{"episode_reward_max": 57.15493985377503, "episode_reward_min": -75.25992586319137, "episode_reward_mean": -12.324431212473417, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -67.31119444429325, "policy_agent_": -29.14538955041792}, "policy_reward_max": {"policy_adversary_": -4.627757767760036, "policy_agent_": 62.23306714903414}, "policy_reward_mean": {"policy_adversary_": -29.14133933835273, "policy_agent_": 8.408454062939654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.371362798294333, -26.753300081937603, 6.340717139718812, -50.29697293622002, -20.402857110424648, -7.072286939177957, -25.49785138842995, -61.15626113703238, -28.618429180082373, -53.994393087847556, 1.0744901797266577, -43.64029868248587, -13.208135548635227, -32.169628290278474, -6.2323072291958495, -10.860552863814934, -26.060435986450443, 17.938604507462347, -6.1835708173910096, 20.95943565278555, 4.769537270188731, -3.219660911566474, -20.004697783581346, -28.063247461380158, 22.51188225531437, -40.68709415306205, 10.249028176313246, -37.65671195836259, -17.305728874915353, -20.359397857120303, -7.519552408242927, -1.8703089890673752, 43.40577838145649, -62.63255814181255, -7.634778749875284, 23.700352139350066, -17.895445600499976, -48.66841880457656, -4.6952883985593195, -33.24631051913413, 4.185554041626974, -60.24535658411458, 10.029585748119205, -5.7041773398364475, 15.942074823109417, 1.2751542078496945, -7.3800565777587535, -4.4433791638563385, -30.715847008305865, -15.241265420778635, -16.479025963380423, -5.235582680082875, -5.054617118692915, 19.918474453191237, -26.98784568279729, -8.28221382113062, -29.823283217236085, -13.152624165211275, -23.67619343020015, -6.52755218047691, 10.07635519085424, 14.769114659971267, -45.338000801037154, -20.814050660352684, -28.732301456749852, -15.257800986693539, -13.101459171693154, 26.456488047330772, -30.69427866989991, -3.71679054342208, -34.81746691812118, -19.69134282820535, -21.36944369426141, 9.25532614736614, -64.55427219276956, -35.46211005760428, -55.354556864226026, -7.146405573968298, 21.516586200861553, 0.9014869312827922, -15.898968688378979, -34.62180914400608, 57.15493985377503, -5.599978991314913, -0.08409037478651316, -11.504632828079288, -17.943933165454272, 4.3885659662946805, -45.937005795715585, -20.618609108796896, -37.033319865712244, 28.603419786767617, -3.1407388800854146, -16.148718439172765, -12.131441284233908, -0.4129009653649659, 6.421039297359635, -22.832991866450136, 19.151513971061362, -32.47012149165759, -5.74557771574078, -18.937661166904714, 5.749501463373836, -36.13283396198219, -3.62435833901547, -10.58161118039253, -35.23320729212321, -16.400431030542446, 4.368585025058192, 29.762980096401996, 13.809781512407756, -58.10532645834659, 7.24341018641727, -5.863301070432879, 8.310132152746975, -26.83434192266131, 4.93890394273241, 12.481244244192652, 8.032121865474874, -8.39543577951285, 11.59874644156331, -26.49881321081138, -1.9824105718069926, -41.86192729853197, 18.300878818614958, -31.360715596491815, -7.527877167979764, -8.455930485069533, -23.700644085033687, 38.78920638593426, -48.435338244189765, 9.352874598992457, -2.593508664182591, -75.25992586319137, -53.38722758707692], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-44.1295417269042, -4.627757767760036, -47.113617097381685, -14.313115449432175, -45.500948330829104, -28.229005277658157, -43.11556869523345, -11.001517882713287, -16.686326224467543, -11.045921801505957, -29.296517305743265, -17.752896515418737, -25.239993466987862, -34.21540039380817, -22.16095945513637, -28.062585258296405, -25.733036200333338, -41.35217041883503, -20.82436259479438, -44.98076159741606, -29.977517304934448, -11.967972385332056, -54.02244706526969, -8.151965814569627, -40.58124649099698, -20.003446725078263, -50.13002129320207, -30.838012152020756, -11.170981232782989, -37.13806728590241, -31.254344093086598, -18.44908258475526, -54.969480564639575, -14.567640154589633, -43.093908966562246, -50.783906915984446, -56.133957197430405, -36.23342676220995, -24.97301997445878, -10.35195861578971, -35.971858745741805, -30.877070629781628, -46.17811291718532, -19.063980137797895, -43.22475906198073, -18.33509961783685, -27.289662549057656, -19.51099939249576, -8.255973312362789, -18.852721781789953, -23.4253014987762, -22.40627493678994, -27.79082463297886, -41.88602332177352, -12.469378264545192, -12.941409638454571, -6.628714519764604, -26.128674024156695, -25.85175914882357, -14.74393331884218, -24.985598184746557, -27.21532212253741, -45.00349357339, -44.87868757716921, -35.74737682860127, -12.254283203487134, -15.980216819581816, -49.917157297716145, -32.93231882006203, -32.129652756572476, -25.8950017605313, -61.33758729492833, -19.193771552107037, -30.041811246668477, -31.106019286075327, -40.609533725714655, -40.97935652105574, -22.768506920078565, -50.60431622078551, -48.307173355941806, -18.13052605479856, -24.73596786811949, -67.31119444429325, -27.44555522000142, -25.908078795651047, -24.05671338288008, -9.265717909810503, -33.892668582334416, -17.273904118456574, -35.87356034926017, -18.007855885588743, -37.613690107398, -27.6258601757886, -8.282977513621459, -14.045261547310457, -32.3544573701261, -23.874111165698057, -15.198697044701685, -44.76673234169834, -21.055654488909173, -43.712553700520665, -54.81074484456478, -37.80634141555457, -32.31355248481888, -20.53698663382933, -18.178611712702104, -11.772572636637536, -18.472168120090082, -13.133891269412667, -38.972523678374976, -29.798905951850195, -18.90764661057968, -19.162158809216052, -63.08009014206883, -23.86353407908873, -22.41085983099869, -27.848375468661782, -41.82679478373977, -27.79238189495601, -19.590583143670322, -47.211557994928945, -34.35280044958701, -27.29158797940516, -23.81766606811851, -31.581868194228193, -38.00012907169241, -49.68710341903941, -25.912711032867424, -26.926230549001794, -58.812639023957274, -28.347989666266404, -25.455421239217994, -12.275735898125573, -16.969146762355525, -12.833638192107134], "policy_policy_agent__reward": [24.250452262599264, 24.250452262599264, -11.062771157088783, -11.062771157088783, 26.72716711855025, 26.72716711855025, -17.991928743393924, -17.991928743393924, 12.549045610202231, 12.549045610202231, 10.578359169240098, 10.578359169240098, 8.808858653401757, 8.808858653401757, -25.07737162715955, -25.07737162715955, -5.966051477807414, -5.966051477807414, -21.474235643170818, -21.474235643170818, 15.185503742734962, 15.185503742734962, -12.943701083533567, -12.943701083533567, 6.0159289591763185, 6.0159289591763185, 1.0228860517648484, 1.0228860517648484, 7.964326112970261, 7.964326112970261, 8.601016197240737, 8.601016197240737, -0.16369989305855304, -0.16369989305855304, 29.645387463148687, 29.645387463148687, 7.320395888701684, 7.320395888701684, 32.9700986251008, 32.9700986251008, 17.37352728756159, 17.37352728756159, 4.374155736882792, 4.374155736882792, 17.00887464084417, 17.00887464084417, -9.955640823405256, -9.955640823405256, 31.546564373155682, 31.546564373155682, -10.341823713991891, -10.341823713991891, 30.189524734757654, 30.189524734757654, -3.4093499031709165, -3.4093499031709165, -3.067373821066177, -3.067373821066177, 8.389334714391055, 8.389334714391055, 11.867395842421836, 11.867395842421836, 8.28938679784394, 8.28938679784394, 49.187629473048034, 49.187629473048034, -24.032458993611467, -24.032458993611467, 17.729565108343472, 17.729565108343472, 37.24212952766725, 37.24212952766725, 19.11925579846522, 19.11925579846522, -6.217496021183308, -6.217496021183308, 10.138865787949731, 10.138865787949731, -11.447175951672216, -11.447175951672216, 20.07870639368439, 20.07870639368439, -14.684142977166474, -14.684142977166474, 28.103849332652263, 28.103849332652263, 6.679901398980725, 6.679901398980725, 29.583416942545075, 29.583416942545075, 9.80512691284327, 9.80512691284327, 9.954802985649449, 9.954802985649449, 7.53381011431971, 7.53381011431971, -11.229936847971544, -11.229936847971544, 1.8057281805056558, 1.8057281805056558, 3.473137767697887, 3.473137767697887, 8.585346128353532, 8.585346128353532, 11.368103757142968, 11.368103757142968, 30.902248887482372, 30.902248887482372, -7.259233709126053, -7.259233709126053, 2.3295979086619774, 2.3295979086619774, -11.597284348735737, -11.597284348735737, 6.48802492947271, 6.48802492947271, 1.0877828593117114, 1.0877828593117114, 4.108190569182631, 4.108190569182631, 17.530976687800408, 17.530976687800408, 20.99221839125434, 20.99221839125434, -0.16725361382357828, -0.16725361382357828, 12.032318458408273, 12.032318458408273, 3.5075376859257057, 3.5075376859257057, -1.5017588916032025, -1.5017588916032025, 1.439378823944328, 1.439378823944328, 38.18682267252347, 38.18682267252347, 1.1190200750810657, 1.1190200750810657, 14.206431106575195, 14.206431106575195, -4.461232578794934, -4.461232578794934, 20.82312223336149, 20.82312223336149, -1.0878360710771915, -1.0878360710771915, 19.648568697017314, 19.648568697017314, -16.724126453347118, -16.724126453347118, 2.5737118340551826, 2.5737118340551826, -7.187600171585142, -7.187600171585142, 7.8110506730551315, 7.8110506730551315, 36.06045121082354, 36.06045121082354, 24.604330143612305, 24.604330143612305, 1.115778683209788, 1.115778683209788, -4.942920637943295, -4.942920637943295, 62.23306714903414, 62.23306714903414, 10.922788114343255, 10.922788114343255, 12.911994210432267, 12.911994210432267, 6.276040277400395, 6.276040277400395, -4.339107627821884, -4.339107627821884, 19.140617274314547, 19.140617274314547, -14.331550838629509, -14.331550838629509, 7.627475620231633, 7.627475620231633, -9.512731990061743, -9.512731990061743, 33.10855494708281, 33.10855494708281, 12.24256064785159, 12.24256064785159, -3.9328704627756514, -3.9328704627756514, 0.9569101315382766, 0.9569101315382766, 15.970778202380565, 15.970778202380565, 15.147575231528851, 15.147575231528851, -3.817147410874223, -3.817147410874223, 31.959123156379857, 31.959123156379857, -5.707233501374212, -5.707233501374212, 18.983487992389943, 18.983487992389943, 17.93654183883003, 17.93654183883003, 21.777921439464194, 21.777921439464194, -1.9096407385816563, -1.9096407385816563, 8.456314147406928, 8.456314147406928, 3.798500266154786, 3.798500266154786, -11.730317327742835, -11.730317327742835, 1.0358685447738178, 1.0358685447738178, 8.751238147235428, 8.751238147235428, 34.367751887388486, 34.367751887388486, 21.804343732128977, 21.804343732128977, -19.598839923883453, -19.598839923883453, 13.20278449781666, 13.20278449781666, 28.608394535817983, 28.608394535817983, 16.08683311591785, 16.08683311591785, -2.211741045831305, -2.211741045831305, 16.393639705697097, 16.393639705697097, 27.154019513966215, 27.154019513966215, 17.91225188021544, 17.91225188021544, 5.597573682078739, 5.597573682078739, 29.40515221824613, 29.40515221824613, 3.926993619387808, 3.926993619387808, 12.654588703799087, 12.654588703799087, -9.02213061520672, -9.02213061520672, 24.94137350642157, 24.94137350642157, 3.3197067376003027, 3.3197067376003027, 21.07961312552982, 21.07961312552982, 8.728390273898945, 8.728390273898945, 1.612793231984048, 1.612793231984048, 48.800922704945755, 48.800922704945755, -10.04367428896169, -10.04367428896169, 17.404147919105224, 17.404147919105224, 4.841113616971491, 4.841113616971491, -29.14538955041792, -29.14538955041792, -20.276794697484895, -20.276794697484895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3088645055784401, "mean_inference_ms": 2.2599582271936653, "mean_action_processing_ms": 0.09773400376592686, "mean_env_wait_ms": 0.6199538989551806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 3375, "timesteps_this_iter": 0, "agent_timesteps_total": 10125, "timers": {"sample_time_ms": 11259.445, "sample_throughput": 299.748, "load_time_ms": 0.997, "load_throughput": 3384120.488, "learn_time_ms": 1831.104, "learn_throughput": 1843.151, "update_time_ms": 20.97}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 322.81366577148435, "policy_loss": -0.0026395889959530904, "vf_loss": 322.8305908203125, "vf_explained_var": -2.7382373809814452e-05, "kl": 0.008596981290759568, "entropy": 1.6009324669837952, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 102.89440422058105, "policy_loss": -0.02790609672665596, "vf_loss": 102.93660125732421, "vf_explained_var": 0.0007835894823074341, "kl": 0.008605974222520374, "entropy": 1.6010114014148713, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3375, "num_agent_steps_sampled": 10125, "num_steps_trained": 3375, "num_agent_steps_trained": 10125}, "done": false, "episodes_total": 135, "training_iteration": 1, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-09-50", "timestamp": 1706105390, "time_this_iter_s": 13.082429647445679, "time_total_s": 13.082429647445679, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4B87D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13.082429647445679, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.92352941176471, "ram_util_percent": 70.98823529411764, "gpu_util_percent0": 0.045294117647058825, "vram_util_percent0": 0.19661937040441177}}
{"episode_reward_max": 37.27113670402625, "episode_reward_min": -59.54534747127192, "episode_reward_mean": -12.628554344304366, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -69.09473368137215, "policy_agent_": -26.536533493248353}, "policy_reward_max": {"policy_adversary_": -4.878007072132423, "policy_agent_": 47.920630741235996}, "policy_reward_mean": {"policy_adversary_": -25.841553824626263, "policy_agent_": 6.606499740160947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.959796236743019, -5.906646310983657, 28.095984803117975, -23.249652965506087, -51.339961704148045, -5.0000485077890815, -38.76605622819409, -15.138328049058266, -13.525189956841489, 37.27113670402625, -2.752730242159557, -34.40764786346511, 16.69734888883378, -39.41708915653609, -6.5557018568184215, 8.604778755875387, -1.6340646879280705, -3.571341164859048, 23.26390651068819, 6.595118194348231, -59.54534747127192, 15.091004048573804, -56.0865983973225, -17.753450251585818, 7.602907487613021, -33.07615358910056, -45.78682217976639, 21.531292810545843, 2.0441186805609686, -35.47533324474973, -44.138288295013474, -12.020452338410712, 3.40091444993622, -14.425670354677607, -1.5495634889096777, 20.33167823817755, 13.661793742288499, 2.2391830269396924, -20.196664371167763, 19.728623581594135, -23.32195754537385, 20.412399741919348, -28.27065410223714, 3.798850691303424, 13.63901305208159, -15.978737022363463, -36.30199560560487, 0.5389706102682199, -27.896132012436304, -11.132449731580895, 29.38374270158723, 3.9123153231828445, 3.591722935430863, -9.150305147580013, -22.464185771586433, 26.746527801099823, 20.576651392827973, -0.49367248260153485, -17.026513377309975, -19.773769396124184, -4.846528108925684, -10.368538151178754, -12.301324773037178, -31.786169403451257, -24.84659887982293, -20.376546636412456, -9.799819805261277, -7.01953826568191, -29.789987367657726, -21.114567576608113, -23.41291451789836, 2.7760388003652112, -6.452444630945706, -3.377147106730903, -44.39506551180851, -11.976554983304077, -24.53382155616603, 2.2804471793312655, -31.381669214706704, -7.649144768073375, -13.310096955114124, -36.86614442688452, -0.23182766097916185, -1.0325583434744772, -35.3614613250249, -44.79972980089792, -17.932176706453816, -18.734356870423824, -6.849220342610679, -34.929764583191066, -10.895452392873041, -16.51660875809202, 8.4366929792374, 1.4943762981190982, 16.357388255843023, 5.073774780319406, -47.45285813156733, -2.4240006244806325, -44.300956336698334, -0.4160688511358215, -22.438363554330955, 23.68310300994316, 6.3130204428392345, -14.132428926710407, -25.724060548343157, 37.235694207920254, -25.426837015272753, -46.90783074575302, 16.34637670472399, -15.462063329660483, -54.6641270196051, -2.9160895545528844, -43.54647940324903, -8.874737998504015, -32.3641508183663, -16.123353785561033, 15.815798540293976, -43.63251957883703, -40.565028974418205, -21.337798432099536, -25.014059003734374, -6.40481152473428, -50.10097134038547, -19.45723940979872, -30.635896349757793, -31.66724221392291, 2.2080271800738043, -56.08886765944409, -28.85410275547598, 29.74860585099217, -7.416130819722702, -21.364644450513524, -2.591494375099364, -31.717490299099083, -42.384710521583195], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.795483499097967, -8.63037693864867, -45.92846702906477, -20.63789972905783, -27.94596128630248, -14.965212141753598, -31.064190317259694, -20.069821413361407, -8.219252957361002, -58.24416366681127, -11.941375690168885, -13.475536095505372, -29.321039765020164, -43.411770455828304, -31.20385302610754, -41.01924027527973, -40.329930364193416, -41.847012561986716, -34.27956248380088, -26.126204769511133, -6.472280484775229, -40.37205206331412, -8.883972189691292, -11.587727308297865, -19.73661603638389, -8.95717169096243, -40.89850200055469, -41.18034709946591, -35.711088124394, -23.163975803650093, -22.818049989645726, -31.39207924090927, -32.478983313413785, -27.55415392203191, -6.569052840781102, -35.77849866736991, -33.826152742607995, -20.298143066048286, -18.613100071193323, -40.631799598796114, -8.617405759070115, -35.40260990689244, -27.548126448848073, -19.088733146789828, -34.987538672829544, -13.264595708542357, -16.84480111449798, -25.357265867226932, -13.614917661452612, -41.322420760427555, -55.14432256846508, -19.877446759913198, -19.112611357921413, -22.095330956119593, -20.51042653690711, -69.09473368137215, -32.87897274948116, -38.266676607649735, -13.253430286186491, -17.79692373650248, -19.154343670874603, -12.295210871911236, -42.19677217589508, -5.552695271042424, -20.99392931700816, -21.313817504069377, -18.58914345054812, -29.548256906036144, -39.06105717339805, -35.44745900286319, -18.825455941512143, -29.222576732041627, -27.430760578522463, -42.51161837315639, -34.05615552787638, -30.104780661267142, -11.473339446670087, -21.208541878515458, -26.549299084043604, -24.682670328343626, -16.548287652172416, -30.17755860997988, -18.23970632820333, -34.298477462683536, -23.662526153951976, -11.288388418211268, -28.03157805702449, -23.8764942723979, -13.326879559865535, -21.124917238483583, -28.33658021180782, -18.709467131747157, -34.55810079876827, -15.561061744517216, -24.406332998918362, -28.81345114704343, -9.361161371298286, -20.24026324890055, -37.150099002202246, -24.949299079563694, -42.7295697201242, -46.717294561088515, -20.240339078214, -19.626036700051223, -12.98990270175656, -49.71951871840664, -9.888113885453691, -12.162805309975829, -43.778272485005026, -27.791209000783766, -13.834749427211513, -27.80009805937446, -10.706647810977689, -26.149377880557626, -42.79977615861329, -16.43240281342651, -43.303866637440194, -16.207591592280128, -36.2574076738088, -6.562656422368606, -20.36523008543458, -36.272723774436955, -25.653709835769373, -33.071440255104, -20.31699240013097, -17.77298415827235, -37.29223307444977, -36.98857391772121, -22.621507649529406, -40.91214978786106, -4.878007072132423, -6.3651113847770855, -29.91678290252428, -15.671474560437906, -29.47530343820604], "policy_policy_agent__reward": [4.917843631177474, 4.917843631177474, 1.3618653138325074, 1.3618653138325074, 37.01222591609138, 37.01222591609138, -1.3058766182241341, -1.3058766182241341, -11.697000208922788, -11.697000208922788, 4.982581816982256, 4.982581816982256, -3.8509329554671963, -3.8509329554671963, 2.4657466821515728, 2.4657466821515728, -2.652968499740246, -2.652968499740246, 47.75765018541877, 47.75765018541877, 4.594322724004663, 4.594322724004663, -10.466055883979863, -10.466055883979863, 23.00919432692697, 23.00919432692697, 1.9973406496461135, 1.9973406496461135, 12.324075584644552, 12.324075584644552, 24.812009515577554, 24.812009515577554, 19.34793283813267, 19.34793283813267, 19.137835698563833, 19.137835698563833, 28.771734497244534, 28.771734497244534, 16.360661481929675, 16.360661481929675, -26.536533493248353, -26.536533493248353, 27.73152805594397, 27.73152805594397, -23.601313103815606, -23.601313103815606, -3.0828614716439753, -3.0828614716439753, 13.669761761998453, 13.669761761998453, -12.059490949069064, -12.059490949069064, -2.444160089605854, -2.444160089605854, 31.355819955005877, 31.355819955005877, 18.877603402477487, 18.877603402477487, -6.155678720549817, -6.155678720549817, -10.660119152683878, -10.660119152683878, 9.68581345124928, 9.68581345124928, 17.939948881675004, 17.939948881675004, 6.564241783677158, 6.564241783677158, 2.5097446759357127, 2.5097446759357127, 28.055088452773735, 28.055088452773735, 23.74397324244824, 23.74397324244824, 11.268663046493991, 11.268663046493991, -0.7917821499872235, -0.7917821499872235, 30.180211590195125, 30.180211590195125, -7.352275893151871, -7.352275893151871, 27.907504824405898, 27.907504824405898, -0.3612638266945367, -0.3612638266945367, 11.443791919046621, 11.443791919046621, 24.313275862455576, 24.313275862455576, -1.3570706569105546, -1.3570706569105546, -9.728597245553443, -9.728597245553443, 12.948118238747576, 12.948118238747576, -7.14060717549184, -7.14060717549184, 15.094985514423332, 15.094985514423332, 42.264032635026155, 42.264032635026155, 11.894881041548022, 11.894881041548022, 11.352167146676134, 11.352167146676134, 6.472512904269788, 6.472512904269788, -0.9768796173396556, -0.9768796173396556, 47.920630741235996, 47.920630741235996, 26.72781207115456, 26.72781207115456, 18.886502062524098, 18.886502062524098, -1.886541545561741, -1.886541545561741, -0.9884228298108534, -0.9884228298108534, 7.153907780974462, 7.153907780974462, 0.963336360366239, 0.963336360366239, 14.94772370142895, 14.94772370142895, -13.116737066204418, -13.116737066204418, -1.9263347814073872, -1.9263347814073872, 0.4686354338284606, 0.4686354338284606, 4.3946618226434255, 4.3946618226434255, 11.264359320177117, 11.264359320177117, 4.6355349028701625, 4.6355349028701625, 7.166445713127535, 7.166445713127535, -2.293729288193106, -2.293729288193106, 15.999307766203431, 15.999307766203431, 10.489157973788375, 10.489157973788375, 19.567235633212746, 19.567235633212746, -5.169454991966072, -5.169454991966072, 9.064112838981533, 9.064112838981533, -6.53024105474797, -6.53024105474797, 11.74449452892336, 11.74449452892336, -2.416185065331546, -2.416185065331546, 8.516762780135128, 8.516762780135128, 1.6190953485291462, 1.6190953485291462, -3.3442929084523083, -3.3442929084523083, 9.003939333612083, 9.003939333612083, 16.63295955960453, 16.63295955960453, -5.8494675855364635, -5.8494675855364635, -16.755670691343326, -16.755670691343326, 5.049700675285335, 5.049700675285335, 2.5710687009870368, 2.5710687009870368, 3.238829608627427, 3.238829608627427, -6.902423672353752, -6.902423672353752, 8.720563909467392, 8.720563909467392, 1.0964291868275668, 1.0964291868275668, 21.497396889002832, 21.497396889002832, 8.527719021318156, 8.527719021318156, 20.381860627380693, 20.381860627380693, 16.943612963681417, 16.943612963681417, -19.045848380134526, -19.045848380134526, 8.908131312209958, 8.908131312209958, -3.5754286672480515, -3.5754286672480515, 12.266615114213938, 12.266615114213938, 10.145603082896622, 10.145603082896622, 35.20019878551584, 35.20019878551584, 13.276679760526623, 13.276679760526623, 2.746803886670408, 2.746803886670408, -6.367078923293309, -6.367078923293309, 43.477606463163454, 43.477606463163454, -7.769361564909536, -7.769361564909536, -17.372512717888586, -17.372512717888586, 30.0623245948645, 30.0623245948645, 6.1645728355616445, 6.1645728355616445, -20.414688796196792, -20.414688796196792, 12.442004252410785, 12.442004252410785, -16.419915796135662, -16.419915796135662, 8.637319941026805, 8.637319941026805, 5.217812670123486, 5.217812670123486, 0.15452451393273553, 0.15452451393273553, 29.55983258886708, 29.55983258886708, -13.712463993278453, -13.712463993278453, -2.153810650304697, -2.153810650304697, -7.387571004865461, -7.387571004865461, -2.3244144591498905, -2.3244144591498905, 14.933956124851335, 14.933956124851335, -12.223630752308052, -12.223630752308052, 6.807100422652638, 6.807100422652638, -5.15945197481342, -5.15945197481342, -6.947129027825278, -6.947129027825278, 19.750130127261784, 19.750130127261784, -9.55014687086144, -9.55014687086144, -3.1162975529732826, -3.1162975529732826, 35.330377819426616, 35.330377819426616, -1.2690618737951385, -1.2690618737951385, -7.499766532868222, -7.499766532868222, 13.662644263712457, 13.662644263712457, -8.023007869330588, -8.023007869330588, -6.454703541688573, -6.454703541688573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923209668264037, "mean_inference_ms": 2.150464223711285, "mean_action_processing_ms": 0.09600455493929824, "mean_env_wait_ms": 0.5882104167325872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 6750, "timesteps_this_iter": 0, "agent_timesteps_total": 20250, "timers": {"sample_time_ms": 11650.738, "sample_throughput": 289.681, "load_time_ms": 0.998, "load_throughput": 3383311.663, "learn_time_ms": 1741.856, "learn_throughput": 1937.588, "update_time_ms": 20.944}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 245.88963317871094, "policy_loss": 0.006064303987659514, "vf_loss": 245.8988479614258, "vf_explained_var": -0.002381157875061035, "kl": 0.0027492310930171183, "entropy": 1.5824480414390565, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 80.27635021209717, "policy_loss": -0.01424984186887741, "vf_loss": 80.30521297454834, "vf_explained_var": 0.001720479130744934, "kl": 0.006318078480617567, "entropy": 1.5874869048595428, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6750, "num_agent_steps_sampled": 20250, "num_steps_trained": 6750, "num_agent_steps_trained": 20250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 2, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-01", "timestamp": 1706105401, "time_this_iter_s": 11.767274379730225, "time_total_s": 24.849704027175903, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E7CD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 24.849704027175903, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.179999999999996, "ram_util_percent": 71.76, "gpu_util_percent0": 0.03533333333333335, "vram_util_percent0": 0.19864908854166666}}
{"episode_reward_max": 26.490895548160406, "episode_reward_min": -73.66404239492839, "episode_reward_mean": -9.70816837128081, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -48.98477712436342, "policy_agent_": -31.6345404153587}, "policy_reward_max": {"policy_adversary_": -6.248234146899965, "policy_agent_": 37.06673139810017}, "policy_reward_mean": {"policy_adversary_": -22.809682686468133, "policy_agent_": 6.550757157593663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.68482883442306, -13.519208752074464, -7.233190830274387, -8.36564413249829, 2.6768540392674165, -2.511622603685332, -8.702971063425524, 10.170627300902368, -73.66404239492839, 5.823519119421923, -11.121985392453164, -24.184829834115423, 8.465445193726168, -11.5167848892922, 20.583050598591083, -2.677324547190418, -34.609422989831366, 15.210355457454146, 6.409800227568912, 2.1023517258386515, 1.7273431374013537, 7.806431142507279, -27.840769980088417, -1.3732752870591671, 0.5332094597296749, -13.951416843060302, -4.020414956738996, -16.87979461080475, 16.207531643787874, 7.599007083459844, -2.4548648049797985, -24.084430106072784, -1.9374842240900298, -23.100736195177717, -23.503003135388568, -35.73183808765117, -11.049113151981823, -3.3542744275406005, -33.650662998693946, -30.602134466106495, 11.523316108275553, -41.30825500205906, -3.4251858624293385, -0.900790954971554, -40.961971337139055, -14.701394608632572, 16.87367722116131, -20.93418848736359, 14.28890292188912, 3.0860010886843234, -16.848787827526426, 1.3412898423963557, -2.598358994877303, 0.9567156037654163, -5.532307613262097, 26.490895548160406, -49.11927255935037, 2.400286323467638, -5.956387646176008, 3.838498584470415, -28.68164963455852, 3.080436035111466, -19.458501780911526, -6.002450841760199, -12.745033392291317, -38.92395208493603, 4.618175921448506, -0.5835108948308776, -27.40971512119818, -15.669723600811224, -16.408595714043273, 0.7984520766234952, -19.936633742886492, -26.689956072000832, -0.09356185196485722, -32.318005129030276, 2.345031314738276, -13.04249536615838, -22.271306549065237, 21.206239030091307, -39.84049721009984, 16.256497077025948, -4.210311614715444, -8.934767654218247, 5.783935866288347, 6.887710626101214, -0.09873376114657595, 17.28357216257074, 9.993786548213624, -17.48464437379315, -39.32077785857154, -28.42904175551483, -2.3577534941458413, -20.11676952287836, 16.391654635581453, -21.6808643870397, -13.579782871903108, 12.510381311426627, 6.990577167752182, -17.82733043773498, -6.661796951939088, -3.08765448940909, -35.37515626899943, -18.82672858368302, -22.898867327357017, -26.95511649115266, -54.539611886380776, -21.936602934094243, 8.577496291695365, -35.85193942898965, -9.463803228827288, -11.033083535003573, -19.095494063462272, -1.7404324967703575, 4.291798342698533, -23.39589699189608, -17.099182215296857, -2.0531909801409824, -4.271328392882152, -26.428573034727478, 12.156943468332576, -11.30628338566784, 14.66343036713226, -24.763317852119595, -5.862376757403564, -0.34048934909873485, -4.968751771202182, -55.88523410229302, -3.9087270077560796, -7.75523548529248, -6.401584114489292, -5.490548042555593, -6.338812395872418, -9.432399682522682, -7.656401338760166], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-31.914947577732285, -23.413879691397124, -21.454560165738958, -24.916832179161933, -29.227987570420446, -22.77302039919879, -40.282988878737925, -21.548481012406715, -10.39496156421097, -42.611929153775066, -19.235241085147063, -25.28120856097425, -24.22886275294035, -16.994402303818063, -36.57066590968575, -26.700446732719666, -15.774904468622365, -38.89397593531274, -12.81833604157667, -16.74245862756672, -20.234400886751832, -45.91380582357437, -21.38112756497339, -31.075475804868343, -13.28278248845277, -21.363699845009137, -11.204526601835886, -22.522221726656845, -36.368225843857836, -17.37259189493906, -16.524232444048575, -14.5278019000107, -17.007802991039327, -30.228763552726974, -9.336263981216092, -12.593859496390168, -19.671712688842344, -16.4236205208065, -7.597464309409949, -22.547392164227578, -40.64258863524201, -23.96299542681706, -8.281419797966317, -18.266554582703655, -20.482741864501868, -28.34373362541958, -24.94355370960344, -19.410258171679754, -28.302138308247702, -15.026067968798728, -16.84588407957629, -30.828183579432377, -40.32101639712281, -27.802278818894155, -27.76581957850141, -47.64256724803995, -23.754160081935268, -16.990789999253117, -22.354258109368363, -21.62151309331286, -21.72706897702448, -21.526018590409787, -24.89426090681178, -14.801910806851854, -6.248234146899965, -23.310472116438376, -24.278125507693076, -14.256555128384512, -20.684924057003027, -24.065514417036187, -27.036429445863675, -17.939505126435105, -13.149785413303945, -21.798449898486396, -15.888049730175004, -26.81851354187643, -22.910975095262096, -8.282469834310636, -14.556014542227917, -48.98477712436342, -11.092957443746284, -38.06741958981309, -16.289783375151636, -26.65435718862078, -22.192654603199397, -19.370543209323262, -20.376965561411744, -28.175514159841143, -23.180731822089946, -20.763433546224277, -18.284028043569325, -10.783157817079706, -19.456496297658358, -21.1377585748163, -30.738040137117977, -24.767419444343922, -31.153183434633984, -23.27291734246995, -45.081102849707115, -11.393806125991066, -18.469265290652952, -40.830798115193396, -18.66045811141356, -25.50187145964636, -10.638200514969206, -12.453247911991253, -23.46986784946814, -7.461679780291325, -26.102957487137065, -21.04792989342171, -28.463732774537206, -17.86734720975027, -19.579912492009274, -31.017235662089686, -46.28394821182275, -12.580722604307796, -31.382160419451335, -18.72982449131834, -8.488902200133436, -11.393421563307705, -40.46945844222207, -43.956753583421275, -26.572210081242595, -18.618005708218575, -22.04964409412519, -22.355889476378692, -29.18729596419091, -16.341992412873097, -13.27531311069247, -31.30254940220874, -14.790342050170551, -19.141590677718987, -33.02520774596362, -15.166178440816134, -14.694536249177427], "policy_policy_agent__reward": [5.115059371654616, 5.115059371654616, 4.94733546966133, 4.94733546966133, 7.110684667732284, 7.110684667732284, 8.27559402333182, 8.27559402333182, 15.952420804843928, 15.952420804843928, 10.130698897756728, 10.130698897756728, 15.790008907656206, 15.790008907656206, 15.859554156654541, 15.859554156654541, -31.6345404153587, -31.6345404153587, 24.2177241365985, 24.2177241365985, 4.0566278463469505, 4.0566278463469505, 0.5481893634294213, 0.5481893634294213, 16.347153973333256, 16.347153973333256, 2.7388087072629332, 2.7388087072629332, 28.57685825413841, 28.57685825413841, 12.011561092764616, 12.011561092764616, -9.417259260604496, -9.417259260604496, 27.052165696383454, 27.052165696383454, 9.61406813457279, 9.61406813457279, 9.422405176702684, 9.422405176702684, 10.98087201207659, 10.98087201207659, 26.860118483040832, 26.860118483040832, -3.2298212075575194, -3.2298212075575194, 14.85110025890459, 14.85110025890459, 6.907995974091223, 6.907995974091223, 3.706141500974418, 3.706141500974418, 3.5920558225484456, 3.5920558225484456, 2.8212135579260473, 2.8212135579260473, 26.287878743822862, 26.287878743822862, 12.485799489199449, 12.485799489199449, 7.034683819534389, 7.034683819534389, -4.778314103031039, -4.778314103031039, 7.535159383474647, 7.535159383474647, 3.564013678774634, 3.564013678774634, -7.083369577086244, -7.083369577086244, -11.568989295630505, -11.568989295630505, 4.311299768430259, 4.311299768430259, 6.5346730466329515, 6.5346730466329515, -13.026599344642003, -13.026599344642003, -4.027371150939464, -4.027371150939464, 26.08295237175878, 26.08295237175878, -8.672629787621009, -8.672629787621009, 2.4281169677684895, 2.4281169677684895, 8.682881813866048, 8.682881813866048, -10.239614736318593, -10.239614736318593, 6.821169508393511, 6.821169508393511, 20.90861546538238, 20.90861546538238, -0.7619651578419123, -0.7619651578419123, 21.295520615068412, 21.295520615068412, 9.056034528741526, 9.056034528741526, -0.0014518739750698506, -0.0014518739750698506, 16.08473671091436, 16.08473671091436, 18.86132870112276, 18.86132870112276, 14.379497211329783, 14.379497211329783, 11.11675598261966, 11.11675598261966, 37.06673139810017, 37.06673139810017, -12.68255623870756, -12.68255623870756, 9.695538161360378, 9.695538161360378, 8.198935231596181, 8.198935231596181, 12.730005838891639, 12.730005838891639, -3.477290328767024, -3.477290328767024, 12.303227312760622, 12.303227312760622, 2.7178795629501273, 2.7178795629501273, 4.3997299825458285, 4.3997299825458285, -3.248399622695673, -3.248399622695673, -7.806739984248827, -7.806739984248827, 14.448150714570797, 14.448150714570797, 6.836522116776817, 6.836522116776817, -3.3623955320975787, -3.3623955320975787, 4.197895408112484, 4.197895408112484, 5.313916865910204, 5.313916865910204, 9.3689786015293, 9.3689786015293, -3.3934241647912735, -3.3934241647912735, -2.445753086757218, -2.445753086757218, 7.897243939105074, 7.897243939105074, -2.7497457935769134, -2.7497457935769134, 12.628003205000187, 12.628003205000187, -2.3800127659238726, -2.3800127659238726, -3.8576460034186613, -3.8576460034186613, 35.095508077227365, 35.095508077227365, -14.373769883176768, -14.373769883176768, 27.161958333419516, 27.161958333419516, 6.039735880218098, 6.039735880218098, 8.859794767201263, 8.859794767201263, 13.988295234743877, 13.988295234743877, 13.12912691771224, 13.12912691771224, 10.139115900132582, 10.139115900132582, 22.729543161205942, 22.729543161205942, 16.587259185151783, 16.587259185151783, 1.6393945862155652, 1.6393945862155652, -10.518374907501109, -10.518374907501109, -8.822941969217558, -8.822941969217558, 8.549371401756263, 8.549371401756263, 0.5104945259689618, 0.5104945259689618, 23.564847386349715, 23.564847386349715, 1.5432775286521143, 1.5432775286521143, 8.786700281365437, 8.786700281365437, 17.891649326948286, 17.891649326948286, 26.03584000872964, 26.03584000872964, -3.216762155871959, -3.216762155871959, 5.903734169356934, 5.903734169356934, 18.871571812892153, 18.871571812892153, -8.357349078792936, -8.357349078792936, 3.337571437981669, 3.337571437981669, -6.130333406193901, -6.130333406193901, -7.250934289580703, -7.250934289580703, -15.534872018456316, -15.534872018456316, -7.23746157690146, -7.23746157690146, 17.340226889416215, 17.340226889416215, -7.402004767783977, -7.402004767783977, 9.499964772854952, 9.499964772854952, 3.4171318373733506, 3.4171318373733506, 0.24220921427349906, 0.24220921427349906, 14.638401582659666, 14.638401582659666, 25.287873277260644, 25.287873277260644, -5.407587193794143, -5.407587193794143, 7.14148910207724, 7.14148910207724, 8.33831675558868, 8.33831675558868, 2.1087869036256417, 2.1087869036256417, -7.51757573570988, -7.51757573570988, 26.313200955277328, 26.313200955277328, 16.32523509887672, 16.32523509887672, 20.617820224187437, 20.617820224187437, -3.0726560719505076, -3.0726560719505076, 8.093633668360816, 8.093633668360816, 11.007700063639977, 11.007700063639977, 12.109272096494363, 12.109272096494363, -19.771620844709954, -19.771620844709954, 4.683293051468196, 4.683293051468196, 11.77365695845813, 11.77365695845813, 4.194378967840631, 4.194378967840631, 6.825521317581696, 6.825521317581696, 13.343197675045602, 13.343197675045602, 2.866889379146725, 2.866889379146725, 3.51906745520863, 3.51906745520863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27820269737296344, "mean_inference_ms": 2.0724270314137003, "mean_action_processing_ms": 0.09452962583636354, "mean_env_wait_ms": 0.5652083432107418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 10125, "timesteps_this_iter": 0, "agent_timesteps_total": 30375, "timers": {"sample_time_ms": 11490.352, "sample_throughput": 293.725, "load_time_ms": 0.997, "load_throughput": 3384390.182, "learn_time_ms": 1688.495, "learn_throughput": 1998.822, "update_time_ms": 19.957}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 175.95505981445314, "policy_loss": 0.0042273044033208865, "vf_loss": 175.96554260253907, "vf_explained_var": -0.00441511869430542, "kl": 0.007033951408526416, "entropy": 1.542060375213623, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 55.20169925689697, "policy_loss": -0.012665556557476521, "vf_loss": 55.227949142456055, "vf_explained_var": 0.01180301308631897, "kl": 0.009528016422077366, "entropy": 1.549013125896454, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10125, "num_agent_steps_sampled": 30375, "num_steps_trained": 10125, "num_agent_steps_trained": 30375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 405, "training_iteration": 3, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-13", "timestamp": 1706105413, "time_this_iter_s": 11.048200368881226, "time_total_s": 35.89790439605713, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E085E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 35.89790439605713, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.040000000000003, "ram_util_percent": 71.66000000000003, "gpu_util_percent0": 0.030000000000000013, "vram_util_percent0": 0.193896484375}}
{"episode_reward_max": 25.76625050102496, "episode_reward_min": -45.92855271521884, "episode_reward_mean": -7.760617022250345, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -49.972150551798784, "policy_agent_": -13.627354361236968}, "policy_reward_max": {"policy_adversary_": -4.721559129721254, "policy_agent_": 30.89786429350756}, "policy_reward_mean": {"policy_adversary_": -20.312815040064468, "policy_agent_": 6.276099008907059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.942432479015988, -40.948074122058856, -17.68817334937306, -14.826491875811527, -2.5591842943124075, -5.30930696117157, -14.993341487036886, -12.955164869190387, -5.496082457730586, -25.925235864068057, 3.235465969829756, 5.570533305016599, -25.644415307367936, 6.162221111481871, 15.437302064586028, 3.0781968860254647, 25.76625050102496, -0.04127103326879977, -1.4209389275406104, 0.7151414711458057, -2.1884031858441295, -5.476865997119524, -4.997991797422247, 13.656160339873006, -6.934313205385237, -2.920832490437286, 0.005661633490819606, -14.587319790537357, -6.278146843823415, 2.8657977578845872, -9.463074400743505, -24.384975677915467, 7.146475342612835, -5.321583561845408, -44.0854796652415, 5.828972021957828, 2.1611043392132894, 7.62324067334001, -28.439489954561942, -8.065874975259137, 1.7722311462315734, 19.407551159627765, -1.6127756990410793, -3.373398844324231, 2.9999937143261555, -10.720206382890213, 1.8053401172841297, -0.4817867426079993, -16.071728336561375, -9.060422052309086, -19.666423854937015, -2.5933854337440225, -14.855784399247819, -0.47777984891358694, -14.712357656778583, -10.38009449983373, -0.9718395534742186, -7.2262179183998985, -6.343817845864217, -6.855878671937633, -13.473914094801513, -6.549350299035282, -12.963736998095959, -9.023957955923683, -22.513776734534826, 2.556252291784642, -19.705222355556362, -9.437188428510533, -22.968615212214605, -11.600219879570608, -3.326254119495827, -27.39671730701309, -2.4486811096788963, 11.000270256969102, -42.8704092103008, -14.897057443632507, -13.755960513330331, -45.92855271521884, -10.999422742138528, 8.681845268969964, -7.565945573329739, 15.089683468790387, -22.612283669842746, -15.209209916371185, 4.065477455712104, -1.0786500304208677, -7.634172344642705, -22.956775232242084, 6.363406522779151, -6.3134205420663765, -43.93455940308548, 9.949097348363962, -20.742363660028843, -8.625919534380689, 1.4892534108947535, -25.49522413371461, 7.618164790627655, -6.985884699170379, 2.8936718370078323, -5.591995410731343, -4.213198470334115, -18.624946104006877, -15.705389990925202, -6.523674925348965, -19.955007932215647, -7.31222024435052, 0.8198500032396727, 9.982996299981426, -15.213222301356572, -4.340709525759718, -2.939317231917344, -10.271181710645749, -9.588796896212337, -8.087610748533573, -2.748759290268714, -17.35375581556538, -12.076473258170902, -16.94194675705377, 5.689927662158552, -18.337621443144677, -12.308310775472284, -6.198499915566204, -7.447845352417198, 7.619510384571419, 5.57102117578138, -3.925118045675962, -31.59044232313073, -27.34380549640787, -7.194583345258146, -26.005454432600654, -9.67319587864113, -1.9954301574230382, -7.7225615745118095, -20.90909890517419, 10.255751737702932], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-33.03743422732697, -17.16969888968696, -29.219652160270126, -21.60249159761294, -23.322840095580062, -20.02231864637487, -19.221443987784664, -20.201934419543846, -7.88137849596353, -29.376221878464357, -27.306022146838366, -22.45442972779585, -16.0390055585207, -14.217519968854793, -40.17100685241174, -15.810653704285409, -36.029478085990156, -20.16532435619736, -20.203284470795168, -14.460540909873469, -20.142943012827345, -34.45432997603251, -4.721559129721254, -26.249859700700934, -10.994746258592635, -34.06392409994142, -11.174534804036487, -12.141387493291148, -15.811797975648018, -30.636699108353206, -42.803180353681725, -24.673332902875575, -16.900986119408717, -12.780934347064685, -16.830770942767565, -27.920094005078617, -24.34387152957512, -25.74210477087361, -25.67611263820196, -13.61963240180288, -19.48048391082783, -38.055477868018194, -34.82964207861478, -15.378629075111215, -17.1539512604028, -6.131995610809888, -32.31309249943423, -17.00304593447233, -41.989727161660475, -14.286275834039309, -9.061938441894572, -21.088709166299907, -16.51568978211027, -15.391747175371467, -16.561930927414988, -12.26546896298693, -12.863173604441647, -23.85131943526324, -13.987699871264557, -22.764640183043202, -23.70913022656071, -11.296102890309342, -7.309284241919115, -8.443894081672456, -6.213951449797459, -25.295310190833955, -20.251874153331727, -28.7833993607862, -17.782134000404533, -18.0924221891114, -14.023614072177066, -12.826708671042507, -8.235506235269016, -39.8609203058818, -16.60376564813783, -13.597251124372034, -28.625814908697986, -49.972150551798784, -13.272066606509819, -26.468556575031144, -24.158541768412203, -34.2417380369194, -29.962297032963285, -7.384241535237716, -11.92226761617992, -15.314471143724054, -9.806859517981893, -7.020748464506211, -31.588269594378676, -5.91521929585077, -35.03178699478104, -23.37113772366384, -16.92041950038586, -14.199518219292669, -13.48579476452975, -5.390609978538452, -20.211379703701116, -22.424641623586474, -27.197708368650755, -14.575458938859915, -25.869652004697002, -27.147268018266523, -8.348248917919108, -9.146432853774737, -8.521479329066164, -13.493351107057673, -14.08183103443582, -22.734710102069062, -17.870625207158383, -23.99627692895044, -9.295588059067196, -9.317556313682182, -33.51760528938048, -35.077721065074584, -33.95385090047926, -24.596468872987742, -8.856392493627748, -15.82849321310987, -41.93650568779422, -23.98170599328614, -7.9749405035470655, -19.36619280904724, -13.026396552803861, -28.07866777234563, -21.287741414391313, -28.790163477331983, -6.658626673652752, -15.707043569980367, -12.058553320937992, -14.2627986381871, -18.979742394294327, -31.297015539173003, -35.65695094269954, -13.490668769754514, -26.665676798754244], "policy_policy_agent__reward": [21.98993335317148, 21.98993335317148, -11.88918761618594, -11.88918761618594, 5.765739405448536, 5.765739405448536, 3.387999860900706, 3.387999860900706, 10.381827900633825, 10.381827900633825, 7.356505842601651, 7.356505842601651, 2.1140512503738895, 2.1140512503738895, 3.6233847751767287, 3.6233847751767287, 1.192648019116471, 1.192648019116471, 1.7254930071981502, 1.7254930071981502, 15.27074405833406, 15.27074405833406, 14.012481516406224, 14.012481516406224, -4.802704874423617, -4.802704874423617, 10.189870540168332, 10.189870540168332, 27.804154458498886, 27.804154458498886, 9.444425295155439, 9.444425295155439, 30.89786429350756, 30.89786429350756, 10.062026661464277, 10.062026661464277, 9.39117277162728, 9.39117277162728, 7.587841190509638, 7.587841190509638, 8.977269913491607, 8.977269913491607, 14.488731989456497, 14.488731989456497, -0.13821633385049586, -0.13821633385049586, 19.953010020286975, 19.953010020286975, 2.030216526603702, 2.030216526603702, 15.571545804752061, 15.571545804752061, 5.590098218763655, 5.590098218763655, -1.2229661486231045, -1.2229661486231045, 4.766825565912302, 4.766825565912302, 16.7512484331189, 16.7512484331189, 16.670052976469115, 16.670052976469115, 0.14417861248005104, 0.14417861248005104, 12.023730731010774, 12.023730731010774, 3.7296753926096384, 3.7296753926096384, -13.627354361236968, -13.627354361236968, 16.874533013518224, 16.874533013518224, 13.252487934394205, 13.252487934394205, 16.68267272210681, 16.68267272210681, -1.3816886581799936, -1.3816886581799936, 2.776878713271875, 2.776878713271875, 10.626357528529702, 10.626357528529702, 28.731514513822987, 28.731514513822987, 16.608433189786847, 16.608433189786847, 6.002615115393494, 6.002615115393494, 10.076972487364477, 10.076972487364477, -2.294105386040163, -2.294105386040163, 17.05921630835918, 17.05921630835918, 8.260629595932167, 8.260629595932167, 12.958999412549549, 12.958999412549549, 2.612926890865113, 2.612926890865113, -5.302242706521222, -5.302242706521222, 9.247661866277946, 9.247661866277946, 0.8299526914312262, 0.8299526914312262, 7.45698366322894, 7.45698366322894, 0.9247866353182025, 0.9247866353182025, 0.9426872315766015, 0.9426872315766015, 5.945667025483713, 5.945667025483713, 8.312550758431671, 8.312550758431671, 3.8219410127001687, 3.8219410127001687, 7.954380755552781, 7.954380755552781, 5.117608065879597, 5.117608065879597, 2.373376295637029, 2.373376295637029, -2.8272263780884197, -2.8272263780884197, -0.2900319371256118, -0.2900319371256118, -8.149912642368685, -8.149912642368685, 13.925781241309299, 13.925781241309299, 0.273325898887682, 0.273325898887682, 9.673105466137839, 9.673105466137839, -2.593240605905033, -2.593240605905033, 3.2461011547703964, 3.2461011547703964, 5.3486799763406205, 5.3486799763406205, -7.285004317985295, -7.285004317985295, 2.8934125627950613, 2.8934125627950613, 25.430595281425447, 25.430595281425447, -13.133321781081477, -13.133321781081477, -0.6499031596302367, -0.6499031596302367, 7.434927197683828, 7.434927197683828, 2.0217989182899743, 2.0217989182899743, 1.1363219321856468, 1.1363219321856468, 17.57520092200055, 17.57520092200055, 8.29629809754123, 8.29629809754123, 24.6657107528549, 24.6657107528549, 3.6750066815602658, 3.6750066815602658, -3.9124841905667354, -3.9124841905667354, 7.993872535946009, 7.993872535946009, 7.117910556651596, 7.117910556651596, 1.086343586669595, 1.086343586669595, -7.968013383867931, -7.968013383867931, 18.975838058578915, 18.975838058578915, -0.19910062310780285, -0.19910062310780285, -4.451386204152225, -4.451386204152225, 16.660117536013907, 16.660117536013907, -1.910972079821493, -1.910972079821493, 2.7867993424559936, 2.7867993424559936, 7.487524087712254, 7.487524087712254, -10.052307077588074, -10.052307077588074, 13.914772247164384, 13.914772247164384, 7.719378462208049, 7.719378462208049, 15.04569010282929, 15.04569010282929, 4.491731764064287, 4.491731764064287, 10.828226767181443, 10.828226767181443, 4.261160957129819, 4.261160957129819, -3.678570536503043, -3.678570536503043, 1.3113789642128864, 1.3113789642128864, -5.71676430157474, -5.71676430157474, 3.0905654313535784, 3.0905654313535784, 7.4508405188377465, 7.4508405188377465, 16.35885320102524, 16.35885320102524, 1.3287014529009054, 1.3287014529009054, 9.827783701595358, 9.827783701595358, 3.178135413574926, 3.178135413574926, -0.47681269848178076, -0.47681269848178076, 11.96440419658407, 11.96440419658407, 13.495055158270501, 13.495055158270501, 15.602545805105269, 15.602545805105269, 3.621356528711176, 3.621356528711176, -1.6100403822715763, -1.6100403822715763, -0.5567267719719518, -0.5567267719719518, 23.813216674976385, 23.813216674976385, 2.822042275070733, 2.822042275070733, -2.166685135962607, -2.166685135962607, 6.58384644674052, 6.58384644674052, 2.78927560019333, 2.78927560019333, 17.849089078458523, 17.849089078458523, 13.429381295086342, 13.429381295086342, 12.432522715828009, 12.432522715828009, -12.465907824738986, -12.465907824738986, -5.818380963213754, -5.818380963213754, 2.431984987839926, 2.431984987839926, -5.871327897206781, -5.871327897206781, 4.653273257826599, 4.653273257826599, 14.650792690874981, 14.650792690874981, 13.967194684093858, 13.967194684093858, -3.709215067709843, -3.709215067709843, 18.46071426822859, 18.46071426822859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27047423856123737, "mean_inference_ms": 2.019386657188484, "mean_action_processing_ms": 0.09239163809255381, "mean_env_wait_ms": 0.5547968744216818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 13500, "timesteps_this_iter": 0, "agent_timesteps_total": 40500, "timers": {"sample_time_ms": 11345.366, "sample_throughput": 297.478, "load_time_ms": 0.748, "load_throughput": 4512520.242, "learn_time_ms": 1673.034, "learn_throughput": 2017.293, "update_time_ms": 19.711}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 133.70076751708984, "policy_loss": -0.008248234260827303, "vf_loss": 133.7237106323242, "vf_explained_var": -0.01665966510772705, "kl": 0.0040914828619802845, "entropy": 1.5105766892433166, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 31.935679817199706, "policy_loss": -0.00919441469013691, "vf_loss": 31.959029960632325, "vf_explained_var": -0.06433485746383667, "kl": 0.006200485748834056, "entropy": 1.5395104587078094, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 13500, "num_agent_steps_sampled": 40500, "num_steps_trained": 13500, "num_agent_steps_trained": 40500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 4, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-23", "timestamp": 1706105423, "time_this_iter_s": 10.897071599960327, "time_total_s": 46.794975996017456, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E28940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 46.794975996017456, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.764285714285712, "ram_util_percent": 71.30714285714285, "gpu_util_percent0": 0.08142857142857143, "vram_util_percent0": 0.1953125}}
{"episode_reward_max": 22.649755680765725, "episode_reward_min": -35.5330650181941, "episode_reward_mean": -6.180012927487724, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -60.199819797677925, "policy_agent_": -12.999473029573878}, "policy_reward_max": {"policy_adversary_": -5.187991831198739, "policy_agent_": 41.42478773922185}, "policy_reward_mean": {"policy_adversary_": -19.308537943880957, "policy_agent_": 6.564262508196618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.534673169013384, -18.270658111732704, -20.651754126120935, -33.69882448313698, 4.007834908241627, 22.649755680765725, -1.8154092942584135, -1.9491592770594741, 0.8562576643287713, -1.3871503202210462, -2.2841713457940664, -9.246803241973536, -3.1796627761896854, -2.5893327877711396, -19.102661994181684, -0.35668489268023723, 0.30730450092236405, 17.618546438617535, 5.274639149933241, -10.722262869930804, -16.166284925984154, -10.966877857515732, -4.3287014898235485, -3.833102041448665, -29.923163671287178, -4.713833423870682, -1.3428024164630905, 15.350442516851233, -5.394681331862121, -1.1082273071871471, -0.6823199532977796, -16.403847638560222, 5.3051436978615865, -10.825303974688383, -1.3478252810447922, -21.844486397493423, -7.112493873680266, -10.96546929470177, 2.099947222366163, -5.572600118007638, 0.2653783234236755, -6.648293048185981, -16.101192407333457, -18.451777279004048, -10.068594313970458, -22.964913044572615, 9.282225988646285, -6.925643645724069, -15.367152547618257, -3.8971646121734946, -26.70992480512789, -0.49171992082923965, -14.498515160547583, 4.313732769683005, 0.28865367903626454, -8.375673787148946, -34.10443831739695, 2.9740383098456418, -33.97063297987689, -7.240332068766539, 17.79783771209863, 21.83071689340854, 4.050287292029417, -10.346918819863525, -14.45489944037358, -16.523062054944724, -6.6213842545689525, -11.38923500567795, -7.174790265978161, -22.724967028582316, -4.9625956065544425, -11.918241848265595, -0.46022861549105526, -13.304869071771869, -2.4122572522655727, 3.2728886076975714, -11.421651945791051, -20.320845661747793, 8.598307181973345, -8.012487381911283, 5.633423047880195, -0.30633369506688635, 19.89077428044612, 2.227426987324288, -10.04648221833101, 13.56381978055912, 5.982804782396479, 17.65394397763271, 6.9923583093133255, -35.5330650181941, -11.252556152823598, 1.2230197409423562, -5.186108636237493, -18.713837591238562, -10.571055322614061, -28.2632763736531, -20.014435508748296, -7.722833505769504, -19.81137909822908, -0.33860404170156366, 5.299636460659329, -27.241524548682985, -3.7640782325503523, -0.10146957215703584, -11.503735845359612, -7.017636796167501, 14.317241111766432, -14.668364552767713, -15.79295188139863, 1.5152682154694594, 2.298002207954243, -11.506085431904774, -17.612575156931662, -5.198462690053181, 7.911350724164344, 0.8384554545698075, -13.372793476463162, -10.188291639171982, -8.186808701648145, -11.156055956954448, -2.666462977523226, -23.673595967643518, -17.589145283627342, 5.694666808306119, -29.087536523327742, -5.433197367328955, 3.193388471235382, -11.133865548674676, 6.599334132696275, 6.544140412056596, -4.144750593175612, 14.42300425321867, 0.25946963595061145, 2.8044437059485854, -17.326668463899207], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.943570884869857, -5.658036279564521, -9.968565185024172, -25.486453364902488, -12.973543028005913, -60.199819797677925, -7.642442320847477, -31.469454563462033, -21.75346857617039, -17.221007503367243, -10.964619600550709, -12.95402317839623, -11.232064108076077, -16.21924168899185, -18.85091186940444, -15.567121532720149, -27.967498414394267, -40.75829457013427, -23.398865258757787, -10.41125670236476, -16.770692086051557, -9.255086008474427, -19.184650605917806, -16.835746452267045, -15.487857241595393, -14.688765923343993, -12.093032553287491, -24.955058669004035, -15.123375054991023, -23.70763105787364, -22.997561253108298, -18.539952813202827, -26.471878074205037, -7.98310335149236, -30.071038025213667, -15.063193447304098, -26.728456894809764, -13.517636320184277, -23.75231522010018, -18.854097243077565, -12.3842344381415, -23.51170723085841, -7.986342323379596, -14.524049081696184, -13.532426612037462, -18.570712357939005, -25.261983781240904, -25.192064529307775, -24.89826314265309, -12.24494381005007, -10.25603612465525, -17.842555532285946, -18.20847556881651, -20.423168959526787, -11.157700509845643, -10.259664228699588, -8.105492258249201, -17.413671424059594, -15.451275236091607, -14.547900635589901, -52.873880865030294, -32.77770070747, -15.662425554980869, -11.653049837981929, -12.10784421739464, -17.36029351307781, -12.73219076502654, -16.897252926732804, -18.831679912406727, -19.870976417358538, -10.227941853779319, -5.187991831198739, -21.3691182099403, -15.61560512611551, -8.663666130495248, -16.365064195015876, -23.52276512890086, -34.57987715666697, -23.814693084719455, -24.721737807102436, -27.997129628042607, -16.567566567282416, -37.22744153262658, -19.618370541048947, -10.31019063277499, -33.27190822449774, -32.44149848126394, -28.18429275288671, -24.827652327679054, -37.21069952288771, -15.50802397166526, -14.767048983723724, -12.479530296472674, -21.74952301511443, -33.945168901802454, -15.87615237797383, -7.471013466188524, -25.91604855049137, -7.405691160083385, -30.67810157768552, -19.9409825118868, -12.672292265665407, -22.561578369074294, -22.8857924227511, -14.714402945311026, -9.971683607302843, -33.063103617429235, -23.377343525259953, -23.950900146400492, -15.737553311086835, -28.281950835225494, -8.608374382080514, -19.653624514575498, -23.232480915040284, -16.621918933013035, -16.312038516804467, -21.623202444210115, -30.58137804119483, -19.747300385987007, -15.00500582118883, -11.395525466854346, -20.82348437755321, -11.221627437863232, -31.514698232174915, -14.963760825207014, -17.255730686432727, -18.066107030602915, -16.258852926842835, -24.61805967668484, -15.825046867409354, -21.495960634426115, -23.96595515275704, -13.567440016918537, -15.362118474200525, -11.992484844616099], "policy_policy_agent__reward": [-3.2955511420717585, -3.2955511420717585, -6.306310916084094, -6.306310916084094, -5.341594470548379, -5.341594470548379, -4.106185559117244, -4.106185559117244, 8.49068896812377, 8.49068896812377, 41.42478773922185, 41.42478773922185, 2.9135165132945313, 2.9135165132945313, 14.760147643201282, 14.760147643201282, 11.304863120249582, 11.304863120249582, 7.9169285915731, 7.9169285915731, 4.340224127378322, 4.340224127378322, 1.8536099682113452, 1.8536099682113452, 4.026200665943195, 4.026200665943195, 6.814954450610357, 6.814954450610357, -0.1258750623886178, -0.1258750623886178, 7.605218320019955, 7.605218320019955, 14.137401457658314, 14.137401457658314, 29.1884205043759, 29.1884205043759, 14.336752204345515, 14.336752204345515, -0.15550308378302297, -0.15550308378302297, 0.302203580033701, 0.302203580033701, -0.8558959245206503, -0.8558959245206503, 7.427974558047128, 7.427974558047128, 6.501322205409188, 6.501322205409188, -7.217653214845898, -7.217653214845898, 4.987466249736651, 4.987466249736651, 5.375115068412196, 5.375115068412196, 20.15275059292764, 20.15275059292764, 4.86434686156445, 4.86434686156445, 11.29970187534325, 11.29970187534325, 11.157620649905258, 11.157620649905258, 1.0680525873213014, 1.0680525873213014, 15.888510886033314, 15.888510886033314, -1.4211003115980136, -1.4211003115980136, 14.36160637208444, 14.36160637208444, -3.390646475094665, -3.390646475094665, 9.807981510564748, 9.807981510564748, 1.2760835127412564, 1.2760835127412564, 12.92613122123317, 12.92613122123317, 6.640748562534965, 6.640748562534965, 6.3248063807825865, 6.3248063807825865, 8.431707091336214, 8.431707091336214, -4.057425041976925, -4.057425041976925, -1.963864098653934, -1.963864098653934, 1.7319161490335042, 1.7319161490335042, -2.197100343316807, -2.197100343316807, 17.272104884943595, 17.272104884943595, 9.13321044179185, 9.13321044179185, 4.765555297517416, 4.765555297517416, 4.173889598938287, 4.173889598938287, -8.226944340236324, -8.226944340236324, 8.675417805728356, 8.675417805728356, 1.8549802041344585, 1.8549802041344585, 12.368450864604899, 12.368450864604899, 5.723177094440954, 5.723177094440954, 0.9419952207753204, 0.9419952207753204, -12.999473029573878, -12.999473029573878, 10.19385486695262, 10.19385486695262, -9.259678871892644, -9.259678871892644, 3.6537842834116763, 3.6537842834116763, 35.33585928856448, 35.33585928856448, 27.304208800439266, 27.304208800439266, 9.85635642350514, 9.85635642350514, 0.6530655090591984, 0.6530655090591984, -1.1735276114894715, -1.1735276114894715, 0.4186157290665449, 0.4186157290665449, 3.055403255228794, 3.055403255228794, 2.7540089605274294, 2.7540089605274294, 5.828444823214284, 5.828444823214284, -1.4269953056118894, -1.4269953056118894, 2.6326731236124368, 2.6326731236124368, -3.36512500853343, -3.36512500853343, 10.454444797224623, 10.454444797224623, 1.155368027171817, 1.155368027171817, 3.1257044391148376, 3.1257044391148376, 9.818976401356723, 9.818976401356723, 6.050556591554908, 6.050556591554908, 7.129515747459586, 7.129515747459586, 16.206500133346395, 16.206500133346395, 8.354625212595575, 8.354625212595575, 16.8152763379614, 16.8152763379614, 8.130616436107763, 8.130616436107763, 28.559107906536347, 28.559107906536347, 10.92289876418662, 10.92289876418662, 0.13185420722198998, 0.13185420722198998, 23.41786400252843, 23.41786400252843, 19.21215163183021, 19.21215163183021, 22.919118365259713, 22.919118365259713, 15.910005318496193, 15.910005318496193, 0.838817252346806, 0.838817252346806, 2.1277339094208267, 2.1277339094208267, 7.995034362333041, 7.995034362333041, 3.646710830117592, 3.646710830117592, 1.5178427119379307, 1.5178427119379307, 11.687056789594198, 11.687056789594198, -6.193561997839633, -6.193561997839633, -6.271711021279881, -6.271711021279881, 9.096607522360944, 9.096607522360944, -6.202843969072843, -6.202843969072843, 15.16974876799198, 15.16974876799198, 12.620309486273069, 12.620309486273069, -7.284616141508788, -7.284616141508788, 9.39875006826197, 9.39875006826197, 11.392161425297031, 11.392161425297031, 1.6053335499757049, 1.6053335499757049, 1.477023405567671, 1.477023405567671, 23.690172364597828, 23.690172364597828, 4.354489486246119, 4.354489486246119, 4.07897413250093, 4.07897413250093, 8.626410763278146, 8.626410763278146, 15.28997652158987, 15.28997652158987, -1.4488555249121302, -1.4488555249121302, 1.0205246788219164, 1.0205246788219164, 9.017009112493552, 9.017009112493552, 12.26663482858869, 12.26663482858869, 8.575246985687137, 8.575246985687137, 4.1252044838734765, 4.1252044838734765, 10.196543201011425, 10.196543201011425, 5.780245842169432, 5.780245842169432, 1.924474932117189, 1.924474932117189, 4.364531244665558, 4.364531244665558, -1.4250557950451535, -1.4250557950451535, -3.1837589228820597, -3.1837589228820597, 18.604682520240516, 18.604682520240516, -7.061887849060367, -7.061887849060367, 5.9112666595518855, 5.9112666595518855, 10.62974775091915, 10.62974775091915, 2.562493689084078, 2.562493689084078, 15.608696904690559, 15.608696904690559, 11.184593639732975, 11.184593639732975, 8.675605020625254, 8.675605020625254, 19.194479702987856, 19.194479702987856, 6.913454826434573, 6.913454826434573, 9.083281090074552, 9.083281090074552, -2.667091809641554, -2.667091809641554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26547469620567965, "mean_inference_ms": 1.9909464276478044, "mean_action_processing_ms": 0.09047041795627114, "mean_env_wait_ms": 0.5489231935187953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 16875, "timesteps_this_iter": 0, "agent_timesteps_total": 50625, "timers": {"sample_time_ms": 11277.368, "sample_throughput": 299.272, "load_time_ms": 0.798, "load_throughput": 4230656.306, "learn_time_ms": 1662.162, "learn_throughput": 2030.487, "update_time_ms": 19.558}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 116.31550903320313, "policy_loss": -0.0056962714545079505, "vf_loss": 116.33549346923829, "vf_explained_var": -0.003730034828186035, "kl": 0.007351591662696877, "entropy": 1.4653239965438842, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 30.84399471282959, "policy_loss": -0.0036593231372535227, "vf_loss": 30.860258197784425, "vf_explained_var": 0.023837757110595704, "kl": 0.01121817321708588, "entropy": 1.48483704328537, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16875, "num_agent_steps_sampled": 50625, "num_steps_trained": 16875, "num_agent_steps_trained": 50625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 675, "training_iteration": 5, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-34", "timestamp": 1706105434, "time_this_iter_s": 10.923680543899536, "time_total_s": 57.71865653991699, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E829D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 57.71865653991699, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.12142857142857, "ram_util_percent": 70.87142857142855, "gpu_util_percent0": 0.3207142857142857, "vram_util_percent0": 0.1953125}}
{"episode_reward_max": 17.905149307060576, "episode_reward_min": -47.74397827442506, "episode_reward_mean": -7.594661137291799, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -46.060159918607425, "policy_agent_": -18.130593226643885}, "policy_reward_max": {"policy_adversary_": -4.82495308677677, "policy_agent_": 23.4544813234219}, "policy_reward_mean": {"policy_adversary_": -17.42303249287982, "policy_agent_": 4.914185677794009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.359008194647675, -7.798319944049238, -7.285822167905508, -32.216886474790925, -1.728343294587256, -23.972833824863997, -5.486840190319612, -4.578645135496358, 7.107283270901031, -11.145787007428883, -2.2353617980675566, 17.905149307060576, -2.590186523450224, -7.929416429198351, -18.634702245391075, -13.595359887020848, 5.492393673399901, -2.237946513509991, 0.6296410577276702, 4.511610139356674, -4.231053283202095, -2.807026445741486, -11.103969830827545, -7.959245602454286, -12.594665464607363, -2.3166372703401055, 2.698283728056812, 2.0488560661009907, -0.5117667042615757, -5.49181183026651, -16.402298871109892, 0.47354170728953426, -6.479229288343102, 8.887664827844018, -18.487199985595442, 0.37021843393383624, 5.149257496344109, -15.74681192981915, -47.74397827442506, -10.486758528850151, 8.808456420451868, -2.2159286865070116, -12.70389143868652, -21.35969476706323, -5.125756316335139, -5.958413226140856, 0.016324131501729094, -15.503422601584985, -1.5319967281248466, 2.393628559221659, -5.245885666339148, 0.957541292541666, 4.738941352486265, -27.792559667508222, 3.8724980341113615, 8.81121760564691, -10.058566167838414, -2.69774633941576, -11.09053196203589, 0.8351182743617291, -29.94535339145465, -19.575141618683787, -5.5482900230251335, -24.435787782821414, -21.797892666227586, -7.854009282466588, 4.859792902351514, 8.905611099434966, -34.304785605710464, -11.391326676488672, -6.628382388254034, -0.4542366376697998, -17.41601198856232, -7.410552230208114, -1.842712936886259, 3.4377959799619213, -23.703447117638273, -20.078155455905186, -16.263471678864356, -0.10820597972528323, -14.352865114814598, -4.04669747899189, -30.0603596202948, 11.694058482162186, -9.71901460651983, 13.17238052054384, -17.782258281988668, -21.46031183749525, -22.479446618043188, 5.464053862315043, -19.09305549874285, -5.7807550095152855, -12.76873682309128, -2.000707597723564, -9.16730454047888, -5.80724320255594, -4.886020338677575, 0.6256726951700613, 0.33685009704826085, -26.427529130708336, -21.775442308244834, -7.033616983279086, -15.226242287748141, 15.611463115229201, -11.302252397420576, -13.012885479345071, 11.28534099948978, -13.562331994811624, -6.799598820327734, -20.792278295213666, -43.84570933868107, -10.727408354536903, -1.2829840953580218, -6.426125886489533, -6.093112328308586, -21.864836354640065, 8.038477796443932, -14.269199792790744, -14.40793566116739, -1.3909973501745734, 7.466673259177476, 5.719383706436927, -11.552575127442969, -8.045994707372087, -12.253589974940757, -5.782807882094601, -10.564517167573177, 7.870756262785854, -6.0648220225314535, 4.77921717872034, -12.239188841353473, -11.226175317538978, -5.443046959870292, 5.594291410346103, -23.830646882708265], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.965034652421178, -13.560490713092195, -11.194033894183569, -21.235122615174085, -18.54432731973599, -12.390340667106745, -11.930684017084237, -14.033010551080787, -33.296013396604174, -27.597264554865767, -16.509339267059865, -29.003813339783203, -13.38518975846971, -11.909710919127885, -8.054667761190961, -10.016324089190933, -17.424506546377316, -14.166608445242256, -22.172216838638228, -25.44932291865724, -15.26074557891453, -18.136514704225757, -9.558052049121837, -36.159076796265616, -6.827570004688098, -15.781799559222204, -21.325981947602163, -20.766751741598956, -19.944642861773364, -19.61877093747066, -11.3856380736072, -25.089140225063367, -5.753206232794826, -26.38475916050016, -40.83640570739973, -11.32428318811419, -16.045595703456566, -9.965784571424308, -27.854648276222054, -14.93595867938157, -22.853932138940056, -17.372296878546415, -11.306131034560664, -9.173177265486776, -14.072177115412885, -17.419694066592363, -9.193357357486564, -6.478407485994861, -12.091556392587192, -14.141279501650702, -23.320977874126342, -15.726919508021597, -34.48727980362535, -12.440231024563934, -14.795957952746098, -29.289327297124682, -17.036074443455973, -9.925632798934025, -14.616192070180102, -14.956123629928044, -11.258886323862736, -27.953840934849953, -12.099605088962162, -17.108032707277104, -8.706070916641867, -15.385543165654214, -24.259325191031536, -20.804238933558842, -7.72069459330767, -5.558039992017079, -23.004405115418855, -8.071660723047259, -33.45155997800011, -7.960916303117068, -11.425141991786889, -15.297938631577797, -4.82495308677677, -12.199114030787198, -9.46630281439188, -7.27158401238282, -16.12693707389274, -24.27063632894973, -33.29731224851184, -24.837251189915246, -7.402991044860533, -20.705894397302504, -18.382323874386888, -27.000361713775344, -12.236468935901687, -22.46664542215675, -20.287494908046526, -23.894257332773826, -5.591964132092722, -24.8601857268305, -6.434746905644197, -20.474574025826225, -23.965213109714924, -28.948616681574887, -17.790937651405812, -33.37984130281162, -9.045836077569264, -13.080723326206929, -11.134890695032645, -27.584351559983222, -10.333969018987021, -6.9309605316919125, -35.28622193186528, -11.155690172377076, -19.406413000704884, -46.060159918607425, -7.584522885393297, -16.878435526554025, -13.95695235796898, -29.453950270063952, -15.684263624928137, -9.078091959198858, -12.079520342462116, -16.058156682433044, -14.402358516137298, -26.092666696096277, -37.6475515227647, -17.214760635633958, -16.12560098232871, -14.70499565111521, -9.946180204409048, -13.327980100724316, -13.625973080990173, -25.685783387212116, -26.426945642068155, -17.97042509573581, -8.818269747140965, -10.004753743431142, -12.010141469384324, -18.675927004754563, -19.963380732098358], "policy_policy_agent__reward": [3.8030132288867504, 3.8030132288867504, 2.8810853845214797, 2.8810853845214797, 1.954105863139032, 1.954105863139032, -5.490881929808422, -5.490881929808422, 8.407992012574368, 8.407992012574368, -5.791246578878619, -5.791246578878619, 3.2219219133823134, 3.2219219133823134, 4.727182707792214, 4.727182707792214, 20.201648333752598, 20.201648333752598, 8.22573877371844, 8.22573877371844, 7.136988734496154, 7.136988734496154, 23.4544813234219, 23.4544813234219, 5.397501617509743, 5.397501617509743, 1.9901472449647646, 1.9901472449647646, -5.290017242100052, -5.290017242100052, -1.7895178989149565, -1.7895178989149565, 11.458450109888608, 11.458450109888608, 5.964330965866133, 5.964330965866133, 11.400928948182948, 11.400928948182948, 14.980466529006957, 14.980466529006957, 5.514846147856217, 5.514846147856217, 7.664744129242134, 7.664744129242134, -0.7729588908528509, -0.7729588908528509, 14.099915596905664, 14.099915596905664, -2.883547729959632, -2.883547729959632, 6.732581144441049, 6.732581144441049, 12.012132837829482, 12.012132837829482, 11.40780390384997, 11.40780390384997, 9.716438078755896, 9.716438078755896, 7.063479553602072, 7.063479553602072, -2.5083303987513474, -2.5083303987513474, 12.78134096617645, 12.78134096617645, -0.3630115277741374, -0.3630115277741374, 17.63621199417209, 17.63621199417209, 11.174602860902144, 11.174602860902144, 5.847250811024012, 5.847250811024012, 10.597426599900336, 10.597426599900336, -2.8905136791974213, -2.8905136791974213, -9.944664999101505, -9.944664999101505, 2.2246000752657107, 2.2246000752657107, 15.83119427969596, 15.83119427969596, 7.5781840960197036, 7.5781840960197036, -0.6988802020629262, -0.6988802020629262, -6.0932587507882205, -6.0932587507882205, 4.473210399538875, 4.473210399538875, 5.730640420225755, 5.730640420225755, 4.604840744494147, 4.604840744494147, -4.512507557795063, -4.512507557795063, 5.279779832231173, 5.279779832231173, 8.267454030436177, 8.267454030436177, 9.037546103893598, 9.037546103893598, 8.342230400281633, 8.342230400281633, 19.613110578055803, 19.613110578055803, -7.676164321472147, -7.676164321472147, 9.334227993428733, 9.334227993428733, 19.050272451385794, 19.050272451385794, 3.48875413780878, 3.48875413780878, 3.6139432297591325, 3.6139432297591325, 1.7628300540721054, 1.7628300540721054, 7.895620952144887, 7.895620952144887, -9.343233533795951, -9.343233533795951, 4.189349658083079, 4.189349658083079, 3.275657532968515, 3.275657532968515, -3.663877537772166, -3.663877537772166, -6.545910874792857, -6.545910874792857, 3.7657669415938124, 3.7657669415938124, 14.559559046691522, 14.559559046691522, 14.854925016496903, 14.854925016496903, -13.292045506201388, -13.292045506201388, -2.9166433422357936, -2.9166433422357936, 8.188011363582408, 8.188011363582408, 3.80871204268873, 3.80871204268873, 8.0177739947189, 8.0177739947189, 0.2751820364544765, 0.2751820364544765, 4.791214527450317, 4.791214527450317, 9.367867305769856, 9.367867305769856, -9.439247015430748, -9.439247015430748, -3.9395207125589917, -3.9395207125589917, -3.398584432236242, -3.398584432236242, 3.5816890163287685, 3.5816890163287685, 0.8870359795390743, 0.8870359795390743, 10.111969424978922, 10.111969424978922, 1.6184763141085163, 1.6184763141085163, 18.26565483603872, 18.26565483603872, -1.1580117808296453, -1.1580117808296453, 16.939137458923167, 16.939137458923167, 0.30003279619911477, 0.30003279619911477, 2.7700249381400446, 2.7700249381400446, -5.1214888410707475, -5.1214888410707475, 13.965349642235891, 13.965349642235891, 0.5972197046518359, 0.5972197046518359, 9.056751161629267, 9.056751161629267, -3.588386345499277, -3.588386345499277, 11.42973906455347, 11.42973906455347, -1.3662788174173441, -1.3662788174173441, 7.333665411635138, 7.333665411635138, 9.539596385518678, 9.539596385518678, 14.787144688372472, 14.787144688372472, 9.063893874227036, 9.063893874227036, 3.47615608605165, 3.47615608605165, -6.364803115337787, -6.364803115337787, 3.023553171463922, 3.023553171463922, -2.045675796357746, -2.045675796357746, 21.597907337606205, 21.597907337606205, -0.48414168921677647, -0.48414168921677647, -3.04096247382658, -3.04096247382658, 23.285781465677527, 23.285781465677527, -1.203320911217273, -1.203320911217273, 6.303407090188575, 6.303407090188575, 12.63394081169688, 12.63394081169688, -18.130593226643885, -18.130593226643885, 3.0755135860085616, 3.0755135860085616, 6.3369841313054796, 6.3369841313054796, 11.51391219178721, 11.51391219178721, 4.795575648309775, 4.795575648309775, -6.393372197720605, -6.393372197720605, 10.058999069453023, 10.058999069453023, 0.8944784448211459, 0.8944784448211459, -0.0027885725150445517, -0.0027885725150445517, 12.350834672960854, 12.350834672960854, 22.55711239097109, 22.55711239097109, 11.46707217103544, 11.46707217103544, 2.286512927442871, 2.286512927442871, 3.329500471871562, 3.329500471871562, -1.1537048852658505, -1.1537048852658505, 3.772586109314858, 3.772586109314858, 1.5307279567085001, 1.5307279567085001, 16.77826982499898, 16.77826982499898, 10.181061809768357, 10.181061809768357, 11.37482113722808, 11.37482113722808, -1.71045954710625, -1.71045954710625, -0.610710787053915, -0.610710787053915, 3.283547254757016, 3.283547254757016, 12.135109207550338, 12.135109207550338, -1.9336330753049444, -1.9336330753049444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2642866948366554, "mean_inference_ms": 1.974611081342199, "mean_action_processing_ms": 0.09089863967010517, "mean_env_wait_ms": 0.5458111153155444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 20250, "timesteps_this_iter": 0, "agent_timesteps_total": 60750, "timers": {"sample_time_ms": 11250.241, "sample_throughput": 299.994, "load_time_ms": 0.665, "load_throughput": 5076787.567, "learn_time_ms": 1677.853, "learn_throughput": 2011.499, "update_time_ms": 19.452}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 96.61506958007813, "policy_loss": 0.0024718749584280884, "vf_loss": 96.62655487060547, "vf_explained_var": -0.004944276809692383, "kl": 0.004867109829722403, "entropy": 1.4202015042304992, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 22.83905200958252, "policy_loss": -0.01453962353989482, "vf_loss": 22.866512393951417, "vf_explained_var": -0.06731780171394348, "kl": 0.008035244770245187, "entropy": 1.452720010280609, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20250, "num_agent_steps_sampled": 60750, "num_steps_trained": 20250, "num_agent_steps_trained": 60750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 810, "training_iteration": 6, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-46", "timestamp": 1706105446, "time_this_iter_s": 11.211104393005371, "time_total_s": 68.92976093292236, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D81A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 68.92976093292236, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.828571428571426, "ram_util_percent": 70.85714285714285, "gpu_util_percent0": 0.3378571428571429, "vram_util_percent0": 0.1961669921875}}
{"episode_reward_max": 21.773563392942425, "episode_reward_min": -25.030185302191665, "episode_reward_mean": -4.300777548876546, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -38.72424484314611, "policy_agent_": -7.545325453813039}, "policy_reward_max": {"policy_adversary_": -5.928538275830641, "policy_agent_": 28.495676783261658}, "policy_reward_mean": {"policy_adversary_": -18.050399148003102, "policy_agent_": 6.874810799563278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6921115832361435, -7.550647043424936, -2.20810534408032, -10.524561355870219, 0.10172167330756854, -3.6711002632419474, -14.973740150858475, 3.6690973852676243, -7.256873654142278, 0.5764970298219472, -7.085911166014028, -23.79130766231219, -25.030185302191665, 0.546937188607272, -0.6055129320680284, 0.9540216779676667, 5.366188084350011, 11.312249305901334, 0.710790435612061, -0.18590492177790252, -4.172388848266014, 7.809897934601443, -4.177764000429805, -1.2472957723474327, -3.6562327876057714, 7.292937307293265, -8.383188570656285, 6.35188362171313, 6.862963654010642, -15.501631790154114, -11.098806367995127, -1.651241934515116, 9.946527232708068, -8.458945214873376, -15.320239364930643, -4.03197537821409, -2.689560368430159, -7.8826402330842456, -13.603041136822073, -14.972865841244463, -0.1285436651422609, -4.375987159036843, 8.638941071144513, -13.255419504457517, -1.843140177196947, -10.700384342346053, 6.959868484886137, -8.521451278732545, -3.7322922182523834, 0.25048300572741933, 1.6755240178582262, 14.256274353857014, -10.457963485934922, -13.0651657221748, -16.023795376397967, -7.54626663219638, -7.275927037149186, 0.7550601183636284, -7.234245973751468, -8.547576654839993, 1.0224250337729537, -12.668731158055104, 5.519733460466168, -11.95750299147572, 5.106476194622719, -17.090818158987876, -10.943954183039617, -20.267203271771965, -8.052513834905039, -3.331269317586047, 9.721084754279854, 1.7231861961384323, -1.4913971904005345, -13.03809310351555, -1.0057635332792672, -8.071986221190631, -20.952831546387113, -0.05568897520244087, -9.185974887537258, -3.768475442895139, -11.282547077464574, -15.996275256114995, -13.270042682485641, -2.465290465088639, -10.915150577972872, 7.502377582320328, -16.05185321874006, -9.440772313863096, 18.53365481556645, 0.5620403802314531, -8.993495337187042, -10.200731681498056, -4.469435658574413, -24.63020540280474, -3.4133150882751107, -8.591966655157236, -20.989885493370803, -12.294593462488912, 2.7203172673907345, -4.665058263662508, 16.705132801895942, -0.9972784385838414, 0.18986464960473465, -12.801760499594952, 5.772245177128689, 11.359668844488738, -19.790166880550405, -8.472214460949724, 21.773563392942425, -14.651434647139851, -1.8305873092879303, 0.1492367730100761, -14.274972251972699, -3.370474848911811, -2.718188860630912, 4.3564362143261945, -18.534117796084015, -0.9785160164676411, -23.57130547712199, 4.091285861917717, 2.2593373230288627, 2.2046912565265817, 4.909330984184839, -2.2120850021084895, -6.930139110778291, -5.71664494550864, -13.877163560979938, -3.0361999480388016, 2.9425682765791827, -0.5701592749383091, 10.846734220659506, 8.700641703656828, -10.247400364557816, -1.1335276637112601, -6.299990987253113], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.267912613419718, -8.724746964315749, -23.124077148257097, -14.006321163783007, -23.232914582788524, -9.693666694135109, -27.266165598109573, -15.219223370607668, -10.425223666745326, -16.13910090232787, -13.307491105250048, -19.154721850286663, -9.939534394565579, -25.649748746417803, -13.23284084833266, -17.80948023268097, -14.8713005724799, -20.022811214847756, -14.774339022679422, -16.627202165273626, -12.642703958190031, -30.83287555588147, -26.37552754279219, -9.79248728648281, -13.634018708863406, -18.82682006490291, -11.261612345785963, -17.83588324943423, -24.58067596429483, -12.339055978436798, -9.54813278261591, -18.00312086616455, -23.325049806719175, -5.928538275830641, -10.556060189532236, -21.363588149160442, -10.99447869488271, -8.496495859150052, -19.9625227726075, -23.117113563558224, -19.16805927382356, -19.985520683826994, -17.73763624753212, -16.4063395078269, -26.48824578035148, -6.217158983737153, -21.627759891860887, -14.229394153630247, -16.404893643975864, -13.25131447676607, -20.977797734201474, -30.47758519896852, -21.830497210183445, -24.260523407539427, -20.961530754112147, -24.089658993373874, -29.83317463065235, -8.507970501401811, -16.4807063976603, -9.672141441847877, -14.8611785271845, -7.507735264391078, -35.219670396397596, -15.570005548850117, -16.986590084174836, -32.81871622374067, -15.81178604196189, -8.670019014734816, -19.977836432410626, -6.614951786160524, -19.67773103058766, -19.154357910640382, -17.13022880649822, -9.288552022468199, -31.20508892903965, -38.72424484314611, -7.731209011457246, -11.586184395602015, -10.472914008899734, -15.733547910956545, -11.413676082682466, -10.569936487819836, -12.108157009045602, -16.444903512188944, -13.20631117748738, -23.440254937319065, -22.045854869076123, -18.048780061441313, -29.66954549107304, -14.90229507549051, -22.111521965864764, -23.16036877307469, -8.265676780014676, -21.689200675879775, -20.632607561730165, -8.91601647930333, -22.595940451857057, -25.630854605901263, -12.544830524860894, -10.967059268412324, -28.820279413900906, -10.768080060441646, -14.422916391565197, -27.839653908707326, -24.115545139651147, -23.145858122710838, -12.993089473253386, -6.260379537668821, -35.21779017358089, -28.980957433990415, -22.58216285902969, -15.670752965867177, -10.15217800718338, -33.95659453334958, -12.332786137125915, -32.91161510973855, -16.12274918184845, -18.454017002537977, -14.444958924246379, -30.096174541155712, -15.687810393940353, -17.611602957076112, -31.29311994370843, -9.639508379993256, -9.006295450682359, -10.076919618920861, -20.894091411182597, -26.759930561271712, -24.576921077411683, -21.370579966749283, -19.054601376406538, -33.3848329003654, -12.4780638661205, -17.702183742895855, -8.359051050452093], "policy_policy_agent__reward": [7.98001209832793, 7.98001209832793, 0.5870499604454024, 0.5870499604454024, 10.457985902088385, 10.457985902088385, 1.7408799039563954, 1.7408799039563954, 11.66731812804804, 11.66731812804804, 3.0112832154465807, 3.0112832154465807, 6.146212723625553, 6.146212723625553, 9.444160377937642, 9.444160377937642, 1.5841750063015234, 1.5841750063015234, 8.357798966074908, 8.357798966074908, 3.110789969618009, 3.110789969618009, -2.318292906012762, -2.318292906012762, -7.545325453813039, -7.545325453813039, 13.098342967512544, 13.098342967512544, 6.313663958132318, 6.313663958132318, 9.381750955324312, 9.381750955324312, 10.118744328414955, 10.118744328414955, 15.667530260374546, 15.667530260374546, 7.742564729145739, 7.742564729145739, 8.220648621747863, 8.220648621747863, 4.23515755496201, 4.23515755496201, 19.321386745241455, 19.321386745241455, 11.098881771181192, 11.098881771181192, 4.2725957570676885, 4.2725957570676885, 4.988892960628815, 4.988892960628815, 13.059878686098081, 13.059878686098081, 1.4392118875648356, 1.4392118875648356, 12.093883435573678, 12.093883435573678, 15.721819809152741, 15.721819809152741, -1.581287905858663, -1.581287905858663, -0.7753367926896091, -0.7753367926896091, 8.175939465824719, 8.175939465824719, 16.63578851971362, 16.63578851971362, -1.265203469521368, -1.265203469521368, -2.3820895876992, -2.3820895876992, 8.665806385473177, 8.665806385473177, 4.152459163226274, 4.152459163226274, 0.3069278130329019, 0.3069278130329019, 3.1797408178927102, 3.1797408178927102, 4.072123861156884, 4.072123861156884, 9.519757804340651, 9.519757804340651, 7.804766762395077, 7.804766762395077, 13.188288659338316, 13.188288659338316, 1.5754600016846871, 1.5754600016846871, 12.322552801577267, 12.322552801577267, -2.2416126793044437, -2.2416126793044437, 14.29381418837351, 14.29381418837351, 2.85397143744885, 2.85397143744885, 6.336300712861742, 6.336300712861742, 6.750898741246745, 6.750898741246745, 11.32666087602985, 11.32666087602985, 22.366929776412768, 22.366929776412768, 5.6862668621242545, 5.6862668621242545, 5.59767884268231, 5.59767884268231, 2.4688676888570926, 2.4688676888570926, 8.27169618058875, 8.27169618058875, 11.278623796751589, 11.278623796751589, 4.631515309882721, 4.631515309882721, 4.6232302119544135, 4.6232302119544135, 0.5622823935039416, 0.5622823935039416, 7.941801780478722, 7.941801780478722, -2.580497946832015, -2.580497946832015, 20.369701928431887, 20.369701928431887, 1.8062512786872038, 1.8062512786872038, 11.046533139398782, 11.046533139398782, 7.863949032376396, 7.863949032376396, 2.433915929461136, 2.433915929461136, -5.79859212851858, -5.79859212851858, 5.962661298752794, 5.962661298752794, 1.6418412342872382, 1.6418412342872382, 14.699407892433756, 14.699407892433756, 10.43877205338941, 10.43877205338941, 7.8194158080488405, 7.8194158080488405, -1.8747705405236794, -1.8747705405236794, 15.09966269788019, 15.09966269788019, 15.32612931097774, 15.32612931097774, -6.6108112674649355, -6.6108112674649355, 5.7652477101997865, 5.7652477101997865, 0.6434695606812346, 0.6434695606812346, 5.982536234030703, 5.982536234030703, 0.06556450260894753, 0.06556450260894753, -2.7131693841475726, -2.7131693841475726, -0.5809428367200203, -0.5809428367200203, 6.989806523550151, 6.989806523550151, 1.145580299757253, 1.145580299757253, 15.471316259819698, 15.471316259819698, 2.9970008251680365, 2.9970008251680365, 4.304003873789109, 4.304003873789109, 24.101600153319755, 24.101600153319755, 7.732167727860981, 7.732167727860981, 6.5590133143388645, 6.5590133143388645, 6.479818545788316, 6.479818545788316, 1.8981205607201335, 1.8981205607201335, -1.4705023634624872, -1.4705023634624872, 8.609646236727533, 8.609646236727533, 0.16202491207304864, 0.16202491207304864, 0.8030274792431231, 0.8030274792431231, 6.668130571706176, 6.668130571706176, 7.6325738961258125, 7.6325738961258125, 3.151000502374913, 3.151000502374913, 22.76270610789842, 22.76270610789842, 4.8854008109289015, 4.8854008109289015, 7.3063905205849675, 7.3063905205849675, 7.518946704556186, 7.518946704556186, 14.943895158389916, 14.943895158389916, 17.25276348359979, 17.25276348359979, -3.3985387036485184, -3.3985387036485184, -1.1059174616404537, -1.1059174616404537, 28.495676783261658, 28.495676783261658, 7.164761393425283, 7.164761393425283, 10.375787774870885, 10.375787774870885, 7.909994869438628, 7.909994869438628, -2.0613971223946526, -2.0613971223946526, 15.29305984221889, 15.29305984221889, 4.8072986382475005, 4.8072986382475005, 18.634025662032375, 18.634025662032375, -1.2056843071177783, -1.2056843071177783, 8.737750493035167, 8.737750493035167, -4.563173276437793, -4.563173276437793, 17.09373020153672, 17.09373020153672, 8.973573858484608, 8.973573858484608, 9.90814710680135, 9.90814710680135, 18.101225463946633, 18.101225463946633, 3.713711688942385, 3.713711688942385, 1.0380781699520338, 1.0380781699520338, 2.1801373367061094, 2.1801373367061094, 3.5084639251013305, 3.5084639251013305, 11.861865306616458, 11.861865306616458, 13.759744676995435, 13.759744676995435, 10.400210345905487, 10.400210345905487, 14.950667798533019, 14.950667798533019, 21.042737302011123, 21.042737302011123, 1.1153317507813416, 1.1153317507813416, 8.284328039592296, 8.284328039592296, 1.0295300315994915, 1.0295300315994915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2704902057207063, "mean_inference_ms": 2.0368285436179114, "mean_action_processing_ms": 0.09393785834524288, "mean_env_wait_ms": 0.5609240438708742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 23625, "timesteps_this_iter": 0, "agent_timesteps_total": 70875, "timers": {"sample_time_ms": 11595.595, "sample_throughput": 291.059, "load_time_ms": 0.712, "load_throughput": 4737995.219, "learn_time_ms": 1696.754, "learn_throughput": 1989.092, "update_time_ms": 19.954}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 87.25646514892578, "policy_loss": -0.004951978172175586, "vf_loss": 87.27518692016602, "vf_explained_var": -0.02561999559402466, "kl": 0.004290850169491716, "entropy": 1.3879876971244811, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 18.837890720367433, "policy_loss": 0.003348411242404836, "vf_loss": 18.847884845733642, "vf_explained_var": -0.07672801613807678, "kl": 0.004926878795537698, "entropy": 1.4328089952468872, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 23625, "num_agent_steps_sampled": 70875, "num_steps_trained": 23625, "num_agent_steps_trained": 70875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 945, "training_iteration": 7, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-10-59", "timestamp": 1706105459, "time_this_iter_s": 13.675071477890015, "time_total_s": 82.60483241081238, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 82.60483241081238, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.31111111111111, "ram_util_percent": 71.61666666666666, "gpu_util_percent0": 0.08722222222222224, "vram_util_percent0": 0.1996799045138889}}
{"episode_reward_max": 14.04462186928092, "episode_reward_min": -37.443969249744406, "episode_reward_mean": -5.353599736351803, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -38.72744710355337, "policy_agent_": -15.286896535471122}, "policy_reward_max": {"policy_adversary_": -4.291006639319411, "policy_agent_": 24.899008977118882}, "policy_reward_mean": {"policy_adversary_": -15.771100422959808, "policy_agent_": 5.208750343304001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.82613034254761, -6.092333416676156, 6.237048556755618, -19.40988325887465, -7.633736630312325, 4.840900983180988, 2.4312194781703913, -24.456456559882465, -0.23968146713850264, 8.19628091354076, -7.618295653775501, -5.414278467196793, 1.3424206325728751, -5.774634120888967, -6.153775684813895, -18.771092537467137, 11.070570850684401, 3.4718715307271726, 3.413876736567449, 3.68838525912466, 1.2871807785729579, 14.04462186928092, -10.019152717292862, -37.443969249744406, -2.3312969950660882, -1.4527408824184818, 11.318056659397906, -5.939734508467724, -14.277351345925128, -7.237121108353038, -2.9541250209885472, -7.814419765947233, -3.3269759312934917, -3.154622053625082, -18.203363700653245, -7.708456028208497, -17.245318861136678, -3.0303788487465995, -2.2936312832918446, -3.093968533270372, -20.524709145765016, -8.574695230390045, 0.7862063740558811, 2.3893857807605117, -6.570627531363166, -14.837662139243088, -4.309197747340377, -10.720465754125284, 7.433129853331165, -5.59954682276696, -8.393558101437305, -10.283717441800993, 6.921941672030861, -4.821208553853868, -0.9947906786412193, -5.627750561372208, 0.39004832603128103, -18.968559052529354, 7.906666177609399, -6.418672351804788, -9.007266044310455, -6.438187346910073, -18.40779219563899, -35.12026681990073, 5.680536120213226, 1.6078727871295635, 5.886563401752729, -8.136641483132175, -7.1613190632210575, -7.693003420176745, -28.50902526906314, -5.551604707088593, -14.631320426534344, -17.51751984846111, -18.02203030977078, -7.538663983419871, -13.599816815113684, 13.79426781120469, -10.927891210375076, 1.5872778284277027, -10.134240880007596, -19.317984993459337, 0.7288561137769947, -0.5689289457647793, -2.5386292051419828, -8.544915202530923, 4.5256139658900505, -3.2146608858332573, -5.180964027596383, -17.326549301341036, 3.767543301510745, -9.514028937076802, -8.573436933085475, -6.967242430886488, -0.32321880974147743, -5.231515248932116, 3.8982544909296415, -2.1044671915147948, -3.970065032140245, -7.258530507448047, -13.597279801095336, -2.332351143929672, -8.755077163570538, 5.932058916983471, -11.702688944681276, -7.818505213662348, -0.8691335963951322, 2.060774514107039, 3.2413196071036428, -2.9778786622690494, -15.130445118943438, -11.12188499316654, -7.6298758938691105, 3.7964638223574823, -14.055399933082468, 2.9563842156563522, 5.30148276505642, -1.9067790795563273, 9.24410387455718, -11.731603490300305, 4.4226874132825635, -7.639505873869147, 0.03883202780252337, 0.3724281590759675, 13.779309936350014, 6.7387650409170785, -22.499907049112394, -20.483259991679695, 1.1040563562720918, 1.3109374447233129, -19.127461088891756, -13.419940367986749, -1.2350550577790516, -19.578037015212097, 4.523716286137875], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.324660946982604, -7.807992942237233, -19.258658177993023, -21.03383719375091, -17.17954419018821, -23.80154620942457, -11.520246699716509, -14.838332269171431, -11.752388426404703, -27.450813494289854, -12.260068853807237, -20.220709680697542, -19.35486088428169, -10.697254620317876, -12.079791450260098, -5.23953835423309, -38.72744710355337, -22.452549787409474, -19.55619088011461, -15.444482327751675, -11.6411776423941, -27.541051706137857, -14.183335552015057, -6.87017617880216, -17.778044309122837, -6.59908201827021, -22.13806737789169, -21.365028987416032, -11.263856353242716, -8.82731053642121, -8.889675351526657, -11.264241261590353, -13.29648005416572, -11.471406687494193, -4.291006639319411, -10.783236424823327, -4.627983052322072, -19.007885184453574, -12.655146670315863, -10.309597835876895, -19.566081882373187, -16.22286745666435, -13.110836042464218, -29.71862690508396, -8.546515798017474, -19.531908392493428, -16.615849943226873, -14.634227720445024, -18.541447256032193, -20.2563951178646, -14.305601909454644, -7.6426254268522325, -23.912115384591814, -14.838652549228705, -15.034449582203322, -15.847035175659448, -17.49702778399627, -18.685895993939763, -19.884707090215297, -14.224817432721443, -11.268370790034975, -8.298812749505034, -11.460912341999958, -19.42871552801978, -28.409175458565965, -9.184575400866978, -14.156007137585952, -17.237469804961417, -13.464983045565178, -32.97662236461449, -14.985673238868044, -8.991231669708416, -23.31807019779073, -18.878403379304785, -14.098636164517204, -13.478299569188488, -14.501627969231272, -23.931391415771632, -8.992475227970546, -15.169520197805477, -18.976572499356944, -6.7699800389762235, -13.171655669417342, -11.92402582685071, -7.356713369453936, -16.112929473338433, -15.947969096470967, -14.50615644860421, -21.516772213612956, -13.754401563222217, -17.337828356404973, -10.963179512332296, -18.175094911972334, -11.585824734676027, -9.96471126867755, -17.589990034465576, -19.183911697743977, -24.03583477307089, -8.616262902359722, -19.268301842978293, -10.16120594868621, -19.27151369424543, -5.631855011503894, -18.542934124699112, -27.66665445234107, -7.222105403452089, -12.665748977715646, -16.911311760629022, -14.106169147932874, -21.324259988124396, -4.868061354179981, -6.102782951698579, -17.878251083747603, -27.896709465469826, -30.020690941675664, -14.874143681686524, -15.749419564209486, -13.835975926861586, -22.041467641755318, -16.972393889042394, -20.095654316480616, -23.361809857509446, -23.61384086937203, -12.450873109920545, -26.073074335631752, -24.326751152794298, -10.02906650378944, -12.880898442759229, -9.641631156537906, -22.047062325980253, -15.730999090079036, -11.065426367415453, -7.824942120893621, -9.995795391248036, -17.805598003927784], "policy_policy_agent__reward": [-1.2507346977825033, -1.2507346977825033, 0.8578297627805385, 0.8578297627805385, 12.74785336737432, 12.74785336737432, 0.8119769674381282, 0.8119769674381282, 4.772903779937943, 4.772903779937943, 14.32122359630278, 14.32122359630278, 6.975733088943452, 6.975733088943452, -4.809062145355514, -4.809062145355514, 5.756353479633101, 5.756353479633101, 17.82354720391531, 17.82354720391531, 2.3208866000158666, 2.3208866000158666, 7.403215606750375, 7.403215606750375, 10.348640758427283, 10.348640758427283, 2.461310249714455, 2.461310249714455, 2.9630078827231032, 2.9630078827231032, -6.765777091617027, -6.765777091617027, 24.899008977118882, 24.899008977118882, 12.962210659068326, 12.962210659068326, 11.485033808341031, 11.485033808341031, 9.566433793438163, 9.566433793438163, 6.464179210483526, 6.464179210483526, 20.792836787709387, 20.792836787709387, 2.082091417361095, 2.082091417361095, -15.286896535471122, -15.286896535471122, 7.723373657028372, 7.723373657028372, 2.5731705679258647, 2.5731705679258647, 16.728062018644795, 16.728062018644795, 7.7126472394741565, 7.7126472394741565, -1.506747496341202, -1.506747496341202, 0.7950947140340862, 0.7950947140340862, 2.9677751652690554, 2.9677751652690554, 1.7249107478215604, 1.7249107478215604, 4.984752061436116, 4.984752061436116, 4.158392316934557, 4.158392316934557, -6.9561785306669215, -6.9561785306669215, 1.5373901983074159, 1.5373901983074159, -6.308667904407306, -6.308667904407306, 7.9887531678534875, 7.9887531678534875, 5.1807576935120085, 5.1807576935120085, 3.6078146513032605, 3.6078146513032605, -0.47931363169591, -0.47931363169591, 3.8240861131371475, 3.8240861131371475, 6.94852120826005, 6.94852120826005, 16.054006342922236, 16.054006342922236, 0.9879441333271515, 0.9879441333271515, 2.3471231266251698, 2.3471231266251698, 6.153326097943245, 6.153326097943245, 1.9568809831598708, 1.9568809831598708, 12.987288554681676, 12.987288554681676, 7.328424147548819, 7.328424147548819, 2.9560219040086717, 2.9560219040086717, -1.3205460074743787, -1.3205460074743787, 15.417028528311336, 15.417028528311336, 5.008721997687416, 5.008721997687416, 7.019829451781052, 7.019829451781052, 5.109642307143618, 5.109642307143618, 8.943538055013779, 8.943538055013779, -0.14133152929479287, -0.14133152929479287, 13.895686633912348, 13.895686633912348, 3.903072540458327, 3.903072540458327, 1.1305523728622624, 1.1305523728622624, 0.9303127012974783, 0.9303127012974783, -3.473439926819514, -3.473439926819514, -7.845775645940472, -7.845775645940472, 17.04485578938959, 17.04485578938959, 5.396224093998271, 5.396224093998271, 10.021285269669342, 10.021285269669342, 4.550414160914624, 4.550414160914624, 3.1518319911720587, 3.1518319911720587, 12.641809472218874, 12.641809472218874, -6.761676015097546, -6.761676015097546, 1.7198134813099102, 1.7198134813099102, 4.343374885628194, 4.343374885628194, 0.6804417654218414, 0.6804417654218414, -1.9616970726267737, -1.9616970726267737, 2.9698177928843057, 2.9698177928843057, 0.45090557705879514, 0.45090557705879514, 18.862829613488167, 18.862829613488167, -0.9677079912022629, -0.9677079912022629, 8.378399013116589, 8.378399013116589, 4.421165809674675, 4.421165809674675, -6.274002477241557, -6.274002477241557, 6.950255891597169, 6.950255891597169, 5.6775484405429655, 5.6775484405429655, 2.409042082155976, 2.409042082155976, 3.784007135403754, 3.784007135403754, 10.236791531180513, 10.236791531180513, 5.6457477813854755, 5.6457477813854755, 8.167904093008286, 8.167904093008286, -1.786073869059416, -1.786073869059416, 10.552685828957861, 10.552685828957861, 0.7245752876277483, 0.7245752876277483, 4.800828989443427, 4.800828989443427, 2.30929115189477, 2.30929115189477, 4.820746229468037, 4.820746229468037, 6.179237392766728, 6.179237392766728, 11.541083094336809, 11.541083094336809, 10.965683790778048, 10.965683790778048, 2.323098935109738, 2.323098935109738, 6.004885667765122, 6.004885667765122, -1.7180369262045652, -1.7180369262045652, 8.469581275157877, 8.469581275157877, -1.5616110760333242, -1.5616110760333242, 12.237496520841292, 12.237496520841292, 7.981982753829897, 7.981982753829897, -0.2981999051051294, -0.2981999051051294, 5.898307690660258, 5.898307690660258, 9.48604313736803, 9.48604313736803, 8.673744377518258, 8.673744377518258, 9.173190662927675, 9.173190662927675, -5.131191882381731, -5.131191882381731, -2.5095510207339795, -2.5095510207339795, 5.124187594939244, 5.124187594939244, 15.846586643913655, 15.846586643913655, 7.982645504296595, 7.982645504296595, 8.915263948671438, 8.915263948671438, 10.525451164632951, 10.525451164632951, 5.964598423652632, 5.964598423652632, 15.642785758156247, 15.642785758156247, 2.620395199371047, 2.620395199371047, 12.25917086488159, 12.25917086488159, 7.861151991820145, 7.861151991820145, 11.826336448587277, 11.826336448587277, 6.411650634498257, 6.411650634498257, 19.926192135990885, 19.926192135990885, 15.532758096855689, 15.532758096855689, -6.2354202726614725, -6.2354202726614725, -3.801180774460239, -3.801180774460239, 5.372843756404999, 5.372843756404999, 11.678999885351786, 11.678999885351786, -1.6982309994063576, -1.6982309994063576, -1.1772570002856528, -1.1772570002856528, 3.2949435315572844, 3.2949435315572844, -4.791120811982028, -4.791120811982028, 11.164657145032825, 11.164657145032825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2754492595338861, "mean_inference_ms": 2.0724950448821153, "mean_action_processing_ms": 0.09545681764277177, "mean_env_wait_ms": 0.5707677050041842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 27000, "timesteps_this_iter": 0, "agent_timesteps_total": 81000, "timers": {"sample_time_ms": 11818.373, "sample_throughput": 285.572, "load_time_ms": 0.623, "load_throughput": 5414851.678, "learn_time_ms": 1701.085, "learn_throughput": 1984.028, "update_time_ms": 19.825}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 66.8873664855957, "policy_loss": 0.004394547146512195, "vf_loss": 66.89661865234375, "vf_explained_var": -0.06930320262908936, "kl": 0.004302183977266808, "entropy": 1.3700856924057008, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 14.726210117340088, "policy_loss": -0.011960479244589806, "vf_loss": 14.751284170150758, "vf_explained_var": -0.06324570775032043, "kl": 0.008154677786392566, "entropy": 1.3929386675357818, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 27000, "num_agent_steps_sampled": 81000, "num_steps_trained": 27000, "num_agent_steps_trained": 81000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 8, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-11-13", "timestamp": 1706105473, "time_this_iter_s": 13.239599704742432, "time_total_s": 95.84443211555481, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 95.84443211555481, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.15294117647059, "ram_util_percent": 72.50588235294119, "gpu_util_percent0": 0.04294117647058823, "vram_util_percent0": 0.20164579503676472}}
{"episode_reward_max": 15.458170814678239, "episode_reward_min": -34.21291775143886, "episode_reward_mean": -2.4501757847714036, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.864243613582744, "policy_agent_": -9.603542124841553}, "policy_reward_max": {"policy_adversary_": -5.042632503130976, "policy_agent_": 24.114079872684172}, "policy_reward_mean": {"policy_adversary_": -16.973786103609402, "policy_agent_": 7.261805159418997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.925345014958652, 0.23657442157294672, -8.965791542551216, -2.5174275898386815, 2.376258289136209, 1.0053683373116558, -12.204186819739913, 1.1131970180647583, -5.651721646016213, 3.042533018522804, -1.6359920756933466, -6.014415436479491, 1.2826889173709906, -5.3765549640385055, -0.1686543148105129, 0.5651258050612789, -5.162602288397033, -1.4036898664669386, -18.501651073011747, 5.9239119989024855, -2.577248993676726, -3.933259077295321, 2.6168144691368815, 8.533138225304704, -0.8834072945802699, -7.792441893265881, -3.3682466128038575, -3.3667080922317036, -5.62235359067129, -1.8022079315968123, 2.140020806242645, 7.066970229849522, -15.836476774709887, -20.91638428849113, 3.058391296072514, 7.256851673722143, 4.748864542255308, -3.254138659432144, 15.458170814678239, -11.182392794348344, -1.7310210828294101, -12.763268440236473, 7.139270775225945, -2.244760870014697, -10.57818775326033, 11.151488699494967, -5.227510069496612, -34.21291775143886, 7.239364896774238, 1.5415524767412085, 8.704461733619235, -4.536228114187517, -4.138014097197511, -15.821867472185048, -13.565337134017186, 0.5879257462997483, 6.2331108363462455, -3.230681676833424, -7.301804010356065, 5.692014186034289, -6.54237178410879, -0.6355304065763814, -6.52979741593495, -4.0307269853534216, 1.6250926865701705, -8.005447359038467, -5.557597239661439, -6.8086507449756315, 9.047795711918075, 3.7775046338084928, -9.805420497540538, 3.1422187967471578, 4.784067371996612, -8.572605746426584, 1.7458030866822258, 0.3420611407228539, 2.9017121734216227, 8.11395137744614, -5.159022852982963, -6.9253469663702045, 4.481096517361933, 0.23156411280375067, -14.402092820087987, 14.470725933122418, 3.0669384497219, -5.500666025534503, -5.749691169160473, -10.848333868438205, -4.783698346527967, -8.731868529020943, 0.34081829217701687, 1.0541261811393556, 5.942474533759959, -4.78907412745296, 0.7133010636180991, -25.12685260869817, -10.24340156399754, -1.955925624951687, -17.379726379641244, 2.1204954741847843, -10.368636622690959, 7.6716164848443995, -4.833352898642406, -5.42523743682743, -3.2600770883995382, 8.956987758187504, -8.446224257525785, -2.490089423489423, -4.426706180256468, -17.527189409494216, -8.404344560226082, 2.1958529399976223, 8.75032142981604, 0.04875939534088569, -23.981151311518467, -0.788889117006109, -5.801761646648979, -5.524448953068976, -3.884021830552494, -2.716859768051213, 7.905540480477936, -6.94602316839591, -3.4060004828669883, -9.094970456963031, 7.152791489481741, -15.616995123759015, -3.397262386562256, 4.008848046962111, 2.0993136447085154, 6.018176583588144, 8.154062542697682, 5.072209889179775, -8.572186187921657, 10.925554265568497, -3.789098195344093], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.86021259523416, -10.024427400097927, -14.74713660639465, -5.912845117539938, -14.2970706909724, -10.952594827856023, -27.41552354901385, -18.906046896653887, -7.403227804575487, -17.775524698629177, -13.612730506975106, -12.237501755220327, -13.763550939853225, -21.939088976677276, -11.856697366622484, -12.12075811536268, -22.009167962247997, -13.382150249572067, -11.626755333487196, -17.087814986759515, -11.711456310793618, -16.974050761912796, -18.533519975427165, -19.120559599642696, -14.020992436180254, -10.273194207180454, -9.188804230548659, -9.346848953862354, -16.04545674641504, -16.74445723617665, -11.120514890323747, -16.91242884553132, -17.150899319773572, -31.028361646521514, -19.235802364083995, -25.175917107012108, -35.04431537245436, -9.072857049607753, -26.09813122106613, -13.85938596156331, -9.20941186199417, -19.58081690370336, -20.84832134585544, -13.986608480710817, -17.709302112542726, -22.493932212540646, -11.850866064860792, -15.005833501755758, -16.713152529694053, -20.069865269897665, -18.236604802387898, -19.39821608527315, -10.696600610437878, -24.71623328660185, -18.024452894883584, -23.2715714812092, -13.487134046537506, -11.665981779939354, -7.694762186082986, -25.482313049891463, -23.531695241681057, -14.070559892355169, -9.08299444585324, -7.227567218730993, -23.020115473131856, -11.945710564874165, -9.097796812113936, -36.864243613582744, -20.732677111594995, -15.910893256284881, -8.972212706289174, -10.276129909812964, -23.36607908160184, -29.875612706774415, -15.209957622014512, -33.06676168513287, -11.05206295966809, -24.176383486683417, -20.272231669906347, -16.092696660889906, -14.656399318053678, -13.893225154967748, -11.97988540920287, -33.75743381224593, -32.18314706198804, -6.842398786199401, -19.240226220991588, -24.539779663270938, -14.96254635599997, -14.877006025795309, -21.290330691952388, -12.196816992603017, -17.05865997891605, -24.410135315636566, -15.811424371487464, -12.371231265248216, -27.92584507868503, -10.230209259459835, -5.782762814665194, -11.67729303734759, -5.042632503130976, -22.69087696455636, -8.677244568781811, -9.729757609168203, -33.81844421929755, -14.975054457670288, -8.735761001702997, -9.552260096116974, -19.377287376343766, -9.84603437357642, -5.844367717622835, -21.152895401627678, -24.104217386025866, -12.796477950275927, -17.14796171074636, -18.72441458623673, -7.178077664447645, -18.02157696882405, -15.100490216126406, -30.926467982811644, -23.109622420474885, -18.758539058980016, -10.94142683753006, -23.523721851148096, -16.053106975124024, -11.872649569720318, -11.252282747829186, -24.935350692893223, -31.541513046774416, -15.872880531743894, -20.182720766410014, -18.57176336409925, -13.103577114257416, -26.57072440920223, -20.46704398967484], "policy_policy_agent__reward": [12.892778805096407, 12.892778805096407, 5.130500910835437, 5.130500910835437, 2.890672531921717, 2.890672531921717, 1.697708763850628, 1.697708763850628, 8.336664490054307, 8.336664490054307, 5.978981582583844, 5.978981582583844, 7.605668364636973, 7.605668364636973, 10.00962195735932, 10.00962195735932, 0.8757530792796371, 0.8757530792796371, 10.409028858575988, 10.409028858575988, 5.98836921564088, 5.98836921564088, 3.1115431593704157, 3.1115431593704157, 7.523119928612107, 7.523119928612107, 8.281267006319384, 8.281267006319384, 5.844021525905985, 5.844021525905985, 6.342941960211979, 6.342941960211979, 8.423282836925482, 8.423282836925482, 5.989230191552563, 5.989230191552563, -3.437447869762277, -3.437447869762277, 11.505863492831, 11.505863492831, 4.567103658558447, 4.567103658558447, 6.520395842308737, 6.520395842308737, 10.575167222282024, 10.575167222282024, 13.8268489124737, 13.8268489124737, 6.568792570799989, 6.568792570799989, 1.2403761569572862, 1.2403761569572862, 2.910278808872398, 2.910278808872398, 2.9900704308153245, 2.9900704308153245, 5.211551577871878, 5.211551577871878, 7.471124652289919, 7.471124652289919, 6.630267848283195, 6.630267848283195, 11.989699537690418, 11.989699537690418, 0.6572112725318378, 0.6572112725318378, 5.055988679015192, 5.055988679015192, 11.147096830078254, 11.147096830078254, 16.216384390367125, 16.216384390367125, 19.896589957354838, 19.896589957354838, 2.909359195087802, 2.909359195087802, 20.778151017872183, 20.778151017872183, 1.3384965836074818, 1.3384965836074818, 3.7391953895823815, 3.7391953895823815, 3.408774231733442, 3.408774231733442, 13.993796060540694, 13.993796060540694, 5.870923805348059, 5.870923805348059, 3.565557179641197, 3.565557179641197, 16.822710456017806, 16.822710456017806, 3.3116779976820867, 3.3116779976820867, -9.603542124841553, -9.603542124841553, 11.976258713234145, 11.976258713234145, 10.805708873319436, 10.805708873319436, 13.470533268003567, 13.470533268003567, 7.430993985542817, 7.430993985542817, 3.2792932566201825, 3.2792932566201825, 4.447182907208398, 4.447182907208398, 2.229557880433203, 2.229557880433203, 11.929748613754473, 11.929748613754473, 9.860122441441877, 9.860122441441877, 4.2176500515529645, 4.2176500515529645, 0.19647908786346, 0.19647908786346, 15.587163617962872, 15.587163617962872, 8.49466172878614, 8.49466172878614, 6.717514742889392, 6.717514742889392, 1.2765985149591452, 1.2765985149591452, 1.5984201166887855, 1.5984201166887855, 12.322604079851011, 12.322604079851011, 1.9701316029178502, 1.9701316029178502, 1.7700997862262469, 1.7700997862262469, 15.027796434303559, 15.027796434303559, 14.890236411756536, 14.890236411756536, 9.844198945046688, 9.844198945046688, -0.41660389562568334, -0.41660389562568334, 6.70917435328006, 6.70917435328006, 14.075073226799223, 14.075073226799223, 10.651503480173915, 10.651503480173915, 8.477880354348368, 8.477880354348368, 16.704411412927865, 16.704411412927865, 6.976887566544857, 6.976887566544857, 16.14516743206478, 16.14516743206478, 7.556604408461695, 7.556604408461695, 4.58367484725985, 4.58367484725985, 9.568747917707803, 9.568747917707803, 7.062394633885749, 7.062394633885749, -1.2111037054425602, -1.2111037054425602, 24.114079872684172, 24.114079872684172, 17.62504275585497, 17.62504275585497, 0.6708663803324468, 0.6708663803324468, 6.745267525915556, 6.745267525915556, 6.845722897416367, 6.845722897416367, 5.089424004736003, 5.089424004736003, 3.0725687483871855, 3.0725687483871855, 10.815574492064702, 10.815574492064702, 6.625471586871187, 6.625471586871187, 11.500567256338005, 11.500567256338005, 9.810530594091802, 9.810530594091802, 8.262362717552781, 8.262362717552781, -6.377810671724985, -6.377810671724985, 8.841221757343742, 8.841221757343742, 4.137141817254075, 4.137141817254075, -5.798481782488027, -5.798481782488027, 6.898894255766187, 6.898894255766187, -2.6630020597799957, -2.6630020597799957, 15.181246724700383, 15.181246724700383, 1.9219458350697025, 1.9219458350697025, 2.152260086170387, 2.152260086170387, 15.279183565449001, 15.279183565449001, 11.966021107928894, 11.966021107928894, 0.1447683720886057, 0.1447683720886057, 3.531085336313777, 3.531085336313777, 7.475290598043649, 7.475290598043649, -3.8405775179589003, -3.8405775179589003, -1.2799884213016246, -1.2799884213016246, 11.674374170812651, 11.674374170812651, 16.42726940792095, 16.42726940792095, 6.422618672808406, 6.422618672808406, -3.4165948003860627, -3.4165948003860627, 8.967762734615311, 8.967762734615311, 0.6881580088993314, 0.6881580088993314, 6.248564007877536, 6.248564007877536, 5.608234192786957, 5.608234192786957, 14.104804107380211, 14.104804107380211, 15.50758145047641, 15.50758145047641, 5.906257945292054, 5.906257945292054, 3.767713177331537, 3.767713177331537, 7.214375697092533, 7.214375697092533, 11.602949232302887, 11.602949232302887, -1.8721727770193484, -1.8721727770193484, 3.927510180633463, 3.927510180633463, 14.472099369927669, 14.472099369927669, 16.820413345741457, 16.820413345741457, 10.945528557666018, 10.945528557666018, 14.168391654553849, 14.168391654553849, 11.821986626639516, 11.821986626639516, 2.26569546316788, 2.26569546316788, 18.748139337385375, 18.748139337385375, 8.338972897165368, 8.338972897165368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2772629088386226, "mean_inference_ms": 2.0812534309802024, "mean_action_processing_ms": 0.09625163782641034, "mean_env_wait_ms": 0.5731629173400342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 30375, "timesteps_this_iter": 0, "agent_timesteps_total": 91125, "timers": {"sample_time_ms": 11891.9, "sample_throughput": 283.807, "load_time_ms": 0.554, "load_throughput": 6091708.138, "learn_time_ms": 1698.133, "learn_throughput": 1987.477, "update_time_ms": 19.842}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 71.97192840576172, "policy_loss": -0.029669901169836522, "vf_loss": 72.01490707397461, "vf_explained_var": -0.0958480715751648, "kl": 0.005458705909991357, "entropy": 1.3344361424446105, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 15.145022964477539, "policy_loss": 0.02661740668118, "vf_loss": 15.13182544708252, "vf_explained_var": -0.07256020903587342, "kl": 0.005736042915296527, "entropy": 1.3993418991565705, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30375, "num_agent_steps_sampled": 91125, "num_steps_trained": 30375, "num_agent_steps_trained": 91125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1215, "training_iteration": 9, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-11-25", "timestamp": 1706105485, "time_this_iter_s": 12.375261306762695, "time_total_s": 108.2196934223175, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4DDDF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 108.2196934223175, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.56875, "ram_util_percent": 72.54375, "gpu_util_percent0": 0.048125, "vram_util_percent0": 0.20751953125}}
{"episode_reward_max": 14.506820717092381, "episode_reward_min": -23.89909956472837, "episode_reward_mean": -3.0729122435909657, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -38.97765815341984, "policy_agent_": -9.023169461061991}, "policy_reward_max": {"policy_adversary_": -4.800342828978357, "policy_agent_": 26.74223943525611}, "policy_reward_mean": {"policy_adversary_": -15.964737035305161, "policy_agent_": 6.445912395857099}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5673663090893006, -0.32450366067100656, -4.566253196556859, -11.96287432245702, -3.667388798543736, 5.8520334841924635, -0.3726837997185115, -2.19443175976211, -0.26998973375686436, -9.365759490799146, -2.049181118854377, 5.758064431134585, 2.7045048042986917, 1.9021068353686215, 2.918722593562281, 14.506820717092381, 3.5243464385652112, -0.7421213998268086, -3.086097464819903, -4.855721238667781, -6.205219787881955, -3.085329279198148, -7.775301844014246, -8.95103827484701, -23.89909956472837, -18.067453082805574, -7.433529516367818, -0.6885477926182519, -4.721762300900827, -2.3101109230150296, 9.655865198987716, -3.852171683583373, -1.6571160463105246, -5.660036363527408, 5.181467647540852, 5.665879634871722, -4.070622803587266, -2.2781104967143744, 3.8617107199445315, 3.121297599900437, -17.018895206953815, -0.08576832546172225, -9.615985707703315, -0.7718874542334027, -5.094720624528594, -0.09903516200568133, -15.799818168563602, -3.3588696117975054, 8.699653280100561, 4.306719969201137, -12.837559449602631, 0.0068617448066202735, -5.164269018388488, 5.0376340233817345, -0.9777357144920493, -12.877414977967652, 3.8677211945279, -12.10349023109002, -13.36267682494836, -14.188067117730634, -15.44029526311284, 2.5729820984417153, -10.368505236471174, -0.06960773509519735, 2.7837033336653256, -11.775830770764419, -0.17184007877601415, -9.104761122867135, 8.285305056771636, -0.5157874756148808, 7.615650530944359, -3.375508770265789, -3.3613422664877795, -2.755690997605279, 1.2125402491949937, 9.706719628622858, -16.575555658588385, 1.3498580261392679, -6.809292763951968, 1.048097700480105, -10.81188625942419, -0.4822331086892593, -7.333907728258973, -18.975259658041377, -2.342395764463293, -0.4011260295683048, -7.8101402649965, 0.7509532852618461, -3.214654206225184, -11.66012874763278, -3.8158204186895945, 4.480147007986191, -3.270767272869716, 3.809425283911152, -8.916116171421175, 1.216840183424523, 1.1664582580081135, -14.084129579605492, -4.288645353456548, -0.6189587114380055, -13.810110016135345, 0.13417589966885057, 1.3033161052165325, -1.0068051665486877, 1.124813611981657, 0.20965549184173088, -0.08608421056204552, -5.878871623433908, 6.303878656254771, -10.256282574906892, -11.713083338055043, 0.36991764504239977, -11.59622269905807, -7.270191623303125, 10.802110653822249, 10.30554643681659, -2.5388293536064994, -12.209017386707416, 0.6469546576024037, 0.28090043175722823, -3.4860630366160157, 8.616564678188384, -2.286412106995959, 1.2081912462154618, -0.7141253481218199, -4.811669572715474, -1.5546261697931083, -14.282442072630165, 1.0274167344525027, -6.527954985306224, -9.039487380783122, 2.847454683767916, -4.438986222271355, -23.418996425225735, -3.416409019668869], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.818731839880687, -17.95367607878014, -15.708856288207125, -14.294071664372359, -18.081408566062454, -16.58469421610965, -10.281501623875767, -10.241242415794815, -12.315530208232943, -17.009101421940763, -12.999423319964896, -15.872372494993932, -11.904350571597092, -16.363237396062193, -28.765373924222494, -38.97765815341984, -28.660084182320485, -30.860176972375097, -22.49888186439351, -9.257684649783773, -11.538170055236419, -16.529907595669428, -8.218878630028623, -17.279550713478137, -21.198684180357, -12.510899720747373, -17.45397308059638, -11.377245988871238, -24.510798429605984, -34.905798623575464, -24.50849320147265, -13.597143423205312, -13.90269832835364, -16.581348515783375, -15.356973346869598, -12.587272266433711, -6.445959896075297, -10.295595619618123, -23.116018655056557, -9.755220322523332, -20.014332662484616, -16.74185160414537, -10.378945274611713, -18.545562190104967, -21.905085772393907, -11.07468075309561, -4.800342828978357, -6.588897343692518, -22.596137573207244, -14.834736236637, -14.481583952265199, -17.345280995176044, -14.628191526385034, -22.79363372294773, -15.799261687950422, -21.474929971994616, -19.37162542879777, -14.38394610807913, -15.284448480736222, -10.68319317933638, -7.872525124714219, -11.061337345053262, -8.578152076523425, -19.360153997434296, -14.177990331918263, -7.397357116251296, -13.322487109701203, -15.515524833973464, -17.31366107945929, -18.983611884003004, -26.53163494167723, -20.046034562023898, -14.105753090738567, -11.8290413519905, -17.153235406500396, -22.906485079508666, -23.688374029704278, -19.141119337082827, -29.54053044695063, -9.61064255019161, -12.08560169578483, -9.617167205758301, -12.695633640231199, -19.349660744989492, -7.634850218214331, -9.163420244538816, -11.731636848579102, -11.630342982739872, -9.450117721533989, -9.410920900357082, -16.948718483101082, -18.829943632086046, -10.729665048161444, -12.518651404274475, -11.2210298234226, -8.853198655546976, -21.427743287094984, -15.937983113991276, -27.71418188074657, -13.78010152735538, -17.76280712083673, -9.666745576928582, -12.317681034835175, -15.64196932528339, -17.205084673523277, -10.203350761047519, -17.47105277808707, -18.39439801745365, -28.50011017869131, -17.945202677260237, -11.387787347242003, -10.836900988887217, -10.209160479470649, -11.46940727381356, -21.473494395758383, -22.65789370176116, -9.573196389294013, -6.1418260302317, -20.266707275068086, -23.042230191003, -8.167658903145671, -23.780909073150223, -10.756035664095313, -24.006126699128167, -17.114139259000105, -5.244262088667141, -23.485470915033606, -20.342718620092995, -12.646664933305143, -15.781577372744009, -11.781151128947988, -21.983225634366867, -32.725242621741536, -5.372657503101747, -10.173076640324194], "policy_policy_agent__reward": [10.193049074484993, 10.193049074484993, 8.814586209054568, 8.814586209054568, 5.571301545825134, 5.571301545825134, 1.1655986709576678, 1.1655986709576678, 7.207009883759359, 7.207009883759359, 11.218363850151054, 11.218363850151054, 4.95440891207863, 4.95440891207863, 4.02340532801635, 4.02340532801635, 6.022770237238042, 6.022770237238042, 3.8216709655708065, 3.8216709655708065, 5.475121100555259, 5.475121100555259, 10.815218463064262, 10.815218463064262, 7.304427687947894, 7.304427687947894, 9.132672115715405, 9.132672115715405, 15.842048258892389, 15.842048258892389, 26.74223943525611, 26.74223943525611, 16.09221531044285, 16.09221531044285, 15.059027786274148, 15.059027786274148, 9.706392199786803, 9.706392199786803, 2.2009817055579957, 2.2009817055579957, 2.6664751336772348, 2.6664751336772348, 6.7222891582356405, 6.7222891582356405, 0.22178839300718917, 0.22178839300718917, 4.164256219315564, 4.164256219315564, -1.3502076921856823, -1.3502076921856823, -2.778276681029096, -2.778276681029096, 5.010221782114284, 5.010221782114284, 5.34434909812649, 5.34434909812649, 9.894518064352578, 9.894518064352578, 16.297843850280216, 16.297843850280216, 17.082179200230183, 17.082179200230183, 4.872485869810971, 4.872485869810971, 6.122791141021559, 6.122791141021559, 5.460656076127982, 5.460656076127982, 10.269220497205225, 10.269220497205225, 9.126575950652718, 9.126575950652718, 1.1876685462440146, 1.1876685462440146, 4.008742561451874, 4.008742561451874, 13.488864687500548, 13.488864687500548, 6.438258961211885, 6.438258961211885, 1.4977187277654047, 1.4977187277654047, 8.328041639341825, 8.328041639341825, 0.3814797834541974, 0.3814797834541974, 8.886837367935781, 8.886837367935781, 8.40518257393266, 8.40518257393266, 5.4878227955449645, 5.4878227955449645, -5.4997376697926175, -5.4997376697926175, 1.6150138659475077, 1.6150138659475077, 15.647895426653907, 15.647895426653907, 9.570728102919066, 9.570728102919066, 0.8220122513312844, 0.8220122513312844, 8.676071369991332, 8.676071369991332, 4.731961253998272, 4.731961253998272, 13.915633873164737, 13.915633873164737, 7.410762986729187, 7.410762986729187, 4.298757497013482, 4.298757497013482, 11.619673311662835, 11.619673311662835, 1.140227938494554, 1.140227938494554, 0.9608858278939313, 0.9608858278939313, -1.7524369691971278, -1.7524369691971278, -3.7838850691993136, -3.7838850691993136, 6.817159721747489, 6.817159721747489, -0.8951765799738702, -0.8951765799738702, 9.645273131169551, 9.645273131169551, 8.480846832791794, 8.480846832791794, -2.1892368272565617, -2.1892368272565617, 6.5753235154625935, 6.5753235154625935, 3.2053818555531626, 3.2053818555531626, 12.799483068115462, 12.799483068115462, 9.233912204194064, 9.233912204194064, 17.07364273631079, 17.07364273631079, 8.335262895879051, 8.335262895879051, 5.372205412125393, 5.372205412125393, 4.5366751771926115, 4.5366751771926115, 9.182887827847695, 9.182887827847695, 16.306602354065763, 16.306602354065763, 3.556409185557943, 3.556409185557943, 10.245488681611048, 10.245488681611048, 11.36561884149933, 11.36561884149933, 5.329370125335855, 5.329370125335855, 0.6368577181803158, 0.6368577181803158, 4.567467048534521, 4.567467048534521, 2.6808629559861155, 2.6808629559861155, 0.18720054347406118, 0.18720054347406118, 2.6462272268755185, 2.6462272268755185, 4.381147107485256, 4.381147107485256, 1.9607482917913035, 1.9607482917913035, 6.190648134000858, 6.190648134000858, 3.1177317576544, 3.1177317576544, -1.1246039236378522, -1.1246039236378522, 6.566449032205743, 6.566449032205743, 11.65504532003612, 11.65504532003612, 3.7294488876458636, 3.7294488876458636, 8.164038344092813, 8.164038344092813, 1.1524568260007126, 1.1524568260007126, 5.035019419485747, 5.035019419485747, 11.297100772551547, 11.297100772551547, 0.926926767192899, 0.926926767192899, 11.712768263645014, 11.712768263645014, 6.580571407958689, 6.580571407958689, 1.9763485523506918, 1.9763485523506918, 4.900460738298718, 4.900460738298718, 6.810498570025855, 6.810498570025855, 7.317582079367347, 7.317582079367347, 9.164949142752464, 9.164949142752464, 5.206503126444624, 5.206503126444624, 8.692484283762509, 8.692484283762509, 6.257763197009875, 6.257763197009875, 17.40199441747304, 17.40199441747304, 3.844460051176679, 3.844460051176679, -0.16264799540651945, -0.16264799540651945, 5.60340931696481, 5.60340931696481, -0.6935311097937124, -0.6935311097937124, 2.0996078252552173, 2.0996078252552173, 16.137802524790313, 16.137802524790313, 16.481720069288876, 16.481720069288876, 3.5171835178437587, 3.5171835178437587, -3.0335956782378584, -3.0335956782378584, 10.456830966335245, 10.456830966335245, 11.66156531138012, 11.66156531138012, 2.3407979332648288, 2.3407979332648288, 16.1987368756693, 16.1987368756693, 4.234811778549677, 4.234811778549677, 12.607158972671817, 12.607158972671817, 8.200006955439141, 8.200006955439141, 0.21629625797583463, 0.21629625797583463, 10.965422372620246, 10.965422372620246, 3.030138273731415, 3.030138273731415, 6.837040833878824, 6.837040833878824, 4.626811193718891, 4.626811193718891, 1.3708318740824312, 1.3708318740824312, 12.415340159067394, 12.415340159067394, 14.143128199735097, 14.143128199735097, -9.023169461061991, -9.023169461061991, 3.3783338103276632, 3.3783338103276632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782664884764274, "mean_inference_ms": 2.0936130365032537, "mean_action_processing_ms": 0.09676084448091402, "mean_env_wait_ms": 0.5749927856242821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 33750, "timesteps_this_iter": 0, "agent_timesteps_total": 101250, "timers": {"sample_time_ms": 11963.198, "sample_throughput": 282.115, "load_time_ms": 0.598, "load_throughput": 5639751.394, "learn_time_ms": 1724.576, "learn_throughput": 1957.002, "update_time_ms": 20.052}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 59.65057716369629, "policy_loss": -0.008877388085238636, "vf_loss": 59.672729110717775, "vf_explained_var": -0.12581779956817626, "kl": 0.0063968246919775314, "entropy": 1.3314996242523194, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 11.953519105911255, "policy_loss": -0.0033416980877518654, "vf_loss": 11.96977424621582, "vf_explained_var": -0.06667185425758362, "kl": 0.007809618913943964, "entropy": 1.3694292724132537, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 33750, "num_agent_steps_sampled": 101250, "num_steps_trained": 33750, "num_agent_steps_trained": 101250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1350, "training_iteration": 10, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-11-38", "timestamp": 1706105498, "time_this_iter_s": 12.82948088645935, "time_total_s": 121.04917430877686, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 121.04917430877686, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.518750000000004, "ram_util_percent": 72.69999999999999, "gpu_util_percent0": 0.05125, "vram_util_percent0": 0.2085723876953125}}
{"episode_reward_max": 10.366988704225482, "episode_reward_min": -26.523583682695225, "episode_reward_mean": -3.090917931720469, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.82261783109091, "policy_agent_": -5.400229565884364}, "policy_reward_max": {"policy_adversary_": -3.70051036373057, "policy_agent_": 17.420124734315287}, "policy_reward_mean": {"policy_adversary_": -16.30276579909326, "policy_agent_": 6.605923933686396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.8751715247349106, -6.766705630505671, -6.428337941511568, -2.4009825630758646, -22.616313679059978, -12.741926020030618, -3.400204544738637, -0.8296431668031339, -7.415709233897619, 1.5012327203562013, -1.1233062077781755, 1.5846239907199309, 4.499029646568729, -16.961690937990106, 4.668283112310565, 5.426841924783528, -19.672921412873666, -26.523583682695225, -1.3363269248095238, -5.28005675948055, -16.466427153900142, -20.58282330573579, -10.596382816125265, -6.740279922563172, -3.372177660709312, 2.9967927555298792, -0.4053865190899646, -2.5270868826815636, -20.15256154340622, -0.6688466926922274, -1.3303426824863704, 0.45395981696183263, 8.037088931505117, -2.0652427985243333, -3.4513971086327384, -0.0869768671361103, 1.585730834081522, -14.33741822235853, -14.057929306337968, -2.8522650509636867, -0.05926620122857473, 3.736264797100667, 2.076359152091028, 1.8079689369665206, 7.298876900964473, -8.183758564160359, 9.600190598387972, 3.329468288179503, -3.0777620809906328, 8.290703555084749, -10.60157817689962, -5.9776194550658825, -14.8365385655465, -10.360276280642918, 5.60011311083144, 10.366988704225482, 1.8567474361580252, -2.9400840569244173, 3.1877340533629877, -6.228945885584588, 7.043016330135707, -0.23604001026686527, -6.617026749649035, -5.588765168782906, -4.337939799779831, 1.0341515028230026, 0.9638828758194675, -19.760844452778727, -3.4916920672008778, 1.1554112936213472, 1.563946672565371, -3.0864015093873607, -0.6607805448405225, 3.1161751079031776, -5.423123140719458, -7.085094490878156, 1.2300273900699694, -2.0570591017308004, 8.112156684869376, -7.809869362103164, 4.907885076360004, -2.670710980279593, -3.5985299614990014, -9.257999766191134, -1.14540727884346, -12.910650649307552, -0.857335907055605, 1.4120415489645128, 1.845343547130242, -19.30056133634333, -17.617211337613416, 3.654526276361426, 9.845537491018483, -0.523230903555318, 8.225205753814949, -5.823287507089416, 0.513217798375275, -10.695761914858162, 2.79118256777124, 5.2702769744842195, -3.6111066477397475, 2.002040133801299, -2.9737438970575267, -1.4799691225657605, -24.897208701994533, -4.265704287524761, -6.235834852248914, -4.805572801327854, 1.6753243730951302, 2.024887867766894, -2.489515208001215, -7.292612181778541, -10.132904457925674, 6.340342920324359, 4.71369126213526, 7.575281575307947, -0.6148933846358733, -8.271830859006341, -10.651668729046474, -7.023215066551688, 2.590371399281281, -2.919034623194216, 3.3533296290464056, 3.2682832877365873, -4.817987399262847, -1.5204549408547392, -0.9436169792332838, 1.7359558811277442, 6.558822686195195, -5.4924543780435675, -8.551626041653597, -2.4390147115491536, -4.444052341432975, -1.9926821979679303, -12.946954174616316], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.263389240655172, -16.566912431450646, -8.852922184476219, -6.934854746466127, -11.815854547291252, -20.191230633756994, -6.726067242965291, -17.572043576621155, -18.377075805653487, -11.525953358139253, -17.210947924896733, -12.860227912705941, -21.43587100333617, -14.833275553789289, -23.859414732613494, -18.691173162890465, -26.57213285925043, -17.560420074464265, -14.492216843906867, -21.804458352259832, -12.323637211247014, -19.24335666478737, -8.14579559034996, -9.796314482297905, -16.36656553963055, -15.859577356096104, -23.504181898998226, -19.58690784184337, -15.038368381710715, -14.731964747818772, -16.48156271864198, -14.283259488025537, -24.61072839796599, -21.933475899884204, -21.05154185797299, -19.1280432006481, -16.57320694154954, -16.266327916838645, -31.26132561791742, -10.29967161092153, -17.153699592956904, -23.574117136437327, -12.098307385132616, -19.488074420018854, -27.54137256766611, -6.755662670601249, -18.308237912738736, -17.230301267267688, -10.666939997832202, -18.846669963013504, -6.307897421522892, -17.42735725873301, -18.102796749546126, -8.710607466537233, -13.845105036250411, -22.122993409069434, -17.146636641016986, -16.660439523394324, -17.689970235304273, -12.994106348836032, -18.196505920834426, -17.018512307818476, -7.559707936778638, -9.769722327000556, -3.70051036373057, -11.6053807289858, -9.947909489980841, -21.557888530519946, -20.65561935399791, -19.148236148423816, -15.495998008708327, -8.69680404734126, -10.539434227824337, -25.705783638543828, -16.382908646003486, -13.615232065541635, -20.083432487007777, -14.481947198988362, -22.68084282906954, -7.106486437315897, -17.83646964101878, -26.328229862633354, -28.31262867776757, -21.809046596195532, -17.463575371298024, -14.046825975976617, -11.151509806493886, -15.767312101915472, -13.921410009580088, -13.544018650670726, -10.447735095440693, -15.025088714064367, -19.050496186710195, -15.303971648404687, -21.1794822398307, -23.114671227856224, -14.564644577007558, -17.662277766084227, -22.232475063212675, -17.392419399689615, -15.76484035474034, -22.714511389928234, -25.011488355105612, -15.774074383678217, -16.32343907395539, -20.985723782596924, -19.36801477270129, -11.549927738156459, -18.32331498779795, -13.3097038740656, -31.82261783109091, -9.929213816472227, -13.161472993950396, -22.08806415653592, -12.787474365124933, -17.92998947885224, -12.922540509016493, -7.613622160931167, -6.427463385174663, -8.75175450417362, -17.194801720558928, -25.474246749458732, -19.240189000702895, -22.01182145747418, -10.151664423941504, -12.945856131431848, -26.04667276939743, -15.306933978194163, -16.89116012248869, -8.739943719219701, -14.29387390913597, -9.340950055935112, -10.702720303423883, -13.629333033114419, -15.937263726187044], "policy_policy_agent__reward": [5.194108857960133, 5.194108857960133, 4.900103400472486, 4.900103400472486, 1.2122921214823255, 1.2122921214823255, 2.266936091695129, 2.266936091695129, -5.400229565884364, -5.400229565884364, 3.7246523068631867, 3.7246523068631867, 1.6629313491133266, 1.6629313491133266, 8.371200204909012, 8.371200204909012, 5.480683285877934, 5.480683285877934, 6.513593039247728, 6.513593039247728, 8.04382085855928, 8.04382085855928, 7.222425951712941, 7.222425951712941, 12.967450324952452, 12.967450324952452, -1.0642076921004073, -1.0642076921004073, 14.263848922462026, 14.263848922462026, 12.059007543837003, 12.059007543837003, 3.4496057231883785, 3.4496057231883785, -4.481581804115474, -4.481581804115474, 6.577944959548673, 6.577944959548673, 8.262200796389639, 8.262200796389639, -2.0713949713265665, -2.0713949713265665, -0.6697333204742066, -0.6697333204742066, -1.2252936128876515, -1.2252936128876515, 1.5280172798673664, 1.5280172798673664, 6.497193939460615, 6.497193939460615, 9.428185055812994, 9.428185055812994, 11.549397689954132, 11.549397689954132, 8.529910479580904, 8.529910479580904, -2.5570965808477624, -2.5570965808477624, 7.031559027563273, 7.031559027563273, 7.575610018077806, 7.575610018077806, 7.368609652493686, 7.368609652493686, 16.32390866473555, 16.32390866473555, 9.934116550679935, 9.934116550679935, 8.800072374670123, 8.800072374670123, 9.520533166755994, 9.520533166755994, 9.07946888781553, 9.07946888781553, 0.9644548472400551, 0.9644548472400551, 8.601698155789718, 8.601698155789718, 3.7237032799789196, 3.7237032799789196, 8.547216695864163, 8.547216695864163, 13.655190966769, 13.655190966769, 7.087333268611822, 7.087333268611822, 10.648021678492684, 10.648021678492684, 17.420124734315287, 17.420124734315287, -0.7140479467795584, -0.7140479467795584, 13.954214255563357, 13.954214255563357, 10.279884777723595, 10.279884777723595, 3.7945889584207855, 3.7945889584207855, 13.568686759049129, 13.568686759049129, -2.1468403776883593, -2.1468403776883593, 5.724868901833563, 5.724868901833563, 1.6331290919998178, 1.6331290919998178, -0.82483440705284, -0.82483440705284, 9.722609073540925, 9.722609073540925, 16.24499105664746, 16.24499105664746, 9.50169203858751, 9.50169203858751, 6.860177733234954, 6.860177733234954, 10.43885214433363, 10.43885214433363, 3.3825802316257207, 3.3825802316257207, 12.619761125485068, 12.619761125485068, 8.391236148775803, 8.391236148775803, 0.47134059356480196, 0.47134059356480196, 2.090478579108826, 2.090478579108826, -0.3187147180246307, -0.3187147180246307, 6.319766115904401, 6.319766115904401, 5.4558961829001555, 5.4558961829001555, 0.8985220388706121, 0.8985220388706121, 8.581963643398517, 8.581963643398517, 10.15182372102258, 10.15182372102258, 8.529972340636851, 8.529972340636851, 2.80520126897695, 2.80520126897695, 4.939326841491907, 4.939326841491907, 14.410979373223505, 14.410979373223505, 5.479892752642015, 5.479892752642015, 3.2650687873317383, 3.2650687873317383, 10.656729938538874, 10.656729938538874, 6.212444048628782, 6.212444048628782, 15.396499756969456, 15.396499756969456, -0.3516914623936345, -0.3516914623936345, 11.372177358689394, 11.372177358689394, 11.828759441176878, 11.828759441176878, 12.357049358134278, 12.357049358134278, 6.275523415002195, 6.275523415002195, 8.15908404622728, 8.15908404622728, 0.5680876633345315, 0.5680876633345315, 5.147086949719139, 5.147086949719139, 8.589676825439993, 8.589676825439993, 7.883376778355162, 7.883376778355162, -2.878271342836297, -2.878271342836297, -3.5847381210863567, -3.5847381210863567, 9.339807495212899, 9.339807495212899, 14.448016838864337, 14.448016838864337, 7.3903703724246865, 7.3903703724246865, 14.702343996822824, 14.702343996822824, 8.645691860383405, 8.645691860383405, 7.538931187691414, 7.538931187691414, 3.4832579256130307, 3.4832579256130307, 12.511828815491954, 12.511828815491954, 11.331348187086922, 11.331348187086922, 6.076866853500293, 6.076866853500293, 12.358275761864764, 12.358275761864764, 11.01887222902404, 11.01887222902404, 7.147052630556228, 7.147052630556228, -4.286884814019572, -4.286884814019572, 8.360009747536079, 8.360009747536079, 6.566089960226186, 6.566089960226186, 3.372177468414301, 3.372177468414301, 9.99931968044654, 9.99931968044654, 7.667295870916249, 7.667295870916249, 14.666551311544849, 14.666551311544849, 1.318300817346843, 1.318300817346843, 1.5142842680123625, 1.5142842680123625, 14.214203538430144, 14.214203538430144, 8.750582813630098, 8.750582813630098, 12.752635527080097, 12.752635527080097, 6.153823562190309, 6.153823562190309, -0.32910434903758506, -0.32910434903758506, -2.1121026719359093, -2.1121026719359093, 0.8642697188109667, 0.8642697188109667, 9.892586559920105, 9.892586559920105, 11.277606063132257, 11.277606063132257, 11.296759314874652, 11.296759314874652, 12.640052372605384, 12.640052372605384, 2.6668385123393294, 2.6668385123393294, 5.712700595288554, 5.712700595288554, 12.55152789508207, 12.55152789508207, 8.521444929660955, 8.521444929660955, 11.72499140434194, 11.72499140434194, 1.6237446705880676, 1.6237446705880676, 2.8711239337411842, 2.8711239337411842, 3.450967672192979, 3.450967672192979, 3.1293339809954537, 3.1293339809954537, 5.818325417573245, 5.818325417573245, 1.4951547757853667, 1.4951547757853667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28829239563647374, "mean_inference_ms": 2.1697437781833537, "mean_action_processing_ms": 0.09925154727424826, "mean_env_wait_ms": 0.5942384498264588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 37125, "timesteps_this_iter": 0, "agent_timesteps_total": 111375, "timers": {"sample_time_ms": 12480.29, "sample_throughput": 270.426, "load_time_ms": 0.598, "load_throughput": 5640200.813, "learn_time_ms": 1800.513, "learn_throughput": 1874.465, "update_time_ms": 21.246}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 55.206442260742186, "policy_loss": 0.0110950474627316, "vf_loss": 55.208549880981444, "vf_explained_var": -0.20824260711669923, "kl": 0.0066719150877449064, "entropy": 1.3243374228477478, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.731389904022217, "policy_loss": -0.03626071475446224, "vf_loss": 10.780075693130494, "vf_explained_var": -0.09907641410827636, "kl": 0.007387307595160736, "entropy": 1.3163534581661225, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 37125, "num_agent_steps_sampled": 111375, "num_steps_trained": 37125, "num_agent_steps_trained": 111375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1485, "training_iteration": 11, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-11-55", "timestamp": 1706105515, "time_this_iter_s": 17.026750802993774, "time_total_s": 138.07592511177063, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4DDD3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 138.07592511177063, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.790909090909096, "ram_util_percent": 74.88636363636363, "gpu_util_percent0": 0.05136363636363637, "vram_util_percent0": 0.22587446732954544}}
{"episode_reward_max": 17.021203803437473, "episode_reward_min": -19.701320723807694, "episode_reward_mean": -2.3387374375921777, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -37.504939041333884, "policy_agent_": -3.4289353546054224}, "policy_reward_max": {"policy_adversary_": -5.313726170084351, "policy_agent_": 24.71343070073028}, "policy_reward_mean": {"policy_adversary_": -16.61205139970873, "policy_agent_": 7.136656981058274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.973937493722364, 4.594832736617343, -1.0839064184582998, 3.476768685228591, -4.707206909871724, -7.4940008617468745, -5.377479413560213, -11.471012041216497, -15.004618713787794, 1.2741302342589913, 3.4414975174378135, -5.883116145743051, -4.958267212508709, -2.4997792508585808, -6.636045157094904, -14.490397593488991, -11.32640916503544, 2.35835690048331, -1.670931229199204, -1.3254976586037217, -9.704518442731983, -3.7782411875668482, -7.652206102174242, -10.376547085123326, -2.2171433768472766, -10.602508791942604, -4.030505213371649, 3.0415142170667115, -2.0262848264066613, -5.666708004278185, -6.146190007017589, 6.062064930003384, 14.564667093947039, -2.134163044403813, -3.3575081194344008, -5.632835496189505, -3.204710237301507, 2.541607976941878, -7.953560031044801, -1.4376156110713096, -9.07192701606056, 13.2900763262964, 2.478012517017508, 8.655349803627558, 1.2881937007924917, 1.4549179519682056, 3.6563796469645737, -0.0025387523640880705, -14.647253763648276, -6.009741379067625, 2.811529508779821, 1.828920930460945, 0.023498643849212908, 8.053602979501875, -0.2500038767756295, -9.706804685921561, 2.6575346115399214, 1.5322270488946697, -1.9863581579923133, 1.323912182592446, 7.51894146308455, -11.890778783716032, 1.4720756791538945, 6.423600358456061, 0.4979437465993053, -5.955417032430416, -4.698748159593782, -16.529836747154604, -7.969416021237806, 1.4979654421436965, -6.809117980082114, -1.5673629546393477, 5.726746331237305, -1.2238616547981995, -1.0589814489981706, 3.0334811728366455, 8.926582781955906, 5.018092193549023, -4.812972541995043, -1.3575822085980311, 1.8295835638692328, -8.381935796360853, 2.4604070338716233, -16.584120623594263, 17.021203803437473, -6.060071904981834, -0.15855726428179806, -10.471402927240103, -7.2871395497655085, -0.2181163290434074, -1.6477158887364793, -2.3529547197778737, -13.28549967750838, 0.0643973876305719, -4.555170968474599, -5.609569607453797, -1.0695875716001049, -1.604166776506013, 1.3481547800250526, 5.982094973258802, -1.8125115823515485, 0.5951258084628838, -13.637692419706074, -6.810465349942936, -2.2093010095705776, 2.198079764957394, -13.161905810925315, -4.606669723635059, 2.6914883581660654, -9.45693078704852, 2.4441020058657315, -4.862083591401101, -6.826273096126702, -2.5875604694427796, 5.58918277236579, 7.808771952415805, -12.243680533906279, 2.3672077641244127, 3.336898711499492, -1.497595080776073, 7.7623181647379065, -0.05392329388302769, -5.085714528944521, -5.019914518154823, -3.283707734874268, -3.367084453881663, -0.22019619434900692, -9.434115629997633, -8.25111998513155, -6.035817027455753, -19.701320723807694, -5.175589807260362, 4.513017163730979, 8.639735954728339, -6.90661238660463], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.094327814811928, -17.317804028985872, -11.236227782012039, -12.190388080902956, -27.070141716237494, -20.655151646455426, -19.929878579200476, -11.133768439941168, -13.598288500648444, -11.327073154261118, -14.285411741730917, -8.094421981318677, -21.54990713361507, -23.282299740703394, -25.008044786898203, -13.102582342008828, -20.659931956378983, -10.276643754608994, -12.480001933625951, -10.047297317242492, -7.42598110273326, -5.313726170084351, -11.3395139977078, -13.921057519796797, -12.540461137163003, -9.2864288383679, -15.834777351679543, -15.377093168323404, -18.385747885681397, -9.004733400839049, -18.053958881214122, -27.204433847083816, -25.2661056679955, -18.41653154320731, -9.169474726603816, -16.866826024307414, -37.504939041333884, -19.376969259142648, -18.50033425995415, -22.097429755130655, -23.368960793955292, -30.477646842025067, -18.56968763853993, -18.71498815982815, -18.94421142017731, -12.250977074572877, -21.245419290151272, -6.835224277409129, -11.820022463919807, -13.416751400712668, -18.67363929382827, -9.020778702969253, -30.62032969519366, -17.84068685999876, -14.559230009029367, -8.85765388645626, -23.75917333584937, -16.573156483501393, -17.554166642898057, -25.459142083891926, -24.4288900772625, -26.713269858384606, -25.09495480448338, -14.833222685996093, -21.784956466440025, -24.524973698009862, -9.84362749921705, -22.275010149038483, -8.571449410739868, -14.51658579187753, -17.401082671927423, -11.056727214944793, -18.493824958547712, -15.23836706446307, -8.069535173031023, -27.417722209056706, -23.655353647841213, -23.559244950106496, -10.013448774887014, -15.343307061402273, -21.58241714924954, -17.47913111900649, -10.983363597278228, -12.286886917957398, -32.40565759802308, -8.635298611383806, -16.336421272618665, -22.753326673709, -10.015058308900919, -19.237858445767447, -6.685003958075234, -14.73607469244975, -16.390798290619426, -11.073841106744021, -10.444687605987294, -10.055190976223207, -12.92689175745484, -25.09343982124724, -17.8622154309001, -19.700190081018214, -24.53659747473391, -23.479142752070246, -6.7798217104952245, -18.15052906979579, -18.270951296254296, -9.94339172886357, -17.548460085223283, -9.777097212887893, -8.645181502262202, -10.734972177811608, -17.061821419746, -16.847283871818274, -9.513308860947422, -9.274880970949269, -15.341309099133374, -35.58880132768577, -7.63722245449471, -36.04831826208181, -15.822673173791031, -10.140060975302067, -20.32872832973312, -8.10790426377303, -22.98027548633716, -13.014116355715856, -14.333127689208524, -21.643243682478165, -12.422528455666171, -10.709575945708155, -23.211065760505395, -14.442004194854109, -21.486278933935083, -8.081877593367555, -13.43559153752468, -21.857325867888573, -14.124199490517752], "policy_policy_agent__reward": [1.5601951605447857, 1.5601951605447857, 10.956318382801616, 10.956318382801616, 5.076160681776869, 5.076160681776869, 7.833578383065776, 7.833578383065776, 11.181467403182884, 11.181467403182884, 6.580575392354277, 6.580575392354277, 7.276199582820132, 7.276199582820132, -0.16862180063766533, -0.16862180063766533, -0.7031651065696669, -0.7031651065696669, 6.300601694260055, 6.300601694260055, 8.863454629584364, 8.863454629584364, 1.105652917787813, 1.105652917787813, 8.295819960553182, 8.295819960553182, 10.391260244922407, 10.391260244922407, 9.185999814901647, 9.185999814901647, -0.6939076257400771, -0.6939076257400771, 4.666761395671771, 4.666761395671771, 6.317500327546148, 6.317500327546148, 5.404535352213374, 5.404535352213374, 4.360899829319386, 4.360899829319386, -1.1392686699993613, -1.1392686699993613, 0.7677424912587505, 0.7677424912587505, 1.8436539477667775, 1.8436539477667775, 1.7722552173367414, 1.7722552173367414, 5.16165888015786, 5.16165888015786, -0.6580399767873536, -0.6580399767873536, 5.902136069153947, 5.902136069153947, 9.209303692695055, 9.209303692695055, 8.17973152963736, 8.17973152963736, 1.6690126982804316, 1.6690126982804316, 5.953884437098264, 5.953884437098264, 16.6332493885436, 16.6332493885436, 19.91538638097127, 19.91538638097127, 8.14118424940175, 8.14118424940175, 2.905983303584709, 2.905983303584709, 5.6169952640589536, 5.6169952640589536, 17.150114402016197, 17.150114402016197, 10.959288618042262, 10.959288618042262, 5.2733871144546764, 5.2733871144546764, 10.32990707202967, 10.32990707202967, 7.1485168889473645, 7.1485168889473645, 21.883861584160737, 21.883861584160737, 10.523850077778718, 10.523850077778718, 13.685168981727852, 13.685168981727852, 10.1162025604849, 10.1162025604849, 6.852947513270542, 6.852947513270542, 12.450899468557923, 12.450899468557923, 3.416342762522521, 3.416342762522521, -1.4136156498642372, -1.4136156498642372, 3.7035050108225187, 3.7035050108225187, 10.742584401304047, 10.742584401304047, 5.424849816715101, 5.424849816715101, 15.321914169521435, 15.321914169521435, 12.947144919750318, 12.947144919750318, 7.154613066126867, 7.154613066126867, -0.42457539973265324, -0.42457539973265324, 13.208353973694647, 13.208353973694647, 9.052691766198032, 9.052691766198032, 7.783904242452872, 7.783904242452872, 13.391527133242183, 13.391527133242183, 15.973915770173527, 15.973915770173527, 7.411245537334291, 7.411245537334291, 13.283515241818636, 13.283515241818636, 10.628411522226076, 10.628411522226076, 11.141450106519661, 11.141450106519661, 9.284778332789724, 9.284778332789724, 2.572439669811635, 2.572439669811635, 2.872586700941938, 2.872586700941938, 0.30101669475102855, 0.30101669475102855, 8.007275617010615, 8.007275617010615, 5.295982345922653, 5.295982345922653, 4.744682130152722, 4.744682130152722, 12.110285644892507, 12.110285644892507, 7.0072527048324345, 7.0072527048324345, 3.505276862016426, 3.505276862016426, 15.22560169094667, 15.22560169094667, 16.29096821489856, 16.29096821489856, 14.288668571827756, 14.288668571827756, 2.600238116445988, 2.600238116445988, 6.992862426402122, 6.992862426402122, 11.706000356559384, 11.706000356559384, 4.5485976613228205, 4.5485976613228205, 6.721885315574928, 6.721885315574928, -2.1486168528184324, -2.1486168528184324, 24.71343070073028, 24.71343070073028, 1.2876133532009868, 1.2876133532009868, 8.088932004168432, 8.088932004168432, 6.140961873234449, 6.140961873234449, 1.3639593795677065, 1.3639593795677065, 9.50987105836202, 9.50987105836202, 2.5186440346693777, 2.5186440346693777, 6.191559986335938, 6.191559986335938, 1.5526493065555218, 1.5526493065555218, 5.5691192471872935, 5.5691192471872935, 2.9447583187563473, 2.9447583187563473, 2.222810684384703, 2.222810684384703, 5.928652092927366, 5.928652092927366, 11.744636522370618, 11.744636522370618, 9.605185105462578, 9.605185105462578, 12.841142527138507, 12.841142527138507, 11.36204294619118, 11.36204294619118, 12.03713428026656, 12.03713428026656, -3.4289353546054224, -3.4289353546054224, 5.670031859926425, 5.670031859926425, 8.030825143341858, 8.030825143341858, 6.070735746910485, 6.070735746910485, 2.193277137148982, 2.193277137148982, 2.585213744626419, 2.585213744626419, 5.668334930214132, 5.668334930214132, 0.6390206953815444, 0.6390206953815444, 9.752961712805867, 9.752961712805867, 5.992600140208587, 5.992600140208587, 1.343517882410362, 1.343517882410362, 3.3436602507532447, 3.3436602507532447, 10.465245935749582, 10.465245935749582, 21.69878664005078, 21.69878664005078, -2.3032290397057835, -2.3032290397057835, 19.207763013103108, 19.207763013103108, 9.579785942645264, 9.579785942645264, 4.321232947262997, 4.321232947262997, 14.045523247235511, 14.045523247235511, 4.026990484945001, 4.026990484945001, 8.947280478696321, 8.947280478696321, 3.997100918780516, 3.997100918780516, 5.524709977167127, 5.524709977167127, 9.13807961429825, 9.13807961429825, 6.101166130658582, 6.101166130658582, 0.6377301578552587, 0.6377301578552587, 7.479972887686923, 7.479972887686923, 4.203093583699179, 4.203093583699179, 0.8924791050636924, 0.8924791050636924, 1.4531438930535954, 1.4531438930535954, 8.974304350627833, 8.974304350627833, 15.248530911308452, 15.248530911308452, 3.6087935519565595, 3.6087935519565595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919283388526689, "mean_inference_ms": 2.2028476649452013, "mean_action_processing_ms": 0.10025001860555992, "mean_env_wait_ms": 0.6028897890192032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 40500, "timesteps_this_iter": 0, "agent_timesteps_total": 121500, "timers": {"sample_time_ms": 12810.49, "sample_throughput": 263.456, "load_time_ms": 0.499, "load_throughput": 6768888.251, "learn_time_ms": 1802.714, "learn_throughput": 1872.178, "update_time_ms": 21.348}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 50.32826881408691, "policy_loss": -0.008519312553107738, "vf_loss": 50.34975662231445, "vf_explained_var": -0.14763591289520264, "kl": 0.007459361765665562, "entropy": 1.3015661358833313, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 12.397833156585694, "policy_loss": -0.009483595658093692, "vf_loss": 12.419591474533082, "vf_explained_var": -0.04855532646179199, "kl": 0.006323855741331624, "entropy": 1.290733766555786, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40500, "num_agent_steps_sampled": 121500, "num_steps_trained": 40500, "num_agent_steps_trained": 121500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1620, "training_iteration": 12, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-12-10", "timestamp": 1706105530, "time_this_iter_s": 14.301920652389526, "time_total_s": 152.37784576416016, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D801F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 152.37784576416016, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.56666666666667, "ram_util_percent": 74.4388888888889, "gpu_util_percent0": 0.16444444444444445, "vram_util_percent0": 0.2275390625}}
{"episode_reward_max": 17.353611787753653, "episode_reward_min": -16.65602193445552, "episode_reward_mean": -1.7317895893200124, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -38.889862006968045, "policy_agent_": -3.505858702116983}, "policy_reward_max": {"policy_adversary_": -5.701600430922961, "policy_agent_": 21.138001656213007}, "policy_reward_mean": {"policy_adversary_": -16.21298875785719, "policy_agent_": 7.24059958426859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.6299853663042665, -13.581849474355515, -15.461363900434568, 6.735654478524022, -9.346953787598693, 1.3479433847644988, -1.8302782604761467, 2.3403491954328284, -2.534988443914614, -1.782827898386468, -9.521595072861095, -5.7502170821136325, -9.769097268126362, -6.731683638132973, -11.383738689726654, 4.416858304868073, -2.081273673077614, -10.021196262981597, 3.4150623971849647, -9.037442492402775, -3.157829826343064, -3.228832457671021, 8.659035099594286, -1.7659433867639092, 2.4489152489063133, -13.179532141229274, -2.1356092382582745, 0.1535619083610309, 6.841292984498439, 10.649615826997195, -12.564067576916605, -5.219715679903372, -13.79892847218179, -7.454715792547715, -3.798064371769309, 2.2050302752246664, 3.7113416975347713, 4.912007860186108, -5.784500897305567, -8.163646078350371, 6.12424210031922, -0.3491309996127526, 4.537921699745582, 0.8053003656109868, 1.6173287810383874, -5.012512136212964, -3.250840704994399, 0.711193068442407, -0.9556718362786482, 0.8336756263043523, -13.286565346087485, -3.97499094941725, -11.576646212611093, -1.0878762778163178, -5.086737849903631, 11.297286262310605, -3.0476261470033004, 3.9149856772344163, 9.302539422786444, 2.3472793718642113, 3.4936575704811825, -3.9146553393897734, 5.491456640904121, -1.5714107268908912, -3.6770476904764626, -2.0194125363430966, -3.1663001215737423, 1.8929444777041669, 1.6213574342069876, 5.637007117504101, -16.65602193445552, -7.718731676579969, 7.933052032689101, -1.1620012563450914, -5.176099439570048, -0.8583976245144358, -6.776503601438907, -1.4369201862083472, -10.055316824269903, -11.194608837200084, 10.46505848497202, 0.7867790099791201, -2.3493995987722496, 5.736497588487111, -7.990524476496933, -6.019418008669925, -3.392400287206989, -1.4127654260888054, -0.4707926615825956, -6.771374441744741, -3.309326313542344, -8.37164190631538, 0.19574305406445136, 1.7872660946587098, 3.13795123716346, -5.87296682431068, -0.015977541741990564, -2.265617942649438, 6.2117542220410344, -9.355397171910111, -2.6278846415359256, -6.161633230332922, 6.83647545592828, -10.926110162813988, 6.930108216326452, 7.921237916615277, 11.93549900936745, 5.007096070413516, 4.1729523235918045, -8.309680145323808, -8.60628218860213, 7.571260353005391, 17.353611787753653, -5.48388668352235, -3.3992985321832068, 0.9231341263643201, -6.3492959266386695, -10.950090569985152, -4.83813059416435, 1.3180870549317514, -2.9883505546682967, 1.2958177173458048, -5.237314789815459, 6.906692131505522, -15.539922734734965, 2.9098948340161503, 5.466295575510142, -3.0131537274879814, -0.09330304535766831, -5.599702962891823, 5.687439926079273, -0.2607460939718564, 0.14383727711465408, -7.242937390978967, -0.9367502752914352], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.618587864846612, -22.025555051966297, -9.208762002380416, -21.346207994071598, -8.600468595501246, -13.66280000398134, -8.498486042250006, -18.608838812739766, -13.869465891887389, -16.952463269288643, -17.790707417354263, -20.605076398760303, -9.497998340991046, -12.804361841116249, -12.091560161179984, -21.636268415585917, -9.26220574787715, -26.983026688918752, -20.372812709764958, -6.160431713541776, -16.37195803540575, -12.331306454564176, -16.148720888020073, -13.772522308016631, -10.156543871377336, -13.054055968529205, -13.220909006612676, -14.731320847466844, -18.307852926852085, -20.4905068557251, -11.08315902992029, -12.181997489650012, -17.93890013686303, -17.653989916157258, -12.797752503764725, -19.576489410723006, -11.475278084376578, -22.93733840158051, -13.495415014277611, -14.763458592836749, -19.060754776346876, -14.225708368426753, -21.45431701250973, -23.476043173827108, -22.423470445151555, -18.466440697061163, -8.564922445307946, -19.061523626045922, -15.646171920343793, -15.741463454146528, -6.274847941853525, -16.12636860157687, -25.466854171448894, -31.739705216890204, -7.772431326440869, -28.20934936225783, -18.475604760724245, -17.641628684280846, -26.525129426077452, -26.11390023073992, -12.995709090521274, -11.525096206760498, -15.830082604123119, -9.930832801598852, -19.850566383837908, -10.39672742538188, -20.189283919342873, -14.124735317479463, -11.952836164317205, -14.74365535221875, -18.099698233451658, -11.307087433761598, -18.497867042594578, -9.208274986937912, -26.75198550948569, -15.366941091932258, -15.816439706704934, -11.630192022159147, -14.571794146685564, -15.485678953756755, -16.606619876842807, -19.87423267521612, -17.13167336305824, -30.487423349585928, -13.292292884044384, -5.701600430922961, -9.677510525728986, -21.6557230239356, -9.163061852426601, -12.594785236279659, -8.385330561627175, -25.065149742068122, -20.279972067038226, -15.11937966675532, -14.550766175841003, -12.646919080578883, -9.351196483144419, -11.008685573401976, -15.639275096212256, -5.7979670503291745, -13.328737524254521, -21.986645280467535, -23.829918096823164, -17.063596067664697, -17.92786160528848, -22.332777750232395, -25.475102204340466, -26.051319748634906, -12.71874601010576, -9.808583713589195, -9.800469513343291, -18.59911711628509, -24.922391524672367, -21.469877121642043, -14.329548316154083, -38.889862006968045, -17.58028429323271, -11.66942051545551, -12.071069917225943, -21.617303247107927, -8.53747252890794, -16.120507377506854, -6.258652487627276, -20.110532207288433, -22.17102517177473, -20.008251512124748, -18.711865883240968, -13.838856922399604, -21.500815162561857, -13.869380719318773, -17.414927497824962, -19.151319803322195, -9.980675449146045, -8.925152693796912, -14.824169864120636], "policy_policy_agent__reward": [3.494301249271173, 3.494301249271173, 4.221852788805391, 4.221852788805391, -3.1263009490270806, -3.1263009490270806, 14.040931236297808, 14.040931236297808, -0.3732425960487239, -0.3732425960487239, 7.5053716943729185, 7.5053716943729185, 3.33410389088693, 3.33410389088693, 10.474594004086295, 10.474594004086295, 5.667238723986385, 5.667238723986385, 7.584817685451089, 7.584817685451089, 4.1345561722465805, 4.1345561722465805, 7.427429658323336, 7.427429658323336, -0.13554946356765502, -0.13554946356765502, 3.0363391014916377, 3.0363391014916377, 0.3539107357266631, 0.3539107357266631, 13.026563360226998, 13.026563360226998, 3.590466037399768, 3.590466037399768, 8.480915212968576, 8.480915212968576, 11.893937553474961, 11.893937553474961, -1.438505389430498, -1.438505389430498, 6.607064104531343, 6.607064104531343, 4.551236998446576, 4.551236998446576, 12.403877993807182, 12.403877993807182, 6.00328946062636, 6.00328946062636, 6.302729560141825, 6.302729560141825, -0.06273808635003209, -0.06273808635003209, 5.542649884177201, 5.542649884177201, 7.442441377913937, 7.442441377913937, 12.574572955675263, 12.574572955675263, 15.570061341361145, 15.570061341361145, -0.7404542734981563, -0.7404542734981563, 3.4811409048733237, 3.4811409048733237, 2.069985832340616, 2.069985832340616, 5.099637061804772, 5.099637061804772, 4.499844065997707, 4.499844065997707, 10.890759842973837, 10.890759842973837, 7.593309890955676, 7.593309890955676, 13.92467313088331, 13.92467313088331, 3.85545705848602, 3.85545705848602, 3.299906257243191, 3.299906257243191, 12.592498438333047, 12.592498438333047, 6.938288684407, 6.938288684407, 12.996119356127654, 12.996119356127654, 12.140671769719045, 12.140671769719045, 12.020399613094972, 12.020399613094972, 6.726964280424095, 6.726964280424095, 2.6570408701567745, 2.6570408701567745, 9.886358347244162, 9.886358347244162, 7.345250042032573, 7.345250042032573, 8.287569540225439, 8.287569540225439, -3.505858702116983, -3.505858702116983, 6.075688826079811, 6.075688826079811, 6.945103979418901, 6.945103979418901, 15.325914469536947, 15.325914469536947, 1.342846738268619, 1.342846738268619, 19.753317812284216, 19.753317812284216, 7.71398930686047, 7.71398930686047, 10.778307180757634, 10.778307180757634, 17.913834424431943, 17.913834424431943, 14.230589801302061, 14.230589801302061, 8.244683330501225, 8.244683330501225, 3.805220433685362, 3.805220433685362, 10.66076962251362, 10.66076962251362, 4.1797110373539805, 4.1797110373539805, 8.086759346680722, 8.086759346680722, 4.188657444519389, 4.188657444519389, 8.511491898884564, 8.511491898884564, 8.008839897591814, 8.008839897591814, 6.787096799262095, 6.787096799262095, 10.190331234861427, 10.190331234861427, 0.7218381494980687, 0.7218381494980687, 1.794177878590812, 1.794177878590812, 13.215459537641841, 13.215459537641841, 4.02313686529641, 4.02313686529641, 10.787943034957818, 10.787943034957818, 7.254271733708911, 7.254271733708911, 4.519968052633014, 4.519968052633014, 5.096635917975402, 5.096635917975402, 2.2582386612078356, 2.2582386612078356, 2.1455350582783383, 2.1455350582783383, 13.535839180907416, 13.535839180907416, 10.330505842597619, 10.330505842597619, 7.39113688214299, 7.39113688214299, 18.11196046903652, 18.11196046903652, 2.650884203773724, 2.650884203773724, -0.1589087888734837, -0.1589087888734837, 3.1425551192609986, 3.1425551192609986, 10.121478798923398, 10.121478798923398, 4.3461345954220025, 4.3461345954220025, 2.9117053972674594, 2.9117053972674594, 2.538002124042415, 2.538002124042415, 8.346753917876367, 8.346753917876367, 10.237857560551339, 10.237857560551339, 8.453322880707015, 8.453322880707015, 8.844358706502232, 8.844358706502232, 3.3869761281340995, 3.3869761281340995, 4.6676094707012155, 4.6676094707012155, 4.371533815376271, 4.371533815376271, 10.925514659126645, 10.925514659126645, -1.7787150607904658, -1.7787150607904658, 5.350426441359296, 5.350426441359296, 7.912506025067305, 7.912506025067305, 15.333196776375726, 15.333196776375726, 3.0687429524253544, 3.0687429524253544, 12.428984910807465, 12.428984910807465, 15.127007833423837, 15.127007833423837, 18.70530060685396, 18.70530060685396, 15.529207909524214, 15.529207909524214, 8.445849166848781, 8.445849166848781, 0.7494517841326955, 0.7494517841326955, 0.5970936623705765, 0.5970936623705765, 13.085188734645241, 13.085188734645241, 21.138001656213007, 21.138001656213007, 7.992995219059848, 7.992995219059848, 5.465124891985436, 5.465124891985436, 19.906498066666177, 19.906498066666177, 5.615494183297022, 5.615494183297022, 0.35966497273518233, 0.35966497273518233, 3.6164696615307945, 3.6164696615307945, 11.467695151019841, 11.467695151019841, 2.774560987119823, 2.774560987119823, 8.708162547426332, 8.708162547426332, 0.510668848905904, 0.510668848905904, 13.508612169396974, 13.508612169396974, 3.3155512185198814, 3.3155512185198814, 11.459073173070449, 11.459073173070449, 12.089080729375553, 12.089080729375553, 5.412851597455808, 5.412851597455808, 10.70375605860209, 10.70375605860209, 4.1348388782134755, 4.1348388782134755, 11.55118371195212, 11.55118371195212, 9.44528685467517, 9.44528685467517, 5.062256363130352, 5.062256363130352, 0.8411076514089703, 0.8411076514089703, 6.943709794414599, 6.943709794414599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922024997210136, "mean_inference_ms": 2.2120395742024694, "mean_action_processing_ms": 0.10081192015210734, "mean_env_wait_ms": 0.6051266566088701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 43875, "timesteps_this_iter": 0, "agent_timesteps_total": 131625, "timers": {"sample_time_ms": 13009.207, "sample_throughput": 259.432, "load_time_ms": 0.399, "load_throughput": 8459795.613, "learn_time_ms": 1826.768, "learn_throughput": 1847.525, "update_time_ms": 21.445}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 41.90200614929199, "policy_loss": 0.0010772883892059327, "vf_loss": 41.913983535766604, "vf_explained_var": -0.22575509548187256, "kl": 0.004861606281024197, "entropy": 1.30835462808609, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 11.997036027908326, "policy_loss": -0.01677500531077385, "vf_loss": 12.025873231887818, "vf_explained_var": -0.12247258424758911, "kl": 0.007921728223723067, "entropy": 1.285396581888199, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 43875, "num_agent_steps_sampled": 131625, "num_steps_trained": 43875, "num_agent_steps_trained": 131625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1755, "training_iteration": 13, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-12-23", "timestamp": 1706105543, "time_this_iter_s": 13.254241466522217, "time_total_s": 165.63208723068237, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 165.63208723068237, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.36470588235294, "ram_util_percent": 74.31176470588235, "gpu_util_percent0": 0.18058823529411763, "vram_util_percent0": 0.21613625919117646}}
{"episode_reward_max": 14.207329255494532, "episode_reward_min": -26.006893201408243, "episode_reward_mean": -1.0678568646090683, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -32.80748212379981, "policy_agent_": -5.189754231920246}, "policy_reward_max": {"policy_adversary_": -4.525032578943448, "policy_agent_": 22.400488664815505}, "policy_reward_mean": {"policy_adversary_": -15.56246821213424, "policy_agent_": 7.247305673762585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.018544720031885564, 4.195877607203616, -0.8980260291626312, 10.180850506185863, -0.6575074401899466, 3.043666270850754, 1.00811684147875, -3.800330581699665, 5.899597529265801, -11.838366598813328, 5.223910887684255, -14.562835295356242, 9.102017466302032, 2.8765168051126855, -7.370713432820418, 3.248784661766317, 12.967416371165347, -1.7856113920378025, -1.498679392447041, -4.440177666185999, 14.207329255494532, 2.1352850436942106, -4.819139179129452, 3.2767271909381934, -7.898224964385707, 6.745192349268103, -3.2639238676846567, -0.01674276297582522, 0.9370126799667122, -2.931917176031261, 0.2160083309551089, 1.596440985791684, 4.808832254736676, -5.92789870005829, -2.8738070657429007, -1.2110688395778548, -7.043584527428138, 4.128295506425396, 12.807526842879062, -9.446832132791947, 8.320222994902965, 7.213972920294964, -0.9053227815216056, 8.992590868348874, -5.102974965380489, -0.4664618431770254, 4.759692781286437, -2.540199630958195, -10.055230313843435, -0.7049022913123713, -4.091182192201723, -7.0861461122907405, -1.7474734787906163, -4.371462061396178, -1.701713378441899, -0.528747815179277, -6.546963323312381, -2.6132368390873006, -13.312258457566664, -5.432137159761032, 2.5560449745621487, 9.24117734877878, -3.602229689829872, -1.737445559840748, -1.918326360089614, 0.5160461324704912, 0.801487145094018, 0.9623426467983466, -2.026507854040151, 1.5315327895276771, -10.416235179337738, 10.032413699908723, -1.9009383749527298, 1.6286028923473763, -10.553793171901551, 7.34241537533447, -26.006893201408243, 9.064772543608202, -13.945758448865874, 1.9139252827771402, -7.460622677902081, 4.7896193189705984, 11.055612580074909, 1.3926595325464752, 3.176330221998379, -1.1622385921353815, 0.026828099321833332, 5.533220992939413, -10.412362271206312, 6.37878781066597, 10.80943425780312, 9.538332353778532, -15.187960088851929, -9.2060706930426, -15.884854899760523, 10.518858282034682, 3.0319604075101205, -3.226152329786271, -8.701251623118829, -4.540833627903985, -7.18333554606288, -0.13215700770216954, 9.5175439028453, -5.505868634026807, 2.9022558499181716, -8.819205480525968, 3.01670286846186, -2.417577916000798, -7.465073102378619, 3.889866229187975, 5.236281477679194, 1.2125043994045972, 3.6697244925552415, -8.057111501427062, -8.05144911999113, 2.1453683925722693, -1.155179199367213, -0.1838396238835523, 1.6037555773569474, 1.342451069249273, 0.6053551626080196, 6.15909893251773, -1.0137797397443655, -3.6719472651581446, -18.19337817102684, -11.452139287751468, 1.267550915818429, 0.7320725160491741, 2.547065278345083, -2.997612828261838, -10.88804604533586, -3.736642644612979, -9.179645692891675, -8.387933460058285, -13.84982210868921], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.773335824976337, -10.21969438680808, -19.0186216366621, -20.07056818595048, -15.474889002149059, -13.589799323514024, -18.456355174260345, -17.675089821481922, -16.017658250717123, -13.767671133650252, -12.075651946764584, -12.87199566208652, -17.585329476565974, -10.818185056319372, -7.957462168862238, -21.923010792940854, -31.833560958465657, -7.91984956253156, -7.460478137856065, -26.592256733004426, -23.185451375790603, -32.80748212379981, -9.819325338543374, -16.65280860101216, -20.649215638290656, -21.890355327491985, -8.384960828987623, -23.504420086131187, -8.02030449403382, -13.921126068113178, -11.159349835362702, -12.34252029793705, -17.66406726958873, -16.888415165869517, -7.532489861648756, -23.794384407147618, -9.634902362630397, -26.081047994332295, -25.11301402825763, -9.599345896151945, -20.752383593230206, -15.385535442161048, -21.86818269746021, -15.04981140879667, -12.479004023449473, -20.69320073865999, -19.75123330539312, -9.677682907135477, -15.029057464128096, -18.00951484943632, -8.088771456427523, -12.159833204143329, -10.1862123444635, -16.856071360991283, -11.445740109184818, -12.002856475096156, -4.525032578943448, -9.04707424696809, -15.09984188163676, -10.187312683500355, -10.678716534499957, -21.384200760531357, -10.792194488474369, -10.763897313244057, -13.18340188080707, -8.43052331918361, -14.92219008265978, -15.752825021288938, -11.80567728937939, -14.647753812683654, -8.690863933584245, -19.476732546090624, -13.57359055662436, -24.50304598911114, -10.420321532917802, -18.06792593097347, -15.627384737567766, -21.724900819484866, -16.216238959053285, -25.037881447339966, -12.338674502776604, -23.388608459299384, -27.708344537408074, -7.494452380174586, -24.044810739644987, -13.000364846684347, -17.038694476536545, -14.145846528288564, -18.312986306411847, -18.823225563088418, -19.653073365743964, -29.566932438551305, -25.248504858921105, -8.542419263299928, -11.64590476463781, -25.083390797183736, -20.261638727782064, -11.975643239511781, -18.400839269525125, -7.070356024022723, -18.03200706281974, -15.181410391105214, -20.269163047416072, -5.338921249289687, -18.855031637329986, -20.039349333618613, -13.705319241584991, -13.27089154389107, -17.509826320617556, -13.985073537648818, -20.794328393215135, -6.618364528980477, -20.27921832160945, -19.725408323709328, -17.706049540271113, -19.386959428345637, -10.62962033663129, -13.608346836759784, -10.704151549946863, -16.23923634301314, -8.761051825895455, -17.380123580813695, -10.111781145212724, -10.111371523716643, -8.98091474669155, -28.76648839261646, -20.123863581920084, -10.296848836070053, -15.143247216986449, -19.14422054677856, -9.892179610123822, -6.986464945545669, -11.821738062291987, -9.649118019685677, -12.399338583082796], "policy_policy_agent__reward": [5.877395552472225, 5.877395552472225, 7.207785997005848, 7.207785997005848, 9.060297803749735, 9.060297803749735, 15.125709346068168, 15.125709346068168, 7.408690780979555, 7.408690780979555, 8.31673279718239, 8.31673279718239, 9.73223600786955, 9.73223600786955, 6.937379619891127, 6.937379619891127, 10.958627889991464, 10.958627889991464, 0.9646522674184591, 0.9646522674184591, 8.649781417224421, 8.649781417224421, -0.8454198166348627, -0.8454198166348627, 13.343673471434006, 13.343673471434006, 6.847350930716028, 6.847350930716028, 0.29337436802090916, 0.29337436802090916, 12.585897727353588, 12.585897727353588, 22.400488664815505, 22.400488664815505, 3.067119085246878, 3.067119085246878, 2.980899372704513, 2.980899372704513, 11.076039533409215, 11.076039533409215, 18.696390315642564, 18.696390315642564, 17.47138358374701, 17.47138358374701, 2.5000930797069625, 2.5000930797069625, 9.964767895975179, 9.964767895975179, 6.375495336952478, 6.375495336952478, 14.317773838380045, 14.317773838380045, 2.5605184806514836, 2.5605184806514836, 11.743838661577682, 11.743838661577682, 4.478658587000266, 4.478658587000266, 5.494604446040958, 5.494604446040958, 5.687679083158904, 5.687679083158904, 6.969480641864363, 6.969480641864363, 11.236449762162701, 11.236449762162701, 5.480258232905613, 5.480258232905613, 2.3293413979529274, 2.3293413979529274, 11.291657783784878, 11.291657783784878, 1.295658917601132, 1.295658917601132, 15.104671750378845, 15.104671750378845, 18.96027043556835, 18.96027043556835, 0.0762568816799945, 0.0762568816799945, 14.53630329406659, 14.53630329406659, 11.299754181228003, 11.299754181228003, 10.4814299579693, 10.4814299579693, 12.021201138572774, 12.021201138572774, 3.6880145290344934, 3.6880145290344934, 10.113369447741483, 10.113369447741483, 12.255463043339779, 12.255463043339779, 3.5687416380886408, 3.5687416380886408, 2.4869135751423297, 2.4869135751423297, 8.652306279061976, 8.652306279061976, 1.9987946321129, 1.9987946321129, 2.536843545926296, 2.536843545926296, 4.219369432836441, 4.219369432836441, 6.242304649797551, 6.242304649797551, 4.872013365371458, 4.872013365371458, 5.737054329958442, 5.737054329958442, -1.010965372184464, -1.010965372184464, 3.216918703940395, 3.216918703940395, 0.8937917120350469, 0.8937917120350469, 2.3775877618696617, 2.3775877618696617, 6.6173807545310535, 6.6173807545310535, 15.31268905465507, 15.31268905465507, 3.594982399322248, 3.594982399322248, 4.513225876701655, 4.513225876701655, 5.632537760358728, 5.632537760358728, 4.47328472582705, 4.47328472582705, 7.861838613876898, 7.861838613876898, 8.357583834043643, 8.357583834043643, 4.88958471766962, 4.88958471766962, 8.089643301105669, 8.089643301105669, -0.8626856228767409, -0.8626856228767409, 14.75457312299967, 14.75457312299967, 5.836326090835818, 5.836326090835818, 13.065824440729266, 13.065824440729266, -0.06673581949187257, -0.06673581949187257, 12.70517065315397, 12.70517065315397, -5.189754231920246, -5.189754231920246, 15.394836681546533, 15.394836681546533, 1.1352402550937062, 1.1352402550937062, 13.475903365058553, 13.475903365058553, 2.439025912437262, 2.439025912437262, 14.089113889134989, 14.089113889134989, 19.381978558741494, 19.381978558741494, 4.443555956360531, 4.443555956360531, 13.610570480821684, 13.610570480821684, 5.919063127274484, 5.919063127274484, 8.532761287929189, 8.532761287929189, 9.839533760613989, 9.839533760613989, 3.9503120176027666, 3.9503120176027666, 12.601006686877193, 12.601006686877193, 15.231253811773541, 15.231253811773541, 19.552632396164913, 19.552632396164913, 5.0302723850345865, 5.0302723850345865, -0.3318257148713348, -0.3318257148713348, -2.1194750675613596, -2.1194750675613596, 17.801124539609212, 17.801124539609212, 11.646799567646095, 11.646799567646095, 4.374745454862755, 4.374745454862755, 4.849793823203146, 4.849793823203146, 1.2647611980593685, 1.2647611980593685, 5.424335758378431, 5.424335758378431, 7.52462669170152, 7.52462669170152, 14.893353475130684, 14.893353475130684, -0.08347369236855828, -0.08347369236855828, 10.87864374362408, 10.87864374362408, 5.610071926546322, 5.610071926546322, 8.361011055023427, 8.361011055023427, 5.426656813945135, 5.426656813945135, 5.022376609119466, 5.022376609119466, 8.9374698834184, 8.9374698834184, 13.015304935447164, 13.015304935447164, 3.915434464192536, 3.915434464192536, 11.974471407082344, 11.974471407082344, 5.8341484111411335, 5.8341484111411335, 4.827300210139992, 4.827300210139992, 10.766163910458957, 10.766163910458957, 4.737220568632038, 4.737220568632038, 6.712253606438114, 6.712253606438114, 6.153953563651903, 6.153953563651903, 8.790843706131202, 8.790843706131202, 4.683203494251737, 4.683203494251737, 11.76961125666571, 11.76961125666571, 4.5490007027341814, 4.5490007027341814, 3.2197121292792503, 3.2197121292792503, -4.606231712167647, -4.606231712167647, 8.657174552432501, 8.657174552432501, 10.695707248869258, 10.695707248869258, 5.514460676059612, 5.514460676059612, 8.845156247665768, 8.845156247665768, 8.073303859258365, 8.073303859258365, -0.49793321760602083, -0.49793321760602083, 1.6249111504663423, 1.6249111504663423, 1.321046184700154, 1.321046184700154, 0.6305922798136949, 0.6305922798136949, -0.7252417628032104, -0.7252417628032104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29463499513934976, "mean_inference_ms": 2.2333422824909097, "mean_action_processing_ms": 0.10199796941837881, "mean_env_wait_ms": 0.6099796095386595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 47250, "timesteps_this_iter": 0, "agent_timesteps_total": 141750, "timers": {"sample_time_ms": 13340.833, "sample_throughput": 252.983, "load_time_ms": 0.496, "load_throughput": 6804680.094, "learn_time_ms": 1850.013, "learn_throughput": 1824.312, "update_time_ms": 23.737}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 33.16685314178467, "policy_loss": 0.014069873373955488, "vf_loss": 33.165545272827146, "vf_explained_var": -0.18356698751449585, "kl": 0.002173185214786111, "entropy": 1.2767072916030884, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 12.01370062828064, "policy_loss": -0.03022543303668499, "vf_loss": 12.056138849258422, "vf_explained_var": -0.08645361065864562, "kl": 0.005124269504116369, "entropy": 1.2725050270557403, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 47250, "num_agent_steps_sampled": 141750, "num_steps_trained": 47250, "num_agent_steps_trained": 141750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1890, "training_iteration": 14, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-12-37", "timestamp": 1706105557, "time_this_iter_s": 14.244829177856445, "time_total_s": 179.87691640853882, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5ED7D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 179.87691640853882, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.233333333333334, "ram_util_percent": 74.16666666666667, "gpu_util_percent0": 0.13944444444444443, "vram_util_percent0": 0.22437879774305555}}
{"episode_reward_max": 20.003108669136918, "episode_reward_min": -26.888918068835103, "episode_reward_mean": -1.3415284436641863, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -37.50413463959976, "policy_agent_": -6.069758158475702}, "policy_reward_max": {"policy_adversary_": -5.372935227875912, "policy_agent_": 28.55001230869511}, "policy_reward_mean": {"policy_adversary_": -15.200076630098875, "policy_agent_": 6.929274093217344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.953717276071488, -11.548896311943547, 11.339132703820377, 6.210449969440495, 6.280733021807653, -2.0922831799596824, -8.306521321860606, 20.003108669136918, 7.194543507664963, -5.976335036424051, -3.4546064522008706, -26.888918068835103, -0.2552265242647382, -3.9621587974440957, -12.70852125599572, -5.582017943900837, -1.3336842608301351, 6.972686572224503, -5.350921317493858, -14.381492391726285, -9.360135489990096, -1.442327055796091, 3.927654994556069, -6.837549673249793, -0.21869766621012882, -4.8182929972062025, -4.521329614808515, -4.91326993613402, 5.412862891782311, -3.2446678242246754, -5.930962132535381, 0.5055128628233414, -4.281662710616606, 3.322791117787024, -1.8172361236170695, -5.125561157700893, -1.5894658548074387, 1.8686665180589395, 3.9951587639472956, 4.484208574916097, -0.32653670128621526, 4.117984612035114, -13.238017314384653, 1.3531912147741734, 4.045675912619994, 6.345244697168242, 1.2090532699035599, -4.715031855279455, 1.5854984345654506, -1.8664449927829576, -2.8968863237080273, -4.962980347473146, -0.80496444852142, 4.045561994155638, -10.59611485064807, -5.696848037602218, -5.227956541829502, -14.029575199329562, 0.96353207767306, -20.790253140228256, 4.121803197974947, -2.0169533579308543, 9.125009838602262, -2.252711273721484, -13.923810661913127, -20.828090641415297, -10.077087943405948, -4.184277626065438, 14.070305167536794, 4.3032194510422315, -6.128832701404345, -0.41902305684521957, 1.2301646596740632, 6.468967053345169, -1.317371358442926, -4.0292823136937965, 8.961125800245659, 0.778434334907468, 0.3531515786804422, -5.443135673354454, 7.020679722395556, 4.878763979653496, -1.702493498047255, 9.343777206213376, 5.4721713984905715, -12.30573156591975, -9.56055459228309, -1.382774225906351, 5.399272666720128, 3.133791509858637, -0.25198128705189116, -8.059825413848664, 0.5447337607488227, -3.172004928580141, -3.9424794553186517, 1.2379162466050244, 4.652567837985748, -3.472896489586979, 17.864310654790316, -4.048064869637191, -4.8769152833068725, 0.9899435156890232, 1.3038770764425152, 2.7446546208769456, 4.369251978708412, 12.149983887340548, 6.994991282954276, -4.061674574372381, -1.9617583780278025, 1.6539146010068488, 5.540942407945183, -0.7949431250581724, -11.260331823085512, 0.8487740185415821, -0.32519586786548776, -4.848363607844594, -14.800105465574122, 1.860869953538471, -8.678031952087037, 2.1999646914191997, -5.670994645467549, -0.903507044109044, 3.0127324535104676, -1.8965811876436136, -0.8653440467327838, -13.863129751313169, -11.5316860320244, -0.5533618921264147, -0.5537769005228534, 17.807827625994577, -4.663777848076129, 2.954203068828317, -8.625982760371386, 19.595889977790446, -4.974666252680294], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.009164852329983, -25.30705828569517, -17.53387774791851, -22.867003381815564, -16.58949553740864, -14.306817796569367, -14.124144860419948, -32.05624504554357, -15.79847949805891, -10.238688348475344, -28.718197328177588, -19.772260910904972, -10.054628214210576, -9.137555177221689, -13.824395046552347, -13.172511993564292, -18.629826292327465, -26.03442790469719, -8.089187359822496, -7.287164241663185, -22.37662464867204, -25.84147828146117, -16.90557439684103, -10.34920897243603, -9.209371492211465, -7.638521279245192, -14.621281183541283, -16.382808455965385, -22.917678462452468, -18.15847106976091, -9.656722876866253, -18.236869757415267, -5.372935227875912, -12.09900285821169, -7.746631688955816, -11.329946880124025, -9.864209763968608, -19.342307656016843, -12.905902497801755, -17.49741630170435, -20.054223677189114, -13.298800572695308, -8.762227819131805, -14.525910162161432, -12.355771245428478, -11.814346478467211, -7.97791551596824, -11.561057697820113, -16.58503284284264, -7.397819598690725, -22.86451936481893, -18.798449615295663, -19.30549633637051, -11.902668769953866, -9.675250442102689, -11.481874541821602, -11.269410433278294, -25.152081703498247, -20.901645222305145, -8.650736823276846, -14.134120166487083, -6.696543494668353, -19.32026934335864, -10.883569453877904, -21.97096684848129, -20.73107874983166, -17.818761407435677, -7.3101064098092925, -22.56081964975913, -21.55969634580667, -13.039145072133387, -14.666344680333754, -12.83494811118885, -17.637723742469426, -17.309136110624692, -7.184671734101914, -14.973381127582812, -25.268611019800144, -8.654139353792507, -10.200187133349932, -13.542707454362004, -15.438168736613889, -10.63469049118037, -16.601127249133782, -11.260548799018201, -17.711623809453407, -6.006272041641468, -12.695587245648976, -11.902404655613893, -15.392480978414318, -11.402531728502723, -18.781501166543837, -16.504900564159946, -14.472559875416867, -10.287483091004878, -17.04921007181095, -23.040066611826006, -14.025448981085809, -29.608629628038337, -6.004165013853608, -10.37846869673312, -12.123399628615179, -8.408115363237297, -18.50811067784676, -15.766788334698088, -26.239175883062874, -15.226410975377988, -10.031142253650527, -11.498005232711721, -13.347576103746821, -16.726823282208265, -8.559121088959623, -27.21455830482741, -9.458130761782082, -8.20717140476831, -9.858665993309868, -20.717994390800207, -19.98106225985325, -12.039253113733302, -12.576495576817337, -11.751706962540899, -8.83191724209508, -17.799022380037183, -13.186029885827894, -23.708270764886127, -14.870820710161311, -17.631675783081374, -17.65223043991026, -9.967836957942525, -36.95573632990797, -13.80273731755497, -14.6418792136966, -12.421952891419494, -37.50413463959976, -9.962263631709183], "policy_policy_agent__reward": [-1.4722762118707502, -1.4722762118707502, 6.879080986875808, 6.879080986875808, 14.436505225869443, 14.436505225869443, 14.538726675628027, 14.538726675628027, 11.435114279608147, 11.435114279608147, 6.107267308304843, 6.107267308304843, 2.908811769279671, 2.908811769279671, 26.029676857340252, 26.029676857340252, 11.496511502861935, 11.496511502861935, 2.131176656025649, 2.131176656025649, 12.631795437988362, 12.631795437988362, -3.5583285789650727, -3.5583285789650727, 4.8997008449729185, 4.8997008449729185, 2.5876981898887963, 2.5876981898887963, 0.557936895278312, 0.557936895278312, 3.795247024831728, 3.795247024831728, 8.648071015748666, 8.648071015748666, 16.503557238460854, 16.503557238460854, 1.3691330211643198, 1.3691330211643198, -3.547164075031552, -3.547164075031552, 6.508244579340969, 6.508244579340969, 12.19957561283254, 12.19957561283254, 10.416614695698547, 10.416614695698547, 1.7558296495931174, 1.7558296495931174, 4.495336913000669, 4.495336913000669, 1.410114141019495, 1.410114141019495, 5.049975784366382, 5.049975784366382, 5.734769259915685, 5.734769259915685, 14.165270677117396, 14.165270677117396, 7.45690162276812, 7.45690162276812, 1.8628803721654321, 1.8628803721654321, 9.371191310119304, 9.371191310119304, 0.5456362586296506, 0.5456362586296506, 7.710896987999356, 7.710896987999356, 2.964697782669375, 2.964697782669375, 3.1021928612115666, 3.1021928612115666, 4.137371954580584, 4.137371954580584, 10.605487087037888, 10.605487087037888, 8.450530630874526, 8.450530630874526, 10.990812438310224, 10.990812438310224, 9.863843487951446, 9.863843487951446, 8.708392592365213, 8.708392592365213, -2.237894747626423, -2.237894747626423, 7.9395506884678015, 7.9395506884678015, 8.200723579024237, 8.200723579024237, 9.079795587817726, 9.079795587817726, 4.593484392935901, 4.593484392935901, 3.423012921270329, 3.423012921270329, 9.085265638704044, 9.085265638704044, 2.765687302953883, 2.765687302953883, 9.983816520555449, 9.983816520555449, 6.917734633911259, 6.917734633911259, 9.250265943924543, 9.250265943924543, 7.97411538205475, 7.97411538205475, -0.4604322042726886, -0.4604322042726886, 2.8925132521096915, 2.8925132521096915, 3.0207269457243946, 3.0207269457243946, 5.56125325208435, 5.56125325208435, 10.932588649989103, 10.932588649989103, -6.069758158475702, -6.069758158475702, 9.127961682231012, 9.127961682231012, 2.339795068368749, 2.339795068368749, 14.222639590980455, 14.222639590980455, 4.31542909007821, 4.31542909007821, 4.023578093284077, 4.023578093284077, -0.04850594579181877, -0.04850594579181877, 3.870836732014865, 3.870836732014865, 1.562914391871925, 1.562914391871925, 18.315562408647963, 18.315562408647963, 12.931457898424446, 12.931457898424446, 3.4551561853645207, 3.4551561853645207, 7.123660811744268, 7.123660811744268, 7.032556385431458, 7.032556385431458, 12.053345397907297, 12.053345397907297, 7.995882376090883, 7.995882376090883, 1.5776947102040597, 1.5776947102040597, 11.967253463914231, 11.967253463914231, 13.023522677353803, 13.023522677353803, 4.503645466236475, 4.503645466236475, 2.3785257299977376, 2.3785257299977376, 10.281693588378781, 10.281693588378781, 10.158466358133692, 10.158466358133692, 4.466098496566557, 4.466098496566557, 12.972452227673575, 12.972452227673575, 8.366360098754386, 8.366360098754386, 2.702946121766832, 2.702946121766832, -1.777141275320811, -1.777141275320811, 5.656406509871313, 5.656406509871313, 8.650838661167011, 8.650838661167011, 9.263136244136478, 9.263136244136478, 5.575275220725414, 5.575275220725414, 5.360837876347585, 5.360837876347585, 8.524817162454383, 8.524817162454383, 5.650277473418362, 5.650277473418362, 3.1725018178431132, 3.1725018178431132, 9.143563159207984, 9.143563159207984, 13.846317224905878, 13.846317224905878, 5.276276245749412, 5.276276245749412, 23.73647014141433, 23.73647014141433, 0.978050072108208, 0.978050072108208, 2.7507767067131215, 2.7507767067131215, 6.556671572152098, 6.556671572152098, 4.855996219839904, 4.855996219839904, 10.62638264936185, 10.62638264936185, 10.068020156703254, 10.068020156703254, 19.19457988520171, 19.19457988520171, 11.11070112916613, 11.11070112916613, 2.984733839639075, 2.984733839639075, 4.76812342734196, 4.76812342734196, 7.500745352376836, 7.500745352376836, 11.133882845076728, 11.133882845076728, 3.8820889819507256, 3.8820889819507256, 7.977113240870957, 7.977113240870957, 5.153452390161834, 5.153452390161834, 3.9409877684514116, 3.9409877684514116, 2.5051511927326353, 2.5051511927326353, 2.958944462613041, 2.958944462613041, 10.920966106695865, 10.920966106695865, 1.680610580823134, 1.680610580823134, 7.388230134118271, 7.388230134118271, 3.040356158536674, 3.040356158536674, 3.964205098993018, 3.964205098993018, 10.405877416773825, 10.405877416773825, 5.644724349092143, 5.644724349092143, 11.421463359076675, 11.421463359076675, 0.5038454794240707, 0.5038454794240707, 3.0499948755284896, 3.0499948755284896, 8.54943427389192, 8.54943427389192, 4.707030028709836, 4.707030028709836, 27.381781977951267, 27.381781977951267, 4.56947973473942, 4.56947973473942, 8.798041141262459, 8.798041141262459, 1.8979850655240549, 1.8979850655240549, 28.55001230869511, 28.55001230869511, 2.4937986895144464, 2.4937986895144464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960391475365437, "mean_inference_ms": 2.239127880862932, "mean_action_processing_ms": 0.10276353062105609, "mean_env_wait_ms": 0.6114404885300001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 50625, "timesteps_this_iter": 0, "agent_timesteps_total": 151875, "timers": {"sample_time_ms": 13587.036, "sample_throughput": 248.399, "load_time_ms": 0.496, "load_throughput": 6802064.293, "learn_time_ms": 1858.536, "learn_throughput": 1815.946, "update_time_ms": 23.837}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 27.800142097473145, "policy_loss": -0.028725604899227618, "vf_loss": 27.841675186157225, "vf_explained_var": -0.19379276037216187, "kl": 0.005489335037997647, "entropy": 1.2816362977027893, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.50231122970581, "policy_loss": 0.03634227178990841, "vf_loss": 10.477713346481323, "vf_explained_var": -0.06426650285720825, "kl": 0.005938589961330116, "entropy": 1.2338137209415436, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50625, "num_agent_steps_sampled": 151875, "num_steps_trained": 50625, "num_agent_steps_trained": 151875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2025, "training_iteration": 15, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-12-50", "timestamp": 1706105570, "time_this_iter_s": 13.227234840393066, "time_total_s": 193.10415124893188, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4B87550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 193.10415124893188, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.33529411764706, "ram_util_percent": 74.23529411764706, "gpu_util_percent0": 0.17705882352941174, "vram_util_percent0": 0.21989889705882354}}
{"episode_reward_max": 24.201207874388942, "episode_reward_min": -25.087231165576696, "episode_reward_mean": -0.3830990280890726, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -37.43348770263391, "policy_agent_": -5.390631600450439}, "policy_reward_max": {"policy_adversary_": -4.3479330903864515, "policy_agent_": 28.440533038863084}, "policy_reward_mean": {"policy_adversary_": -15.149995872975166, "policy_agent_": 7.383448422443046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4066871376519563, 6.2036176955665185, -15.658275026527711, -8.21840940434706, -7.30176950696583, 7.86296369830383, -4.545208597001319, 6.421919205033136, -2.441304147604837, -7.19333918159445, 2.3842681668680723, -2.75048251363507, -5.476060347019146, -0.31050430506342364, 2.464666091729814, 1.604045685252717, 0.2026897266377209, 2.208616013558349, -0.5600179686589855, 18.96689392940427, -3.7203087437995395, -2.84663194245318, 4.492975973196028, -10.379691671174838, -6.181088017087643, 5.26819264674303, 0.4470089365121434, -6.867783925123522, -3.0463064721923674, 0.675198910777816, -0.9924988066523209, -5.626405808308691, -8.982332782834936, -0.24450845789678388, 6.9792739301160225, -5.9089422185462, 5.283524407048425, 1.636362251016479, 24.201207874388942, -5.601543446231498, 6.4119522875360495, 1.8020676093486176, -4.400464176545713, -10.75653113390878, -25.087231165576696, 6.377135009673322, 6.32191592542738, -2.8042590144132893, 3.7813660293653673, 9.240536007296525, -1.670123353246094, 8.569904824368955, -4.09142367899397, -4.017571482215428, -3.3042645448641723, -5.179237255883891, -3.1681746050702646, -5.104219757588743, 3.5455564151458896, 8.317057250221339, -12.961419155676028, 12.050261832899768, -1.5941535475345372, -12.989104982219489, -7.920349865828682, -4.414939920067627, 7.081634161391856, 1.3991971112462882, 4.309866157319061, -1.1651569398564647, -13.94474861107832, -12.67893628245722, 1.8212834197583552, 3.5660046847868565, -0.8911707655462269, -0.9265428118745783, 3.4708835910020954, -17.17543987187697, 9.117001003202432, -1.1641050973221403, 2.9754036424170156, -1.2496793197663334, -5.644873117225332, 19.764623011334415, -12.1438257818072, -6.526761945583965, 4.00856642507522, -4.544859100720469, -0.2926312714450343, 6.296046021301037, -0.2513632086186841, -1.3747677759817152, 2.9783941292636653, 1.354790870093929, 7.9859860139317815, 13.146639923057823, 1.9374601881517037, -7.926242838560903, 6.335192132386858, 15.40056233693083, -13.32159688486712, 6.427838177020512, 4.881562777380317, 1.1769199418653755, 3.2748312848526053, -5.653388530275966, 0.8582915495903248, -2.5907152818908084, 3.092641296380345, 7.91979642814612, -1.0667831024059402, 3.7048312838963295, 2.3443856546872777, -5.251032963849766, -6.66456026428123, -5.075107847402423, 2.2285058521804233, -1.874471602323262, 4.280497975174033, -0.39384011806475117, -4.705258188206066, -1.4160389990316937, 0.06524180392760343, 0.8368117424051542, -7.007997317291522, 7.803550997165005, 2.0747236479701696, -1.8454301609261454, 0.8942221719243465, -5.488980087437164, -2.490426546409921, 7.045473807607009, 1.1902329835115883, -4.334375323509059, -4.684765297897967], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.028128500468355, -25.073884605775078, -22.308548466397845, -22.78447564175985, -18.71481877569992, -19.152613506192658, -8.08989738869663, -19.783330879086158, -12.443450807979483, -8.001741597462694, -19.414361367159653, -22.770905445846925, -25.271430730216082, -7.950065672990092, -21.086221751522892, -19.669891171414612, -11.621005808033164, -15.533673879413108, -17.537346999008367, -37.43348770263391, -4.3479330903864515, -22.56113004475777, -15.226705896891731, -13.2889063015877, -6.862149939541009, -15.833001628071033, -11.10106545398313, -9.974248485361043, -8.457957515444383, -6.2051342133247305, -14.910419100389475, -18.63683596497137, -13.445681470188385, -10.036175844791236, -24.191002731182905, -8.542656500243865, -17.633406278200024, -15.389451747665168, -32.679858203337226, -27.826450516459293, -18.0786277798061, -10.115117205209222, -5.8874803686553365, -17.770210730309127, -14.305967964675828, -17.58133730247346, -24.99821642875596, -6.994555915789059, -17.450999305701085, -26.0040683721922, -7.627995832527003, -26.70294732964141, -10.967451633401472, -15.61255055252373, -12.656875295823593, -18.772022580551454, -5.900445868496249, -5.671850570039342, -11.821848117354795, -19.094192797168763, -10.466325585588418, -24.99725681336735, -17.31436518560763, -12.510420913328366, -24.78315412637236, -5.6051197268588515, -27.214540233321316, -19.613600307947085, -18.4606765799819, -11.1963153229232, -9.471369921222113, -8.69806825449172, -10.066096599552182, -12.20673170018231, -21.086034138588698, -10.50397571788083, -16.8248602070137, -11.774188101684887, -25.929405129982698, -18.509694232513677, -9.474413302985303, -9.244146988455034, -5.783640560687903, -29.408255892771287, -8.298593818693337, -18.28942366944324, -12.846710335513384, -7.987181858195879, -11.170395584951919, -15.665973054525676, -9.488979404265248, -10.948984496514898, -18.989842544762812, -17.146929934867032, -20.5233810461788, -19.65467322195319, -16.12921241690154, -24.343615361530848, -14.405948175704543, -25.621340380763986, -16.469212794035332, -14.51563008013506, -15.366414444065757, -13.623985286053088, -10.392590809124593, -13.160963645126621, -22.129789429438386, -8.099446047092288, -13.373180118866394, -16.90838164848729, -18.61037413787831, -20.2491708665192, -9.33360997835562, -16.765585230737365, -5.926236444800884, -6.348428009066021, -14.046923334053542, -14.072220483433206, -22.644407704095116, -6.664792299654713, -10.45681876211222, -10.26112336830235, -8.242746586711675, -12.085592083725256, -15.443634692790326, -13.040875227832911, -10.569575824931789, -10.028960979664104, -8.62943481790894, -18.458890725901178, -7.018645629478604, -26.51339320116811, -12.424396592463738, -17.20140245380913, -9.684554690122626], "policy_policy_agent__reward": [2.810720681408201, 2.810720681408201, 15.638751150670798, 15.638751150670798, 3.3251367199350668, 3.3251367199350668, 7.2830331187064, 7.2830331187064, 5.70652463436704, 5.70652463436704, 13.507788602248242, 13.507788602248242, 1.7723443958476557, 1.7723443958476557, 13.10262504205965, 13.10262504205965, 5.001073330187323, 5.001073330187323, 0.4042012079341229, 0.4042012079341229, 10.89931476701386, 10.89931476701386, 10.010211466105929, 10.010211466105929, 9.897685191598466, 9.897685191598466, 3.819780683963334, 3.819780683963334, 11.775443921626357, 11.775443921626357, 10.636968428333665, 10.636968428333665, 5.911847767335445, 5.911847767335445, 8.871144946485728, 8.871144946485728, 8.48866451517469, 8.48866451517469, 28.200190816019088, 28.200190816019088, 0.31381217329345606, 0.31381217329345606, 9.8572490511523, 9.8572490511523, 9.859840935043882, 9.859840935043882, 1.454607315206431, 1.454607315206431, 0.34053096122668225, 0.34053096122668225, 10.550597137407028, 10.550597137407028, 5.774037195247638, 5.774037195247638, 1.5532322801187612, 1.5532322801187612, 2.7058255216260063, 2.7058255216260063, 3.4401665620512727, 3.4401665620512727, 6.958960146868575, 6.958960146868575, 6.505215078331338, 6.505215078331338, 2.2316743436767226, 2.2316743436767226, 4.895833693447226, 4.895833693447226, 15.585138330649466, 15.585138330649466, 1.3168571408488303, 1.3168571408488303, 11.458465342624223, 11.458465342624223, 8.512906999340824, 8.512906999340824, 28.440533038863084, 28.440533038863084, 11.112453535113898, 11.112453535113898, 12.245290033671075, 12.245290033671075, 5.958592407278921, 5.958592407278921, 0.7435080960548103, 0.7435080960548103, 3.5068397982001747, 3.5068397982001747, -5.390631600450439, -5.390631600450439, 11.979236156073396, 11.979236156073396, 15.66006617709167, 15.66006617709167, 2.0951484506878844, 2.0951484506878844, 10.616182667533227, 10.616182667533227, 17.622302189744364, 17.622302189744364, 2.978936239640455, 2.978936239640455, 17.636426077005186, 17.636426077005186, 3.4380139772037492, 3.4380139772037492, 5.79748953515415, 5.79748953515415, 4.67630537547971, 4.67630537547971, 6.796392662333777, 6.796392662333777, 1.366135631712992, 1.366135631712992, 0.2838154062252995, 0.2838154062252995, 7.683702266250344, 7.683702266250344, 13.705625023695053, 13.705625023695053, -1.2475467850437996, -1.2475467850437996, 18.523759323133554, 18.523759323133554, 7.860105819036544, 7.860105819036544, -0.23934203444556645, -0.23934203444556645, 8.431402130271842, 8.431402130271842, 0.5950899033956112, 0.5950899033956112, 17.14808719735658, 17.14808719735658, 10.506398709596688, 10.506398709596688, 11.385271368650482, 11.385271368650482, 5.015579191533368, 5.015579191533368, -2.2366893449281005, -2.2366893449281005, -1.9904340139827528, -1.9904340139827528, 5.94369000965527, 5.94369000965527, 7.886368192484587, 7.886368192484587, 10.097431686521228, 10.097431686521228, 4.788716453003127, 4.788716453003127, 10.1478718990079, 10.1478718990079, -2.700625885096054, -2.700625885096054, 17.52320306659257, 17.52320306659257, 8.672794567595767, 8.672794567595767, 6.2249084727011565, 6.2249084727011565, 3.9972338343443505, 3.9972338343443505, 0.06938372173128553, 0.06938372173128553, 24.58643945205285, 24.58643945205285, -1.9226159815569317, -1.9226159815569317, 5.881330861929641, 5.881330861929641, 8.427638380294304, 8.427638380294304, 1.7211613787377051, 1.7211613787377051, 5.438882156753443, 5.438882156753443, 10.981009537913357, 10.981009537913357, 4.618808097823283, 4.618808097823283, 4.787108360266593, 4.787108360266593, 10.984118337013236, 10.984118337013236, 9.25086040248048, 9.25086040248048, 14.25468353005529, 14.25468353005529, 16.400656572505504, 16.400656572505504, 9.033336302526624, 9.033336302526624, 8.208686261484972, 8.208686261484972, 10.370570154045703, 10.370570154045703, 20.510951358847407, 20.510951358847407, 1.5738079545841033, 1.5738079545841033, 10.471734128577783, 10.471734128577783, 10.12398861072303, 10.12398861072303, 7.400452613959232, 7.400452613959232, 6.833711046988601, 6.833711046988601, 3.753787557425327, 3.753787557425327, 11.494040489514354, 11.494040489514354, 2.754365382600739, 2.754365382600739, 8.232910707623365, 8.232910707623365, 12.414089038316703, 12.414089038316703, 8.771795517736184, 8.771795517736184, 11.977001075207767, 11.977001075207767, 5.838997816521449, 5.838997816521449, 5.757276133443801, 5.757276133443801, -0.3691619097401722, -0.3691619097401722, 0.6366600808317976, 0.6366600808317976, 8.137714593116982, 8.137714593116982, 6.098874440554974, 6.098874440554974, 13.462452839634572, 13.462452839634572, 3.13547609079498, 3.13547609079498, 2.875780286953078, 2.875780286953078, 4.422542184635329, 4.422542184635329, 4.1539941953196395, 4.1539941953196395, 6.461201913065205, 6.461201913065205, 4.217818687749403, 4.217818687749403, 10.42221311249896, 10.42221311249896, 6.322149736450978, 6.322149736450978, 4.091765409368979, 4.091765409368979, 4.761828494916645, 4.761828494916645, 6.484955319232012, 6.484955319232012, 2.2641095415343417, 2.2641095415343417, 16.779433504387555, 16.779433504387555, 6.807314787987664, 6.807314787987664, 6.433513565150032, 6.433513565150032, 2.4998946961123263, 2.4998946961123263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29556598379747534, "mean_inference_ms": 2.2340828012454663, "mean_action_processing_ms": 0.1021781360860927, "mean_env_wait_ms": 0.6105953092878258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 54000, "timesteps_this_iter": 0, "agent_timesteps_total": 162000, "timers": {"sample_time_ms": 13720.446, "sample_throughput": 245.983, "load_time_ms": 0.496, "load_throughput": 6802064.293, "learn_time_ms": 1863.765, "learn_throughput": 1810.85, "update_time_ms": 23.939}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 30.604817962646486, "policy_loss": -0.0018826495012035593, "vf_loss": 30.61959114074707, "vf_explained_var": -0.140968918800354, "kl": 0.003412948972889407, "entropy": 1.2894578576087952, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 13.43455238342285, "policy_loss": -0.007228034362196922, "vf_loss": 13.453235149383545, "vf_explained_var": -0.0813290536403656, "kl": 0.0054330002285145175, "entropy": 1.1998092412948609, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 54000, "num_agent_steps_sampled": 162000, "num_steps_trained": 54000, "num_agent_steps_trained": 162000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2160, "training_iteration": 16, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-13-03", "timestamp": 1706105583, "time_this_iter_s": 12.50911831855774, "time_total_s": 205.61326956748962, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.61326956748962, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.0125, "ram_util_percent": 73.94375000000001, "gpu_util_percent0": 0.21125, "vram_util_percent0": 0.219573974609375}}
{"episode_reward_max": 16.170964329999716, "episode_reward_min": -18.07331455519104, "episode_reward_mean": -0.6887821152570697, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -39.002256724587795, "policy_agent_": -4.663079955445484}, "policy_reward_max": {"policy_adversary_": -5.389402095634317, "policy_agent_": 22.600892948287697}, "policy_reward_mean": {"policy_adversary_": -15.191855523889872, "policy_agent_": 7.251536704316403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.113470991991404, 2.0298381360782916, -13.467518952710922, -0.48896354161373295, 9.146512675648367, 6.842303904479836, 5.706065419415727, -2.687418320646884, -10.150106887745654, -7.2658432420172145, 0.922354468893785, 0.532719458680212, -4.136897195025733, -8.423433200664968, 9.377401653456836, -0.6750988223825122, -3.2013413946215827, -7.392445684911605, 6.112492802311136, 4.7502713479267475, 1.9862467310704588, -12.708651600146974, 3.5390522447478987, 0.005741182902691877, 3.508440010083548, -3.090774419172365, -15.16237384391715, 1.6623688991499463, 4.3364876860674295, -8.16084083570793, 2.9484807030818723, 3.907625793414346, 0.3981552147215157, 2.4509744508303712, -1.4785984514498205, 4.13869458688738, 16.170964329999716, 0.05306803148012773, 4.885717278367903, -12.745503980347863, -6.192340022445936, 6.73453217030098, -0.19077606241856615, 9.280141125678314, -6.781713936263164, 1.6214634487623178, 2.8559592465521293, 7.64017293549931, -10.81735637983402, -2.659985598443717, -6.2095597142615855, 6.935415960099428, -2.288011628369033, -5.5040116779331285, -9.05399920364839, -10.59855046471021, -3.6552972699691857, -1.4816950962816056, 2.0264408979573294, 7.862629176286001, 1.0620241151288161, -0.1821456580049291, -4.057355928485324, -3.879132364444839, 2.9790409640770723, -1.9941383223046403, -7.902521596958218, -3.6916019130144004, -15.97720651240647, 3.5927852601651096, -2.4143587880281823, -0.5871983970395311, -6.017669576723339, -3.016016673679717, 4.37367476492045, -6.95519468458677, 7.9348526760771385, -0.12473336578356542, 2.44406804157886, -3.3752865345987564, 1.3617921414564118, -4.6175575461478395, 3.4841622673665897, 3.8205559794728514, 0.3072312711204441, -5.540650440893964, -5.847480507871806, 2.829583900386493, -4.010437549043961, -2.197445414356984, -8.798770198646471, 9.230437373405968, -7.163757571595913, -6.244037624113162, -2.189359864606214, 8.941001744822161, 8.091788343572688, -6.370085551507754, -13.945663694980915, 5.92837185586406, -1.6824217306098808, 0.3797164547654721, 1.3948464809575234, -2.532517487063252, -7.714747579036831, 12.628860876041765, 6.810301791381378, 10.434485987955137, -0.573293631762108, 0.3769575638664085, 8.078255436534171, 1.882793176713771, -3.1748704647581216, 7.70519671492048, 9.525860985828144, -3.7894363410925584, -18.07331455519104, -5.602450838648172, 8.019098850283248, -10.668724313916508, 1.5350720806855387, 0.2611597011002564, -0.7808671025773185, 7.688348600162398, 1.2996193895863484, -7.883642382308334, 1.6393746978739054, 1.782973654395673, -0.044374802072948, -8.753717508348135, -10.152478165685089, 1.82747524419732, -0.13473882224792025, 9.847871133647118, 5.5900233739472105], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.178077068510774, -9.58401022686004, -23.486628681794937, -15.62973797591996, -18.68710280042193, -14.394156733873714, -30.27180830229997, -6.6171007373403254, -11.014370347864775, -10.974886816363357, -6.216810034584894, -10.292739009909425, -16.871450038376715, -5.389402095634317, -17.618336064120847, -12.499134893326486, -15.46476134647931, -11.38910859571864, -20.731410897574328, -15.619791371137103, -13.614174720818026, -15.42284460091495, -22.594620897536643, -9.344102886144446, -17.062216808001832, -19.99759435422026, -8.935076684898727, -16.32142869244233, -12.55920665408865, -9.096551852043882, -15.647575417060585, -14.883638390726128, -15.186118906939017, -18.972652956905964, -20.03579158055784, -15.505951634475672, -29.030821566575685, -8.889953831053406, -15.314824318316267, -13.809128475460533, -13.312444179437579, -14.593879434484789, -21.766346386126624, -18.385053469172608, -8.166403684409604, -7.656431111595021, -14.675354438909277, -15.875154370867673, -10.207220958901447, -10.31987249972804, -6.602921412389199, -19.298603879623798, -7.899760344252536, -13.91304046364198, -23.01200265538877, -15.309385556312211, -12.421860666588532, -13.565160360999158, -9.137648631017083, -19.966367400286952, -11.279659744276048, -13.165356901750627, -14.935740523474083, -19.55065221384585, -13.254479032770474, -25.193415852492677, -17.86880898444815, -39.002256724587795, -12.012654329822997, -13.786182235906425, -16.275138163899474, -11.994645698757703, -13.152115229779174, -27.654806187021745, -22.422208156741167, -18.965602063220118, -19.246994608663705, -9.171178021905304, -14.245399040174801, -8.888411305468534, -12.345678650747544, -13.279894372426368, -8.460849181376737, -15.120061695278427, -25.468564230373357, -9.245955950836468, -13.698459213231281, -19.669572959189402, -8.895320598563945, -7.604446757498222, -16.7328796332185, -26.88638762131902, -11.551578679381862, -10.69287501096658, -9.77654542752972, -20.11307599953127, -15.1051120061888, -19.753700944642684, -8.960389801420465, -17.946183371398778, -15.326060739651087, -14.364019624433658, -17.11307052660204, -11.591380286176268, -7.070453803638761, -21.408164823128917, -24.933118840555746, -18.298708248815704, -9.828935403379152, -16.185652272727012, -21.216487052629486, -13.617269310385065, -15.100809961045732, -17.855350945561476, -28.33135951319332, -11.171445982474081, -8.74715464430007, -15.665546846871951, -18.997054986988353, -8.260784967821381, -19.224782272893844, -11.960772834045079, -9.15075415088456, -25.353524607937548, -10.18807845305875, -19.356286279488188, -17.698268100869935, -14.806821322677898, -19.816736634428324, -9.397585555148087, -5.956362088395065, -9.319503441346939, -15.41848102206198, -22.831302692646965, -17.725159193318756], "policy_policy_agent__reward": [0.032303038259689804, 0.032303038259689804, 5.806924181469165, 5.806924181469165, 5.009554864542005, 5.009554864542005, 7.570387217153113, 7.570387217153113, 13.916807738035152, 13.916807738035152, 10.61823031917678, 10.61823031917678, 17.988936860857855, 17.988936860857855, 1.9648412083467204, 1.9648412083467204, 0.43213173005956074, 0.43213173005956074, 1.854521787173071, 1.854521787173071, 3.5695822517393405, 3.5695822517393405, 5.4127292342948214, 5.4127292342948214, 6.3672764216754905, 6.3672764216754905, -1.5170155525153246, -1.5170155525153246, 13.497868858788845, 13.497868858788845, 5.912018035471986, 5.912018035471986, 6.131709975928863, 6.131709975928863, 1.9983314554035176, 1.9983314554035176, 13.421951849942731, 13.421951849942731, 10.185031359531928, 10.185031359531928, 7.800210725944244, 7.800210725944244, 1.3570965003839874, 1.3570965003839874, 13.06683657114227, 13.06683657114227, 4.674922034523568, 4.674922034523568, 10.28532840904269, 10.28532840904269, 8.453409967523953, 8.453409967523953, -3.1136485795092113, -3.1136485795092113, 8.99189879579614, 8.99189879579614, 8.44784717007804, 8.44784717007804, 0.467855508167979, 0.467855508167979, 9.298028060071232, 9.298028060071232, 9.395632092070239, 9.395632092070239, 7.792137060830266, 7.792137060830266, 10.71181370386816, 10.71181370386816, 9.278596564554011, 9.278596564554011, 9.822323110681527, 9.822323110681527, 22.600892948287697, 22.600892948287697, 4.471510931266768, 4.471510931266768, 10.100270798342082, 10.100270798342082, 0.5318122475563343, 0.5318122475563343, 3.5600520784958185, 3.5600520784958185, 10.664205802392884, 10.664205802392884, 10.787785161854028, 10.787785161854028, 13.832597297425458, 13.832597297425458, 0.6923448740732173, 0.6923448740732173, 4.6389472801786695, 4.6389472801786695, 8.765656842730701, 8.765656842730701, 11.757663653183494, 11.757663653183494, -0.30506771046628367, -0.30506771046628367, 3.8299434506421632, 3.8299434506421632, 0.19668084906380598, 0.19668084906380598, 13.117009919861612, 13.117009919861612, 2.805874357941753, 2.805874357941753, 4.204514392854425, 4.204514392854425, 6.979001725870189, 6.979001725870189, 2.355417545801002, 2.355417545801002, 4.383281698309672, 4.383281698309672, 6.041732632358775, 6.041732632358775, 5.582044764487206, 5.582044764487206, 13.914498288286477, 13.914498288286477, 6.1708419297024335, 6.1708419297024335, 6.491605621872849, 6.491605621872849, 5.439192297494378, 5.439192297494378, 7.835759924700504, 7.835759924700504, 8.116759998423776, 8.116759998423776, 11.599638765094019, 11.599638765094019, 4.983143693744967, 4.983143693744967, 17.655327405786693, 17.655327405786693, -1.982276091291736, -1.982276091291736, 8.68948374803577, 8.68948374803577, 6.9303896879356435, 6.9303896879356435, 5.703723650859086, 5.703723650859086, 3.5672228265279164, 3.5672228265279164, 12.319394756671016, 12.319394756671016, 13.397941460830811, 13.397941460830811, 6.005203689316674, 6.005203689316674, 13.590923642370418, 13.590923642370418, 4.523222328060869, 4.523222328060869, 8.34473354087683, 8.34473354087683, 2.7565623854348873, 2.7565623854348873, 6.853735396101977, 6.853735396101977, 4.331168413139266, 4.331168413139266, 5.972505724371664, 5.972505724371664, 9.470308837375638, 9.470308837375638, 12.887897750746903, 12.887897750746903, 1.852652754971252, 1.852652754971252, 3.9254893526797376, 3.9254893526797376, 11.249578429787947, 11.249578429787947, 2.4424415247599915, 2.4424415247599915, 2.7035006715706196, 2.7035006715706196, 3.9670547172860102, 3.9670547172860102, 18.058412497362493, 18.058412497362493, 2.1939105538929766, 2.1939105538929766, 2.224418693426708, 2.224418693426708, 3.793592781461754, 3.793592781461754, 14.52703887217671, 14.52703887217671, 11.598450174880744, 11.598450174880744, 6.691807696567461, 6.691807696567461, -2.4926369467802183, -2.4926369467802183, 11.937277613631418, 11.937277613631418, 6.8218195045206045, 6.8218195045206045, 7.371868039599562, 7.371868039599562, 9.253958503779781, 9.253958503779781, 4.529431399556505, 4.529431399556505, -0.3221468876990368, -0.3221468876990368, 17.01851284958534, 17.01851284958534, 15.871710315968569, 15.871710315968569, 14.36659711838542, 14.36659711838542, 4.627820885808522, 4.627820885808522, 8.28130491829671, 8.28130491829671, 14.64737124458183, 14.64737124458183, 7.750031243549418, 7.750031243549418, 5.962969748143805, 5.962969748143805, 12.780273830240972, 12.780273830240972, 18.928610249510733, 18.928610249510733, 3.6910048206907624, 3.6910048206907624, -4.663079955445484, -4.663079955445484, 5.03154800411189, 5.03154800411189, 13.508076918635794, 13.508076918635794, -1.2039696730475646, -1.2039696730475646, 10.379927176789687, 10.379927176789687, 6.1109662675726675, 6.1109662675726675, 4.184943524153621, 4.184943524153621, 16.520936604049975, 16.520936604049975, 5.7438489213225505, 5.7438489213225505, 5.736321948589924, 5.736321948589924, 9.668821399371918, 9.668821399371918, 8.294897488536787, 8.294897488536787, 9.886180916177684, 9.886180916177684, 0.32193402339997784, 0.32193402339997784, -2.098058038645007, -2.098058038645007, 5.57348934277213, 5.57348934277213, 7.64187109990703, 7.64187109990703, 16.33958691314704, 16.33958691314704, 11.657591283632984, 11.657591283632984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29540078985330437, "mean_inference_ms": 2.2307073082798254, "mean_action_processing_ms": 0.10212633909913899, "mean_env_wait_ms": 0.6101650912841792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 57375, "timesteps_this_iter": 0, "agent_timesteps_total": 172125, "timers": {"sample_time_ms": 13622.864, "sample_throughput": 247.745, "load_time_ms": 0.496, "load_throughput": 6801410.657, "learn_time_ms": 1875.668, "learn_throughput": 1799.359, "update_time_ms": 24.734}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 28.0957389831543, "policy_loss": 0.0019493677682476118, "vf_loss": 28.10590763092041, "vf_explained_var": -0.14719146490097046, "kl": 0.0038804526254109573, "entropy": 1.2122562050819397, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 11.102076005935668, "policy_loss": -0.014625578187406063, "vf_loss": 11.127824068069458, "vf_explained_var": -0.06777013540267944, "kl": 0.0063102827570119535, "entropy": 1.1753321886062622, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57375, "num_agent_steps_sampled": 172125, "num_steps_trained": 57375, "num_agent_steps_trained": 172125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2295, "training_iteration": 17, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-13-16", "timestamp": 1706105596, "time_this_iter_s": 12.763190269470215, "time_total_s": 218.37645983695984, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D80310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 218.37645983695984, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.46875, "ram_util_percent": 74.1875, "gpu_util_percent0": 0.0625, "vram_util_percent0": 0.2135467529296875}}
{"episode_reward_max": 15.117317386274351, "episode_reward_min": -19.088810608037164, "episode_reward_mean": -0.7305100050087509, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.96226980382586, "policy_agent_": -4.073174927293021}, "policy_reward_max": {"policy_adversary_": -5.052467582707116, "policy_agent_": 23.03570566470595}, "policy_reward_mean": {"policy_adversary_": -14.91314785662478, "policy_agent_": 7.091318925808016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.636885065102627, 4.85297379770132, 5.969847956500619, -4.585113884121239, -12.417512692563749, 8.519718600421543, 8.49313915148058, -2.4094562749423014, -15.541207076762479, 1.0282327859792149, -1.1295064733054048, 2.8337774247970318, -11.978516995683288, -2.7638665340731703, 6.701215143653659, 2.1387084508104937, -11.34800555690118, 9.53523437541181, -10.92424682455182, -3.7823502754853866, 4.590253513530522, -13.707684853070413, 1.4113552920716015, 5.360487542088026, -2.786472889368576, -5.4270812950024485, 2.8730415089285177, 3.9086781847989327, -2.824591563005768, 1.598570731669886, -8.48252912302283, 5.497149747523039, -4.533529330391028, -0.7138455978325158, -3.087047326010443, 2.927706646210207, 3.2460671952196867, -0.6726649287801214, 6.347167742772308, -3.0967504401437846, 2.038024039933422, 1.4611148076745428, 2.1011753237649686, 0.14771236890783324, 9.016871536437558, -1.3335248120107184, 1.8260493620356015, -1.8459117231300932, 6.372145508680847, 2.3924615748822338, -2.3779551280508286, 8.635958663504537, 5.982716763684446, -2.8049429902765413, -8.437897014497882, 2.333057037241685, -2.5195870515929357, -4.254043718989433, -2.5967980802551174, 4.938225032686514, 4.813102927484629, 4.467069872232287, -5.48592205267867, 6.066387130424323, -9.660228123554797, 2.3193190133433337, -3.6790337645620124, -7.064555500480783, 4.1026922783622295, 14.109141525586049, 4.596838898702267, 1.8621543133414722, 3.7802276871008065, -10.934308114883995, -15.951901907015246, 5.12720980804514, -7.515710476322425, -3.388452742678418, -0.17440586448726697, -0.3982057226108404, 1.179889221490254, 4.565385009950358, 2.732380415592413, 3.784097924437337, 2.4393209518857653, 1.7715361081097587, -0.6142635647033998, -15.182551854275232, -1.4393698058173165, -4.626223219485785, 0.22448349349994423, -7.804586038166359, -6.582348278685864, -8.254344945444078, -1.7762745775216842, -9.505481025925658, -1.584109894062499, -1.3024203930899456, -2.2477429587437476, 4.735155093732711, -8.664407024952908, -9.376639507590996, 4.827919224018564, 0.8841083058085294, -4.848450664537905, 4.0147016498979085, 3.2298506433760092, -3.6946120681113097, -19.088810608037164, 2.535500804372486, 2.237192825158221, 2.68115442762129, 5.403151202598782, -8.593656311685397, -6.188797451361607, 2.381871576757495, -8.714911663409689, 15.117317386274351, 3.4969029013098947, -9.683167480625904, 1.6566946090366965, -1.1737681602895453, -4.04811161841934, -5.5905689927843065, -7.904655576138375, 5.867926994355673, -7.554870077307604, 0.8401086384352948, 2.5456793375326523, 8.961310353690589, 4.794516016414287, 1.535477563996914, 4.692519244909379, 3.456819623457154, 2.782590059844381], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.09435669560772, -13.440487320039853, -25.6384362179301, -8.43973682120461, -10.249657395137117, -16.58047906305098, -20.930542513393764, -11.652310537118401, -8.855304123003162, -14.051603658911635, -14.828810538991567, -15.428851136075302, -25.077827442782457, -12.257283109704604, -20.172530885774346, -23.648011149875288, -9.080136874550808, -26.0744060327788, -7.174961115161505, -13.397298346817855, -15.317825186646132, -14.603455209702195, -14.472649920971518, -25.614202858785163, -10.000099715070556, -11.741830776894295, -13.610263321512342, -11.943563976647567, -11.402607727668284, -11.740465371653915, -12.957508863349464, -15.83870339976045, -11.057743873049926, -9.976361006203158, -25.433774336108506, -20.776746368559966, -12.366252373537922, -24.18151841199578, -17.46718383774028, -11.371615469893634, -8.10210569373075, -9.735609097111405, -13.026006953590095, -8.882392559482911, -25.78460766681791, -20.410513630265342, -10.614439405001892, -18.47510449567017, -12.863064530767598, -17.311940432525034, -13.14925397964516, -24.021646415561328, -28.774158941316628, -17.239580709232158, -5.052467582707116, -20.093893099077622, -17.61796772863679, -10.775982171271396, -8.303512595261726, -15.347468378356306, -12.39996168160192, -10.209291266831197, -12.161153039787555, -14.337971435726809, -8.935075538565163, -12.898181887517776, -5.723586248694482, -12.76819024214526, -24.878547296019757, -31.96226980382586, -25.294432778831624, -16.762285896362332, -26.968059579998176, -19.75823067917602, -7.805552052429196, -8.193535444859393, -16.797808956341036, -11.400113954127818, -15.524597472352044, -17.669163144284994, -11.42243381389177, -15.001439749075029, -14.307466430955527, -18.17474074572132, -9.359932619100187, -6.675518010454818, -14.962038398316338, -10.72041913922751, -7.45985578357597, -17.718438241820092, -19.7481011308904, -23.08641789740903, -12.561222913043999, -10.834302245283796, -13.31228322920636, -9.709439912182912, -10.823506792053626, -9.918599343433206, -6.669428529268746, -15.627808463187137, -15.248161971734223, -21.84801864566698, -14.372132520736514, -16.496367348215493, -14.209436536009319, -16.96989562294363, -14.574583504189732, -5.869503670099654, -13.50202074869593, -16.041470143074502, -16.23475206053996, -12.358934415375899, -17.661935977769048, -14.359714126841764, -14.600172879510833, -14.90038445831258, -10.005007264008112, -28.193654456539612, -18.006223643391735, -10.714993911447785, -17.498924615420425, -11.608505925188533, -7.22873246357566, -15.69679254903917, -12.66360262690463, -14.530486371699924, -10.22963865504338, -21.867932665280783, -17.93122734214917, -21.53590126854861, -16.982623831630473, -11.654117333685722, -13.174318328311239, -12.450229973918875, -10.984041951579176], "policy_policy_agent__reward": [2.228735815252545, 2.228735815252545, 9.146730558870587, 9.146730558870587, 15.80414208721536, 15.80414208721536, 1.9273114685416841, 1.9273114685416841, -1.0839276487133187, -1.0839276487133187, 12.55009883173626, 12.55009883173626, 14.711840832437174, 14.711840832437174, 4.62142713108805, 4.62142713108805, -3.342951476879662, -3.342951476879662, 7.539918222445427, 7.539918222445427, 6.849652032843082, 6.849652032843082, 9.131314280436163, 9.131314280436163, 6.549655223549586, 6.549655223549586, 4.746708287815718, 4.746708287815718, 13.436873014714001, 13.436873014714001, 12.893359800342896, 12.893359800342896, -1.1339343411751852, -1.1339343411751852, 17.804820204095307, 17.804820204095307, -1.874642854695157, -1.874642854695157, 4.807474035666231, 4.807474035666231, 9.954039350088326, 9.954039350088326, 0.44788517831588937, 0.44788517831588937, 7.942002606521562, 7.942002606521562, 15.487345200436598, 15.487345200436598, 3.606813412850989, 3.606813412850989, 3.157374740945924, 3.157374740945924, 8.24165241522043, 8.24165241522043, 7.92612108072325, 7.92612108072325, 4.289008082331259, 4.289008082331259, 6.669518051661902, 6.669518051661902, 2.237489870163314, 2.237489870163314, 10.667926573641743, 10.667926573641743, 3.262107271329451, 3.262107271329451, 4.63125770418532, 4.63125770418532, 11.17336350504903, 11.17336350504903, 11.852226507385087, 11.852226507385087, 7.806159784378802, 7.806159784378802, 11.754426741607828, 11.754426741607828, 11.907175790256298, 11.907175790256298, 4.1374325148749245, 4.1374325148749245, 5.070064866832083, 5.070064866832083, 5.598361952392975, 5.598361952392975, 7.563591138677531, 7.563591138677531, 4.515052464195372, 4.515052464195372, 17.400739601627734, 17.400739601627734, 9.538494409127313, 9.538494409127313, 6.220244383518746, 6.220244383518746, 8.31459638627004, 8.31459638627004, 9.617605019724223, 9.617605019724223, 9.852201003703636, 9.852201003703636, 5.385649425797165, 5.385649425797165, 16.328802539532937, 16.328802539532937, 17.37843785250054, 17.37843785250054, 7.217318859477812, 7.217318859477812, -1.6927147158953861, -1.6927147158953861, 11.21347506815965, 11.21347506815965, 7.549190338521928, 7.549190338521928, 3.260969226140983, 3.260969226140983, 2.8533572575033044, 2.8533572575033044, 10.142846705521409, 10.142846705521409, 8.606532304543272, 8.606532304543272, 7.338180569531745, 7.338180569531745, 3.337615493554447, 3.337615493554447, 10.202179283075568, 10.202179283075568, -0.3625762924948157, -0.3625762924948157, 7.6087504504305565, 7.6087504504305565, 1.0222762420662337, 1.0222762420662337, 2.8518173708322383, 2.8518173708322383, 14.490619787190996, 14.490619787190996, 23.03570566470595, 23.03570566470595, 14.945635838766943, 14.945635838766943, 9.312220104851903, 9.312220104851903, 15.374143633549492, 15.374143633549492, 4.4119612821460175, 4.4119612821460175, -4.073174927293021, -4.073174927293021, 6.660372626452266, 6.660372626452266, 4.641049240009304, 4.641049240009304, 4.0058306057247, 4.0058306057247, 7.67509580393239, 7.67509580393239, 8.635478710837075, 8.635478710837075, 6.301161517691014, 6.301161517691014, 9.783412379512693, 9.783412379512693, 8.51992342327397, 8.51992342327397, 10.979419335079328, 10.979419335079328, 5.899626785492976, 5.899626785492976, 4.223527059282288, 4.223527059282288, 7.173887416806469, 7.173887416806469, -2.231066357523865, -2.231066357523865, 3.0102429888793267, 3.0102429888793267, 6.546107511167156, 6.546107511167156, 9.986292312195175, 9.986292312195175, 7.640915929621334, 7.640915929621334, 2.9894373171790694, 2.9894373171790694, 1.2899786499198587, 1.2899786499198587, 5.7680043258423375, 5.7680043258423375, 0.10197944312862403, 0.10197944312862403, 4.619698448995562, 4.619698448995562, 4.308089475171631, 4.308089475171631, 2.210842785262499, 2.210842785262499, 10.181481778459922, 10.181481778459922, 3.2918774733906537, 3.2918774733906537, 6.235689569037989, 6.235689569037989, 9.60002587237754, 9.60002587237754, 8.69023782701201, 8.69023782701201, 4.680492935735703, 4.680492935735703, 10.492298636420774, 10.492298636420774, 8.902217073782868, 8.902217073782868, 1.0874458009941728, 1.0874458009941728, -2.793394929670615, -2.793394929670615, 9.288485473723494, 9.288485473723494, 9.235972442849091, 9.235972442849091, 7.520044421498595, 7.520044421498595, 11.532543590183918, 11.532543590183918, 2.883028907578183, 2.883028907578183, 4.205687714074613, 4.205687714074613, 8.641128017535037, 8.641128017535037, 0.645047800299211, 0.645047800299211, 21.655485921406985, 21.655485921406985, 10.751563272350813, 10.751563272350813, 0.5159132154109412, 0.5159132154109412, 9.57780961222856, 9.57780961222856, 5.217368882449493, 5.217368882449493, 1.5903104225781597, 1.5903104225781597, 5.053111778127433, 5.053111778127433, 2.379473525383127, 2.379473525383127, 10.199206683027796, 10.199206683027796, 1.3373842888678904, 1.3373842888678904, 11.354020651858038, 11.354020651858038, 10.23845333984091, 10.23845333984091, 15.248605811119603, 15.248605811119603, 10.888569924022377, 10.888569924022377, 6.5947974488413195, 6.5947974488413195, 8.933418786610305, 8.933418786610305, 7.953524798688016, 7.953524798688016, 6.8833160057117775, 6.8833160057117775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2957406697980909, "mean_inference_ms": 2.237001980294179, "mean_action_processing_ms": 0.10207517173080358, "mean_env_wait_ms": 0.6115011505806024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 60750, "timesteps_this_iter": 0, "agent_timesteps_total": 182250, "timers": {"sample_time_ms": 13636.876, "sample_throughput": 247.491, "load_time_ms": 0.496, "load_throughput": 6801410.657, "learn_time_ms": 1880.678, "learn_throughput": 1794.566, "update_time_ms": 25.04}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 27.033865547180177, "policy_loss": -0.0022763352160836805, "vf_loss": 27.04798126220703, "vf_explained_var": -0.17940301895141603, "kl": 0.0038880994589284346, "entropy": 1.1841035723686217, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.458757781982422, "policy_loss": -0.005473398603498936, "vf_loss": 10.475001001358033, "vf_explained_var": -0.05903787016868591, "kl": 0.007741999487711473, "entropy": 1.1543876945972442, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60750, "num_agent_steps_sampled": 182250, "num_steps_trained": 60750, "num_agent_steps_trained": 182250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2430, "training_iteration": 18, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-13-29", "timestamp": 1706105609, "time_this_iter_s": 13.301033735275269, "time_total_s": 231.6774935722351, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5ECE940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 231.6774935722351, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.27058823529411, "ram_util_percent": 74.07058823529412, "gpu_util_percent0": 0.05588235294117648, "vram_util_percent0": 0.21942497702205882}}
{"episode_reward_max": 15.65645805865506, "episode_reward_min": -19.532778713671334, "episode_reward_mean": -0.8921426622526462, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.054694410953026, "policy_agent_": -5.823504145962946}, "policy_reward_max": {"policy_adversary_": -4.633290898715586, "policy_agent_": 20.708824363210773}, "policy_reward_mean": {"policy_adversary_": -14.053143953107792, "policy_agent_": 6.580500645427574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5717451546210857, -1.331924589282907, -1.970622181334698, 0.38710285627260277, -3.05656642111005, 2.295270047963039, 5.69312529678977, -1.2125736557438578, 0.10832394689469022, -3.3192167383340694, 8.147706678880237, -3.624801223583716, -4.226261028631227, -0.2167524828047186, 3.7190943249628785, 0.23175080529825698, -3.190066975385791, -3.4407726228406865, -5.971276394409026, 2.2890667209707285, -11.168896474682915, 0.5943973668649951, -5.628668578660101, -1.3970600839019545, 5.048888199060221, -3.533588733595394, -3.9070042480651193, -0.8444393083598603, -3.7663069459301006, -2.9621947249328047, -7.930529405423786, -3.252345714615322, -7.849349778788956, -10.264458032283374, -2.2074596895469716, -10.760921445246657, -17.921780988766457, 9.475390075732442, 5.259016883643319, 2.5326880564272773, 9.436875076635957, -2.101489875989006, 1.6238529314087384, -18.014633658371647, 14.275638647423607, -0.386362191629376, 1.6289912332453702, -1.091756266517729, -10.187743951124135, -7.738642092379276, -4.2544782514024515, 1.000884761273515, -19.532778713671334, -2.2546413172885327, 0.14560554786058, 4.285540956990097, 4.7649535592268055, 2.03500448801802, 11.464259087739235, 9.182506832898603, 13.878626342280961, 2.9329942691354987, -0.4605828865339374, 1.1246359017452288, 0.9294532551035151, -2.554214091437261, -3.0114517673659957, -0.15003798789081318, -3.626262019590788, -2.7201435369322415, 3.833573175408328, -1.942981392038762, -2.153507266967882, 1.756290872287583, -6.334383094175873, 1.1259180017869448, -1.9557895135105785, -0.09265884027093224, 15.65645805865506, -4.385067088663291, 3.9172183262380065, -3.499194825486343, -0.51094053278575, -2.2930850414197232, 11.314423016441499, -0.7684205470702832, 5.128593459296288, -10.845765308556455, 2.1284027969851116, -12.662240906548588, 4.004443222736187, -5.217774697441168, 0.6983589433918479, -1.6969985105205359, 1.593222555361162, 8.449904449221206, -1.145111661576279, -2.6573129030456935, 2.66563764009857, -2.8374455396872347, -3.5094689852928553, -1.2094845776439653, 7.139187347290996, -11.613900517456623, 1.2162381373921693, -0.7037540787541715, -5.1143004781877925, -4.31084929655089, -1.8897068619284993, 8.84266878234604, -8.139843230653383, -0.3688879147634443, -3.5100868024002247, -7.2979249305333695, -6.05849738588526, 8.402609447880058, 0.18254050859379717, -6.443440612564425, -5.896171649987245, 0.4058198550711123, 1.0914961212111738, 1.6323902098873901, 0.032776372960131916, -0.28272344938792887, -6.132689072457859, -10.943004246818719, 5.493720345637082, 0.2707556168328571, -0.6246606527068546, 5.037352685273781, 1.2544062932120508, -5.43005340647946, 4.934339670154722, -7.216974959356369, 6.024763232834116], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.435862907644488, -16.903912272115388, -7.847003439605969, -7.7570133374379475, -28.054694410953026, -8.501630267401096, -18.584007798447832, -7.955410480707717, -8.521002655121908, -9.40958533343482, -13.645752605292774, -6.840454938977134, -9.056638110816392, -13.36056401176456, -12.0998558088849, -11.449597913601192, -10.815852463298965, -12.131669326109066, -10.845849863710981, -9.048536415533816, -9.901360879316739, -16.2999244360279, -6.898495338439974, -7.36247202362971, -11.668291030037599, -9.986745974136285, -12.78096031422057, -10.237590347436134, -11.100944664612381, -6.842244435684173, -11.902454240113164, -12.159738044962893, -4.633290898715586, -6.591088019830682, -8.898898650903627, -10.749627629898995, -24.185764845784014, -17.906362819496405, -17.657653661104575, -15.006958660658455, -18.838479282885512, -13.608695848509457, -12.422842438673312, -19.969913662395964, -27.142010078997945, -10.949943388143085, -19.3950583055449, -8.561545637835374, -10.030380058928367, -8.547570721415214, -15.07075428873633, -10.540136580731536, -7.885770421745456, -17.86342914466613, -19.301967639828455, -23.39512345905903, -15.247978048151161, -17.892472633626898, -17.819604493312077, -20.982589222969747, -24.092250683819675, -18.107673310904065, -9.785008849955261, -15.354685727106292, -13.867599451484336, -17.38162456262483, -6.670800318551045, -19.334344029359325, -25.455507280316024, -9.277817274599272, -13.393088570886125, -12.510837497380683, -8.257582295166017, -13.946752806621088, -14.374175044205963, -6.925651276548543, -17.89977889447688, -13.36912344226512, -23.854341692495844, -14.499432922392929, -18.424255644615155, -11.025673004893694, -8.617578440083127, -21.887670547228613, -22.26950217010927, -9.399271333054436, -24.43705593484613, -11.476203582061597, -18.62591570308865, -17.709763092839548, -17.795989035611115, -11.841973769312794, -11.708921955590933, -11.738650687745826, -16.849414579480772, -24.4496434816298, -8.19554921887503, -5.447656320481302, -17.731052493285738, -9.680083833798253, -18.367864771959674, -7.739200131585637, -20.627372147361033, -14.77375957076317, -16.082531470226716, -13.522294153269051, -11.710854761517673, -11.731920057843462, -14.874347653389732, -18.691112155801065, -9.828131791238508, -24.58251635011781, -5.3978231320956755, -6.1422409086010115, -18.45375669161043, -22.462469398297948, -19.6273964696538, -11.607949911833481, -8.360430530593298, -10.575069984210273, -15.77118642271022, -14.48531942607401, -14.42475569089739, -21.664220372730714, -16.45260436158118, -11.536702392312476, -15.268921883871988, -7.706933685581063, -19.131351664478384, -14.239697457105159, -15.386043940310783, -17.08073867002156, -16.5956431525125, -7.696452216935898, -19.402892898642513], "policy_policy_agent__reward": [9.003804031132786, 9.003804031132786, 7.785993841416237, 7.785993841416237, 2.9381906291356366, 2.9381906291356366, 4.072058096855274, 4.072058096855274, 12.499063994921485, 12.499063994921485, 5.398450157682068, 5.398450157682068, 12.138566547618804, 12.138566547618804, 3.3714184124819293, 3.3714184124819293, 4.314663301008298, 4.314663301008298, 3.0451842975503753, 3.0451842975503753, 10.896729642086502, 10.896729642086502, 1.6078268576967079, 1.6078268576967079, 2.4151885410925824, 2.4151885410925824, 6.57190576447992, 6.57190576447992, 7.909475066923888, 7.909475066923888, 5.840674359449723, 5.840674359449723, 3.8128927439565867, 3.8128927439565867, 4.345448351634189, 4.345448351634189, 2.4372867346509794, 2.4372867346509794, 5.668801568252274, 5.668801568252274, -0.6337677976830861, -0.6337677976830861, 8.447160901446448, 8.447160901446448, 0.6349133798899378, 0.6349133798899378, 2.982705969863877, 2.982705969863877, 8.358589614548906, 8.358589614548906, 3.226578620270445, 3.226578620270445, 4.43697803307773, 4.43697803307773, 4.696575519538139, 4.696575519538139, 3.6673188593411394, 3.6673188593411394, 1.9400248553756825, 1.9400248553756825, 1.985962417344686, 1.985962417344686, 4.453696165173785, 4.453696165173785, -1.6080294400366857, -1.6080294400366857, -1.8366850062263502, -1.8366850062263502, 3.3457194806783277, 3.3457194806783277, -0.00564690767382918, -0.00564690767382918, 3.1319919285087767, 3.1319919285087767, 13.69087644761442, 13.69087644761442, 11.458335272373947, 11.458335272373947, 8.769823358542865, 8.769823358542865, 14.137677179760734, 14.137677179760734, 5.753602986260225, 5.753602986260225, 7.023347685041027, 7.023347685041027, 0.9776400020121583, 0.9776400020121583, 20.708824363210773, 20.708824363210773, 5.281790598256854, 5.281790598256854, 10.512024769395131, 10.512024769395131, 3.7348946856588223, 3.7348946856588223, -0.07868194609788515, -0.07868194609788515, 0.4044643145179717, 0.4044643145179717, 5.408138018666939, 5.408138018666939, 5.770510671002525, 5.770510671002525, -5.823504145962946, -5.823504145962946, 7.8043939136888, 7.8043939136888, 9.723786593844519, 9.723786593844519, 13.840332208024563, 13.840332208024563, 10.00646580368898, 10.00646580368898, 9.963738560822462, 9.963738560822462, 14.641931790525657, 14.641931790525657, 15.082548027934175, 15.082548027934175, 18.98543851305032, 18.98543851305032, 10.520333790019782, 10.520333790019782, 4.6622129817106615, 4.6622129817106615, 8.239660814425761, 8.239660814425761, 7.398526353293926, 7.398526353293926, 7.413705235593779, 7.413705235593779, 1.829674275592524, 1.829674275592524, 9.592153020734255, 9.592153020734255, 10.91462263036262, 10.91462263036262, 3.278836868833514, 3.278836868833514, 8.613330873147229, 8.613330873147229, 5.28392805267096, 5.28392805267096, 3.052037514099068, 3.052037514099068, 7.851521839454336, 7.851521839454336, 4.019895975015044, 4.019895975015044, 4.025784639167743, 4.025784639167743, 7.97199469048315, 7.97199469048315, 6.638232300997098, 6.638232300997098, 19.75539987557546, 19.75539987557546, 5.057182916864818, 5.057182916864818, 11.17073698542658, 11.17073698542658, 3.7632390897036747, 3.7632390897036747, 4.053318953648688, 4.053318953648688, 9.797292752904443, 9.797292752904443, 16.79196259327538, 16.79196259327538, 4.315425392992077, 4.315425392992077, 14.782824697071206, 14.782824697071206, 0.31521913675257207, 0.31521913675257207, 10.377159250036884, 10.377159250036884, 2.523761093145482, 2.523761093145482, 10.90021612917365, 10.90021612917365, 3.3120995359358116, 3.3120995359358116, 6.2036404494913935, 6.2036404494913935, 5.020826088612646, 5.020826088612646, 9.221318567420967, 9.221318567420967, 16.44977396542551, 16.44977396542551, 3.525218778649374, 3.525218778649374, 1.395171708717804, 1.395171708717804, 10.198345066692156, 10.198345066692156, 3.421319147055511, 3.421319147055511, 7.429197893333412, 7.429197893333412, 3.2648577769708362, 3.2648577769708362, 13.883279747326009, 13.883279747326009, 1.5799295266532734, 1.5799295266532734, 8.649384803809443, 8.649384803809443, 6.409270037257441, 6.409270037257441, 3.2982771416649417, 3.2982771416649417, 3.7105353806462835, 3.7105353806462835, 6.492320395730615, 6.492320395730615, 13.766890469073552, 13.766890469073552, 0.844144280292561, 0.844144280292561, 12.10681421767718, 12.10681421767718, 0.9438681648477258, 0.9438681648477258, -0.577842010966179, -0.577842010966179, 6.197629652862583, 6.197629652862583, 15.432539423089, 15.432539423089, 9.904968489123803, 9.904968489123803, 2.5822546496345296, 2.5822546496345296, 1.232129440303025, 1.232129440303025, 5.490444919640692, 5.490444919640692, 8.431341271960699, 8.431341271960699, 8.058854817980697, 8.058854817980697, 7.228766031928764, 7.228766031928764, 10.690748461671394, 10.690748461671394, 5.1599576445616595, 5.1599576445616595, 0.2968490727468819, 0.2968490727468819, 10.381321114754533, 10.381321114754533, 3.98884465120696, 3.98884465120696, 9.253345505885761, 9.253345505885761, 9.638525071189468, 9.638525071189468, 8.320225116761414, 8.320225116761414, 5.825342631771052, 5.825342631771052, 10.764991411333616, 10.764991411333616, 0.2397386287897627, 0.2397386287897627, 12.713828065738305, 12.713828065738305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29462434461343034, "mean_inference_ms": 2.2325558721448564, "mean_action_processing_ms": 0.10192730690954362, "mean_env_wait_ms": 0.610257383183523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 64125, "timesteps_this_iter": 0, "agent_timesteps_total": 192375, "timers": {"sample_time_ms": 13634.393, "sample_throughput": 247.536, "load_time_ms": 0.496, "load_throughput": 6801410.657, "learn_time_ms": 1880.27, "learn_throughput": 1794.955, "update_time_ms": 25.036}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 22.487499618530272, "policy_loss": -0.005468295630998909, "vf_loss": 22.504569435119627, "vf_explained_var": -0.1591809034347534, "kl": 0.0037713719120743396, "entropy": 1.1601161718368531, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 8.88321418762207, "policy_loss": -0.0018167893402278423, "vf_loss": 8.895889854431152, "vf_explained_var": -0.062499362230300906, "kl": 0.006785119219821109, "entropy": 1.1537554025650025, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64125, "num_agent_steps_sampled": 192375, "num_steps_trained": 64125, "num_agent_steps_trained": 192375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2565, "training_iteration": 19, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-13-42", "timestamp": 1706105622, "time_this_iter_s": 12.293542385101318, "time_total_s": 243.97103595733643, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 243.97103595733643, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.081249999999997, "ram_util_percent": 74.26875, "gpu_util_percent0": 0.07250000000000001, "vram_util_percent0": 0.214569091796875}}
{"episode_reward_max": 21.38992942568064, "episode_reward_min": -12.171086374879023, "episode_reward_mean": -0.46077638787848996, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -40.82117810116103, "policy_agent_": -1.65898602663435}, "policy_reward_max": {"policy_adversary_": -5.5110873658074295, "policy_agent_": 31.105553763420826}, "policy_reward_mean": {"policy_adversary_": -14.566323255654147, "policy_agent_": 7.052773433887828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.964379830130433, -6.353679105872639, 5.118692297324954, -2.111290755207403, 3.7126457893270106, 2.3581297418139977, -4.4283098480970535, 0.04907696109211701, 6.481006289753124, 4.26178831172378, -3.941144573995715, -4.302967089779892, -9.601686124492048, 2.106050253495202, 0.9522095879014458, -1.970725828096743, -2.8497403903473226, -5.1163524146232, 1.9967625672768263, -10.480282263255578, 3.1109280935866637, -0.28001121311646693, 0.2861330857948296, -5.758419754732766, 9.879241874501808, -6.49307097980833, 5.681461897793381, 3.536444771920391, -9.292295198965281, -0.4320078376687586, 0.3321158744231022, -5.0189364328643435, 3.2854239374760947, -5.900174199558148, 7.047340751713563, 2.473197111148651, -7.534457769786995, 1.5825842334872324, 5.21388698934096, 0.29785480098244843, 10.98883577062757, 1.353246065487883, -3.295683146529831, -3.3729728996691666, -2.370690997219586, -3.9451803054727335, -10.161991083476298, 3.3462212715057094, -3.553859886131399, 3.0955771485465737, -12.171086374879023, -11.626062933049639, -4.011601914564754, -2.739550337807617, -3.351231966415424, -8.68271960109229, -5.688058214138658, -3.471357940293079, -3.476088011823712, 3.9973526963379267, 10.798551530592666, 1.6640072014663683, 7.951775220399574, -2.4400594283886203, 2.0872357239706645, 1.0477091171578463, 6.207427080760154, 10.718297735657027, -0.1590896341067798, 4.5124994812699635, -11.784395934264378, -11.988465193492825, -2.4971391030899195, 1.6791825074522733, -1.8797044894057122, 5.098966006357395, -9.663999668744651, -1.1547370188676473, -8.022792144345747, 1.3787330018046473, -1.645950858869035, 21.38992942568064, 1.2572044519246663, 6.18787513242518, -7.2068064821343985, -2.788233654967338, -8.126528590136182, 1.2480666585326432, 6.491542189636413, 0.46667660924711196, 8.20981421216382, -1.4919942246648912, -3.892578801805617, -3.8040007576863246, 1.8684661438121564, -5.623099737915056, -2.7339900126310805, 5.3095795536999635, -5.411846492058306, -4.264984322073215, 3.3651403416387256, 8.638507136583247, -0.22609585195819903, 18.524282519524224, 6.696701290037147, 5.4266863617279055, 2.0318276689200223, 7.646812629847233, 0.28775753125584547, -1.3968442648432222, 1.5578622414244097, -0.7169164990865675, -0.9856258734352897, 1.4914435681300016, -4.290262171665015, -1.262099205409866, -2.694268876362877, -10.222905303999879, -2.0443153887995136, 0.91928705653031, -8.761390143420003, -0.042013653953418606, -5.506429740480112, -5.965025450799848, 2.3189454808368635, 1.5248852150682497, 1.6534301938444518, -6.978684782327748, 0.6954939218065995, -1.1377870559605947, 5.292206146010511, 1.0984416871980465, 1.4097613436500447, -2.6054495453317466, 2.2625457244195415], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.663548605899827, -7.180238582149408, -20.191783575608458, -10.376394764631014, -13.845026439844705, -13.283888043097846, -17.68351057730576, -11.758485753743066, -19.800076815308742, -9.85354218127787, -11.938588111035582, -11.552884903048879, -29.06906365517707, -10.15167760695538, -21.654037187902883, -10.911091537097379, -18.829162556222084, -10.302193237456317, -11.204541475416796, -11.037697865328067, -13.047621970632118, -7.876078483656461, -16.540016318937308, -9.877978075617586, -24.12736884904112, -17.45305565454315, -13.490414954183636, -15.15657534750528, -18.36620732970275, -10.464611602433678, -21.219003205046853, -9.789893127075658, -14.124518862149602, -16.03322267161211, -27.41235491590429, -8.424635504315061, -11.92624335796746, -18.20280601877122, -11.14909264258593, -7.865743765668739, -19.707746091890225, -19.709918708996863, -26.556904791084435, -10.580786362151743, -12.941566266876494, -9.373581825294758, -10.419327395679286, -18.970297917436937, -23.308925012967688, -11.457838129372462, -8.853114321610319, -16.71534443883013, -7.076538688154157, -10.68138265800857, -5.683109105090344, -9.320849586920685, -11.984161441977589, -5.5110873658074295, -16.44772308773957, -12.747425850496192, -24.921504127414977, -12.110336737403411, -23.642347321585447, -7.842952321736195, -11.555225939855255, -13.483786213805002, -19.453077077264997, -17.812482569069935, -9.736127721509728, -10.577563542027232, -16.653566711442878, -12.74828792492683, -11.38797269863652, -14.931277369390136, -12.860019257344847, -15.056375740828626, -14.732159092693951, -12.496335829145046, -17.16093141985458, -18.587968342625814, -12.296096285580102, -40.82117810116103, -19.989077787173958, -15.50591514902569, -17.56262522887478, -10.322920840492145, -8.050817219713176, -8.219409825847023, -15.887903128200454, -6.154492575431609, -22.338272738434117, -14.825385995844195, -16.692421989180314, -17.250804281266586, -19.235129903476142, -12.836804885258532, -7.24579710407705, -13.3214789524073, -7.751846821999777, -17.1188250877844, -14.715073981655513, -16.394044402598986, -15.298703110489674, -28.952287580314906, -15.051277011050722, -14.501008337074337, -11.81022947455053, -26.248983153541026, -15.923763329919664, -16.443509166976096, -14.316830412230633, -6.807247985900823, -10.171388100173079, -7.589771423487412, -7.0624073752524215, -19.27162352407149, -11.765106915216288, -14.037915490908786, -31.15394294092383, -14.636264732710268, -17.463354872702812, -21.95321527453259, -13.389674395120936, -11.48844725835846, -9.075305771505437, -11.591323837427998, -22.16713492996573, -7.541233310403016, -10.020746554952295, -12.135743499067672, -15.40283875348707, -21.138695941434598, -14.218052384635358, -7.743828450057171, -11.912658792579265], "policy_policy_agent__reward": [3.3495843878846956, 3.3495843878846956, 0.41327973813838503, 0.41327973813838503, 12.655237936466708, 12.655237936466708, 4.132552004711805, 4.132552004711805, 8.778836114585859, 8.778836114585859, 7.821008892455922, 7.821008892455922, 6.627600364604355, 6.627600364604355, 5.903781357417591, 5.903781357417591, 13.14054155253093, 13.14054155253093, 7.057665246500827, 7.057665246500827, 3.998721768519933, 3.998721768519933, 3.6249589066344914, 3.6249589066344914, 9.73368876534251, 9.73368876534251, 6.128863930225289, 6.128863930225289, 11.303123387902167, 11.303123387902167, 4.470182854500316, 4.470182854500316, 7.989711082937381, 7.989711082937381, 2.592920411416555, 2.592920411416555, 6.600652021346812, 6.600652021346812, 0.2787078010362438, 0.2787078010362438, 8.07927503210939, 8.07927503210939, 3.7980336352699977, 3.7980336352699977, 8.413074702366071, 8.413074702366071, 2.059779160442407, 2.059779160442407, 17.003305361771464, 17.003305361771464, 5.479992337367406, 5.479992337367406, 9.585938425988509, 9.585938425988509, 9.346510059712834, 9.346510059712834, 4.536956065368734, 4.536956065368734, 5.016301882382458, 5.016301882382458, 10.775559539734987, 10.775559539734987, 2.385478347105658, 2.385478347105658, 8.704971399812848, 8.704971399812848, 5.066524236026982, 5.066524236026982, 17.229847833808925, 17.229847833808925, 5.4489163077318565, 5.4489163077318565, 2.1958927940902355, 2.1958927940902355, 9.892695126129224, 9.892695126129224, 8.181489815963445, 8.181489815963445, 4.081799283325593, 4.081799283325593, 15.348290931258896, 15.348290931258896, 10.531582387242372, 10.531582387242372, 11.630610822277303, 11.630610822277303, 3.6039067312412882, 3.6039067312412882, 5.285437634828453, 5.285437634828453, 2.714200759911013, 2.714200759911013, 0.12866815610149931, 0.12866815610149931, 11.158259594471321, 11.158259594471321, 9.877532563418143, 9.877532563418143, 7.276707638959517, 7.276707638959517, -1.65898602663435, -1.65898602663435, 2.5446407528902455, 2.5446407528902455, 1.5324683867947013, 1.5324683867947013, 3.970916160100477, 3.970916160100477, 1.1659385693374602, 1.1659385693374602, 0.3190649929141923, 0.3190649929141923, 3.148051613919465, 3.148051613919465, 1.0198647127571736, 1.0198647127571736, 6.485817537957929, 6.485817537957929, 8.372389273417058, 8.372389273417058, 17.86002782900382, 17.86002782900382, 6.887171969434889, 6.887171969434889, 15.797061270992506, 15.797061270992506, 2.7014464466737875, 2.7014464466737875, 6.8212308319129615, 6.8212308319129615, 7.265747665481422, 7.265747665481422, 12.83025207901258, 12.83025207901258, 14.26539015236348, 14.26539015236348, 4.788519043701477, 4.788519043701477, 7.545031511648597, 7.545031511648597, 2.434585388589248, 2.434585388589248, 0.3799113657170036, 0.3799113657170036, 4.445416797773301, 4.445416797773301, 8.305229938421204, 8.305229938421204, 5.490157383969567, 5.490157383969567, 10.07767087359301, 10.07767087359301, 2.5340797119746505, 2.5340797119746505, 5.670799405138699, 5.670799405138699, 4.569069637754422, 4.569069637754422, 9.983350672215236, 9.983350672215236, 5.325072713355533, 5.325072713355533, 31.105553763420826, 31.105553763420826, 10.623141119549317, 10.623141119549317, 10.846895140725435, 10.846895140725435, 5.1779093733701895, 5.1779093733701895, 3.767343592762404, 3.767343592762404, -0.03785568521150458, -0.03785568521150458, 4.733738242189834, 4.733738242189834, 11.189722658918432, 11.189722658918432, 3.31058459233936, 3.31058459233936, 15.274043475298969, 15.274043475298969, 6.666695885589651, 6.666695885589651, 6.399921593687349, 6.399921593687349, 6.723401761790131, 6.723401761790131, 10.551798023644148, 10.551798023644148, 3.6068525736717367, 3.6068525736717367, 2.2559035457229846, 2.2559035457229846, 9.315529253053631, 9.315529253053631, 1.170000164970736, 1.170000164970736, 6.426920382855593, 6.426920382855593, 9.04010716164712, 9.04010716164712, 12.516275769591118, 12.516275769591118, 7.536303629265737, 7.536303629265737, 23.73828504991957, 23.73828504991957, 10.873989150543935, 10.873989150543935, 9.963847349401123, 9.963847349401123, 6.921028571735276, 6.921028571735276, 16.94789789169413, 16.94789789169413, 8.105760430587756, 8.105760430587756, 7.5233324510664366, 7.5233324510664366, 7.937346326827523, 7.937346326827523, 3.0451657434071273, 3.0451657434071273, 4.592881113368894, 4.592881113368894, 4.5406074958087075, 4.5406074958087075, 1.3860726017937028, 1.3860726017937028, 9.004762159330816, 9.004762159330816, 4.535419019426707, 4.535419019426707, 1.9075050934544526, 1.9075050934544526, 14.554813776062156, 14.554813776062156, 7.77777589462029, 7.77777589462029, 4.350982364641405, 4.350982364641405, 10.955600810289589, 10.955600810289589, 3.9416223273204123, 3.9416223273204123, 2.761710903779307, 2.761710903779307, 5.69712562617115, 5.69712562617115, 6.558104526248127, 6.558104526248127, 11.910282561905088, 11.910282561905088, 0.28127426403763345, 0.28127426403763345, 5.3581202383794455, 5.3581202383794455, 5.498978221553538, 5.498978221553538, 10.34752244974879, 10.34752244974879, 11.118568814316324, 11.118568814316324, 7.813906864142702, 7.813906864142702, 2.569189452362711, 2.569189452362711, 7.087602258499401, 7.087602258499401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2950845044911076, "mean_inference_ms": 2.2347923258127214, "mean_action_processing_ms": 0.10221322582358847, "mean_env_wait_ms": 0.6104138361939562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 67500, "timesteps_this_iter": 0, "agent_timesteps_total": 202500, "timers": {"sample_time_ms": 13671.068, "sample_throughput": 246.872, "load_time_ms": 0.396, "load_throughput": 8513728.273, "learn_time_ms": 1884.355, "learn_throughput": 1791.064, "update_time_ms": 24.737}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 25.341636657714844, "policy_loss": 0.0032479634077390075, "vf_loss": 25.34959011077881, "vf_explained_var": -0.11732277870178223, "kl": 0.005511527647324027, "entropy": 1.120177674293518, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 9.910690832138062, "policy_loss": -0.013016111170873045, "vf_loss": 9.934413194656372, "vf_explained_var": -0.06266672611236572, "kl": 0.0049407208534308165, "entropy": 1.1200250387191772, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67500, "num_agent_steps_sampled": 202500, "num_steps_trained": 67500, "num_agent_steps_trained": 202500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2700, "training_iteration": 20, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-13-55", "timestamp": 1706105635, "time_this_iter_s": 13.257009744644165, "time_total_s": 257.2280457019806, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E295E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 257.2280457019806, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.97058823529411, "ram_util_percent": 74.22941176470587, "gpu_util_percent0": 0.0688235294117647, "vram_util_percent0": 0.21938189338235295}}
{"episode_reward_max": 17.91685752396337, "episode_reward_min": -23.02888132203266, "episode_reward_mean": -1.2551678014970165, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.16123131190195, "policy_agent_": -4.7879974351090935}, "policy_reward_max": {"policy_adversary_": -4.426447689107025, "policy_agent_": 21.71958645032755}, "policy_reward_mean": {"policy_adversary_": -14.61849029841078, "policy_agent_": 6.681661248456882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.546588482584253, -6.768652756381442, 5.490953971089407, 3.0627586356598613, -0.9703051277930896, -2.868181566276806, -2.945711803363271, -3.476975003340317, 7.7068214335317995, -11.969955064244843, 9.626166267677155, -3.3212561629005766, -0.28584885709298125, -7.414280098372416, -7.944598443709841, -6.289184453084531, -8.711996188855526, -2.745971209793493, 1.8259808821892243, -1.983489788011203, 1.998590484642596, 0.48334197924694206, -1.4491751108888944, -2.6449388484269853, 1.303877879715077, -15.6963073633259, 4.69316119818766, -15.039781926891717, 15.730302404347784, 5.3055907427742195, -4.796951153845607, -0.3979264703553284, 0.6139122022344679, -1.5182506566627074, 4.871349547805965, 0.27418592147763143, 1.5920614853142236, 2.141231954573613, -2.2146879303777265, 10.078275796905213, -0.6729758946327904, -7.54651400816566, -4.123104448981753, 3.4451075980760093, -0.13608186862035968, 9.059071008620611, 1.344002637689821, 5.201903539293207, 2.8404537730875328, -8.0299542810973, 0.4459163828890057, -5.290916811171014, -1.9310535754400149, -0.9015476346522321, 0.2726504389983335, 6.45514763926033, -18.73606588402916, 3.2469505121650477, 5.550244385775306, -12.405268551322026, 7.815469173342651, 3.851065308082142, 1.5793426667037092, 2.8820576853253868, 1.9515021662625904, 3.3320979467533176, 9.28931415600349, -3.248501213851912, -3.5779407444984512, -3.5512685765960432, 2.573190112665987, -10.298865676185011, -5.44949834353227, -1.3481221524059663, -18.014814664609446, 4.083705819737806, 3.5525212787612483, -2.7475892077297672, 17.91685752396337, 2.13618647865707, 9.139625248346327, -13.185672183003112, -8.045993958308298, 2.8998730776201462, -6.827388962912234, -3.268730330906702, -1.8715488663079294, -6.920374245546462, 2.809474298379093, -0.03639198232706842, -2.731804711659901, -2.660712009588188, 0.04957495842844964, -6.152758509205944, -1.3472311536766757, -1.3679343313182066, -1.9129498645933856, 0.3464217871595554, -4.069337865106455, -11.715838437132861, -0.17046401285065205, -5.018429282838481, -1.9656555787987964, 7.728566752701154, 2.5054928084533468, -0.8268076284606509, 2.661437781356675, 3.601010744492842, -17.48638539043704, -10.9304544765502, -23.02888132203266, 9.578526736725394, 3.1727873566931915, -11.957111270974634, -0.37507324848814966, 17.81251900915217, 3.1744202550109426, 2.893580330944453, -10.571191671856303, -1.8164905525848711, 9.380383711443429, -1.4053630897767124, 5.677038892106773, -9.61852715280299, -6.379459342764503, -4.1596962492750365, -10.772606843422343, -5.576455485147224, -1.367375121317023, -2.107217237690642, 9.521971848882332, -4.548979643806013, -1.16283595203555, -10.243033466583425, -11.502597348460858], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.713076384757219, -7.204889798959311, -27.913165544920698, -14.147816089381223, -17.870745593459763, -7.515510564037244, -16.003003048079822, -12.283477122130604, -18.187285803222387, -13.750537942140529, -24.192134318545204, -17.18718691014253, -6.222787589672161, -12.704319180969918, -20.26146010614476, -11.232468046537658, -4.426447689107025, -11.891776700497015, -10.534646235685967, -11.47546618854057, -9.624084497274385, -15.402983310823258, -12.681343761306296, -8.255484562333704, -17.078270522168438, -16.60725500820107, -15.609544350836424, -16.788193542045672, -20.880182447388975, -16.570103349404544, -12.00671734003724, -4.689281351766494, -14.794207808463083, -6.271106868346242, -18.25707052148642, -8.623383689687072, -5.588860098998359, -13.996200307321624, -16.961374249582317, -17.557223961231756, -8.330398086526564, -20.50351287285012, -15.581398149359574, -9.393648626792924, -9.997607183835576, -19.736061512763428, -13.50298124573818, -13.662964639655797, -21.599470286175286, -6.717830181986664, -9.054589155368955, -18.656069724422025, -15.64682878705672, -7.797529485623841, -18.112632569800382, -22.763381579770364, -17.023115014868235, -12.136745948166924, -20.81306944347853, -23.857844214615284, -17.945283379210153, -14.73293219423323, -10.932162437641868, -15.77270608185955, -22.134715251312763, -12.982896452213323, -19.541817336676427, -11.030065141191875, -8.309496081034025, -6.009490753983403, -17.0266768944894, -15.300247360685418, -14.138729658812482, -23.700570589943002, -11.083000444560184, -12.940747741632505, -18.734183966741924, -12.887437062588145, -25.52231537669173, -18.182515849378195, -24.631894456799643, -20.18985719812625, -13.487171625847983, -16.984084949150105, -13.520443275039877, -7.046177862043764, -12.98413633239491, -8.92806108622519, -23.582270672292463, -7.084929572616285, -7.862785257745246, -13.971770093453834, -12.99369395048691, -17.57146805492273, -23.4677105495199, -12.723155228990674, -8.705138548143024, -13.63274035786203, -10.67896424675782, -16.919456885519818, -13.346381126040159, -14.890803201069458, -9.115194137755667, -17.768573511424076, -21.210741154946927, -25.849333743277406, -20.040164870112854, -24.05928110709978, -8.82003090831295, -8.423413036580948, -13.452886451814464, -16.010704207809063, -10.975599336110676, -12.917119280374472, -11.021619262746547, -23.679740178863803, -16.096648055864616, -16.185828302884673, -8.188361950656637, -14.479046163080788, -31.16123131190195, -6.491831848476112, -21.225942540994218, -13.113779451570617, -15.207259338531136, -12.989171548383567, -14.019849896055351, -8.435807563873013, -11.360639153515043, -23.407244855582768, -26.689524038429106, -7.219553002800684, -6.815196114714155, -8.817829663057752, -10.287208597435038], "policy_policy_agent__reward": [11.129832433670739, 11.129832433670739, 0.218118521288934, 0.218118521288934, 16.702059758005056, 16.702059758005056, 8.60528736252054, 8.60528736252054, 8.450220232833335, 8.450220232833335, 2.3236644988802193, 2.3236644988802193, 6.528645622358275, 6.528645622358275, 4.403251059395143, 4.403251059395143, 12.947053618377094, 12.947053618377094, 0.8902914389478408, 0.8902914389478408, 16.90915029311117, 16.90915029311117, 6.932965373620979, 6.932965373620979, 2.968469366289591, 2.968469366289591, 2.6450195412987494, 2.6450195412987494, 6.1584308312174585, 6.1584308312174585, 2.471641796726563, 2.471641796726563, -2.142774249874252, -2.142774249874252, 4.572902745351761, 4.572902745351761, 6.180313558937596, 6.180313558937596, 4.745988200264682, 4.745988200264682, 5.811337490958491, 5.811337490958491, 7.943162645035097, 7.943162645035097, 5.616084325208702, 5.616084325208702, 2.8052728569533603, 2.8052728569533603, 9.19107420094176, 9.19107420094176, 0.45547382243758594, 0.45547382243758594, 10.151352774512041, 10.151352774512041, 0.8742058075769782, 0.8742058075769782, 18.305242425868382, 18.305242425868382, 10.937847046089383, 10.937847046089383, 3.6048830930958164, 3.6048830930958164, 2.145677440705582, 2.145677440705582, 7.704060005348775, 7.704060005348775, 2.3764281058417667, 2.3764281058417667, 11.564210034646196, 11.564210034646196, 4.448784805582352, 4.448784805582352, 3.590460792156292, 3.590460792156292, 8.068716130947617, 8.068716130947617, 7.373343159602294, 7.373343159602294, 13.81774987906849, 13.81774987906849, 3.828711095946889, 3.828711095946889, 6.478499432342237, 6.478499432342237, 5.729146850188912, 5.729146850188912, 6.419378112434467, 6.419378112434467, 4.930762657607606, 4.930762657607606, 14.397566260692022, 14.397566260692022, 7.423491941714001, 7.423491941714001, 9.432434089474501, 9.432434089474501, 12.219962029631407, 12.219962029631407, -0.6560620495553189, -0.6560620495553189, 4.750252769128979, 4.750252769128979, 6.6825764566255055, 6.6825764566255055, 6.857887605808351, 6.857887605808351, 3.447990925485804, 3.447990925485804, 9.19264150439936, 9.19264150439936, 14.609264609515344, 14.609264609515344, -0.8564754345804563, -0.8564754345804563, 7.691848230165986, 7.691848230165986, 13.181656914626918, 13.181656914626918, 5.726287831646632, 5.726287831646632, 12.880376276276401, 12.880376276276401, 9.291998751157687, 9.291998751157687, 6.255752552172789, 6.255752552172789, 9.32738188359247, 9.32738188359247, 12.043108708787678, 12.043108708787678, 8.157497199483322, 8.157497199483322, 14.415565746339954, 14.415565746339954, 3.8907819636699807, 3.8907819636699807, 2.3657776682677865, 2.3657776682677865, 1.2291110886936802, 1.2291110886936802, 9.79993350357769, 9.79993350357769, 2.500690842250206, 2.500690842250206, 4.344615657640109, 4.344615657640109, 11.176224218768514, 11.176224218768514, -3.4659071100246313, -3.4659071100246313, 8.512226780685156, 8.512226780685156, 11.14335262275159, 11.14335262275159, 5.06992392742919, 5.06992392742919, 21.71958645032755, 21.71958645032755, 10.159351164017636, 10.159351164017636, 16.88575985257299, 16.88575985257299, 3.502092507561572, 3.502092507561572, 2.7205888337698423, 2.7205888337698423, 9.941979013385126, 9.941979013385126, 3.3465271560638223, 3.3465271560638223, 1.88872376556853, 1.88872376556853, 5.556293733043491, 5.556293733043491, 1.0038434203393651, 1.0038434203393651, 13.195872485335778, 13.195872485335778, 3.5242687951446094, 3.5242687951446094, 2.5654902730426694, 2.5654902730426694, 5.655529041932825, 5.655529041932825, 6.521634454457677, 6.521634454457677, 5.709354772858388, 5.709354772858388, 11.060239697921613, 11.060239697921613, 5.677610448836234, 5.677610448836234, 3.3960943417748184, 3.3960943417748184, 6.989581072510791, 6.989581072510791, 3.304813190825684, 3.304813190825684, 2.6018092241934787, 2.6018092241934787, 6.587958556594751, 6.587958556594751, 4.936186959115486, 4.936186959115486, 3.574769279478436, 3.574769279478436, 12.748570132062621, 12.748570132062621, 11.858116981700137, 11.858116981700137, 12.511263057408375, 12.511263057408375, 11.350801325734764, 11.350801325734764, 13.830145925796307, 13.830145925796307, -4.333177241062045, -4.333177241062045, -1.253520719984629, -1.253520719984629, -4.7879974351090935, -4.7879974351090935, 12.794615472267227, 12.794615472267227, 7.074193346401934, 7.074193346401934, 0.48000400469991933, 0.48000400469991933, 5.323273007129199, 5.323273007129199, 20.74612959400799, 20.74612959400799, 9.635534155437778, 9.635534155437778, 9.539704316914559, 9.539704316914559, -1.1914148605998345, -1.1914148605998345, 6.33127780524796, 6.33127780524796, 20.270807511672682, 20.270807511672682, 2.5432343793497, 2.5432343793497, 13.451490716550495, 13.451490716550495, 1.7476261493838139, 1.7476261493838139, 4.413899997883317, 4.413899997883317, 4.414737649554269, 4.414737649554269, 1.6236215263165026, 1.6236215263165026, 1.429676039362894, 1.429676039362894, 4.996632016099009, 4.996632016099009, 10.650013808946067, 10.650013808946067, 18.10574794365572, 18.10574794365572, 1.3352866794973364, 1.3352866794973364, 2.826180081339302, 2.826180081339302, -0.7126019017628346, -0.7126019017628346, -0.607694375512909, -0.607694375512909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940320805834362, "mean_inference_ms": 2.2322465856674936, "mean_action_processing_ms": 0.10224085522521383, "mean_env_wait_ms": 0.6106146759214887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 70875, "timesteps_this_iter": 0, "agent_timesteps_total": 212625, "timers": {"sample_time_ms": 13315.708, "sample_throughput": 253.46, "load_time_ms": 0.297, "load_throughput": 11373755.423, "learn_time_ms": 1789.118, "learn_throughput": 1886.404, "update_time_ms": 23.441}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 25.72096118927002, "policy_loss": -0.002931424169219099, "vf_loss": 25.734869384765624, "vf_explained_var": -0.15139974355697633, "kl": 0.0040089357490018076, "entropy": 1.0976750135421753, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 9.961817502975464, "policy_loss": -0.00862419605255127, "vf_loss": 9.981179666519164, "vf_explained_var": -0.06594780683517457, "kl": 0.005003802565306392, "entropy": 1.0988383173942566, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 70875, "num_agent_steps_sampled": 212625, "num_steps_trained": 70875, "num_agent_steps_trained": 212625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2835, "training_iteration": 21, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-14-07", "timestamp": 1706105647, "time_this_iter_s": 12.450435400009155, "time_total_s": 269.67848110198975, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 269.67848110198975, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.75, "ram_util_percent": 73.92500000000001, "gpu_util_percent0": 0.051875000000000004, "vram_util_percent0": 0.219146728515625}}
{"episode_reward_max": 19.804079698083562, "episode_reward_min": -17.199011012540616, "episode_reward_mean": -0.9041795014188432, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.413668113166306, "policy_agent_": -3.3684161287665217}, "policy_reward_max": {"policy_adversary_": -2.8029427652543264, "policy_agent_": 25.608873905624936}, "policy_reward_mean": {"policy_adversary_": -13.172874361424615, "policy_agent_": 6.134347430002883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5074889569140177, 8.815710956847385, 2.544051604006083, -6.091467941639068, 1.9546127917351088, -4.69662716789309, -0.1549625452927788, -1.660291169382818, 2.8391348775718317, 1.4022423775456825, -1.506587852337115, 2.088925391608995, 3.630183521441108, 3.9765672720537983, -3.2812954806999084, -9.647495390991438, -1.5420529670625454, -0.3144428399555679, 19.804079698083562, 4.213272773724187, -3.4561588564477335, 9.1843343980577, -16.7195638199188, -10.129279913023154, 1.0682927109819107, -6.008574534013989, -0.6505492246568176, -1.034199148034271, -12.682493235091476, -1.6765760826908909, -5.216391809123153, -7.247275567182363, 4.338044765972671, -6.384259539314515, 1.3033522893173521, -2.378899148763782, 7.188621366675605, 3.004317575906734, -0.18196999209881226, -3.8138097355032814, 4.5634764468438975, 5.140022460227551, 1.5546050522911976, 11.91301176079621, 0.574306822932208, -8.865614321689447, -0.07963133499391042, 2.631926460144056, -1.933427807373824, -0.5748961934841952, 4.669950154957617, -8.324026951906967, 4.618411095765708, 0.20929762744850255, -12.87897954402353, -2.264136986312179, 0.45316811472853546, -10.789712547960796, 2.012855382625571, -1.4320913296749085, 4.153156164484418, -6.629689635263262, -10.255245571425288, -1.164688663503301, 7.444091241678871, -0.1735579516576613, 3.2462437987134294, 1.032978004854105, 5.031826880124465, -7.48977570846031, -5.351170204745578, 0.05869176629181899, 1.3388595014035911, 7.082730990885857, -10.143327322164529, -2.5042031991254143, 2.2177056423038803, 0.6935753212009109, 3.907135589384626, -4.7648148156236925, 3.0027369375818136, -1.616267678429875, 6.189790705069268, -5.894109436758608, 8.991408200166752, 3.5284676250292146, -6.988675544607083, -3.3814245798554188, 1.512684278220199, 4.661876260468639, -4.904027539979479, -5.151643378891167, 12.811770595174451, 2.086856506283701, -1.1885532765450308, -3.876411480780664, 4.830788216848904, 0.5716064468921483, 2.2708172965308275, -14.83040614923506, -2.8538447890197096, -5.462030674279977, 1.7823975567726296, -17.199011012540616, 1.6524564713512768, 1.0671939495082576, -7.883643329402317, 6.977737589436481, -5.143780894267456, -8.080474793302416, -5.448952564221082, -4.074558692173144, -7.911449977307708, 1.2107604505933116, 4.775500123283894, -4.308725466343291, -1.5265047640406357, 2.4805322663200275, 5.956196777425952, -8.115059756823797, 11.508157658875104, -3.6608953105375814, -1.2674979496162688, -7.11839958883852, -2.5357113402294194, -0.5114711385138593, -3.5316666823603398, 3.0429312846642884, 2.3587395138986076, -6.018023744184705, -3.6258302634860216, 0.7976072868644088, -0.3152997488714925, -3.3308115470694095, -8.695129154316417], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.91235305448266, -20.163431532776357, -15.242847988706744, -4.587169824264597, -11.523082457522273, -7.824367743170215, -11.164640458885671, -12.323181357287735, -12.247491704511816, -9.321262180803766, -8.791875702890929, -12.572653678581123, -20.512841097656853, -13.676088014182943, -7.89038316462981, -7.300650373219392, -16.769497390042005, -7.53184237857195, -31.413668113166306, -24.6134413748511, -14.676190121523828, -20.117464863829053, -9.982731562385768, -8.33074318836374, -13.636827854391631, -6.313653931311037, -8.780555897430677, -13.298269020387751, -14.50883747951011, -9.192706787223964, -7.41535131053006, -25.95616429303761, -11.34123571364483, -7.803169831167294, -9.153865508376985, -7.713847607511701, -26.153693278179272, -12.047593687774025, -12.918709312274054, -6.091630375060946, -13.737119377794025, -15.183651816189412, -10.639447890624268, -23.83695967401068, -9.573981950823875, -29.64605172598372, -10.671778731402839, -10.41595497161966, -5.890777412490936, -11.446709127701254, -11.380459249967338, -23.79414800451316, -11.686116604271945, -17.889558943207508, -8.184276608458482, -8.281575328621235, -18.59613205491661, -14.905811114754448, -24.267601683477906, -8.913655799468662, -19.478987920211246, -7.311439654911869, -10.353846866245412, -11.063016128680681, -22.461742050090354, -14.471548312981323, -12.046866927032928, -7.778027239012874, -22.18859799322953, -6.556378050436893, -10.834491955386365, -8.531744555035589, -12.648022693763679, -15.438636007864119, -7.267987029600371, -4.3765421536623315, -9.892645107137977, -18.55296064294944, -14.313249800757124, -12.28499386422949, -17.532214323552264, -7.715056838060784, -13.141450744625564, -21.395615732877175, -20.011954724205946, -18.76932536226178, -5.666958836966369, -12.253703931534949, -11.933698647712609, -18.34097954113997, -10.696439471752447, -7.199075514438535, -17.822376510131537, -18.39028207780565, -19.205184535329487, -6.557467352731613, -18.82435013923506, -10.654473450403387, -13.464731362150875, -19.499512923692553, -25.615148867085484, -13.483663848300125, -10.09612411205089, -10.556733601021124, -12.295470483963154, -10.606067455572045, -15.492939876251906, -16.080098311344532, -12.994295446324099, -7.010256891911554, -6.0482905999746235, -14.09846930199497, -13.238982849348346, -14.336483011089161, -17.704557587579448, -2.8029427652543264, -10.916892073976575, -13.70247211067589, -17.860767555552634, -11.480325279312028, -24.0071008800765, -7.430148516250657, -9.117780836367656, -15.843816686511815, -6.850837251358576, -4.383844031846031, -9.321878051785053, -12.783828919846595, -8.492759794400387, -10.957024863881179, -16.761875344697458, -19.908495995650878, -7.356770496659793, -16.212930289116294, -14.803608547046222], "policy_policy_agent__reward": [5.709921005698339, 5.709921005698339, 14.489571244811868, 14.489571244811868, 8.893449796356418, 8.893449796356418, -0.7521490586872354, -0.7521490586872354, 6.738847624628691, 6.738847624628691, 1.5638702876385615, 1.5638702876385615, 5.504838956796446, 5.504838956796446, 5.331445093952459, 5.331445093952459, 7.543313291041824, 7.543313291041824, 5.361752279174724, 5.361752279174724, 3.6426439252769063, 3.6426439252769063, 7.330789535095057, 7.330789535095057, 12.071512309548979, 12.071512309548979, 8.826327643118368, 8.826327643118368, 2.3045438419649527, 2.3045438419649527, -1.1734225088860235, -1.1734225088860235, 7.613722211489732, 7.613722211489732, 3.6086997693081906, 3.6086997693081906, 25.608873905624936, 25.608873905624936, 14.41335707428765, 14.41335707428765, 5.610015632538046, 5.610015632538046, 14.650899630943375, 14.650899630943375, -3.3684161287665217, -3.3684161287665217, -0.8992683623297083, -0.8992683623297083, 7.3525602826867695, 7.3525602826867695, 0.15253969864852424, 0.15253969864852424, 4.065003336386928, 4.065003336386928, 6.1320349361767414, 6.1320349361767414, 0.9131721222093138, 0.9131721222093138, 3.7580653522665344, 3.7580653522665344, 1.0994797507034542, 1.0994797507034542, 9.354444362927614, 9.354444362927614, 7.83964023980875, 7.83964023980875, 0.7094551459263918, 0.7094551459263918, 5.228608898847168, 5.228608898847168, 2.6674742293739584, 2.6674742293739584, 16.671157322427444, 16.671157322427444, 7.5259556318403815, 7.5259556318403815, 6.368369660087621, 6.368369660087621, 1.1389103197788317, 1.1389103197788317, 9.150297912318962, 9.150297912318962, 10.16183713820848, 10.16183713820848, 6.097026471457733, 6.097026471457733, 17.87498571740344, 17.87498571740344, 5.074144386878041, 5.074144386878041, 10.390218702147141, 10.390218702147141, 5.296073698204466, 5.296073698204466, 6.523940715881858, 6.523940715881858, 1.9786748025585563, 1.9786748025585563, 5.435906467108531, 5.435906467108531, 8.025204702462476, 8.025204702462476, 7.735060526303094, 7.735060526303094, 8.152263850018825, 8.152263850018825, 9.049428285328005, 9.049428285328005, -2.347351467782525, -2.347351467782525, 3.0087191711545276, 3.0087191711545276, 9.52465008482257, 9.52465008482257, 2.0580492833968242, 2.0580492833968242, 13.140228533051738, 13.140228533051738, 3.7407822348968764, 3.7407822348968764, 11.816072042347828, 11.816072042347828, 0.34087500982430347, 0.34087500982430347, 0.04930064741006657, 0.04930064741006657, 4.94916373258869, 4.94916373258869, 14.952916645884617, 14.952916645884617, 7.14899518066183, 7.14899518066183, 7.646555362873177, 7.646555362873177, 4.40550262193349, 4.40550262193349, 13.610212436676994, 13.610212436676994, -0.46669882901170634, -0.46669882901170634, 2.7416608753203935, 2.7416608753203935, 4.295218160663704, 4.295218160663704, 6.993441097583635, 6.993441097583635, 11.260683499374993, 11.260683499374993, -1.4376701462820818, -1.4376701462820818, 0.9361694772684589, 0.9361694772684589, 6.055175374720928, 6.055175374720928, 9.623267982075173, 9.623267982075173, 9.110192695070872, 9.110192695070872, 3.7600895243028996, 3.7600895243028996, 10.267475630567041, 10.267475630567041, 3.0493945798154556, 3.0493945798154556, 9.665620724847411, 9.665620724847411, 7.750753148059276, 7.750753148059276, 14.501681462186347, 14.501681462186347, 11.148896493645498, 11.148896493645498, -0.6608583538203577, -0.6608583538203577, 4.436139675839767, 4.436139675839767, 6.723191462966406, 6.723191462966406, 11.501427900804307, 11.501427900804307, 2.8962059658864856, 2.8962059658864856, 1.023716067773686, 1.023716067773686, 15.317073552652998, 15.317073552652998, 10.238569292044673, 10.238569292044673, 9.008315629392225, 9.008315629392225, 1.3405279359754743, 1.3405279359754743, 11.82756917804198, 11.82756917804198, 5.613039948647766, 5.613039948647766, 7.867774329340847, 7.867774329340847, 2.334553387228745, 2.334553387228745, 11.380652039032881, 11.380652039032881, 4.010816587010073, 4.010816587010073, 5.939260834411762, 5.939260834411762, -3.3211387057597466, -3.3211387057597466, 6.973963477657219, 6.973963477657219, 5.836630702540148, 5.836630702540148, 3.8046482734247955, 3.8046482734247955, 11.528917950390507, 11.528917950390507, 3.9252572760283204, 3.9252572760283204, -0.5351089506954309, -0.5351089506954309, 0.2996690178767717, 0.2996690178767717, 5.011955304910915, 5.011955304910915, 2.6637664360203215, 2.6637664360203215, 7.773621730841232, 7.773621730841232, 11.240028855431675, 11.240028855431675, -0.7528913505444805, -0.7528913505444805, 4.695193654967968, 4.695193654967968, 8.091502188497959, 8.091502188497959, 11.908482166489296, 11.908482166489296, 1.6826327612441179, 1.6826327612441179, 17.757629269475796, 17.757629269475796, 1.884626602856537, 1.884626602856537, 3.925141443375694, 3.925141443375694, 4.362708548836645, 4.362708548836645, 2.1575629555645794, 2.1575629555645794, 1.9361864466660854, 1.9361864466660854, 2.8951056847123553, 2.8951056847123553, 7.9133801022554415, 7.9133801022554415, 5.425749654149497, 5.425749654149497, 2.469500559848237, 2.469500559848237, 6.5680225406057176, 6.5680225406057176, 10.35305164125764, 10.35305164125764, 3.520735373894149, 3.520735373894149, 6.441059371023441, 6.441059371023441, 3.054239696364904, 3.054239696364904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2928200937251418, "mean_inference_ms": 2.2197986673622667, "mean_action_processing_ms": 0.1017013861313383, "mean_env_wait_ms": 0.6079205014311743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 74250, "timesteps_this_iter": 0, "agent_timesteps_total": 222750, "timers": {"sample_time_ms": 12931.622, "sample_throughput": 260.988, "load_time_ms": 0.297, "load_throughput": 11373755.423, "learn_time_ms": 1789.709, "learn_throughput": 1885.781, "update_time_ms": 23.441}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 21.44649314880371, "policy_loss": -0.005166832397662802, "vf_loss": 21.462334442138673, "vf_explained_var": -0.1303740382194519, "kl": 0.005640645307849257, "entropy": 1.0673728466033936, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 8.676966238021851, "policy_loss": -0.008076683059334755, "vf_loss": 8.695857858657837, "vf_explained_var": -0.07621480822563172, "kl": 0.00567990317557246, "entropy": 1.1098784863948823, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 74250, "num_agent_steps_sampled": 222750, "num_steps_trained": 74250, "num_agent_steps_trained": 222750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2970, "training_iteration": 22, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-14-19", "timestamp": 1706105659, "time_this_iter_s": 11.460501432418823, "time_total_s": 281.13898253440857, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 281.13898253440857, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.826666666666664, "ram_util_percent": 73.72, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.20764973958333333}}
{"episode_reward_max": 12.541812471285606, "episode_reward_min": -18.286665518807855, "episode_reward_mean": -0.35971539031437905, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -34.298432126833106, "policy_agent_": -1.8982992395374285}, "policy_reward_max": {"policy_adversary_": -5.537182811754707, "policy_agent_": 22.95609961763153}, "policy_reward_mean": {"policy_adversary_": -13.951233072955754, "policy_agent_": 6.795758841320686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6720511969246268, -5.1441450118684635, -6.008757280842967, 1.1579964127405324, 0.8686029798132657, 6.383828144700992, 2.055738077026956, -1.5715342587043981, 2.714069173684694, -8.15667210791458, 6.645375514656638, -1.3851524348597555, 0.8753481228094042, 0.14853809336085844, -3.704102923712467, -3.69414814665076, 6.159595811245417, 9.166062488540431, 0.08423595566662645, -1.7836270938208094, 0.2088467190308877, -4.297641257004196, -9.217360395635255, 0.25682796407239616, -2.3020004002447423, 6.548928107781981, 7.586380469207629, 6.376596277435611, -0.8367762936169796, -6.77847694059962, 4.20215681749194, 8.216612937034965, 12.541812471285606, -4.098956197854878, -8.477761675952253, 4.809005043163909, 1.6574310489233541, -8.938763280699519, 11.613767108429942, -7.19821575626123, 6.344853178164058, 0.27806886872309156, -3.169387437895806, 4.359275367394615, -2.5657305692508903, -0.2238367206485457, -18.286665518807855, 0.11916173723074591, 1.103737601267222, 2.536252774882073, 1.9824716252563723, 2.775185764794859, 2.996244536697573, 2.140286000707368, -1.9248495017075644, 3.041951494062492, 1.2699197128841968, -8.848761513460126, 5.751947412191171, -3.3423930996303817, 3.8434460767453236, -9.786441492739055, 1.195282232448219, -6.055575159331453, 2.625458055143378, 0.9077440379542486, 0.6797115365545721, 1.5064946107622146, 2.57647439529871, 1.0360141460332724, -2.146801543816027, -5.537593985020554, 2.0694495570845293, -5.404558819800284, -3.48505318879218, 7.449946576574466, 0.8088270629536528, -5.825414969929199, 3.840653167679328, -0.865115669917538, 1.4010528151343635, -7.211960594335472, -10.032250185741047, 3.1400895985624104, -1.9645564386614487, -11.765715244976555, -0.7887973647611324, 8.479244361165192, -2.6974291573843425, 4.292566937298801, -1.7710518484589302, -2.0444861564220838, -8.674348178091336, 3.3307524705967575, 1.3148206434641208, -5.991696933928574, -5.489512995847742, 2.6797555919813214, -13.163739092888163, 11.994456494280001, 1.073944021120792, -0.2975935348707499, 4.46966469017797, 9.516600075909613, 3.6556380053905357, 6.694949283488558, -6.272196793633976, 3.479825314846381, -10.301263509762142, 8.648721770892632, -2.1547040165212668, -1.6741333660159607, -6.899965356435088, -1.1031052164409398, 1.4765198021391952, 3.3431190280509417, 0.6920692783372309, 1.8154362520700982, -4.247477102322706, -1.9500697938174731, -0.2437422026393374, 0.48535684208926333, -8.775029155454687, 6.806567153584813, -6.23725499156645, -2.1973443988537884, 0.041296908776826236, -3.5805323125457047, 0.9602902424535982, -8.812986721490912, 0.35043415537251976, -0.13325555203311468, -0.4892031626454032, -2.6815565032590443, -3.184185365345629], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-18.267864517144485, -14.960820792875381, -21.123450399412864, -14.064544102486371, -12.60445271548189, -18.053368398962323, -10.870974508873156, -16.41175042904737, -12.182889068070608, -8.306372732976817, -23.874676628149892, -15.168524172914855, -12.439350489168772, -9.057371588325111, -18.138627778171344, -10.855433918361086, -15.525967234706432, -23.02267706257385, -17.845005567717372, -8.01809271907045, -21.65040489645679, -6.840017945169041, -13.233784632332334, -25.76315360373708, -12.789656611831736, -11.87635934116467, -17.434122148547154, -19.745201376298347, -7.328453084388324, -11.17395350205972, -15.127327895806216, -19.393777627145347, -22.015753644700965, -22.692655377070423, -8.65897150865696, -14.288948397717201, -17.48913018620862, -12.056771880262803, -34.298432126833106, -15.290321905138569, -15.639152464519471, -12.010420105027418, -9.428327359401944, -11.198967141121562, -17.199407357781705, -8.156990627413464, -24.65771925962761, -7.636309053998582, -10.759130226753694, -10.515655446301103, -10.443026185466781, -10.740806816781479, -16.022183978877973, -10.001463661621525, -7.877915460132581, -17.25397320490701, -10.496829459944664, -9.370708938080005, -17.3550423909842, -7.990501057418524, -9.563759648771132, -25.636413273306133, -14.174525034793565, -9.540522437904688, -15.769585103681191, -11.882309403759615, -17.123134423472, -20.816026501039048, -12.842398710937472, -21.17306969930672, -6.2981763968738225, -13.57181667516134, -10.184113026807264, -14.321696201759034, -17.533830013583977, -17.84594209518355, -12.353213563000544, -10.771668891536676, -20.806407277710672, -6.06254008762052, -13.072609366831275, -12.986107151284678, -6.235651706666187, -16.094619088883768, -12.428220720113998, -13.127423826660824, -9.329255338818754, -14.424506617800851, -15.495123775549505, -20.61969807380387, -10.55386041671736, -16.193482856463046, -5.537182811754707, -11.939236915925258, -15.997332023638581, -14.10205349696511, -8.19726441970559, -12.399328595564347, -12.782249244334524, -19.23901222235492, -19.71682826073035, -8.16414255970328, -15.971059436714881, -16.36071616317494, -13.719142288208818, -25.45330356417027, -12.831272020161318, -14.157544888520762, -8.931649152426324, -17.109299404077294, -7.92155998870214, -9.360672077637666, -17.71913516014338, -10.977767520209035, -16.57537449462883, -12.387901543725627, -25.634704643754638, -16.676297613062353, -11.585383995212908, -8.699651157824125, -12.591503863373035, -8.797694311768927, -8.121268977120607, -19.803450056147206, -18.674114321356132, -10.294037735676987, -11.93725794217282, -10.220132399816668, -8.360138617516302, -11.280929271713049, -17.806778845139085, -10.552854969833842, -6.0249795622882685, -8.748199825613789, -6.530408368477875], "policy_policy_agent__reward": [9.969957857034561, 9.969957857034561, 4.908337890503457, 4.908337890503457, 7.557346559284949, 7.557346559284949, 7.611270257613455, 7.611270257613455, 6.736527847647579, 6.736527847647579, 12.218598271831656, 12.218598271831656, 6.463356292950057, 6.463356292950057, 7.420108085171485, 7.420108085171485, 7.44847912087765, 7.44847912087765, 0.07485031253111678, 0.07485031253111678, 15.26002607140327, 15.26002607140327, 6.891685869027551, 6.891685869027551, 6.657349305989088, 6.657349305989088, 4.602954840842986, 4.602954840842986, 7.2172624272294374, 7.2172624272294374, 3.580642885855163, 3.580642885855163, 10.842781522975926, 10.842781522975926, 16.09436977555714, 16.09436977555714, 8.964620761691998, 8.964620761691998, 3.1172328126248208, 3.1172328126248208, 10.92962580774384, 10.92962580774384, 1.271188344082422, 1.271188344082422, 2.008212118348538, 2.008212118348538, 13.009990783904746, 13.009990783904746, 5.243828105793495, 5.243828105793495, 9.212643724473324, 9.212643724473324, 12.510251308877395, 12.510251308877395, 13.060898826866977, 13.060898826866977, 3.2458383953856718, 3.2458383953856718, 2.19773828073005, 2.19773828073005, 9.664742356649075, 9.664742356649075, 13.805195282090157, 13.805195282090157, 17.27878305799328, 17.27878305799328, 9.296849589607772, 9.296849589607772, 0.09060491635235246, 0.09060491635235246, 9.548976720440557, 9.548976720440557, 9.573280617565988, 9.573280617565988, 1.559004299781639, 1.559004299781639, 22.95609961763153, 22.95609961763153, 4.046053074438672, 4.046053074438672, 10.992002821341767, 10.992002821341767, 6.1442444868752535, 6.1442444868752535, 3.129469960753069, 3.129469960753069, 7.779121254258088, 7.779121254258088, 7.316838394265408, 7.316838394265408, 3.966576953382459, 3.966576953382459, 3.185526870409879, 3.185526870409879, 3.877735395614664, 3.877735395614664, 5.931433914010459, 5.931433914010459, 6.525954110591589, 6.525954110591589, 6.21274890536158, 6.21274890536158, 6.757996290788168, 6.757996290788168, 9.509214257787775, 9.509214257787775, 6.070874831164446, 6.070874831164446, 2.9765329792125086, 2.9765329792125086, 10.14796234948475, 10.14796234948475, 5.883374586414431, 5.883374586414431, 0.2609737123099404, 0.2609737123099404, 11.553494901587689, 11.553494901587689, 2.324053978894071, 2.324053978894071, 6.703602862758228, 6.703602862758228, 7.924985890283542, 7.924985890283542, 7.68490363362089, 7.68490363362089, 1.7424736392866185, 1.7424736392866185, 9.197521579412285, 9.197521579412285, 6.395026720856932, 6.395026720856932, 8.901422980013287, 8.901422980013287, 11.161260555900629, 11.161260555900629, 7.7094365531180875, 7.7094365531180875, 11.104541922669997, 11.104541922669997, 2.075687426528899, 2.075687426528899, 4.017111345070395, 4.017111345070395, 6.126781291945898, 6.126781291945898, 4.458568690979376, 4.458568690979376, 7.024388412395899, 7.024388412395899, 12.647944335879007, 12.647944335879007, 6.581020312977098, 6.581020312977098, 2.473126960803737, 2.473126960803737, 12.323530222694998, 12.323530222694998, 2.5987122088514907, 2.5987122088514907, 7.23683109098282, 7.23683109098282, 2.8870732784746056, 2.8870732784746056, -1.8982992395374285, -1.8982992395374285, 9.617354343723088, 9.617354343723088, 5.231832140726271, 5.231832140726271, 0.6808542908421309, 0.6808542908421309, 4.270228987028814, 4.270228987028814, 11.451875489483026, 11.451875489483026, 6.3988473090825835, 6.3988473090825835, 12.456132505551338, 12.456132505551338, 4.391404284129214, 4.391404284129214, 7.07449835002048, 7.07449835002048, -1.5685826831683125, -1.5685826831683125, 7.6349946932610075, 7.6349946932610075, 8.65607633355135, 8.65607633355135, 4.055178281518267, 4.055178281518267, 1.3538757119289229, 1.3538757119289229, 7.539542093772836, 7.539542093772836, -0.1907449242768219, -0.1907449242768219, 15.616734358317462, 15.616734358317462, 10.39538614092557, 10.39538614092557, 3.933274512416265, 3.933274512416265, 10.220362063446427, 10.220362063446427, 12.938658119542279, 12.938658119542279, 8.687390146799677, 8.687390146799677, 16.07412642382941, 16.07412642382941, 3.279537613263669, 3.279537613263669, 8.818685101683574, 8.818685101683574, -0.6848071786679121, -0.6848071786679121, 12.879010587484963, 12.879010587484963, 2.8834279860904366, 2.8834279860904366, 3.843269355810854, 3.843269355810854, 5.409584901854146, 5.409584901854146, 4.937331151884049, 4.937331151884049, 9.025947148384013, 9.025947148384013, 7.865510285888283, 7.865510285888283, 13.163386961045934, 13.163386961045934, 9.245866932566225, 9.245866932566225, 3.6689534464451024, 3.6689534464451024, 3.3747906820033258, 3.3747906820033258, 6.173880830366848, 6.173880830366848, 4.6415255769290935, 4.6415255769290935, -0.32688008916704137, -0.32688008916704137, 13.30500860486601, 13.30500860486601, 6.218429664894847, 6.218429664894847, 4.048346668411599, 4.048346668411599, 5.989277425474825, 5.989277425474825, 3.3198000436354818, 3.3198000436354818, 4.660214429984952, 4.660214429984952, 1.233971275111073, 1.233971275111073, 9.078606500255804, 9.078606500255804, 5.2097997089003645, 5.2097997089003645, 2.767888199821432, 2.767888199821432, 3.0333216611773732, 3.0333216611773732, 1.673111501566124, 1.673111501566124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927431371218945, "mean_inference_ms": 2.2185031636241512, "mean_action_processing_ms": 0.10163051825259832, "mean_env_wait_ms": 0.607414119323531, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 77625, "timesteps_this_iter": 0, "agent_timesteps_total": 232875, "timers": {"sample_time_ms": 12877.159, "sample_throughput": 262.092, "load_time_ms": 0.496, "load_throughput": 6804353.009, "learn_time_ms": 1789.177, "learn_throughput": 1886.342, "update_time_ms": 23.74}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 21.968027877807618, "policy_loss": 0.018233470059931277, "vf_loss": 21.960225105285645, "vf_explained_var": -0.10431346893310547, "kl": 0.007659384380403478, "entropy": 1.043052566051483, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 8.292975401878357, "policy_loss": -0.03959954078309238, "vf_loss": 8.343188929557801, "vf_explained_var": -0.050825434923172, "kl": 0.0084318875382846, "entropy": 1.1035508990287781, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 77625, "num_agent_steps_sampled": 232875, "num_steps_trained": 77625, "num_agent_steps_trained": 232875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3105, "training_iteration": 23, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-14-32", "timestamp": 1706105672, "time_this_iter_s": 12.657414674758911, "time_total_s": 293.7963972091675, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4DDD4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 293.7963972091675, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.80625, "ram_util_percent": 73.85, "gpu_util_percent0": 0.065, "vram_util_percent0": 0.2112579345703125}}
{"episode_reward_max": 15.724227492912219, "episode_reward_min": -17.51877217614736, "episode_reward_mean": -1.1154536288634809, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.04506059144788, "policy_agent_": -4.920016276715547}, "policy_reward_max": {"policy_adversary_": -4.44129401063859, "policy_agent_": 22.264617618029902}, "policy_reward_mean": {"policy_adversary_": -13.862163153137287, "policy_agent_": 6.373354762136904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9418538996616425, -14.280570876802189, -1.1581945299047294, 1.4456642863694518, -0.18340574275052846, -3.799505665237099, 5.237610781894517, -6.74305741448886, 1.5844161187009238, 6.733274947883156, -3.290703308189331, 2.3288615662818883, 8.931732955363561, 5.1126355271120305, -7.4484173042986015, -5.95213198152311, -6.498370220223686, 1.1042013272501658, -0.4036631733539758, 8.675500608004326, -9.217326332335897, -1.7011047590924773, 8.401080126681375, -0.08366901819266503, -14.007593714160254, -3.2235591610162166, -1.261751829157662, 3.7337699210032493, -5.0531844982539535, 2.829785583895719, -14.949137051930087, 15.484174644611924, 5.154342639424753, 0.45072720254439136, 5.329415698497345, -6.254152086059873, -17.51877217614736, -9.307450990164202, 2.744384060082706, -2.516972966276234, 12.154409326400021, 6.33256800659199, -4.307439963115141, 15.724227492912219, -2.6252558654280094, -5.722747318571116, 5.782444979655086, 3.925243043146202, 3.382562684327744, -8.647074363870178, -11.76974462579187, 4.084154892368352, -0.5771050147824299, -4.501564721427025, 1.5988124743010217, 4.015272927401732, -2.8537156820790424, -1.1797444604585308, -6.9802772345031565, 6.839457384241376, 3.4084176939670234, 6.64449081059611, 7.389104123406928, -11.07060012858131, 4.7010217196640065, -14.421160480172189, -10.288260205459693, 0.4266103475718027, -2.986671396548478, 8.401600532154799, -11.92035432590051, -10.115030323364111, -2.4203277285320155, -1.8881674901343581, 0.26167156857928753, -6.3893436370110885, -0.08538481284342281, -15.769386564160861, -0.016450425828862386, -2.4351709033768474, 5.55691017344756, -3.094330399073112, 1.3244913033647872, -3.3082768727282543, -6.295769784619088, -15.43384190363984, 2.197443604254481, 4.340306315817114, 4.685818061118978, -5.9393554039096665, -1.9925705280182333, -11.864960167474395, -0.34601943136224744, -0.6257221306289604, 2.927189085783023, 0.43058213268390566, -11.550068833740289, 2.241056386498635, -5.333658883650886, 6.445164339063691, 2.125367736433294, 0.27996344249785143, 1.9486304807714303, -5.608220980016494, 0.9040867619481501, 2.22578415836131, 4.278252966040388, -0.6147440557181261, -2.0331984750424734, -13.133541669572654, -2.1557514781906524, -1.2400740689586585, -3.1191184834707837, 2.0701842368775836, 6.553737015776571, 2.8585879690356193, -1.2651456037506132, 3.8770710765362315, -3.56591146453178, -9.111651085271614, 3.9166298746104973, -12.953415500557863, -1.1808538655458225, 7.78358035272327, -3.62850578839927, -0.05452679036041774, 9.69280249910838, -8.542920329802998, 13.724168801045586, 0.4133522788419423, -3.509948342573004, 1.4058496996389263, -16.99704811837258, 3.7830742374950286, 0.3347039209103454], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.576224043652795, -15.84445992619637, -8.505019501847643, -8.055526491303619, -7.953936448483869, -7.250025329249821, -18.342276314556543, -5.917129147658004, -11.834964259961113, -13.734512789393879, -15.770977591473105, -13.218368524832023, -23.163425043814012, -14.284719371139367, -18.01837673743402, -8.298773436622305, -14.414975143474594, -8.736841830126878, -16.304453407840548, -16.42194735718808, -6.385314849524266, -11.088334758526294, -15.327386096161954, -21.51172318591565, -15.41412122492586, -20.45153230763043, -11.628372713679543, -11.35249559466364, -8.143390950856825, -14.956579654001949, -7.978154138093115, -29.04506059144788, -14.856784415390734, -14.644703769358966, -13.291733255352042, -17.817134994316294, -16.43884201383467, -17.190539410685336, -10.278731471807614, -20.60006731743761, -23.143562895010028, -15.047902528199502, -13.013415833500162, -22.610419660818494, -19.386183594619325, -6.1156015495617515, -18.511011733903313, -11.575838706016686, -17.476182301087658, -18.389472771829446, -20.22852625293836, -20.997374826513227, -9.504703400628532, -16.59772533053163, -7.214847527774759, -14.585465659451625, -6.054347552461356, -10.142919320867701, -9.128981516229826, -13.698232602516532, -13.71827155292862, -17.611940166496588, -18.288067019925478, -13.666378108317186, -15.469268598662024, -12.223250454317713, -10.160953432476475, -6.5081998408813435, -9.75135518533268, -25.074345424621466, -21.8071563630466, -20.725019625326695, -6.525490768772587, -15.922690739728331, -20.398335188526058, -12.82945326176545, -10.09296090793504, -17.42520812298627, -7.959086678787593, -19.5344477758499, -11.858898434763335, -6.5709762906781455, -9.349750554142663, -12.85592250462914, -18.374797464312213, -14.873072850280161, -11.574669422538019, -16.59501742247995, -16.48978437608383, -8.681590075492858, -9.494130041865784, -10.97557006054153, -13.791641826859781, -4.44129401063859, -13.773690343189234, -8.654260610226366, -15.059059445634722, -17.692266423085997, -13.800901843734179, -14.942072046467677, -9.799265065127559, -18.574308118305392, -8.765908977549342, -22.973844742869534, -10.886182631548719, -12.321432980355342, -12.929676736208982, -13.669357261361423, -9.751473798980328, -22.2579493486189, -10.357840036025104, -6.5634643434749504, -16.164720148634014, -8.667121022120902, -13.615975401394264, -21.516917825328854, -8.208700405543144, -16.90237839985647, -17.22133524905982, -17.02044258551308, -21.2804412064738, -15.280638728093592, -5.025782004993936, -22.961390122249682, -7.520567352777401, -5.772473323653019, -18.62561578879637, -6.223395947638613, -21.592801625191147, -12.531527090562065, -10.037465543868228, -9.242637657298978, -7.157015564941486, -17.883092959930018, -13.076989440541945], "policy_policy_agent__reward": [7.317185071995578, 7.317185071995578, 0.7819445246970915, 0.7819445246970915, 3.673412485971455, 3.673412485971455, 4.750595388836535, 4.750595388836535, 3.885265352866671, 3.885265352866671, 1.725259832006359, 1.725259832006359, 11.789943548225528, 11.789943548225528, -0.41296413341542987, -0.41296413341542987, 6.709690189331018, 6.709690189331018, 10.233893868638518, 10.233893868638518, 6.240137141641889, 6.240137141641889, 7.773615045556954, 7.773615045556954, 16.047578999588783, 16.047578999588783, 9.6986774491257, 9.6986774491257, 5.284979716567709, 5.284979716567709, 1.1733207275495976, 1.1733207275495976, 3.9583024616254505, 3.9583024616254505, 4.920521578688523, 4.920521578688523, 7.950395117243286, 7.950395117243286, 12.548723982596202, 12.548723982596202, -1.4160057414058203, -1.4160057414058203, 4.6936149997169085, 4.6936149997169085, 11.864233111421662, 11.864233111421662, 10.714027083861493, 10.714027083861493, 0.7032637553828023, 0.7032637553828023, 8.613986573307105, 8.613986573307105, 5.18331044226094, 5.18331044226094, 7.543132757833446, 7.543132757833446, 1.545103226301437, 1.545103226301437, 8.893182618948837, 8.893182618948837, -3.485491456918485, -3.485491456918485, 22.264617618029902, 22.264617618029902, 10.005563527407743, 10.005563527407743, 7.547715485951681, 7.547715485951681, 9.310574476924698, 9.310574476924698, 5.7814914541282105, 5.7814914541282105, -0.5399650811563458, -0.5399650811563458, 3.941544210260564, 3.941544210260564, 6.51155776594516, 6.51155776594516, 9.041547175580689, 9.041547175580689, 17.64898611070502, 17.64898611070502, 10.690235267395751, 10.690235267395751, 4.3529879351925125, 4.3529879351925125, 19.16732357686535, 19.16732357686535, 8.380463864595662, 8.380463864595662, 0.19642711549531724, 0.19642711549531724, 12.146728356779198, 12.146728356779198, 7.750540874581444, 7.750540874581444, 10.429372492707703, 10.429372492707703, 4.8711992039796375, 4.8711992039796375, 4.229390813573247, 4.229390813573247, 12.540764859440786, 12.540764859440786, 4.46379919292305, 4.46379919292305, 6.048080304552305, 6.048080304552305, 4.40683000103789, 4.40683000103789, 9.30036929342668, 9.30036929342668, 1.600315935191156, 1.600315935191156, 4.481587430204583, 4.481587430204583, 1.0743521408633363, 1.0743521408633363, 10.268844993378949, 10.268844993378949, 8.563344623447826, 8.563344623447826, 12.128215488546347, 12.128215488546347, 12.838585571666206, 12.838585571666206, 1.2978889898679395, 1.2978889898679395, 10.085145159163014, 10.085145159163014, -1.0989550129272363, -1.0989550129272363, -0.06365338649160901, -0.06365338649160901, 3.4674050942265735, 3.4674050942265735, 3.3823418943921015, 3.3823418943921015, 16.737972978388132, 16.737972978388132, 4.943401018573048, 4.943401018573048, 5.304994650981291, 5.304994650981291, 2.052581520120287, 2.052581520120287, 7.017261624796988, 7.017261624796988, 10.330003378552671, 10.330003378552671, 3.22005481237718, 3.22005481237718, 5.003788047545809, 5.003788047545809, 0.8279107794127069, 0.8279107794127069, 3.9713181264793658, 3.9713181264793658, 8.54963843623653, 8.54963843623653, 8.707904304105448, 8.707904304105448, 1.738322945802518, 1.738322945802518, 5.337120928753724, 5.337120928753724, 4.773822815950443, 4.773822815950443, 6.039513839846564, 6.039513839846564, -0.2803845266798383, -0.2803845266798383, 6.886056513396249, 6.886056513396249, 10.46766186914853, 10.46766186914853, 10.5878012186014, 10.5878012186014, 1.371117335791595, 1.371117335791595, 3.7507797569237757, 3.7507797569237757, -0.44469505346643623, -0.44469505346643623, 6.722811197748767, 6.722811197748767, 1.9077859400048147, 1.9077859400048147, 8.35043971448613, 8.35043971448613, 4.542421371455135, 4.542421371455135, 1.7544953059472164, 1.7544953059472164, 9.966661404792315, 9.966661404792315, 4.233621480041646, 4.233621480041646, 10.693618192765685, 10.693618192765685, 5.962316400780429, 5.962316400780429, 9.427135780401622, 9.427135780401622, 5.357269729160386, 5.357269729160386, 8.68281188142652, 8.68281188142652, 5.895134696748433, 5.895134696748433, 7.2736085693583235, 7.2736085693583235, 8.603964851124683, 8.603964851124683, 6.527306602821649, 6.527306602821649, 3.8591376619689273, 3.8591376619689273, 4.562203839523126, 4.562203839523126, 4.101044278917227, 4.101044278917227, 2.6616951372581457, 2.6616951372581457, 6.522800832581612, 6.522800832581612, 5.368652629499245, 5.368652629499245, 10.084856208585418, 10.084856208585418, 12.18775289718224, 12.18775289718224, 3.471777400896266, 3.471777400896266, 10.389724738196353, 10.389724738196353, 6.827711892264019, 6.827711892264019, 3.9543957501207347, 3.9543957501207347, 12.59853554054215, 12.59853554054215, 1.1636116137678671, 1.1636116137678671, 1.9224640697240563, 1.9224640697240563, 15.37248523748648, 15.37248523748648, 1.9460307821890652, 1.9460307821890652, 2.8589732666463004, 2.8589732666463004, 14.159209143952374, 14.159209143952374, -1.1597621910821956, -1.1597621910821956, 17.658485213118368, 17.658485213118368, 6.472439684702004, 6.472439684702004, 3.2637586006476114, 3.2637586006476114, 5.324243678468953, 5.324243678468953, -4.920016276715547, -4.920016276715547, 10.83308359871252, 10.83308359871252, 6.705846680726145, 6.705846680726145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2956018342041661, "mean_inference_ms": 2.2433779513923175, "mean_action_processing_ms": 0.10276970031442179, "mean_env_wait_ms": 0.6131132936717231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 81000, "timesteps_this_iter": 0, "agent_timesteps_total": 243000, "timers": {"sample_time_ms": 13026.109, "sample_throughput": 259.095, "load_time_ms": 0.499, "load_throughput": 6768888.251, "learn_time_ms": 1886.61, "learn_throughput": 1788.923, "update_time_ms": 22.942}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.89799861907959, "policy_loss": 0.003860519320005551, "vf_loss": 20.904501152038574, "vf_explained_var": -0.10112963914871216, "kl": 0.0039027720572813117, "entropy": 1.0363159894943237, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 7.689987158775329, "policy_loss": -0.013729395996779203, "vf_loss": 7.71401081085205, "vf_explained_var": -0.04575504064559936, "kl": 0.006291732918778642, "entropy": 1.0608788788318635, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 81000, "num_agent_steps_sampled": 243000, "num_steps_trained": 81000, "num_agent_steps_trained": 243000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3240, "training_iteration": 24, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-14-48", "timestamp": 1706105688, "time_this_iter_s": 16.686151266098022, "time_total_s": 310.4825484752655, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5ED7820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 310.4825484752655, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 58.39047619047618, "ram_util_percent": 75.87142857142857, "gpu_util_percent0": 0.15761904761904763, "vram_util_percent0": 0.22099376860119047}}
{"episode_reward_max": 14.70629061599516, "episode_reward_min": -14.551353839696304, "episode_reward_mean": -0.7738881652465888, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.62970377236993, "policy_agent_": -1.4891196165371001}, "policy_reward_max": {"policy_adversary_": -4.879973825832778, "policy_agent_": 21.356672658897427}, "policy_reward_mean": {"policy_adversary_": -13.916062058088132, "policy_agent_": 6.571086946420772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8472868923375434, -0.843135305597571, 6.831083816421242, -0.2640283948842255, -3.457012248375485, -0.588929057997654, -8.123597406247116, -8.36503183952613, -0.058462600596534936, -1.5939663801454373, 2.373938004520658, -12.58612764018755, 0.28113343692180137, 7.030690860432076, -3.67800367079941, 5.513393071250398, 3.643834943691889, 3.6987760525824998, -4.1810760487358944, 3.113959315029558, -3.9393298956350504, -4.455051143444567, -2.866290450294815, 11.01919494686981, -7.195429543463247, -3.224632092038426, 0.7875641967101914, -1.578171844350681, -9.667734405376338, -0.35578390151967887, -14.551353839696304, 3.642629339718525, -0.12381553430991335, 4.517621328336881, 8.037132562507058, 6.0432580393172834, -3.8469872351545558, -5.911667234015724, -4.4851618581623995, 5.199945713089515, 2.961984447531541, 3.9187387651106897, -3.4835704721965994, -1.0715514175072118, -9.770816070820832, -3.0594246405413585, 5.87312924917531, 3.3187149724713736, -3.490505997977786, -2.964799878405662, -0.22772738110997465, 2.5210259533058927, 5.596153301155043, -6.099053114063291, 3.6691471787278713, -0.8899611893104266, 2.2601813078323443, -1.0636233823791228, 5.9754205175802255, 12.595694363684713, 0.8367293272940409, 2.8652827820731335, -10.956512931170282, -10.354913755593236, 1.2297015276698477, -3.7610032531145015, 4.645988508064782, 0.7291627204350322, -6.388857437077657, -9.417748047161213, -0.6725335829273977, -1.9838761325172798, 2.675405214891185, -8.831868541956036, -3.228550235695389, 2.5298818537743317, 4.1303271599375195, -5.218308246243151, -5.383253324058144, 9.083641545424928, 14.130416553486304, -10.316652380777354, -2.0207755007259687, 0.6452357119924108, 0.35339576574874404, -3.1390257209713495, 1.4052355208615717, -3.7521077067784128, 9.980088830174992, 1.414493727408507, 0.7862705014646659, 0.35134008378019377, -5.392016919365094, -8.997326034465905, 14.70629061599516, -10.548116155181885, -11.650523637333327, 4.08527376091699, -1.7867022439630111, -0.2716882485503276, -0.46339961083945175, -0.6773790318014516, -5.219363771035925, -2.9824748636160265, -9.153655179729014, 9.42343761833002, -2.0725662816529393, -0.30045918280776807, -1.9707186289387124, -1.3635240556625559, -10.99613062406927, -6.394564160679146, -0.3732683998911486, -0.004402855791474813, -3.678232422775652, 5.515617219625224, -1.8173469219977638, -7.567807301889021, 3.9029162392767884, -0.024602703121177627, 6.012865113978236, -1.390263400184176, 13.00867646555329, 1.3521246948015737, -12.602594847336258, 2.3754037669158703, -2.3297446451174886, 0.20087380415181133, -3.8997913925637255, 2.7297705654374744, -11.249034635785698, 3.367455756897451, -5.584968413601898, -5.567776208701744, 6.598404849119906], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-24.95868284275386, -7.865998886812499, -18.135513178510937, -8.200510529081836, -10.074888637124275, -11.445707866359399, -13.691970514848796, -18.218535778321478, -7.608817645343895, -11.372839569941602, -9.186378348822608, -11.381837772537251, -8.063022400623899, -16.02246175756346, -17.81530844798076, -16.24286813501625, -8.562181368325906, -21.286455265633034, -15.092050881776892, -10.112657797319873, -13.548408790474921, -4.879973825832778, -7.650918746478497, -20.685580261326034, -17.757129488857178, -12.206582118241162, -11.116771632515714, -18.703610614566287, -14.295206461706828, -15.490646865294023, -15.381415411316489, -26.35765418668394, -10.078912022986358, -14.30905323585684, -15.682591407465363, -18.477092642983745, -15.42633098691435, -10.45500481719349, -14.125078047839695, -23.478189416422232, -12.953295101567782, -17.074035151003205, -10.38376398850982, -13.409163449404609, -15.085977950022196, -12.582643929558653, -24.676484941338288, -16.90196609403863, -8.371225923986417, -9.740998961838093, -10.367229856222819, -9.714859318256403, -17.841627413201707, -18.6370833326004, -18.460544452114547, -8.371634432533929, -9.39156452386124, -10.004405193789328, -14.280984828211993, -24.657799174954018, -6.935932840978613, -13.393798536624603, -17.959565652832463, -8.776954300641234, -9.75379849292436, -16.613214632205118, -12.670621808106002, -14.429925756067897, -13.066324871677887, -8.015640262479057, -17.179971449012534, -13.267830136775272, -10.802502526971383, -16.56644826631911, -8.585152900599388, -12.01130288583267, -18.19977362707124, -9.829841604363498, -8.215622479523221, -33.62970377236993, -23.460503556327662, -7.338413147703162, -15.652254829019235, -18.780434276244897, -12.949918930510586, -8.00925319595809, -8.513857820988921, -12.763902922730761, -18.763656754747338, -13.218355486346566, -14.554572497371861, -9.566765086174852, -7.364349215709498, -15.596185159963673, -21.240923763122886, -9.227826206482073, -12.777239716459423, -11.05578145820268, -6.720044853964951, -10.495053817069174, -10.28736888767851, -11.66420614452306, -10.711700463531718, -13.401138447731656, -7.720129705195067, -19.337540347781925, -10.956281374048952, -10.876117223419945, -18.673358066957274, -8.238549192065083, -11.51160406444572, -12.882754960599742, -10.159854787894757, -23.226645943663684, -23.492716256580383, -13.2262833669566, -14.886206400940374, -12.195729818035604, -17.895115992961262, -13.540459329083054, -20.65643595437636, -20.071873271707656, -22.737255935209433, -17.113867185205393, -14.399260496321878, -12.05457648379443, -9.561649583235203, -14.501400163362257, -12.401629009616382, -16.19471354258969, -15.767538173127337, -12.724269723394011, -11.924071348209564, -8.98417938868762, -18.386550687824034], "policy_policy_agent__reward": [14.402984867545703, 14.402984867545703, 3.5114317906074657, 3.5114317906074657, 12.48329849746609, 12.48329849746609, 3.9682410670988046, 3.9682410670988046, 3.3089381943743934, 3.3089381943743934, 5.428389404180871, 5.428389404180871, 2.784186554300842, 2.784186554300842, 4.926751969397676, 4.926751969397676, 3.7751775223736805, 3.7751775223736805, 4.889436594898082, 4.889436594898082, 5.780158176671635, 5.780158176671635, -0.602144933825149, -0.602144933825149, 4.1720779187728505, 4.1720779187728505, 11.526576308997766, 11.526576308997766, 7.068652388590675, 7.068652388590675, 10.878130603133323, 10.878130603133323, 6.103008156008896, 6.103008156008896, 12.492615659107766, 12.492615659107766, 5.4554874165205, 5.4554874165205, 6.613308556174719, 6.613308556174719, 4.804539447419935, 4.804539447419935, 0.2124613411941054, 0.2124613411941054, 2.3923141480918395, 2.3923141480918395, 15.85238760409792, 15.85238760409792, 5.280849972696967, 5.280849972696967, 4.4909750131013695, 4.4909750131013695, 5.952167914612952, 5.952167914612952, 8.562719385107808, 8.562719385107808, 2.3137360281652435, 2.3137360281652435, 7.567431481887174, 7.567431481887174, 0.4150307858100929, 0.4150307858100929, 15.000141763201237, 15.000141763201237, 4.977548244338222, 4.977548244338222, 9.413337282096856, 9.413337282096856, 11.859861984986209, 11.859861984986209, 12.260175341150513, 12.260175341150513, 5.789671875879898, 5.789671875879898, 2.271668791588883, 2.271668791588883, 4.819958094838646, 4.819958094838646, 14.339067564755876, 14.339067564755876, 7.957639774549659, 7.957639774549659, 10.496386958056949, 10.496386958056949, 3.4500967581566107, 3.4500967581566107, 6.1688060159487, 6.1688060159487, 2.657580939600681, 2.657580939600681, 4.761609644508651, 4.761609644508651, 15.274807095256804, 15.274807095256804, 10.110340533255002, 10.110340533255002, 2.4403599630043153, 2.4403599630043153, 3.388099541716215, 3.388099541716215, 5.069751237556422, 5.069751237556422, 6.117942635781149, 6.117942635781149, 11.718890357178376, 11.718890357178376, 6.269015109268558, 6.269015109268558, 11.064845815421206, 11.064845815421206, 3.7408366216117503, 3.7408366216117503, 5.8258729158467935, 5.8258729158467935, 4.470390905705102, 4.470390905705102, 10.128202672896112, 10.128202672896112, 18.62674676931937, 18.62674676931937, 3.886331084136328, 3.886331084136328, 8.129540659348867, 8.129540659348867, 3.501526360831086, 3.501526360831086, -0.7889797274760018, -0.7889797274760018, 5.491750010297105, 5.491750010297105, 6.4261056895453095, 6.4261056895453095, 8.658305158085394, 8.658305158085394, 7.579544238251465, 7.579544238251465, 3.338733717300117, 3.338733717300117, -0.7010538923410802, -0.7010538923410802, 8.253718933042567, 8.253718933042567, 5.641977002128995, 5.641977002128995, 6.738953870931283, 6.738953870931283, 3.8672898621815346, 3.8672898621815346, 2.6783013324520013, 2.6783013324520013, 7.270592369803502, 7.270592369803502, 11.165050393504384, 11.165050393504384, 2.3057666790601745, 2.3057666790601745, 1.4161845777325386, 1.4161845777325386, 21.356672658897427, 21.356672658897427, 18.795460054906993, 18.795460054906993, -1.4891196165371001, -1.4891196165371001, 6.8157396641466335, 6.8157396641466335, 9.712834994118655, 9.712834994118655, 6.651657348129665, 6.651657348129665, 2.43511373749337, 2.43511373749337, 4.959546670925246, 4.959546670925246, 4.505897607976176, 4.505897607976176, 14.371872792461165, 14.371872792461165, 7.316424606877537, 7.316424606877537, 7.670421499418265, 7.670421499418265, 4.959052584977522, 4.959052584977522, 0.9861661481722042, 0.9861661481722042, 3.2994295627488794, 3.2994295627488794, 17.973607189559026, 17.973607189559026, -0.6601449743499048, -0.6601449743499048, 0.5633580395630504, 0.5633580395630504, 7.570527609559834, 7.570527609559834, 2.466671305000968, 2.466671305000968, 5.1116827842594175, 5.1116827842594175, 4.911984638419529, 4.911984638419529, 5.493413556360804, 5.493413556360804, 2.7461683462478987, 2.7461683462478987, 5.209331792057811, 5.209331792057811, -0.7167627372669729, -0.7167627372669729, 14.38048898305597, 14.38048898305597, 4.441857546198004, 4.441857546198004, 5.28782902030609, 5.28782902030609, 8.351319719009277, 8.351319719009277, 3.4375125682012615, 3.4375125682012615, 0.257736720188228, 0.257736720188228, 3.2440953999602975, 3.2440953999602975, 4.893293194001805, 4.893293194001805, 11.611121543936108, 11.611121543936108, 9.90724191690236, 9.90724191690236, 9.370950293290917, 9.370950293290917, 6.534429739471305, 6.534429739471305, 2.31396125807329, 2.31396125807329, 10.899016116119025, 10.899016116119025, 6.7579283129809395, 6.7579283129809395, 13.334650534177301, 13.334650534177301, 9.340804935761737, 9.340804935761737, 17.87296620038136, 17.87296620038136, 9.23299594000348, 9.23299594000348, 0.8983328244928135, 0.8983328244928135, 7.214990125355149, 7.214990125355149, 3.6159524690588567, 3.6159524690588567, 7.351136983757034, 7.351136983757034, 4.250918808526329, 4.250918808526329, 9.462242054013586, 9.462242054013586, 2.2592517686708207, 2.2592517686708207, 8.045862740145731, 8.045862740145731, 3.1695514673038305, 3.1695514673038305, 1.7082015899929361, 1.7082015899929361, 12.492477768471968, 12.492477768471968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29626301644107905, "mean_inference_ms": 2.2433751831689386, "mean_action_processing_ms": 0.10290621840958344, "mean_env_wait_ms": 0.6129704401671185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 84375, "timesteps_this_iter": 0, "agent_timesteps_total": 253125, "timers": {"sample_time_ms": 13085.51, "sample_throughput": 257.919, "load_time_ms": 0.499, "load_throughput": 6769859.397, "learn_time_ms": 1897.93, "learn_throughput": 1778.253, "update_time_ms": 22.745}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.802848243713377, "policy_loss": -0.005038774469721829, "vf_loss": 20.81811237335205, "vf_explained_var": -0.08799675703048707, "kl": 0.006600309543036853, "entropy": 1.022491204738617, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 8.52622938156128, "policy_loss": -0.008909631590358912, "vf_loss": 8.54535961151123, "vf_explained_var": -0.038547152280807497, "kl": 0.004868026560295049, "entropy": 1.0464337348937989, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84375, "num_agent_steps_sampled": 253125, "num_steps_trained": 84375, "num_agent_steps_trained": 253125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3375, "training_iteration": 25, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-15-01", "timestamp": 1706105701, "time_this_iter_s": 12.966963768005371, "time_total_s": 323.4495122432709, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 323.4495122432709, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 40.475, "ram_util_percent": 77.00625, "gpu_util_percent0": 0.09125000000000001, "vram_util_percent0": 0.216400146484375}}
{"episode_reward_max": 10.718164139623868, "episode_reward_min": -21.047007229436492, "episode_reward_mean": -0.46172104110007406, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.74044365421926, "policy_agent_": -2.4271151046985247}, "policy_reward_max": {"policy_adversary_": -4.9163902943389175, "policy_agent_": 20.33577945617922}, "policy_reward_mean": {"policy_adversary_": -13.952136431529018, "policy_agent_": 6.7452076952144715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0161068141235914, 3.656360234082444, -7.7083476124968096, -3.7651194516822577, 0.44489838515166436, -4.776255692884338, 0.8875897611204515, 5.056992099525585, -1.6795269043809653, 0.17417447958891955, 2.7369952585251, 2.907925482433873, -3.798569810829128, -12.45721880582581, -3.7681705496929596, 0.5483031903063298, -16.101725655374683, -1.0066583973764744, 3.474470064838158, 4.094287317338299, -2.9961973050888133, 3.5029939184985683, 3.451231164505372, -2.770473258215058, 4.3042254544573675, 1.2373603403577789, -5.982832721543925, 2.7016479514180105, -4.310829670341658, 0.4571757645992418, 0.13676170188907816, -4.931809151955545, 0.4651545585342157, 0.6677191865471681, -4.249735521303148, -5.215033168405386, -3.965512508872901, 1.6896299363526794, 7.797908728563573, -4.468084688386723, 0.3174160120506129, -3.7680409161508366, -6.5232741228272975, 9.865187738608949, 1.3359838919844222, 4.742286029072316, 0.3132534282011158, 3.4185198751307184, 0.19841649373353837, 4.7147426948470645, 10.718164139623868, 5.860624307749415, -4.453462912331191, 8.451634786305465, -6.02778821941344, 6.018060872834725, 1.6338957205262497, 4.864468508173426, -1.542197304827949, -0.5314241283874852, 3.443412325143173, -0.24617691400060393, 1.7037097547859466, 3.302565827464797, -4.586322194290906, 2.3699637449533824, -6.948374300477498, 6.513577417129355, -1.6157992761263487, -1.7711402121807525, 3.89704339792444, -14.703362163418287, 4.667468574873436, 6.203823018176152, 8.724092450000047, -2.2590070285706467, -2.8202441445756934, -2.1957385124232336, 1.304614222317176, -21.047007229436492, 1.5630008011187564, 1.8997522382662058, -6.835337082134164, 1.1086007884485294, 0.7362707874673954, -0.115962634612286, 0.5287849217943642, 1.025820760163792, -3.7473772370747156, -1.1917159447974375, 3.884784903945059, -6.530436978856898, -11.495271324934112, -3.3101568256088942, -3.341396699055945, -1.9117069772802135, -2.70920756294837, -9.940961254297193, 0.6762554519521129, -0.8736670887016231, -16.068137832250393, 9.931115258139199, -2.6988612042533853, -2.375250643273409, -7.0159292393146835, 7.109707060474825, -0.8992383445901801, 1.584983938076146, -2.1317241447962307, 1.9320607259712488, 8.561055921432486, -1.2729799258517813, -6.515595672744375, -5.816269913903337, 4.314694236508571, 3.4417940107780645, 2.2778110936842797, -0.5551600974142947, -8.033113469615797, -1.1578552359944827, -0.19689149883037815, 7.911677446687439, 1.51296155246468, 5.671375863770706, 0.5628377398833728, -1.1645273980964181, 0.3864285278968836, 4.489087628236129, 0.0153034830100032, -1.8705183655705102, 0.9907130187634923, 0.2571682956554471, 1.3444123772137786, 0.4820993495095991, -4.726811075045891], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.243029125079646, -22.995431729819447, -13.895388617008939, -6.318277803987988, -11.96049420318349, -15.245429983029355, -10.515606452701668, -14.709930375995635, -20.57495689099225, -9.923645949535164, -9.821060376652667, -18.777989662735244, -16.23549615722096, -17.172465632546466, -9.04396336064336, -10.094983676755655, -17.231738724113185, -12.893279060780058, -18.1594330589947, -16.87284775795158, -6.317791370449294, -10.795450603650396, -12.710604529907766, -9.717665617610049, -10.172323339942269, -10.429094508345084, -21.199395882316217, -10.333249654575399, -23.482209970559765, -9.287334026594255, -7.942679507401985, -15.357807112152528, -13.199905650213324, -13.139030895140248, -9.388047651074647, -19.08199218022485, -13.89621702130643, -18.67999635403328, -16.62293147313424, -21.231608519257005, -8.682581179954509, -14.151647467897218, -12.114654207597392, -21.57467007515523, -13.910207103028014, -14.735530169994188, -22.178199467603076, -17.9841178976066, -16.84910655848148, -14.899472211840475, -17.177713530628065, -10.486914113076041, -14.50496340373741, -17.98500125800578, -13.719850553586971, -21.005421710793318, -16.12111203432345, -14.20843462277666, -5.030019732023292, -8.288086741395539, -18.727683383705642, -9.74981508957077, -11.865917695488132, -9.7473953181055, -8.436666343786229, -11.046499008693353, -11.284392711379853, -15.646647117000155, -7.691021428426201, -13.152713775639596, -17.39137964438458, -15.560767139950554, -24.746705872093305, -14.131384689854107, -18.184568216292742, -16.759346914271134, -18.6720290767547, -30.15745763896499, -13.61101475366675, -19.635743378040438, -12.38671942397227, -11.29247993084178, -18.37614337037754, -8.767344107990894, -9.009757648374354, -11.13850881738301, -10.494599120745223, -17.819850301548392, -11.748140735181204, -14.176407387344984, -12.66990964936208, -10.868405308866876, -11.563378363981826, -14.274112290004018, -15.00645553333417, -7.7681593887761915, -11.813922850579038, -10.118227009628457, -19.434343830310258, -8.136307927768481, -11.21390762285335, -30.74044365421926, -10.33928659556317, -5.960013397991971, -18.85825307764726, -12.538551216803258, -19.095514031151378, -12.684345149719835, -17.64114791035992, -12.013033381361518, -17.444450927679064, -13.002400555234399, -6.1315615463567745, -11.700648521893216, -16.934064669499282, -10.055577019544582, -10.953373545558643, -11.886954045982524, -19.121799768081587, -12.02232785141944, -4.9163902943389175, -15.93498718415879, -8.296559733062578, -17.42378894276325, -21.63697999615744, -5.316590287624714, -15.495051301358568, -16.82477855466815, -10.910321456205587, -19.00378019598741, -8.369485364650753, -25.48710324940384, -13.956614228948363, -11.945937486877158, -5.341584791730461], "policy_policy_agent__reward": [3.113461155478028, 3.113461155478028, 13.325895981950945, 13.325895981950945, 3.093520502256064, 3.093520502256064, 1.2765791761528662, 1.2765791761528662, 6.202696294167578, 6.202696294167578, 5.234587145072506, 5.234587145072506, 5.701598106911058, 5.701598106911058, 9.883461237760612, 9.883461237760612, 9.447714993305645, 9.447714993305645, 5.048910214562042, 5.048910214562042, 6.279027817588885, 6.279027817588885, 10.842957572584556, 10.842957572584556, 6.218463173195916, 6.218463173195916, 2.3576234133603258, 2.3576234133603258, 2.637896405475199, 2.637896405475199, 5.321643433530991, 5.321643433530991, 0.5650065343692594, 0.5650065343692594, 5.943310331701789, 5.943310331701789, 10.816951561916428, 10.816951561916428, 10.483567537644937, 10.483567537644937, 1.6607970326802397, 1.6607970326802397, 7.149222261074483, 7.149222261074483, 8.080917847206566, 8.080917847206566, 3.4735961796974952, 3.4735961796974952, 7.238274397199818, 7.238274397199818, 5.83322742435143, 5.83322742435143, 7.608281580386143, 7.608281580386143, 6.517448802996705, 6.517448802996705, 9.585690150109052, 9.585690150109052, 4.87225489559675, 4.87225489559675, 4.039720604645532, 4.039720604645532, 5.212998980098493, 5.212998980098493, 6.83253010437377, 6.83253010437377, 6.903375040843707, 6.903375040843707, 2.5691560648857483, 2.5691560648857483, 6.933479505909736, 6.933479505909736, 4.965352256216764, 4.965352256216764, 10.18481314519298, 10.18481314519298, 12.21042010084891, 12.21042010084891, 8.381761915435138, 8.381761915435138, 4.499998596002562, 4.499998596002562, 5.19180327587319, 5.19180327587319, 2.795690042385049, 2.795690042385049, 15.71992890688209, 15.71992890688209, 7.623095497506218, 7.623095497506218, 9.73890809953325, 9.73890809953325, 11.245726447902094, 11.245726447902094, 10.701318886368659, 10.701318886368659, 8.523761526107508, 8.523761526107508, 9.807107453343773, 9.807107453343773, 13.94793883512597, 13.94793883512597, 8.173769210412724, 8.173769210412724, 5.025750245703113, 5.025750245703113, 13.218318022155625, 13.218318022155625, 3.8460311670867657, 3.8460311670867657, 13.511741291814026, 13.511741291814026, 8.877503877424848, 8.877503877424848, 9.53645156547504, 9.53645156547504, 1.743911213597672, 1.743911213597672, 3.8783313065040295, 3.8783313065040295, 11.085547854424407, 11.085547854424407, 4.751819087785085, 4.751819087785085, 6.78481372513704, 6.78481372513704, 6.5249805727851475, 6.5249805727851475, 1.92517207474766, 1.92517207474766, 6.708231376823367, 6.708231376823367, 2.1680092054511793, 2.1680092054511793, 11.080112267064752, 11.080112267064752, 3.0376110761499273, 3.0376110761499273, 5.690786781729423, 5.690786781729423, 10.64421152115451, 10.64421152115451, 0.4287024882661302, 0.4287024882661302, 14.707087223483368, 14.707087223483368, 10.167603854015132, 10.167603854015132, 13.454330333146395, 13.454330333146395, 7.250169942850243, 7.250169942850243, 7.9258924660895005, 7.9258924660895005, 13.980859563270876, 13.980859563270876, 7.457814487991964, 7.457814487991964, -0.705631925698031, -0.705631925698031, 6.974860112545516, 6.974860112545516, 6.596116084553993, 6.596116084553993, 5.770403144121689, 5.770403144121689, 4.937972448219711, 4.937972448219711, 4.8730142179208755, 4.8730142179208755, 5.511273091385362, 5.511273091385362, 5.511692021269793, 5.511692021269793, 9.42283553085609, 9.42283553085609, 4.000381749053242, 4.000381749053242, 6.4923457212737725, 6.4923457212737725, 8.277347276653565, 8.277347276653565, 2.168984165004995, 2.168984165004995, 0.03405351952386049, 0.03405351952386049, 5.481977732197562, 5.481977732197562, 5.832529417139113, 5.832529417139113, 2.928226205747988, 2.928226205747988, 4.552357643815334, 4.552357643815334, 0.08863287766562947, 0.08863287766562947, 10.055299641131183, 10.055299641131183, 3.631320419533428, 3.631320419533428, -2.4271151046985247, -2.4271151046985247, 20.33577945617922, 20.33577945617922, 3.8202126956548907, 3.8202126956548907, 1.792381377359281, 1.792381377359281, 5.921161919166291, 5.921161919166291, 9.82412913863904, 9.82412913863904, 9.098137843280597, 9.098137843280597, 7.1346645438979905, 7.1346645438979905, 7.7547118827818435, 7.7547118827818435, 6.972547053666386, 6.972547053666386, 13.002753424555772, 13.002753424555772, 5.864710314691306, 5.864710314691306, -0.1920170631938009, -0.1920170631938009, 2.9421893039949403, 2.9421893039949403, 10.62437945300393, 10.62437945300393, 6.748685515161324, 6.748685515161324, 6.615592319621459, 6.615592319621459, 5.665896974284116, 5.665896974284116, 5.544343149232898, 5.544343149232898, 5.43223630771248, 5.43223630771248, 2.359749397754269, 2.359749397754269, 11.923332315423114, 11.923332315423114, 4.9047606427636286, 4.9047606427636286, 11.547582403266981, 11.547582403266981, 11.09990886802041, 11.09990886802041, 2.0760314447641477, 2.0760314447641477, 7.940739914627727, 7.940739914627727, 10.656933091452139, 10.656933091452139, 5.462812469607797, 5.462812469607797, 8.56663091520845, 8.56663091520845, 4.6800991917071215, 4.6800991917071215, 12.872135772529642, 12.872135772529642, 7.650513303081071, 7.650513303081071, 6.214018418193377, 6.214018418193377, 0.3073868583422854, 0.3073868583422854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2949183624479353, "mean_inference_ms": 2.2307805657817377, "mean_action_processing_ms": 0.10242585117955287, "mean_env_wait_ms": 0.609306412756835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 87750, "timesteps_this_iter": 0, "agent_timesteps_total": 263250, "timers": {"sample_time_ms": 12979.321, "sample_throughput": 260.029, "load_time_ms": 0.499, "load_throughput": 6769859.397, "learn_time_ms": 1893.501, "learn_throughput": 1782.413, "update_time_ms": 22.942}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 21.286676597595214, "policy_loss": -0.006702811922878027, "vf_loss": 21.303474998474123, "vf_explained_var": -0.14338668584823608, "kl": 0.004907649953856797, "entropy": 1.0097147703170777, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.985989093780518, "policy_loss": 0.0033073222264647486, "vf_loss": 6.9932938575744625, "vf_explained_var": -0.058318537473678586, "kl": 0.0051426689549386225, "entropy": 1.0740704119205475, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 87750, "num_agent_steps_sampled": 263250, "num_steps_trained": 87750, "num_agent_steps_trained": 263250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3510, "training_iteration": 26, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-15-13", "timestamp": 1706105713, "time_this_iter_s": 11.269330739974976, "time_total_s": 334.71884298324585, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E825E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 334.71884298324585, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.60666666666667, "ram_util_percent": 76.58666666666667, "gpu_util_percent0": 0.03066666666666668, "vram_util_percent0": 0.20458984375}}
{"episode_reward_max": 13.957914332585547, "episode_reward_min": -16.48241376912899, "episode_reward_mean": -0.4112701351244755, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.60323783297779, "policy_agent_": -2.1012065994300775}, "policy_reward_max": {"policy_adversary_": -4.791654666184636, "policy_agent_": 18.353632970308162}, "policy_reward_mean": {"policy_adversary_": -13.708646774248189, "policy_agent_": 6.648688319561856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.156759235595911, 2.6325036350584954, -16.48241376912899, 0.9540334265755582, -0.3180017443675263, 1.7194697011019928, 2.1585922043065016, 4.769583958249419, -3.202782711550445, -6.497031386777632, -1.4560835250590385, 4.472591309185147, 1.9404047155383322, 4.263960587330828, 3.1205575893289637, 2.5028880263465956, 1.2511755268796376, -1.5262282953165147, 0.11514523943161209, 3.6820076934821833, 3.2622318976483737, -2.048381948508514, -1.9501562850670096, -2.602046528466159, 1.8721662140320423, -1.2005187828309956, -1.9649407205370772, -1.7901669957383506, -0.7493586916094941, -1.4545132177045756, -9.101854855081053, 5.642229222626641, 1.0021889576808956, 2.868141044580681, 1.0624323988835047, -1.6698963593152558, -3.5022599511480803, 8.69277850208249, 4.579838672358643, -0.5612620367788208, 2.6510049881559987, 1.1526657142677348, 0.5366566736278704, 6.025233852306457, 0.6498724467763167, 7.80405658018691, -9.027459298411006, 8.104028107638525, -2.5718213125984026, -0.787072968713546, -3.426955253076154, 3.152562470770053, -1.6142438182279069, -10.588838137021403, -8.74335374366002, 5.583041756696615, -2.089087183406407, 3.8876514955742327, 4.711183449282862, -3.0324966682548142, -4.968379323794878, -6.716903340553395, 6.474605830368706, -8.660479694596466, 1.5727357199567036, 7.157109225950683, -1.7573929859148318, -0.7337718732899281, -0.5856670216581651, 13.957914332585547, 5.404881249264391, -3.907604294462518, 1.1545282428697121, 4.211178065812205, 3.428682169610274, -4.547915058327768, 3.753374311777283, -0.4656952952330149, -3.543086397235354, 7.364189143086566, -0.34241463497944624, -6.039610219505289, -9.601672812946, -2.9119374797463964, -3.3086717973979844, -1.237511417613367, 4.583757179941949, -6.170186478386692, -9.156825327894852, -1.755829047280101, -13.203533995502191, -5.115389760009255, 0.4365780217527211, -4.495779145649182, 5.915612985539442, 3.546756165000305, -5.4169561556268375, 9.037543427403733, -12.666827353908854, -8.609160215990299, -7.442310005192706, 5.222844916603578, -1.395131828875111, 0.5654870383521218, -4.586865568734134, -0.9892288731359491, -7.569272840942446, 0.6435239477512663, 2.991875271073777, 1.0111099678163682, -6.017611282131114, -7.2350399736863045, -2.0929259410351744, -3.876227036636254, -0.5639905590210694, 0.18259769896502537, 6.309676945997315, -2.8430644617250675, 1.2995016267980728, -10.39321182452787, 0.391850391191246, -3.5307327278375356, 6.458933652891283, -4.5210826329400975, 1.8018200766941952, -1.6908635573445168, 1.6611886347825844, 8.106612725043334, 6.927639578497698, 7.170237347746531, -9.758131178896917, 2.847606882983585, 4.325224444401612, 2.832988990926838, -3.8671541363083435], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.56670724728774, -18.924190798175573, -12.280000570268838, -12.442249326510481, -8.228644794037235, -8.910288978278738, -11.54923082395684, -22.166414101123202, -15.610052341498733, -20.674359397905462, -8.169803293897838, -14.01159115073606, -12.684015132103562, -10.202632626830244, -16.24648748535298, -10.795628814983473, -13.159376990358835, -8.89033863035206, -9.737923953870778, -15.628390091029177, -10.813595231951467, -14.165499424779698, -10.675525552699371, -19.604831626560518, -8.279483423969344, -13.867102572665939, -15.793623473595712, -20.870936553297444, -5.933355481328358, -10.680087767372994, -16.482403691746754, -15.5907933321255, -11.626291732726173, -13.758777519072854, -17.888105766307564, -15.132708508039267, -7.163781073409535, -20.041758887168537, -13.431450013045943, -8.56755735460341, -11.612572715138835, -11.509613979040402, -6.177029556617134, -20.60719066850908, -19.305777166567694, -16.270810651857296, -8.964056497716806, -28.60323783297779, -13.146765467308095, -10.552808054602677, -9.28507255139355, -15.49063641578528, -9.110050737534063, -16.914397260086098, -8.096934414484144, -15.325115898318094, -10.652121483529356, -15.272108672345084, -15.778178903886978, -14.296412782720159, -25.685669313496113, -5.482209474527772, -15.122474000392243, -9.360338302343246, -19.40539344034727, -16.10996670175956, -9.748143824595797, -4.791654666184636, -8.32026175853718, -21.490758538190104, -16.621380901613477, -6.8777746351806295, -8.300213499154221, -18.99338790131438, -10.75755199045843, -13.817715489359106, -14.683064230576289, -17.259875853495235, -11.928604343811077, -20.186411241872108, -9.768027573901488, -8.651631064483773, -13.577788460281205, -9.678112517991089, -17.891044094935, -9.854997823025478, -8.60494572737581, -20.367615632477367, -10.537632297389937, -8.276491361899986, -12.817010759504608, -9.080470703093319, -14.769343609123146, -8.958127070962385, -13.774817631167572, -12.103048162607132, -19.08918372468489, -19.828943851542594, -15.157492868387157, -10.656601069907746, -17.694657662983612, -12.14363316485899, -16.863676528826918, -8.188515516700766, -17.03747234182083, -12.676426196351793, -16.586492600547032, -13.503461527851544, -17.65379485879226, -14.43176050457928, -11.745706203061722, -13.480463066216162, -13.335442325031593, -18.610495993341964, -16.943316074600126, -14.425721542863435, -15.582207079914937, -9.350916648636177, -8.426197535390374, -12.829207080630372, -14.016436913898346, -10.760767183147319, -15.692610638675522, -13.560872899184915, -18.723207187369198, -10.284469134210896, -23.787266624989382, -19.988851990028873, -15.001272692700779, -15.966522128922342, -7.505033292462835, -8.620070226129025, -19.502323378696797, -16.856629435411165, -23.288352987284892], "policy_policy_agent__reward": [6.361733241441824, 6.361733241441824, 10.778347216617036, 10.778347216617036, -2.1012065994300775, -2.1012065994300775, 6.69814137654302, 6.69814137654302, 3.9553215248348543, 3.9553215248348543, 5.314879339690364, 5.314879339690364, 6.853911514131672, 6.853911514131672, 13.467999029686311, 13.467999029686311, 6.203634814974147, 6.203634814974147, 7.088664005563917, 7.088664005563917, 3.3568598844193995, 3.3568598844193995, 9.2420912299606, 9.2420912299606, 7.312209923820947, 7.312209923820947, 7.233296607080537, 7.233296607080537, 9.683522537340972, 9.683522537340972, 6.649258420665031, 6.649258420665031, 7.205276258619236, 7.205276258619236, 3.6820551675177726, 3.6820551675177726, 4.9265345966511935, 4.9265345966511935, 9.655198892255676, 9.655198892255676, 7.037913564799919, 7.037913564799919, 6.058558738135592, 6.058558738135592, 4.36268463381618, 4.36268463381618, 8.501392549047184, 8.501392549047184, 5.075824819000695, 5.075824819000695, 6.333291894917473, 6.333291894917473, 6.914341376529317, 6.914341376529317, 9.540384778779542, 9.540384778779542, 2.591998394859432, 2.591998394859432, 4.612787274834209, 4.612787274834209, 3.690274418332852, 3.690274418332852, 10.616511277376071, 10.616511277376071, 6.314240345203535, 6.314240345203535, 8.313459281826766, 8.313459281826766, 9.475269082595533, 9.475269082595533, 6.731406074362007, 6.731406074362007, 1.8307605611307276, 1.8307605611307276, 14.367268694625508, 14.367268694625508, 9.005644342702293, 9.005644342702293, 4.003147658912295, 4.003147658912295, 7.131788851647416, 7.131788851647416, 6.331139846654068, 6.331139846654068, 3.3568431151225013, 3.3568431151225013, 13.31621226040777, 13.31621226040777, 9.977824806672004, 9.977824806672004, 12.0374336160221, 12.0374336160221, -0.031701400347098785, -0.031701400347098785, 18.353632970308162, 18.353632970308162, 5.287472077354847, 5.287472077354847, 4.882867542944567, 4.882867542944567, 2.9290586491587, 2.9290586491587, 9.321599443277666, 9.321599443277666, 3.7479034596530774, 3.7479034596530774, 3.162779561532348, 3.162779561532348, -0.3232096645879363, -0.3232096645879363, 10.45407882750735, 10.45407882750735, 4.281517150061475, 4.281517150061475, 9.57988008395966, 9.57988008395966, 10.244681176584924, 10.244681176584924, 5.631958057232672, 5.631958057232672, 10.358644994850613, 10.358644994850613, -0.617346933012811, -0.617346933012811, 10.798539915380474, 10.798539915380474, 0.34992930387339477, 0.34992930387339477, 10.489064580151986, 10.489064580151986, 11.633537963855124, 11.633537963855124, 3.995375419340483, 3.995375419340483, 2.0289413964473537, 2.0289413964473537, 3.8672973684395067, 3.8672973684395067, 17.724336435387833, 17.724336435387833, 11.013131075438928, 11.013131075438928, 1.4850851703590522, 1.4850851703590522, 4.727370871011969, 4.727370871011969, 11.602282983563294, 11.602282983563294, 7.093117080034353, 7.093117080034353, 4.63490021551567, 4.63490021551567, 9.218219271176784, 9.218219271176784, 8.397090279131112, 8.397090279131112, 4.192758973287863, 4.192758973287863, 13.775300192479339, 13.775300192479339, 4.71280646946102, 4.71280646946102, 1.3060104224892415, 1.3060104224892415, 1.9880578236676074, 1.9880578236676074, 3.3830875191223466, 3.3830875191223466, 7.291186148768508, 7.291186148768508, 4.308743202706055, 4.308743202706055, 6.594351453658879, 6.594351453658879, 7.098714577045335, 7.098714577045335, 0.690403484747543, 0.690403484747543, 3.2603311573099405, 3.2603311573099405, -0.19326161799879257, -0.19326161799879257, 1.9825404715420314, 1.9825404715420314, 7.602960815437931, 7.602960815437931, 2.2311739626566043, 2.2311739626566043, 9.84521530835351, 9.84521530835351, 7.824902163803719, 7.824902163803719, 6.836113784529026, 6.836113784529026, 14.433243639473162, 14.433243639473162, 1.2453327572391482, 1.2453327572391482, 1.023720426958723, 1.023720426958723, 5.126173828895453, 5.126173828895453, 8.683239040731285, 8.683239040731285, 7.7342723499759005, 7.7342723499759005, 4.377001277526443, 4.377001277526443, 6.225303386543348, 6.225303386543348, 5.843598661607921, 5.843598661607921, 4.508609879802294, 4.508609879802294, 7.073492737801405, 7.073492737801405, 10.322835064933017, 10.322835064933017, 7.721435236197825, 7.721435236197825, 2.8640474604653026, 2.8640474604653026, 3.1227115462649278, 3.1227115462649278, 5.621258191998211, 5.621258191998211, 7.367134478352856, 7.367134478352856, 8.189662757789527, 8.189662757789527, 7.304159620914228, 7.304159620914228, 10.945942012956126, 10.945942012956126, 3.2539260934555556, 3.2539260934555556, 4.862849581094224, 4.862849581094224, 1.2179976280512508, 1.2179976280512508, 7.204143652544794, 7.204143652544794, 3.615017227654891, 3.615017227654891, 11.075772145783402, 11.075772145783402, 4.519895133122409, 4.519895133122409, 10.262513632031693, 10.262513632031693, 4.296802788433189, 4.296802788433189, 12.724227629885979, 12.724227629885979, 14.0477323575361, 14.0477323575361, 10.964456135599239, 10.964456135599239, 11.568379738334439, 11.568379738334439, -1.1265489432170384, -1.1265489432170384, 5.733838554556304, 5.733838554556304, 11.913773911549209, 11.913773911549209, 9.844809213169002, 9.844809213169002, 9.710599425488272, 9.710599425488272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.294295193834192, "mean_inference_ms": 2.2238581312477894, "mean_action_processing_ms": 0.10217832216671394, "mean_env_wait_ms": 0.6074597319796499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 91125, "timesteps_this_iter": 0, "agent_timesteps_total": 273375, "timers": {"sample_time_ms": 12907.422, "sample_throughput": 261.477, "load_time_ms": 0.501, "load_throughput": 6734752.367, "learn_time_ms": 1922.088, "learn_throughput": 1755.903, "update_time_ms": 24.139}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 19.069381523132325, "policy_loss": -0.005909343936946243, "vf_loss": 19.085512161254883, "vf_explained_var": -0.1063732385635376, "kl": 0.005028691125525464, "entropy": 1.0221188902854919, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.030393505096436, "policy_loss": -0.003304093508813821, "vf_loss": 7.043828225135803, "vf_explained_var": -0.0710449367761612, "kl": 0.008452526243067016, "entropy": 1.0342077255249023, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 91125, "num_agent_steps_sampled": 273375, "num_steps_trained": 91125, "num_agent_steps_trained": 273375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3645, "training_iteration": 27, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-15-25", "timestamp": 1706105725, "time_this_iter_s": 12.403606653213501, "time_total_s": 347.12244963645935, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 347.12244963645935, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 36.06875, "ram_util_percent": 74.8875, "gpu_util_percent0": 0.035, "vram_util_percent0": 0.205169677734375}}
{"episode_reward_max": 14.013548818173152, "episode_reward_min": -16.78506642105394, "episode_reward_mean": 0.023174410933828736, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.95123860269077, "policy_agent_": -1.9736809699767375}, "policy_reward_max": {"policy_adversary_": -4.9201938190466565, "policy_agent_": 18.32548996780885}, "policy_reward_mean": {"policy_adversary_": -12.915724213604392, "policy_agent_": 6.46944931226911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.505173140667445, 2.211945409900868, -0.39043663950650953, 3.8573765787589007, -2.6042662981946094, 1.2792488706550817, 0.02644217909955049, -0.3700864750782699, -12.930076730597486, -6.412858254655623, 0.5640336086799145, 2.9857825363706283, -4.461238772878744, 1.4853866731710466, -2.632694098675148, 2.2357464277225243, -4.651476448775154, 6.312385046681559, 7.017732836576722, -0.011538552607100488, -0.9737066162484171, 0.43111995231826605, 12.72424217551246, 8.569207718787421, -5.932718651773248, -0.09553415235722779, -4.33258402210697, 7.94167208731631, -7.101738885187071, -2.4802136816228426, 4.067349860109018, 7.329533658647682, -6.06047288880339, -0.5627632076138527, -0.7208671474304624, 3.7836554857763463, 0.06565771823730948, 2.280486515307409, 3.87003659368367, 9.525147066311611, 1.80566993769266, 1.141757543667263, 2.509189255279163, 1.6062549224242104, -3.5268663426002895, 8.903912723601175, -6.57622747171408, -2.7821498705478547, 7.191336992348719, -5.6719810213861965, -10.647245162024161, -2.2379877711047365, -4.207077447930379, -9.19322289915509, 4.25027564817165, 0.06253928157440852, 4.465156318756667, 1.7668494925886788, 4.827781919929384, -4.638606988950766, -5.546385102169408, -16.78506642105394, 8.177149238298963, 5.6744750842406, 5.971992292706963, 5.390307240192795, 9.790013668510355, 0.5262529924046464, -2.278044816186763, 2.4082279145855954, 2.360044172435102, 2.4842099259323898, 3.7824939751960636, 0.8118380488147157, 2.13601547953112, 0.11708231267006114, 0.022772374180116794, 0.645283115014502, 1.2410217870536688, -2.269631930651829, 3.25002627750075, -1.3788241207528364, -1.3292163611457863, 7.510535582173174, 1.7226480563484403, -0.5423693416084436, 1.66537958130312, -2.2180017431539127, 4.636151959947102, -2.8088578457541833, -2.0219422245008483, 2.545872124568795, 0.6685473243408734, 0.9681292441170373, -8.036248448894785, -8.116325017902957, 0.8761418151890445, -12.513708601820607, -1.8800291569715597, 0.7499652549613754, 1.8236534667854096, -2.4879520325667506, 0.645333257314193, -1.040343100975683, -8.247274319724905, -0.4444604198590061, -11.224368874005688, -2.8368092890010095, -4.572292180700249, 1.3499279867649987, -0.08077288550722994, -4.159199473539383, -10.042977832936849, -8.280693283598705, 11.473518218879203, -3.473945286973727, -0.7270600078484359, -6.233906656333598, -7.276809602257269, 8.521790925625307, -1.94573842552816, 0.7087596504252899, -2.855475854855067, -3.9226598492578537, -3.627898751874724, -7.328140797490907, 8.557715307399512, -6.506190148925534, 14.013548818173152, 2.278319492598043, 2.8183532133446922, 2.2197019590549205, 7.710988210746034, 10.12470862673386, 0.39582002953345147], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.909506234878267, -16.699194062956355, -18.201576241429095, -10.865346774937322, -5.977337327343077, -10.209250746375927, -8.188668071225328, -17.725085085887716, -13.154831244180327, -10.25359417416188, -7.924721606637904, -19.603066023970015, -23.323628776368682, -16.960710027936564, -6.821528871782843, -11.439099030841536, -9.032877976891667, -15.703469320759607, -18.10530270003424, -10.479632431828756, -16.478691960269394, -10.589718440329342, -20.181440149470777, -22.136673358598095, -11.016758319515901, -11.671095468632592, -7.8803623641127425, -22.66021806830322, -10.255441991708391, -5.510770837818154, -12.209233410620882, -15.752753430591628, -19.79394411992907, -12.21762296560068, -7.894849744205869, -11.781931834321355, -8.142417252217337, -13.230135540312109, -14.204375687251344, -15.80801899331701, -13.440619109274373, -15.703187125601431, -15.02634143033373, -7.9760434758349135, -23.60806913357601, -24.95123860269077, -8.061246183414788, -11.00565692186109, -21.902314753936395, -10.01783923801513, -14.806649836009438, -5.201901478953279, -6.100077284776423, -13.910817480193138, -15.18341389767197, -6.5714945040316834, -16.61111813421165, -17.026138117423233, -14.210949384428359, -16.48365288585022, -19.09475042679854, -16.91526028711926, -16.221613169798612, -13.197529202160503, -10.66454032475371, -16.770250245466666, -15.34229408311699, -10.801492957080656, -17.303236766650006, -15.192648278932172, -12.300807434736347, -14.701247615893356, -12.783332927775298, -11.436477107616982, -13.72163201552142, -6.265954421922063, -9.946726169921728, -7.066863353785603, -11.15755064800491, -6.030187016638649, -11.27789227705237, -17.974869876314184, -9.12433998730637, -17.766836070155072, -10.057709244283247, -11.099088618101444, -11.064489017899593, -12.925946806809534, -13.171128022981671, -9.432240522807447, -8.591766021954037, -16.97883713715463, -10.86254220485298, -15.72045098159257, -15.799750583099613, -4.9201938190466565, -10.585993506489778, -16.730035641704806, -8.626328695757786, -12.311910244428612, -11.925315700308545, -5.257938447989978, -9.131874566888666, -7.663372182773878, -13.86840790603366, -9.280013973757422, -13.625645856739776, -8.714529300651307, -8.805300080256842, -15.816390436585609, -11.5215251596445, -23.609607317256774, -6.095615892983374, -16.263521370976573, -22.08637977651285, -6.203269598124412, -11.459652226629116, -9.92083912324356, -10.177260696778983, -13.707776782961961, -15.731313440227401, -7.121308804482983, -13.628942565306403, -13.006810509077889, -7.470760538913567, -6.730551315823044, -14.11463017660554, -8.477002221574601, -22.63743111744454, -11.342552484696588, -10.96378887100058, -13.974674350849652, -16.849267368481613, -18.417100528691922, -15.292004767192049], "policy_policy_agent__reward": [8.707339687772855, 8.707339687772855, 9.455569736428613, 9.455569736428613, 8.905569800961295, 8.905569800961295, 7.36136167684811, 7.36136167684811, 1.6865355145742331, 1.6865355145742331, 5.744249808515503, 5.744249808515503, 4.107555125162439, 4.107555125162439, 8.677499305404721, 8.677499305404721, 0.11237725679141841, 0.11237725679141841, 1.9203679597531274, 1.9203679597531274, 4.244377607658908, 4.244377607658908, 11.294424280170322, 11.294424280170322, 9.43119500174497, 9.43119500174497, 9.223048350553803, 9.223048350553803, 2.0944173865538485, 2.0944173865538485, 6.83742272928203, 6.83742272928203, 2.1907007640582576, 2.1907007640582576, 11.007927183720586, 11.007927183720586, 12.56151776830548, 12.56151776830548, 5.2340469396108285, 5.2340469396108285, 7.752492672010494, 7.752492672010494, 5.510419196323803, 5.510419196323803, 16.45284116249162, 16.45284116249162, 15.35294053869276, 15.35294053869276, 2.5420198338713256, 2.5420198338713256, 5.787780658137683, 5.787780658137683, 1.7738891710028868, 1.7738891710028868, 15.300945077809759, 15.300945077809759, 1.5768515532606615, 1.5768515532606615, 1.5152785780976572, 1.5152785780976572, 8.13829163536495, 8.13829163536495, 11.541143544619656, 11.541143544619656, 6.866735615562844, 6.866735615562844, 5.827429878993414, 5.827429878993414, 3.5869912983877046, 3.5869912983877046, 7.782793660048851, 7.782793660048851, 4.104037485227322, 4.104037485227322, 7.75531102780976, 7.75531102780976, 9.037206140467507, 9.037206140467507, 12.66658302981431, 12.66658302981431, 7.623144523483514, 7.623144523483514, 8.422472334634346, 8.422472334634346, 8.767765342806447, 8.767765342806447, 4.791149199129562, 4.791149199129562, 10.040601395487862, 10.040601395487862, 16.92757566314597, 16.92757566314597, 0.7425093558503533, 0.7425093558503533, 4.111753525656617, 4.111753525656617, 14.546825873142561, 14.546825873142561, 2.1729291083144693, 2.1729291083144693, 2.0797023369926433, 2.0797023369926433, 1.4819568539242716, 1.4819568539242716, 0.9464999184230206, 0.9464999184230206, 2.3587972905190213, 2.3587972905190213, 9.716844772921808, 9.716844772921808, 3.3170168928030463, 3.3170168928030463, 10.53813722648416, 10.53813722648416, 9.396493805005957, 9.396493805005957, 9.519365652178875, 9.519365652178875, 5.9225229484497275, 5.9225229484497275, 6.774182662314567, 6.774182662314567, 0.06509693303265768, 0.06509693303265768, 12.199381204048791, 12.199381204048791, 9.43600214320055, 9.43600214320055, 8.318266308730339, 8.318266308730339, 11.080278742829728, 11.080278742829728, 12.56615387581367, 12.56615387581367, 5.663872974742653, 5.663872974742653, 7.5125959752316245, 7.5125959752316245, 8.800438096758885, 8.800438096758885, 7.330425803585725, 7.330425803585725, 8.592728770912872, 8.592728770912872, 8.282913451485681, 8.282913451485681, 6.124157578215849, 6.124157578215849, 7.9288237475262715, 7.9288237475262715, 3.1915183672960628, 3.1915183672960628, 4.984749272050923, 4.984749272050923, 3.856073234400052, 3.856073234400052, 6.199286217529289, 6.199286217529289, 1.88027754299341, 1.88027754299341, 7.26395927727656, 7.26395927727656, 8.29802287778067, 8.29802287778067, 3.8975618130802916, 3.8975618130802916, 12.63868582616412, 12.63868582616412, 5.890178650315845, 5.890178650315845, 5.2783596382465, 5.2783596382465, 6.364934299601359, 6.364934299601359, 5.353972531827813, 5.353972531827813, 8.903639991464388, 8.903639991464388, 3.3116913385266304, 3.3116913385266304, 3.284911898726595, 3.284911898726595, 9.762354630861712, 9.762354630861712, 5.765544764596926, 5.765544764596926, 8.344290112854804, 8.344290112854804, 3.8817510671024147, 3.8817510671024147, -1.5980655994281467, -1.5980655994281467, 5.731067660839414, 5.731067660839414, 2.1081635199420994, 2.1081635199420994, 3.373149769393114, 3.373149769393114, 6.530937749694996, 6.530937749694996, 6.874484583546978, 6.874484583546978, 1.3849932077116127, 1.3849932077116127, 4.888603912101428, 4.888603912101428, 3.311514540899098, 3.311514540899098, 2.810566793154372, 2.810566793154372, 4.417776776949207, 4.417776776949207, 1.2006384913670443, 1.2006384913670443, 2.9388600058251493, 2.9388600058251493, 2.1165039497782985, 2.1165039497782985, 8.583159211675305, 8.583159211675305, 5.720376137068636, 5.720376137068636, 9.725203921858695, 9.725203921858695, -1.9736809699767375, -1.9736809699767375, 3.991414043688936, 3.991414043688936, 16.77994899769603, 16.77994899769603, 1.364662155575343, 1.364662155575343, 5.366296109390341, 5.366296109390341, 1.8434662334549774, 1.8434662334549774, 1.4502255472608574, 1.4502255472608574, 11.114783854293636, 11.114783854293636, 6.892787507349621, 6.892787507349621, 3.915034227454137, 3.915034227454137, 5.386733355225668, 5.386733355225668, 4.542075329910018, 4.542075329910018, 1.9214308935194226, 1.9214308935194226, -0.29879474083393354, -0.29879474083393354, 11.336172742002525, 11.336172742002525, 0.9854060363245336, 0.9854060363245336, 18.32548996780885, 18.32548996780885, 6.810435988647318, 6.810435988647318, 6.891071042172635, 6.891071042172635, 8.097188154952287, 8.097188154952287, 12.280127789613823, 12.280127789613823, 14.27090457771289, 14.27090457771289, 7.84391239836275, 7.84391239836275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2943796141227406, "mean_inference_ms": 2.224860785039237, "mean_action_processing_ms": 0.10213948397052205, "mean_env_wait_ms": 0.6084535680672247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 94500, "timesteps_this_iter": 0, "agent_timesteps_total": 283500, "timers": {"sample_time_ms": 12906.017, "sample_throughput": 261.506, "load_time_ms": 0.501, "load_throughput": 6734752.367, "learn_time_ms": 1941.609, "learn_throughput": 1738.249, "update_time_ms": 23.936}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 17.600197410583498, "policy_loss": -0.009692206745967269, "vf_loss": 17.619976615905763, "vf_explained_var": -0.15782960653305053, "kl": 0.003076395890592548, "entropy": 1.00870361328125, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.349616527557373, "policy_loss": 0.011086755990982055, "vf_loss": 6.348809289932251, "vf_explained_var": -0.05686035752296448, "kl": 0.0046399662237680325, "entropy": 1.0395684659481048, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 94500, "num_agent_steps_sampled": 283500, "num_steps_trained": 94500, "num_agent_steps_trained": 283500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3780, "training_iteration": 28, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-15-38", "timestamp": 1706105738, "time_this_iter_s": 13.179195165634155, "time_total_s": 360.3016448020935, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D93820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 360.3016448020935, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 41.15294117647059, "ram_util_percent": 75.97058823529412, "gpu_util_percent0": 0.04352941176470588, "vram_util_percent0": 0.20493451286764705}}
{"episode_reward_max": 13.305836380284427, "episode_reward_min": -15.204456859478508, "episode_reward_mean": -0.41759702001031834, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.51939022356989, "policy_agent_": -1.1488569544204257}, "policy_reward_max": {"policy_adversary_": -4.435610125430745, "policy_agent_": 19.685571128587597}, "policy_reward_mean": {"policy_adversary_": -12.727445638932267, "policy_agent_": 6.1549243094609745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.650905061860974, 2.646975655024799, -8.700319906471167, 3.1810639778935133, -0.05213292008662529, 6.07350552531315, -5.930986147070932, -5.707704019624419, -10.863154515180343, -0.9506341432402716, -0.6637874556362648, 2.8744150972143148, -2.8404869922326554, 1.3090716392581276, 7.700610462514069, 0.9764758517779134, -7.531949576698931, -5.821256165922638, -1.6461296330163386, 11.765427100405354, 4.049472509023464, -0.23357165735304883, -3.093045410725175, -2.715822179694655, 1.7533410533762093, 7.233377730568808, -1.1385131961947805, -4.427822356689191, 0.8427525103175196, -0.43032029375401704, 1.169175641298181, 4.884220077683866, 5.666701098107288, 1.7798642364267265, -9.159613419710382, -1.4356008859806437, -2.7767005013238943, -8.445524442484501, -4.1028692027997735, -11.037628550894294, -1.7179970558695583, -0.3369393454840831, -5.541095468377646, -1.6621245937146925, 3.6838454362946997, -2.8517007877676193, 7.257781706575777, -6.825020469023388, -3.64038519902696, 10.064007037359746, 3.8647098970052776, 2.4560741749080415, -2.9162901201606757, 4.396951561295357, 2.025610811829793, -9.211406959375115, 1.614397010164782, -2.6727448715511795, 9.375508162404039, -10.505201047057732, -1.874234792696392, -6.427923410028968, -3.591686534599039, -0.7561333310323313, -6.780323098218778, 6.568197840605609, -3.6551582157328886, 2.8782386961854116, 1.818454933168331, 3.4448337850197728, -7.189212639853798, -0.042198399619773314, 1.450887683187839, 0.6790022810162863, 2.6586181272437384, 4.576328391896829, -8.574002385729788, -3.619801776348095, -3.4692085675611817, -1.4652307585351376, 0.028474964558031557, -5.178056637382663, 13.305836380284427, -0.245216501389112, -4.431824343272563, 0.425701713284121, -2.8312493292837546, 3.021231245934984, -5.47054787603063, 1.8453861861226208, 5.95804609063285, 5.724870586820968, -7.197262224394355, 2.3435603246593293, 2.0289763399513343, 0.021776466114763693, 1.8759484694579829, 0.1460959950282293, 3.1127362207285314, 6.160104542022314, 4.04223879720771, -0.9319056721269686, -3.1693350148010064, -10.541103557572615, 5.287290771548347, -6.087607751581522, 4.595161253360065, -2.258269490443915, -8.043522175850907, 3.4482951916490148, 2.835688971221532, 0.5044839702027555, -2.7589538058905316, 1.100551444469279, -3.559644763415208, 5.365278435275254, -15.204456859478508, -4.662893431592342, 10.61834903323778, -10.629165377175346, -1.0464560436220571, 0.8310161090834608, 2.5257623551764725, 2.0054541264044623, -1.1772120741730043, 9.174378598046626, 2.076377698637295, 2.7818355638725905, -2.07972979993448, 4.435056843224903, 0.5899204262597396, -0.3244471867617423, 2.3086826375971268, -4.697858177890843, -4.712656723479642], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.275153966515218, -10.931235139948551, -6.402605997630319, -12.702322021964086, -13.40243266289198, -13.21828795511057, -19.27062138133227, -9.628154851620229, -11.564789989610817, -13.148520693029, -10.660391916177282, -11.18762903876266, -13.991734575676995, -13.911921898815274, -23.056742099306472, -15.444710380342588, -17.977306309153548, -12.319173794981868, -12.48772322183709, -19.16296567279399, -18.662527811157624, -9.311396773399114, -9.186478254436857, -6.846120689415889, -11.920888198358174, -16.98129886768652, -12.474461334677253, -6.123943410879868, -13.401216838828242, -7.797005736225754, -10.01643103906196, -13.480747923267849, -21.872969674621665, -14.898365977113995, -14.177417868084083, -11.596480114082096, -21.217943265812803, -17.246286949442165, -9.993950724654315, -22.584619830638104, -4.435610125430745, -5.653325519873653, -8.525582446985382, -16.414666845980943, -14.02771992184739, -10.36265225141249, -12.63084638077575, -7.790294716784888, -5.144946103513137, -18.82038580133253, -14.017017830137709, -13.035920430647117, -8.31267991865862, -15.03796120695757, -9.93924089770816, -9.245557321282362, -12.053734157207717, -8.53863419898967, -17.14667704547453, -14.34482249328567, -8.059688803296746, -8.387423886235466, -8.281851547220166, -10.183054795334161, -20.082706598142057, -24.34175466767333, -10.010241210388779, -11.095817656070999, -7.178227587640471, -15.62243126468992, -6.96324222360421, -14.854677089190492, -7.332293238221006, -8.313150196896629, -11.22738975885444, -15.757194134820327, -8.847978226488594, -9.400709246448658, -10.026198549068646, -6.134267158544961, -13.599487783035098, -6.791944981321686, -22.84367928355091, -4.518088848069268, -16.709736784069875, -11.204961270713486, -33.51939022356989, -8.356724719571991, -8.349398218171766, -14.414827738853843, -15.09846812822497, -11.61145690079445, -11.10662783267639, -14.80314444960243, -13.63689771686991, -5.599385980346154, -12.139658905191785, -11.78023428139422, -10.417324767607923, -20.495905088302766, -14.339052258634007, -12.917896622976833, -6.691068217965869, -9.702363449029317, -16.095104753221808, -6.754324895954624, -17.812127191500565, -12.328057633637766, -8.61541754407002, -9.760862504637391, -10.055761856658286, -9.646291923647471, -12.576005579395147, -12.745201436366044, -7.534355145456304, -20.875605083220183, -16.90605350221082, -14.202658881798742, -28.75279322393743, -15.597063706521547, -21.56288370487048, -14.69908380657588, -22.424602637308627, -10.246572130837125, -15.515775891305646, -19.063618394166213, -14.165800686434487, -12.818120071886367, -8.8242585217699, -11.34446696176818, -11.854548479055925, -7.109873426905435, -9.084142417998239, -7.752457571503562, -11.719998938229644], "policy_policy_agent__reward": [6.9630295141880945, 6.9630295141880945, 6.7891053974866775, 6.7891053974866775, -1.1488569544204257, -1.1488569544204257, 7.941692999928799, 7.941692999928799, 6.67514987140268, 6.67514987140268, 9.645896740211857, 9.645896740211857, 6.669817617130668, 6.669817617130668, 1.9602254159979058, 1.9602254159979058, 0.35081773721523596, 0.35081773721523596, 6.0989432748943635, 6.0989432748943635, 4.998302230270511, 4.998302230270511, 7.03102206798849, 7.03102206798849, 5.575623791722171, 5.575623791722171, 7.610496769036702, 7.610496769036702, 15.378676280910273, 15.378676280910273, 8.210593116060252, 8.210593116060252, 5.222678366227306, 5.222678366227306, 3.248958814529613, 3.248958814529613, 5.420796794410375, 5.420796794410375, 15.46419638659967, 15.46419638659967, 11.356000160090543, 11.356000160090543, 4.538912558023032, 4.538912558023032, 3.046716421855841, 3.046716421855841, 2.065149254860616, 2.065149254860616, 6.837114625867193, 6.837114625867193, 12.107338299127665, 12.107338299127665, 5.667974069241237, 5.667974069241237, 0.8480605270953401, 0.8480605270953401, 7.1219846745728805, 7.1219846745728805, 3.68334272123587, 3.68334272123587, 5.59280334018007, 5.59280334018007, 9.182484000475855, 9.182484000475855, 13.769835386364477, 13.769835386364477, 8.339115106770361, 8.339115106770361, 2.5089022241868544, 2.5089022241868544, 5.080439614050723, 5.080439614050723, 9.220621382244454, 9.220621382244454, 4.400381253478833, 4.400381253478833, 2.9455407609272712, 2.9455407609272712, 5.773495639871906, 5.773495639871906, 1.3588065347805938, 1.3588065347805938, 2.6581930871947836, 2.6581930871947836, 1.4922434893038683, 1.4922434893038683, 7.37627112613313, 7.37627112613313, 8.855782679071046, 8.855782679071046, 3.755475731822436, 3.755475731822436, 9.944314043675767, 9.944314043675767, 0.48263712388075164, 0.48263712388075164, 0.7522804522430884, 0.7522804522430884, 14.44219641934614, 14.44219641934614, 8.940863863571494, 8.940863863571494, 7.745997302777578, 7.745997302777578, 2.6981948992489717, 2.6981948992489717, 9.717456384126464, 9.717456384126464, 5.982425854768975, 5.982425854768975, 0.017075180953624064, 0.017075180953624064, 6.834065583686252, 6.834065583686252, 2.9329446637192453, 2.9329446637192453, 13.261092603939282, 13.261092603939282, 1.9198107231139705, 1.9198107231139705, 3.0927270053001767, 3.0927270053001767, 0.9797502381032505, 0.9797502381032505, 2.345082506310564, 2.345082506310564, 4.713460732150915, 4.713460732150915, 6.651191749961644, 6.651191749961644, 15.45497625413947, 15.45497625413947, 3.1775414973279466, 3.1775414973279466, 6.987028176128204, 6.987028176128204, 4.498341260404403, 4.498341260404403, 9.533632524854845, 9.533632524854845, -0.11298520812479187, -0.11298520812479187, 7.406239344785357, 7.406239344785357, 4.391590460704424, 4.391590460704424, 4.496076238956458, 4.496076238956458, 6.94300394304909, 6.94300394304909, 10.166761263358577, 10.166761263358577, 0.13698792037940472, 0.13698792037940472, 2.8904537350502797, 2.8904537350502797, 3.278494990753731, 3.278494990753731, 2.334518200004912, 2.334518200004912, 6.813981373796568, 6.813981373796568, 0.8069441719695122, 0.8069441719695122, 18.074757831917672, 18.074757831917672, 2.136436173340077, 2.136436173340077, 6.138956220398656, 6.138956220398656, 5.815331491998802, 5.815331491998802, 15.344070447143068, 15.344070447143068, 5.688977982753491, 5.688977982753491, 1.4394251710705679, 1.4394251710705679, 8.130106962488233, 8.130106962488233, 10.528257109428905, 10.528257109428905, 8.668163743807709, 8.668163743807709, 1.9546828041410174, 1.9546828041410174, 8.573352387130878, 8.573352387130878, 7.832937028410621, 7.832937028410621, 2.810581223230458, 2.810581223230458, 7.007803687324884, 7.007803687324884, 5.963165138211226, 5.963165138211226, 6.765030494168227, 6.765030494168227, 13.32800481516254, 13.32800481516254, 9.190645527920859, 9.190645527920859, 5.992995475424933, 5.992995475424933, 1.7608666015824321, 1.7608666015824321, -0.41937005427164825, -0.41937005427164825, 10.691197762385075, 10.691197762385075, 0.3333585721865491, 0.3333585721865491, 11.203644222430315, 11.203644222430315, 5.034894071596925, 5.034894071596925, 0.28594768410955645, 0.28594768410955645, 6.604578848143202, 6.604578848143202, 6.445725413939908, 6.445725413939908, 5.075387946925112, 5.075387946925112, 4.908525886752308, 4.908525886752308, 6.922876440417663, 6.922876440417663, 1.9873551910205467, 1.9873551910205467, 13.120441759247722, 13.120441759247722, 0.8507983213661574, 0.8507983213661574, 4.7698827251032005, 4.7698827251032005, 19.685571128587597, 19.685571128587597, 2.483949164673103, 2.483949164673103, 10.258213830624214, 10.258213830624214, 7.765049957829669, 7.765049957829669, 12.475182496242555, 12.475182496242555, 6.126013128620793, 6.126013128620793, 7.169281908566322, 7.169281908566322, 14.118998496106416, 14.118998496106416, 8.121089192535889, 8.121089192535889, 7.799977817879481, 7.799977817879481, 3.372264360917712, 3.372264360917712, 7.88976190249654, 7.88976190249654, 6.222234452657834, 6.222234452657834, 3.392713120071846, 3.392713120071846, 5.696412527797683, 5.696412527797683, 1.527299696806359, 1.527299696806359, 3.503671107375002, 3.503671107375002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2942482727840814, "mean_inference_ms": 2.2210336438841103, "mean_action_processing_ms": 0.10145044722344089, "mean_env_wait_ms": 0.6069387429326882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 97875, "timesteps_this_iter": 0, "agent_timesteps_total": 293625, "timers": {"sample_time_ms": 12905.523, "sample_throughput": 261.516, "load_time_ms": 0.501, "load_throughput": 6734752.367, "learn_time_ms": 1937.532, "learn_throughput": 1741.906, "update_time_ms": 23.936}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 18.132618141174316, "policy_loss": 0.007316197734326124, "vf_loss": 18.135367965698244, "vf_explained_var": -0.10843780040740966, "kl": 0.0023694809436954458, "entropy": 1.006562352180481, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.866215538978577, "policy_loss": -0.010752194374799729, "vf_loss": 6.887237453460694, "vf_explained_var": -0.031661593914031984, "kl": 0.007411826682627948, "entropy": 1.0362325727939605, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 97875, "num_agent_steps_sampled": 293625, "num_steps_trained": 97875, "num_agent_steps_trained": 293625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3915, "training_iteration": 29, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-15-51", "timestamp": 1706105751, "time_this_iter_s": 12.031904935836792, "time_total_s": 372.3335497379303, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 372.3335497379303, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 33.593333333333334, "ram_util_percent": 75.00666666666666, "gpu_util_percent0": 0.06466666666666668, "vram_util_percent0": 0.21119791666666668}}
{"episode_reward_max": 15.058171507368977, "episode_reward_min": -15.854702083720328, "episode_reward_mean": 0.6920007041549724, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.02112037073112, "policy_agent_": -2.4063104982751096}, "policy_reward_max": {"policy_adversary_": -3.9541416169367682, "policy_agent_": 21.667629497396277}, "policy_reward_mean": {"policy_adversary_": -13.386083563125569, "policy_agent_": 7.03904213364027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.680687106192622, -14.57933958565818, 7.244494114959452, -2.131148413919559, -3.8530197351087114, 4.731616483421596, -3.8109820018248923, -2.922517121079699, 4.963256265886481, 6.158387963016108, -4.990738973356837, 1.1445350324500048, -13.697089670952973, 12.384419776229558, 2.437400424787435, 5.56780905692131, 14.732594778667405, -4.934563619567175, 1.4197021744791725, 1.4780833404193885, 0.2698205614733486, 2.2518076649537515, -13.8382028814752, 7.624442055056872, -4.973308184244886, -0.3941635585132244, -0.9986152803544132, -3.8972645710116725, -1.4264424292327016, -3.6552841748761353, 7.635925742760049, 0.5396722165633463, -0.25370240743724476, 15.058171507368977, 0.09620918386919342, -1.187421250966322, 2.523136820664557, 3.516273392397848, 2.2456703900241495, 6.33710119374318, 2.861658226927087, -0.1343118036074562, 6.9395881296934325, 1.7638740673963886, -0.47779731170390366, 0.658262813512753, -0.6563531688581835, -0.4508895445366381, -0.9620615108959762, -6.493812064616309, 10.582911370479684, -3.406474417383494, -0.07861182951008128, 0.5507416074954349, 3.6070407465364704, 7.075156159650829, -2.6494025504726233, -3.4979701737931457, -3.1597906794638226, 5.732102356258332, -1.3244324883772371, -0.005403375115317188, -15.854702083720328, 0.11049598926290796, 1.7728195920795393, -1.5728442343522766, 4.724334047602846, 3.9918600596549396, -2.2339357975313874, 0.20604682772115984, 0.23695830157399092, -0.566914892799375, -2.4694950257252812, -3.837907058102905, 2.6850102144235666, 2.612981480815009, 3.4823771838324924, 6.71325770906248, 2.832238771738171, 2.9392550383151956, 0.6759110074927364, -0.9832297584858025, 0.8717884136966207, -2.977765825177614, 1.0872316107994973, -11.699215718716676, 3.9061051793003787, 0.4966663398661756, -1.0464223694553187, 6.300764273949689, 3.852108821408167, 2.166700683492857, 5.428550536466266, -0.0934711096405969, -12.334626024312962, 2.568039908700313, 5.090511660312305, -1.689007659592073, -1.3053018800194147, 5.753894917273439, 3.3259959453418775, 5.794999969734975, -0.09417892297868759, 5.680529220771485, 4.5795590296741056, 1.860268611316157, -4.620917799803375, -1.2025480613573984, -13.410886838638083, 3.2263298122363233, -1.610807248199305, 3.4842231160613886, 4.549727804154758, 3.084213642872063, 8.690068233383968, -3.088609794880494, 0.972255681266524, 3.2204242377434236, 5.126463245833083, 5.741096503529793, 2.3090863817660443, 12.586735611774218, 2.0238418179338855, -0.3195497699664866, 1.1845081215499265, 11.637774489898028, 0.18443497428397923, -0.8763797348061979, -3.8328087211241715, -2.6230637808925388, -5.879240066699842, -5.978958112491153, 8.891768851675392, -0.43079859883341654, -11.216595656374682], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-3.9541416169367682, -19.671310799467662, -18.375955636691472, -13.965509803424363, -12.376168990695515, -15.64265761789384, -12.337207134098385, -23.99822382220351, -18.781229394979974, -12.08745495768242, -8.628182133689837, -22.569297751893675, -8.884468674402754, -30.02112037073112, -7.7855746754562976, -12.924605715992064, -25.154358526753764, -16.171440474362612, -16.904700350287897, -12.752166300106726, -12.202404766420646, -10.224258240679578, -12.459176978729031, -19.430575122184763, -8.145150366454418, -10.562376443493799, -11.768488754970868, -20.282217774138875, -7.424360075621966, -7.778328487705421, -19.436867836644534, -7.107196274123599, -9.876233786212595, -28.277087487423586, -18.693897448179168, -9.482429745781976, -6.96899305944849, -13.412677615174806, -14.986162784655976, -15.212984867755678, -7.282428240798288, -18.45877764486451, -15.568393684825818, -13.627680182107852, -11.788621111707425, -11.47163686660542, -12.337461585438144, -8.459921456120687, -12.96952966464384, -18.0219190861977, -24.992917149365738, -17.735858769935735, -10.107784049982168, -12.177027726236119, -9.611673721359368, -17.73936526274273, -12.600847031965802, -7.60466049525524, -6.951091051919439, -13.28170162620204, -14.23057245418452, -14.785520018731965, -26.336576231471224, -5.082261580293693, -8.210621985650365, -12.70693536449727, -11.555326713598504, -11.583074760878146, -4.062496148907786, -11.326078328189219, -11.434834578242718, -9.631913682509172, -14.42858358754694, -13.882745337199061, -19.429931343277286, -14.418070896345654, -11.770548558920863, -12.87963393589958, -14.059528100791153, -16.15795538154182, -9.59244298576505, -10.781186335696002, -7.620290869022547, -5.447904100202118, -9.41002649292402, -12.132656440170951, -13.060089246949474, -9.41720624738164, -15.58278530369371, -18.48859273449866, -14.742322119634464, -10.871356521939648, -12.33586072968325, -10.059544243849919, -15.715602046622365, -14.79769276433268, -11.725127077067933, -17.09713197331887, -9.559906444143488, -15.657547800484679, -16.744344534313775, -14.767017641536697, -5.5888576245168755, -17.144760045318872, -16.695757342346166, -12.50383179547359, -7.3849370050521035, -15.340149188081536, -9.083688329436367, -12.394290254587903, -10.40663541045784, -20.851641328429018, -20.265710340141315, -10.70920987223137, -15.365497961962959, -8.373414132776475, -7.65295891989967, -11.072543965451793, -18.42772294789292, -19.24979313728289, -15.813672389883191, -22.084719903332143, -11.328471367370334, -10.250603419247525, -15.25507734011023, -22.162822445732232, -6.11408944994395, -13.526463503592586, -6.362031901339537, -8.786724150371663, -18.7811100633741, -6.48202749431189, -25.709130594745243, -5.362671947839573, -7.503482735684516], "policy_policy_agent__reward": [-1.3632727446279258, -1.3632727446279258, 2.5459856069047384, 2.5459856069047384, 12.810224875825458, 12.810224875825458, 5.917180694752403, 5.917180694752403, 4.261574627793402, 4.261574627793402, 10.18713705065772, 10.18713705065772, 4.263112566136744, 4.263112566136744, 10.537853350561907, 10.537853350561907, 11.872242830433224, 11.872242830433224, 9.122921460349264, 9.122921460349264, 1.818721580166498, 1.818721580166498, 11.856916392171842, 11.856916392171842, -2.4063104982751096, -2.4063104982751096, 21.202770073480334, 21.202770073480334, 5.111487550121866, 5.111487550121866, 9.246207386456685, 9.246207386456685, 19.943476652710586, 19.943476652710586, 5.618438427397717, 5.618438427397717, 9.162201262383537, 9.162201262383537, 7.115124820263057, 7.115124820263057, 6.236112663946997, 6.236112663946997, 6.238032952816663, 6.238032952816663, -0.6895129513730839, -0.6895129513730839, 13.527508588620815, 13.527508588620815, 1.5859210911047676, 1.5859210911047676, 5.0841064424902855, 5.0841064424902855, 5.3849367373082275, 5.3849367373082275, 8.192476601563602, 8.192476601563602, 2.9989588231946325, 2.9989588231946325, 2.061522156414645, 2.061522156414645, 13.53639678970229, 13.53639678970229, 3.823434245343473, 3.823434245343473, 4.811265689387672, 4.811265689387672, 21.667629497396277, 21.667629497396277, 9.39505331602418, 9.39505331602418, 4.147504247407826, 4.147504247407826, 4.746064940056523, 4.746064940056523, 8.464475503786327, 8.464475503786327, 8.615916587340061, 8.615916587340061, 10.77504303074943, 10.77504303074943, 5.072043233862687, 5.072043233862687, 9.16223292062853, 9.16223292062853, 11.253990907259626, 11.253990907259626, 7.6957771247521185, 7.6957771247521185, 5.655411900001763, 5.655411900001763, 6.0649498400590875, 6.0649498400590875, 5.840554208289983, 5.840554208289983, 4.004515955792023, 4.004515955792023, 6.003734076873931, 6.003734076873931, 5.764053510790693, 5.764053510790693, 17.787914259922708, 17.787914259922708, 7.164692176276119, 7.164692176276119, 5.014586110236044, 5.014586110236044, 6.3638846668657765, 6.3638846668657765, 6.60935723394792, 6.60935723394792, 12.407260711196779, 12.407260711196779, 4.975722240746587, 4.975722240746587, 2.0533451607310464, 2.0533451607310464, 1.8956501862278068, 1.8956501862278068, 9.50690199123019, 9.50690199123019, 6.45306998290364, 6.45306998290364, 7.390058321808324, 7.390058321808324, 5.240937073875449, 5.240937073875449, 2.5963787847783006, 2.5963787847783006, 4.991720788864954, 4.991720788864954, 5.5670455650724975, 5.5670455650724975, 8.139830380600674, 8.139830380600674, 7.787467410266542, 7.787467410266542, 0.9142801756881985, 0.9142801756881985, 5.76606257795519, 5.76606257795519, 5.835896439908355, 5.835896439908355, 4.532499394854899, 4.532499394854899, 5.9795442809108295, 5.9795442809108295, 5.0224191395480755, 5.0224191395480755, 11.057470778850428, 11.057470778850428, 8.515526188580331, 8.515526188580331, 7.626462871376676, 7.626462871376676, 9.79644582248103, 9.79644582248103, 8.445883436264662, 8.445883436264662, 9.54860520992851, 9.54860520992851, 5.134176996628893, 5.134176996628893, 4.8989782886051, 4.8989782886051, 4.246039641359584, 4.246039641359584, 1.2350691375122507, 1.2350691375122507, 5.248629051861759, 5.248629051861759, 0.21672036072713707, 0.21672036072713707, 8.483097213124928, 8.483097213124928, 4.956936293623909, 4.956936293623909, 7.268181467119195, 7.268181467119195, 12.394678504224176, 12.394678504224176, 9.297215470521317, 9.297215470521317, 6.519028602716252, 6.519028602716252, 8.88220563307476, 8.88220563307476, 4.983036567104662, 4.983036567104662, 1.6904880111547007, 1.6904880111547007, 8.682866336516495, 8.682866336516495, 8.407819368690118, 8.407819368690118, 7.7040621568633965, 7.7040621568633965, 4.127302282062037, 4.127302282062037, 10.70572135887906, 10.70572135887906, 10.035170239827826, 10.035170239827826, 10.281008805635835, 10.281008805635835, 2.7473393507690935, 2.7473393507690935, 11.41264463304518, 11.41264463304518, 10.637658186010137, 10.637658186010137, 7.182050203394874, 7.182050203394874, 1.3820096026243665, 1.3820096026243665, 7.068800563362068, 7.068800563362068, -2.1635992546008596, -2.1635992546008596, 7.810310033412114, 7.810310033412114, 4.397914081129267, 4.397914081129267, 12.1679322222452, 12.1679322222452, 12.407719072148033, 12.407719072148033, 6.896711757551714, 6.896711757551714, 12.027783097673467, 12.027783097673467, 2.6424021689479904, 2.6424021689479904, 4.312607300583096, 4.312607300583096, 7.14648410159761, 7.14648410159761, 11.777093096863, 11.777093096863, 12.495444820406343, 12.495444820406343, 9.061379385824617, 9.061379385824617, 17.335727757553183, 17.335727757553183, 6.6761565926521085, 6.6761565926521085, 4.965526824640516, 4.965526824640516, 8.219792730830079, 8.219792730830079, 16.900298467815126, 16.900298467815126, 3.149262212113964, 3.149262212113964, 6.325041884393193, 6.325041884393193, 1.2646115901076824, 1.2646115901076824, 3.0818301847395615, 3.0818301847395615, 6.45093499833713, 6.45093499833713, 0.2515346909103684, 0.2515346909103684, 17.30044972321032, 17.30044972321032, 2.465936674503078, 2.465936674503078, -1.8565564603450788, -1.8565564603450788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29263566893916443, "mean_inference_ms": 2.2088473350738806, "mean_action_processing_ms": 0.10110529535292996, "mean_env_wait_ms": 0.6038660092328815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 101250, "timesteps_this_iter": 0, "agent_timesteps_total": 303750, "timers": {"sample_time_ms": 12700.02, "sample_throughput": 265.748, "load_time_ms": 0.501, "load_throughput": 6734752.367, "learn_time_ms": 1898.559, "learn_throughput": 1777.664, "update_time_ms": 23.836}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 20.117993354797363, "policy_loss": 0.00025748254965947127, "vf_loss": 20.12776870727539, "vf_explained_var": -0.1098982572555542, "kl": 0.005196396501792866, "entropy": 1.003301054239273, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 8.055714178085328, "policy_loss": -0.019028639048337938, "vf_loss": 8.085034060478211, "vf_explained_var": -0.0320010781288147, "kl": 0.005911919311334402, "entropy": 1.0365119338035584, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 101250, "num_agent_steps_sampled": 303750, "num_steps_trained": 101250, "num_agent_steps_trained": 303750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4050, "training_iteration": 30, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-01", "timestamp": 1706105761, "time_this_iter_s": 10.851900339126587, "time_total_s": 383.1854500770569, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FFDC9CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 383.1854500770569, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.835714285714282, "ram_util_percent": 74.57142857142857, "gpu_util_percent0": 0.24714285714285708, "vram_util_percent0": 0.21337890625}}
{"episode_reward_max": 19.094893047643016, "episode_reward_min": -16.043737217918984, "episode_reward_mean": -0.1696399521990658, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.72345349432161, "policy_agent_": -1.1011186182421668}, "policy_reward_max": {"policy_adversary_": -4.505398748168091, "policy_agent_": 24.110103993135517}, "policy_reward_mean": {"policy_adversary_": -13.075212637604272, "policy_agent_": 6.452786342702605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.053532577746915, -0.6372212245322582, -5.21055654609518, -1.388392861361345, 10.59625199534241, -2.9135121614152326, -4.4424623095659195, 7.554430037824242, -0.8287040039316509, -9.581489168982737, -4.629729388966105, -1.1683288079050453, 3.1965923891126833, -2.1140005495397496, 0.07609036124229551, 2.123352129410432, 1.121539235362805, -0.7314404999290568, 1.956811062878614, 1.6084966798757296, 5.123395958693601, -2.651520148677549, -3.921184330846139, -1.4113572214000132, -3.617774824491116, 4.216195626580145, 3.398721179066905, 3.655761930285781, 3.0239698897491127, -7.122842048337772, 5.0735738519350555, -4.0147085505426805, -6.199879496533217, 2.044874745205888, -0.6454229560420748, 5.752666990696748, 1.1344306948019507, 2.563766966168444, -9.313746302529967, -0.23228488323091812, -2.9239012321726485, -12.790234364007992, 12.662284874811471, 9.939503987910168, -6.414407458209794, 4.804926928697137, -2.804391290894512, -5.107045894197666, 1.5546960082982557, 3.261566083798777, -3.2641178524028867, -0.022085440630820852, 1.0266689212180697, -5.186120802165114, -12.791968394336, 6.226126042951913, -3.089711408674445, 7.304457007954547, 0.2895561978046716, -6.681569728109345, -0.6079621996371856, 4.299324580029689, 5.932733515817121, 3.0073830609357284, -2.821752170156051, 0.7385421429656425, -5.277597233039695, -3.0296310843814664, 5.893009461013795, -10.118811068816559, -2.1997325574574487, -16.043737217918984, 8.058811992449739, -0.9373992297133897, 1.2296269790954624, 5.338784655888127, -3.4175700349178766, 2.0835317339954385, 3.859275554558169, -3.8883699475739695, 14.987050942669514, 4.914864265739072, -4.353983593719125, -1.9963399304406244, 2.753100233649117, -2.623120716367783, 2.75341921224428, 8.670729230714379, 4.538019060126427, 7.263243600283679, -11.104441487926668, -0.44608708132689373, -3.2473929501448042, -2.1945568690425303, -2.5944320703400416, 0.5304598971195615, -0.15599576785966407, -4.463787325261733, 0.2587774184297808, -0.8142235034623477, -2.3586725313669774, -4.1458561329132895, -5.621412857628405, -1.7840711638110545, -0.27460010653268885, 16.29377540528908, -3.096307446436564, -3.373079124789996, -4.138162992101151, -2.1085436481513087, -3.2383481231490236, 3.8869401823191625, 0.4351810485291565, -4.761640240091878, -0.805101519513669, -3.6480702939527636, 0.20811425997921085, -2.0935418443468357, 0.36168408782988287, -2.795949772532552, 5.084861723671565, 6.624712215654521, 3.824584812909248, -2.503465533027678, 1.7156695849604262, -1.9159610282255515, 4.979342100316593, -4.423674812671463, -4.259228480542121, -0.6310981375041118, 19.094893047643016, -0.4038181288188214, -3.757902591163286, -4.175354450885, 0.7438823966865928], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.114422447571574, -21.672919775509005, -4.97786210828151, -15.893976689187001, -15.117041711550623, -8.493189942130366, -7.135002166215659, -16.561189188996455, -9.235760397074165, -14.390671977770952, -4.505398748168091, -11.075783013483015, -12.06326221282412, -7.3391744067489295, -11.004973871484186, -13.068177205324679, -15.024119608936234, -12.395149834463998, -12.17095607800456, -12.984002500352625, -13.762771733440085, -13.89350055889247, -19.431863141389083, -8.216321427654442, -5.5629872197006, -18.23556391535279, -12.982566547859616, -29.72345349432161, -7.1049643696370985, -26.022554992544638, -17.601148654360433, -6.659219494294856, -19.121114763035365, -14.117952154926593, -5.55769153730541, -12.239364595088334, -12.597087125169404, -10.543466874754001, -15.357749427614205, -5.7200608417277605, -5.882490649118778, -16.92968446939889, -24.575515448765255, -21.037863448394884, -14.73652603142457, -16.09470491796247, -5.658953141779006, -8.269351238046486, -12.723529222073005, -11.755602933493247, -10.40274796430777, -17.875424057734968, -17.86392929652941, -11.799135002916966, -15.54608654081289, -14.644476084599464, -5.805130819493965, -18.701062616177566, -9.751059146338836, -14.064612478220402, -6.9969144835981805, -13.568225034368101, -13.205629049197327, -9.901309350138394, -15.347643771228219, -6.84385286788841, -23.306375211357906, -18.007956733677755, -16.111772925858325, -12.71777873147494, -7.120569035422748, -13.84149998143464, -15.014573928912903, -10.975665226468792, -14.882705413141263, -14.51602284452176, -17.994267252642455, -14.585335389193741, -12.022388562303846, -7.463159391826293, -25.220111042219514, -11.225072467741702, -10.55466190521481, -20.76366439140234, -10.549244768461293, -12.648307796510029, -13.235878251624401, -17.865167066400858, -15.93315163136796, -23.979137559107762, -15.772292609943488, -7.413279183234453, -7.445943267418816, -8.337115611158357, -11.198708074047161, -9.986079140940262, -11.143667171530685, -13.88739788717892, -9.200758171913485, -7.293327219516936, -6.878000557531752, -16.772441126363553, -13.798265493404251, -9.94888898398337, -10.718062339909979, -24.604666404986045, -9.134259124526515, -10.432541896276847, -12.800142762131292, -7.694796959924712, -16.297618661596097, -13.611622225291047, -7.5840822391102325, -8.438199369910452, -12.383724391265222, -6.009934311334789, -10.849257724260356, -15.734765095644894, -9.912992303175338, -15.161918288204824, -20.784116793225362, -14.50972740156203, -12.75992680652176, -8.240333060768878, -10.01537853196399, -8.083695754849813, -19.422568590704564, -24.28173450536561, -7.040520710978262, -11.21732856120211, -29.125314938628016, -11.18061106201347, -9.907013568858504, -18.652054581162716, -11.298268287615745], "policy_policy_agent__reward": [3.030444934912331, 3.030444934912331, 10.517849275488368, 10.517849275488368, -0.11634721890683611, -0.11634721890683611, 7.2527919139128265, 7.2527919139128265, 12.856646853446515, 12.856646853446515, 2.789838890357566, 2.789838890357566, 1.3462699283248698, 1.3462699283248698, 12.05780961341035, 12.05780961341035, 4.203528196571258, 4.203528196571258, 2.4045914043941083, 2.4045914043941083, -0.06216532039900741, -0.06216532039900741, 4.953727102788984, 4.953727102788984, 7.629927300968401, 7.629927300968401, 2.61258692860459, 2.61258692860459, 5.540532116363241, 5.540532116363241, 7.595764667367556, 7.595764667367556, 8.072829422149518, 8.072829422149518, 5.831854667267472, 5.831854667267472, 7.063883570441586, 7.063883570441586, 7.296249590114176, 7.296249590114176, 9.443083846066846, 9.443083846066846, 5.62099020510746, 5.62099020510746, 7.755339405271472, 7.755339405271472, 3.402482103127215, 3.402482103127215, 0.9726061976047404, 0.9726061976047404, 11.22587977096647, 11.22587977096647, 8.19064386346326, 8.19064386346326, 16.689607712303697, 16.689607712303697, 5.064467129693105, 5.064467129693105, 9.449856472103436, 9.449856472103436, 11.337361253147742, 11.337361253147742, 1.3222554718760886, 1.3222554718760886, 6.460617633251074, 6.460617633251074, 8.08141345006624, 8.08141345006624, 2.4561342906316668, 2.4561342906316668, 8.99601579289254, 8.99601579289254, 6.865758909985679, 6.865758909985679, 6.553616920461223, 6.553616920461223, 3.022001562542121, 3.022001562542121, 2.7438879792484214, 2.7438879792484214, 1.4792947084730654, 1.4792947084730654, 2.0697250526954543, 2.0697250526954543, 18.618900161788368, 18.618900161788368, 15.48868371815253, 15.48868371815253, 4.161059286607385, 4.161059286607385, 10.449815923329803, 10.449815923329803, 1.4272809254422474, 1.4272809254422474, 1.5811526719244082, 1.5811526719244082, 7.139112615185629, 7.139112615185629, 7.508584508646012, 7.508584508646012, 3.569315055952443, 3.569315055952443, 8.926669308552071, 8.926669308552071, 9.445299108873737, 9.445299108873737, 3.3065071003759283, 3.3065071003759283, 1.3770590732384458, 1.3770590732384458, 10.435301063775682, 10.435301063775682, 1.3577097054097598, 1.3577097054097598, 13.00275981206606, 13.00275981206606, 5.020307672071754, 5.020307672071754, 3.6915213750555282, 3.6915213750555282, 3.194476141980498, 3.194476141980498, 8.933774807198894, 8.933774807198894, 9.569181282507223, 9.569181282507223, 6.4543462055370595, 6.4543462055370595, 6.262945800536084, 6.262945800536084, 3.791197505427027, 3.791197505427027, 9.014388989159103, 9.014388989159103, 7.489162824648147, 7.489162824648147, 11.002391193436061, 11.002391193436061, 1.2994838313291903, 1.2994838313291903, 2.46041823898265, 2.46041823898265, -1.1011186182421668, -1.1011186182421668, 11.536692960681318, 11.536692960681318, 5.019132998377701, 5.019132998377701, 8.056166196118363, 8.056166196118363, 9.927403750204945, 9.927403750204945, 7.288348608862287, 7.288348608862287, 8.33443356159459, 8.33443356159459, 7.940832058431007, 7.940832058431007, 1.787394722126161, 1.787394722126161, 20.103580992444513, 20.103580992444513, 8.069968366740389, 8.069968366740389, 3.100339155747844, 3.100339155747844, 9.383662230480855, 9.383662230480855, 6.651172501055205, 6.651172501055205, 5.012593540071121, 5.012593540071121, 7.994648731934341, 7.994648731934341, 13.26794814855762, 13.26794814855762, 10.235585345747193, 10.235585345747193, 15.621190579695723, 15.621190579695723, 2.3339255610084093, 2.3339255610084093, 3.4835960509537798, 3.4835960509537798, 2.0992751586370058, 2.0992751586370058, 3.0712793710579147, 3.0712793710579147, 4.302138001853561, 4.302138001853561, 5.258269519029911, 5.258269519029911, 5.493835701835511, 5.493835701835511, 4.711805280958592, 4.711805280958592, 4.729767795171635, 4.729767795171635, 3.2395518580272937, 3.2395518580272937, 2.259664013082388, 2.259664013082388, 6.313292496725135, 6.313292496725135, 4.0884263178879205, 4.0884263178879205, 4.0824089100861585, 4.0824089100861585, 5.221731116688643, 5.221731116688643, 20.449220905137565, 20.449220905137565, 3.0189758390449755, 3.0189758390449755, 3.5297313857434265, 3.5297313857434265, 4.3309898850150725, 4.3309898850150725, 2.7931266558867005, 2.7931266558867005, 6.529635269223533, 6.529635269223533, 8.749281203805106, 8.749281203805106, 4.009631643819695, 4.009631643819695, 1.8382795649092858, 1.8382795649092858, 5.789311435875777, 5.789311435875777, 1.180932008691014, 1.180932008691014, 5.528685992119784, 5.528685992119784, 6.820611625649031, 6.820611625649031, 5.13733819550261, 5.13733819550261, 6.182984257836137, 6.182984257836137, 12.934489258448469, 12.934489258448469, 10.567219808608277, 10.567219808608277, 8.292255809715503, 8.292255809715503, 2.8684337638706006, 2.8684337638706006, 5.865524058462209, 5.865524058462209, 3.08386736331213, 3.08386736331213, 12.20095534551058, 12.20095534551058, 9.929029846347076, 9.929029846347076, 1.390646115218069, 1.390646115218069, 5.293115211848999, 5.293115211848999, 24.110103993135517, 24.110103993135517, 5.388396466597327, 5.388396466597327, 3.07455548884761, 3.07455548884761, 7.238350065138858, 7.238350065138858, 6.0210753421511685, 6.0210753421511685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917004672454298, "mean_inference_ms": 2.197516072285631, "mean_action_processing_ms": 0.10044731915077994, "mean_env_wait_ms": 0.6008157034310567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 104625, "timesteps_this_iter": 0, "agent_timesteps_total": 313875, "timers": {"sample_time_ms": 12503.346, "sample_throughput": 269.928, "load_time_ms": 0.601, "load_throughput": 5616925.641, "learn_time_ms": 1896.115, "learn_throughput": 1779.955, "update_time_ms": 23.736}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 18.703631782531737, "policy_loss": -0.007021444756537676, "vf_loss": 18.72064971923828, "vf_explained_var": -0.08745365142822266, "kl": 0.003598982361597454, "entropy": 0.9996746480464935, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 7.054994535446167, "policy_loss": -0.0008540058974176645, "vf_loss": 7.066161108016968, "vf_explained_var": -0.022113129496574402, "kl": 0.006624580754815396, "entropy": 1.0395405113697052, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104625, "num_agent_steps_sampled": 313875, "num_steps_trained": 104625, "num_agent_steps_trained": 313875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4185, "training_iteration": 31, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-12", "timestamp": 1706105772, "time_this_iter_s": 10.863620281219482, "time_total_s": 394.04907035827637, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D93280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 394.04907035827637, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.22142857142857, "ram_util_percent": 74.45714285714284, "gpu_util_percent0": 0.25214285714285717, "vram_util_percent0": 0.21337890625}}
{"episode_reward_max": 18.16889690329155, "episode_reward_min": -12.474129973804782, "episode_reward_mean": 0.9007173644820197, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.933142318008787, "policy_agent_": -1.6850393390999472}, "policy_reward_max": {"policy_adversary_": -5.443993163102916, "policy_agent_": 21.17082029418837}, "policy_reward_mean": {"policy_adversary_": -12.660257890416766, "policy_agent_": 6.780487627449394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.135150137425983, 5.80714604325665, -8.304697174047966, -1.4963185104131993, -0.8144900911804924, 2.242170816790442, -2.580265991109798, 1.798392832971337, -2.7516479276423693, 9.709849497559235, 2.92827490107008, -12.474129973804782, 2.6985914425485915, -9.403687699511702, -3.255231698212812, -1.1376918951465629, -0.5770409008357411, 5.589576437987233, -8.438013729525222, -6.521770943885745, -7.364843753861158, 1.4769912358678778, 7.492316903568612, 6.377179212622369, -3.1550804615503822, 3.5534261525103172, 5.8204047938830294, 10.845105868651409, 0.3115767073945269, -2.454278268686852, -3.554983841038668, 6.461527623567109, 18.16889690329155, 7.107705640893011, -1.2096445380721974, -2.6345167652447663, -3.7851262359977906, 2.443634517488948, 6.020387945576919, 1.416970862164976, -7.880545612243085, -0.12999396162559967, 1.2834861598945029, 0.4334628131299055, -4.543592978875848, -0.6268284764624524, -0.4022435009479414, -2.260989586487444, 3.5546663749606635, -2.1230661429201807, -6.009895330834545, 12.42989025952461, 3.7053745613753253, -0.28097902582783085, 1.7309289531416379, 7.941579099938896, 1.2491675590699263, 0.5242765253643915, 1.523256464203098, -1.2076084828575753, -1.856905796228715, -4.068167177499349, -3.328822838236258, 1.7199609255080743, 0.04701761977153396, 0.7749391638347071, 6.325170491600161, 2.6243293314877576, 3.60790741336513, 3.7312642974593135, 2.476017773265833, 1.2749303417585822, 2.7390692037582554, 13.600599275139343, 7.335205242492282, 0.5343188175596673, 0.5679530297939305, 0.21255217040092722, 3.263376361396488, 6.303242382697194, -4.380400171402854, 0.7819587375341077, -3.2308973920894144, -2.5166339452827673, 2.7450135036541257, 3.5470832040028726, 5.964143039384449, -0.09284382633022065, -1.2605276916344992, 2.257965094807394, -2.4524438373970843, 10.372315064982088, -1.4754684360369943, -4.223353218397134, 3.4148697151629306, -0.5537592620716916, -0.8957382649699375, 2.001351745487373, -6.245068691897568, 2.1866961750573193, 11.790786749647534, -7.463864047907608, 5.921184418927607, 3.6633555535264546, 4.656476622358152, 2.8015699968403043, 3.211446443991183, -1.0534456042703404, 0.6566530385158156, -10.062855522472493, -9.314763673335896, 2.3298218214685353, -1.5136974383923307, -4.107569776334459, 11.836211637421489, -2.349724657062661, -5.296437099806054, -3.337900784652665, -5.9842340233845475, 7.549474651028012, 7.989629858018322, 0.584415978875558, 1.8174856157926553, -0.05122150432580008, 2.420901590989354, 6.043529170627547, 5.21554271219929, -6.652030683449938, 2.4048630379738154, -1.275606733826704, 10.733545276075409, 0.5340267520886673, 1.9260228144729634, -1.2108536635156222, -6.046275643758687], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.269675110747192, -16.316437819776674, -10.988660307408036, -8.77189625729707, -11.466405042191802, -10.596510544290508, -14.218343016720512, -14.269479071199193, -7.6440745691432355, -18.747040344202958, -14.78522345497226, -10.18632579603465, -10.779909680212679, -18.973779221425232, -13.289964663168144, -10.204960067489521, -7.278197257646576, -11.490809699370178, -13.268417139727056, -14.729084396751526, -7.2530765355852855, -13.315193703630756, -14.110725615874898, -13.839579192749078, -7.172290614434908, -13.094465391385663, -11.780615841526968, -22.87517603186951, -8.779202927179195, -9.145702776462688, -13.426801233625426, -15.870102483040284, -24.1727436850852, -15.59847658355194, -10.339216144770921, -10.992134043284437, -15.986144061707499, -12.054570985950749, -18.903233237051367, -6.444970514675602, -14.525021178854427, -12.128820599538516, -19.394986445475613, -10.092350488436574, -10.935365889578717, -5.5170923983326, -16.052024708825652, -9.770793051588335, -14.512079804498294, -18.81401881501331, -18.04564933531778, -23.28554769999393, -7.681375213512985, -7.000869760722716, -9.40483341586132, -19.791623890004395, -6.899518200781331, -14.79428793457182, -8.932557471782426, -6.523911499710311, -8.530249972018176, -5.443993163102916, -13.324265213503564, -15.57685389159217, -9.68670085328439, -24.933142318008787, -20.225010760416986, -13.070696218922901, -10.067541701834143, -16.208251378380893, -6.217733400298315, -7.61470679936495, -18.511395770168907, -21.508079061079332, -15.32083535316376, -6.076795661483443, -12.861051186138928, -9.629041442705885, -13.211493992334523, -13.904506968448942, -10.695370686171803, -9.216953328892966, -6.2503773697296285, -21.622228711088354, -10.461692199586082, -13.784786849236966, -10.461454892075677, -9.130004009053954, -11.882032092210514, -11.525312198516842, -16.777340744784343, -18.119601471491066, -14.576985470259897, -7.621452785924445, -11.486315112565798, -13.582835701378693, -6.45323304199478, -10.17966230872724, -13.471656796110807, -12.062263964043668, -18.792283681308124, -17.566216219926588, -19.46413057161407, -12.455181405789027, -15.29755913111245, -9.675089423266037, -13.771657958649637, -10.98593377073174, -14.65464914023031, -6.692776844272616, -12.319338993227523, -8.869611309938648, -6.974714193290345, -8.319618405839208, -17.551186360177756, -10.025245610309383, -8.203025512004132, -11.791418264998546, -13.173356279711058, -15.473893315035946, -16.486156615130017, -9.662824121683819, -10.407483122699068, -15.474523701542585, -10.83153345646954, -12.729764972291882, -12.642762801386414, -10.021611342347327, -13.337905249325065, -9.957276259091174, -19.277329670895874, -5.511129586459385, -8.93394515363922, -17.10903754376947, -14.878397512385781], "policy_policy_agent__reward": [7.702412624086583, 7.702412624086583, 11.061791931516662, 11.061791931516662, 1.3419815666800339, 1.3419815666800339, 3.6377888734419344, 3.6377888734419344, 5.325957475505655, 5.325957475505655, 6.419340680540474, 6.419340680540474, 5.819038512805356, 5.819038512805356, 8.033935952085264, 8.033935952085264, 2.4462133207504326, 2.4462133207504326, 14.228444920881095, 14.228444920881095, 8.856749178021168, 8.856749178021168, -1.1439020888850684, -1.1439020888850684, 6.739250561380636, 6.739250561380636, 4.78504576095677, 4.78504576095677, 5.017366482477667, 5.017366482477667, 4.533634086171479, 4.533634086171479, 3.3505781784054163, 3.3505781784054163, 8.54019306867871, 8.54019306867871, 2.415201705100916, 2.415201705100916, 4.1036567264328925, 4.1036567264328925, -0.05588360913793575, -0.05588360913793575, 7.396092469749317, 7.396092469749317, 10.801521259721754, 10.801521259721754, 10.108379202685722, 10.108379202685722, 2.0086050764422625, 2.0086050764422625, 8.323945771947988, 8.323945771947988, 8.800510317704996, 8.800510317704996, 16.86014095026046, 16.86014095026046, 4.545389817286861, 4.545389817286861, 3.3457122538879167, 3.3457122538879167, 4.93590869629338, 4.93590869629338, 11.165815053303701, 11.165815053303701, 21.17082029418837, 21.17082029418837, 11.353091112222476, 11.353091112222476, 4.564785803349361, 4.564785803349361, 4.178808639019836, 4.178808639019836, 6.100508912854853, 6.100508912854853, 7.249102751719848, 7.249102751719848, 12.461810591314146, 12.461810591314146, 3.93097068842029, 3.93097068842029, 3.322237783305673, 3.322237783305673, 5.999413318956458, 5.999413318956458, 10.339236302685057, 10.339236302685057, 5.26290665078324, 5.26290665078324, 3.1958864553514355, 3.1958864553514355, 2.4451319609350732, 2.4451319609350732, 7.824890603938856, 7.824890603938856, 3.754901732550445, 3.754901732550445, 9.033373089729476, 9.033373089729476, 8.345476336046564, 8.345476336046564, 6.017877002241618, 6.017877002241618, 17.857718979759277, 17.857718979759277, 5.693374887444155, 5.693374887444155, 3.3599453674474438, 3.3599453674474438, 5.567881184501477, 5.567881184501477, 13.866601494971647, 13.866601494971647, 4.074342879925627, 4.074342879925627, 7.659282229968106, 7.659282229968106, 5.227906967992762, 5.227906967992762, 2.658151508426368, 2.658151508426368, 3.336672087894729, 3.336672087894729, 0.6879129928017834, 0.6879129928017834, 4.99772118763365, 4.99772118763365, 8.648407408550126, 8.648407408550126, 4.866859236527965, 4.866859236527965, 12.854040740921747, 12.854040740921747, 13.275090626008577, 13.275090626008577, 7.847512775205328, 7.847512775205328, 6.837724557599636, 6.837724557599636, 9.969757837920104, 9.969757837920104, 4.3468755867820725, 4.3468755867820725, 4.444818570561766, 4.444818570561766, 10.625232486963577, 10.625232486963577, 17.55433916810934, 17.55433916810934, 11.328020297828022, 11.328020297828022, 3.3055572395215536, 3.3055572395215536, 6.714502107966426, 6.714502107966426, 4.920796806553406, 4.920796806553406, 8.237435176865505, 8.237435176865505, 10.103874675573067, 10.103874675573067, 3.157485257384473, 3.157485257384473, 4.999456033213538, 4.999456033213538, 1.5097399888201073, 1.5097399888201073, 9.552797382902789, 9.552797382902789, 6.603352851620105, 6.603352851620105, 8.66593502661992, 8.66593502661992, 8.212798965730062, 8.212798965730062, 4.518580091361867, 4.518580091361867, 5.310752200288009, 5.310752200288009, 6.891638646662116, 6.891638646662116, 7.162448453693629, 7.162448453693629, 14.245958268236576, 14.245958268236576, 6.5507585171114515, 6.5507585171114515, 1.6990497837636551, 1.6990497837636551, 7.450592413864363, 7.450592413864363, 6.514538219653499, 6.514538219653499, 2.778747388512421, 2.778747388512421, 6.0905070271073045, 6.0905070271073045, 3.6132940521066192, 3.6132940521066192, 7.124480069550493, 7.124480069550493, 15.29153521547783, 15.29153521547783, 5.051176086009491, 5.051176086009491, 12.692657495270833, 12.692657495270833, 8.059268479657744, 8.059268479657744, 9.977017876735301, 9.977017876735301, 6.238329710053173, 6.238329710053173, 8.491552201320411, 8.491552201320411, 4.9662440832306975, 4.9662440832306975, 7.655651089373065, 7.655651089373065, -1.6850393390999472, -1.6850393390999472, 1.5022876599458168, 1.5022876599458168, 5.599716565703591, 5.599716565703591, 2.7305083774490067, 2.7305083774490067, 2.1060243147523727, 2.1060243147523727, 14.693698998799624, 14.693698998799624, 3.837760476623361, 3.837760476623361, 1.4532942060990373, 1.4532942060990373, 4.22675874017294, 4.22675874017294, 3.5945611281632566, 3.5945611281632566, 11.511683983031979, 11.511683983031979, 12.237893236574168, 12.237893236574168, 5.123620050279688, 5.123620050279688, 6.112484369245864, 6.112484369245864, 7.711651098608391, 7.711651098608391, 6.626217523729447, 6.626217523729447, 9.386647071459711, 9.386647071459711, 8.929152756792849, 8.929152756792849, 1.6847903294486961, 1.6847903294486961, 7.871384143649441, 7.871384143649441, 4.340834762632234, 4.340834762632234, 15.005437473485637, 15.005437473485637, 3.022578169274026, 3.022578169274026, 5.42998398405609, 5.42998398405609, 7.949091940126924, 7.949091940126924, 4.416060934313546, 4.416060934313546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2903321922415335, "mean_inference_ms": 2.188092283147484, "mean_action_processing_ms": 0.09987670576263713, "mean_env_wait_ms": 0.598108093331225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 12453.89, "sample_throughput": 271.0, "load_time_ms": 0.698, "load_throughput": 4837431.569, "learn_time_ms": 1891.33, "learn_throughput": 1784.459, "update_time_ms": 23.334}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 15.98408031463623, "policy_loss": -3.9574538823217155e-05, "vf_loss": 15.99390172958374, "vf_explained_var": -0.1177248477935791, "kl": 0.003115768385989276, "entropy": 0.9781206667423248, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.574788451194763, "policy_loss": -0.006353095662780106, "vf_loss": 6.591324090957642, "vf_explained_var": -0.02615971565246582, "kl": 0.008439070641903954, "entropy": 1.0288159132003785, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 324000, "num_steps_trained": 108000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4320, "training_iteration": 32, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-23", "timestamp": 1706105783, "time_this_iter_s": 10.980552196502686, "time_total_s": 405.02962255477905, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FFDC9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 405.02962255477905, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.92142857142857, "ram_util_percent": 74.29285714285713, "gpu_util_percent0": 0.2571428571428571, "vram_util_percent0": 0.21316964285714285}}
{"episode_reward_max": 14.455124812436358, "episode_reward_min": -15.133291053064278, "episode_reward_mean": 0.2941140686051813, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.917554927432768, "policy_agent_": -0.32475150493173494}, "policy_reward_max": {"policy_adversary_": -4.404615407306414, "policy_agent_": 21.200527813709233}, "policy_reward_mean": {"policy_adversary_": -13.282727353467925, "policy_agent_": 6.7884207110365535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.864926819566099, 4.072134594519371, -2.9973138570078106, -2.172585132797176, -5.506899221106839, -13.294698349096565, -3.147280118222178, 3.2237583007387336, 4.004681780651004, -7.2316961139313065, 3.8878008907378065, 6.030031492425838, 12.330386787493824, -9.975553414532735, -2.3206891420920917, 1.7207085563491025, -1.0116410750764802, 3.39199369371279, -2.3191556647101197, 4.253682485235501, 6.277560523457624, 0.7916229477823912, -0.4758579001331231, 11.301994967664967, 8.370559673043307, -15.133291053064278, -1.181703711375148, 9.014541302813047, 3.003071745940911, -5.30074781274947, -1.3596095035351543, 0.3163937171373154, 4.633713685216782, 0.5614727737261036, 4.763179069203367, 6.569704872533786, 14.455124812436358, -5.436055681394196, 3.566621648637184, -6.563004851176402, 1.4884241373955989, -4.168014096231508, -1.4095202131367528, 6.132590179752638, 3.769693144579641, -8.223990801870606, -4.126634276878025, -7.957477175458269, 0.2961821882298066, 6.532002328189707, -7.1303264041719885, 0.5593539080645131, -1.480084336394228, 2.0267856996841305, -4.972799201915061, -4.694948223264538, 0.8873745293082034, 2.754545133277433, -2.8365465662724008, 6.919742903227416, 4.37739933963068, -1.6976708952590944, -0.7996708237315131, -1.1296074910681102, -6.454440661510881, 2.1074356729096433, 0.8446285264435522, -4.620349755502807, 1.7311655085753113, -2.26156506100607, -0.7726938377068966, -5.991864754297538, 3.7780437067470105, 2.4509516649489727, -4.393858589238696, 1.770957098565682, 4.542112099931821, -0.43349178558066226, 2.7858023501926987, -0.3858944226826193, 3.8990258211482898, -7.834869935637251, -3.787210169278106, 4.077418629733965, 3.374415780139591, -2.8698570915161454, 0.24937045703484928, 2.5861197095008492, 1.9897392864964363, 8.98227714900688, 3.7410975607763297, 11.812187755423341, 1.494455644071854, 8.249787245721942, 3.7121588812564537, 4.2866635192326035, -0.21695670574560055, -1.5382696110180505, -3.4149245825868086, 2.9626040275934304, -2.2702600210603237, 5.62027756322456, 0.8902996352711094, 1.8921374769110186, 0.8966985403791505, -2.279657665244853, -4.230644184159803, 2.5551787150180374, -2.534204475600842, -4.944483330167268, 3.271802191861201, -8.9305860014415, 5.063297639404028, 0.3182627491527392, -6.783029424244202, -0.3924798048255125, 2.4365151843020985, 7.738571009358318, -5.032491655249287, 5.485614983925238, -1.1134059246494599, -1.7000262088166007, -5.554176974266021, -2.4240858585317695, 2.694410357917797, 0.6475160390862471, 8.114712823518524, -6.765135944399216, -5.492604857679119, -4.924905135335326, -0.11698297464524815, -0.35890665843352304, -7.246119428327853, -0.2865000918246664, -1.0860676855813851], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.563648579445577, -12.86018484657697, -10.768612611284274, -11.23695850510264, -8.666016317319755, -13.524649117838061, -6.824009690096481, -11.54067501268278, -16.088912932757125, -15.39334570972741, -14.464242678551477, -21.32812918499814, -19.931295137172953, -12.853753181352, -10.629370259334596, -10.660703795477936, -11.602113133038856, -7.778058346865547, -12.202852872417612, -11.01056220082586, -19.295726090181468, -15.267414381249935, -12.78782499528118, -20.80222476229938, -15.806704223241345, -20.898601500282062, -7.730195517269247, -15.933492311747477, -8.010622940456754, -24.781773643717834, -11.90860662307562, -9.45893880899344, -11.399402502743087, -13.073336179610301, -9.525642993922855, -16.9544802421134, -27.945930814982102, -8.074548025668863, -15.02256727355076, -15.12238616208416, -18.29140883477003, -9.41820230022525, -19.328638287276323, -16.2867979689489, -10.858449120288554, -12.103444099583976, -10.84371821904647, -18.504961520264832, -12.72219868452648, -24.77125432123833, -13.326028683429461, -10.17214027998144, -9.88716332838436, -8.173673287462966, -15.977229983256379, -8.690638887869305, -17.976197796686005, -10.995810316238536, -8.093963112928, -18.934316751252187, -11.286052579091074, -6.44660319362332, -10.018525697092327, -8.777545513521604, -5.80493765164741, -6.646112012688083, -13.346791458377794, -11.455929231070318, -11.50693368048232, -6.880433183392649, -9.59235587537034, -9.150782932607832, -14.417631893028839, -11.23016104117255, -9.694257817887431, -13.599258400403201, -13.683553703788094, -11.525776829739362, -13.274864012963793, -8.924242191526687, -13.945762532592068, -8.096691950877672, -7.241818398151685, -21.006714113561426, -15.980485543279569, -9.386946734138785, -14.413920496168844, -14.305321869677737, -21.129045207494507, -16.897222372782746, -18.711816699305935, -16.885249606767267, -10.068746854059372, -20.332295077728535, -10.945108635013504, -31.917554927432768, -15.298225233780295, -16.190566206432095, -6.4421536180897565, -16.516158567079714, -21.93669549348581, -15.045931742536958, -7.823080723423553, -10.29248182418127, -5.32532114493727, -5.147610765223042, -11.78832022729746, -20.409369151713182, -7.661722205106783, -4.404615407306414, -15.794944247447626, -13.788139959172346, -13.063268500184943, -8.402833662366167, -11.80573927600052, -18.299962788795337, -20.529922894643015, -18.222685995953057, -7.5524639177578345, -12.065658868838465, -9.112098736941823, -6.253841463052924, -18.030549813836007, -11.853259955138784, -7.875929452423742, -7.608719871931104, -18.598532361419032, -23.35192434876543, -13.855887046599685, -16.766665274006627, -21.44552676947741, -6.752663517244691, -23.61405216623341, -5.271359046405008, -6.357110665438808], "policy_policy_agent__reward": [16.714287699505842, 16.714287699505842, 8.466159720548173, 8.466159720548173, 3.8856493771382317, 3.8856493771382317, 4.53218668615273, 4.53218668615273, 1.5795585481064585, 1.5795585481064585, 0.11497538437074926, 0.11497538437074926, 1.8383647859371504, 1.8383647859371504, 7.382216656710756, 7.382216656710756, 10.046797356704063, 10.046797356704063, 4.080824797898053, 4.080824797898053, 9.17602178464464, 9.17602178464464, 13.679080338711993, 13.679080338711993, 16.130840962333387, 16.130840962333387, 1.4390998834096305, 1.4390998834096305, 4.154340558621252, 4.154340558621252, 6.190706175913519, 6.190706175913519, 5.295236028981187, 5.295236028981187, 5.585026020289168, 5.585026020289168, 4.941848603853745, 4.941848603853745, 7.632122343030683, 7.632122343030683, 12.786643306819544, 12.786643306819544, 8.02951866451616, 8.02951866451616, 6.155983547574031, 6.155983547574031, 16.052109864982175, 16.052109864982175, 12.088631948142327, 12.088631948142327, 2.882655223608888, 2.882655223608888, 3.2742459029470505, 3.2742459029470505, 12.474016807280263, 12.474016807280263, 5.506847343198833, 5.506847343198833, 9.740512915484183, 9.740512915484183, 5.274498559770231, 5.274498559770231, 4.887666263065379, 4.887666263065379, 8.016558093979935, 8.016558093979935, 6.8174044766682025, 6.8174044766682025, 7.14441103156311, 7.14441103156311, 11.762092557323596, 11.762092557323596, 21.200527813709233, 21.200527813709233, 1.319246172137333, 1.319246172137333, 9.294594461093974, 9.294594461093974, 4.2796906554538765, 4.2796906554538765, 9.88991648608281, 9.88991648608281, 2.6250941019968694, 2.6250941019968694, 8.959559037069782, 8.959559037069782, 11.209694074350768, 11.209694074350768, 7.314071132434098, 7.314071132434098, 1.9397266488566838, 1.9397266488566838, 3.3585419710842244, 3.3585419710842244, 5.273742172403278, 5.273742172403278, 6.509190436378143, 6.509190436378143, 15.651628324714025, 15.651628324714025, 3.0978511396287405, 3.0978511396287405, 5.365747094022976, 5.365747094022976, 4.203539495995065, 4.203539495995065, 5.100229493573547, 5.100229493573547, 5.50221539067066, 5.50221539067066, 1.9978453323023828, 1.9978453323023828, 9.43178616299711, 9.43178616299711, 6.8751777247579815, 6.8751777247579815, 2.6287082733278, 2.6287082733278, 12.927029827239803, 12.927029827239803, 7.831725959360876, 7.831725959360876, 2.374466149182112, 2.374466149182112, 4.6094274366804076, 4.6094274366804076, 3.8239690112267453, 3.8239690112267453, -0.32475150493173494, -0.32475150493173494, 4.376773842798864, 4.376773842798864, 7.095709992410671, 7.095709992410671, 3.4177897377837567, 3.4177897377837567, 6.619049594528816, 6.619049594528816, 2.30943406119329, 2.30943406119329, 4.4098310188317225, 4.4098310188317225, 1.5794590891551477, 1.5794590891551477, 9.097837799887925, 9.097837799887925, 6.84055635306076, 6.84055635306076, 2.650199614324368, 2.650199614324368, 7.685107749484442, 7.685107749484442, 9.11283290185996, 9.11283290185996, 5.546142522079351, 5.546142522079351, 8.030333181578246, 8.030333181578246, 4.269173884422034, 4.269173884422034, 8.922394176870176, 8.922394176870176, 0.1309110076202102, 0.1309110076202102, 1.7273041144367889, 1.7273041144367889, 12.542066371647696, 12.542066371647696, 9.677450661709578, 9.677450661709578, 3.258544821311321, 3.258544821311321, 7.331645476601846, 7.331645476601846, 8.445720789589291, 8.445720789589291, 11.55939224699547, 11.55939224699547, 12.939749760894811, 12.939749760894811, 11.226457130041137, 11.226457130041137, 14.348718681095304, 14.348718681095304, 5.781601249065611, 5.781601249065611, 14.291041161725236, 14.291041161725236, 7.328633758134978, 7.328633758134978, 18.10210922333269, 18.10210922333269, 7.5406342640173465, 7.5406342640173465, 7.326148297707023, 7.326148297707023, 1.5136145177514724, 1.5136145177514724, 9.73938129733657, 9.73938129733657, 9.833217736212747, 9.833217736212747, 10.333104652880756, 10.333104652880756, 4.35669017934733, 4.35669017934733, 6.0923096505461425, 6.0923096505461425, 3.1110098426582096, 3.1110098426582096, 1.4339765499890933, 1.4339765499890933, 3.7788380215688293, 3.7788380215688293, 11.48227393336561, 11.48227393336561, 2.5637588647529688, 2.5637588647529688, -0.26993396143042747, -0.26993396143042747, 9.533373219654408, 9.533373219654408, 2.4287769788654274, 2.4287769788654274, 9.063283069794482, 9.063283069794482, 4.360548205759452, 4.360548205759452, 2.5113549258781593, 2.5113549258781593, 8.953741491984914, 8.953741491984914, 11.483219039472555, 11.483219039472555, 12.980628502655689, 12.980628502655689, 1.2599861312542742, 1.2599861312542742, 8.775636926381853, 8.775636926381853, 3.9993464061461816, 3.9993464061461816, 2.276907627118163, 2.276907627118163, 6.2381864197849906, 6.2381864197849906, 4.714587048303506, 4.714587048303506, 5.28516990517077, 5.28516990517077, 4.128117955508676, 4.128117955508676, 13.35662259246878, 13.35662259246878, 8.293394202183112, 8.293394202183112, 4.181641094460287, 4.181641094460287, 5.920880069335648, 5.920880069335648, 10.664271897416084, 10.664271897416084, 3.196878429405583, 3.196878429405583, 8.183966368952778, 8.183966368952778, 2.4924294772901714, 2.4924294772901714, 2.635521489928713, 2.635521489928713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2890070420712959, "mean_inference_ms": 2.1778058408106875, "mean_action_processing_ms": 0.09943668479113915, "mean_env_wait_ms": 0.5958449208667066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 111375, "timesteps_this_iter": 0, "agent_timesteps_total": 334125, "timers": {"sample_time_ms": 12282.773, "sample_throughput": 274.775, "load_time_ms": 0.498, "load_throughput": 6771478.594, "learn_time_ms": 1876.879, "learn_throughput": 1798.198, "update_time_ms": 23.032}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 19.151279258728028, "policy_loss": -0.00614425428211689, "vf_loss": 19.16731243133545, "vf_explained_var": -0.09831310510635376, "kl": 0.004400692273874962, "entropy": 0.9889005601406098, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 7.173641514778137, "policy_loss": -0.009947193041443824, "vf_loss": 7.19372329711914, "vf_explained_var": -0.007740628719329834, "kl": 0.0070354507870018955, "entropy": 1.0222587525844573, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 111375, "num_agent_steps_sampled": 334125, "num_steps_trained": 111375, "num_agent_steps_trained": 334125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4455, "training_iteration": 33, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-34", "timestamp": 1706105794, "time_this_iter_s": 10.895022630691528, "time_total_s": 415.9246451854706, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E821F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 415.9246451854706, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.064285714285713, "ram_util_percent": 74.28571428571426, "gpu_util_percent0": 0.26071428571428573, "vram_util_percent0": 0.213134765625}}
{"episode_reward_max": 12.84206499269857, "episode_reward_min": -20.216608763204125, "episode_reward_mean": -0.4546585270987409, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.98266736472282, "policy_agent_": -3.6989286554267617}, "policy_reward_max": {"policy_adversary_": -3.71959550681455, "policy_agent_": 20.2601055286053}, "policy_reward_mean": {"policy_adversary_": -12.72373949299812, "policy_agent_": 6.1345404829496895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7236953970679236, -9.279110123312172, -2.845977970947855, 3.1198789951622596, -8.233498863363288, 6.604518834712671, -3.683556159220109, -1.3528892959419918, 1.036825207240076, -0.10102894736035367, 7.257878054604544, -2.828242967835731, 2.2848852201758993, 0.7123837455124192, -3.6736705524807984, 3.480821975904644, -1.324736189218919, 4.564280296859661, -4.022481854692542, 0.2058609672518252, 0.20079683180460783, 2.0177087062737704, 0.6403971360939424, -3.7567354669342112, 0.8982680281539818, 0.08561317384955558, 6.013050021475879, -4.675393076092883, -0.9801567738516404, -7.115178331092887, 4.092521172697732, 1.3346208441898553, -7.893839395009103, 3.765753410707335, -6.395297531432243, -5.311447614077228, 3.892466374576385, -2.4252612991634996, -6.453240057213791, -4.8891139767145075, 2.8161368192179337, -3.9505823220785556, -10.475814997359182, 2.263224822257468, 7.103014699988975, 0.43112157253123035, 12.84206499269857, 2.2137651147014985, -0.6525679415354578, -5.376156621618025, -20.216608763204125, -6.1808684953887205, -2.0667266093866266, 5.478260366958088, -1.708880331010857, -5.790029384615854, 8.929963126920287, -0.3776442961481217, 3.913175974243536, -3.2138753162711273, -4.263990569159628, 1.2754246802424594, -8.042704715789966, -1.8257421087219545, -9.674334687241466, 2.0068296863665225, 1.1387584034933182, -3.559496684238536, 4.17176470715113, 4.661560082960084, -6.07443514461477, 2.3471419359069587, 9.880886597305595, 5.708522984819333, -12.044204069508517, -8.381958007736356, 11.537543692487802, -4.628689528626916, -17.877801239080384, -3.2604292526328447, 1.0052311098434028, 11.515943838008807, 6.306904938183691, 5.984355524377191, -5.801710656733697, -0.8093986396195252, 11.93351994081449, -7.448904537602858, -5.16061820409477, 8.89407535277643, -4.7386211845905475, 0.3326412481765012, 1.6816351699494427, -0.4205948151793754, -6.059631039633896, -3.6094954257614305, 0.6434395437393662, -8.364672791378545, 0.5649539338294138, 8.607628302216426, 10.72282542398775, 3.6238717418697, 2.157553859270291, -7.230988651223198, 2.6499466820398694, 1.9180774520056036, -3.2192472498859783, 3.6611346083804515, -5.070235485194026, 1.0480002751318502, 4.339131824990516, 3.614100081764673, -4.318893998600564, -5.024921646096369, 6.336972790533675, 7.821017521528452, 2.474383908204124, 2.6357322188084784, -0.45845595334115785, -2.806184864237745, 11.489334038113986, -12.35795388031611, -0.8222218230238179, -0.23262586421371018, -2.689613318810114, -3.588588869825049, -1.5556387662898528, 2.036206436995222, 0.3593925135953666, -0.6722901677124178, 2.7487969072155827, -0.6450454451193817, -0.22672850779610054, -7.982741127615577, 1.5107182407088655], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.48170196434073, -8.499669697266336, -8.938451384607347, -9.797130787823418, -8.112474747993293, -25.275294691554688, -14.622604653718982, -6.457074129081354, -7.083505768616544, -14.489492857288715, -23.898533390369277, -7.634559382736898, -10.066058205862948, -8.71367522433322, -8.92283506254518, -17.26714715770636, -9.088137742675903, -15.182698261326193, -19.973172645151024, -12.285357311753224, -13.456094195233412, -11.125765192176923, -10.791900207077996, -6.874653582532867, -7.715140681177484, -9.385793801041679, -13.881093476763656, -14.744355014507862, -14.869638428792749, -12.61120402285631, -17.69894511850023, -12.639911270471043, -10.73374071123446, -11.26034202368752, -8.653655940149896, -13.509850053536947, -13.893356390128766, -17.050934408790184, -15.109861968681397, -14.842273863671656, -13.454420736648036, -7.234328059194323, -9.076759593975693, -11.874185539010082, -20.109726091687403, -8.855236291998995, -21.106571194458578, -12.675876706293174, -8.011928207883312, -3.71959550681455, -15.962510738016444, -17.122630007122424, -18.83263785150161, -13.521449148701924, -8.762863063176418, -15.127507066937032, -21.627354273721966, -13.302566241606257, -13.066105077236324, -13.35779087318155, -14.335531740398528, -10.148248075429137, -6.7188918640455535, -6.784481251277057, -5.8699841809114774, -14.590393312234792, -12.707687805648938, -12.42949433710413, -17.47633902414777, -13.250352604891381, -12.077957629371253, -6.452768642098757, -21.018196504216704, -16.18571515487125, -13.014475415643254, -7.093994572614164, -28.98266736472282, -8.258949369633457, -10.479943928226838, -9.771626909359332, -9.1121355825614, -19.306029467023407, -19.81880403609976, -14.48197398533276, -10.891779410272719, -6.171602003231756, -27.361709552590224, -12.87503777923214, -8.228585650592022, -14.102060499393172, -15.942834673308749, -7.109678936684967, -8.235835829741662, -10.702759074098235, -9.437271196186707, -8.427506326493894, -7.389462828988369, -7.736949189580002, -7.325228929367124, -21.52782680548713, -15.125835220539448, -12.90213481968604, -8.9363294109864, -15.619208652699044, -10.467852402656433, -16.60095947264941, -6.358332556986822, -13.216161571752995, -6.446772810758228, -11.465387447226865, -16.418810106137936, -17.56663522569545, -15.702617813542922, -7.889845496914564, -17.47809952182186, -13.387048688976451, -11.225254854933846, -13.259986325913825, -5.280123056578757, -7.8649663892590596, -20.777114754918113, -22.55056800228067, -7.396090102436506, -18.489158970789244, -8.277632500202722, -12.078623713103967, -10.886253021096985, -13.784919123089605, -22.204616125904835, -8.87518820504462, -17.536985684166325, -9.807524678121787, -5.528855613745253, -15.03354882740935, -16.99249125667631], "policy_policy_agent__reward": [6.879003283636402, 6.879003283636402, -0.3897202130229217, -0.3897202130229217, 3.0462367068297476, 3.0462367068297476, 6.458504891492839, 6.458504891492839, -0.06051205768499854, -0.06051205768499854, 15.939906763133674, 15.939906763133674, 5.469524247249438, 5.469524247249438, 2.5520924165696814, 2.5520924165696814, 4.060165487928311, 4.060165487928311, 7.194231954964182, 7.194231954964182, 15.57820572248691, 15.57820572248691, 2.4031582074505824, 2.4031582074505824, 6.175471713019423, 6.175471713019423, 4.713029484922822, 4.713029484922822, 2.6245822550321924, 2.6245822550321924, 10.373984566805506, 10.373984566805506, 3.8817007767284917, 3.8817007767284917, 9.873489279092933, 9.873489279092933, 7.975345395229237, 7.975345395229237, 6.245609139502524, 6.245609139502524, 6.828445513519007, 6.828445513519007, 6.571736949225348, 6.571736949225348, 5.716148671585969, 5.716148671585969, 1.5589590577993278, 1.5589590577993278, 4.306704354665733, 4.306704354665733, 4.735703487445617, 4.735703487445617, 9.947071749119768, 9.947071749119768, 5.034480969207489, 5.034480969207489, 6.944740827470554, 6.944740827470554, 2.748012845881714, 2.748012845881714, 10.895733145598983, 10.895733145598983, 6.987266057330448, 6.987266057330448, 1.4199506581126788, 1.4199506581126788, 7.513047717197427, 7.513047717197427, 1.129179204358826, 1.129179204358826, 4.09920121972986, 4.09920121972986, 8.892911382352574, 8.892911382352574, 7.312836554813338, 7.312836554813338, 4.328310955733804, 4.328310955733804, 4.976579943478578, 4.976579943478578, 8.135278777932983, 8.135278777932983, 1.6418728685578827, 1.6418728685578827, -0.6995277016917464, -0.6995277016917464, 7.068705180633777, 7.068705180633777, 13.606370395838187, 13.606370395838187, 4.643178932265115, 4.643178932265115, 16.974318093578574, 16.974318093578574, 7.444820910497338, 7.444820910497338, 3.6796801331739273, 3.6796801331739273, -0.8282805574017369, -0.8282805574017369, -2.1270490125938433, -2.1270490125938433, 5.470880755866854, 5.470880755866854, 8.382955621057492, 8.382955621057492, 9.49985475783001, 9.49985475783001, 3.526991366082781, 3.526991366082781, 4.668738841160589, 4.668738841160589, 15.278658700321134, 15.278658700321134, 6.462460972729071, 6.462460972729071, 8.48964052573993, 8.48964052573993, 5.071957778455211, 5.071957778455211, 5.03577058561945, 5.03577058561945, 5.711836377835797, 5.711836377835797, -0.6619064258722092, -0.6619064258722092, 2.4793695712775503, 2.4793695712775503, -1.9021752531649951, -1.9021752531649951, 8.298611499300657, 8.298611499300657, 6.923223104571128, 6.923223104571128, 4.4349988264327935, 4.4349988264327935, 10.824051865649452, 10.824051865649452, 8.955956343925735, 8.955956343925735, 3.0017612423782407, 3.0017612423782407, 4.3999552890028575, 4.3999552890028575, 15.449541550761152, 15.449541550761152, 10.947119069845291, 10.947119069845291, 0.48513567306736827, 0.48513567306736827, -0.6439817175610938, -0.6439817175610938, 20.2601055286053, 20.2601055286053, 1.815129920503271, 1.815129920503271, -3.6989286554267617, -3.6989286554267617, 3.2555988283632447, 3.2555988283632447, 5.058683346202403, 5.058683346202403, 15.410986652516105, 15.410986652516105, 13.062854487141724, 13.062854487141724, 10.233164754854975, 10.233164754854975, 2.54503437676951, 2.54503437676951, 2.6811016818061155, 2.6811016818061155, 19.647614746702356, 19.647614746702356, 2.713066620814641, 2.713066620814641, 1.533983723248624, 1.533983723248624, 11.4980679260848, 11.4980679260848, 5.6021067443591015, 5.6021067443591015, 3.721160092430734, 3.721160092430734, 4.95873549984555, 4.95873549984555, 5.1410821294594315, 5.1410821294594315, 1.6888200782764045, 1.6888200782764045, 2.4090054503662337, 2.4090054503662337, 4.016451186363868, 4.016451186363868, -0.3138618008992721, -0.3138618008992721, 3.945091431598269, 3.945091431598269, 15.067727553851778, 15.067727553851778, 12.924330322263602, 12.924330322263602, 8.263003280777868, 8.263003280777868, 5.546941635128347, 5.546941635128347, 4.19411000073792, 4.19411000073792, 6.55889954234815, 6.55889954234815, 9.259518462327504, 9.259518462327504, 1.5695426535504216, 1.5695426535504216, 8.438648090066724, 8.438648090066724, 0.6882686627821007, 0.6882686627821007, 6.256693861179357, 6.256693861179357, 10.378970965564227, 10.378970965564227, 10.59036765373006, 10.59036765373006, 5.6918619074711785, 5.6918619074711785, 1.4324619254090964, 1.4324619254090964, 11.90753615617777, 11.90753615617777, 10.60403310525245, 10.60403310525245, 6.8498193815689845, 6.8498193815689845, 7.9478592723611525, 7.9478592723611525, 2.4108335516187984, 2.4108335516187984, 2.5293907625106553, 2.5293907625106553, 16.133224396516045, 16.133224396516045, 5.096307060982286, 5.096307060982286, 3.2869341397063447, 3.2869341397063447, 9.128266553287768, 9.128266553287768, 2.794009590696306, 2.794009590696306, 4.245017421639457, 4.245017421639457, 4.665307127403565, 4.665307127403565, 7.9105627800424125, 7.9105627800424125, 11.282004319750097, 11.282004319750097, 4.1014490186661, 4.1014490186661, 10.142891295690955, 10.142891295690955, 4.581239616501203, 4.581239616501203, 2.651063552974577, 2.651063552974577, 3.5254038498968834, 3.5254038498968834, 9.25160474869259, 9.25160474869259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880530562249697, "mean_inference_ms": 2.168826276802959, "mean_action_processing_ms": 0.0988803572467702, "mean_env_wait_ms": 0.59354296022197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 114750, "timesteps_this_iter": 0, "agent_timesteps_total": 344250, "timers": {"sample_time_ms": 11813.118, "sample_throughput": 285.699, "load_time_ms": 0.399, "load_throughput": 8463336.123, "learn_time_ms": 1755.703, "learn_throughput": 1922.307, "update_time_ms": 21.436}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005000000000000001, "total_loss": 17.57971611022949, "policy_loss": -0.004420332791050896, "vf_loss": 17.59388656616211, "vf_explained_var": -0.10856376886367798, "kl": 0.0029222054771723014, "entropy": 0.9750383138656616, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.836541676521302, "policy_loss": 0.0015680070500820875, "vf_loss": 6.844673299789429, "vf_explained_var": 0.030630746483802797, "kl": 0.007409497529209367, "entropy": 0.9792358011007309, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 114750, "num_agent_steps_sampled": 344250, "num_steps_trained": 114750, "num_agent_steps_trained": 344250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4590, "training_iteration": 34, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-45", "timestamp": 1706105805, "time_this_iter_s": 10.923521280288696, "time_total_s": 426.8481664657593, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D93940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 426.8481664657593, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.61428571428571, "ram_util_percent": 74.27857142857142, "gpu_util_percent0": 0.2607142857142857, "vram_util_percent0": 0.213134765625}}
{"episode_reward_max": 12.949067935714487, "episode_reward_min": -16.036898071153768, "episode_reward_mean": 0.4956184950159005, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -32.51394704075722, "policy_agent_": -0.9344754855518034}, "policy_reward_max": {"policy_adversary_": -5.0662306488574425, "policy_agent_": 19.34622037688097}, "policy_reward_mean": {"policy_adversary_": -13.402143576594833, "policy_agent_": 6.948881035805368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.430162959052112, -1.043346958668962, 2.4652831056625675, 7.006333904728888, -0.3162019140132796, -1.85479129194594, -5.239350138433585, -1.2487303181953993, -0.8581436062630985, -4.025980046470354, 4.804317327826464, 2.3899752731703514, -11.467441030474347, 0.6293826855609115, 0.5785611062017483, -7.227243204091876, 0.7732949692985013, 4.008469422180638, -0.4548363743870924, 0.6445153788065257, -0.4269799170905105, -3.999854761220906, 4.001413293139132, 7.9489405533949595, -6.275843704960921, -0.8592482745177477, -7.513829209341527, 5.9308079792863975, 3.2646217205533814, 5.868462718138982, 2.5346545380439665, -2.7598733809273868, -0.6002049043964526, 6.749961751128064, -0.050877207279694525, 1.303198440143547, -4.226810742213496, -3.194680784219163, 9.75341652071004, 5.2197570159064055, -4.859732154241315, 1.1872964438115283, 9.280099747494786, 5.256436928918096, 9.611591704998524, 1.8844001136104636, 5.006273811108327, 8.241700641523337, 10.937465867096469, 0.8206554470395231, 2.187693153906968, -3.0628995298133628, 2.322967811283932, 3.4872619187187035, -1.7606316216742415, 3.038219457580443, 2.4186033466212837, -12.706942521374541, -7.079025592168407, -0.8464406167997106, 0.6017921861837525, -12.30226316127618, 7.833830738787427, 5.743217898414176, 4.179511073980288, 2.8967297879606835, -2.2547461396787454, -4.213184954275274, -4.966333276148256, -2.156589970309966, -3.2377357897807735, 10.677496892026324, 2.2113065948263637, 10.308683926555466, -1.488121050861563, 3.5542017791907186, -0.3433737072538241, 1.7989977542325941, -2.702980963576392, -0.3784843100067247, -5.6725181808739285, 2.0134470976853223, -0.03358444991035389, 1.5762575708272288, -16.036898071153768, 0.8437372959937566, -2.24404638172068, 8.457857333739112, -6.3917161213121805, -1.0631818735622507, 6.786080024361973, -3.1288609171557002, -4.445289944091555, 0.8252756339104221, 0.8877279266924542, 4.621103224020733, -4.9299475592215645, 12.949067935714487, -3.1607996709026986, 1.063233321034444, 8.459505556166432, 9.843621610703766, -4.558042849670461, -4.652678681777899, -0.16424786435835836, 7.44272691067086, 0.9324125708713302, 5.278064952537728, 9.636407031851972, 1.6001788206287446, -6.575733411261255, -12.809253445733649, 3.5785215949835423, 0.7024374606576016, 5.230966588790045, 1.4988629710323298, -2.689321096685292, 2.253661430308131, -9.808120754506826, -5.9944662689655415, 6.1784937130047135, -7.520075668454209, -2.8121453532620455, 4.194094911409495, 0.21450520911843463, 2.7952171081534667, 1.3874139142825628, -1.097927775069711, 2.780979740954333, 4.957654123932022, 4.016451069476901, -1.9551923645368892, -3.501769099080697, -2.7451433046671316, -2.0343933607816442], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.869815458572401, -8.12205796178077, -10.519579431535618, -18.01250260604028, -13.080396711194721, -13.795264355943132, -7.332050014164594, -9.066186705565762, -8.136926652404998, -16.765736899670994, -15.51977393712107, -11.60972618801034, -16.164247175123734, -12.500012980732157, -10.253537774942533, -10.50464624090485, -12.991089395806295, -16.90771724653462, -9.966651142796309, -6.329065221450313, -6.963138952089661, -10.083604765036126, -8.295335009711357, -16.059212874055177, -9.876144020451957, -7.960237837756455, -16.4210408168461, -17.46365401878326, -14.226567429445057, -18.64497906371227, -16.262208181887306, -11.930000340975734, -13.646449397819179, -13.623294518632203, -18.539699175515636, -8.05410310769412, -9.46181753498102, -11.764263928506997, -23.945944512050364, -11.291298453793374, -9.61057583716913, -12.6359091619709, -18.119820949131675, -18.908514859234245, -20.458037953760396, -19.163193690151665, -12.09814099459078, -14.232753970220301, -22.300915034557793, -6.720175399990763, -10.68291020542008, -14.200516259790543, -8.422200446224666, -15.690299725744993, -14.793937822121823, -12.957830044797388, -10.942518234276116, -14.594910316850635, -15.728993692546572, -15.638943631574017, -11.48958865995436, -11.589072280377376, -12.833969585128273, -19.431622492597665, -12.191664102223722, -11.831436992883722, -8.256503645889861, -5.356731874936225, -10.571012905454364, -11.86846956729458, -9.65772509678415, -21.944528894637692, -14.121275932526025, -20.84808252165348, -8.157605819033366, -19.65714916111095, -12.034363347232931, -8.7889829991861, -9.484592190212995, -8.09438151266939, -12.136899743663083, -10.351017095294345, -13.271888292313815, -16.596898140121098, -23.220472089917987, -8.648316879557584, -11.918158328315316, -17.4636574590911, -15.933275755640208, -18.73202507768338, -18.521667510417124, -13.507695770797989, -15.968341942036272, -11.172193307228852, -8.61750254248716, -11.850927196872313, -5.0662306488574425, -20.87210983064868, -6.728912305192755, -11.565408877743009, -17.527558313885926, -20.14170465062323, -12.945041824065022, -14.277389081574716, -13.663532550564756, -14.688345215221537, -17.679073764071205, -13.396115300958757, -20.78789621696417, -5.408431640428448, -16.768774786135857, -10.940302474630037, -11.016873852307526, -12.137497207200413, -14.859710364206071, -12.944954766591104, -18.76778933641905, -8.982677981701734, -20.021732574310995, -13.699721369018116, -32.51394704075722, -13.87603357707763, -11.870369574334163, -24.919830997051374, -13.969978894698341, -10.232819778199982, -13.099484296164265, -14.796567300951045, -9.868152039227477, -12.950531447159161, -13.937727924169005, -9.738964367041016, -7.745465168306669, -11.742177482413014, -9.15877503604348], "policy_policy_agent__reward": [2.219826249760143, 2.219826249760143, 3.539355501555904, 3.539355501555904, 6.492431268599093, 6.492431268599093, 12.509418255384583, 12.509418255384583, 6.382097398590719, 6.382097398590719, 5.970236531998599, 5.970236531998599, 1.0463499378655041, 1.0463499378655041, 3.9087281936851817, 3.9087281936851817, 3.6393915230709504, 3.6393915230709504, 6.36987842660032, 6.36987842660032, 10.162045632473765, 10.162045632473765, 6.999850730590343, 6.999850730590343, 2.348403072324691, 2.348403072324691, 6.564697833146534, 6.564697833146534, 5.4160494405721415, 5.4160494405721415, 1.6387015184064855, 1.6387015184064855, 6.882192182552399, 6.882192182552399, 10.458093334357626, 10.458093334357626, 4.755907384204607, 4.755907384204607, 3.4867903001284195, 3.4867903001284195, 3.268079517499575, 3.268079517499575, 3.0418750019076093, 3.0418750019076093, 6.148374151425246, 6.148374151425246, 12.00407671372507, 12.00407671372507, 1.8001501577455195, 1.8001501577455195, 3.5504947816193546, 3.5504947816193546, 4.453605803752286, 4.453605803752286, 11.69723099903483, 11.69723099903483, 8.745594574999219, 8.745594574999219, 12.256720890925624, 12.256720890925624, 9.398431359965636, 9.398431359965636, 4.585063480024175, 4.585063480024175, 6.523122246711361, 6.523122246711361, 10.186628134880134, 10.186628134880134, 9.244410984117973, 9.244410984117973, 4.678650773918833, 4.678650773918833, 2.617503396383762, 2.617503396383762, 4.284791572143917, 4.284791572143917, 16.849680516380204, 16.849680516380204, 8.25552773484989, 8.25552773484989, 2.3754218414639086, 2.3754218414639086, 6.911602802891213, 6.911602802891213, 13.699960348313228, 13.699960348313228, 12.082475894076168, 12.082475894076168, 15.034814829379457, 15.034814829379457, 10.523796901881061, 10.523796901881061, 8.552207402849554, 8.552207402849554, 11.23722730587182, 11.23722730587182, 16.61919045082713, 16.61919045082713, 3.7704154235151437, 3.7704154235151437, 6.4353016796635245, 6.4353016796635245, 5.568808364988589, 5.568808364988589, 5.372584128754296, 5.372584128754296, 9.588780822231849, 9.588780822231849, 6.51665310022379, 6.51665310022379, 7.998024751188914, 7.998024751188914, 6.680560790448697, 6.680560790448697, 0.9439838977380445, 0.9439838977380445, 4.324984050189082, 4.324984050189082, 7.396251507387152, 7.396251507387152, 6.0456904230690585, 6.0456904230690585, -0.35659544044940344, -0.35659544044940344, 10.333900161957846, 10.333900161957846, 12.587420195505924, 12.587420195505924, 8.185587588102004, 8.185587588102004, 7.364083390422202, 7.364083390422202, 3.000878753105557, 3.000878753105557, 0.5717734603304757, 0.5717734603304757, 2.802339814653054, 2.802339814653054, 4.855939798492307, 4.855939798492307, 3.2099946535016874, 3.2099946535016874, 16.31101289333201, 16.31101289333201, 8.166291263676191, 8.166291263676191, 15.578383224104472, 15.578383224104472, 3.3347423840859016, 3.3347423840859016, 11.605675470150837, 11.605675470150837, 5.845494819989556, 5.845494819989556, 5.293990376709348, 5.293990376709348, 3.390805613318302, 3.390805613318302, 3.857948601331333, 3.857948601331333, 3.232190781394575, 3.232190781394575, 6.182232096489833, 6.182232096489833, 6.619151921201732, 6.619151921201732, 9.086577855474165, 9.086577855474165, 3.591787009382113, 3.591787009382113, 4.746027087775672, 4.746027087775672, 4.8370559732973195, 4.8370559732973195, 12.960757396415103, 12.960757396415103, 4.770779817164013, 4.770779817164013, 8.834421602060566, 8.834421602060566, 12.653873767389547, 12.653873767389547, 5.189417426821143, 5.189417426821143, 5.761525998972356, 5.761525998972356, 5.99873447056964, 5.99873447056964, 4.752615234589806, 4.752615234589806, 8.236015210446524, 8.236015210446524, 0.06814154481793784, 0.06814154481793784, 16.91058888318158, 16.91058888318158, 1.7840563171450279, 1.7840563171450279, 6.314321099388727, 6.314321099388727, 12.99353193502618, 12.99353193502618, 14.992663130663495, 14.992663130663495, 4.193499487197281, 4.193499487197281, 4.812355199898408, 4.812355199898408, 6.749642343103197, 6.749642343103197, 11.065536062946205, 11.065536062946205, 9.305743167471267, 9.305743167471267, 9.337090126748238, 9.337090126748238, 15.21215162440807, 15.21215162440807, 3.5043052305285967, 3.5043052305285967, 5.096520687437304, 5.096520687437304, -0.9344754855518034, -0.9344754855518034, 7.297697723645536, 7.297697723645536, 6.419967333929009, 6.419967333929009, 10.045338476498062, 10.045338476498062, 7.2219088688117195, 7.2219088688117195, 8.039234119866881, 8.039234119866881, 5.618169706004934, 5.618169706004934, 5.106805909902088, 5.106805909902088, 3.8526275500262868, 3.8526275500262868, 19.34622037688097, 19.34622037688097, 3.1779789543117105, 3.1779789543117105, 4.529112110536058, 4.529112110536058, 14.556962954230437, 14.556962954230437, 7.092242051908387, 7.092242051908387, 6.514018443176725, 6.514018443176725, 7.243449105223412, 7.243449105223412, 6.849319762940667, 6.849319762940667, 6.324565890090902, 6.324565890090902, 8.954092785545598, 8.954092785545598, 8.977089496822952, 8.977089496822952, 3.891886001252067, 3.891886001252067, 2.121848034612986, 2.121848034612986, 4.498517088872943, 4.498517088872943, 3.5621908376309186, 3.5621908376309186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2871717697803071, "mean_inference_ms": 2.160906862324172, "mean_action_processing_ms": 0.09850409491589682, "mean_env_wait_ms": 0.5914295989348541, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 118125, "timesteps_this_iter": 0, "agent_timesteps_total": 354375, "timers": {"sample_time_ms": 11512.543, "sample_throughput": 293.159, "load_time_ms": 0.299, "load_throughput": 11289397.879, "learn_time_ms": 1735.756, "learn_throughput": 1944.397, "update_time_ms": 21.533}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 18.67472858428955, "policy_loss": 0.01005666102282703, "vf_loss": 18.674104309082033, "vf_explained_var": -0.09427180290222167, "kl": 0.004174137936872874, "entropy": 0.9432076156139374, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 7.001997542381287, "policy_loss": -0.016319339624897112, "vf_loss": 7.028112244606018, "vf_explained_var": 0.03204702734947205, "kl": 0.00560755890314017, "entropy": 0.9865342020988465, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 118125, "num_agent_steps_sampled": 354375, "num_steps_trained": 118125, "num_agent_steps_trained": 354375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4725, "training_iteration": 35, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-16-56", "timestamp": 1706105816, "time_this_iter_s": 11.005611658096313, "time_total_s": 437.8537781238556, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5ED7C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 437.8537781238556, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.0, "ram_util_percent": 74.30714285714284, "gpu_util_percent0": 0.2599999999999999, "vram_util_percent0": 0.213134765625}}
{"episode_reward_max": 15.983982626668258, "episode_reward_min": -19.38336317521834, "episode_reward_mean": -0.4614276245347802, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.870026455495115, "policy_agent_": -1.8058545089042795}, "policy_reward_max": {"policy_adversary_": -5.069635427234673, "policy_agent_": 20.704886268227792}, "policy_reward_mean": {"policy_adversary_": -13.006972929595825, "policy_agent_": 6.272772652530522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9753030688115669, 5.149751967741159, 4.8067634512089805, -2.630162694621709, -0.7193524236545353, -1.7262883827077493, -2.5801182887587424, -0.9508216381900836, 2.8644835642543724, 2.167539523559833, 1.9750501594886887, -0.027563316209304523, -1.7335191043191442, 5.254112455481635, -0.15500963650666133, -1.8266747635181722, 3.157572758638604, -6.574806211148565, -5.690071140066466, 1.091142833639385, 4.962640919184068, -17.196505361708255, -10.97169655988793, -1.1615183475214321, 5.54650934626232, 3.9765054184357336, -2.0073857621441418, 4.655837666974947, 3.724290279769684, -3.7456991909058295, 2.0843092426200647, 15.983982626668258, 1.795922805255218, -2.9043367819465478, -3.1542085271265634, 5.297848825558656, -1.5634877169005725, 0.03043535347090498, 0.42090359667656396, -0.7970472782959432, 2.2342993379617746, 1.2574853226963507, 1.5317645337232428, 3.342810194145709, 1.807223557718288, -2.8374442992036064, -3.5351950204956046, -4.453229704296054, 1.479436062404708, 1.8916075289124006, -6.030518441986983, -1.6178904799092102, -2.923575305110382, -0.9007270963768761, -1.2351315239027791, -4.680195309412772, 4.58110578367875, -4.9446446054981, 3.1350713904319014, -1.0435195101544394, 0.9313600587986149, 3.0324589432774713, -1.1631553397835868, 12.539746080960466, 7.196312623922535, 1.752735954279665, -0.42337910586511396, -11.501162484255966, -19.093415643906543, 1.4793164601251545, 8.484238302966725, -2.529840597190282, -0.455970237944781, 6.5870185701567925, -3.257755528744092, 4.79657623331547, -0.2762058833966036, 0.3885407521007338, -0.7527450980778416, -7.656116905099129, 1.319466591800414, -2.6793802878468567, 6.0814107271383655, -13.355174122906972, 2.154981821735555, -1.0192492173677197, 2.8088240344687967, 3.2422980518689606, -2.1906358045031795, -2.3060166887586493, -1.8428748831755024, -1.9798442183645188, 0.48808574702541474, -1.580085101867902, -11.605673046515312, -3.850828774916577, -0.8387420265468701, -6.76660426055245, -1.0681984036059577, 5.388681781867168, -8.420796815488751, 2.621125326602444, -2.1678385397071556, 2.5273121724982004, 8.20225251378443, 4.898164792053975, -9.926903734965123, -19.38336317521834, -2.2274615874019394, 0.48104740916643585, -4.180860882543132, 1.9359630086138997, 12.304903007990427, -10.343396899800213, -1.0066025832744008, -0.19044017072319583, 0.16586544651980925, 4.438307760858436, 3.6204162920676355, -1.3503783864062708, 8.60273384523845, -2.7571739019852015, -3.4433025627490563, -3.322900753657417, 2.0845724761527564, -0.8757541671929749, -6.0099879234539815, -1.5964393457612758, 4.605995090508838, -11.031559513742634, 7.9490109685043775, -1.014038961891495, -1.158359265619115, 4.365068748075167, -4.079667089130337], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.086988943489809, -12.434023227478987, -24.836087810349852, -13.993628546907265, -13.656265307838591, -8.878090662568388, -9.869633351332798, -5.683634664400009, -15.938326159150197, -11.633367345094547, -18.010293286581952, -18.51212582979333, -14.215416992208178, -14.049509938873928, -7.902808600755852, -9.74767240567926, -16.81494542104087, -14.325461004569233, -11.989552875709473, -13.948314490538666, -18.512752198996857, -15.716477752555665, -14.86945659700204, -11.920856447760414, -11.526725489991374, -10.907766341055003, -11.975135692003722, -12.937325358984099, -8.819877314685971, -9.589649683163934, -28.737569725018847, -23.588258490073695, -14.725051434570538, -18.116061531955804, -10.210572175943692, -16.745712177831127, -11.338826611465036, -9.89037929268433, -15.458792540574857, -15.805107585367717, -14.397400679540969, -22.191288564368914, -18.08539202864871, -9.808644351575868, -10.647696968501842, -8.531109411377697, -14.807646243391233, -8.090240559585377, -7.410841887437351, -11.17777072842464, -5.937928153786373, -7.762767420101566, -11.79860078315021, -12.175384187332233, -11.513513144672583, -10.375125768642276, -8.683135622714428, -12.790767454706609, -11.560013012832663, -19.77731678661821, -13.870218206816693, -10.069066010246898, -11.686514078801498, -28.870026455495115, -16.55532379291802, -13.90178572795735, -15.070098233601698, -9.227762289080317, -18.657257710118976, -9.664849644046168, -17.93716793770175, -6.5065292654993145, -9.75952476986707, -15.595364916646673, -5.898584258744571, -15.277522090628006, -12.385871956326156, -9.506843914192649, -13.017348885115835, -9.211743267529242, -11.410040448900485, -10.92765024651323, -14.624703183231968, -18.864196729726988, -14.340017187382475, -6.940384830432622, -8.763888952857798, -20.79093388738794, -7.481492949458127, -9.912299985048847, -11.614476438635064, -11.677352509133406, -6.265355956125494, -15.344767392156214, -16.150350060357965, -8.743950604448498, -10.021095099215751, -13.425635937000967, -10.300340317649047, -12.05917269171512, -8.984860643773555, -18.573756549111987, -6.299961656926918, -15.194789604029559, -18.056707371542977, -15.744124368992273, -6.3151947171565626, -17.58856786600275, -13.575175163817395, -8.478438745079286, -5.069635427234673, -11.034523273671601, -19.865383065948315, -11.465149071064578, -10.145645743628691, -8.515366946316576, -15.557808155142656, -14.410866349481337, -8.78491453893298, -8.63355904987923, -23.788800973570908, -6.970260987136891, -17.58016249499008, -8.7967416191352, -19.669577276800908, -11.499948054253021, -6.956260380764388, -11.314170812892751, -10.672932703775226, -25.326852041193174, -16.220429575056425, -6.635046467880392, -16.785840235105198, -15.566838833452334, -14.094460849527712], "policy_policy_agent__reward": [6.555842937339124, 6.555842937339124, 8.79188759761007, 8.79188759761007, 14.82142563077942, 14.82142563077942, 5.681732926142777, 5.681732926142777, 6.468456442092028, 6.468456442092028, 3.5759011399303198, 3.5759011399303198, 3.6447575312870284, 3.6447575312870284, 2.366406513104963, 2.366406513104963, 9.401404861702288, 9.401404861702288, 6.900453434327191, 6.900453434327191, 9.992671723035322, 9.992671723035322, 9.242281256792014, 9.242281256792014, 6.240948943944517, 6.240948943944517, 9.65181119717778, 9.65181119717778, 3.873899482124595, 3.873899482124595, 3.9604988210805434, 3.9604988210805434, 9.986259089839734, 9.986259089839734, 3.875327396710334, 3.875327396710334, 3.1497408678215013, 3.1497408678215013, 7.519728662089024, 7.519728662089024, 11.737696559090463, 11.737696559090463, -0.7400138045762998, -0.7400138045762998, 1.9488800185570516, 1.9488800185570516, 5.379669050119489, 5.379669050119489, 8.536617418126847, 8.536617418126847, 7.4421358797453685, 7.4421358797453685, 4.98387496492979, 4.98387496492979, 8.796581512979525, 8.796581512979525, 6.272083797227827, 6.272083797227827, 2.9219752461290525, 2.9219752461290525, 15.410939483819455, 15.410939483819455, 19.786120558370982, 19.786120558370982, 8.26048711991288, 8.26048711991288, 7.605862375004626, 7.605862375004626, 3.528181824408566, 3.528181824408566, 11.021780501694895, 11.021780501694895, 4.887669447282232, 4.887669447282232, 4.960407323077616, 4.960407323077616, 7.939848068625713, 7.939848068625713, 7.5040301535358855, 7.5040301535358855, 8.315850008751372, 8.315850008751372, 11.724386943532634, 11.724386943532634, 9.808578281185978, 9.808578281185978, 6.575727272860788, 6.575727272860788, 6.227460263110062, 6.227460263110062, 2.8468325560870467, 2.8468325560870467, 5.636225611447815, 5.636225611447815, 1.8185054276446633, 1.8185054276446633, 4.445138974921028, 4.445138974921028, 6.534689128668521, 6.534689128668521, -0.04629514410030344, -0.04629514410030344, 3.0724384700961793, 3.0724384700961793, 4.437512739019914, 4.437512739019914, 5.637328545477677, 5.637328545477677, 5.139190810384902, 5.139190810384902, 2.8474652296147505, 2.8474652296147505, 6.632120703196591, 6.632120703196591, 3.9230614246042563, 3.9230614246042563, 7.3475422016322804, 7.3475422016322804, 9.366898638231884, 9.366898638231884, 7.400789132807654, 7.400789132807654, 6.550762476762184, 6.550762476762184, 5.261679369508954, 5.261679369508954, 20.704886268227792, 20.704886268227792, 11.87581820842028, 11.87581820842028, 7.827260841118508, 7.827260841118508, 7.323359563868291, 7.323359563868291, -1.1367000975878248, -1.1367000975878248, -0.21807896689379194, -0.21807896689379194, 5.572083052085663, 5.572083052085663, 13.210703120334237, 13.210703120334237, 1.9883443341545155, 1.9883443341545155, 4.651777265961145, 4.651777265961145, 11.091191743401733, 11.091191743401733, 1.3204143650002396, 1.3204143650002396, 10.037049161971737, 10.037049161971737, 6.0548330364647756, 6.0548330364647756, 4.947692333146689, 4.947692333146689, 6.132301893518994, 6.132301893518994, 0.7778131812150548, 0.7778131812150548, 6.364753520350445, 6.364753520350445, 4.1241349793331885, 4.1241349793331885, 10.353056955185165, 10.353056955185165, 2.7545113034100037, 2.7545113034100037, 8.247499504559016, 8.247499504559016, 2.96056780653245, 2.96056780653245, 5.7863564936632965, 5.7863564936632965, 12.016615969628452, 12.016615969628452, 2.645428572477474, 2.645428572477474, 3.8031416481450986, 3.8031416481450986, 4.885800777729781, 4.885800777729781, 4.848754145384443, 4.848754145384443, 3.376720851575455, 3.376720851575455, 6.882341145144157, 6.882341145144157, 2.2723385069213284, 2.2723385069213284, 2.4465609147659615, 2.4465609147659615, 4.591176536334439, 4.591176536334439, 3.3295158382242613, 3.3295158382242613, 4.616070957021546, 4.616070957021546, 8.723927236791141, 8.723927236791141, 0.2820319141424036, 0.2820319141424036, 10.597440937857211, 10.597440937857211, 2.066061558609881, 2.066061558609881, 8.861050888263879, 8.861050888263879, 13.129479942663705, 13.129479942663705, 10.321144580523127, 10.321144580523127, -1.8058545089042795, -1.8058545089042795, -0.8973976546077898, -0.8973976546077898, 5.673856788207729, 5.673856788207729, 4.479743077122861, 4.479743077122861, 0.44438727234577063, 0.44438727234577063, 6.48524314114275, 6.48524314114275, 16.085143036969374, 16.085143036969374, 0.5608760856321806, 0.5608760856321806, 4.569521580177146, 4.569521580177146, 4.16246338779669, 4.16246338779669, 7.861836800831233, 7.861836800831233, 9.424587055169884, 9.424587055169884, 6.202665415500306, 6.202665415500306, 3.6415903317364777, 3.6415903317364777, 16.195767409404674, 16.195767409404674, 2.106543542575844, 2.106543542575844, 7.06842996612051, 7.06842996612051, 2.7369204327388905, 2.7369204327388905, 10.87707487647683, 10.87707487647683, 5.312096943530021, 5.312096943530021, 0.47313622865520355, 0.47313622865520355, 4.8588657335657395, 4.8588657335657395, 7.639463897142032, 7.639463897142032, 7.147646263725266, 7.147646263725266, 12.084720271780403, 12.084720271780403, 2.8105037529944483, 2.8105037529944483, 7.813740484743043, 7.813740484743043, 9.965953790763749, 9.965953790763749, 5.007396880198686, 5.007396880198686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28701988142168466, "mean_inference_ms": 2.1552463405414395, "mean_action_processing_ms": 0.09803340143237124, "mean_env_wait_ms": 0.5897741823433673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 121500, "timesteps_this_iter": 0, "agent_timesteps_total": 364500, "timers": {"sample_time_ms": 11513.558, "sample_throughput": 293.133, "load_time_ms": 0.399, "load_throughput": 8464348.242, "learn_time_ms": 1724.384, "learn_throughput": 1957.221, "update_time_ms": 21.539}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 17.050571632385253, "policy_loss": -0.02406467031687498, "vf_loss": 17.084171104431153, "vf_explained_var": -0.07065300941467285, "kl": 0.002840475639521056, "entropy": 0.9534738421440124, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.220895671844483, "policy_loss": 0.011234279349446296, "vf_loss": 6.219064736366272, "vf_explained_var": 0.07533179521560669, "kl": 0.004290944533911728, "entropy": 0.945681169629097, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 121500, "num_agent_steps_sampled": 364500, "num_steps_trained": 121500, "num_agent_steps_trained": 364500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4860, "training_iteration": 36, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-17-08", "timestamp": 1706105828, "time_this_iter_s": 11.389502763748169, "time_total_s": 449.24328088760376, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E083A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 449.24328088760376, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.446666666666662, "ram_util_percent": 74.3, "gpu_util_percent0": 0.22266666666666662, "vram_util_percent0": 0.21033528645833333}}
{"episode_reward_max": 15.567880763418732, "episode_reward_min": -18.555903242669203, "episode_reward_mean": 0.3583044874024283, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.859971371684825, "policy_agent_": -5.128307411767425}, "policy_reward_max": {"policy_adversary_": -4.630702064584376, "policy_agent_": 19.79308208621626}, "policy_reward_mean": {"policy_adversary_": -12.683555369655803, "policy_agent_": 6.520929928529116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6335891616609075, 2.137530723503662, -7.674111814621061, -2.6508764849422266, -2.62344565166213, -2.6904219902064272, 0.7474434454242755, 0.10830816341108851, -0.5350060209416971, 0.14582840708199715, 1.2430844772202676, 2.4551518121680846, 5.230599771534319, -7.2825692341426365, 3.5327133816386906, -3.56873612024408, -3.836973444342327, 8.435672132612973, 7.022443124650966, 5.838092597681837, 4.311019107030392, 4.953419097093217, -2.390518204793411, -11.023875557796622, 2.748770280537959, -4.93211794064137, 9.045127696170415, 3.792076588641662, 4.6614931169514335, 3.4363121946712796, 4.096548702035395, 4.924675782119759, 2.3860209049190186, -2.871712549213107, 6.275841117865256, -1.6514738637194046, -0.220678606909442, 2.8217391173962, 7.0245493203643194, -7.242997941025915, 0.5117616231676327, 1.2955434639703904, 6.54961049842027, -0.07607211377273682, 2.4119636386204166, -4.606625320446229, -14.261613608397148, 14.330233640937756, -2.738101267489132, -3.235531298056105, -2.837903578310362, 0.26394292208130626, -10.109844198355741, 3.0663653133642925, 2.115261049077658, -2.6882970348740756, 0.19450305573219295, -4.191916322301721, 1.9578261653202143, -3.2761242594442277, -1.3859292060104642, -5.895049173550879, 0.3579187794792316, 11.91555089661729, 5.107561592185947, -0.7647058508290339, 11.062491009581635, 10.533514904696371, -0.4826437243375406, -0.8809633568421182, -5.600503943736673, -6.526286823738646, 0.05467066392819203, 15.567880763418732, -9.190326889769745, -5.411635628175809, -11.522302780221795, -0.9620522825226986, 4.225576259955971, -1.4465379626754382, -5.781223791268239, -5.290795304163669, -0.958099590938279, 6.002748211477987, -2.09541093563886, 6.461551356775484, -3.745933784741764, 8.6977816995589, 7.318379625439105, 9.326320647477427, 8.660105351395789, 1.5462743911655772, 0.5660701323984199, -0.4221975995257037, 4.602084995856313, -2.701626320543872, 2.8566739221128477, -18.555903242669203, -7.040469099657827, -1.7198642316985495, -6.813458017771618, -1.4524844418168446, 9.959494263518867, 5.50790136256731, 6.1988175946048445, 0.39355173959071965, 4.664523660552996, 0.7255764373148021, 2.4343081116880456, 2.565519839326275, 2.8960365365615237, 2.7329755874165844, 3.7113483653238166, -3.0571202825321313, -1.5463143898268557, -3.534024627587236, -2.2563673419439274, -7.076712378674402, 0.27942501164923633, -2.50625229385581, -11.06809066485587, 2.4950589105353824, 0.6392679547963078, -1.7797999535996174, -4.62296019417429, 5.796457344672519, -7.152403542938602, 8.589030166947323, 5.263350219343439, 1.1953123146857387, 0.7085950241219581, -3.8811664265141532, 1.1366383674765366, 1.9898479379501826, -1.467808920595996], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.800857865493159, -19.95757868143075, -6.75438249911437, -11.402607733275646, -5.566887687371444, -6.934166408358738, -10.414543454475652, -12.517204320417921, -10.283460374293576, -12.832262310894247, -13.514439922238898, -11.66926762203722, -17.23693350785756, -8.159301595844298, -9.966344638755391, -9.716854376927358, -15.506335957749211, -13.969385147022026, -20.445713849208527, -12.101567765101795, -12.296161829629911, -14.806234377957281, -19.652012549848738, -8.308494961062218, -16.94546762023642, -15.702200763523368, -19.098073124002152, -13.173119342392472, -19.23206309173839, -11.654797430237268, -14.981203128798192, -10.891225789327773, -19.311132011178472, -8.570012568127577, -14.088081248786434, -9.693830665371724, -15.722979155235073, -8.659357861373136, -19.64769312203837, -9.75052300810488, -8.484060374215327, -10.480588578940585, -15.67273348011849, -5.735777322435642, -12.19121793010556, -18.122309785221205, -11.39089458172436, -22.212967581889398, -9.748703748242509, -7.36601014535616, -6.489004064081029, -8.388266641785478, -7.39127445081139, -15.025415080742913, -10.07465214767374, -15.063096101650352, -7.909386256712933, -9.6577851169616, -13.943951550560199, -12.218568390529613, -16.010972847692962, -4.630702064584376, -7.490991289522808, -23.302639551147557, -14.70856887940291, -7.989530440523809, -15.198775162668948, -19.74604228774629, -7.54073908480659, -12.70711823833136, -7.125691871760063, -11.817345558634239, -5.3361519706537575, -24.018283409013804, -14.31224233293309, -10.705253905032516, -6.949778079191035, -10.757071693840865, -16.014153285735663, -8.699643272817246, -13.49943810925827, -14.023014127391011, -5.408985041564299, -12.53219890689626, -10.621600843290793, -21.030831999627335, -13.763001720249177, -16.96503307662713, -14.786179752285145, -26.859971371684825, -17.310667377008077, -11.519511810163822, -9.599230418071187, -10.563220646884696, -13.839304798662848, -6.952599386272807, -14.579072483541735, -8.299288419134335, -16.357555070760533, -8.509859410307019, -5.731478003453708, -8.743798362444762, -20.016562782667386, -14.937019790566184, -12.939870796205225, -7.249886004287816, -15.115054878843944, -10.400684065371285, -15.16399760848872, -11.048211991712034, -15.970003755672582, -21.097995165299647, -19.767486403933084, -6.557205538801148, -9.258054698139524, -9.712311160311515, -12.96464745057835, -17.78473584561632, -6.9169095723699305, -10.065368710088427, -12.349267092467219, -15.812336518027465, -13.166311349372203, -9.021426365006548, -7.990315694841188, -13.441879599599813, -8.943169321826966, -16.004749100172297, -13.881155229304177, -15.51273521276411, -12.988116447697589, -23.8031148189015, -14.819290921427008, -9.985477780222281, -6.535664174734313], "policy_policy_agent__reward": [7.583634351916125, 7.583634351916125, 11.047554702467203, 11.047554702467203, -0.4598646577533457, -0.4598646577533457, 4.37586562416671, 4.37586562416671, 1.4717210178546565, 1.4717210178546565, 2.1218722090761557, 2.1218722090761557, 5.580993449949964, 5.580993449949964, 6.312756241914506, 6.312756241914506, 4.874227176675938, 4.874227176675938, 6.4890453589881245, 6.4890453589881245, 7.378762199729583, 7.378762199729583, 7.062209717102651, 7.062209717102651, 11.233766639695938, 11.233766639695938, 0.43836618085082685, 0.43836618085082685, 6.749529010197041, 6.749529010197041, 3.0740591283416387, 3.0740591283416387, 5.834681256703444, 5.834681256703444, 11.202528639817496, 11.202528639817496, 13.73407848692975, 13.73407848692975, 8.969830181391814, 8.969830181391814, 8.30359046833015, 8.30359046833015, 9.879826737525248, 9.879826737525248, 8.630747172527661, 8.630747172527661, -1.3576902983672052, -1.3576902983672052, 9.847118950387186, 9.847118950387186, 5.385041411440996, 5.385041411440996, 14.07160041008628, 14.07160041008628, 8.482597965517066, 8.482597965517066, 11.946778104344908, 11.946778104344908, 7.545554812454275, 7.545554812454275, 9.538875915416792, 9.538875915416792, 7.907950785723768, 7.907950785723768, 10.848576458048747, 10.848576458048747, 2.8491500094572335, 2.8491500094572335, 10.181961183325845, 10.181961183325845, 4.02117840082616, 4.02117840082616, 7.751150274162816, 7.751150274162816, 5.740548489384668, 5.740548489384668, 13.336121221201346, 13.336121221201346, 1.2537625335394862, 1.2537625335394862, 4.497910998691479, 4.497910998691479, 5.888066021455487, 5.888066021455487, 11.111171989269382, 11.111171989269382, 2.829852604331453, 2.829852604331453, 7.30159078436299, 7.30159078436299, 6.757842232387489, 6.757842232387489, -1.4353595133363917, -1.4353595133363917, 18.271600611413582, 18.271600611413582, 3.505301240376688, 3.505301240376688, 2.0652394236500267, 2.0652394236500267, 1.8255502428853332, 1.8255502428853332, 4.326104781933393, 4.326104781933393, -1.3592848737721777, -1.3592848737721777, 9.045890197053602, 9.045890197053602, 6.094956598375698, 6.094956598375698, 6.187399533388138, 6.187399533388138, 4.051944656222562, 4.051944656222562, 2.732934397329938, 2.732934397329938, 7.950888857940204, 7.950888857940204, 4.471222065542693, 4.471222065542693, 7.312521820841251, 7.312521820841251, -0.632173554483254, -0.632173554483254, 3.9244550345010194, 3.9244550345010194, 17.609095223882424, 17.609095223882424, 9.908065235794428, 9.908065235794428, 3.6124122948473887, 3.6124122948473887, 13.130633086125291, 13.130633086125291, 15.139778596221328, 15.139778596221328, 3.5290476802345254, 3.5290476802345254, 5.913077440744621, 5.913077440744621, 0.7625939640116962, 0.7625939640116962, 2.6455293674477938, 2.6455293674477938, 2.6954113172909744, 2.6954113172909744, 19.79308208621626, 19.79308208621626, 2.560957721581673, 2.560957721581673, 2.646809138428355, 2.646809138428355, -2.2862623505153823, -2.2862623505153823, 4.897509705659082, 4.897509705659082, 10.119864772845816, 10.119864772845816, 3.6265526550709053, 3.6265526550709053, 3.859107158995015, 3.859107158995015, 4.366109411613671, 4.366109411613671, 2.2254427253130102, 2.2254427253130102, 9.267473559187126, 9.267473559187126, 4.263094953825965, 4.263094953825965, 13.746191678201411, 13.746191678201411, 5.008533967753704, 5.008533967753704, 12.83140738809301, 12.83140738809301, 11.052279688862122, 11.052279688862122, 18.09314600958113, 18.09314600958113, 12.985386364201933, 12.985386364201933, 6.532893100664699, 6.532893100664699, 5.082650275234804, 5.082650275234804, 5.070511523679496, 5.070511523679496, 9.22069489725958, 9.22069489725958, 2.125486532864468, 2.125486532864468, 8.717873202827288, 8.717873202827288, -5.128307411767425, -5.128307411767425, 4.658542985551357, 4.658542985551357, 3.3949975893042352, 3.3949975893042352, -0.5409900071589563, -0.5409900071589563, 3.645656960313959, 3.645656960313959, 14.988028523093126, 14.988028523093126, 10.222460576566746, 10.222460576566746, 9.569344195405035, 9.569344195405035, 3.8217188719392694, 3.8217188719392694, 9.889789269698472, 9.889789269698472, 5.563130251343041, 5.563130251343041, 8.79915286008838, 8.79915286008838, 6.806865915519152, 6.806865915519152, 9.433020146117055, 9.433020146117055, 11.915485376358118, 11.915485376358118, 11.739417384628451, 11.739417384628451, 1.750042628134508, 1.750042628134508, 3.855870154156337, 3.855870154156337, 3.0891432663621394, 3.0891432663621394, 5.354140054317212, 5.354140054317212, 5.354011733470961, 5.354011733470961, 3.598167292009583, 3.598167292009583, 3.779558208116309, 3.779558208116309, 0.6405882138056745, 0.6405882138056745, 9.15369771428143, 9.15369771428143, 6.902789652084256, 6.902789652084256, 3.6208132057034668, 3.6208132057034668, 1.6836777503334475, 1.6836777503334475, 9.619168472136169, 9.619168472136169, 0.895382889444182, 0.895382889444182, 12.296889633559811, 12.296889633559811, 9.572252724323807, 9.572252724323807, 8.354023763724927, 8.354023763724927, 6.848355735909771, 6.848355735909771, 9.960974196193668, 9.960974196193668, 7.977964644451771, 7.977964644451771, 5.987662859086232, 5.987662859086232, 2.533927627069157, 2.533927627069157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28735796343237485, "mean_inference_ms": 2.1583877914571423, "mean_action_processing_ms": 0.09823094217359003, "mean_env_wait_ms": 0.5906003671034404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 124875, "timesteps_this_iter": 0, "agent_timesteps_total": 374625, "timers": {"sample_time_ms": 11610.695, "sample_throughput": 290.68, "load_time_ms": 0.296, "load_throughput": 11389312.093, "learn_time_ms": 1687.493, "learn_throughput": 2000.009, "update_time_ms": 19.345}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 17.43744010925293, "policy_loss": -0.01363393636420369, "vf_loss": 17.46073627471924, "vf_explained_var": -0.12918936014175414, "kl": 0.00511716563863758, "entropy": 0.9662571012973785, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 6.965477061271668, "policy_loss": 0.010023064352571965, "vf_loss": 6.9650826215744015, "vf_explained_var": 0.05889068245887756, "kl": 0.0036315417952644314, "entropy": 0.9651186436414718, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124875, "num_agent_steps_sampled": 374625, "num_steps_trained": 124875, "num_agent_steps_trained": 374625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4995, "training_iteration": 37, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-17-21", "timestamp": 1706105841, "time_this_iter_s": 13.091259002685547, "time_total_s": 462.3345398902893, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D72E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 462.3345398902893, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.62352941176471, "ram_util_percent": 74.34705882352941, "gpu_util_percent0": 0.06, "vram_util_percent0": 0.21309168198529413}}
{"episode_reward_max": 11.36232883666117, "episode_reward_min": -18.737224729767757, "episode_reward_mean": -0.2716550451467907, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.36447171127089, "policy_agent_": -2.6737925524085053}, "policy_reward_max": {"policy_adversary_": -5.585584651259795, "policy_agent_": 15.024013656667924}, "policy_reward_mean": {"policy_adversary_": -12.511846851877353, "policy_agent_": 6.12009590336528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6188920561193633, -4.392198584978342, 2.7774991305809316, 8.930491468703295, -4.93366393272533, -7.7549423397127635, 3.2089855744758853, -2.1939266928151047, 5.704506366284846, 3.5266264323251306, -4.04127244111905, -4.859003860579626, -8.275760006397086, 5.113919663094177, 7.796232599361524, 7.740553028692579, -8.558405663893165, -3.826540121548132, 8.354390278228465, -9.6680149485536, -1.1297073498598698, 2.809769453353881, 0.40655797519459436, 3.8678266229198677, -1.223864142821253, 0.8712715576201469, 6.357584661619668, -0.41637919719012906, 10.40628645456722, 0.28420802528507283, -3.920269834490444, 2.918689233810552, 6.866797563724508, -5.333934142326035, -1.1913911259091963, 1.074553816886137, 0.5089956234282533, 6.9637133380039415, -7.401921916750932, -1.6307950278256995, -1.8992593922659577, -1.5520109818583543, -2.2458710736714207, -4.229318885708369, 2.5383347173160358, 7.519087770641272, -2.77356263838645, 1.1199655033233802, -4.462980751653143, 5.627964052952249, -0.25609909691285426, 7.337066144432147, 5.366184614526866, 4.491920059386827, 2.0668441507418795, 0.910729441649116, 4.468324150503466, 2.7022233876919417, -3.095354109975438, -2.150309750512156, 3.6612856544214027, -4.695682529245792, -6.593477020039404, -3.4000753502950087, 3.9945003147386955, -2.902180917309332, -6.151066164586334, 0.5446826233470635, -9.67946331557487, -0.5545046013620596, -0.7143512442896882, 0.5211664646347636, -0.06983388605505508, -5.501278734133613, -0.9727337049320819, 6.079990911032871, 5.253983412072192, -2.545684406410056, -3.1488015431780734, -1.4196325626720283, 0.05624680468420287, -7.991933894489648, 11.36232883666117, -3.293722129165536, 4.815677587368665, 2.7695153652206193, -7.693625591075129, 0.5793851305595131, 5.224276735506727, -5.153045703273083, 2.029615280388433, -1.0275628437246522, -3.3909259635528137, -14.136022739528286, 8.922469721707257, 2.7882481902229053, -0.35131320485343925, -10.102496111672531, 2.052688166558635, -5.1822698019669815, -1.2614308758153012, -3.169183290861151, 4.91315549319629, -1.412307544011911, 0.05874364467047438, 2.0364492382392325, 1.5921531550359553, -15.110445269205416, 0.22912758348264806, 2.721194439534081, -0.285513568730426, 0.044761170661684946, 6.232419627680342, 3.3829983101216023, 3.526700551102067, -8.66910078531626, -1.8193050024126607, -13.68157262237981, 1.7447791228194873, -18.737224729767757, -0.1896144674828979, -0.10350917893177808, -1.371491341030055, 5.262721465275083, 2.0126475617761472, 2.5431390784190673, 6.733616134229819, 3.9530066505026586, -3.6631841314500884, 1.915718133833309, -7.053021130118768, -3.2204197048124374, 2.250384465663376, -3.619409388185911, 3.714971966707637], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.937693994108422, -12.877653725947178, -9.484101660772039, -12.923129353294838, -13.49720606711753, -9.849917476181677, -10.185491364394617, -17.619439698931657, -10.467160397959004, -22.119105781848077, -15.44013609060906, -13.020864717836634, -11.79796958211993, -16.629824449366296, -14.48199043335353, -16.328042004149985, -13.784949954270067, -15.982192849927117, -15.041265273068483, -20.0460488358466, -6.639486093491227, -18.40377142532825, -19.238443029854427, -11.424303065974135, -5.595190471903688, -6.841482543754318, -17.433479220657752, -6.831162028608699, -19.641740858768628, -16.489825238822103, -11.656517963427861, -9.644280810322302, -14.759454485528671, -8.780987174953923, -11.115927840376132, -6.694282168102063, -18.034469949885892, -17.221710874531308, -7.364366876493716, -13.03785243058304, -7.758642065984938, -14.539747559049893, -11.963001774179352, -12.270497667722523, -7.085454475201088, -17.839062420612063, -11.033527640908211, -15.10546255259622, -6.221567451900977, -18.81967921839386, -5.7866710864565585, -17.397945254395797, -12.38446164152852, -13.307985040551761, -12.879738915779038, -11.560152911743286, -17.55127277419036, -13.700565992062277, -11.298024427721037, -9.436452539696097, -19.603858393885854, -14.101590867790268, -12.12019681524506, -12.983677829631736, -9.122779679008246, -5.585584651259795, -8.395961896952466, -8.437223657867655, -9.086266781809075, -11.060788054984043, -16.439991736682916, -14.204840076639957, -8.18585548579825, -9.270729802166027, -8.378888968649793, -22.467773392648606, -11.078461764886294, -9.541528512368123, -8.767776542119636, -6.880086427501625, -9.706907363247366, -14.980149649051754, -18.1972809272089, -15.69174718467386, -11.285210833736558, -19.27107911130028, -14.967242348670244, -11.114416207855898, -23.36447171127089, -14.239267715559434, -9.373422175879668, -10.33367199300991, -11.172981681765341, -10.5373882911537, -15.719060172686609, -12.602102889078107, -11.316232197331749, -6.939381461903937, -9.293804133685697, -7.595573994950776, -7.339047855387283, -8.732661301203006, -15.614610065327033, -5.698033297439818, -10.55400289907642, -12.570674754207495, -11.54676136066065, -17.14079821998004, -17.787159466460707, -11.358302889457095, -16.625401985678497, -7.986999839513679, -18.211338410640604, -17.64009606464681, -8.069043795852114, -16.809176960740775, -10.310465723232001, -8.3339875175628, -9.816944453434958, -23.113637727665026, -7.866093945640192, -7.88423847926964, -14.91483778154378, -9.793003011246649, -10.21305915123329, -9.071023566334512, -21.470879983228606, -15.497498991547333, -12.815749058258403, -8.492723671055874, -7.922873688794985, -12.689430730317252, -7.883754318185124, -12.301950705360504, -11.304978278198925], "policy_policy_agent__reward": [7.278293025113894, 7.278293025113894, 4.242727570484416, 4.242727570484416, 6.130800395676485, 6.130800395676485, 10.926810410999066, 10.926810410999066, 4.281771067196098, 4.281771067196098, 1.0474875682344567, 1.0474875682344567, 6.697238469435251, 6.697238469435251, 7.71275650305828, 7.71275650305828, 8.085833382121923, 8.085833382121923, 12.822866107086602, 12.822866107086602, 5.699431824745008, 5.699431824745008, 4.080930428628503, 4.080930428628503, 1.761104787861422, 1.761104787861422, 10.871872056230242, 10.871872056230242, 11.139111516357529, 11.139111516357529, 12.034297516421288, 12.034297516421288, 2.6132721451884513, 2.6132721451884513, 6.077826364189489, 6.077826364189489, 11.697827775648472, 11.697827775648472, 5.189016943646503, 5.189016943646503, 2.754889371815678, 2.754889371815678, 10.606770439341062, 10.606770439341062, 9.822500502524507, 9.822500502524507, 7.646064844447001, 7.646064844447001, 2.1856631645412175, 2.1856631645412175, 3.856377050687231, 3.856377050687231, 11.89553194113871, 11.89553194113871, 3.2073914157092855, 3.2073914157092855, 15.024013656667924, 15.024013656667924, 8.38701663205359, 8.38701663205359, 3.868124064468708, 3.868124064468708, 6.281485022066429, 6.281485022066429, 10.813126024626591, 10.813126024626591, 1.7235265163139424, 1.7235265163139424, 4.962268357233469, 4.962268357233469, 3.8844179924940994, 3.8844179924940994, 9.271732786657076, 9.271732786657076, 12.092712106267621, 12.092712106267621, -0.018777520128607894, -0.018777520128607894, 5.70352870137867, 5.70352870137867, 2.9296913368594897, 2.9296913368594897, 6.493868288595768, 6.493868288595768, 4.858565350253966, 4.858565350253966, 4.02058939100708, 4.02058939100708, 4.811894596258559, 4.811894596258559, 12.679075095626667, 12.679075095626667, 4.129982501260881, 4.129982501260881, 8.112714027959802, 8.112714027959802, 0.879293350123918, 0.879293350123918, 12.223821635673051, 12.223821635673051, 2.7652859947718524, 2.7652859947718524, 12.367505699413968, 12.367505699413968, 8.875323128027695, 8.875323128027695, 8.899952549969294, 8.899952549969294, 7.4732915332604595, 7.4732915332604595, 6.235441176696201, 6.235441176696201, 11.009798462346918, 11.009798462346918, 8.201394689877107, 8.201394689877107, 4.101335158872797, 4.101335158872797, 3.64307139459197, 3.64307139459197, 11.63257202415363, 11.63257202415363, 4.702954169272234, 4.702954169272234, 2.7633598976028293, 2.7633598976028293, 4.791801239668363, 4.791801239668363, 6.55863999687347, 6.55863999687347, 1.341701866975232, 1.341701866975232, 1.1224478661830668, 1.1224478661830668, 4.49095314060736, 4.49095314060736, -0.2965982668828984, -0.2965982668828984, 5.253141726810991, 5.253141726810991, 7.862820246196614, 7.862820246196614, 7.363003270637361, 7.363003270637361, 4.058010799871596, 4.058010799871596, 1.8847255340162068, 1.8847255340162068, 3.7030776318588545, 3.7030776318588545, 14.273882151840738, 14.273882151840738, 8.166222588479242, 8.166222588479242, 3.4979220529790322, 3.4979220529790322, 2.8094874994707815, 2.8094874994707815, 2.730226932414798, 2.730226932414798, 4.881577083965783, 4.881577083965783, 3.4941078772810497, 3.4941078772810497, 14.779804881935036, 14.779804881935036, 6.199012527754163, 6.199012527754163, 8.050444210552614, 8.050444210552614, 11.020297238260454, 11.020297238260454, 3.636808378797558, 3.636808378797558, 5.846900669207709, 5.846900669207709, 14.294374223388811, 14.294374223388811, 4.543111006143177, 4.543111006143177, 5.701518728134053, 5.701518728134053, 4.65305457464263, 4.65305457464263, 3.8910278591062637, 3.8910278591062637, -1.7993172241872926, -1.7993172241872926, 12.320764947196931, 12.320764947196931, 7.695175539650504, 7.695175539650504, 5.482459496239155, 5.482459496239155, -1.5815573248842951, -1.5815573248842951, 5.673246150122168, 5.673246150122168, 1.2066520964918972, 1.2066520964918972, 3.038808489785992, 3.038808489785992, 2.781739005170927, 2.781739005170927, 10.263882779261664, 10.263882779261664, 2.142862876713954, 2.142862876713954, 5.306373271873447, 5.306373271873447, 7.3035619962233636, 7.3035619962233636, 6.569457257848304, 6.569457257848304, 1.0151764753873138, 1.0151764753873138, 9.008143524971677, 9.008143524971677, 7.039748664495586, 7.039748664495586, 8.169944208474037, 8.169944208474037, 4.015880505087683, 4.015880505087683, 12.221879019160475, 12.221879019160475, 10.511547187384203, 10.511547187384203, 5.79787217347709, 5.79787217347709, 4.070038087712254, 4.070038087712254, 4.245580360409671, 4.245580360409671, -2.6737925524085053, -2.6737925524085053, 5.780861788127223, 5.780861788127223, 2.1882064989486327, 2.1882064989486327, 3.838239739078648, 3.838239739078648, 3.8903646501689306, 3.8903646501689306, 6.771673220256862, 6.771673220256862, 7.527862238260862, 7.527862238260862, 6.11285335650472, 6.11285335650472, 5.807081322376789, 5.807081322376789, 14.10224805872921, 14.10224805872921, 9.725252821024997, 9.725252821024997, 4.576282463404159, 4.576282463404159, 5.2042209024445905, 5.2042209024445905, 0.43492627933810735, 0.43492627933810735, 4.734505512752405, 4.734505512752405, 5.067069391924249, 5.067069391924249, 4.3412706585872956, 4.3412706585872956, 7.5099751224532785, 7.5099751224532785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28768256737096043, "mean_inference_ms": 2.1630681186858904, "mean_action_processing_ms": 0.09836271804996231, "mean_env_wait_ms": 0.5920965166908119, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 128250, "timesteps_this_iter": 0, "agent_timesteps_total": 384750, "timers": {"sample_time_ms": 11605.112, "sample_throughput": 290.82, "load_time_ms": 0.296, "load_throughput": 11389312.093, "learn_time_ms": 1672.377, "learn_throughput": 2018.086, "update_time_ms": 19.441}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 16.08753080368042, "policy_loss": 0.002775954132084735, "vf_loss": 16.09476327896118, "vf_explained_var": -0.07363409996032715, "kl": 0.003120413675859268, "entropy": 1.0008354246616364, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 5.399168705940246, "policy_loss": -0.004683755710721016, "vf_loss": 5.4134621858596805, "vf_explained_var": 0.11062151491641999, "kl": 0.0066788081898406185, "entropy": 0.9630513072013855, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128250, "num_agent_steps_sampled": 384750, "num_steps_trained": 128250, "num_agent_steps_trained": 384750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5130, "training_iteration": 38, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-17-34", "timestamp": 1706105854, "time_this_iter_s": 13.359998941421509, "time_total_s": 475.6945388317108, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 475.6945388317108, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.99411764705882, "ram_util_percent": 74.3941176470588, "gpu_util_percent0": 0.11411764705882352, "vram_util_percent0": 0.2168255974264706}}
{"episode_reward_max": 14.922792959402056, "episode_reward_min": -19.287961807726603, "episode_reward_mean": -0.7339190461913214, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.638942184127014, "policy_agent_": -4.803961737760622}, "policy_reward_max": {"policy_adversary_": -4.304678267943871, "policy_agent_": 20.83452575246445}, "policy_reward_mean": {"policy_adversary_": -12.61859171088398, "policy_agent_": 5.942336332346329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3950008767674387, 4.803854461757335, -4.832017568096637, -0.2659893462467533, -0.9917736366941879, -2.909322451092895, -3.289343059602278, -6.437354473191258, -4.284107049356231, -3.3262266094644337, -7.455050729815782, 1.81142840852723, 0.35946743527795816, -1.6452830114045751, -4.557744187233685, -3.7404314374152694, -7.210232785092067, -3.3646238823676375, -11.177495238247719, -0.22018415944370473, -2.959511426592528, 7.718508604766891, -0.6566075027342779, -10.525762281339535, -1.6380349977708253, -4.455933359659891, 8.217758094184001, -7.430482284975124, -1.182390553589697, 6.445621041260441, 4.883303048069563, -11.069813186994391, 9.456634009973058, 10.498141406981606, 0.422759100063359, -8.353785450908878, 1.67658953499652, -1.5325654397086117, 2.9911189500794437, -4.01490616287203, -9.192200584509905, 3.9885645589512198, 11.469157559645371, -14.163553609110325, -6.5237257386793415, 2.764523660905289, 1.9483710711008866, -3.6639317492306454, -0.20490907877284248, -3.7189587515412814, 0.5221579130487775, -3.7338006468693585, 11.030109320801866, -2.222445962405919, -4.121054931928203, -0.8425843439634346, 0.289355208829581, 6.364944309768555, 1.015178514015699, 5.751097493914938, -5.380971721920507, -1.9559793410505795, 4.06655568828751, -6.799835232341475, 0.13580363270051107, 14.309612248378087, 0.4349953616012977, 4.175653814293161, -4.611950463939874, 9.380923058040864, -2.726555233230036, 0.3638845990234941, -2.755059420870852, -4.458219977828216, 3.2454705754625968, 4.225111347925672, -2.638781898313143, -15.909047739223736, -5.646705669698804, -1.723738573875389, 1.666501886737229, 10.497493831309276, 1.1309408614344005, -8.571074762448768, 2.2714505941994996, 5.403907112353446, 0.9772277510950227, -1.9402321769127437, 9.526133897240612, -0.40086646163665557, -3.0550098036607656, 4.774334747120974, 0.6392457981487922, -7.47098473458475, 5.168756485284501, 3.0243730019955732, -3.011594003922395, 14.922792959402056, -2.1831861292277193, 4.391414590671758, 1.960146030689982, -0.3815337042899405, 1.1914277309801813, 2.3124985524633876, -1.0672148337036713, 2.0204673203293617, -3.7306764946475557, -4.991427974270202, -1.2668141713958117, 1.4271426170915815, 0.5311961021114787, -5.622772559698238, -3.145315183343102, -3.114915883775183, 9.453009781628609, 3.279915663520712, -8.940013336045801, -2.4470297216155648, 1.8352598572085121, -6.523844100791244, -4.41318640049773, -8.649098409038414, -1.9352176303961446, 2.597555010958667, 2.873358249852074, -4.547402398616802, -17.24448667600158, -3.392606376674631, -19.287961807726603, 1.052800527520036, 0.9231054230144562, -0.3881529214393489, -0.874879529602504, 0.2583156213032532, 8.766982976284607], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.6255980917905, -17.748996378034047, -12.416226197287841, -9.849813846736305, -8.910990735306838, -12.19959150391577, -5.387582113127415, -16.034320396709056, -10.50715714117457, -11.539528795017144, -7.530158182451357, -15.630017866307671, -13.484479559098808, -18.17629443895381, -11.200530082865532, -13.645535469132197, -11.981196177843985, -12.401054834279797, -12.977425823211288, -7.450822569536183, -20.05828691511507, -17.941317800891902, -17.11541536505539, -11.72165305392333, -12.178873515214946, -4.304678267943871, -14.885337406860875, -12.37103491441665, -9.829834715125457, -13.538476680825518, -14.083979905319337, -12.67102535887952, -24.142492002922616, -24.438427972535116, -9.594581463900871, -8.928831824500685, -13.81111369975798, -5.53646986444889, -14.623117359215314, -16.228471101054804, -13.76900828176562, -7.969813902614671, -29.34076998670318, -18.482992175741476, -16.456428754850066, -14.731492011993586, -14.66470944634296, -18.61690546785971, -11.441767932513274, -6.093853421937164, -5.441249152592142, -11.907529499511137, -30.638942184127014, -6.989333415780966, -6.3263473041441705, -9.756444586226158, -12.567801010405223, -16.858789777522507, -11.4168836802629, -14.570485864635044, -19.764071064186382, -5.538836445003796, -16.056154778614303, -7.438303347028932, -13.197550694847571, -24.883548990701264, -6.6877534257111675, -17.056843312150676, -6.879373718323943, -15.032716411412787, -10.221341704726244, -10.638361190672951, -11.182743293274847, -10.90696688727537, -9.200323390395063, -11.604063971207154, -9.625165816920129, -6.301124263702505, -7.234741656503144, -14.321848138088612, -6.237782190541839, -15.165927038063872, -11.544749843914657, -13.49218364902584, -12.803609191958746, -14.943114591095588, -7.569645743252334, -15.76087586574009, -18.79645914873947, -12.872140672113598, -17.467343856556603, -16.02726514626054, -6.32670111116348, -10.34388280700166, -19.863590810391553, -14.294813450971567, -4.380946099287625, -24.495187215437564, -12.97600122676571, -13.556651090548632, -11.627130324103064, -8.263322028515352, -8.561356738707593, -10.147198446135873, -14.982383164168262, -9.604287103135817, -5.1843505034935085, -16.817839869137305, -10.155323517772583, -7.092308314984593, -13.773970035308448, -19.098329088528555, -10.3885234190491, -6.782787391691627, -19.022491816243754, -10.10495590918653, -7.686290424759642, -8.856133997196062, -8.732318063503918, -10.32286191139367, -10.966922300193797, -14.778309977337345, -11.346026998541813, -11.478064753798552, -11.97733627292257, -8.287630989525434, -16.77253166213302, -8.01605994139672, -17.192143514167316, -9.147625386462478, -13.677968845395725, -9.2181872289436, -11.47276078890458, -7.860543862294088, -16.68061588250985], "policy_policy_agent__reward": [11.010299484278963, 11.010299484278963, 11.276425419895691, 11.276425419895691, 3.792104314595602, 3.792104314595602, 4.791912250244778, 4.791912250244778, 3.959608549306326, 3.959608549306326, 4.645134526411437, 4.645134526411437, 1.0491195267625693, 1.0491195267625693, 4.798482961758903, 4.798482961758903, 3.1115250459091697, 3.1115250459091697, 4.106651092776353, 4.106651092776353, 0.037553726317787445, 0.037553726317787445, 8.720723137417453, 8.720723137417453, 6.921973497188384, 6.921973497188384, 8.265505713774616, 8.265505713774616, 3.321392947815924, 3.321392947815924, 4.952552015858465, 4.952552015858465, 2.385481696375959, 2.385481696375959, 4.518215475956079, 4.518215475956079, 0.8999652924817882, 0.8999652924817882, 3.61531920504624, 3.61531920504624, 8.549387744261269, 8.549387744261269, 12.82991320282939, 12.82991320282939, 8.229403931160558, 8.229403931160558, 0.5979453862919021, 0.5979453862919021, 5.27041925872206, 5.27041925872206, -0.07562754585800925, -0.07562754585800925, 11.55154775052244, 11.55154775052244, 2.4702763147207665, 2.4702763147207665, 4.32372208076788, 4.32372208076788, 9.992048861042981, 9.992048861042981, 9.48364147669445, 9.48364147669445, 0.8006060859425647, 0.8006060859425647, 16.79956300644783, 16.79956300644783, 17.468284689758367, 17.468284689758367, 5.0086702819821145, 5.0086702819821145, 0.28752318679590155, 0.28752318679590155, 7.74385161737725, 7.74385161737725, 2.001952212370139, 2.001952212370139, 8.807118154647377, 8.807118154647377, 6.106782469091386, 6.106782469091386, 2.2884038486278557, 2.2884038486278557, 5.979189230782944, 5.979189230782944, 20.404963773174266, 20.404963773174266, 2.159719283315573, 2.159719283315573, 4.966351508085362, 4.966351508085362, 8.748007836449435, 8.748007836449435, 8.306540258721924, 8.306540258721924, 7.476486859314537, 7.476486859314537, 5.6184294268702155, 5.6184294268702155, 1.187447335197942, 1.187447335197942, 2.9817035328204597, 2.9817035328204597, 4.086864426320888, 4.086864426320888, 20.83452575246445, 20.83452575246445, 2.383443726687524, 2.383443726687524, 1.1026461861079837, 1.1026461861079837, 4.456930121131362, 4.456930121131362, 6.4285781096174, 6.4285781096174, 11.611867043645532, 11.611867043645532, 6.216031097139299, 6.216031097139299, 10.160791679274988, 10.160791679274988, 7.191549671132936, 7.191549671132936, 1.791428551976609, 1.791428551976609, 10.061355233450906, 10.061355233450906, 0.31923405734372834, 0.31923405734372834, 6.666677163774041, 6.666677163774041, 19.596580619539672, 19.596580619539672, 3.5613743936562337, 3.5613743936562337, 10.61624856322192, 10.61624856322192, 1.133711627192034, 1.133711627192034, 12.206819734726826, 12.206819734726826, 3.7473932357481052, 3.7473932357481052, 5.501122894848224, 5.501122894848224, 4.213841936202, 4.213841936202, 3.2243734547235774, 3.2243734547235774, 6.22289698292883, 6.22289698292883, 7.914587659566417, 7.914587659566417, 3.493191959303493, 3.493191959303493, -4.803961737760622, -4.803961737760622, 0.7940179934021698, 0.7940179934021698, 6.299054782106612, 6.299054782106612, 3.9521420386395345, 3.9521420386395345, 12.831710434686574, 12.831710434686574, 6.337845352674529, 6.337845352674529, 2.460554443288534, 2.460554443288534, 7.537529893079125, 7.537529893079125, 10.17351085172452, 10.17351085172452, 4.273436747173679, 4.273436747173679, 6.910321844413672, 6.910321844413672, 14.161296522990042, 14.161296522990042, 6.235637105238471, 6.235637105238471, 7.2061670264479165, 7.2061670264479165, 10.40079994669076, 10.40079994669076, 3.482973454656136, 3.482973454656136, 1.4364490362084588, 1.4364490362084588, 12.516173647838029, 12.516173647838029, 8.659593226483565, 8.659593226483565, 0.6846760476826131, 0.6846760476826131, 19.708990087419814, 19.708990087419814, 5.396407548768996, 5.396407548768996, 8.974032840610194, 8.974032840610194, 6.793638177396524, 6.793638177396524, 3.940894162112706, 3.940894162112706, 4.876392234843888, 4.876392234843888, 6.229848499299628, 6.229848499299628, 6.9575841652322925, 6.9575841652322925, 5.8123772117325885, 5.8123772117325885, 0.7268370044229765, 0.7268370044229765, 5.91320594743355, 5.91320594743355, 4.444254673188386, 4.444254673188386, 4.259725466038087, 4.259725466038087, 7.152583068709963, 7.152583068709963, 6.737778264415158, 6.737778264415158, 3.6216041178529985, 3.6216041178529985, 1.8339357539582222, 1.8339357539582222, 14.23775079893618, 14.23775079893618, 6.692435786353622, 6.692435786353622, -0.6268614556430774, -0.6268614556430774, 3.2045521377902486, 3.2045521377902486, 5.283788960356217, 5.283788960356217, 1.8995089053012129, 1.8995089053012129, 3.2768679498480333, 3.2768679498480333, 3.06460578414947, 3.06460578414947, 4.705404684072836, 4.705404684072836, 7.037809882378611, 7.037809882378611, 7.42534726138732, 7.42534726138732, 1.8701142954543144, 1.8701142954543144, -0.2359775069342767, -0.2359775069342767, 2.3117267823610455, 2.3117267823610455, -1.0479091467796477, -1.0479091467796477, 5.100212956991259, 5.100212956991259, 7.300537134205091, 7.300537134205091, 4.415017153752126, 4.415017153752126, 5.298940629651039, 5.298940629651039, 4.05942974179867, 4.05942974179867, 12.72379942939723, 12.72379942939723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2880875804969572, "mean_inference_ms": 2.1667205778611374, "mean_action_processing_ms": 0.09826585454152692, "mean_env_wait_ms": 0.5934148669606912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 131625, "timesteps_this_iter": 0, "agent_timesteps_total": 394875, "timers": {"sample_time_ms": 11688.704, "sample_throughput": 288.74, "load_time_ms": 0.396, "load_throughput": 8522441.902, "learn_time_ms": 1679.54, "learn_throughput": 2009.479, "update_time_ms": 20.14}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 17.44625186920166, "policy_loss": -0.0022273338545346633, "vf_loss": 17.459053230285644, "vf_explained_var": -0.08375098705291747, "kl": 0.0030438603573995056, "entropy": 1.057381796836853, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 6.383250641822815, "policy_loss": -0.011174066411331295, "vf_loss": 6.403739666938781, "vf_explained_var": 0.09225635826587678, "kl": 0.008424225013820896, "entropy": 0.9341268807649612, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 131625, "num_agent_steps_sampled": 394875, "num_steps_trained": 131625, "num_agent_steps_trained": 394875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5265, "training_iteration": 39, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-17-47", "timestamp": 1706105867, "time_this_iter_s": 13.115392923355103, "time_total_s": 488.8099317550659, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5ED73A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 488.8099317550659, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.741176470588236, "ram_util_percent": 74.2764705882353, "gpu_util_percent0": 0.13529411764705881, "vram_util_percent0": 0.21485811121323528}}
{"episode_reward_max": 12.923353081308687, "episode_reward_min": -13.30307291111176, "episode_reward_mean": 0.5826915434282225, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.060360500210194, "policy_agent_": -1.3834772903964303}, "policy_reward_max": {"policy_adversary_": -4.908407656432153, "policy_agent_": 17.897095508992194}, "policy_reward_mean": {"policy_adversary_": -12.75007397861432, "policy_agent_": 6.666382761021272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.760919182922092, 0.9437108614674505, -3.503092279523524, -2.5220622923974387, 3.5015897145099464, -9.030361157170612, 3.1572734950219696, 3.255066630409231, 5.399167938380989, 2.4336277321529773, 12.923353081308687, 1.1616891513221452, 2.8766442162496535, 3.0181384638035875, -6.771031278184436, 7.0392074585095035, -5.666634521130025, 2.0309923654638204, -2.7869911321831697, -2.4170969699723215, 3.877028375278375, 4.47001535350754, 1.3006662951439152, 0.7819777747845221, 0.6592065246854484, -1.1566153737436031, 4.29179255976988, -2.875756322956256, -2.8438709910772366, -6.318624871106179, 3.4176200558242433, 2.1459482844528086, 9.393203979002145, -2.203598213428595, 1.1315028335754884, 7.403246967168711, 1.1360238894990973, 5.448339789328865, -4.270227415117252, 3.1824078131693407, -6.196190035004832, 0.06457297126996958, 0.6579790362873424, 8.243921339812472, -1.446461571387252, 2.4784837420907615, 3.14282551269128, 3.6752880762715447, 2.483535845147854, -4.610234635155674, -1.8814033055032517, -3.0920006147843857, -2.4295802125728705, 4.59571368675887, 7.824425998022997, 8.909751182529547, -4.34465760511864, -5.322603064766042, 11.326622167973632, 1.29535045398151, 3.4858466619584747, -0.2613531428820368, 3.2942221404037157, 7.4099014464480035, 5.703762464641462, -4.604686553610367, -4.515413733972878, 4.125251671491158, -9.19302305186093, 1.5624264069801364, -2.3574256231586137, -1.2268777497820966, 2.6343083798702227, -4.307167533568853, 3.2177230434798303, 1.6280410880033163, -3.620880435857523, -0.4027462781894072, 9.19709977949537, 2.0053958095184377, 2.034347957785874, 2.6637053908779773, 1.4993812204735373, -3.0131830291098365, 2.822750174655985, 6.589986046584807, 4.458210309000824, 0.7371480493844502, 0.508042967906994, -1.2622501600685538, 0.1981257165363438, -6.516517096392578, 0.4647223680331001, 1.2975240180486851, -1.9704860664459423, -9.985153269921042, 2.746769015091935, -2.123509888963546, -0.0324333502625081, -8.195727542646386, 5.225882697673237, 10.658657158512757, 6.782248664424275, -5.249380149795314, -1.9034579147135677, -8.097143622135818, -0.05907378686516929, -13.30307291111176, 4.2308757451775, -9.926158815895029, 5.355064582849706, -1.1595703291623187, 4.243933895117461, -5.285583557686836, 5.285973839827619, -2.104189303933482, -1.5127554289427216, -2.460425399917657, -5.310912819417877, -2.16899547044801, -4.092513241321538, -0.0015845456466616614, -1.9119954505059817, -5.554469623744246, 5.746692906465913, 3.474491142400173, 5.450648519058973, 5.7373755628883885, 3.3474552733871823, 2.8381951907354086, 2.379764177628741, 4.643728867294808, 3.6696113768773073, -3.5360394005360973, -1.0936756571293116], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.339414438583539, -9.702999038615948, -8.576854821075186, -19.136348631589307, -16.287926113734095, -12.02342818423262, -7.5818967218018205, -13.301764024956608, -10.339358812040006, -14.492275469967325, -22.870837936675706, -8.949487433686098, -16.205708132456422, -15.00268089131362, -10.93915700272484, -14.084427980213775, -11.59821616180582, -13.178690673244525, -10.049060190323566, -10.9247655204106, -13.977529615301407, -15.55217942876653, -8.622488107374366, -12.180971014367916, -16.740832363154915, -17.990106404667248, -12.416732082338347, -7.61992445728989, -5.595777329727671, -8.4880784198214, -14.904400860226728, -8.768322325634893, -17.68040889947452, -5.256698835174895, -8.215787151192707, -15.27374350442881, -19.07104576557802, -19.510185266468696, -4.908407656432153, -12.315699581717313, -12.935819757469602, -20.749314505712846, -17.42219411096165, -18.46856329634615, -7.540685864551501, -10.676628271414577, -13.070055561772424, -14.129902991560213, -17.589305013786433, -10.129374941850454, -8.47470235141382, -9.489111252205163, -10.099780182106745, -16.183492455135468, -15.379754453842072, -19.361791024777585, -9.758177799072001, -8.866301619810326, -20.160188597884375, -10.236550507729252, -13.670328439237183, -9.732132330767339, -11.282627564268974, -16.521384194525375, -19.454039081266668, -14.494463879743357, -14.540299183465946, -15.991903094530432, -9.728185253385247, -8.711144465088369, -9.532776120714866, -11.69532288291552, -15.703963378737186, -9.644072256368936, -10.489763993672609, -8.52461563732226, -7.982900609149344, -13.04558752039796, -17.43913917483855, -12.420609155190546, -16.584159022893008, -10.814327192192188, -7.866063779618174, -11.303267909091115, -10.829242240521674, -14.745657052813852, -16.600391010797956, -7.480185913271481, -11.047285258949497, -19.414474582463804, -8.912926049516644, -9.457707766751476, -5.488099480848044, -10.922005779804277, -7.3003887030922225, -12.772206714672159, -12.989905117431608, -17.459782277569087, -11.199815442011438, -10.582648585705313, -26.060360500210194, -18.411289526289146, -12.528515253980158, -11.58642960926565, -9.127350544193682, -13.863016730129036, -11.758355893355208, -10.536118330318894, -10.127312937652318, -17.063532370552686, -10.814072630238206, -14.310506945180391, -23.11469432512882, -10.20300274112301, -22.361195650375272, -7.155293652424226, -6.251334585652167, -12.742485422156275, -16.818830790158707, -13.314544066786741, -8.447572950639687, -13.489068968733552, -11.38392060727973, -10.784031846981792, -14.40611139474464, -13.925463946095997, -13.542721557824178, -14.797114818709051, -9.860192195643773, -13.893991265219608, -9.962960976426015, -15.57699660103802, -10.975090087356898, -7.121952332971719, -21.17244515450374], "policy_policy_agent__reward": [3.289247627830724, 3.289247627830724, 5.3233549500417, 5.3233549500417, 2.536881270775832, 2.536881270775832, 8.307143169595932, 8.307143169595932, 9.894757914122025, 9.894757914122025, 1.496533513531006, 1.496533513531006, 5.369585108411894, 5.369585108411894, 8.278415327682922, 8.278415327682922, 7.869263375210496, 7.869263375210496, 8.462951601060148, 8.462951601060148, 17.897095508992194, 17.897095508992194, 5.0555882925041224, 5.0555882925041224, 9.541176174353037, 9.541176174353037, 9.010409677558604, 9.010409677558604, 2.084062862270202, 2.084062862270202, 10.56181771936164, 10.56181771936164, 2.9657908203378964, 2.9657908203378964, 7.604841519354174, 7.604841519354174, 3.631034529070199, 3.631034529070199, 4.253834275219138, 4.253834275219138, 8.927278995289893, 8.927278995289893, 10.011097391137035, 10.011097391137035, 4.96157720125914, 4.96157720125914, 6.481474394576217, 6.481474394576217, 8.700019443920178, 8.700019443920178, 8.416745515461818, 8.416745515461818, 8.354262321054113, 8.354262321054113, 2.3720840671668175, 2.3720840671668175, 1.3759531693252176, 1.3759531693252176, 1.084726774357609, 1.084726774357609, 9.161010458025485, 9.161010458025485, 5.457135305043851, 5.457135305043851, 13.536806439238331, 13.536806439238331, 1.52655031087315, 1.52655031087315, 4.673644992384096, 4.673644992384096, 11.338495235798757, 11.338495235798757, 10.10353482753856, 10.10353482753856, 12.479262527898777, 12.479262527898777, 0.3190901206574493, 0.3190901206574493, 7.749053697443327, 7.749053697443327, 3.3698148612323866, 3.3698148612323866, 10.406943738491403, 10.406943738491403, 9.040086573624496, 9.040086573624496, 13.356242318079307, 13.356242318079307, 3.047112146582125, 3.047112146582125, 6.577556006752668, 6.577556006752668, 8.106440537231851, 8.106440537231851, 8.902595533915882, 8.902595533915882, 10.036420429467144, 10.036420429467144, 2.7595701533473873, 2.7595701533473873, 3.296649522955283, 3.296649522955283, 3.1985553187103886, 3.1985553187103886, 3.8350999847669374, 3.8350999847669374, 10.389603070947171, 10.389603070947171, 11.602090225932535, 11.602090225932535, 14.135771103653564, 14.135771103653564, 2.706760096976681, 2.706760096976681, 1.7718492775221424, 1.7718492775221424, 15.743405382928998, 15.743405382928998, 5.765950480855383, 5.765950480855383, 8.57808755059783, 8.57808755059783, 4.735389593942651, 4.735389593942651, 7.288424852336344, 7.288424852336344, 11.965642820486691, 11.965642820486691, 12.578900772954068, 12.578900772954068, 4.944888663066495, 4.944888663066495, 5.012442724746537, 5.012442724746537, 10.05857738301079, 10.05857738301079, 0.2675811007621549, 0.2675811007621549, 5.136785436034253, 5.136785436034253, 3.5876752487781247, 3.5876752487781247, 5.23422256656671, 5.23422256656671, 9.169135879303706, 9.169135879303706, 2.6684523614000435, 2.6684523614000435, 6.853743518576218, 6.853743518576218, 5.076328362662787, 5.076328362662787, 2.1810100866459097, 2.1810100866459097, 6.321420621104274, 6.321420621104274, 13.31811947716696, 13.31811947716696, 7.213002482354492, 7.213002482354492, 9.309253490339442, 9.309253490339442, 6.739016291535082, 6.739016291535082, 4.682722500045856, 4.682722500045856, 4.14504243999064, 4.14504243999064, 6.825996207588831, 6.825996207588831, 10.667821549699331, 10.667821549699331, 10.529300659899391, 10.529300659899391, 4.108666981327966, 4.108666981327966, 5.777664113428245, 5.777664113428245, 9.076112211197625, 9.076112211197625, 4.555525883026494, 4.555525883026494, 1.4705953351794483, 1.4705953351794483, 2.97641092444057, 2.97641092444057, 6.10976489892648, 6.10976489892648, 2.664951318323139, 2.664951318323139, 1.3935267223755592, 1.3935267223755592, 7.868337066261768, 7.868337066261768, 7.668136194302769, 7.668136194302769, 5.583691045874468, 5.583691045874468, 1.193460521529462, 1.193460521529462, 15.643121598941718, 15.643121598941718, 14.534973342400953, 14.534973342400953, 9.655381959202217, 9.655381959202217, 3.1685247297351684, 3.1685247297351684, 3.611946314740055, 3.611946314740055, 2.8829365539966085, 2.8829365539966085, 5.849641053245022, 5.849641053245022, -1.3834772903964303, -1.3834772903964303, 7.17909434141491, 7.17909434141491, 3.568686777328831, 3.568686777328831, 8.084568606543959, 8.084568606543959, 6.575468308009035, 6.575468308009035, 13.679314110123146, 13.679314110123146, 2.458709591718088, 2.458709591718088, 13.823584745101442, 13.823584745101442, 2.525552174245372, 2.525552174245372, 2.3692895783547225, 2.3692895783547225, 5.141030011119311, 5.141030011119311, 5.753958985370413, 5.753958985370413, 5.572774298169366, 5.572774298169366, 2.177529854659076, 2.177529854659076, 6.743742211543445, 6.743742211543445, 4.735962578386874, 4.735962578386874, 2.614781111618774, 2.614781111618774, 10.076402150605272, 10.076402150605272, 8.699977544248085, 8.699977544248085, 9.496685038441584, 9.496685038441584, 10.267245190798715, 10.267245190798715, 6.603823734515475, 6.603823734515475, 8.366093227977508, 8.366093227977508, 6.171362577027379, 6.171362577027379, 10.110362734166419, 10.110362734166419, 7.322350732117103, 7.322350732117103, 1.7929564662178108, 1.7929564662178108, 10.039384748687214, 10.039384748687214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28845556606538003, "mean_inference_ms": 2.170051370380037, "mean_action_processing_ms": 0.09856982427831179, "mean_env_wait_ms": 0.5945590516325694, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 135000, "timesteps_this_iter": 0, "agent_timesteps_total": 405000, "timers": {"sample_time_ms": 11920.194, "sample_throughput": 283.133, "load_time_ms": 0.498, "load_throughput": 6771802.526, "learn_time_ms": 1701.256, "learn_throughput": 1983.829, "update_time_ms": 21.237}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 16.10081911087036, "policy_loss": -0.006690585054457188, "vf_loss": 16.117589473724365, "vf_explained_var": -0.10875529050827026, "kl": 0.00539198299230263, "entropy": 1.0079126358032227, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 5.651314306259155, "policy_loss": 0.007813271940176492, "vf_loss": 5.652672815322876, "vf_explained_var": 0.10207451283931732, "kl": 0.005618309182060327, "entropy": 0.9189237207174301, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 405000, "num_steps_trained": 135000, "num_agent_steps_trained": 405000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5400, "training_iteration": 40, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-01", "timestamp": 1706105881, "time_this_iter_s": 13.269816160202026, "time_total_s": 502.07974791526794, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D72430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 502.07974791526794, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 39.90588235294118, "ram_util_percent": 74.35294117647058, "gpu_util_percent0": 0.21176470588235294, "vram_util_percent0": 0.21258903952205882}}
{"episode_reward_max": 12.549258041669974, "episode_reward_min": -19.907411154600585, "episode_reward_mean": -0.6815122296985298, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.439578569972586, "policy_agent_": -1.5276890690822487}, "policy_reward_max": {"policy_adversary_": -4.3905481362113035, "policy_agent_": 18.86188242166382}, "policy_reward_mean": {"policy_adversary_": -12.336679219928756, "policy_agent_": 5.827583495115112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8791507197205953, 4.856303012636752, -4.399519636111326, 5.486780127617962, -4.849917693537142, -7.162488805753268, -9.729145320163266, -1.0743971850959944, -1.44607608959511, -1.188570832289003, -2.0748717962720535, 2.4707363067957266, -3.0596074902666563, 3.8934747853549645, -4.638454399141154, 2.4573250957038866, -4.324611780050095, 2.320229085624799, -6.009442527245371, -5.041664203803769, 8.858069779013594, 0.7538734279347817, -1.7069612992146275, 11.386236821230842, -1.4768498688907956, 4.3644389350566675, -7.045774197149247, -3.657924934231088, 0.5517019311020828, -1.3601981815983142, 0.489427527725136, 2.238817636417546, 1.4568094675247414, 12.549258041669974, -5.794261551915323, -3.3415553444397244, -6.020842841388705, -1.1114030387807157, 3.686193499490045, 2.9092487399861637, -9.00183642122202, 3.6268578590784957, -0.6721145716663652, 0.7735054656407023, 0.1840641537295014, -1.7284989201994114, -1.1415631587155533, 5.2533318244106075, 3.380647000160049, -7.10122949203183, 1.1646642125368667, -9.774203445791922, -4.887102253281223, -2.181386409487639, -1.3616613078089128, 3.5917707072340237, -2.6517382899674224, 11.081439812373004, 2.3638120141381775, -4.972224725274938, -7.695435833398424, 0.45300155724653923, -8.742163194796518, 1.5357324690339142, 0.7856320282392717, 2.9415950856955035, -7.0041107977764, 2.373540652584379, -1.0268360340842273, 7.1024909766535576, -2.070817557203869, 5.521885311028728, -3.0509674925265404, 9.505053480886582, -6.910985924021009, 4.321814085252473, -19.907411154600585, -5.377954486323328, -0.1934360323451576, -2.398311904430777, 0.606377822100643, 1.4512494366483146, -2.158476744709942, -9.804794926720724, -4.834709014237464, -1.3963574545527389, -5.219334055335981, -9.9073767953384, 0.3227314524807992, -4.354251060658454, 6.50157381851929, 6.107774012791742, 9.950327394833323, 5.755170042634271, -8.635780509715046, 1.0751430736120866, -0.2922162954214642, -1.0619927439730883, -3.5132089681173597, 5.8145617920719666, -6.442464128795346, 2.254941544952191, -1.4460778663250409, 3.3020610218614515, 1.8965911977463767, -1.0967302940535786, 7.999722810857257, -2.2715207315711052, -2.9785602347224818, 1.6016539386789161, 1.2338637878177139, -1.4310736069987935, 9.723622823967661, -3.595840868673471, 2.5903329613086874, -6.0255547096552515, -0.24141063679339, -3.8379897784551193, -1.7079370561427265, 2.9240311796918057, -8.376305058054173, -2.8811774622837696, -5.735388275975988, -0.3028322357141519, -1.4333778092499012, 0.2761861398866522, 0.7674363243605803, 2.6310128747298944, -1.5917683407682373, 8.106729037960019, 9.687066012287056, 1.931459836535537, -8.948464939380116, -8.061214942700088, -8.133969015184162], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.328408668534713, -7.614686566778687, -12.618627299490242, -10.833915590063938, -10.553900739098967, -8.254311271146188, -12.938175524350878, -7.783004148324512, -10.167055021310599, -8.090453498551032, -6.727861655513689, -12.68751059879713, -12.946564806546128, -12.993644132075799, -12.646483969535298, -10.926230477332776, -9.833482971606921, -8.315689760301545, -11.011905037000535, -10.465365242359773, -22.15046376320406, -9.524429075351076, -13.48710771795634, -18.842601211067706, -5.523621766654635, -9.717768529394187, -11.573820404254382, -13.86036074907785, -20.116951276496238, -12.537722005281326, -6.758194529392122, -11.063644864690893, -15.415784633562094, -25.174506801657657, -6.447368132281133, -9.108588507973387, -7.649589907064802, -14.274844833789404, -29.439578569972586, -13.53285726462716, -9.36324165441772, -10.682251832959434, -9.52007145665431, -8.695177668107526, -6.863693885634402, -5.784244925117354, -11.89691237436891, -14.489135877513865, -13.110210079135024, -12.413117903581693, -17.76827502343238, -17.60250852769819, -15.668687801732077, -4.3905481362113035, -14.207444477840966, -15.906683738521231, -11.730447307719665, -21.09774966357583, -17.006619006862216, -12.2625311691253, -20.878099741071967, -16.77969306890589, -16.632921020014905, -10.96592140202541, -13.017563131622351, -7.9592589219405605, -9.034761438031474, -8.088807349718547, -10.884093224296166, -20.249102736940884, -18.92518687391069, -13.947989869477949, -4.670078725010714, -22.479832608265827, -14.216624245823331, -21.096465285840473, -17.425393668510342, -4.855263661134534, -8.901097441891087, -10.435962355955004, -15.261600931492644, -11.078004946071383, -6.054536690104584, -17.377469722827815, -18.629300475948, -11.924441564420329, -16.813133370407897, -13.536361718153891, -9.405066327226374, -14.47064719806365, -17.36723871112219, -12.100118004079814, -16.661482981302374, -13.635971048098243, -9.576676280852794, -5.9227985421467455, -8.878503887932778, -5.86864789215589, -12.472185925851706, -21.314104194070765, -6.814440800326532, -18.26630362852859, -9.293925909544475, -16.628630106890107, -9.737731749317836, -6.561551788424208, -14.18881359400656, -20.33869995222182, -5.253961193708131, -9.538649500810253, -11.853644090512821, -17.347939204923296, -14.462558924870692, -6.382273917863862, -8.900546251758598, -9.355189181463233, -9.330819548787023, -11.475539184349772, -7.572957839026107, -8.847968288371336, -14.331954334054045, -7.47809177393536, -16.630254886007965, -7.0123510494370525, -9.586793009383433, -17.692555889673628, -10.475143287122178, -17.599361865250707, -6.513918510822197, -13.885272612735251, -16.122735453531554, -9.92503093083152, -5.893086801215623, -10.209583466123318, -14.754374949157159], "policy_policy_agent__reward": [6.103779694127654, 6.103779694127654, 6.235494789707721, 6.235494789707721, 4.10955383168946, 4.10955383168946, 8.16034785884095, 8.16034785884095, 2.8519915227809127, 2.8519915227809127, 0.54591123269646, 0.54591123269646, 1.604515102093807, 1.604515102093807, 3.3543034816142594, 3.3543034816142594, 4.360489465857744, 4.360489465857744, 3.450941333131015, 3.450941333131015, 2.326494929620818, 2.326494929620818, 7.579123452796431, 7.579123452796431, 4.943478658139735, 4.943478658139735, 8.44355945871538, 8.44355945871538, 4.0040147851970715, 4.0040147851970715, 6.691777786518334, 6.691777786518334, 2.754435595778413, 2.754435595778413, 5.317959422963172, 5.317959422963172, 2.501231254877582, 2.501231254877582, 2.711850519278002, 2.711850519278002, 15.504266771108819, 15.504266771108819, 5.139151251642929, 5.139151251642929, 5.890073209370857, 5.890073209370857, 15.114419016149276, 15.114419016149276, 2.0233859488819195, 2.0233859488819195, 7.041103732225426, 7.041103732225426, 2.2640231035525678, 2.2640231035525678, 5.101217907423379, 5.101217907423379, 10.334326603799157, 10.334326603799157, 5.588761911841507, 5.588761911841507, 3.6238110285586274, 3.6238110285586274, 6.65123125055422, 6.65123125055422, 8.436297050543418, 8.436297050543418, 18.86188242166382, 18.86188242166382, 0.3265532901829043, 0.3265532901829043, 2.8835165817668322, 2.8835165817668322, 0.814373532838047, 0.814373532838047, 6.581720897504342, 6.581720897504342, 16.56288603473132, 16.56288603473132, 8.221053002306663, 8.221053002306663, 0.18070261659785078, 0.18070261659785078, 7.154554846018964, 7.154554846018964, 4.423978442493974, 4.423978442493974, 4.734341566874112, 4.734341566874112, 3.5238790196819507, 3.5238790196819507, 2.0278730024589717, 2.0278730024589717, 5.377674607826678, 5.377674607826678, 9.871233850962232, 9.871233850962232, 8.245428539647538, 8.245428539647538, 2.655944205774931, 2.655944205774931, 9.466469617984625, 9.466469617984625, 3.9141525409531353, 3.9141525409531353, 5.3907927742254245, 5.3907927742254245, 1.1045808633618324, 1.1045808633618324, 6.422891585016027, 6.422891585016027, 9.749227222877629, 9.749227222877629, 4.53935450887612, 4.53935450887612, 16.089594737974416, 16.089594737974416, 9.685215510500193, 9.685215510500193, 3.64515322192518, 3.64515322192518, 6.591331953836771, 6.591331953836771, 8.616347313076213, 8.616347313076213, 3.9453789126091943, 3.9453789126091943, 6.250826935529663, 6.250826935529663, 6.901597579930813, 6.901597579930813, 5.450427003818032, 5.450427003818032, 1.0153253201275372, 1.0153253201275372, 5.231174001151462, 5.231174001151462, 4.928628595105971, 4.928628595105971, 13.67579685679722, 13.67579685679722, 8.427184658353411, 8.427184658353411, 9.734937590253338, 9.734937590253338, 0.8095556162420888, 0.8095556162420888, 15.992443044576204, 15.992443044576204, 3.652819160901163, 3.652819160901163, 12.709139685546472, 12.709139685546472, -1.2410087430451193, -1.2410087430451193, -0.2613454125943983, -0.2613454125943983, 4.353830704772964, 4.353830704772964, 4.018825225762113, 4.018825225762113, 7.933989376796641, 7.933989376796641, 6.264627191359849, 6.264627191359849, 1.9480299726973196, 1.9480299726973196, 3.786337398053546, 3.786337398053546, 6.8972957308552685, 6.8972957308552685, 5.264042054933792, 5.264042054933792, 5.796899657535958, 5.796899657535958, 1.814492461407744, 1.814492461407744, 4.863898889853588, 4.863898889853588, 5.058198068702599, 5.058198068702599, 11.934406264820744, 11.934406264820744, 9.103946008435779, 9.103946008435779, 13.305905188067848, 13.305905188067848, 9.695570545366255, 9.695570545366255, 0.4704478855688737, 0.4704478855688737, 3.498970807879416, 3.498970807879416, 4.293143796255657, 4.293143796255657, 2.4033275740914015, 2.4033275740914015, 4.479488478867171, 4.479488478867171, 13.564332993071368, 13.564332993071368, 0.1859883357655939, 0.1859883357655939, 10.260622586740386, 10.260622586740386, 3.9239240216097175, 3.9239240216097175, 9.96534556437578, 9.96534556437578, 5.81716147353211, 5.81716147353211, 2.732410747185315, 2.732410747185315, 11.094268202431909, 11.094268202431909, 9.033589610325356, 9.033589610325356, 1.1377004794928243, 1.1377004794928243, 5.570151719744585, 5.570151719744585, 6.543753939165267, 6.543753939165267, 7.958432798962253, 7.958432798962253, 12.093090874419177, 12.093090874419177, 1.3932165245951962, 1.3932165245951962, 5.745439606533641, 5.745439606533641, 1.6648172359039906, 1.6648172359039906, 4.544704455996814, 4.544704455996814, 3.818774702947328, 3.818774702947328, 2.9325103914416917, 2.9325103914416917, 5.88599973403157, 5.88599973403157, 2.9778246379999347, 2.9778246379999347, 2.298457155825795, 2.298457155825795, 5.447433305015989, 5.447433305015989, 3.3547594068614504, 3.3547594068614504, 4.076707600066763, 4.076707600066763, 8.98437101478014, 8.98437101478014, 5.621289805741379, 5.621289805741379, 10.115187369990297, 10.115187369990297, 2.4610750850269807, 2.4610750850269807, 10.996000825347634, 10.996000825347634, 12.904900732909304, 12.904900732909304, 5.928245383683527, 5.928245383683527, -1.5276890690822487, -1.5276890690822487, 1.074184261711614, 1.074184261711614, 3.3102029669864996, 3.3102029669864996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28866043613472214, "mean_inference_ms": 2.17133929294194, "mean_action_processing_ms": 0.09877091784713748, "mean_env_wait_ms": 0.5948945668022374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 138375, "timesteps_this_iter": 0, "agent_timesteps_total": 415125, "timers": {"sample_time_ms": 12127.699, "sample_throughput": 278.289, "load_time_ms": 0.498, "load_throughput": 6776340.833, "learn_time_ms": 1703.344, "learn_throughput": 1981.397, "update_time_ms": 21.137}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 16.934953117370604, "policy_loss": -0.004555808583972976, "vf_loss": 16.949448585510254, "vf_explained_var": -0.07893426418304443, "kl": 0.005080242398868109, "entropy": 0.9939945638179779, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 5.3365335941314695, "policy_loss": -0.0035101149696856737, "vf_loss": 5.349177551269531, "vf_explained_var": 0.13684751093387604, "kl": 0.007103904323662596, "entropy": 0.9156158626079559, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 138375, "num_agent_steps_sampled": 415125, "num_steps_trained": 138375, "num_agent_steps_trained": 415125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5535, "training_iteration": 41, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-14", "timestamp": 1706105894, "time_this_iter_s": 12.648512601852417, "time_total_s": 514.7282605171204, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 514.7282605171204, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 35.375, "ram_util_percent": 74.875, "gpu_util_percent0": 0.10875, "vram_util_percent0": 0.2239990234375}}
{"episode_reward_max": 16.730547180985884, "episode_reward_min": -22.408792835251692, "episode_reward_mean": 0.048070998551446406, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -40.16272918078487, "policy_agent_": -3.255568450254332}, "policy_reward_max": {"policy_adversary_": -4.450866005537372, "policy_agent_": 28.446638180885373}, "policy_reward_mean": {"policy_adversary_": -13.48877582568132, "policy_agent_": 6.768423412116383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.45179090748715023, -6.589740367468077, 4.242634800744996, 0.7441346214021113, -0.45232717906609227, -3.2347241022627515, 1.5792436504672074, -0.1384347051856496, -2.6403676899592687, 0.641228571168202, 0.9364265101631088, -3.3000904948807186, 8.514461936645773, 11.02625461029567, 4.393862174125059, -5.550843556690294, -1.5239788692451128, 0.14877775564853787, 10.461222274524726, 0.5331839618848447, -3.879099191524182, -0.07386799763157348, 3.1190941813585193, 0.23902401298993242, -4.93556509868814, 7.491486623009477, 0.06442738118098931, 2.0465332152441267, 0.31877136330821304, 0.3635013795777341, 10.550726800965151, -3.8543661479489777, 5.159078782503159, -2.7854874814852444, -2.998511787554632, 2.8079748219922074, 3.302997181912743, -3.0598182624494683, 10.746828465204679, 7.620281236635151, -4.76778601063963, 0.1775023665955492, 2.194090039670124, -1.8900015414832403, 0.019767778804330227, -0.6822219618104621, 2.4577273830866346, -5.5852181723877345, -2.916617935871141, -0.9937860596193813, 10.462058283257331, -2.9791872859191044, -3.2162324648914296, 16.730547180985884, 0.44179375809562194, -6.051576530723622, 1.783942144207333, 2.0368380891039157, -3.297712772760522, 2.4772528643246194, -3.0274054180791876, -2.910327405186475, -4.7737575019213025, 10.980711649229356, -3.4060808515350574, -0.694866698480147, 14.259674666221116, -14.669091914768433, -7.543177569131343, 10.470045346132906, -5.249753546983088, 2.5615357323254333, -9.200098011185643, 7.533820153642878, 4.495395140837996, 2.276324563972169, -5.812021549543358, -2.27935395943019, 2.149975698109138, -3.627592308343842, 0.2094574815846838, -22.408792835251692, -8.486037711070875, 5.271714202066781, 9.903968438381554, -9.012127145687941, 5.073210667896597, -1.7151479408970092, -1.9479069229935482, -8.539296389976787, -8.201740320438109, -11.709887817748609, 2.3004009478304814, -0.1535017279038359, -11.328695347102094, -2.8391868848837585, -0.2496186194887285, 3.121091071225669, -5.507767513057374, 10.525167804750598, -8.949474003181084, 3.255631438416156, -3.0615142560869417, 8.18442258883936, 1.817589940595522, 4.652294002648464, 4.161344173245894, 3.3888170774690707, 5.176279101514395, 1.4111004330112966, 3.4458492216057333, 0.08906984562094739, -0.8814424283887171, 0.6342674316353021, 4.644245799589034, 1.3744854126465595, -0.649618601009805, 5.095335389046895, -6.565956025073951, -2.6675174774207897, -5.362009781483868, 15.546378208152465, 0.030581490503595404, -2.0944790886093614, -11.330053694511834, -0.03400233991742352, -7.718904947448289, 6.28965700690552, 1.910290090853355, 2.7117423716982447, -3.3784803664834353, -2.573361841708511, -6.211619152052613, -3.4873912691471514, 3.8124477744022394], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.00175555257394, -6.773217747093843, -14.768203204718207, -17.322585337485275, -17.06186520280583, -7.896958537117015, -9.126531168945032, -9.922029918358259, -9.72727596587317, -10.639159120343392, -7.735308204543284, -13.16766602897085, -28.17658656632532, -18.745546399918798, -12.532996087584264, -5.378302880614646, -18.933012147412022, -10.28399046908541, -17.41135864026731, -13.344496835730814, -12.236617884854313, -13.537516658122827, -16.31137302391188, -10.018131716920927, -12.175027176098157, -19.548072130416333, -9.673971001296655, -17.709697156345953, -5.36761706259504, -12.969555675174938, -21.582738674780572, -16.17070919869812, -9.814864443463128, -5.794447287889733, -12.939087374577474, -17.55771545786531, -13.987541452590039, -9.394725428569508, -21.73898704312739, -14.36403379194175, -5.374034447160043, -10.60352134178676, -13.076931740965279, -12.122679191801401, -9.317730524656147, -5.916995089620114, -7.190283617929767, -10.035487260452308, -7.557813598384072, -12.847939941043872, -15.502659986258285, -6.919242980222622, -16.13676423367306, -40.16272918078487, -23.311245430011517, -12.505106961504717, -9.919783805837527, -10.965139674238547, -10.108684923374131, -9.601000197865499, -9.182684033055034, -14.258023012954139, -16.07020760654341, -24.61517819219098, -9.790587647219784, -11.083268248728928, -24.39106168347541, -10.418111394589666, -8.566533238508745, -19.09241482330035, -15.832851870724387, -12.09794294629652, -13.734692111870963, -15.780718919588502, -17.981657497341732, -12.8480018887175, -9.874294964410296, -12.5355314355014, -10.03124555346756, -19.063865925877057, -8.023117773151734, -15.897655934743032, -17.58365104756435, -18.33946683071958, -23.031106993516484, -4.450866005537372, -18.116434924279982, -15.309077510735722, -10.330068692794729, -22.751700141453533, -16.004554792304507, -15.27476643903139, -27.912253162602852, -12.557297179566502, -11.288876498224614, -13.236631033881324, -8.738029456470112, -9.40709690719077, -8.609926630355323, -29.88342897867791, -17.382422140072492, -8.906045070186932, -9.35996396137411, -19.094571625332176, -6.640045850278665, -14.63049051039313, -26.415048712960296, -12.537997191776325, -17.130589843945106, -8.234279412525488, -8.960732211641776, -14.133978058521649, -10.711718008358577, -18.65334106814117, -15.385214187547497, -8.218926265246774, -11.48928894424541, -11.400754159501266, -8.77259631971266, -17.87418120090856, -9.937593754898376, -22.90167579677681, -7.245930640053933, -12.11513382302101, -9.43393190957868, -11.750626300823665, -9.459477300926709, -21.383694046706697, -7.415097580611872, -11.727336989708744, -22.25722092157888, -4.754353112292678, -13.262335267046469, -4.978513614790653, -12.417700955751279], "policy_policy_agent__reward": [4.2749823225433925, 4.2749823225433925, 0.09173868981288233, 0.09173868981288233, 9.5054190027316, 9.5054190027316, 9.033359979443693, 9.033359979443693, 8.304769011869869, 8.304769011869869, 2.331117217427133, 2.331117217427133, 5.3528874097061205, 5.3528874097061205, 4.891797606586306, 4.891797606586306, 3.5434541379569504, 3.5434541379569504, 5.640193845755796, 5.640193845755796, 4.335867357353195, 4.335867357353195, 4.933787767045065, 4.933787767045065, 18.34552425148555, 18.34552425148555, 14.885900505107228, 14.885900505107228, 8.463429130854664, 8.463429130854664, -0.08627033803782264, -0.08627033803782264, 8.70451663908346, 8.70451663908346, 5.216384112366972, 5.216384112366972, 13.936290457396018, 13.936290457396018, 6.93884039880783, 6.93884039880783, 4.178759346665065, 4.178759346665065, 6.731824330245628, 6.731824330245628, 9.715233602635204, 9.715233602635204, 5.128577864955429, 5.128577864955429, 3.61973103870501, 3.61973103870501, 13.519779376712906, 13.519779376712906, 4.869199191238819, 4.869199191238819, 9.878115185795037, 9.878115185795037, 2.843194212951627, 2.843194212951627, 6.666528527376336, 6.666528527376336, 16.066732737872854, 16.066732737872854, 6.158171525374571, 6.158171525374571, 7.486971612983144, 7.486971612983144, 1.5044799032022447, 1.5044799032022447, 4.970287793511421, 4.970287793511421, 10.182845139928757, 10.182845139928757, 8.64526931725139, 8.64526931725139, 3.167453583060019, 3.167453583060019, 16.242907754166033, 16.242907754166033, 10.992157514288447, 10.992157514288447, 0.3031242182602058, 0.3031242182602058, 5.390511854191154, 5.390511854191154, 7.635510890317703, 7.635510890317703, 5.116338825159081, 5.116338825159081, 4.668749151730236, 4.668749151730236, 2.617386563904826, 2.617386563904826, 4.824005500508201, 4.824005500508201, 2.2251345440322914, 2.2251345440322914, 2.320597831256464, 2.320597831256464, 5.927076940712246, 5.927076940712246, 12.982359134757811, 12.982359134757811, 1.9700278471517594, 1.9700278471517594, 6.460265884390818, 6.460265884390818, 28.446638180885373, 28.446638180885373, 11.876519594053569, 11.876519594053569, 3.226765215390549, 3.226765215390549, 5.85186297502243, 5.85186297502243, 6.50098888167123, 6.50098888167123, 3.4054860753068037, 3.4054860753068037, 6.039126531095061, 6.039126531095061, 3.077639307487923, 3.077639307487923, 5.673847803883834, 5.673847803883834, 5.648225052311052, 5.648225052311052, 17.79794492071017, 17.79794492071017, 3.1922533978423635, 3.1922533978423635, 5.194200775124389, 5.194200775124389, 19.325368174848265, 19.325368174848265, -2.1254902600893835, -2.1254902600893835, 0.5116778346887023, 0.5116778346887023, 14.78123008471663, 14.78123008471663, 5.291549161870652, 5.291549161870652, 7.329739339310977, 7.329739339310977, 2.2672970503426617, 2.2672970503426617, 11.657269536615694, 11.657269536615694, 11.238526319089864, 11.238526319089864, 7.5621632263448335, 7.5621632263448335, 2.0311367074334696, 2.0311367074334696, 5.128088738035604, 5.128088738035604, 6.090610625788349, 6.090610625788349, 7.718136808766602, 7.718136808766602, 4.116287627368209, 4.116287627368209, -3.255568450254332, -3.255568450254332, 4.548806668246735, 4.548806668246735, 11.805590516393183, 11.805590516393183, 16.46753771594902, 16.46753771594902, -2.2806305700752825, -2.2806305700752825, 11.594822796088287, 11.594822796088287, 6.7969647849193535, 6.7969647849193535, 4.191080884900594, 4.191080884900594, 7.1062018757383685, 7.1062018757383685, 3.9014072359331964, 3.9014072359331964, 1.7824393106413923, 1.7824393106413923, 15.106327055216667, 15.106327055216667, 6.2018977258313335, 6.2018977258313335, -0.01990942443874566, -0.01990942443874566, 5.19872207449878, 5.19872207449878, 4.24420541849069, 4.24420541849069, 6.26409398920822, 6.26409398920822, 1.5510795586489765, 1.5510795586489765, 20.20429839171425, 20.20429839171425, 4.216474068445701, 4.216474068445701, 6.080838254301544, 6.080838254301544, 3.1492248526435853, 3.1492248526435853, 13.639497107085768, 13.639497107085768, 4.2288178954370945, 4.2288178954370945, 9.641392256520797, 9.641392256520797, 15.288196443103093, 15.288196443103093, 7.963407134622698, 7.963407134622698, 11.153434472729748, 11.153434472729748, 4.822689922768392, 4.822689922768392, 6.203290716623753, 6.203290716623753, 7.111523952071296, 7.111523952071296, 4.91513778998493, 4.91513778998493, 9.643804249888232, 9.643804249888232, 10.01472999356827, 10.01472999356827, 4.796705838946668, 4.796705838946668, 5.419835171617803, 5.419835171617803, 8.24804477427408, 8.24804477427408, 1.1033201473193548, 1.1033201473193548, 7.6033318617438885, 7.6033318617438885, 2.2877919867072563, 2.2877919867072563, 19.22402700246465, 19.22402700246465, 3.638256065278764, 3.638256065278764, 5.0103273672058215, 5.0103273672058215, -0.9480608924665741, -0.9480608924665741, 5.858311980453119, 5.858311980453119, 0.8702861767392072, 0.8702861767392072, 13.836675526806108, 13.836675526806108, 4.662693835732613, 4.662693835732613, 7.2195396807034955, 7.2195396807034955, 9.439370277547724, 9.439370277547724, 1.090495635292083, 1.090495635292083, 3.5253580574969265, 3.5253580574969265, 0.7455611728217496, 0.7455611728217496, 8.11507436507676, 8.11507436507676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2875721030203369, "mean_inference_ms": 2.164366834609812, "mean_action_processing_ms": 0.09856609945672834, "mean_env_wait_ms": 0.5929055282312591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 141750, "timesteps_this_iter": 0, "agent_timesteps_total": 425250, "timers": {"sample_time_ms": 12126.913, "sample_throughput": 278.307, "load_time_ms": 0.401, "load_throughput": 8411537.227, "learn_time_ms": 1701.748, "learn_throughput": 1983.255, "update_time_ms": 21.199}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 23.07180519104004, "policy_loss": 0.0066417875001207, "vf_loss": 23.075094604492186, "vf_explained_var": -0.08494753837585449, "kl": 0.005202030000041237, "entropy": 0.9930082857608795, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 9.001432704925538, "policy_loss": -0.018195725884288548, "vf_loss": 9.028649044036865, "vf_explained_var": 0.12020796537399292, "kl": 0.005014567970695725, "entropy": 0.9036137759685516, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 141750, "num_agent_steps_sampled": 425250, "num_steps_trained": 141750, "num_agent_steps_trained": 425250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5670, "training_iteration": 42, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-25", "timestamp": 1706105905, "time_this_iter_s": 10.898039817810059, "time_total_s": 525.6263003349304, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 525.6263003349304, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.164285714285715, "ram_util_percent": 74.29999999999998, "gpu_util_percent0": 0.2492857142857143, "vram_util_percent0": 0.229736328125}}
{"episode_reward_max": 14.509023438028832, "episode_reward_min": -15.17825388138379, "episode_reward_mean": -0.29333007855721155, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.353105486849238, "policy_agent_": -3.420073815843557}, "policy_reward_max": {"policy_adversary_": -4.34160699044584, "policy_agent_": 21.916376100711847}, "policy_reward_mean": {"policy_adversary_": -12.976027957587494, "policy_agent_": 6.34134893951514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.447112155010571, -0.7591684629151532, -0.16009756008743048, -1.8531148542087472, -5.109028170717096, 2.3091564354442804, 4.47093103423213, -0.1288712777989055, -2.555910453824467, -5.341767132895852, -3.2775248151473755, 2.096723746087452, 2.2296309725113685, 3.3476445954060137, 5.962558607935097, -1.4857620038496484, 0.8791861860523591, -15.17825388138379, 1.1054041821761875, -11.306870900026365, -4.7944696375885485, -1.2824591006994832, 3.608019014208964, -1.9191988999008267, 1.3513471714629803, 0.4865562703935919, 13.568802781104184, -13.103053448642694, -2.7557102718715583, -4.7128481174412755, -15.173472843322736, -0.8266465770448412, 1.0722486506175186, 2.292530356367745, -0.20697243329791135, 0.9438054474114825, 1.474028828812302, -5.489101838765188, 0.8602041937184914, 4.117355316688152, 2.840056856664676, -4.820442661643227, 1.7729141209389083, 14.509023438028832, 1.6001878705547843, -1.6080069178901475, -4.126348470092464, 5.07369488561392, 4.777279167352674, 0.8319292433828318, 2.102630375784706, 4.7626440950316065, -2.316991772521563, 0.17219953140951316, -0.5541918953900546, 4.8245206060249215, 0.23693172745501392, 3.8529453008001258, 1.7351505290643148, 1.6931141027929208, -0.21558904238674792, -9.03299538325261, -6.233790299837627, 0.09647773303082191, 5.514768719162205, 4.901160127942491, -5.270310026735274, -12.6877276461086, -1.1782308626653655, 2.451862646828928, -5.781023089556971, -2.328770627419809, 1.1177359031313028, -1.3905329371841224, -2.00763260766762, 3.93329825427075, 2.1815960297049175, 9.85924979282326, -3.32711518512691, -3.6031046639615876, 2.455198881427846, 1.487259644291559, -10.15362906044798, 1.0536794265545608, -11.303900420368244, -1.0610100210306868, -1.3516706766405464, 1.1703447771925954, -1.3545251732669565, 0.7650845471420545, 0.6042258678422736, -0.4851815872066698, 0.34198951202180206, -3.877020490470657, 2.3069256093490065, -3.4552064719873226, 4.628565952430918, -0.01749037458120979, -4.83622558133686, -10.029620479307988, 0.8802834715930574, 4.607984488635105, -1.3311456669470556, 1.2901698270057262, 0.2270918102176383, 7.578518723434043, 2.0871990035381236, -5.0803465334658755, 4.665472943274737, -4.2601352204151715, 8.523307273714387, -5.298937260756178, 10.20876115196571, 3.1770415745789755, 0.45753288033989936, 2.3965955384641835, -4.859129173635943, 1.1083699978775017, -6.1618195715064745, 1.6938180398470495, -8.933520701156718, 2.7020642442694425, -3.418367132488302, -1.737558828695502, 0.4201660473005004, -9.945638125029705, -1.7478399522328323, 8.457643150792679, 5.193786542691286, 4.927253680672771, -7.327515693451231, -0.271107693274762, -1.6456260467814092, 10.864297721563755, -2.4975352313351697], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.786615578089828, -18.922547175524098, -8.146357874081396, -11.489714608775682, -5.535044154552491, -19.73276153580633, -16.350948348246966, -7.761108654618286, -14.888197766482865, -10.312020836571543, -9.422032712499364, -8.21933169005959, -10.271986209578495, -12.201568374549039, -31.353105486849238, -14.429102369586525, -14.449581490648463, -12.878145215772465, -5.363146227263894, -9.918947681606694, -9.480967442136976, -15.644246105963166, -10.680250814734944, -8.873051733067129, -7.700954697985146, -7.712034643788684, -19.532596605099062, -19.44274176581622, -9.935083933561948, -7.099368647525781, -8.333325211635625, -13.207048070519432, -10.222074143903509, -13.883645943844083, -4.34160699044584, -13.747063476481916, -7.640891876178335, -22.78430739397399, -7.932024818742358, -31.148166336772707, -12.173451609176357, -10.58699654128997, -8.49955109764926, -29.323728763394858, -17.92393237185593, -10.998340014574453, -12.263839704880985, -14.904098970923291, -10.97321177604749, -17.974105393436176, -17.75722765352711, -14.231275098469567, -9.538675391788502, -5.6709392337187525, -11.572274720211231, -13.702121992963862, -7.439815773401409, -17.840008351711514, -8.569997066073428, -11.237473348062814, -19.757923121162385, -29.60573853952182, -18.593473956665317, -12.76104439146346, -14.009069355293407, -9.83686624240243, -7.764598429900506, -12.38189783604816, -9.895540257422962, -8.862368713402152, -13.283935119969495, -9.788280265678008, -9.291577297699204, -8.15602799030083, -6.643960374436495, -13.32629532817214, -26.97586304774864, -19.117482553370277, -6.61254215159301, -6.967972047313171, -17.828395738025318, -17.658134414732707, -10.780088888666386, -16.286623197746824, -13.252626300237765, -15.96231979895668, -13.697327966575497, -13.88909207987838, -21.88925134117869, -10.468180104994492, -5.9113326630720175, -12.015757270109821, -9.022108110934642, -16.2795183148537, -11.158071357326156, -8.141532691488049, -11.502821438289017, -9.666484527052651, -5.864944137222275, -8.428132494082528, -16.880938077874838, -14.368966695295267, -12.695356146544903, -13.666588280585598, -11.338911023252003, -21.98327240691283, -17.26135904959385, -7.613718138652918, -9.823112622931177, -11.859466137901991, -18.96643477358874, -7.22263608713251, -14.691092599787382, -11.455520017171976, -9.342947423360085, -14.673051268626963, -9.295590220161579, -14.077295744440896, -10.568995243135907, -11.622164498044347, -11.170964390769042, -12.17694740791028, -11.313817369509458, -17.821192761473505, -15.156693333710292, -14.110496528425584, -6.902342684819494, -22.194678269389016, -16.268079856022396, -13.725313231382039, -13.380598993467698, -10.087163532111045, -7.060204783404569, -24.155851497046687, -13.542033808390242], "policy_policy_agent__reward": [11.616863866550196, 11.616863866550196, 9.081689356304473, 9.081689356304473, 3.993130156996982, 3.993130156996982, 4.818299877283466, 4.818299877283466, 0.21300799191769826, 0.21300799191769826, 11.020958985625308, 11.020958985625308, 10.410939691239548, 10.410939691239548, 3.81611868840969, 3.81611868840969, 6.166143656329196, 6.166143656329196, 2.485126851837846, 2.485126851837846, 3.0722539486759937, 3.0722539486759937, 5.158027718073522, 5.158027718073522, 6.250808591044933, 6.250808591044933, 7.774606484977528, 7.774606484977528, 18.657832047392173, 18.657832047392173, 6.47167018286844, 6.47167018286844, 7.664383838350413, 7.664383838350413, -1.150054332805665, -1.150054332805665, 3.2342752047200407, 3.2342752047200407, -0.6939616092098334, -0.6939616092098334, 2.343248902274213, 2.343248902274213, 7.180893502631842, 7.180893502631842, 7.144134914471953, 7.144134914471953, 3.4769264165831504, 3.4769264165831504, 4.526150934724064, 4.526150934724064, 4.099295457091138, 4.099295457091138, 16.55069969310162, 16.55069969310162, 3.1698441585867636, 3.1698441585867636, 3.5896868308451957, 3.5896868308451957, 1.1932602650422532, 1.1932602650422532, -3.420073815843557, -3.420073815843557, 6.190200746737297, 6.190200746737297, 5.64716139726051, 5.64716139726051, 8.088088150105914, 8.088088150105914, 2.067317278573965, 2.067317278573965, 7.345434461946699, 7.345434461946699, 4.55746035249532, 4.55746035249532, 8.647602777604407, 8.647602777604407, 4.3961145062304245, 4.3961145062304245, 17.63276082673043, 17.63276082673043, 7.50675423292052, 7.50675423292052, 2.883276939823374, 2.883276939823374, 5.136232609294086, 5.136232609294086, 21.916376100711847, 21.916376100711847, 9.762060121205355, 9.762060121205355, 4.6951665483421525, 4.6951665483421525, 4.068745617394261, 4.068745617394261, 9.988896928268607, 9.988896928268607, 7.875245471700082, 7.875245471700082, 9.4030173184095, 9.4030173184095, 9.929929014655906, 9.929929014655906, 9.496959596750587, 9.496959596750587, 3.6108418096334702, 3.6108418096334702, 2.9215693825641322, 2.9215693825641322, 5.509041412410589, 5.509041412410589, 9.263321299494391, 9.263321299494391, 3.8383737504282114, 3.8383737504282114, 10.846476826255818, 10.846476826255818, 5.152573797568872, 5.152573797568872, 6.465293725427868, 6.465293725427868, 9.771167039387818, 9.771167039387818, 10.286371578134599, 10.286371578134599, 6.179841828413844, 6.179841828413844, 6.42876106224714, 6.42876106224714, 9.761919037227809, 9.761919037227809, 7.369013185172459, 7.369013185172459, 1.2471442015826164, 1.2471442015826164, -0.1529149050302179, -0.1529149050302179, 4.3586546973788, 4.3586546973788, 5.657115680115539, 5.657115680115539, 3.7514560152062613, 3.7514560152062613, 3.7297548191291, 3.7297548191291, 5.2046566004152535, 5.2046566004152535, 3.3827475265583544, 3.3827475265583544, 2.3181638833844374, 2.3181638833844374, 8.629796791221448, 8.629796791221448, 14.578729538726776, 14.578729538726776, 14.488366173096766, 14.488366173096766, 1.6427134832330492, 1.6427134832330492, 1.682433691675792, 1.682433691675792, 10.141797309726583, 10.141797309726583, 9.572697029512133, 9.572697029512133, 0.3132299141092025, 0.3132299141092025, 8.670151312150692, 8.670151312150692, 0.9743629399347625, 0.9743629399347625, 7.450654888962995, 7.450654888962995, 6.172828644967475, 6.172828644967475, 7.529718428535489, 7.529718428535489, 10.267363083955868, 10.267363083955868, 5.616632326068272, 5.616632326068272, 3.257779265457145, 3.257779265457145, 5.765287841451574, 5.765287841451574, 4.682048811478222, 4.682048811478222, 6.201248912191522, 6.201248912191522, 6.7324984833375785, 6.7324984833375785, 2.3431631097503636, 2.3431631097503636, 8.065693695359966, 8.065693695359966, 4.824497076235722, 4.824497076235722, 0.5143592779427081, 0.5143592779427081, -0.8007439926127298, -0.8007439926127298, 8.880610774733949, 8.880610774733949, 9.488475591965184, 9.488475591965184, 5.682105239798924, 5.682105239798924, 7.478379053795664, 7.478379053795664, 5.783001416734819, 5.783001416734819, 14.780895565173433, 14.780895565173433, 9.674279026565985, 9.674279026565985, 1.2666858025935235, 1.2666858025935235, 7.244292783102957, 7.244292783102957, 3.79966545874341, 3.79966545874341, 13.744871023651566, 13.744871023651566, 0.9618494131881651, 0.9618494131881651, 12.449926875876548, 12.449926875876548, 7.316280795875472, 7.316280795875472, 4.900240151849991, 4.900240151849991, 8.534823403545575, 8.534823403545575, 2.2182305232628163, 2.2182305232628163, 7.5928328711592, 7.5928328711592, 2.2035878358147145, 2.2035878358147145, 6.657991268945699, 6.657991268945699, 1.1187218448061573, 1.1187218448061573, 7.439505826089865, 7.439505826089865, 3.947725118510578, 3.947725118510578, 8.041816966389002, 8.041816966389002, 7.788429690505397, 7.788429690505397, 2.082429201697938, 2.082429201697938, 2.5772513662933307, 2.5772513662933307, 15.326160710090846, 15.326160710090846, 10.73093319935684, 10.73093319935684, 9.326283456027404, 9.326283456027404, 3.0265416500082334, 3.0265416500082334, 4.908027919418142, 4.908027919418142, 2.70728936831158, 2.70728936831158, 17.51007460930522, 17.51007460930522, 5.5222492885275365, 5.5222492885275365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2872297325440749, "mean_inference_ms": 2.162178199738419, "mean_action_processing_ms": 0.09854851609867073, "mean_env_wait_ms": 0.5921661785616245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 145125, "timesteps_this_iter": 0, "agent_timesteps_total": 435375, "timers": {"sample_time_ms": 12228.143, "sample_throughput": 276.003, "load_time_ms": 0.401, "load_throughput": 8411537.227, "learn_time_ms": 1705.542, "learn_throughput": 1978.843, "update_time_ms": 21.199}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 19.239166259765625, "policy_loss": -0.012315427418798208, "vf_loss": 19.261055564880373, "vf_explained_var": -0.07093197107315063, "kl": 0.00782564974881983, "entropy": 0.9574182212352753, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 6.304101800918579, "policy_loss": -0.007556698843836784, "vf_loss": 6.320675683021546, "vf_explained_var": 0.15407669246196748, "kl": 0.008690860791293803, "entropy": 0.9044275164604187, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 145125, "num_agent_steps_sampled": 435375, "num_steps_trained": 145125, "num_agent_steps_trained": 435375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5805, "training_iteration": 43, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-37", "timestamp": 1706105917, "time_this_iter_s": 11.94086766242981, "time_total_s": 537.5671679973602, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 537.5671679973602, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 32.2, "ram_util_percent": 74.25333333333332, "gpu_util_percent0": 0.17999999999999997, "vram_util_percent0": 0.22234700520833334}}
{"episode_reward_max": 14.332010572341344, "episode_reward_min": -14.880922241350696, "episode_reward_mean": -0.5832634651819238, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.797646617589354, "policy_agent_": -2.695642081803778}, "policy_reward_max": {"policy_adversary_": -2.191810662462492, "policy_agent_": 18.42364674746309}, "policy_reward_mean": {"policy_adversary_": -12.647539493140721, "policy_agent_": 6.032138013979398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.290060028456838, 3.8482993890128094, -5.361690262287371, -9.277561673023627, -8.362549278566858, 8.803237684320298, -3.274457957491691, 0.9774468036212449, 1.4186634107504381, -3.807781017464843, -1.7396660105185862, 4.982873196028218, 0.19470391891892003, -0.2729933256614989, 0.7151781032803248, -12.591487381709571, -1.3148814797094093, 1.854240606148448, 0.29784720879390547, -4.675516338238063, -6.41517625572418, -2.0183064678702602, 7.878549536094569, 1.5087003704834547, 9.243900602443178, -1.2999226365149625, 1.1598036595173797, 0.5522433855848696, -14.880922241350696, -2.3395823076966593, 0.22761574890706224, -1.3606781576961466, -3.784969998143195, -9.837190192892084, -6.420379864114592, 4.293878811860146, -3.0423111170304438, -3.1960846512617245, 0.5163590309749113, -6.647933039718089, -2.3273216910133687, 0.8549810171724801, -1.4284191732599179, 0.28510412963036, 3.606505034848849, -1.1372165971391948, -2.4136523905453364, 6.525605611355935, -4.7685592526313565, 0.20390038436824082, -1.1282640900561711, 2.0244061570964456, -3.9395593306173113, 6.0992748560964625, 7.325163387045889, -0.13062141887637563, 2.8917470427169145, 8.121845955344831, -0.7190037575554042, 2.897259472691307, -0.16173066199539532, 3.5082293460588936, 8.328897428915662, -4.213769373452148, -3.416445214362002, -2.174808165523103, -1.6975014890512603, 2.566576319248017, -10.67406475661761, 2.2789596659723497, 6.2772289817933515, -0.8923333446352549, 1.9981438595529784, 3.619944691504258, 5.334473814475098, -3.011757024792805, -6.187079232399042, 4.448121099502616, 2.4455447133790216, -0.272836055529889, -8.729894403782543, 2.2385586564788733, -5.722890976512937, -0.506588713846567, -2.858417482368036, 7.321462541023022, 4.8873617440059585, -5.472743607875972, -5.99090456102002, 2.216654751148574, -0.29885649583132157, 3.6378912623414292, 2.661898550413711, -1.0011052218745933, -7.907915212404594, 3.261784104536963, -0.4382688899103783, 9.208758211146604, -6.461991346759628, -1.8959029591238132, -0.06162071946669467, -12.06980867701658, 0.5703997662729955, 4.008567630581013, 1.542301781759424, 4.683013353458583, 9.726206273538063, 4.140067054504374, -11.815220262100574, -5.3115220491088415, -3.002769643337085, -4.400925648522187, -2.4654768130155906, -1.81011228843262, -6.777321432115205, 1.707581494751432, -7.1481752345149125, -2.468852866619845, -4.943910894624203, 1.2577941948521778, -2.922451142094871, 5.23990909514947, 6.561426502279783, 14.332010572341344, -7.590397236492022, -2.2833564800467068, 0.0188581064924572, 9.274116280735587, -1.4590785053461768, -6.30580054381968, -1.0517117572331323, -5.831706808578822, -4.88948650765284, -4.439517560410116, 5.889103482171757], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.929327992971347, -11.466660785192195, -8.205871567651428, -18.08489135463654, -3.9378534161720404, -12.872254164305431, -18.689837813167845, -6.481831833137965, -12.673682851688637, -11.621425760614635, -7.8754016648036345, -9.761552604945699, -16.57802775463886, -21.57919459883384, -7.800192736922873, -7.200203218102011, -5.786796427360929, -9.1169416335219, -17.64223692367819, -7.708607492321903, -13.603730206037314, -27.352013301322117, -14.578670689535924, -8.232932483418173, -14.696632771162907, -8.879349125064454, -9.838385031618124, -13.268162897285137, -19.178314012865247, -8.286545058512171, -12.418330162515039, -9.885404800808697, -11.128792446459611, -20.367131495775734, -13.170642703656448, -9.991594346399642, -11.802661211992826, -9.487914663508064, -8.089818439297343, -13.647243085715822, -8.131708099169005, -11.716417947834989, -13.213643045350288, -9.625379365355958, -14.715130005681067, -17.461924118502992, -14.280275287543818, -13.659846078677663, -10.35234894483586, -6.500511982748236, -8.342413070047634, -17.323773900373578, -9.555898074280254, -14.74376216499846, -16.449634808849876, -9.520099341376095, -19.897687755356174, -15.720961343245001, -15.667406103773518, -10.47468349109346, -9.31871892982032, -17.247341958378044, -21.83341686419661, -12.659058099821545, -9.650618512404478, -9.96562566682145, -10.229077727214552, -14.025514592798975, -6.960819915320247, -12.383385568196497, -12.086512407291549, -8.795587039357322, -19.109363325360796, -11.115886800815222, -16.524575789064215, -7.624473883787043, -10.746461302193548, -14.188004134600751, -13.673698209175166, -15.658626831765782, -10.069899165450172, -9.61217631383709, -20.76679410099544, -7.9749123769546015, -2.191810662462492, -19.77606369591613, -15.600940819727528, -12.069980891227722, -9.404374253743669, -9.345688903241934, -19.83902651598814, -28.419516149761428, -8.501735380016754, -17.034225909351324, -17.609002180421697, -16.07251886093104, -13.205359344691683, -14.302253217771597, -8.654637271207308, -13.963521626102137, -22.239655491712302, -9.868912037122898, -8.345215704358036, -10.250464911069367, -10.415445716572824, -17.7517357602366, -15.667572132914694, -28.797646617589354, -15.74464659786517, -7.485222212729503, -9.821184866381273, -9.931527448560956, -2.8037412205123986, -6.203209446627715, -7.932339887885508, -12.71043856374147, -13.244557285616882, -8.59063173471898, -5.438532798171551, -8.099903428584804, -14.799219822381735, -18.918142768148808, -13.72832333058717, -22.515282922584838, -11.512599588740061, -20.763333589061045, -12.118136312203676, -17.397990065851992, -8.159627520504893, -7.703879659013644, -5.441872606280487, -18.630968721391458, -11.510156783314772, -8.218194666614599, -15.175747699449326], "policy_policy_agent__reward": [3.3196339822572525, 3.3196339822572525, 7.657480087102501, 7.657480087102501, 1.4220906526820278, 1.4220906526820278, 4.403664840806462, 4.403664840806462, -2.2123479311974124, -2.2123479311974124, 10.837745924312866, 10.837745924312866, 7.707689927838075, 7.707689927838075, 3.7296393183796046, 3.7296393183796046, 7.046173131219538, 7.046173131219538, 3.9068223715748958, 3.9068223715748958, 3.067867827142523, 3.067867827142523, 7.372212900486956, 7.372212900486956, 8.38636583677889, 8.38636583677889, 10.65310063658617, 10.65310063658617, 4.257685420101599, 4.257685420101599, -2.695642081803778, -2.695642081803778, 2.2359574738257604, 2.2359574738257604, 5.485591119835173, 5.485591119835173, 8.970042066236047, 8.970042066236047, 1.5165455770419196, 1.5165455770419196, 3.5942769751565664, 3.5942769751565664, 12.666853416725926, 12.666853416725926, 11.228610112815247, 11.228610112815247, 4.870816426950812, 4.870816426950812, 11.970266686803042, 11.970266686803042, 3.789713244274746, 3.789713244274746, 5.4990943455677535, 5.4990943455677535, 6.9102031414350025, 6.9102031414350025, 2.148695885757274, 2.148695885757274, 2.973481375407757, 2.973481375407757, 6.322972955711049, 6.322972955711049, 4.2623633215562755, 4.2623633215562755, 3.671911224158208, 3.671911224158208, 5.264970651441825, 5.264970651441825, 3.375131419770929, 3.375131419770929, 7.142736579129896, 7.142736579129896, 4.380175047481191, 4.380175047481191, 3.145915006123169, 3.145915006123169, 4.303088735136127, 4.303088735136127, 3.499655022998867, 3.499655022998867, 2.9021932040778187, 2.9021932040778187, 6.285699482503734, 6.285699482503734, 5.892611936045187, 5.892611936045187, 4.955241747493161, 4.955241747493161, 9.160817520264956, 9.160817520264956, 8.162353760681892, 8.162353760681892, 5.933311448499241, 5.933311448499241, 10.0927258450168, 10.0927258450168, 2.791894846102253, 2.791894846102253, 3.3522061835582386, 3.3522061835582386, 3.607074489995731, 3.607074489995731, 9.674090028735014, 9.674090028735014, 2.808169371831471, 2.808169371831471, 10.42151851054746, 10.42151851054746, 11.887399097947883, 11.887399097947883, 4.694738961249861, 4.694738961249861, 11.394717399036548, 11.394717399036548, 11.921403649294916, 11.921403649294916, 7.474201173109059, 7.474201173109059, 6.685971481892385, 6.685971481892385, 4.578494133912463, 4.578494133912463, 10.377785652218469, 10.377785652218469, 15.08115714655613, 15.08115714655613, 4.222644363184699, 4.222644363184699, 3.1170866490212368, 3.1170866490212368, 3.895408750649173, 3.895408750649173, 4.265788119081647, 4.265788119081647, 8.296045456023498, 8.296045456023498, -1.8566224206486848, -1.8566224206486848, 7.331172617084425, 7.331172617084425, 9.18187069454245, 9.18187069454245, 3.951626847361034, 3.951626847361034, 10.553753592456887, 10.553753592456887, 7.367915746159743, 7.367915746159743, 10.929524801769661, 10.929524801769661, 2.3063584294971173, 2.3063584294971173, 2.2796910348972537, 2.2796910348972537, 9.318062617051684, 9.318062617051684, 8.059621461277093, 8.059621461277093, 7.692895388117945, 7.692895388117945, 0.6700023808338128, 0.6700023808338128, 5.925367485157981, 5.925367485157981, 7.5219515622412505, 7.5219515622412505, 3.734161831554017, 3.734161831554017, -0.33330340995277097, -0.33330340995277097, 13.548763118469584, 13.548763118469584, 10.244151281866747, 10.244151281866747, 3.298618641675876, 3.298618641675876, 1.706734846361823, 1.706734846361823, 5.781171827195252, 5.781171827195252, 9.77008501007841, 9.77008501007841, 16.028703706051434, 16.028703706051434, 5.581816965215233, 5.581816965215233, 8.016560343738366, 8.016560343738366, 4.85054348400855, 4.85054348400855, 9.667151482733999, 9.667151482733999, 6.383545227390652, 6.383545227390652, 11.755505714459101, 11.755505714459101, 1.0963229622238397, 1.0963229622238397, 6.033809333489162, 6.033809333489162, 11.0890173861228, 11.0890173861228, -1.1004483199468484, -1.1004483199468484, 4.457807735315518, 4.457807735315518, 7.129516270825191, 7.129516270825191, 5.978873749166124, 5.978873749166124, 11.217374556847586, 11.217374556847586, 12.696889203226378, 12.696889203226378, 16.468856836046857, 16.468856836046857, 1.964713167882295, 1.964713167882295, 1.0868500818103293, 1.0868500818103293, 3.4092076115220933, 3.4092076115220933, 2.765300900019385, 2.765300900019385, 0.16913220374840357, 0.16913220374840357, 2.196548579097547, 2.196548579097547, 0.5775092278851528, 0.5775092278851528, 7.209010029246449, 7.209010029246449, 3.048191025550984, 3.048191025550984, 3.060889434049567, 3.060889434049567, 0.24731095177367435, 0.24731095177367435, 4.67884881171849, 4.67884881171849, 5.938384340143432, 5.938384340143432, 12.079025931649138, 12.079025931649138, 10.144874916433476, 10.144874916433476, 18.42364674746309, 18.42364674746309, 1.9611011761240182, 1.9611011761240182, 9.239988554507164, 9.239988554507164, 6.068497209348068, 6.068497209348068, 13.336053173293788, 13.336053173293788, 3.3502745075793583, 3.3502745075793583, 0.6990395575969824, 0.6990395575969824, 2.1950804245236775, 2.1950804245236775, 6.39963095640632, 6.39963095640632, 3.3103351378309647, 3.3103351378309647, 1.88933855310224, 1.88933855310224, 10.532425590810542, 10.532425590810542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865930799257659, "mean_inference_ms": 2.155395622670312, "mean_action_processing_ms": 0.0983845394596804, "mean_env_wait_ms": 0.5902805098088408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 148500, "timesteps_this_iter": 0, "agent_timesteps_total": 445500, "timers": {"sample_time_ms": 12230.578, "sample_throughput": 275.948, "load_time_ms": 0.501, "load_throughput": 6742772.221, "learn_time_ms": 1703.445, "learn_throughput": 1981.279, "update_time_ms": 21.202}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 17.35948963165283, "policy_loss": -0.0035583239106927065, "vf_loss": 17.37256736755371, "vf_explained_var": -0.06525417566299438, "kl": 0.006722512299127237, "entropy": 0.9519520103931427, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 5.009890174865722, "policy_loss": -0.009304807876469567, "vf_loss": 5.02826681137085, "vf_explained_var": 0.21076025068759918, "kl": 0.004470878045594695, "entropy": 0.9085727453231811, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148500, "num_agent_steps_sampled": 445500, "num_steps_trained": 148500, "num_agent_steps_trained": 445500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5940, "training_iteration": 44, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-48", "timestamp": 1706105928, "time_this_iter_s": 10.889168977737427, "time_total_s": 548.4563369750977, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E8FEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 548.4563369750977, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 26.414285714285715, "ram_util_percent": 74.02857142857144, "gpu_util_percent0": 0.03000000000000001, "vram_util_percent0": 0.21803501674107142}}
{"episode_reward_max": 12.684794289114135, "episode_reward_min": -18.92263677666574, "episode_reward_mean": 0.1975247710509533, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.724349073969073, "policy_agent_": -0.9813005185064454}, "policy_reward_max": {"policy_adversary_": -5.150721570053708, "policy_agent_": 17.10819569427877}, "policy_reward_mean": {"policy_adversary_": -13.814297820933062, "policy_agent_": 7.005911295992007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5058446267233678, -0.7002697828631207, 1.7948375362726494, 2.587402142495946, 0.5532852385716105, 2.498829905666941, -2.496558204488788, 4.948297679907061, -6.837484033323154, -8.949647804832281, -11.508457517601224, -2.7690976783206827, 2.027385534607011, 0.8221454207060777, 1.1374691650850712, 4.100870396532376, 4.854229141358398, 4.942997190375079, -0.965691075826753, 0.5570515825712157, 1.6494473883888323, -1.0974652081987761, 4.614341181786375, 9.534051817869962, 0.9430005478925529, -1.7944937631610371, 0.7771382509079452, -0.057753982201012244, -11.882645271435132, 0.7715874273314902, -6.149876619614974, 3.305012332289437, -3.5060423282332334, 1.880729724742371, -7.73241117097206, -14.259459287652245, 4.225486724484277, -12.699010909093552, 11.672101848700207, -1.7337567947853483, 11.124534728769559, -5.377253517793054, -1.2025825770581897, 2.7830989496226333, -4.031447193995525, -8.127141806117365, -0.8301434878295981, -2.245710108114504, -0.13858021756854322, 3.9061548207213046, 0.4504011725210344, -5.056977768148291, -2.605294072595059, 5.154578389796657, 5.829925213304099, 2.2737681881871312, 7.7682154011559055, -4.051823232151495, 5.2688739850422985, -4.0501118978136645, 1.87972952539752, -1.6791036933216712, -1.0699666734248519, 2.9603547540075525, -2.3538906050535826, 2.9266612053928984, -4.502043626385845, 5.439727758150678, 2.8487451159587707, 6.796150697583263, -0.766339909167393, 10.644717125914703, 1.915802958085845, 1.9863344161605656, -1.4973063117743832, -4.410041300569864, 5.267378798886751, -5.088414691460701, 1.9267918112945002, 12.416656271129565, 11.13806303771296, 4.597128661134724, 1.1528102763759307, -9.540120416596965, 2.686732051838203, -11.868269247482107, 8.613342510372705, 5.200418041359541, -0.023766262902110702, 9.468591210218237, 12.684794289114135, 4.941875234708325, -1.5927766351448889, -2.0183437043453676, -1.9576032404675203, 3.881908464414047, -2.1518539122441354, 1.0378100297353465, -10.286527636987405, -15.784844778559016, 1.4130842081583614, -8.360195910290608, 5.687003902629057, 0.5307071686529596, 8.26949810339823, -0.14457537243963034, -18.92263677666574, 5.104224462818206, -1.9410016398748096, -2.2500320537721756, 3.7132492839500406, 3.963763457069524, -7.647948165610005, 2.627674968600412, -0.9265603944179841, 2.0857205192552146, 0.706253459205455, -7.948392043447281, -2.1415188571622137, -3.0436089560477684, 4.4778609386472645, -7.093405064124541, -5.004295895955365, 5.625401453839877, 2.0118986207726604, -5.189463466261008, 1.840309795609126, 1.2838068507544762, 1.5318026489092158, -4.444923189184938, 2.332486530743999, -0.9346620140285574, 5.703573233463564, 7.4693999000331175, 8.054126442993397], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.465198074390125, -8.88946714567155, -17.25772485530878, -11.143018817507663, -9.4501589684927, -12.910435022451603, -15.447783790882182, -21.371555947440083, -7.845954125681829, -14.344410043115877, -10.435931495091417, -19.78105013328406, -18.710160368651547, -16.559768604401864, -10.893020712799457, -10.06766272635487, -11.186326931703464, -13.149423602845472, -19.592686205042206, -14.743764417884261, -6.442709367112743, -22.725989112691092, -13.613154306143159, -19.267226207129053, -14.391398668712956, -8.0034917058153, -12.501942415686447, -9.386826197247412, -9.920044234422228, -19.5190136996506, -8.116255245950327, -8.674346117900493, -7.470467119494914, -7.259325940917578, -7.516652866377762, -26.227744805654496, -16.91455339288988, -16.05852115377577, -18.826032524886553, -8.26338126358414, -16.767106308105426, -12.068854230191468, -13.473977429654273, -15.652667816375127, -6.686174412415498, -20.014697134640635, -9.810778677002848, -7.7218680397224, -8.504626822605886, -10.313396213538851, -8.195696065879003, -14.880354143111228, -7.034513483446577, -16.076589380371924, -21.392177395528275, -9.527071900937077, -12.519203416360465, -5.150721570053708, -10.825269529039364, -7.343289897444191, -9.769810287589426, -8.13121571060774, -12.789045437090092, -9.556499525944401, -9.82792374903355, -12.308508985831798, -8.93917541952999, -10.903244322847026, -20.908870817770026, -20.698726238005708, -28.724349073969073, -15.543927749145638, -21.056484789314634, -20.90783688072164, -11.28608818324632, -10.247343625282562, -12.844307921132344, -6.98886653216485, -10.617814418738714, -21.79973511742798, -16.091747342201455, -21.99643967154475, -14.233586916824258, -15.294117213784364, -10.329599469517612, -14.599791715275327, -16.80275499451792, -10.636980936969568, -14.369421074663988, -22.019294134426584, -21.344918715180988, -12.601037681806286, -15.32606846382967, -26.363154237224514, -21.804249658544013, -9.191401017610865, -10.581839928837665, -8.088745705955391, -14.889532586680417, -25.386932230438838, -8.04914753851124, -20.491644324556255, -14.063250261730708, -12.842930389880353, -14.453879036583754, -5.960747578133517, -23.743701087190473, -17.40893906648258, -12.680561781782103, -10.725964923726695, -19.98767883630228, -10.05635131073712, -19.104519338989302, -18.61892100687608, -14.848807916185947, -16.351581391951814, -8.249931632156443, -6.911795732628518, -16.128591287949654, -13.861604498448104, -15.331627275574958, -19.1504019710547, -13.660499349853632, -26.92875867520657, -12.271613115827824, -5.986381813204215, -19.277935528723404, -7.019290378485165, -11.258086538048094, -18.929377571386915, -9.462068713658908, -6.550308123032778, -14.8087913102225, -13.478146342141365, -15.171369496043006], "policy_policy_agent__reward": [3.4855213505567475, 3.4855213505567475, 4.0945986814042135, 4.0945986814042135, 9.526281195790714, 9.526281195790714, 6.865210480001805, 6.865210480001805, 5.001722103532156, 5.001722103532156, 7.704632464059271, 7.704632464059271, 6.475612793196696, 6.475612793196696, 13.159926813673572, 13.159926813673572, 0.5042350461793358, 0.5042350461793358, 2.6973811191418005, 2.6973811191418005, -0.5362630112549058, -0.5362630112549058, 8.505976227481685, 8.505976227481685, 10.368772951629271, 10.368772951629271, 8.690957012553971, 8.690957012553971, 6.015244938942265, 6.015244938942265, 7.08426656144362, 7.08426656144362, 8.020278036530932, 8.020278036530932, 9.046210396610276, 9.046210396610276, 9.313497564607726, 9.313497564607726, 7.6504080002277375, 7.6504080002277375, 4.046078377750788, 4.046078377750788, 10.814261952246156, 10.814261952246156, 9.113747743964765, 9.113747743964765, 14.400639012499504, 14.400639012499504, 7.667199608302752, 7.667199608302752, 3.104498971327131, 3.104498971327131, 6.639540333297192, 6.639540333297192, 4.6645361075232, 4.6645361075232, -0.9813005185064454, -0.9813005185064454, 10.145300563491045, 10.145300563491045, 0.9831893131676779, 0.9831893131676779, 5.989679225094965, 5.989679225094965, 1.9822123956308422, 1.9822123956308422, 4.570027832829975, 4.570027832829975, -0.10787915229714508, -0.10787915229714508, 5.984142759001135, 5.984142759001135, 10.570020058687073, 10.570020058687073, 1.6797551223411145, 1.6797551223411145, 15.249067186793383, 15.249067186793383, 3.264812234399397, 3.264812234399397, 13.945820518437493, 13.945820518437493, 3.3458003561992076, 3.3458003561992076, 6.135697426298039, 6.135697426298039, 9.217883382998878, 9.217883382998878, 1.327363609209988, 1.327363609209988, 5.943777664261638, 5.943777664261638, 4.490317594586626, 4.490317594586626, 2.7380789658039477, 2.7380789658039477, 4.183023302518671, 4.183023302518671, 7.109775517130077, 7.109775517130077, 4.32304861920002, 4.32304861920002, 4.911688187481469, 4.911688187481469, 2.2146097054257585, 2.2146097054257585, 10.615583885084291, 10.615583885084291, 13.611051304416186, 13.611051304416186, 5.900420044562105, 5.900420044562105, 10.14370940875819, 10.14370940875819, 0.5494491689511067, 0.5494491689511067, 8.047071757040829, 8.047071757040829, 1.6465889998152647, 1.6465889998152647, 5.82476990649347, 5.82476990649347, 3.226056008643035, 3.226056008643035, 5.859539381832621, 5.859539381832621, 6.258427139975977, 6.258427139975977, 3.7370165719899844, 3.7370165719899844, 7.6175850956123465, 7.6175850956123465, 2.218565896572073, 2.218565896572073, 8.171486040498852, 8.171486040498852, 11.878807966864397, 11.878807966864397, 13.747438467794487, 13.747438467794487, 13.979004582400849, 13.979004582400849, 13.094322437530172, 13.094322437530172, 11.486143873700241, 11.486143873700241, 11.447085648441103, 11.447085648441103, 4.89439093573597, 4.89439093573597, 2.918651162356348, 2.918651162356348, 9.055843360009549, 9.055843360009549, 0.9502259203520728, 0.9502259203520728, 6.272303115016604, 6.272303115016604, 17.10819569427877, 17.10819569427877, 13.614905189957208, 13.614905189957208, 13.296784166339732, 13.296784166339732, 7.693198596600095, 7.693198596600095, 2.8769983985936984, 2.8769983985936984, 6.5081657606779055, 6.5081657606779055, 1.3657612338966107, 1.3657612338966107, 12.708048752445306, 12.708048752445306, 7.918699489164555, 7.918699489164555, 7.1728274058809385, 7.1728274058809385, 15.743942672322412, 15.743942672322412, 17.014856502147563, 17.014856502147563, 8.771456458257305, 8.771456458257305, 6.86664591434239, 6.86664591434239, 12.172405266439572, 12.172405266439572, 9.923323209038248, 9.923323209038248, 6.536654741012457, 6.536654741012457, 4.214993008296765, 4.214993008296765, 4.563277867845369, 4.563277867845369, 2.301502474846506, 2.301502474846506, 4.801043725939911, 4.801043725939911, 4.731115873334801, 4.731115873334801, 6.065724207132827, 6.065724207132827, 9.875127082179878, 9.875127082179878, 6.686818779266657, 6.686818779266657, 11.361688569990994, 11.361688569990994, 2.908086102846943, 2.908086102846943, 2.4105321552623655, 2.4105321552623655, 11.256581764650393, 11.256581764650393, 5.369780070953647, 5.369780070953647, 4.23796643497726, 4.23796643497726, 11.850464060126157, 11.850464060126157, 7.0100573839033204, 7.0100573839033204, 5.728285586689652, 5.728285586689652, 10.623297987738244, 10.623297987738244, 6.961123760883983, 6.961123760883983, 9.218650955603522, 9.218650955603522, 4.478092545680948, 4.478092545680948, -0.5182981554093826, -0.5182981554093826, 6.993536215393717, 6.993536215393717, 5.408997771200168, 5.408997771200168, 9.90474410711111, 9.90474410711111, 6.02849845346508, 6.02849845346508, 4.328101726949133, 4.328101726949133, 16.277080064523222, 16.277080064523222, 7.141755868300242, 7.141755868300242, 0.398459173471603, 0.398459173471603, 10.559122662166263, 10.559122662166263, 4.15154861461982, 4.15154861461982, 6.3949445934786535, 6.3949445934786535, 7.242227191100984, 7.242227191100984, 5.897277622201455, 5.897277622201455, 2.8078230545021094, 2.8078230545021094, 10.256182271843032, 10.256182271843032, 10.473773121087243, 10.473773121087243, 11.612747969518203, 11.612747969518203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28599967622753186, "mean_inference_ms": 2.150004547881959, "mean_action_processing_ms": 0.09825461903689853, "mean_env_wait_ms": 0.588937083380929, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 151875, "timesteps_this_iter": 0, "agent_timesteps_total": 455625, "timers": {"sample_time_ms": 12244.558, "sample_throughput": 275.633, "load_time_ms": 0.501, "load_throughput": 6742772.221, "learn_time_ms": 1704.642, "learn_throughput": 1979.888, "update_time_ms": 21.349}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 21.438137245178222, "policy_loss": 0.007819791091606021, "vf_loss": 21.43948974609375, "vf_explained_var": -0.08182281255722046, "kl": 0.003197092323516726, "entropy": 0.9172515273094177, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 5.948804163932801, "policy_loss": -0.014279692620038986, "vf_loss": 5.971777081489563, "vf_explained_var": 0.2124721348285675, "kl": 0.006600636447524103, "entropy": 0.8703556478023529, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 151875, "num_agent_steps_sampled": 455625, "num_steps_trained": 151875, "num_agent_steps_trained": 455625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6075, "training_iteration": 45, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-18-59", "timestamp": 1706105939, "time_this_iter_s": 11.170145511627197, "time_total_s": 559.6264824867249, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 559.6264824867249, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.133333333333333, "ram_util_percent": 74.07333333333332, "gpu_util_percent0": 0.030000000000000013, "vram_util_percent0": 0.21735026041666666}}
{"episode_reward_max": 17.072851547339813, "episode_reward_min": -19.86809930329553, "episode_reward_mean": -0.3819316902005606, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.343693107012015, "policy_agent_": -2.6161155524653483}, "policy_reward_max": {"policy_adversary_": -2.8973098575160514, "policy_agent_": 22.9470855722679}, "policy_reward_mean": {"policy_adversary_": -12.89878640660362, "policy_agent_": 6.258427358201527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.644645650591221, -1.3949385910591499, 10.761386296289267, -7.390489082982932, 0.04961689168150585, -6.0540608931893525, 2.3989500051187247, -4.803878224211586, 5.208551072856865, -7.664489489827094, 2.4028601924301194, 3.8709325312532994, 0.6129534733065373, -3.1187228994680254, 6.933710103114434, -3.924906501735605, -13.562147236251082, -6.20342238677247, 7.158897331391499, -1.00871768738153, 1.7459629419868699, 4.483439585224017, -4.59379875228291, -7.084737400280546, 2.856300422176601, -2.9073138052318495, 2.351858070005391, -4.14957060031979, 0.3129584627845746, -7.537429750477845, 3.8482045985105815, -9.131235348929216, -3.7080751473635836, 5.420013388215048, -5.311596136016808, 1.4350088639267666, 0.4078623447340595, -2.8230777545784416, 1.8577337009930364, 9.71758357039956, 5.528986182629694, -3.7870521800746646, 2.569036233173209, -4.572951717976033, -0.26790451752961875, -4.74714451534335, -4.948520420087815, -4.152782174943987, -1.859998224210945, -3.117616058618744, 1.8646241745237768, 5.66962926041952, 4.979390978477483, -6.198614948255115, 3.2919769337459863, -4.389150070571059, 12.886835852235455, -3.100858298877706, 9.41817017391048, -6.5959788867613165, 6.75914945949777, 0.6829331152459958, 2.768220818750763, -2.2173275003273933, -2.8011257945308348, -0.2646816562103597, -1.3955706187121546, -3.797165462989646, 1.5372737835694825, 0.3151409591480434, 8.290449405037775, -1.8258673691762142, -0.3120533050138041, -11.865820919083351, -1.9267408899667484, 2.9719734814505205, 2.4201569522742066, -16.329356987239187, 17.072851547339813, 0.26184748347015596, 0.45548080315400324, -2.2257655114579835, 3.164267198505745, -12.260872741232506, 5.991111056372615, -2.2865792278143613, -5.5981518448910785, -7.281632468255848, -2.375941928213361, 3.726457635529008, 3.204342579203152, -5.227798059432221, 6.643715386315662, -9.9137475551064, 1.2405358896197025, 10.228307843840911, 2.1568543905257482, 1.3239529492296218, -3.7966872693119544, -0.3766188268608235, -1.198675245196892, -0.25417013381174636, 2.4724748250714312, -0.54913793260374, -0.013303704440046304, 1.017866567040081, -3.553092122959331, 2.7388296168430974, 2.662368361818985, -6.163266589636815, 0.5931581207995984, 3.8215652166862073, 10.952166065388282, -19.86809930329553, 3.2929399265969694, 2.201943011941307, 13.795853052451065, 0.8465233715271901, -3.520168414035906, -5.6954848368203095, 0.6540817253583142, -7.465374349221649, -7.496682693535557, 4.042036673568532, -6.036379934106998, -6.227455303867273, 2.371465155008201, 3.3705497809809626, 3.075048082991816, 1.9380227461604684, 3.7548086762985626, 1.5555476916301694, -6.721741201947362, -0.32422020880599367, -0.3431912577016287], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.343535245451092, -4.776192943451416, -18.796541872295464, -7.914804462551719, -17.63384776752269, -8.835622682891662, -8.558652012569024, -18.242354171949934, -17.793121660441535, -16.7651755016971, -12.884424951423748, -19.70185198041066, -7.2453545198208165, -8.299460408517362, -19.57745424730029, -9.800393614860035, -14.73835348477159, -30.343693107012015, -16.921533029748954, -6.804649580417358, -10.528640429978301, -20.271318001022163, -16.461846970458748, -13.268909490146969, -11.339385514751378, -11.308423699941429, -17.58764243225926, -8.625905637313608, -11.850776394954265, -10.035488059282386, -12.371496388708081, -9.295148824316913, -13.057240226057814, -19.287015969923463, -20.937350638270516, -7.623293183500871, -10.829852129136047, -19.82734612557833, -12.63157987529545, -14.684534595742813, -13.196308126357827, -9.182467006552061, -10.00155738391796, -6.885359078602091, -11.04483060884365, -14.294730678538514, -19.36448649180934, -8.769157477760208, -15.544756613264015, -7.639854850207031, -7.659314029320357, -14.88101695762249, -11.126120120721602, -14.789470464328216, -11.723385283202134, -15.090912014067591, -28.00616155937448, -3.0458067567388474, -16.806974928145806, -5.1397366766924195, -17.695093540549863, -11.141487701740326, -15.964593088016958, -5.398326036379992, -11.924346687434813, -11.035983394381386, -13.143759058905152, -10.167497878626046, -10.374101136954728, -6.863071347546224, -20.14752832257806, -6.1076298745119635, -9.17757856947333, -16.18312915241154, -7.9182137823673, -9.666949595188344, -7.767331207870981, -11.097125882308484, -28.821319597195988, -9.086958059495245, -11.087773554255048, -10.005665698809512, -9.616106720302314, -23.025557618577174, -18.110260721809514, -6.051038486626182, -6.483275076674672, -17.772173265631565, -6.521045053254942, -14.320387006225456, -11.063260357174396, -16.426126853753967, -13.593751515915951, -8.4834422182531, -16.28185618446481, -17.638523102072483, -11.828114094016884, -8.744727399595025, -10.723741727761297, -8.293717049695838, -9.062033578821309, -25.783482030260366, -15.9228240532541, -10.67806752205756, -13.581383931920787, -5.517680141713889, -22.458511089896728, -14.242490370159816, -12.83020493077887, -14.942839824231436, -23.69264502200155, -18.32648017297244, -17.147300895084253, -21.913996272891254, -12.113051260076837, -18.837864834159223, -19.519265568386288, -11.738234475079008, -2.8973098575160514, -10.336026556713522, -11.613075573690576, -18.735641645116967, -8.00733372614941, -15.246373608681484, -6.197866739589994, -4.872232201689005, -10.870786120207791, -11.036992790729037, -17.150613104962083, -8.394698877243608, -8.691047027290322, -10.658109979772725, -6.279251533299379, -15.37202735136891, -11.923235667105079], "policy_policy_agent__reward": [4.494090448021156, 4.494090448021156, 1.6906271761961336, 1.6906271761961336, 14.778964084292362, 14.778964084292362, 0.2621576897843937, 0.2621576897843937, 8.841732329602097, 8.841732329602097, 1.3907808948511549, 1.3907808948511549, 5.478801008843874, 5.478801008843874, 6.719237973869178, 6.719237973869178, 11.5008363666492, 11.5008363666492, 4.550343005935001, 4.550343005935001, 7.643642571926936, 7.643642571926936, 11.786392255831984, 11.786392255831984, 3.929153996563676, 3.929153996563676, 2.590368754524669, 2.590368754524669, 13.255582175207357, 13.255582175207357, 2.937743556562212, 2.937743556562212, 0.5881031242602558, 0.5881031242602558, 12.070135360119775, 12.070135360119775, 12.040215180570222, 12.040215180570222, 2.897965946517915, 2.897965946517915, 6.137301685982586, 6.137301685982586, 12.377378793123095, 12.377378793123095, 5.934024109087916, 5.934024109087916, 3.092086044933209, 3.092086044933209, 7.097842968463991, 7.097842968463991, 4.200554947354793, 4.200554947354793, 9.969750251132329, 9.969750251132329, 2.2381675184969083, 2.2381675184969083, 6.08186742886942, 6.08186742886942, 1.2490291544022685, 1.2490291544022685, 8.109850493609327, 8.109850493609327, 0.08195673769384562, 0.08195673769384562, 4.674582539347114, 4.674582539347114, 12.353514679069253, 12.353514679069253, 7.812877251126852, 7.812877251126852, 4.529151023713818, 4.529151023713818, 5.618857236935053, 5.618857236935053, 8.502134185499946, 8.502134185499946, 7.244656788144245, 7.244656788144245, 12.201059083071186, 12.201059083071186, 9.362647154493754, 9.362647154493754, 2.6977074132386956, 2.6977074132386956, 6.285296808545586, 6.285296808545586, 1.1562036803130291, 1.1562036803130291, 5.3884630456570175, 5.3884630456570175, 4.773793081597583, 4.773793081597583, 7.207983035860761, 7.207983035860761, 2.3081876514081094, 2.3081876514081094, 6.842379194526536, 6.842379194526536, 2.2611193957941436, 2.2611193957941436, 4.761969101922065, 4.761969101922065, 10.275323109021004, 10.275323109021004, 8.052755549599542, 8.052755549599542, 4.295427758036548, 4.295427758036548, 7.507681108474059, 7.507681108474059, 5.3508809717482695, 5.3508809717482695, 20.446498705804967, 20.446498705804967, -0.027525771069429564, -0.027525771069429564, 13.112572551028142, 13.112572551028142, -0.7281211050344478, -0.7281211050344478, 12.227121500023818, 12.227121500023818, 5.912210408493164, 5.912210408493164, 9.366406953383857, 9.366406953383857, 1.5904992680263, 1.5904992680263, 4.561610446451988, 4.561610446451988, 5.385650869085514, 5.385650869085514, 5.8740942200965, 5.8740942200965, 3.1851662078181993, 3.1851662078181993, 5.955687460262106, 5.955687460262106, 3.589106153347134, 3.589106153347134, 14.218988863807914, 14.218988863807914, 2.1408812526678753, 2.1408812526678753, 4.432762632229761, 4.432762632229761, 2.1586541166640902, 2.1586541166640902, 2.9957364462002753, 2.9957364462002753, 6.319461538319431, 6.319461538319431, 5.093744080072595, 5.093744080072595, -2.6161155524653483, -2.6161155524653483, 22.9470855722679, 22.9470855722679, 4.674402771482698, 4.674402771482698, 5.771627178704527, 5.771627178704527, 3.8899500936757656, 3.8899500936757656, 6.390186959404028, 6.390186959404028, 5.382342438672335, 5.382342438672335, 12.050685889091065, 12.050685889091065, 1.8822296294059104, 1.8822296294059104, 0.4425616158917979, 0.4425616158917979, 5.245270398687858, 5.245270398687858, 2.0725515625207906, 2.0725515625207906, 9.023422320877234, 9.023422320877234, 7.133801468188775, 7.133801468188775, 5.599164397160873, 5.599164397160873, 10.118733451115807, 10.118733451115807, -0.7151526684266514, -0.7151526684266514, 8.76119603704226, 8.76119603704226, 13.933415472956698, 13.933415472956698, 6.992484242271314, 6.992484242271314, 5.034340174412323, 5.034340174412323, 3.463527229224672, 3.463527229224672, 3.958549111417507, 3.958549111417507, 3.9316791668122075, 3.9316791668122075, 12.764655948224313, 12.764655948224313, 9.197649439162767, 9.197649439162767, 5.06446479472691, 5.06446479472691, 6.784040113740368, 6.784040113740368, 3.2677733543769847, 3.2677733543769847, 9.4527094834687, 9.4527094834687, 8.490659993501454, 8.490659993501454, 7.746286646298926, 7.746286646298926, 4.38978661729731, 4.38978661729731, 12.142901571400575, 12.142901571400575, 11.074022694829317, 11.074022694829317, 14.049733480236268, 14.049733480236268, 1.0229484847978636, 1.0229484847978636, 7.702995593336903, 7.702995593336903, 10.519903923050263, 10.519903923050263, 16.657559310418684, 16.657559310418684, 6.292378923303101, 6.292378923303101, -0.31142927825992683, -0.31142927825992683, 2.3202708599466044, 2.3202708599466044, 6.133578649524445, 6.133578649524445, 5.635133647947664, 5.635133647947664, 0.25532551630692707, 0.25532551630692707, 9.644205141125008, 9.644205141125008, 0.08074340274149608, 0.08074340274149608, -0.6776115510891338, -0.6776115510891338, 6.621125637607994, 6.621125637607994, 7.203771285855, 7.203771285855, 10.112830593976948, 10.112830593976948, 5.166360811702036, 5.166360811702036, 6.222927851794443, 6.222927851794443, 6.1068288357014495, 6.1068288357014495, -0.22124483432399059, -0.22124483432399059, 7.5239035712814575, 7.5239035712814575, 5.790022204701726, 5.790022204701726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28526965958435796, "mean_inference_ms": 2.143949365264802, "mean_action_processing_ms": 0.0978007295797082, "mean_env_wait_ms": 0.5874548439391133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 155250, "timesteps_this_iter": 0, "agent_timesteps_total": 465750, "timers": {"sample_time_ms": 12204.022, "sample_throughput": 276.548, "load_time_ms": 0.5, "load_throughput": 6743414.634, "learn_time_ms": 1697.86, "learn_throughput": 1987.796, "update_time_ms": 21.446}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 19.71502513885498, "policy_loss": 0.002919975365512073, "vf_loss": 19.72113094329834, "vf_explained_var": -0.0734593152999878, "kl": 0.005161916080365472, "entropy": 0.9025123000144959, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 5.588197541236878, "policy_loss": -0.003985006513539701, "vf_loss": 5.601015996932984, "vf_explained_var": 0.2536249697208405, "kl": 0.005303306947800668, "entropy": 0.8841736793518067, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 155250, "num_agent_steps_sampled": 465750, "num_steps_trained": 155250, "num_agent_steps_trained": 465750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6210, "training_iteration": 46, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-19-10", "timestamp": 1706105950, "time_this_iter_s": 10.875227928161621, "time_total_s": 570.5017104148865, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D01820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 570.5017104148865, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 27.857142857142858, "ram_util_percent": 73.93571428571428, "gpu_util_percent0": 0.06071428571428571, "vram_util_percent0": 0.2171630859375}}
{"episode_reward_max": 15.290086584923413, "episode_reward_min": -20.31926354932955, "episode_reward_mean": -0.6809861560348693, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.762380509453507, "policy_agent_": -2.883423664062029}, "policy_reward_max": {"policy_adversary_": -4.123655841370168, "policy_agent_": 21.150329761776437}, "policy_reward_mean": {"policy_adversary_": -12.713549802110412, "policy_agent_": 6.016281823037772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.9899848270309946, -4.387817444318718, 0.7624370606896638, -2.5417791360127944, 4.7614059910152395, -11.521338555239787, 3.097141335494108, 3.0235200339742274, -4.932772463980685, -20.31926354932955, -9.947566793593536, -0.6934292629976955, 12.538279014099379, -6.057797967269434, -0.7621625387624373, -3.1255089395203393, 4.3980280714688345, 0.9362494513155639, -4.755269304280615, -7.1415746007282666, -8.145904148701094, -5.547210316608042, -0.38403782069952386, 2.159067370441772, 3.7083088228994283, -2.3964527131339364, 7.672482686668583, 0.231265642428061, -3.3109431732883086, 3.8100478724574725, -0.8463850667573327, 1.3101301424395262, -5.231558029609125, -0.6071754600388222, -9.326534565812981, -2.89278554998551, 1.2480447856541304, 1.4529332483303345, -1.3275869014285075, -9.237715377755016, 3.083193082095138, 6.873737346040433, 0.26081373955821274, 4.851348442511714, -0.7114026898848127, -9.66074689086817, -10.164742637942679, -0.6321382891456974, 5.677913601153231, 0.4895070444299823, 0.49266389919218057, -9.13893220517901, -2.17487545653887, -14.693071908040798, 2.2036800948496658, 2.050850356709674, 2.7554551377605545, 8.992779579182091, -0.08299894710040823, -7.172428046605873, -4.378276945103288, -5.785495115388183, -7.787125392756678, -1.5297641769652153, 3.591071454738585, 1.2423379627485391, 9.90995183825886, -4.259707603145507, 11.584259194367975, -15.069270652457995, 8.829134255830589, -0.9584539358366708, -13.794348381344204, -0.1509669479094311, -1.0488571236035913, 9.855300535973337, -0.9338389722266262, 5.724594201334645, 1.2455916380426761, -2.9694241671226287, 4.812896077011165, 1.8268823553773699, -3.7835238181443835, 1.9683219340437978, 1.2573509878859472, 7.071188102110231, -1.9686277821830998, 4.190935648667495, 1.1751283904645327, 9.76927251483949, 6.828230316773524, 1.6018927703734869, 7.3687472792757065, 4.614303154923656, -3.242567162576502, -3.4832446546100795, 2.0064118376089533, 8.667121562742052, 3.562517665332247, 3.005007467120087, 15.290086584923413, -1.6179728405192206, 0.6451810727253429, 2.6330136152597774, -0.9478664994147747, 0.37618945289111494, -3.7326694633576354, 2.7941333533459374, -1.9623680168131876, -0.861716151964177, 3.099660501707119, 11.917625606530018, -1.990786376583928, -8.885022992092045, -2.5193824951241854, -10.576320444864812, -0.3332600590205378, -0.5599346950829978, 0.5309958071264658, -5.93363569715827, -11.381544773838291, -2.5443125804807987, -5.065860315894653, -3.858454525343936, 2.777019294840115, 5.803579496181188, -7.205116854291982, -5.122317684851231, -1.882614734007335, -5.154971962112781, -0.821093999443852, 0.5428572173197633, -7.915043579059393, -1.2522747301726158, -0.7632801852056834], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.600521750606744, -14.913328528084074, -13.23168616123823, -15.281094380722394, -24.238161620246547, -12.31296696072235, -11.799709708223363, -9.85583168759707, -10.417861534494087, -14.552416221205487, -14.865822184485504, -9.14132801238243, -29.762380509453507, -7.244796555607246, -9.341061442854537, -10.057723492025017, -12.551951852873776, -9.591405898392454, -12.402277081909785, -15.904741350331657, -4.715797609485158, -8.431607473070267, -4.682366162275213, -7.44158925515483, -9.83201708859096, -12.292101225833969, -16.743499349905832, -10.45005233429565, -9.656141617674715, -14.270239222252155, -7.426027231604278, -17.418424692677014, -12.618034818910832, -21.289374332114726, -11.63081089282481, -13.77302960117416, -12.130324171917279, -15.454999589724395, -10.454784785877628, -8.69817836222594, -12.982092425524108, -17.592003245612776, -14.1072247705751, -14.160169656791886, -16.908188561731645, -15.0278573606922, -9.741376293567772, -14.4527535259848, -12.996153184300285, -18.030324214998995, -8.867619713736996, -17.231299117784868, -4.123655841370168, -17.482489491188538, -13.664721993284106, -10.91192493760041, -15.761985043189041, -23.929580260696234, -11.051479812691877, -5.865852525808885, -15.322026911766509, -8.717926062572676, -14.972513783856323, -6.219100000817837, -16.45648249450719, -6.813386372115568, -21.403079974514338, -15.117538606725937, -21.29738467318779, -21.36428583358388, -16.964167042260605, -6.838509705124469, -10.494995677766694, -5.485025625381907, -10.906180896345717, -13.534331392342676, -17.069869094883742, -18.634553852324235, -14.679743359999634, -8.422711803118318, -12.980672196175728, -7.531458991687324, -8.724776394222085, -11.95033025848524, -9.713424011395652, -16.77498994189427, -10.780600895202742, -13.730245340008292, -8.72364631964936, -15.02479412570861, -15.131888070574275, -11.107632858644111, -20.381032044250095, -14.73649629196345, -8.928524245887475, -7.072363563488128, -6.5205278929198265, -18.531603001873737, -12.413936616189885, -16.314677095315943, -20.686156243463444, -8.30512355426392, -13.02524780561828, -10.66216854546744, -11.67139961296518, -15.89629492270258, -13.29703111686777, -15.761179278832566, -8.240029989307752, -8.076683432454775, -10.17733819933364, -20.314246409505014, -10.800645386893674, -17.291546681553513, -9.083502094615042, -18.375446308607383, -16.41243237011022, -9.624051933027578, -10.268263361540589, -9.776855169287206, -14.273155552291579, -17.78390328734012, -11.409586643121964, -7.649589547812604, -15.951930002889055, -11.5441074909245, -10.941084044289026, -6.112270893855624, -9.405983463195831, -9.298479099869942, -15.938242784129738, -10.330027277059656, -13.381152609831528, -9.31035647589345, -9.101059649074626], "policy_policy_agent__reward": [0.8052684617878754, 0.8052684617878754, 5.262755541882679, 5.262755541882679, 6.997061610963943, 6.997061610963943, 6.369657622354797, 6.369657622354797, 14.499783805630893, 14.499783805630893, 0.395814202741283, 0.395814202741283, 7.448425521858736, 7.448425521858736, 6.43967586078565, 6.43967586078565, 2.7425445352567017, 2.7425445352567017, -2.883423664062029, -2.883423664062029, 2.4591276954459813, 2.4591276954459813, 4.223949374692368, 4.223949374692368, 21.150329761776437, 21.150329761776437, 0.5934992941689066, 0.5934992941689066, 4.2894494520460515, 4.2894494520460515, 3.466107276252338, 3.466107276252338, 8.474989962171302, 8.474989962171302, 5.263827674854009, 5.263827674854009, 3.8235038888145856, 3.8235038888145856, 4.3815833748016955, 4.3815833748016955, -1.715053269607968, -1.715053269607968, 1.442198578231111, 1.442198578231111, 2.149164170787845, 2.149164170787845, 4.800328312798301, 4.800328312798301, 6.770162955745195, 6.770162955745195, 4.947824256350015, 4.947824256350015, 12.20799101828721, 12.20799101828721, 5.340658988361855, 5.340658988361855, 3.1725992221932033, 3.1725992221932033, 9.04014354735481, 9.04014354735481, 3.2898210824234724, 3.2898210824234724, 9.36427741755827, 9.36427741755827, 3.693238394650856, 3.693238394650856, 10.341099436037947, 10.341099436037947, 1.1521381635059131, 1.1521381635059131, 5.440122025594327, 5.440122025594327, 6.689184478785704, 6.689184478785704, 8.453966419027367, 8.453966419027367, 4.5635989422245595, 4.5635989422245595, -0.26976850776454253, -0.26976850776454253, 8.032642753809624, 8.032642753809624, 12.232870295826611, 12.232870295826611, 7.184019255066659, 7.184019255066659, 9.505759049651804, 9.505759049651804, 8.098392935923412, 8.098392935923412, 2.683555234912016, 2.683555234912016, -0.21168317218745192, -0.21168317218745192, 6.910307618419548, 6.910307618419548, 9.337033392726761, 9.337033392726761, 9.259915629714488, 9.259915629714488, 4.680141806464588, 4.680141806464588, 4.046183456302927, 4.046183456302927, 0.9743901924156496, 0.9743901924156496, 1.3947087915738798, 1.3947087915738798, 7.934201044066889, 7.934201044066889, 6.481387647155043, 6.481387647155043, 9.258720090474796, 9.258720090474796, 16.461179919939156, 16.461179919939156, 5.484240432795737, 5.484240432795737, -0.6532877603984925, -0.6532877603984925, 5.471874983331611, 5.471874983331611, 1.4662154735922472, 1.4662154735922472, 3.5926941955498224, 3.5926941955498224, 2.3446679119263107, 2.3446679119263107, 10.023776974622887, 10.023776974622887, 4.027862167432055, 4.027862167432055, 15.6565159063866, 15.6565159063866, 5.428915501790216, 5.428915501790216, 16.440821933777883, 16.440821933777883, 3.147507590562942, 3.147507590562942, 12.896650649045595, 12.896650649045595, 2.9400278846439005, 2.9400278846439005, -1.649676351788753, -1.649676351788753, 2.667029338736238, 2.667029338736238, 4.928661886371063, 4.928661886371063, 11.694815964158007, 11.694815964158007, 8.068015061328559, 8.068015061328559, 12.179574026829448, 12.179574026829448, 7.962667499021156, 7.962667499021156, 2.7266438179978447, 2.7266438179978447, 8.896784136593446, 8.896784136593446, 4.679170673532346, 4.679170673532346, 2.4706262880388516, 2.4706262880388516, 6.959326096264519, 6.959326096264519, 5.485387499640802, 5.485387499640802, 11.923089022002255, 11.923089022002255, 4.405986556509821, 4.405986556509821, 8.960590494337891, 8.960590494337891, 4.949387355056945, 4.949387355056945, 12.39703332027405, 12.39703332027405, 10.9800591936739, 10.9800591936739, 6.354762814508801, 6.354762814508801, 13.874889661762904, 13.874889661762904, 9.675399723443556, 9.675399723443556, 2.842978541655486, 2.842978541655486, 1.794559454439024, 1.794559454439024, 4.263469865264389, 4.263469865264389, 13.599362282307895, 13.599362282307895, 7.988227140761064, 7.988227140761064, 9.659842281218014, 9.659842281218014, 17.988121414193433, 17.988121414193433, 3.343575356872349, 3.343575356872349, 6.8352144391718115, 6.8352144391718115, 6.647591080363611, 6.647591080363611, 5.361766556775201, 5.361766556775201, 8.13624218779685, 8.13624218779685, 4.782180826755066, 4.782180826755066, 9.277656316089251, 9.277656316089251, 3.1388309862472834, 3.1388309862472834, 3.607483640245299, 3.607483640245299, 6.638499350520379, 6.638499350520379, 16.115936008017513, 16.115936008017513, 4.4049295051548745, 4.4049295051548745, 4.203261844730733, 4.203261844730733, 3.2820597997454275, 3.2820597997454275, 3.8995629318712846, 3.8995629318712846, 8.039586155544841, 8.039586155544841, 4.532058618972292, 4.532058618972292, 5.399629584333528, 5.399629584333528, 1.9216097360644675, 1.9216097360644675, 1.4458053892266447, 1.4458053892266447, 7.619795353429664, 7.619795353429664, 3.171863163613656, 3.171863163613656, 1.8955675112343338, 1.8955675112343338, 9.364474648864588, 9.364474648864588, 8.673843493552841, 8.673843493552841, 1.8679835949985197, 1.8679835949985197, 0.4949766045021935, 0.4949766045021935, 3.761684364594249, 3.761684364594249, 2.071753568878578, 2.071753568878578, 7.558574392342944, 7.558574392342944, 5.43644224718971, 5.43644224718971, 2.7330545153860695, 2.7330545153860695, 4.029040872860419, 4.029040872860419, 4.168889731934472, 4.168889731934472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2845015355624092, "mean_inference_ms": 2.1379580182663775, "mean_action_processing_ms": 0.09757977341650317, "mean_env_wait_ms": 0.586091085607316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 158625, "timesteps_this_iter": 0, "agent_timesteps_total": 475875, "timers": {"sample_time_ms": 12002.782, "sample_throughput": 281.185, "load_time_ms": 0.603, "load_throughput": 5598709.065, "learn_time_ms": 1674.615, "learn_throughput": 2015.388, "update_time_ms": 21.343}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 17.26515922546387, "policy_loss": 0.0058170710923150185, "vf_loss": 17.268044662475585, "vf_explained_var": -0.06163226366043091, "kl": 0.008306998520141768, "entropy": 0.8702339112758637, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 5.068744015693665, "policy_loss": -0.0171178481541574, "vf_loss": 5.09442138671875, "vf_explained_var": 0.2404759168624878, "kl": 0.0051138651449473774, "entropy": 0.8567546844482422, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 158625, "num_agent_steps_sampled": 475875, "num_steps_trained": 158625, "num_agent_steps_trained": 475875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6345, "training_iteration": 47, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-19-21", "timestamp": 1706105961, "time_this_iter_s": 10.903253078460693, "time_total_s": 581.4049634933472, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E8F310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 581.4049634933472, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.75, "ram_util_percent": 73.91428571428571, "gpu_util_percent0": 0.15714285714285706, "vram_util_percent0": 0.21784319196428573}}
{"episode_reward_max": 16.48155506316322, "episode_reward_min": -16.1027686277513, "episode_reward_mean": -0.3905304457601158, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -22.629602795400903, "policy_agent_": -1.8374328287484523}, "policy_reward_max": {"policy_adversary_": -3.9516653404908, "policy_agent_": 19.555578929282063}, "policy_reward_mean": {"policy_adversary_": -12.957697743552908, "policy_agent_": 6.283583648896395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.068189683400847, -1.5851258023388943, 1.3431008242517857, -5.00784745350102, 7.5102288463434075, 8.823541941572019, -7.153525712975191, -3.7728578128180423, 16.48155506316322, -1.3080702940337496, -11.492598241017385, 2.6962856758723643, 6.684286220367117, 2.9331544480825076, -0.5632030971807908, 1.6630188226760358, 5.350116575978081, 2.245824672957271, 8.448090447033202, 5.1385261242384335, -6.949767536852049, -0.4548913489564543, -1.3690254477508794, 2.5669198320154822, -0.9745283394059803, 2.4562323587883994, -13.485142336568757, 5.838683961519102, 4.806053815642754, 3.8198019039613618, 1.5433237325563423, -0.6308518095325788, -9.756859144704116, 3.7511494701967187, -0.38566928536055506, -3.066277744712739, 2.1442357566063657, 0.3366695735082411, -0.986915698260412, 2.4611100361786873, 3.4321068028651824, -1.0420366398660117, -0.7977313688407841, -5.3457975979585735, -5.801313301453909, 0.3803528482080844, -3.750504794364606, -7.877506743698886, -0.5767256096159281, 0.0663603051692867, -12.054235596728807, -2.9653423044602913, -5.445499637147442, -1.348659806784407, -2.5493577812963015, -2.604615771366814, 6.5625134170789945, -16.1027686277513, -0.20101158220742923, 4.01401696171676, -5.578989646516055, -3.036791113341446, -3.435348950799262, 0.9559539498644094, -0.49798625245091, -1.71370188613379, -1.1837995347809638, -1.0248845302876064, -2.687337527347507, -6.105399485980216, 3.8462840320561957, -8.800554265266756, 4.86041685989454, 4.182864767558766, 1.744243938838792, -6.118304103246126, 0.09706412702254474, 2.1283809668181686, -6.490289070133353, 0.8714590026751905, 6.035145983315482, -1.6107032124436313, -8.401315194402725, 6.272509744853869, -10.753611469809263, 2.448675845233553, -0.5767219468148921, 2.1240548508350483, 1.0241044000770325, 3.685265180811247, -6.793096543164101, 5.166159362610381, 0.2977427352951537, -6.698240182706964, 0.1698221141790291, 0.03845661849221721, -2.5858696768645295, 5.551003036583802, 2.3214222369569124, -10.895682129584966, 9.52990974184326, 3.213665596391567, 2.8123382471773635, 0.43190422534905587, 7.023110720011048, 2.996902827918585, 9.788937402323302, -0.546497756391629, -2.2752713306752783, -6.8928980893160725, -8.19318469928173, 7.109822232692153, 1.499176743690296, -5.697824620327233, 9.803594677192926, 7.882356863432686, -1.4195594360696608, 4.993901652557065, 2.3971711497813413, -2.8524411044453646, -3.676453388000647, -2.138527635363288, -1.740287772939436, 0.4429045336021141, -1.7734023721259677, -8.707195710115393, -4.2768429051513035, 1.9637282779919523, -12.476659621930688, 5.07582904273588, 5.452719753031952, 5.227113968287818, -0.24783308079653932, -4.042372451641885, -3.2646553765864335], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.340161542405818, -6.363325336964947, -9.779266219267326, -14.956110166241483, -19.765520128763058, -18.910776542425005, -6.295013315415897, -5.134288123824516, -22.629602795400903, -15.820451234094845, -17.439903937981185, -11.793810291641975, -17.566902923941868, -20.12204154931932, -8.861777964915843, -10.303775920355633, -11.386090854531595, -9.692396969364985, -15.442113465520201, -14.19715677525085, -18.57619136234647, -5.55129955515637, -17.422131448466743, -10.368015683543385, -9.917665888493238, -9.035797723174596, -10.708106052122641, -13.269423094270476, -16.998812680008474, -11.935962802396602, -12.463797713100067, -14.055367796693728, -6.349724000342345, -18.30841148197362, -19.354228479352948, -11.588960912077058, -10.00926213544652, -9.79431900053222, -22.265190893430066, -9.740181598757077, -15.711137188091294, -17.440492311316167, -8.449864916535558, -22.471847204505355, -17.526297097111964, -7.261333607693253, -10.384144572920487, -11.03931771593418, -7.147002150323361, -17.21301750799096, -11.096631868622113, -9.43968027818379, -10.817323937364225, -9.769193894996663, -15.66768233894772, -11.620843228936254, -17.102491925957352, -12.427902970254388, -9.59464679478003, -10.805613872953813, -9.873310923366606, -19.27834061023664, -4.8776393159762135, -13.820997831176154, -8.977381343617806, -8.122934501373566, -11.23329050250946, -16.378490946808046, -4.315587975596649, -5.9624001187230125, -17.09172833132548, -15.051346534374686, -13.453367465181172, -9.709468421015796, -19.082948593606982, -15.543421970576281, -10.16716608099157, -11.793106619935436, -9.152657994012337, -11.029894883291158, -11.321412753822543, -15.215395347301719, -17.776258236157094, -14.769256830934921, -9.455184867797708, -8.560449890039902, -11.032712575892846, -15.404601175802616, -10.357796378456547, -11.289515191628, -18.72911644659543, -17.24749094522891, -14.373696159910725, -8.99749627841075, -13.19796844630843, -6.5886068515878975, -11.164623674561346, -18.444622385505927, -16.472164045719584, -13.536253899225688, -20.712363096147964, -21.838649342338915, -12.193420114170186, -12.767019996426585, -19.950678026110182, -14.676981184189026, -20.44298295428144, -6.5477871022411565, -13.901408815312058, -6.481763239964468, -9.90820715468604, -18.291578790328867, -18.369533346504564, -6.598044642300331, -20.658494195128444, -18.21266439801157, -11.114859435430885, -10.589481922828323, -9.757826140812794, -10.280682698065835, -3.9516653404908, -8.93217609501207, -11.440290779728976, -15.105010583993513, -14.047073442236497, -13.433973906297423, -8.16598850898915, -11.456484428080227, -22.11544612177142, -19.613494776943757, -15.533703119201435, -13.126579822503288, -12.149430347765616, -7.793689478511741, -10.779856945522445], "policy_policy_agent__reward": [3.6359859295024877, 3.6359859295024877, 2.3890997673130268, 2.3890997673130268, 5.561183521759555, 5.561183521759555, 4.974131356370233, 4.974131356370233, 13.637874487553235, 13.637874487553235, 13.867159241998506, 13.867159241998506, -0.429256198779646, -0.429256198779646, 0.6807151555032356, 0.6807151555032356, 19.555578929282063, 19.555578929282063, 7.256190470030547, 7.256190470030547, 2.9736528484819003, 2.9736528484819003, 7.245047983757171, 7.245047983757171, 12.125594572154492, 12.125594572154492, 11.527597998700912, 11.527597998700912, 4.149287433867525, 4.149287433867525, 5.983397371515837, 5.983397371515837, 8.368103715254838, 8.368103715254838, 5.969110821161126, 5.969110821161126, 11.9451019562767, 11.9451019562767, 9.667841449744637, 9.667841449744637, 5.813211912747209, 5.813211912747209, 2.5482041030999585, 2.5482041030999585, 8.026553000357936, 8.026553000357936, 6.467467757779435, 6.467467757779435, 4.471568774543626, 4.471568774543626, 5.7460150409815, 5.7460150409815, -1.3885181422230606, -1.3885181422230606, 9.554053527894784, 9.554053527894784, 10.902433247825613, 10.902433247825613, 7.877882353178983, 7.877882353178983, 7.003560722828204, 7.003560722828204, 6.712257993580574, 6.712257993580574, -1.7035675721808847, -1.7035675721808847, 11.02978047608517, 11.02978047608517, 9.484279596996197, 9.484279596996197, 4.261341583682162, 4.261341583682162, 6.076748946026444, 6.076748946026444, 5.065494287020228, 5.065494287020228, 10.639137597584824, 10.639137597584824, 6.100645817467882, 6.100645817467882, 9.571621995478239, 9.571621995478239, 8.19922783572508, 8.19922783572508, 3.8260667738473866, 3.8260667738473866, 8.563024803273397, 8.563024803273397, 5.862491897829027, 5.862491897829027, 3.8208432279506677, 3.8208432279506677, 3.3168198892779386, 3.3168198892779386, 1.5809054861176506, 1.5809054861176506, 3.285138270353715, 3.285138270353715, 8.63968890658012, 8.63968890658012, -0.47880186405335246, -0.47880186405335246, 3.2371689868617493, 3.2371689868617493, 2.685912150108388, 2.685912150108388, 4.210267044106127, 4.210267044106127, 6.5591622788257125, 6.5591622788257125, 4.508113728784718, 4.508113728784718, 11.832502671518172, 11.832502671518172, -1.8374328287484523, -1.8374328287484523, 4.696817606286301, 4.696817606286301, 7.409815417335288, 7.409815417335288, 2.1471606384252744, 2.1471606384252744, 8.120774748447598, 8.120774748447598, 0.7211451825884758, 0.7211451825884758, 7.388475890520282, 7.388475890520282, 4.239697545583447, 4.239697545583447, 3.2046163076198866, 3.2046163076198866, 5.0247454838642485, 5.0247454838642485, 7.676803208260218, 7.676803208260218, 0.8141252241245708, 0.8141252241245708, -0.0714996836286048, -0.0714996836286048, 10.469006181690842, 10.469006181690842, 3.125396134553967, 3.125396134553967, 9.15689216253786, 9.15689216253786, 6.946166594287282, 6.946166594287282, 10.413596266222884, 10.413596266222884, 4.7125589336650755, 4.7125589336650755, 5.132115104007058, 5.132115104007058, 6.9607437933768015, 6.9607437933768015, 1.331184461939493, 1.331184461939493, 5.950676942983175, 5.950676942983175, 8.678279368569012, 8.678279368569012, 6.802346067429041, 6.802346067429041, 4.687471520877177, 4.687471520877177, 10.520883287894396, 10.520883287894396, -0.649213301005778, -0.649213301005778, 5.504562867636729, 5.504562867636729, 5.227995314538978, 5.227995314538978, 8.764328013318831, 8.764328013318831, 5.69095038926679, 5.69095038926679, 7.487390186219622, 7.487390186219622, 5.968009951715666, 5.968009951715666, 11.20682515391965, 11.20682515391965, 7.335719447602939, 7.335719447602939, 1.1496280478518945, 1.1496280478518945, 6.683895280243727, 6.683895280243727, 3.3135317350400566, 3.3135317350400566, 4.289376998848409, 4.289376998848409, 11.99781271104487, 11.99781271104487, 9.396793141338248, 9.396793141338248, 1.3202858848203614, 1.3202858848203614, 15.121136418995608, 15.121136418995608, 12.526157469365245, 12.526157469365245, 7.502879180673773, 7.502879180673773, 6.599462110887821, 6.599462110887821, 13.48689437306062, 13.48689437306062, 8.836942006053802, 8.836942006053802, 15.115960178302371, 15.115960178302371, 3.0006446729247647, 3.0006446729247647, 5.813068742318392, 5.813068742318392, -0.20556742467580225, -0.20556742467580225, 0.8575112277021526, 0.8575112277021526, 12.700700511510513, 12.700700511510513, 9.934355045097437, 9.934355045097437, 0.45011001098655035, 0.45011001098655035, 15.231044436160682, 15.231044436160682, 13.047510630722128, 13.047510630722128, 4.847649999680614, 4.847649999680614, 7.791691787692692, 7.791691787692692, 6.077498645297068, 6.077498645297068, 3.714120796810236, 3.714120796810236, 0.1376059762450775, 0.1376059762450775, 3.396824229824392, 3.396824229824392, 4.850001503394769, 4.850001503394769, 7.773957558797816, 7.773957558797816, 6.136835535055267, 6.136835535055267, 2.3633890980910133, 2.3633890980910133, 1.9445728019189241, 1.9445728019189241, 6.71010635303609, 6.71010635303609, 4.819393249920367, 4.819393249920367, 12.34466190983982, 12.34466190983982, 10.493211436116693, 10.493211436116693, 9.176846895395554, 9.176846895395554, 5.950798633484537, 5.950798633484537, 1.8756585134349288, 1.8756585134349288, 3.7576007844680066, 3.7576007844680066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28354510191164467, "mean_inference_ms": 2.133094614485951, "mean_action_processing_ms": 0.09744419669625817, "mean_env_wait_ms": 0.5844286570680195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 162000, "timesteps_this_iter": 0, "agent_timesteps_total": 486000, "timers": {"sample_time_ms": 11761.184, "sample_throughput": 286.961, "load_time_ms": 0.703, "load_throughput": 4803779.015, "learn_time_ms": 1654.326, "learn_throughput": 2040.106, "update_time_ms": 21.446}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 16.780321311950683, "policy_loss": -0.006093979254364968, "vf_loss": 16.795049285888673, "vf_explained_var": -0.06871801614761353, "kl": 0.0025464355032076558, "entropy": 0.8634393632411956, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 4.580134296417237, "policy_loss": -0.004333013109862805, "vf_loss": 4.592984437942505, "vf_explained_var": 0.2858567476272583, "kl": 0.007303388108625802, "entropy": 0.8528599709272384, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 162000, "num_agent_steps_sampled": 486000, "num_steps_trained": 162000, "num_agent_steps_trained": 486000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6480, "training_iteration": 48, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-19-32", "timestamp": 1706105972, "time_this_iter_s": 10.97036099433899, "time_total_s": 592.3753244876862, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4B87E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 592.3753244876862, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 25.707142857142856, "ram_util_percent": 73.98571428571428, "gpu_util_percent0": 0.03000000000000001, "vram_util_percent0": 0.21336146763392858}}
{"episode_reward_max": 15.975219885987817, "episode_reward_min": -11.749831876975088, "episode_reward_mean": -0.1961382740057986, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.371429320568467, "policy_agent_": -1.5865719862831538}, "policy_reward_max": {"policy_adversary_": -4.01794416989079, "policy_agent_": 18.909266234567976}, "policy_reward_mean": {"policy_adversary_": -11.929718806483413, "policy_agent_": 5.866790266238806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.089959656628237, 5.538796946599954, 0.5205850930575159, 2.464158091415625, -10.182994199100909, -1.0089833755619795, -0.5175833988351815, 1.2570216950311555, -0.4769182982354744, 3.5140128631816165, 0.5614749272741895, -0.47019888903817403, 2.9854374356758306, -5.5637845966629165, 1.8579055600950247, 1.2785489492286546, 2.187040966213715, -1.0662623374526983, 5.471050008666077, -0.644114896861788, 2.573856566669769, 3.7576492551512937, -0.5302308882775638, 4.09493560311091, -0.09793484313293666, 0.8599812233209825, -2.731581930624507, 1.7036308827454276, -3.9627889485620362, 4.251973308963492, -2.153484950917573, 1.5923691209773252, 3.79404067863229, -3.9890727069221907, -3.361526412354925, -10.558997191061477, 9.11979060152387, 0.6807179970058932, -1.122481340795086, 0.9221531330001973, -3.503131750484495, -2.0539302741419534, 8.317067459976009, -1.715699298826074, 15.975219885987817, -0.7535611063605883, 1.1037503584044541, -3.4080598306015255, -8.607233258948865, 10.12638359647123, 11.88511630756066, -4.538307112329077, -9.512101422745484, 8.665428556814621, -0.761704667064188, 9.978576091750071, 1.2719118437247177, -6.637853393152031, -0.7161412576324084, -0.08005892645429946, 2.7354205190618996, -2.7503877270568062, -5.908431046669998, -0.8964042684455227, 2.151036213303082, -1.2726673321860678, -3.3861366029866007, -0.47153100014515187, 2.4740217350450604, -4.570101889655968, -0.3486590635475698, -1.1369706501571222, 12.073772435460345, -0.7440719057027165, -3.428053933074576, -2.1193090104935086, -1.2145457692028063, -6.82476568899358, 0.9790647188928774, -3.796349816686938, -1.6151969691206538, -8.900589312157717, -0.9689110448456164, 0.5974246264266287, -2.912960974222432, 0.19439874558471787, 11.468618878913809, -3.58467683779299, -10.807245088098828, -1.4643515427337077, -5.652037787235351, -1.4790813357256738, -0.1930823214591612, 13.115271064576355, 2.348330851475686, -2.761190531369246, -2.2465894667155215, 1.8889655227951465, 1.5510079072956118, -2.157801376502201, 1.058661219465482, -1.6233218672809069, 0.6592476727894209, 0.6079502903511412, 0.07952554981055882, -0.5345794967444191, -0.33149794056629883, -11.749831876975088, -7.745494515632768, 1.7531255840261448, -3.6688851843055774, 3.725077656032502, -2.547987778168815, -0.17858251969612, -2.023167578466319, -1.8859142595389171, -0.9223718758758377, -3.4498211373630667, 3.1201731557411936, 2.039697509176253, -8.666948468023262, -2.134626265671951, -0.2422163706662418, -1.67709631286533, -7.037198858744272, 1.1769011793115878, 6.225632916525714, 1.1651424754478328, 4.4715549717995025, 1.448206353437821, -1.8826434189991963, 0.38864966314569327, -0.3714653772820274, -2.761196539570788, -6.6024216329738685], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.71975444033272, -13.483284757001991, -10.026992216339007, -13.60095137194578, -7.009850226534597, -19.981792005503138, -6.921204317407964, -20.40510877550355, -9.319424168292814, -9.424590076569514, -6.662925517068912, -11.466344881179257, -13.955493344560796, -15.829850356518792, -8.578485209565299, -7.101372722503337, -7.184902527055886, -9.581014608679935, -11.309161761011765, -11.227701934164259, -15.45390175750154, -12.560302595193383, -10.322916871751639, -14.384199407300368, -7.349879111641024, -14.853057363619588, -12.110410311471584, -7.654622800471291, -5.964876158685995, -13.436570277667387, -16.0336604287617, -6.282153672557837, -8.419007306813544, -8.915605063986867, -9.215424318158444, -16.924293580984873, -23.371429320568467, -15.8692911102502, -20.46197784936216, -10.623087969117304, -6.7941797824629395, -15.879250935887464, -17.967419887668587, -6.5374246049144125, -21.84331258314813, -8.764751049592114, -8.710359673059802, -4.01794416989079, -17.17869212327098, -22.881372682331723, -18.12755857297001, -9.68321165969921, -15.081437130952736, -22.729878687567194, -9.25814827801217, -19.273261845770833, -9.150720733688715, -18.995190313812756, -6.519235368154619, -7.843276677533141, -8.323354955009565, -9.46022081874336, -9.05069688237463, -7.471810982070093, -14.078799890033972, -15.398662464734894, -11.997199000850864, -9.1674014679171, -13.143651030633768, -15.618229073085889, -10.985137130902674, -8.095630148362151, -17.23962025904535, -6.57132360897599, -19.770142343776367, -10.324364681469534, -7.071167898455448, -9.15588500537581, -14.399312437660393, -9.29645124342013, -5.585355634893837, -9.540200748034472, -16.991118976642493, -9.636925006895709, -13.96158904217566, -11.565960160727142, -22.324869382977592, -8.04603311524769, -11.008223793589494, -10.10796750546324, -8.403546654866568, -10.451580356068755, -6.652744607053588, -19.347616104680387, -9.31084195194011, -9.338600353250417, -5.732981632603658, -20.563598933606137, -10.979709172896818, -4.944548162292217, -7.61865617725931, -19.7848903214009, -8.072573444982952, -7.721036270586318, -21.067982385234, -8.70277936964827, -18.30276072118358, -17.263577670579263, -7.774722519270961, -11.265123880953054, -14.152261124129804, -17.876962738035644, -8.621452442272576, -7.5647741388592475, -10.77317151928982, -11.399800352285173, -5.723103067746466, -16.677830936858765, -16.01510972746012, -8.985769738618671, -14.499657870923029, -10.909513408365502, -8.367077093258132, -12.151545478023765, -7.899035571657356, -14.316351947056816, -19.294824614551704, -7.958819710949134, -9.236277791013634, -22.34214949555559, -5.791500901522828, -6.799854066798974, -10.462935958729725, -5.113750910305741, -15.657833637096912], "policy_policy_agent__reward": [10.404857048480475, 10.404857048480475, 9.51104085180097, 9.51104085180097, 5.273788654698263, 5.273788654698263, 8.032554731680701, 8.032554731680701, -1.5865719862831538, -1.5865719862831538, 9.486404314970581, 9.486404314970581, 3.201810459286391, 3.201810459286391, 10.831065235267351, 10.831065235267351, 4.42125293502867, 4.42125293502867, 6.469301469875566, 6.469301469875566, 3.6122002221715515, 3.6122002221715515, 5.49807299607054, 5.49807299607054, 8.470465390118312, 8.470465390118312, 5.133032879927938, 5.133032879927938, 5.218195384830164, 5.218195384830164, 4.189960835865997, 4.189960835865997, 4.685971746634801, 4.685971746634801, 4.257376135613616, 4.257376135613616, 8.39010588483892, 8.39010588483892, 5.291793518651239, 5.291793518651239, 9.013879162085656, 9.013879162085656, 8.158975925172342, 8.158975925172342, 4.896342991737038, 4.896342991737038, 9.239567505205642, 9.239567505205642, 3.6259721342540434, 3.6259721342540434, 7.856519293470284, 7.856519293470284, 4.6894141904235385, 4.6894141904235385, 4.679126841608358, 4.679126841608358, 1.0010436050619764, 1.0010436050619764, 8.844271793315437, 8.844271793315437, 6.940087738922063, 6.940087738922063, 3.937261396767581, 3.937261396767581, 6.106523992722918, 6.106523992722918, 2.463266178532338, 2.463266178532338, 2.926948952901762, 2.926948952901762, 3.182648194961695, 3.182648194961695, 16.24560996104617, 16.24560996104617, 8.275004553628046, 8.275004553628046, 9.669748254283533, 9.669748254283533, 5.772620551058752, 5.772620551058752, 1.6455240159892226, 1.6455240159892226, 6.912660330872752, 6.912660330872752, 13.1422436738223, 13.1422436738223, 2.4108626530441697, 2.4108626530441697, 18.909266234567976, 18.909266234567976, 4.005594971615764, 4.005594971615764, 4.907055015732127, 4.907055015732127, 0.30494216964463217, 0.30494216964463217, 4.285729432161056, 4.285729432161056, 16.50387813940147, 16.50387813940147, 15.006337440265332, 15.006337440265332, 2.572452273685067, 2.572452273685067, 2.7846678541036236, 2.7846678541036236, 15.697653622190908, 15.697653622190908, 4.2482218054739915, 4.2482218054739915, 14.62591896876045, 14.62591896876045, 5.211316288706716, 5.211316288706716, 6.178668460330363, 6.178668460330363, 2.9015470552611053, 2.9015470552611053, 3.881608875539421, 3.881608875539421, 5.529387737035733, 5.529387737035733, 3.354916545843277, 3.354916545843277, 1.5711329178523146, 1.5711329178523146, 3.2877033568122864, 3.2877033568122864, 8.114918051668527, 8.114918051668527, 7.062997566274411, 7.062997566274411, 4.3055311989321305, 4.3055311989321305, 4.3479352338859725, 4.3479352338859725, 7.808836382839415, 7.808836382839415, 5.5240635917149605, 5.5240635917149605, 5.318239033677553, 5.318239033677553, 3.479329749102513, 3.479329749102513, 14.656696347252844, 14.656696347252844, 2.913625851636637, 2.913625851636637, 8.1710442053509, 8.1710442053509, 4.102527835488012, 4.102527835488012, 2.928311064626321, 2.928311064626321, 1.1655596581911152, 1.1655596581911152, 7.689188578276637, 7.689188578276637, 2.750050713366595, 2.750050713366595, 1.9850793328865919, 1.9850793328865919, 0.3198057179383813, 0.3198057179383813, 8.011103965898439, 8.011103965898439, 5.11717481666117, 5.11717481666117, 5.524314033976615, 5.524314033976615, 5.880179453155929, 5.880179453155929, 16.896744130945702, 16.896744130945702, 2.2306781387273493, 2.2306781387273493, 0.10048935274533619, 0.10048935274533619, 4.321807981364768, 4.321807981364768, 1.3757544338156085, 1.3757544338156085, 4.486249510171542, 4.486249510171542, 3.2298311427972126, 3.2298311427972126, 16.231443584628384, 16.231443584628384, 5.829586401707899, 5.829586401707899, 3.2887049109405853, 3.2887049109405853, 1.7431960829440678, 1.7431960829440678, 11.226282228200647, 11.226282228200647, 6.265358540096216, 6.265358540096216, 1.3933733928950074, 1.3933733928950074, 4.338658698362397, 4.338658698362397, 9.080784227059995, 9.080784227059995, 4.365910558886186, 4.365910558886186, 4.164493280468729, 4.164493280468729, 10.573753967522277, 10.573753967522277, 4.084099936451924, 4.084099936451924, 8.985631390308642, 8.985631390308642, 2.756872896802091, 2.756872896802091, 0.014614001819097014, 0.014614001819097014, 6.5091247324895996, 6.5091247324895996, 5.241687969912113, 5.241687969912113, 10.801020197034072, 10.801020197034072, 3.0367323320518804, 3.0367323320518804, 3.6930958095815636, 3.6930958095815636, 4.375001970411749, 4.375001970411749, 4.756943046373128, 4.756943046373128, 2.400365595935314, 2.400365595935314, 6.614004899747852, 6.614004899747852, 9.567641441600653, 9.567641441600653, 5.5127336238974625, 5.5127336238974625, 2.916354701449882, 2.916354701449882, 4.387443571346775, 4.387443571346775, 4.062430361295946, 4.062430361295946, 5.237224582579215, 5.237224582579215, 0.43091835645654086, 0.43091835645654086, 7.746626563184205, 7.746626563184205, 12.760228765538704, 12.760228765538704, 4.561981093198484, 4.561981093198484, 6.853916381406569, 6.853916381406569, 11.895177924496705, 11.895177924496705, 1.9544287412618162, 1.9544287412618162, 3.5942518649723336, 3.5942518649723336, 5.045735290723849, 5.045735290723849, 1.1762771853674756, 1.1762771853674756, 4.527706002061521, 4.527706002061521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28278008777321506, "mean_inference_ms": 2.127677135910853, "mean_action_processing_ms": 0.09714504293472125, "mean_env_wait_ms": 0.5829648961639367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 165375, "timesteps_this_iter": 0, "agent_timesteps_total": 496125, "timers": {"sample_time_ms": 11524.2, "sample_throughput": 292.862, "load_time_ms": 0.702, "load_throughput": 4804920.403, "learn_time_ms": 1646.86, "learn_throughput": 2049.354, "update_time_ms": 20.645}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 14.627191638946533, "policy_loss": 0.005754692782647908, "vf_loss": 14.629833316802978, "vf_explained_var": -0.04391621351242066, "kl": 0.0059830733903931165, "entropy": 0.839620190858841, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 3.722619950771332, "policy_loss": -0.008355418220162392, "vf_loss": 3.7394659161567687, "vf_explained_var": 0.3410125434398651, "kl": 0.0068317935171144486, "entropy": 0.850120460987091, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165375, "num_agent_steps_sampled": 496125, "num_steps_trained": 165375, "num_agent_steps_trained": 496125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6615, "training_iteration": 49, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-19-43", "timestamp": 1706105983, "time_this_iter_s": 10.868897914886475, "time_total_s": 603.2442224025726, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D73310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 603.2442224025726, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.457142857142863, "ram_util_percent": 73.99285714285715, "gpu_util_percent0": 0.03000000000000001, "vram_util_percent0": 0.2132568359375}}
{"episode_reward_max": 17.97814061048201, "episode_reward_min": -17.95346463765933, "episode_reward_mean": 0.00932084357102804, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.69264841120066, "policy_agent_": -3.0379415346251553}, "policy_reward_max": {"policy_adversary_": -3.7098316459234684, "policy_agent_": 21.21826089917909}, "policy_reward_mean": {"policy_adversary_": -12.898326888416014, "policy_agent_": 6.453823865993521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.021530454326403, 9.034162000578739, -2.4746125792008713, 4.315119891928618, 0.5234302720236482, 2.867259328661138, -6.421344798650197, 0.7355990444777075, 8.091102938737087, -1.816233779497673, -0.9670536226409823, 3.3542945643176907, -1.4173376423032895, 1.9606573946244192, 2.9080345945576003, 1.5366390409674273, 8.429292848516134, -14.642713544082326, 0.47003438621205496, 3.010046936480047, -0.13315797583712846, -1.8535531624269488, -7.072901036084319, 0.1469374823847225, -0.16668403067399717, 5.491685170969338, 4.052811464583288, -15.863845706330412, -0.0772611560431178, 0.5348788984785983, -0.14332104040393473, -5.0137115501795515, 1.852233371749056, 3.675715741905018, 7.8394284508849905, -1.8277958776331928, -1.2485056710468794, 12.810363916273126, -0.06801057554458736, 2.008792346939008, 6.204732712520623, 1.6179681191560071, 5.736612252987338, 2.400255562174687, -0.4618603152334347, 12.878494650389065, -1.210319313371527, 4.066809973872623, 0.11980497582422925, 3.8833909553622097, 5.049101445564435, -3.5606654568545975, -1.0754843440534838, 1.5927906819237194, 4.476269412331017, 1.6224144725920113, -3.442697585616458, 0.5169133244080308, 2.9927180789322003, 17.97814061048201, 1.707509110229764, -1.5449811109395937, 3.309713981156639, -4.488857220994621, 3.3943001179153374, -2.929729682700977, 6.032617061819189, -0.6207505712914967, -10.407043414184832, 9.651999650289293, -17.502591276560864, -3.1786574104382668, -7.3546474541184255, -4.910550669975198, -8.358098535335444, -2.934614895926086, 0.8869077698632273, -4.426373530434637, -4.506571307081911, 4.25289042335131, -7.4192927739439885, 4.553392356120442, -4.2228765512546005, 0.8310701238343702, 0.6030987839522534, 0.27422748247665196, 0.6150868354562269, -1.5512095646528992, 8.470149062336873, -4.701939494731341, -3.022347090314144, 12.458064587855889, 2.021879741813438, 0.5843793034002613, 6.825076492647793, -4.340652595765485, 2.589325998780771, 0.5664716829745419, 0.5417470703019667, -8.501328815179095, 0.49428557952279306, -6.691080295470137, 2.684870945695142, 3.8626498736459087, -1.9256828617794528, -1.8861887535145112, -3.3273851822836535, -17.95346463765933, -9.4226932793537, -1.394605223654773, -0.9003055247889171, 2.002472351584474, 0.9000268785453485, -1.3738723684277336, -0.3314740294887169, 0.11216006994256611, -2.3772623754908717, 1.6667989284297944, 3.7569848498530094, -3.6860793689867446, 9.096599560589421, 4.880601079444489, -0.45107254660717927, 1.8409935768470622, -7.07086401881186, 3.1249792939436984, -13.313606473845764, 0.8954218258646702, -4.377482118582313, 3.9207407885190673, -0.9293162816433523, 0.5861111971179056, 4.124344044406261, -6.547023895896739, 0.2166025069362335], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.293024148746245, -19.242701454528596, -5.391286825885448, -18.345728830616423, -22.839107446300996, -12.117090105819244, -7.637561005122196, -9.513251919814609, -17.449620363068274, -6.465926653118287, -9.25535211148369, -14.684131774311396, -16.246272738284674, -22.394575624389876, -17.54863025598088, -11.281243639741797, -14.884112595726194, -13.977974204348442, -6.640268259300022, -19.478357563419817, -8.989861215248125, -10.723945844082694, -18.950396954329115, -12.245015372501904, -8.021402622640581, -13.79904824040693, -15.28482083121876, -13.485336846022431, -18.662435652080973, -6.318594918277668, -6.1262829673868, -6.553156349403388, -12.18326801335965, -11.239118236531743, -17.68121331251753, -13.086856236617024, -10.052859263848616, -21.653124375754466, -8.559222722933848, -8.455779530548774, -11.38756447692071, -12.247308817937581, -14.83532432943385, -17.807816618680643, -16.866680654207823, -23.93507672160047, -16.227911211427084, -13.147736926712355, -5.360710754997813, -17.357412071356144, -10.368535993530173, -9.324973398118829, -8.857251751204334, -14.372465136598922, -17.115425336301463, -14.792512891377774, -13.373932173564166, -10.125600780584882, -11.089411366159277, -24.45838118787617, -16.95581615108561, -4.603626659297364, -10.543806960302387, -6.77501036734547, -13.027017607677774, -10.72296952624349, -20.168686039449675, -5.868235532830358, -13.583372260902896, -23.022809845907233, -15.314534982195097, -13.235150773479637, -8.720536705784607, -5.5381775072629145, -12.36705666623001, -8.210816629089354, -11.574500086417256, -5.751356747113079, -10.557391595715895, -16.310165367688604, -8.954759663658292, -10.980532776143193, -14.414301040192916, -8.130781008394617, -9.925174492011774, -8.412209995410748, -14.667800523617572, -19.650499697517702, -14.641595575687376, -15.786111289051846, -7.25890630680554, -25.625854735248023, -12.34717441323862, -13.394108756497113, -19.178434334983347, -6.340134066496357, -14.526367194410405, -9.998709784272766, -8.685565613555408, -7.941337600995766, -9.598372491401246, -20.243052753652496, -9.188782588714137, -13.256250254968377, -11.313967958462054, -5.463213746299695, -5.558732628426177, -11.877581568409026, -19.39350009570137, -8.116585691953244, -11.413681642089983, -12.115185201421014, -7.228176047245282, -11.610709551747409, -3.7098316459234684, -10.10337746220653, -8.718532237941787, -11.93811477178509, -18.677979929825902, -16.957757455224563, -28.69264841120066, -18.758069213308087, -12.860443384287901, -13.44405440445327, -9.44872624120297, -7.292931250253512, -8.974953987545845, -15.424549911086876, -17.5956911275012, -16.96827731366206, -16.14166031385533, -8.075250893008075, -12.631584998574054, -20.32281585592514, -17.637700402381512], "policy_policy_agent__reward": [4.135746847209921, 4.135746847209921, 14.13843172755367, 14.13843172755367, 1.4583371233422888, 1.4583371233422888, 11.330424361272517, 11.330424361272517, 11.681268859162321, 11.681268859162321, 7.49217471724019, 7.49217471724019, 0.6081081032359992, 0.6081081032359992, 5.124425482146158, 5.124425482146158, 12.77036165090268, 12.77036165090268, 2.3248464368103066, 2.3248464368103066, 4.144149244421354, 4.144149244421354, 9.019213169314547, 9.019213169314547, 7.4144675479906885, 7.4144675479906885, 12.177616509507146, 12.177616509507146, 10.228332425269242, 10.228332425269242, 6.408941340354611, 6.408941340354611, 11.656702722121167, 11.656702722121167, -0.3323696698669397, -0.3323696698669397, 3.5551513227560383, 3.5551513227560383, 11.244202249949932, 11.244202249949932, 4.428351619705497, 4.428351619705497, 4.435196340827872, 4.435196340827872, 5.938747959122399, 5.938747959122399, 6.195976427443314, 6.195976427443314, 3.9273592959832904, 3.9273592959832904, 9.645366705688135, 9.645366705688135, 9.668816147901023, 9.668816147901023, -1.1892544301539918, -1.1892544301539918, 9.292587248018929, 9.292587248018929, 3.4267369083781327, 3.4267369083781327, 2.9914809634914343, 2.9914809634914343, 0.7697223996119184, 0.7697223996119184, 7.017750692554354, 7.017750692554354, 7.457416989218381, 7.457416989218381, 12.760320881701261, 12.760320881701261, 5.629530179491917, 5.629530179491917, 4.402176796400866, 4.402176796400866, 17.23174414601379, 17.23174414601379, 4.24560607369463, 4.24560607369463, 5.232285938743893, 5.232285938743893, 8.796148594720664, 8.796148594720664, 6.932638468546795, 6.932638468546795, 10.285968291210596, 10.285968291210596, 10.104036090427664, 10.104036090427664, 8.202410169487193, 8.202410169487193, 18.40678568599476, 18.40678568599476, 7.508795949027778, 7.508795949027778, 8.60727345029249, 8.60727345029249, 2.7402578654110212, 2.7402578654110212, 10.620401513359182, 10.620401513359182, 7.708818719547305, 7.708818719547305, 2.8821539706321158, 2.8821539706321158, 3.890883703575425, 3.890883703575425, 7.98262790926132, 7.98262790926132, 10.795847374316237, 10.795847374316237, 8.207463681984892, 8.207463681984892, 4.965617293973856, 4.965617293973856, 5.321257052496458, 5.321257052496458, 7.041064722545739, 7.041064722545739, 21.21826089917909, 21.21826089917909, 9.331662630657686, 9.331662630657686, 1.529322774178885, 1.529322774178885, 6.926760470729513, 6.926760470729513, 1.1430765731754249, 1.1430765731754249, 8.210658862796556, 8.210658862796556, 3.896619921771258, 3.896619921771258, 13.100651550634435, 13.100651550634435, 2.6237424807694305, 2.6237424807694305, 1.5881644233590355, 1.5881644233590355, 16.337404748098265, 16.337404748098265, -1.094028147182893, -1.094028147182893, 5.028246681520684, 5.028246681520684, 0.6829446258330895, 0.6829446258330895, 0.313813418643857, 0.313813418643857, 2.0044790654472853, 2.0044790654472853, 2.638100866581636, 2.638100866581636, 6.230703928140242, 6.230703928140242, 0.6624916083392194, 0.6624916083392194, 3.0254101443169934, 3.0254101443169934, 10.28152789551996, 10.28152789551996, 0.7677334448571511, 0.7677334448571511, 7.766962566131818, 7.766962566131818, 5.095712244469157, 5.095712244469157, 4.480925566114493, 4.480925566114493, 5.264136637982015, 5.264136637982015, 4.343218738943699, 4.343218738943699, 7.641443679536898, 7.641443679536898, 9.049645066432399, 9.049645066432399, 11.555872319012126, 11.555872319012126, 5.54208589716025, 5.54208589716025, 2.1182796082456976, 2.1182796082456976, 19.041959661551957, 19.041959661551957, 7.184527077526033, 7.184527077526033, 6.989244029948689, 6.989244029948689, 13.00175541381557, 13.00175541381557, 0.9997407353654373, 0.9997407353654373, 8.557846596595589, 8.557846596595589, 5.282590733623653, 5.282590733623653, 4.613656341928689, 4.613656341928689, -0.2799956070916644, -0.2799956070916644, 5.046329035462023, 5.046329035462023, 6.7759862290911785, 6.7759862290911785, 5.936826767204639, 5.936826767204639, 8.55945006430714, 8.55945006430714, 4.6941425483413, 4.6941425483413, 1.7885124963925918, 1.7885124963925918, 1.1156737230712612, 1.1156737230712612, -3.0379415346251553, -3.0379415346251553, 4.985403408173839, 4.985403408173839, 3.360990234149235, 3.360990234149235, 5.256688058650532, 5.256688058650532, 7.058828776502747, 7.058828776502747, 4.064101462895314, 4.064101462895314, 5.118418591659839, 5.118418591659839, 1.6891788082173753, 1.6891788082173753, 5.107768766074549, 5.107768766074549, 3.1706349312254565, 3.1706349312254565, 6.802456850107442, 6.802456850107442, 11.217482389839455, 11.217482389839455, 6.635839043118908, 6.635839043118908, 18.89462398589505, 18.89462398589505, 11.819335146376291, 11.819335146376291, 6.204685418840363, 6.204685418840363, 7.642523990650168, 7.642523990650168, 1.1889311111955538, 1.1889311111955538, 5.208955272098606, 5.208955272098606, -2.169326243149957, -2.169326243149957, 8.159985868475772, 8.159985868475772, 6.609104504459443, 6.609104504459443, 10.444509051090565, 10.444509051090565, 7.606172016105989, 7.606172016105989, 4.330681045062991, 4.330681045062991, 8.377964521490153, 8.377964521490153, 6.887895980014207, 6.887895980014207, 8.927151454658874, 8.927151454658874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822240058058449, "mean_inference_ms": 2.122899466943342, "mean_action_processing_ms": 0.09699318303700163, "mean_env_wait_ms": 0.5821385885226024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 168750, "timesteps_this_iter": 0, "agent_timesteps_total": 506250, "timers": {"sample_time_ms": 11315.541, "sample_throughput": 298.262, "load_time_ms": 0.6, "load_throughput": 5624737.156, "learn_time_ms": 1634.719, "learn_throughput": 2064.576, "update_time_ms": 19.545}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 17.512326812744142, "policy_loss": -0.02036300431936979, "vf_loss": 17.54143543243408, "vf_explained_var": -0.08219689130783081, "kl": 0.004703192391932049, "entropy": 0.874532687664032, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 5.256109690666198, "policy_loss": 0.0042029164731502535, "vf_loss": 5.260316228866577, "vf_explained_var": 0.23616338074207305, "kl": 0.00862608562224777, "entropy": 0.8422971814870834, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168750, "num_agent_steps_sampled": 506250, "num_steps_trained": 168750, "num_agent_steps_trained": 506250, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 2.680321628746347, "episode_reward_min": -12.652666166385954, "episode_reward_mean": -2.218118574723982, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"policy_adversary_": -22.12968862092487, "policy_agent_": -1.1580842256073896}, "policy_reward_max": {"policy_adversary_": -5.882451330081154, "policy_agent_": 11.143710975791826}, "policy_reward_mean": {"policy_adversary_": -12.156805960144487, "policy_agent_": 4.969343692710251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4217807101139357, -3.27511647198914, -12.652666166385954, -1.7869489825550031, 2.680321628746347, 0.9271702056585154, -11.947673847817518, 0.15773333065877782, -0.4098545787073728, 1.7040684250375864], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.113457452322928, -7.374344272229101, -15.850419973424332, -12.894999546020347, -12.550708936865325, -10.730871476908645, -9.63150539660275, -22.12968862092487, -5.882451330081154, -10.409612596065422], "policy_policy_agent__reward": [8.267619081218427, 8.267619081218427, 2.0496139001199802, 2.0496139001199802, 1.598876903519184, 1.598876903519184, 5.554025281732674, 5.554025281732674, 7.615515282805834, 7.615515282805834, 5.829020841283581, 5.829020841283581, -1.1580842256073896, -1.1580842256073896, 11.143710975791826, 11.143710975791826, 2.736298375686891, 2.736298375686891, 6.056840510551505, 6.056840510551505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3017362845371444, "mean_inference_ms": 1.9706254936309449, "mean_action_processing_ms": 0.07976573776913828, "mean_env_wait_ms": 0.516590369175155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 6750, "training_iteration": 50, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-19-55", "timestamp": 1706105995, "time_this_iter_s": 11.914584398269653, "time_total_s": 615.1588068008423, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FDA5B550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 615.1588068008423, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 28.613333333333333, "ram_util_percent": 74.1, "gpu_util_percent0": 0.038000000000000006, "vram_util_percent0": 0.21409505208333332}}
{"episode_reward_max": 10.698256816505305, "episode_reward_min": -19.949037355827148, "episode_reward_mean": -0.6170097495142614, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.334907129091334, "policy_agent_": -2.9090273533259845}, "policy_reward_max": {"policy_adversary_": -4.73077546629739, "policy_agent_": 16.398768523082055}, "policy_reward_mean": {"policy_adversary_": -12.644385523162224, "policy_agent_": 6.0136878868239805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.192102034734589, 0.33070746314952815, -2.407794603637849, -3.8132287608781783, 4.870601165569869, -0.5640075433639744, 2.019724925284986, -5.423421898796529, -3.309094812891636, -8.797814384746273, 7.679659647614599, 2.8835474540332715, -7.2066795453131105, 8.426716572497742, -10.558594084386332, -4.066349759306602, 1.7088239780723542, -1.1736940279062251, -3.735328278771484, -3.7496837288663327, -9.800770243153359, 1.9467911476608026, -4.670982311056486, 3.656839472214709, 7.710154119591712, -4.716586076466312, 2.6124086536493976, 8.154209572360998, 0.30794084526918736, 2.859129083939183, -4.069725514292466, 3.889776640212851, 7.982690357923457, -2.230977765425054, 1.3756595554507003, 2.3294718419712703, -3.313444367300735, -2.8734310777971475, 0.1231498575707794, 1.6652742258279485, -4.062909601768189, 10.698256816505305, 3.5880734224416813, 3.2692006664645423, 0.27056920080529195, -0.04796858147692046, 3.057141804297572, -4.084907493485603, 7.847581199758499, -14.927267222518411, -0.896041493107661, -0.8428480594897645, -3.2986043522953548, -7.425111684507999, -3.598331215136327, 0.9260624139910787, 3.1468271401752372, 5.323865109658029, 3.3125176657100086, 3.87682664890248, -5.465032847961787, 5.927270444125917, 2.1580676805168357, 4.9159787309394085, -2.6665793014352444, -5.1614076243275955, -1.471465366458375, 3.577684025418676, -3.0870068274420115, -8.20629744705459, -2.0148299787350807, -7.213937493616226, -1.895766569209374, 4.610676044062023, -3.243321371536672, -2.5879772099322356, 5.89565622920534, 6.09590647564437, 6.6387099613365645, 3.7725432725219963, 2.960938762549099, -0.6289354962381399, 9.102241600603676, 5.588429815619219, -3.1990842399861985, 2.056822309355185, -2.9695498282698045, 0.9442311886654206, -2.473850534041781, -3.5904066736243228, -5.74537863035206, -1.1676011687190837, 1.6946442201139282, 0.02866597150534643, 0.9646321667250792, -9.085903642851884, 1.313473573810573, 0.6165967721341759, 6.006193041493968, -4.7808787590473605, 1.1057525993201862, 1.8070808454181104, 1.7076621701774843, -4.189816306559392, -1.5648020321908214, -1.2225943047154564, -0.24707839771098783, -19.949037355827148, -2.1511084488267542, -10.984554276007495, -2.563155356795837, -0.9386940074611898, 8.108573616413972, 1.9402020471540142, 3.89961625116097, -5.169623531864266, 6.891722626323233, -12.349113009141105, -5.55193146208703, 1.5436549344008728, -13.191852448257215, -2.1025737575150822, 5.4707261703713215, -2.54415258490986, -3.051016214893145, -1.732133760548359, 3.081471299927072, 0.8544553371016264, -4.894252373156117, -2.261468925144103, 0.8424773323905603, 4.106470552338605, -9.746120301863655, 2.993181622954341, -3.4509341556077886], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.181107503593418, -16.092579659310445, -10.702022375157753, -11.735996462347561, -8.650729991474751, -8.532264827212007, -10.159992769803367, -14.3129036701751, -11.096726343426127, -17.02493095728681, -17.398047670898126, -11.140341378907495, -12.311568281066709, -17.0379626419092, -12.697996112620967, -12.872904539029568, -13.92260698614191, -13.556977938861353, -4.73077546629739, -6.583784024023663, -12.793419388584052, -11.56141531979057, -6.5091982421564225, -8.077425520757611, -14.895263280663189, -14.440271466624, -17.96295191635744, -14.913459031803699, -13.04322631816339, -17.52532481230659, -9.120693992983421, -14.25341063825445, -15.340006615984413, -9.186435650820927, -19.575302993992068, -6.721838772275253, -5.347159428615445, -12.421579085241687, -12.79236854120664, -12.999501283498478, -8.093132351047291, -21.114936079639044, -18.97647178833974, -15.090448668760368, -8.127229396025069, -6.199961205075001, -12.139039738550117, -19.926601031545005, -15.080240600254694, -17.96243688455339, -5.835909988679502, -21.00322006741171, -6.085026922223738, -9.715848051548654, -19.67168709944007, -12.65112788347708, -14.105422146206656, -13.370461823927661, -11.791616782194396, -19.335597775180577, -7.160829466169684, -22.071675278235443, -12.261719271642166, -13.244827483476143, -11.020270450883245, -14.107562074889644, -9.33974955771529, -14.631732636217716, -13.35288050694921, -8.196150420479404, -9.983681922839786, -12.744357342405051, -8.679282872464508, -13.833112129740869, -15.331217583908712, -10.701044238022446, -14.42877731435144, -16.402620311902147, -15.895596209165213, -8.42103895647097, -10.423119299971626, -20.830029341516635, -23.695295445560422, -13.691268100188543, -7.873300980115198, -16.275899982753522, -14.00587133646618, -10.541112524063058, -8.022365482044448, -13.444100163175184, -13.387227364561056, -12.441162820318869, -9.740802669441816, -8.526026665875932, -10.953904020832569, -7.138744084972144, -10.538385643463348, -5.1891149749608445, -17.890394288402902, -14.004314964158521, -9.541411659994216, -6.161742439207466, -9.048352346260495, -9.518834310725126, -14.022858409333093, -26.334907129091334, -9.195478006292403, -14.130982649175165, -20.04502668952594, -17.077054476254876, -12.046159438522078, -6.2158518559725575, -14.062525676102972, -8.946185516079007, -14.15794154159059, -10.406044981255027, -18.781062724535204, -6.562861577903769, -12.438754921494361, -13.186163051063456, -7.761016700533317, -13.89832699646595, -12.630627464143089, -7.169488638796019, -7.818431110213498, -11.756375578098234, -12.26609402460997, -9.155570591053145, -18.60024964500961, -24.3501545818113, -12.803838994921277, -14.409702996756959, -8.111154559833786, -7.217721605907567, -19.243638373892214], "policy_policy_agent__reward": [1.4945027344294162, 1.4945027344294162, 8.211643561229984, 8.211643561229984, 4.147113885759952, 4.147113885759952, 3.9613838507346903, 3.9613838507346903, 6.760665578522309, 6.760665578522309, 3.9841286419240163, 3.9841286419240163, 6.089858847544175, 6.089858847544175, 4.444740885689287, 4.444740885689287, 3.8938157652672447, 3.8938157652672447, 4.113558286270263, 4.113558286270263, 12.538853659256363, 12.538853659256363, 7.011944416470386, 7.011944416470386, 2.5524443678767996, 2.5524443678767996, 12.732339607203475, 12.732339607203475, 1.0697010141173167, 1.0697010141173167, 4.403277389861482, 4.403277389861482, 7.81571548210713, 7.81571548210713, 6.191641955477566, 6.191641955477566, 0.49772359376295405, 0.49772359376295405, 1.4170501475786645, 1.4170501475786645, 1.4963245727153458, 1.4963245727153458, 6.754103233725685, 6.754103233725685, 0.9191079655499699, 0.9191079655499699, 5.8671324964861595, 5.8671324964861595, 11.302708700127447, 11.302708700127447, 4.861842695078847, 4.861842695078847, 10.287680285003415, 10.287680285003415, 11.533834302082346, 11.533834302082346, 6.67558358171629, 6.67558358171629, 10.192226948122881, 10.192226948122881, 2.5254842393454764, 2.5254842393454764, 9.071593639233651, 9.071593639233651, 11.661348486953933, 11.661348486953933, 3.4777289426979374, 3.4777289426979374, 10.475481274721385, 10.475481274721385, 4.5256553071232615, 4.5256553071232615, 1.0168575306573533, 1.0168575306573533, 4.774074003722268, 4.774074003722268, 6.457759199388708, 6.457759199388708, 7.332387754663211, 7.332387754663211, 2.015111374639549, 2.015111374639549, 15.906596448072177, 15.906596448072177, 11.282272605390705, 11.282272605390705, 9.179824667612452, 9.179824667612452, 4.19889929841518, 4.19889929841518, 3.0759963117990394, 3.0759963117990394, 7.598090771423844, 7.598090771423844, 7.920846769029702, 7.920846769029702, 11.463910900006598, 11.463910900006598, 1.5175848310174833, 1.5175848310174833, 2.46993424778592, 2.46993424778592, 10.080186003960973, 10.080186003960973, 1.393211284964191, 1.393211284964191, 1.1453681835203262, 1.1453681835203262, 8.03667794215187, 8.03667794215187, 6.7885951487340765, 6.7885951487340765, 8.626124643190948, 8.626124643190948, 9.347163466792846, 9.347163466792846, 7.552067223952203, 7.552067223952203, 11.60621221204153, 11.60621221204153, 0.8478983091039489, 0.8478983091039489, 13.999472861180683, 13.999472861180683, 7.209893476079499, 7.209893476079499, 9.080403107207776, 9.080403107207776, 4.176845574724, 4.176845574724, 4.473077225281024, 4.473077225281024, 3.934142095628458, 3.934142095628458, 9.104708330818195, 9.104708330818195, 5.1329368397536, 5.1329368397536, -0.005073513287592146, -0.005073513287592146, 3.9844259720523514, 3.9844259720523514, 2.7652099243944126, 2.7652099243944126, 3.3917581516275668, 3.3917581516275668, 9.221894086901447, 9.221894086901447, 6.043948106186018, 6.043948106186018, 4.056533514045105, 4.056533514045105, 10.162216771778386, 10.162216771778386, 11.249263393773258, 11.249263393773258, 11.267153085250893, 11.267153085250893, 6.096791114496486, 6.096791114496486, 6.692029031260365, 6.692029031260365, 10.100546922639245, 10.100546922639245, 16.398768523082055, 16.398768523082055, 9.639848957903881, 9.639848957903881, 2.3371083700645015, 2.3371083700645015, 9.166361146054353, 9.166361146054353, 5.51816075409819, 5.51816075409819, 5.742671856364238, 5.742671856364238, 2.774257474001333, 2.774257474001333, 4.926846744775432, 4.926846744775432, 3.8209243671044955, 3.8209243671044955, 5.636780825799892, 5.636780825799892, 5.717723444777873, 5.717723444777873, 4.277346318690639, 4.277346318690639, 5.959268093778825, 5.959268093778825, -0.9735797789398641, -0.9735797789398641, 5.9259296086369595, 5.9259296086369595, 2.90285587354751, 2.90285587354751, 11.948293664948443, 11.948293664948443, 4.611718102555581, 4.611718102555581, 5.323582129657202, 5.323582129657202, 3.984411642312789, 3.984411642312789, 5.378007258218991, 5.378007258218991, 2.664509002082866, 2.664509002082866, 6.229028188571139, 6.229028188571139, 12.55615641218794, 12.55615641218794, 4.474199804290707, 4.474199804290707, -2.9090273533259845, -2.9090273533259845, 8.946959120349593, 8.946959120349593, 3.04625010012369, 3.04625010012369, 4.7415020408631205, 4.7415020408631205, 2.6385789242556847, 2.6385789242556847, 11.08554964625847, 11.08554964625847, 5.443193781616511, 5.443193781616511, 9.028778896375778, 9.028778896375778, 2.618210724695377, 2.618210724695377, 12.836392675429215, 12.836392675429215, -2.893125715618668, -2.893125715618668, 3.4434117297036657, 3.4434117297036657, 7.364908992732164, 7.364908992732164, -2.7154178738619477, -2.7154178738619477, 5.897876619475436, 5.897876619475436, 9.050676817257207, 9.050676817257207, 2.3126680269430793, 2.3126680269430793, 2.3837074476601767, 2.3837074476601767, 5.012120908774939, 5.012120908774939, 7.673782662268519, 7.673782662268519, 5.005012964077385, 5.005012964077385, 6.852998635926748, 6.852998635926748, 11.0443428283336, 11.0443428283336, 6.823158163655918, 6.823158163655918, 9.258086774547781, 9.258086774547781, -0.8174828710149384, -0.8174828710149384, 5.1054516144309545, 5.1054516144309545, 7.896352109142211, 7.896352109142211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2817744549001093, "mean_inference_ms": 2.1181921213364925, "mean_action_processing_ms": 0.09662051217875427, "mean_env_wait_ms": 0.5810789123589762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 172125, "timesteps_this_iter": 0, "agent_timesteps_total": 516375, "timers": {"sample_time_ms": 11204.444, "sample_throughput": 301.22, "load_time_ms": 0.598, "load_throughput": 5646500.199, "learn_time_ms": 1634.631, "learn_throughput": 2064.687, "update_time_ms": 19.645}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 15.666772842407227, "policy_loss": -0.016998782567679883, "vf_loss": 15.692067527770996, "vf_explained_var": -0.06820204257965087, "kl": 0.009089328199599001, "entropy": 0.8295930445194244, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 3.6862561821937563, "policy_loss": 0.0047924390761181716, "vf_loss": 3.6897071599960327, "vf_explained_var": 0.3631101310253143, "kl": 0.0055454001090882, "entropy": 0.8252003431320191, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172125, "num_agent_steps_sampled": 516375, "num_steps_trained": 172125, "num_agent_steps_trained": 516375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6885, "training_iteration": 51, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-20-06", "timestamp": 1706106006, "time_this_iter_s": 11.001611709594727, "time_total_s": 626.160418510437, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E088B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 626.160418510437, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.964285714285715, "ram_util_percent": 74.07142857142857, "gpu_util_percent0": 0.04714285714285714, "vram_util_percent0": 0.21400669642857142}}
{"episode_reward_max": 12.852204280412764, "episode_reward_min": -14.181318615427772, "episode_reward_mean": -0.5045489061942263, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -21.31622189043973, "policy_agent_": -2.963189272303393}, "policy_reward_max": {"policy_adversary_": -4.466974582878828, "policy_agent_": 16.110491850469455}, "policy_reward_mean": {"policy_adversary_": -12.09850218363966, "policy_agent_": 5.796976638722717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5959347467777762, 7.879106823126147, 2.371727715763907, 7.556225949010344, -1.5636401588062034, 4.518231266263286, -0.398713256725606, -0.8873126801306551, -9.912674415475415, 1.8484775513601086, -6.743686495018347, -14.181318615427772, -10.463911751563694, -0.2874856608122415, 3.9702676890263815, 4.248406342228071, 1.336272697191312, -1.814239371726385, -0.3312763829708196, 0.17865870309536722, -1.8626319635283508, 6.276396903975501, -10.213257117255308, -3.928686270036661, -0.9122143743492934, -3.723474730504493, 1.8026380851230905, -0.14364353263360743, 9.964584226735584, -1.8571369415252816, -4.313246260899765, -6.748509540596404, 12.852204280412764, -6.243409185075446, 3.9340770988010494, 0.8391909670238146, -1.3079682262856003, 4.99937971848069, -4.437564542686754, -2.8871156488601, -5.205877038472049, 3.207827520773629, 0.32905405161941026, -3.7001578833307933, -3.557496404319769, -1.2028812791961603, -8.14369345906172, 3.255786996743602, -10.183739725356094, 6.898546013977703, 3.0912909209021953, 0.17928394488498123, -1.737570821936838, -13.426848007887829, -0.9800236359908147, -0.8507864620038235, -6.243079520519447, 4.798890101260738, 0.8891931403671263, -0.49522183366879335, 2.8032428345163916, -2.210749499613245, -4.381967017998581, -4.135920711395816, -5.684763209026868, 0.8413655295530111, 0.7153009755050869, -0.31737698136204584, -1.1746426429283234, -7.2084344852676585, -6.336623985601679, -1.8742902117680564, 0.17333718607636725, 7.48189380203106, -4.702178054792496, 3.6043240623664254, 2.2279544199074945, -1.0888138403513388, 6.939133702518441, -4.619691617193424, 1.5035829158444138, 2.27064909582753, -4.361149730339874, 3.8750248176191056, -2.855842740635019, 5.967580738490568, 3.839170338014264, -9.308199964593559, 7.303656950262595, -2.4429870350725813, 0.16361281188513832, 10.020454308757987, 3.1180370939748885, 2.7047013103042024, 3.198418885507801, 4.915499140264654, 1.3517966142189686, 0.3082503429568615, -1.9908298864383598, -1.5082732406515977, -3.2937846244929703, -2.4300794580138954, -6.595274972302777, 7.168387996873312, 0.8444333389424273, 5.060718112785797, -9.052872090877408, -2.3596745740656204, 0.6527841264998049, -2.451481245298895, -3.936517483808173, -4.11616152282006, 1.7769107713678836, 0.4515678269402793, 6.486376421230128, 0.6387352870009755, -1.8902674137162638, 8.27283852628841, 2.3024048775554844, 2.8527336810876838, 0.34653971573686765, 6.696292448962358, 2.1715186712732386, -3.732187311941315, -2.300851286190568, -4.770288395138385, 0.186817167876557, -6.447965229090949, -5.248555669901395, -6.85330216284749, 0.4260041435861456, -3.122328937382478, 1.3386010912718032, 5.298953254871957, -7.348671206586441], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.664117936070292, -11.95142476340516, -11.84623248707349, -15.757700112718148, -8.344548723709904, -13.485703137983457, -6.601949759207111, -7.636492097342014, -15.016693304954035, -8.132441560408918, -12.951935525169091, -11.290795729000182, -4.537533206956896, -5.740409458740897, -17.411966600982304, -12.748229971955482, -8.773533602182052, -6.5172679052002, -13.23075812517223, -13.804587651737325, -9.030508655844283, -15.442282285123826, -17.876075359575992, -15.831444388272777, -16.652217892994894, -11.525169943018998, -12.739452128682181, -10.187446004704235, -17.160889917374462, -14.76784692829579, -8.571077054739959, -13.145465474812012, -19.368779420526135, -7.1333984245160975, -17.45068862736414, -12.312495225965996, -12.759074537488056, -10.818157813160253, -10.44871130347304, -14.975817284067436, -17.888674080573733, -10.508452026545514, -5.668519568917114, -8.283358965207343, -6.42656938802501, -9.737926065307157, -12.211107631666623, -7.74894051630098, -14.29777724617018, -13.83925348820117, -13.230133724044157, -8.640448799309338, -6.1888310120332735, -18.95369124153266, -15.22849571800916, -5.782848379433002, -9.22688908998205, -12.190883412654557, -7.967116941889495, -5.131964966020781, -17.850640276354277, -12.458321081317637, -10.317633336952118, -17.415001230126578, -16.04649492653401, -15.47015649290074, -8.689384101445263, -9.396357018697088, -11.32204581901248, -8.717782764821058, -4.466974582878828, -12.877359689981756, -9.109135515226448, -14.791304179826742, -13.851338320588008, -13.88393286209826, -10.955583848909813, -15.465734578984922, -14.78701025396636, -13.32116403587769, -10.734216367803132, -11.62825517028878, -12.701368643143471, -15.698234254458537, -9.525635819233303, -21.31622189043973, -17.306494536965804, -9.324647255531929, -13.044516062986744, -11.031242143833808, -7.10081655316023, -16.478694244132747, -13.84325990575638, -7.916968419966657, -11.189704943829097, -13.261196429688692, -17.188628935557514, -9.062220632122294, -13.22749314116459, -15.53314556087445, -11.758431565292678, -8.340201392636748, -10.417312766002015, -14.368487250203877, -5.686012914314161, -14.177185429034013, -12.912824909759722, -5.606806287584691, -12.00645454515703, -11.211888843763749, -11.376445197689359, -7.197473778314633, -12.628370738883278, -10.397805419525055, -18.238624867767104, -9.307470226689821, -12.251999759342267, -13.508365925053742, -11.306076380649092, -13.636332355365887, -16.574633039324485, -14.853000773459723, -7.540786019593912, -5.951220100714269, -10.641345170281532, -19.471239798348662, -13.707665227435713, -8.4910806229779, -10.71173268405677, -16.452660391963377, -11.060203003715367, -19.742749932613172, -13.10474076725917, -17.97039155488497, -16.59025673246525], "policy_policy_agent__reward": [6.0340915946462585, 6.0340915946462585, 9.915265793265654, 9.915265793265654, 7.108980101418701, 7.108980101418701, 11.656963030864246, 11.656963030864246, 3.390454282451851, 3.390454282451851, 9.00196720212337, 9.00196720212337, 3.101618251240752, 3.101618251240752, 3.37458970860568, 3.37458970860568, 2.5520094447393102, 2.5520094447393102, 4.990459555884514, 4.990459555884514, 3.1041245150753736, 3.1041245150753736, -1.4452614432137953, -1.4452614432137953, -2.963189272303393, -2.963189272303393, 2.726461898964329, 2.726461898964329, 10.691117145004341, 10.691117145004341, 8.498318157091779, 8.498318157091779, 5.054903149686683, 5.054903149686683, 2.351514266736907, 2.351514266736907, 6.4497408711007065, 6.4497408711007065, 6.991623177416345, 6.991623177416345, 3.5839383461579657, 3.5839383461579657, 10.859339594549661, 10.859339594549661, 3.831409121160347, 3.831409121160347, 5.951379059118056, 5.951379059118056, 7.870001759322803, 7.870001759322803, 3.9008476062572535, 3.9008476062572535, 7.271045106902638, 7.271045106902638, 5.021901236035314, 5.021901236035314, 13.562737072055024, 13.562737072055024, 6.455354993385253, 6.455354993385253, 2.128915396920096, 2.128915396920096, 3.1984779671078054, 3.1984779671078054, 16.110491850469455, 16.110491850469455, 0.44499461972032583, 0.44499461972032583, 10.692382863082594, 10.692382863082594, 6.5758430964949035, 6.5758430964949035, 5.725553155601229, 5.725553155601229, 7.908768765820473, 7.908768765820473, 3.0055733803931393, 3.0055733803931393, 6.044350817603669, 6.044350817603669, 6.34139852105084, 6.34139852105084, 6.85813977365957, 6.85813977365957, 2.9987868102682627, 2.9987868102682627, 2.291600540938273, 2.291600540938273, 1.4345364918526196, 1.4345364918526196, 4.267522393055499, 4.267522393055499, 2.033707086302449, 2.033707086302449, 5.502363756522292, 5.502363756522292, 2.0570187604070425, 2.0570187604070425, 10.368899751089433, 10.368899751089433, 8.160712322473177, 8.160712322473177, 4.409866372097161, 4.409866372097161, 2.225630095048218, 2.225630095048218, 2.7634216168224137, 2.7634216168224137, 7.124236041009174, 7.124236041009174, 2.4660309587145903, 2.4660309587145903, 1.491904784731303, 1.491904784731303, 8.494886756957648, 8.494886756957648, 4.428155041128312, 4.428155041128312, 2.3183715661759945, 2.3183715661759945, 10.32694155543533, 10.32694155543533, 5.123785790852195, 5.123785790852195, 2.967833159476769, 2.967833159476769, 6.639540259365381, 6.639540259365381, 5.180865858753572, 5.180865858753572, 8.155761011226875, 8.155761011226875, 4.702342538475174, 4.702342538475174, 4.539490018667521, 4.539490018667521, 5.073701588042078, 5.073701588042078, 0.7546741397766981, 0.7546741397766981, -0.9348247013614246, -0.9348247013614246, 5.501534739106848, 5.501534739106848, 4.641236350651408, 4.641236350651408, 11.136598990928901, 11.136598990928901, 4.5745801328977524, 4.5745801328977524, 8.744128462232343, 8.744128462232343, 6.591769134408652, 6.591769134408652, 7.18846036931679, 7.18846036931679, 10.863071978242402, 10.863071978242402, 4.350736209342134, 4.350736209342134, 6.118899641823772, 6.118899641823772, 6.949452133058153, 6.949452133058153, 4.170109456401803, 4.170109456401803, 9.786629536038822, 9.786629536038822, 3.33489653929914, 3.33489653929914, 13.641901314465155, 13.641901314465155, 10.572832437490037, 10.572832437490037, 0.008223645469184526, 0.008223645469184526, 10.17408650662467, 10.17408650662467, 4.294127554380611, 4.294127554380611, 3.6322146825226853, 3.6322146825226853, 13.249574276445367, 13.249574276445367, 8.480648499865632, 8.480648499865632, 5.310834865135434, 5.310834865135434, 7.19406191466845, 7.19406191466845, 9.088347784976673, 9.088347784976673, 9.270212774888241, 9.270212774888241, 4.685235487539577, 4.685235487539577, 5.618331627363116, 5.618331627363116, 7.012436160111427, 7.012436160111427, 4.232323470399856, 4.232323470399856, 2.955060967311427, 2.955060967311427, 1.9110188968496178, 1.9110188968496178, 10.768437623538597, 10.768437623538597, 3.2652231266282947, 3.2652231266282947, 9.618951770909906, 9.618951770909906, 1.9299764094411558, 1.9299764094411558, 1.6235658567595355, 1.6235658567595355, 6.329619335828416, 6.329619335828416, 4.380203799232425, 4.380203799232425, 3.7199638569405935, 3.7199638569405935, 1.5406561277472859, 1.5406561277472859, 7.2026407551255796, 7.2026407551255796, 5.424686623232666, 5.424686623232666, 12.362500644498615, 12.362500644498615, 4.9731027568454, 4.9731027568454, 5.180866172813002, 5.180866172813002, 10.890602225671078, 10.890602225671078, 6.804240629102286, 6.804240629102286, 8.24453301822679, 8.24453301822679, 8.460586377530678, 8.460586377530678, 10.77464661121104, 10.77464661121104, 4.856152345433575, 4.856152345433575, 1.1095163943864748, 1.1095163943864748, 4.170246942045483, 4.170246942045483, 7.35047570160514, 7.35047570160514, 6.9472411976561315, 6.9472411976561315, 1.021557696943475, 1.021557696943475, 2.7315885070776855, 2.7315885070776855, 4.799679114557943, 4.799679114557943, 5.743103573650755, 5.743103573650755, 8.310210497615348, 8.310210497615348, 7.221670929265488, 7.221670929265488, 11.634672404878465, 11.634672404878465, 4.620792762939408, 4.620792762939408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2808599443409968, "mean_inference_ms": 2.113286029407554, "mean_action_processing_ms": 0.0964105470550184, "mean_env_wait_ms": 0.5798063713497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 175500, "timesteps_this_iter": 0, "agent_timesteps_total": 526500, "timers": {"sample_time_ms": 11192.791, "sample_throughput": 301.533, "load_time_ms": 0.698, "load_throughput": 4838423.625, "learn_time_ms": 1633.83, "learn_throughput": 2065.699, "update_time_ms": 19.583}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 13.859765148162841, "policy_loss": -0.016876154579222202, "vf_loss": 13.884922981262207, "vf_explained_var": -0.08378075361251831, "kl": 0.0028429636551896564, "entropy": 0.8281634747982025, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 3.144928002357483, "policy_loss": 0.0023575039580464364, "vf_loss": 3.1505892157554625, "vf_explained_var": 0.37526735961437224, "kl": 0.00597435344665509, "entropy": 0.8028101354837418, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175500, "num_agent_steps_sampled": 526500, "num_steps_trained": 175500, "num_agent_steps_trained": 526500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7020, "training_iteration": 52, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-20-17", "timestamp": 1706106017, "time_this_iter_s": 10.814644813537598, "time_total_s": 636.9750633239746, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D4ACA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 636.9750633239746, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 73.36428571428571, "gpu_util_percent0": 0.26857142857142857, "vram_util_percent0": 0.21309988839285715}}
{"episode_reward_max": 10.854114705034116, "episode_reward_min": -13.034864607544588, "episode_reward_mean": -0.18246926051511433, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.994630034960196, "policy_agent_": -0.20627312269081327}, "policy_reward_max": {"policy_adversary_": -4.414850024723362, "policy_agent_": 17.554127295687444}, "policy_reward_mean": {"policy_adversary_": -12.594938869118797, "policy_agent_": 6.206234804301842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.2845522707519237, 1.2298452328417984, 6.686307599321507, -4.8273962701049875, 1.8373385992180649, -0.9623939939124853, 4.014160477013385, -3.871940405523871, -1.3161284543502303, 7.271057100131082, -4.819802896728167, -3.9792672504282667, 5.093678901499319, 3.9462075725153793, -4.597439525865625, 3.1034382640096894, -4.4204795357225315, 3.3897175242375943, -0.9434680322412148, 0.16019520115772823, 6.637128421467566, -0.9238654402315944, -5.934218585142544, 0.4733510343248407, -1.7120028209313134, -13.034864607544588, 2.603465852649334, -5.298581501701886, -2.6516590348220723, -1.016583089083589, -6.590026436422395, -5.517954619957329, 0.5588976008200806, 5.1136245564147025, -4.646564268726008, 0.14104350212614747, -0.40472062522038954, 4.618351575117541, 4.425744052099566, -2.8885477065107525, 10.830825438566984, 4.397052325777238, -3.650195252525078, 1.542610235331269, -5.6885277217962305, -7.515504494447141, 10.854114705034116, 0.6940003273865185, 5.979891057601149, 6.123662970492157, -4.333911887064471, -3.5919585813977806, -2.3072221598290668, -11.902714633408465, -1.1385328254176161, 0.09537555836108214, 5.30411833004433, -5.9234989083099325, -1.030470686239712, -8.280682481847052, 0.16181295574224971, -2.4400009763304484, -4.758188652411392, -4.44593670453802, 3.359138402085565, -3.0014795005989767, -9.255840627823124, 2.001684408208625, 0.9514915406492761, 1.351574000280883, 0.1134875221523069, 3.7682372087812532, -1.2629043129396051, 10.030159536368238, 10.106475672585221, -2.2466064791088165, -9.32848179102369, -0.5909755060078079, -0.7298629353064826, -0.2987257349630099, -4.564227671090576, -5.374770091883212, -1.8691104763766262, 0.8092834053619236, 3.0212926226911447, -3.969491277891141, -0.2506280749933534, 0.49257193819643064, -2.0627065489784133, -2.0736002278316925, 6.968449258311267, 4.624113005709677, -7.416345925711144, -1.3023578095287425, 0.9468757194171722, -10.36370350757237, -1.6253478021663796, 2.075975776308592, 7.43896136242888, 0.22394771370610306, 7.4160610212146105, -2.2180309036918233, 1.7148811313817365, 1.8660079594327916, -4.46592803625913, 9.065787424366, -1.890161277793702, 5.029464966567553, 1.6889597908688303, 3.7025252328192675, -12.888270886815516, -3.787762117586833, 0.6717921781195284, 4.297428833664133, -5.449912926301246, -3.859491021120796, 10.511560353926926, 3.52701711793821, 1.3210231194345823, -1.6512033966286175, 1.4229453749179761, -1.8761237338127772, 4.47868521008118, -3.742933561463585, 5.810922657767474, 6.087051715491286, 1.6178215238789124, -0.11525404160257391, -1.4083665630534186, -3.5031415592358806, -2.5652697115718315, -5.232454138084216, 2.090473787532415, -0.4627889142759473, 4.260462253586556], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.097607077368055, -11.608699019682781, -17.959396031219843, -4.414850024723362, -9.507247246641343, -8.627466181805403, -13.74428861277009, -12.91402371250464, -6.861365989668474, -17.184227861881237, -5.614479727756277, -10.338418441679703, -14.189570329436679, -12.693749846933128, -10.041974400924381, -15.373239336071494, -6.942606046118045, -13.433822049693877, -10.152560909364432, -14.953572618477025, -18.101302838454032, -7.0968222120863675, -17.43181095806467, -11.810161613932323, -9.746357428963677, -14.86825779879639, -10.77135635129418, -6.186030309392246, -7.393086525681684, -9.601055335292589, -10.680773956546016, -7.563497823862064, -9.300749675009987, -29.994630034960196, -12.360483198248195, -13.935301049741211, -6.258545513030028, -13.17685690955799, -11.906512507656595, -13.975035201295123, -19.302884132487144, -11.391324638406507, -9.722824430036852, -11.502269303748822, -17.743500801856925, -18.39010252375945, -16.730004128024618, -11.68040570661774, -17.3138541391955, -13.869412703528738, -9.238085706750727, -10.911652697671027, -11.245216618772073, -22.919236408800966, -12.582954769874503, -6.076331211574924, -8.677570963879948, -19.51947031028464, -12.895898016228378, -8.99650166889328, -8.868944006172415, -9.374417772984748, -10.883991117106689, -5.529928567013144, -21.026324558023006, -7.216134201650945, -21.513489177332712, -16.27974379140484, -10.65147429973326, -12.846642639159896, -8.995429165382633, -11.404514189191486, -28.718690454023594, -17.629263985515077, -20.8500179383301, -8.720154136098781, -20.504093342780227, -16.21911785931173, -5.223563557002211, -17.567909386476213, -7.354520779351903, -14.233498074340087, -8.038796918738194, -16.29751644736219, -11.838753071202026, -10.367493003175678, -7.535468035806556, -10.15728184762652, -15.197746009657607, -8.5397175937825, -13.825718469403435, -13.361124560739263, -12.684040713523112, -7.62187811311323, -14.540515674676879, -17.352556838038936, -6.750173626409396, -7.002184057557121, -24.455632328384635, -9.207179214781213, -11.851804674500775, -9.234308910030334, -12.655490830123894, -12.270812874280312, -7.041691727193969, -15.296003750772268, -15.88234647802497, -9.658866687027299, -15.851977353308179, -11.680421637969138, -13.6656991402956, -13.918141330217617, -11.65022413401632, -15.908036997263146, -15.688644849675349, -12.167239012375612, -22.18953909514613, -11.642680833023833, -9.119144561553393, -13.777102655051864, -10.822812793568085, -8.44582878677554, -15.487468619364412, -10.446991116806398, -17.2846770833308, -13.196381401764, -11.935051485659125, -10.344706265157603, -13.220958854496876, -11.243529963922706, -11.267914351607239, -12.479815992171886, -14.716314818710341, -6.470212570950034, -11.896972585560146], "policy_policy_agent__reward": [8.691079674059988, 8.691079674059988, 6.419272126262287, 6.419272126262287, 12.322851815270672, 12.322851815270672, -0.20627312269081327, -0.20627312269081327, 5.672292922929704, 5.672292922929704, 3.8325360939464583, 3.8325360939464583, 8.879224544891738, 8.879224544891738, 4.521041653490385, 4.521041653490385, 2.772618767659121, 2.772618767659121, 12.227642481006153, 12.227642481006153, 0.39733841551405724, 0.39733841551405724, 3.1795755956257192, 3.1795755956257192, 9.641624615467997, 9.641624615467997, 8.319978709724253, 8.319978709724253, 2.7222674375293794, 2.7222674375293794, 9.238338800040593, 9.238338800040593, 1.2610632551977543, 1.2610632551977543, 8.411769786965735, 8.411769786965735, 4.604546438561609, 4.604546438561609, 7.55688390981738, 7.55688390981738, 12.369215629960797, 12.369215629960797, 3.0864783859273857, 3.0864783859273857, 5.748796186461063, 5.748796186461063, 6.141756324128583, 6.141756324128583, 4.017177304016182, 4.017177304016182, 0.9166965956259009, 0.9166965956259009, 6.687411101971758, 6.687411101971758, 0.4437244038451812, 0.4437244038451812, 2.3707137454298057, 2.3707137454298057, 4.2922361231045, 4.2922361231045, 2.0453737600618096, 2.0453737600618096, 1.022771601952368, 1.022771601952368, 4.9298236379150335, 4.9298236379150335, 17.554127295687444, 17.554127295687444, 3.856959464761096, 3.856959464761096, 7.038172275933677, 7.038172275933677, 2.926912443904819, 2.926912443904819, 8.897604242337767, 8.897604242337767, 8.166128279878079, 8.166128279878079, 5.543243747392185, 5.543243747392185, 15.066854785527063, 15.066854785527063, 7.894188482091874, 7.894188482091874, 3.0363145887558862, 3.0363145887558862, 6.522439769540047, 6.522439769540047, 6.027486540030346, 6.027486540030346, 5.437299014656151, 5.437299014656151, 13.792059416529366, 13.792059416529366, 6.1872030170021315, 6.1872030170021315, 11.646872598398328, 11.646872598398328, 9.996537837010447, 9.996537837010447, 2.4520869098431275, 2.4520869098431275, 3.659847058136622, 3.659847058136622, 4.468997229471504, 4.468997229471504, 5.508260887696248, 5.508260887696248, 5.722210972228444, 5.722210972228444, 3.085853384968003, 3.085853384968003, 6.990844646962139, 6.990844646962139, 6.797985700987352, 6.797985700987352, 5.932713664994333, 5.932713664994333, 0.35790959352311374, 0.35790959352311374, 4.515378480957332, 4.515378480957332, 3.467208398327148, 3.467208398327148, 3.0629012323476466, 3.0629012323476466, 0.5419959312375631, 0.5419959312375631, 12.19273148005429, 12.19273148005429, 2.1073273505259857, 2.1073273505259857, 6.12882427475479, 6.12882427475479, 9.14071409980673, 9.14071409980673, 5.801482920191265, 5.801482920191265, 7.099108319720389, 7.099108319720389, 4.554458343767472, 4.554458343767472, 7.586375698986372, 7.586375698986372, 13.727893070541995, 13.727893070541995, 13.829711760941656, 13.829711760941656, 15.478246805457662, 15.478246805457662, 3.236773828494981, 3.236773828494981, 5.587805775878274, 5.587805775878274, 7.814071176651962, 7.814071176651962, 2.246850310847864, 2.246850310847864, 8.634591825756601, 8.634591825756601, 1.395146554130663, 1.395146554130663, 4.429363991228439, 4.429363991228439, 3.084843221180783, 3.084843221180783, 8.553399926362058, 8.553399926362058, 7.430022846946585, 7.430022846946585, 3.1990008626422686, 3.1990008626422686, 3.642419980406602, 3.642419980406602, 5.324926892911475, 5.324926892911475, 6.567519730339596, 6.567519730339596, 3.233058682975404, 3.233058682975404, 10.397083863857354, 10.397083863857354, 8.99261878322447, 8.99261878322447, 2.6338473939059823, 2.6338473939059823, 3.1597601517922436, 3.1597601517922436, 7.743695697047029, 7.743695697047029, 3.4944266652332865, 3.4944266652332865, 2.562412912121509, 2.562412912121509, 4.539079916932856, 4.539079916932856, 15.947296845406754, 15.947296845406754, 4.715563464243658, 4.715563464243658, 9.633932847857697, 9.633932847857697, 3.508139003169255, 3.508139003169255, 7.185185980752813, 7.185185980752813, 7.068410416856553, 7.068410416856553, 1.2878818454674195, 1.2878818454674195, 12.180895587569132, 12.180895587569132, 6.996092600115636, 6.996092600115636, 7.3441658267974255, 7.3441658267974255, 8.770468572088507, 8.770468572088507, 7.691473435394202, 7.691473435394202, 0.38871412674004235, 0.38871412674004235, 5.065189606315392, 5.065189606315392, 6.161008156067925, 6.161008156067925, 10.10273291546364, 10.10273291546364, 5.11936596168705, 5.11936596168705, 4.153873995627407, 4.153873995627407, 16.35054972453653, 16.35054972453653, 7.58484897548102, 7.58484897548102, 5.220083840493987, 5.220083840493987, 6.06294962921162, 6.06294962921162, 6.12287908424303, 6.12287908424303, 3.28485252648138, 3.28485252648138, 9.983076914722792, 9.983076914722792, 3.352028777671408, 3.352028777671408, 11.547799870549136, 11.547799870549136, 9.64171655862764, 9.64171655862764, 6.776436504769021, 6.776436504769021, 5.114726111777512, 5.114726111777512, 5.906296145721729, 5.906296145721729, 3.870194202343413, 3.870194202343413, 4.351322320017705, 4.351322320017705, 3.623680927043839, 3.623680927043839, 8.403394303121374, 8.403394303121374, 3.003711828337044, 3.003711828337044, 8.07871741957335, 8.07871741957335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802445595247534, "mean_inference_ms": 2.1081351721554134, "mean_action_processing_ms": 0.09620192598932448, "mean_env_wait_ms": 0.5787235648103031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 178875, "timesteps_this_iter": 0, "agent_timesteps_total": 536625, "timers": {"sample_time_ms": 11086.939, "sample_throughput": 304.412, "load_time_ms": 0.698, "load_throughput": 4838423.625, "learn_time_ms": 1624.458, "learn_throughput": 2077.617, "update_time_ms": 19.586}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 16.635824394226074, "policy_loss": -0.006507338932715356, "vf_loss": 16.650684928894044, "vf_explained_var": -0.05753169059753418, "kl": 0.005591928097169541, "entropy": 0.8353462100028992, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 3.7392881512641907, "policy_loss": -0.003251262754201889, "vf_loss": 3.750746989250183, "vf_explained_var": 0.38700835406780243, "kl": 0.004038204011726498, "entropy": 0.8213894039392471, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 178875, "num_agent_steps_sampled": 536625, "num_steps_trained": 178875, "num_agent_steps_trained": 536625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7155, "training_iteration": 53, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-20-27", "timestamp": 1706106027, "time_this_iter_s": 10.810356855392456, "time_total_s": 647.7854201793671, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 647.7854201793671, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.664285714285715, "ram_util_percent": 73.37142857142855, "gpu_util_percent0": 0.32642857142857146, "vram_util_percent0": 0.213623046875}}
{"episode_reward_max": 17.38986942484062, "episode_reward_min": -16.511567966314008, "episode_reward_mean": -0.19788674651433535, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.08231844451859, "policy_agent_": -0.8169682387541751}, "policy_reward_max": {"policy_adversary_": -5.104470600043515, "policy_agent_": 20.794858778342807}, "policy_reward_mean": {"policy_adversary_": -12.721115636995973, "policy_agent_": 6.261614445240818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.812503763306605, 17.38986942484062, -12.175642422315693, 2.3241923310750914, 4.576148021454547, 2.8983368136491707, 1.2304268963422733, 5.18843644229142, -3.6955419291122458, -0.0016916745152459889, -0.5933943716619741, -1.594456158959328, 0.5814215088066113, -2.2906740851871232, 1.7597643580818718, 6.956867243849754, -9.022007640312893, 0.39571698623650364, -1.6561716448971164, -0.35987918172063715, 1.4273234686716103, -0.28506302147936435, -2.254910755352506, 2.3460704268300567, -9.361560820941367, -2.095329314687378, 0.7399379584831245, 11.285281729429867, 1.3170000738126804, 2.7206339061438722, -2.3048017313845217, -0.8462932000321091, -4.360886997998348, -8.848157154724461, -1.161009863275393, 8.34067501717931, -4.124642411428846, -2.1067612189303553, -9.312879355250288, 2.5058109615328217, 0.15793123634124143, -8.655232861398304, 0.5384382875432245, 1.2312728157981359, 5.114381009587372, -0.5783996921681904, -4.413820917543033, 3.3236439395561272, 1.8762059142457312, -0.9536140977982789, 2.8403352483940316, 0.8738271951968037, 1.8553956395086573, -5.779341694230734, 3.2109654740213225, -4.709347149886015, -1.8316063210049702, 0.19028770113893656, 1.7233926426927828, 1.1440514903705847, -2.897173366226665, -0.8734059297181398, -3.783215082296844, 3.3946076106918976, -7.840678159628407, -3.6888790011708172, 0.4675989223713032, 5.030325626821246, -16.511567966314008, 5.35077115812909, 10.830727075150405, 4.469928155155285, 1.0411250465506412, 1.1032071386025004, -3.5711713906589164, 3.540602302475744, -0.7118246869136757, -7.078440594746492, -4.662292948822359, 6.668397461658192, 1.5617370941491235, -0.9816034895241417, -0.43152384997459325, 2.157439957094632, 4.6393712763156945, 4.8434977314198715, -11.384202332224268, -12.516478391472063, 2.583506678937471, 5.323141957147189, 6.504875273608837, -1.525660850107581, -13.911346281428727, -0.2753000243676742, -7.148205765076491, -2.2564144178164853, -3.8734002626937274, -5.952019344763171, -3.403824653652581, -0.931503640805968, 13.296293381493587, -0.5974530734731369, -3.4131145722667804, 6.742890561068938, 3.8326434285004054, -8.148833513471466, 9.92777039067381, -1.3645086069912993, 0.5101781740919122, 0.641943787023331, 2.3119329731842018, -3.8500749692316765, -3.4373345827392257, 5.682320758563496, -3.6757736338418923, 10.664800337930682, 4.076198364415749, 0.6683908463581437, 0.5322626975703224, 4.874863405785673, 0.24385170191053118, -3.0099932091207315, -2.1714150283727536, -3.7159519505619523, 0.403563661359888, -6.851914562468716, -11.070112769828093, -1.0537857048692532, -0.6494714038935171, -0.6527548374106191, -5.779390374923377, 6.237000011847053, 13.379213760370977, -1.3172450754962906, -5.785857426714557], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.934386413632343, -24.19984813184499, -12.570298152259207, -11.253528952124487, -14.612647407244612, -12.115285657472, -11.293124831767187, -12.006794639147754, -5.561651241660616, -12.070928197801843, -5.670737704508401, -8.08633652492256, -9.20786693758509, -7.028190776284992, -7.059710389284048, -17.841120018582288, -7.388071162804544, -11.898008073979247, -9.411327624805134, -6.35174611493125, -8.390354942558814, -6.704273379403661, -5.181675933185625, -11.21720603860017, -17.64369408974402, -8.722367032531452, -8.29196217069756, -26.49425321314541, -12.4914614574086, -9.17835001054717, -9.397470091253451, -11.763763985753036, -15.176077930943093, -7.610514271214377, -18.883442979631315, -17.010020665563243, -16.4342322662688, -8.232224350892976, -16.732998145391235, -11.087588004966017, -7.624513118197835, -10.093574975826664, -9.686081354606596, -8.669084110005045, -13.698541415337932, -19.402785678517763, -8.580021461987217, -16.113316534188385, -11.26943426888882, -15.578437575394526, -9.513040233825864, -12.74200808759664, -9.207651435366333, -21.771372347911882, -11.14810436991532, -7.716479830071079, -8.931656669162418, -17.71122084048369, -8.917884392019435, -5.887719823402066, -13.474475588222434, -6.387404609898465, -11.670052079372073, -15.021206675993593, -10.03406303222481, -10.027664318059063, -7.297925413767376, -12.637342811669162, -20.843383205821013, -16.338103161456736, -23.35419190375489, -16.169104093066938, -9.57774422965652, -9.998499769077144, -8.451210626793777, -13.369087036224666, -14.845639111162598, -21.76997894639993, -7.933685430203967, -12.216566381985052, -19.210079689492183, -9.946108107954556, -9.821654907887005, -17.92298632281495, -12.699057528869847, -16.337242018412663, -15.230976572602188, -29.96511271199515, -8.634533999741768, -15.432822232595992, -24.209951037464887, -17.337561153700367, -13.121091719167808, -5.154355136149711, -14.874798298639995, -6.793758892795334, -6.242760462861014, -6.8999492416924095, -5.104470600043515, -30.08231844451859, -21.86711061807686, -11.46195070613776, -17.717600898204594, -10.705559144856164, -17.64762430211878, -6.840911456797316, -15.512414325413008, -10.991774390209061, -6.519814566336224, -8.009434385910689, -12.747484470393236, -7.146283795150404, -12.529159874312374, -15.381078770074637, -18.75900142401704, -17.76035892104869, -13.281959405287177, -12.397685514298582, -10.713330041207362, -14.252525066687646, -17.286002171131113, -10.892873454241528, -11.601082908487083, -10.726504688073307, -10.715614225593779, -21.62964078651544, -10.313013721780578, -11.163222325560737, -8.472344082254043, -10.149842168288105, -12.32737011956768, -22.66626774846613, -19.36753525871191, -11.341344588808075, -13.547504731181004], "policy_policy_agent__reward": [14.873445088469474, 14.873445088469474, 20.794858778342807, 20.794858778342807, 0.19732786497175991, 0.19732786497175991, 6.788860641599788, 6.788860641599788, 9.59439771434958, 9.59439771434958, 7.506811235560583, 7.506811235560583, 6.261775864054729, 6.261775864054729, 8.597615540719591, 8.597615540719591, 0.9330546562741847, 0.9330546562741847, 6.034618261643297, 6.034618261643297, 2.538671666423213, 2.538671666423213, 3.245940182981616, 3.245940182981616, 4.8946442231958525, 4.8946442231958525, 2.368758345548935, 2.368758345548935, 4.409737373682961, 4.409737373682961, 12.398993631216022, 12.398993631216022, -0.8169682387541751, -0.8169682387541751, 6.146862530107877, 6.146862530107877, 3.87757798995401, 3.87757798995401, 2.9959334666053055, 2.9959334666053055, 4.908839205615211, 4.908839205615211, 3.209605178962149, 3.209605178962149, 1.4633825889165593, 1.4633825889165593, 6.7816382327151095, 6.7816382327151095, 4.1410666344013265, 4.1410666344013265, 3.3135188589220363, 3.3135188589220363, 4.515950064590343, 4.515950064590343, 18.88976747128764, 18.88976747128764, 6.90423076561064, 6.90423076561064, 5.949491958345521, 5.949491958345521, 3.546334179934464, 3.546334179934464, 5.4587353928604605, 5.4587353928604605, 5.407595466472373, 5.407595466472373, -0.6188214417550452, -0.6188214417550452, 8.86121655817796, 8.86121655817796, 12.675347841371273, 12.675347841371273, 6.154794927419978, 6.154794927419978, 3.062731565981313, 3.062731565981313, 3.7100593950704712, 3.7100593950704712, 6.796699483249419, 6.796699483249419, 3.8912221772695363, 3.8912221772695363, 0.7191710572141776, 0.7191710572141776, 5.112259821074912, 5.112259821074912, 4.950178462901592, 4.950178462901592, 9.406461212462647, 9.406461212462647, 9.412192993174788, 9.412192993174788, 2.0831002722220893, 2.0831002722220893, 9.718480236872256, 9.718480236872256, 6.572820091567277, 6.572820091567277, 7.312411738798126, 7.312411738798126, 6.176687741109945, 6.176687741109945, 6.80791764139672, 6.80791764139672, 5.531523537437494, 5.531523537437494, 7.996015326840574, 7.996015326840574, 7.179534921968319, 7.179534921968319, 1.503566340092535, 1.503566340092535, 3.550025174078724, 3.550025174078724, 8.950754270811315, 8.950754270811315, 5.320638517356109, 5.320638517356109, 3.515885656886325, 3.515885656886325, 5.288651110997887, 5.288651110997887, 2.7569993400901627, 2.7569993400901627, 3.943418498537615, 3.943418498537615, 9.207907143342744, 9.207907143342744, 1.0966924362982005, 1.0966924362982005, 3.169392658444121, 3.169392658444121, 3.88276216806934, 3.88276216806934, 8.833834219245203, 8.833834219245203, 2.165907619753505, 2.165907619753505, 10.844437159792907, 10.844437159792907, 17.092459489452647, 17.092459489452647, 10.31951612411111, 10.31951612411111, 5.309434638103581, 5.309434638103581, 5.550853453839823, 5.550853453839823, 2.4400196180674305, 2.4400196180674305, 8.454844669350207, 8.454844669350207, 7.0669072121244625, 7.0669072121244625, 7.345769175826721, 7.345769175826721, 1.6356962406908033, 1.6356962406908033, 9.442481921821622, 9.442481921821622, 10.38590839182066, 10.38590839182066, 4.482252309215207, 4.482252309215207, 4.695065528956206, 4.695065528956206, 10.040213139954792, 10.040213139954792, 8.669214402592772, 8.669214402592772, 10.590369874916265, 10.590369874916265, 1.923387120188962, 1.923387120188962, 8.724317160261542, 8.724317160261542, 5.6090203393396205, 5.6090203393396205, 10.377982094871589, 10.377982094871589, 15.357413155536864, 15.357413155536864, 7.90595015179639, 7.90595015179639, -0.3951272811304606, -0.3951272811304606, 2.439527555891019, 2.439527555891019, 3.863296266781751, 3.863296266781751, 2.2686722374894255, 2.2686722374894255, 1.184680100083645, 1.184680100083645, 0.4739649484646178, 0.4739649484646178, 0.8503229731954667, 0.8503229731954667, 14.575407401856317, 14.575407401856317, 17.581701999785224, 17.581701999785224, 5.4322488163323115, 5.4322488163323115, 7.152243162968908, 7.152243162968908, 8.724224852962548, 8.724224852962548, 10.740133865309588, 10.740133865309588, -0.6539610283370739, -0.6539610283370739, 12.720092358043411, 12.720092358043411, 4.81363289160888, 4.81363289160888, 3.5149963702140687, 3.5149963702140687, 4.32568908646701, 4.32568908646701, 7.529708721788716, 7.529708721788716, 1.6481044129593638, 1.6481044129593638, 4.545912645786573, 4.545912645786573, 10.531699764319066, 10.531699764319066, 7.541613895087573, 7.541613895087573, 14.212579629489689, 14.212579629489689, 8.679078884851462, 8.679078884851462, 6.5330381803283615, 6.5330381803283615, 5.622796369388841, 5.622796369388841, 9.563694236236657, 9.563694236236657, 8.764926936520823, 8.764926936520823, 3.941440122560401, 3.941440122560401, 4.714833940057164, 4.714833940057164, 3.505276368755678, 3.505276368755678, 5.559588943476833, 5.559588943476833, 7.388863112023363, 7.388863112023363, -0.37854952402375674, -0.37854952402375674, 5.054718310345742, 5.054718310345742, 3.911436339180263, 3.911436339180263, 4.748543665438743, 4.748543665438743, 3.273989872322153, 3.273989872322153, 14.451633880156598, 14.451633880156598, 16.373374509541446, 16.373374509541446, 5.012049756655892, 5.012049756655892, 3.8808236522332247, 3.8808236522332247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2795415711619127, "mean_inference_ms": 2.104270467312943, "mean_action_processing_ms": 0.09604706828921333, "mean_env_wait_ms": 0.5776138944136459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 182250, "timesteps_this_iter": 0, "agent_timesteps_total": 546750, "timers": {"sample_time_ms": 11087.243, "sample_throughput": 304.404, "load_time_ms": 0.698, "load_throughput": 4836274.684, "learn_time_ms": 1625.062, "learn_throughput": 2076.844, "update_time_ms": 19.683}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 17.47688388824463, "policy_loss": -0.006259792554192245, "vf_loss": 17.491613578796386, "vf_explained_var": -0.0622368335723877, "kl": 0.005077795508438643, "entropy": 0.8468564987182617, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 4.038691926002502, "policy_loss": -0.00099607789888978, "vf_loss": 4.047609317302704, "vf_explained_var": 0.3560661613941193, "kl": 0.003969193733418269, "entropy": 0.792449164390564, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182250, "num_agent_steps_sampled": 546750, "num_steps_trained": 182250, "num_agent_steps_trained": 546750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7290, "training_iteration": 54, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-20-38", "timestamp": 1706106038, "time_this_iter_s": 10.988024234771729, "time_total_s": 658.7734444141388, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D4AD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 658.7734444141388, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.214285714285715, "ram_util_percent": 73.36428571428571, "gpu_util_percent0": 0.2592857142857143, "vram_util_percent0": 0.21503557477678573}}
{"episode_reward_max": 15.394336033934733, "episode_reward_min": -15.34023690758683, "episode_reward_mean": -0.00428584855546669, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.662962244346936, "policy_agent_": -2.701344076003228}, "policy_reward_max": {"policy_adversary_": -2.1866620288484686, "policy_agent_": 19.528649139140843}, "policy_reward_mean": {"policy_adversary_": -12.678323041746488, "policy_agent_": 6.33701859659551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.633116292773689, 11.179192410205367, -10.24108046838017, 4.389745501026025, 7.759286008669994, -5.265492992571541, -4.548385033611379, -3.9922079827942483, 2.698129832556342, -1.3975163691083812, -1.1528300203702602, 5.1774187751715, 2.034777096882102, 6.042396602551939, 6.025436033209116, -1.6129654451603166, -5.151812864375461, 4.901833065008378, 2.6220980705881805, -0.45673776800095367, -0.14355530666331334, 0.72817684568689, 3.1159695411858386, -0.17664652530172487, 2.3865169940996958, 6.574135499987563, -3.6188085751222534, -3.3136906403254853, 3.5958079093730615, -0.18022444180317465, 0.9688921350818652, 10.7201271538756, -2.28435227967228, 4.805486801181639, -3.631127570189098, -0.29352362512445707, -1.9767117598313517, 15.394336033934733, -1.8015071322304954, -8.02523193813688, 5.4418304141163745, 2.781270733916484, -2.5287565452107197, 2.4649102366467694, -1.346000107696939, 0.8905520220970038, -2.818471189295442, 1.820730841466163, 0.25557100100105423, -4.927967082469153, -6.6044279017390375, -3.331011250477308, 1.2838131319942876, -6.312958806421498, -2.8678332356810374, -2.4021754278861165, 5.332368804853082, 6.111275234885555, 1.8509633094413624, -5.601166864870283, 3.9866002300285106, 3.8360183495631492, -2.3111688086289264, -5.156103851269793, 1.8557457055504591, -8.775498816711401, 0.1217861271831833, -2.4139502773536003, 1.3467881292655908, -15.34023690758683, 8.000912582149969, -3.2801725505180634, -6.053094490540116, -2.746790112919405, -7.2004719740038565, -2.9201042176397403, -4.640686922456184, 4.397881182430565, -2.8631375526245537, 11.946734531062713, -1.7559834406284347, 1.3118672303249943, -2.1679091931208982, 5.601708229855412, 0.8243359570504729, -0.9320346562013391, 6.214011377557929, 4.948212758340106, 2.331270242825358, -0.5827248054876923, -4.187577616206433, 2.5960433165019374, 6.070395678083237, -5.010734756249358, 6.322964300630992, -0.4817648908004464, 1.2578485687132548, 7.3924032600660246, 3.99541457355673, 3.1240839546747456, 4.680604657474197, -2.0370273858611565, -3.0707811011510153, -3.1217515524302706, -4.700131650356962, 3.9468375163622795, 4.62738255821077, 3.5345837475868787, -5.4484986168908955, 7.9673816903398675, -3.166177646242853, 3.973102731485762, -14.822150878288758, -10.759515721227972, -1.8945589184263372, -1.3935541815966692, -5.734737099839369, -5.018418878279727, 6.616672074770464, -0.09340785217907688, 2.815991821086646, -2.746773366827257, -0.2082434376907892, -1.0906860901943332, 2.959597820321639, 0.9295788752706701, 1.442426611904167, -1.6576818782081888, 4.158800296741791, 1.1113677246984324, -3.756524604566911, 1.6091645368586691, 3.6580630851874427, -11.996255005557813, -5.270904479339106], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.952443772160706, -19.22170106735741, -11.429560870274711, -10.605579021355538, -17.54549248651457, -19.28825386775989, -6.448117488143983, -8.791640214267375, -22.904346379304023, -12.304482794168784, -15.329490523668861, -9.054090598972572, -15.7155070115672, -16.389594769359224, -15.437965588858567, -5.627620128856745, -13.9335956479393, -12.323679393570286, -23.30761394209622, -10.586895910053876, -13.661937753344963, -9.577683961810017, -17.03003557066167, -6.7814148067441735, -11.895787576227075, -16.988227398270453, -8.706433396985807, -7.446042787132825, -15.39806505042598, -10.371759875027493, -18.809747224239075, -21.804193111293767, -8.11096071499615, -19.656380045095627, -8.179674825687057, -12.789407671809318, -2.1866620288484686, -23.662962244346936, -7.995319435594677, -20.58874338233109, -21.098785874939427, -8.589630897465145, -6.0335725665727375, -17.579087230693606, -8.039270613786979, -9.110170265203111, -5.86123311667907, -9.737373487394823, -15.736563506265687, -10.600743877262838, -13.435033628928688, -6.896201391701919, -8.995687329573963, -9.959702855611788, -11.863767853486568, -9.51432847957143, -10.748959033545738, -14.356423550405113, -11.494166530142058, -11.10560661972984, -10.85021455380589, -14.920127230770298, -8.719188443478636, -18.739491451356223, -6.948919940676361, -17.182397162942458, -5.8894485957934855, -14.146031182689711, -14.62128128745814, -20.395153214406058, -17.873230106193198, -8.448103572918619, -20.33495143064213, -12.057044315302864, -8.55788980461407, -10.268145337266416, -9.221832395924475, -12.776522086013149, -9.517266131680001, -17.005835295831808, -9.903737351949362, -9.909221175839802, -17.134043477673135, -11.454339024786304, -9.424178368795452, -9.475977682982421, -15.224949838032092, -10.723959169955076, -8.075404397476172, -8.82071860854323, -18.812506047087, -10.898625395909812, -16.911793804618064, -8.123803417626643, -16.66917000736438, -16.425260782677775, -10.002641556193662, -12.982551015339013, -17.683089881124502, -13.896780383125554, -16.62948157701998, -14.035435610182361, -11.637480149417375, -16.28622150830385, -7.366037413178897, -16.1445326507156, -12.325533380881684, -10.431299192489476, -12.936591348427356, -15.126511783094763, -18.978558208766884, -10.753726749860665, -9.4194627262823, -17.171067541889308, -16.188325115738248, -7.710096855694107, -9.106699723260315, -11.817612860932597, -12.455480184767325, -9.864003710819077, -10.755038434951741, -19.403438690171303, -7.219324243531789, -6.6936721278258045, -10.522429542836319, -10.19446655572525, -7.794542615486776, -6.202740804421448, -16.881040576720185, -16.090127560994148, -7.9455558300739355, -20.670868597876318, -10.127480169633085, -12.368427789255747, -15.699054831603398], "policy_policy_agent__reward": [5.15966373969351, 5.15966373969351, 15.200446738781393, 15.200446738781393, 0.5942402009472691, 0.5942402009472691, 7.497662261190784, 7.497662261190784, 12.652389247592284, 12.652389247592284, 7.011380437594172, 7.011380437594172, 0.9498662272663031, 0.9498662272663031, 2.399716115736562, 2.399716115736562, 12.801238105930178, 12.801238105930178, 5.453483212530201, 5.453483212530201, 7.088330251649302, 7.088330251649302, 7.115754687072036, 7.115754687072036, 8.875142054224654, 8.875142054224654, 11.215995685955587, 11.215995685955587, 10.731700811033843, 10.731700811033843, 2.0073273418482143, 2.0073273418482143, 4.390891391781921, 4.390891391781921, 8.612756229289333, 8.612756229289333, 12.964856006342204, 12.964856006342204, 5.06507907102646, 5.06507907102646, 6.759191223340825, 6.759191223340825, 5.152930403748456, 5.152930403748456, 10.073002555923752, 10.073002555923752, 3.302384140721223, 3.302384140721223, 7.141152285163389, 7.141152285163389, 11.781181449129008, 11.781181449129008, 2.5438124109317743, 2.5438124109317743, 2.0661760734036703, 2.0661760734036703, 9.496936479899523, 9.496936479899523, 5.095767716612159, 5.095767716612159, 9.88931967966047, 9.88931967966047, 16.262160132584683, 16.262160132584683, 2.913304217661935, 2.913304217661935, 12.230933423138628, 12.230933423138628, 2.274273627748979, 2.274273627748979, 6.247942023342432, 6.247942023342432, 0.10497513450855853, 0.10497513450855853, 19.528649139140843, 19.528649139140843, 3.096906151682091, 3.096906151682091, 6.281755722097103, 6.281755722097103, 13.270308144527899, 13.270308144527899, 5.685450815690815, 5.685450815690815, 1.7524080106810094, 1.7524080106810094, 10.02199873367019, 10.02199873367019, 3.346635253045018, 3.346635253045018, 5.000361143650057, 5.000361143650057, 1.5213809636918119, 1.5213809636918119, 5.779052164430494, 5.779052164430494, 7.9960672536333695, 7.9960672536333695, 2.8363883973968416, 2.8363883973968416, 3.415302863594825, 3.415302863594825, 1.7825950706123055, 1.7825950706123055, 5.139750230784124, 5.139750230784124, 1.8233720245951457, 1.8233720245951457, 4.4979673089027665, 4.4979673089027665, 3.5560765258426583, 3.5560765258426583, 8.04066391919941, 8.04066391919941, 10.233849392645338, 10.233849392645338, 6.672564919791709, 6.672564919791709, 2.752219877429779, 2.752219877429779, 7.4184073919171984, 7.4184073919171984, 9.378072790166724, 9.378072790166724, 3.204009817424855, 3.204009817424855, 6.791693800043218, 6.791693800043218, 4.40233282311341, 4.40233282311341, 4.203449173115527, 4.203449173115527, 3.005617361488335, 3.005617361488335, 5.866040452668057, 5.866040452668057, 7.984034708361862, 7.984034708361862, 2.5274581534096203, 2.5274581534096203, 12.937071344171585, 12.937071344171585, 2.583965511200277, 2.583965511200277, 7.140928470051007, 7.140928470051007, 4.655127101191731, 4.655127101191731, 0.6787089153051058, 0.6787089153051058, 3.674020559813336, 3.674020559813336, 2.2905727367341466, 2.2905727367341466, 8.587201634221854, 8.587201634221854, 3.327064289527726, 3.327064289527726, 14.476284913447262, 14.476284913447262, 4.073876955660464, 4.073876955660464, 5.610544203082398, 5.610544203082398, 7.483067142276117, 7.483067142276117, 8.528023627320858, 8.528023627320858, 5.124257162922964, 5.124257162922964, 4.2719715133905405, 4.2719715133905405, 10.719480607795012, 10.719480607795012, 7.836085964147591, 7.836085964147591, 5.203337320150766, 5.203337320150766, 4.118996901527769, 4.118996901527769, 7.312464215440284, 7.312464215440284, 6.747334356205875, 6.747334356205875, 11.491094741350649, 11.491094741350649, 1.5565343306886432, 1.5565343306886432, 11.496067153997691, 11.496067153997691, 7.971747945938663, 7.971747945938663, 5.630245062453458, 5.630245062453458, 10.187477137702519, 10.187477137702519, 10.839252227340618, 10.839252227340618, 8.51043216890015, 8.51043216890015, 10.655043117247084, 10.655043117247084, 5.999204112160603, 5.999204112160603, 4.283349524133181, 4.283349524133181, 6.582234977936791, 6.582234977936791, 1.3329528814109692, 1.3329528814109692, 10.045685083538938, 10.045685083538938, 8.476457969546226, 8.476457969546226, 6.9829414700381784, 6.9829414700381784, 3.744046365768229, 3.744046365768229, 11.546946736717317, 11.546946736717317, 7.906190281262018, 7.906190281262018, 7.363414740673212, 7.363414740673212, -2.701344076003228, -2.701344076003228, 3.2057759103306673, 3.2057759103306673, 7.146883098655955, 7.146883098655955, 3.158271337048719, 3.158271337048719, 1.6859813117104725, 1.6859813117104725, 3.3995969913264332, 3.3995969913264332, 9.536076129768887, 9.536076129768887, 4.88529792932, 4.88529792932, 6.7855151280191945, 6.7855151280191945, 8.328332661672023, 8.328332661672023, 3.505540402920499, 3.505540402920499, 2.8014930188157376, 2.8014930188157376, 6.741013681578979, 6.741013681578979, 5.56202271549796, 5.56202271549796, 4.618484613695471, 4.618484613695471, 2.2725294631066295, 2.2725294631066295, 10.519920436730988, 10.519920436730988, 8.600747642846292, 8.600747642846292, 2.094515612753512, 2.094515612753512, 11.140016567367494, 11.140016567367494, 6.892771627410266, 6.892771627410266, 0.1860863918489672, 0.1860863918489672, 5.214075176132148, 5.214075176132148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27904742374159386, "mean_inference_ms": 2.0992614226354243, "mean_action_processing_ms": 0.09587692975784723, "mean_env_wait_ms": 0.5765182420172938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 185625, "timesteps_this_iter": 0, "agent_timesteps_total": 556875, "timers": {"sample_time_ms": 11049.427, "sample_throughput": 305.446, "load_time_ms": 0.798, "load_throughput": 4231415.077, "learn_time_ms": 1626.064, "learn_throughput": 2075.563, "update_time_ms": 19.734}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 15.716723537445068, "policy_loss": -0.013648646418005228, "vf_loss": 15.738735961914063, "vf_explained_var": -0.07312220335006714, "kl": 0.004063074070500994, "entropy": 0.8363581776618958, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.214694547653198, "policy_loss": -0.005211881082504988, "vf_loss": 3.2278097033500672, "vf_explained_var": 0.45113655626773835, "kl": 0.008314644968696161, "entropy": 0.7906518995761871, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 185625, "num_agent_steps_sampled": 556875, "num_steps_trained": 185625, "num_agent_steps_trained": 556875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7425, "training_iteration": 55, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-20-49", "timestamp": 1706106049, "time_this_iter_s": 10.8057701587677, "time_total_s": 669.5792145729065, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D723A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 669.5792145729065, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.607142857142858, "ram_util_percent": 73.37142857142855, "gpu_util_percent0": 0.2621428571428571, "vram_util_percent0": 0.21344866071428573}}
{"episode_reward_max": 13.686446940262172, "episode_reward_min": -14.890896184861996, "episode_reward_mean": 0.22367078220500988, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.363589589135533, "policy_agent_": -1.7270897498492628}, "policy_reward_max": {"policy_adversary_": -4.391359754613901, "policy_agent_": 18.43813653737238}, "policy_reward_mean": {"policy_adversary_": -12.330614687589252, "policy_agent_": 6.277142734897131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.249514469487372, -0.25854372080902344, -0.62875326849276, -4.243920363824458, -4.350155393385105, -0.7888547606213921, -4.398290660114453, 1.7679294112203392, 0.39419049911633214, 3.0069155799528042, 3.9067409843962198, 1.5066792104094462, -3.341993324753325, -4.065927238017877, 0.23639890893252988, 6.241655120302815, 7.577396338968997, -10.320787340419178, 13.686446940262172, 2.900272736207808, -1.6367617742056428, 0.5305082698467882, 6.352502701713509, 6.08209605513172, 0.45330047432534626, 0.05566337858520928, -2.301086073557551, 1.8202687644286064, -9.261714351764763, -5.7890730379688335, 1.8046866016806933, 4.446962158157638, 1.4560005148787571, -0.5116788892679991, 1.6054898338833599, 2.1235673259057704, -5.876020286265091, 9.303953509674741, 2.8324567458437393, 1.1587540332840607, -2.0352024918525906, 0.9701146231051283, 2.6308511239753107, -10.256578831894164, 2.8827529636482305, 4.1365238997728255, 0.761561708780566, 4.041907996861193, -6.558895050988665, 3.556274987249395, 2.4364731113482043, -3.344534817220017, 1.0690434604735646, -4.588762401377605, -7.818107796526261, 5.537269497554191, 10.47541762853584, 3.51171229213912, 7.232857064983676, -7.776875425192859, 1.8623217428670809, -0.6493836201015647, 8.077811333766928, -5.640683391730855, 2.073392505656732, -0.47313388342795515, 3.897894302445999, 0.09659780820474839, 4.199857625836732, -0.38917113575725953, -2.2854864651663647, -0.02062090919308801, 8.029162333635172, -2.877161042953902, 7.133307373607819, -6.847223844483872, -4.048239871173691, 0.3856594057280909, 2.038631810504691, 3.970913463546202, 8.032587734366198, -0.11392659986325504, -2.090979159067474, 5.046479602452443, -1.0029727768312153, -2.566241850458914, -0.512219019346349, 1.0273629128998987, -5.31806014891805, 7.465298959210325, 3.4239701663888487, 1.1727163511614354, 0.31729368854708506, -0.2216755129734802, -2.289103220576189, -0.3053274076221363, -2.347393428561332, -1.4722783510957473, -14.890896184861996, 5.25774025122401, -1.4029689513652555, 6.68568379900325, -1.4911396426625105, 1.2733639142337418, 6.817461819218001, 8.053115106330813, -5.131126388205584, -10.911363838771283, 6.2764429456304525, 0.7429291357936535, -4.2526007661286, -14.458106073505075, 1.9320643032686078, 5.308422549870295, -6.726436173334189, -0.5411482702729464, -4.150556950776279, 3.320717494695456, 1.712289597932538, 5.471165114987915, -1.1082752502392217, 7.758934804661661, 5.04078272853894, 1.9843518605431125, -2.337628732716738, -3.8994666025915077, -1.9924426023583302, 1.626949686451817, -11.886803344819754, 2.255558363501543, -4.900665514881532, -1.418192978700663, 3.896834578825328, -4.817510526932213, -0.7734658329645143], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.320215054704828, -11.1670978553523, -13.224712167454019, -11.448945214786336, -14.590474284520718, -8.90410961306707, -5.685788115241387, -5.695960822920949, -12.565566092089835, -15.882035107183807, -10.17541709082479, -5.943542086377865, -11.68547461169817, -7.633739086306153, -9.913837510459059, -18.10253230411469, -17.09263831604215, -6.866607840720651, -23.189826134482583, -10.529264510390336, -15.924127259736519, -17.85774761942002, -10.917467928290453, -14.440257227408257, -12.826109799690022, -15.545254279028521, -9.721618666810487, -10.151192496348889, -22.377897918926315, -12.236875469138702, -7.921883307321505, -13.188779950248541, -17.760200672007702, -4.482575796015232, -11.523473899084012, -13.457945930297386, -8.378280591063138, -17.320333594484175, -11.84680541133878, -9.753213106924814, -8.42945651621554, -8.961498971683588, -8.552244878064243, -22.468189749736766, -9.639233664474961, -10.790701480265033, -8.99591152875551, -17.264759801945527, -10.662639562305355, -11.973927012334293, -9.037764470938994, -7.796020480126573, -15.167139731801448, -8.206057052843137, -17.204026008795072, -14.010596053481294, -20.522821729826354, -13.194552811412448, -23.363589589135533, -16.5069048266193, -8.829790541753887, -7.640095001084724, -13.711657169735652, -4.391359754613901, -12.790906490539093, -17.71328738549745, -21.67936356539626, -9.234834860884778, -8.141920614334232, -13.968760552023149, -9.052718180398884, -21.65878177708822, -16.097484793041385, -15.171774468757576, -16.61602838343187, -10.874682575857989, -7.194487781944635, -10.081030702422824, -8.676519633089596, -10.057208102994641, -14.687022390763849, -13.538944130472188, -7.389673686553682, -17.451249470928534, -9.541277592255376, -16.05750540736383, -6.537680976756862, -11.52663090026409, -9.105274130294651, -11.030552629914029, -7.730155499779738, -7.088601066660741, -19.58801963956452, -7.128163090936528, -11.22882603088674, -18.04455359223728, -11.787346342973853, -15.842563576403515, -16.963380733793596, -15.844875667737625, -6.588618194956793, -15.916273347924932, -12.482377805024075, -10.500597983736194, -12.30120731097208, -15.061958135931656, -12.72688208967162, -13.311328160347253, -13.85580454079832, -10.680459027366643, -13.825724888649738, -18.635243376352822, -11.559719637149152, -10.038591245744714, -12.372664146243183, -12.155006071758699, -10.837288142162357, -11.000941462222896, -12.195773700388918, -12.108999902941509, -10.162882490539175, -12.568682405859896, -10.738994585453332, -11.296619681570064, -4.669182797457037, -10.357135115361254, -10.258700923407295, -17.986827735616163, -15.009281267334956, -6.916005872548078, -8.723121082856267, -10.773517162148957, -21.643128286461504, -9.341912064832687, -11.33868262824472], "policy_policy_agent__reward": [3.535350292608727, 3.535350292608727, 5.454277067271638, 5.454277067271638, 6.297979449480628, 6.297979449480628, 3.6025124254809393, 3.6025124254809393, 5.120159445567812, 5.120159445567812, 4.057627426222839, 4.057627426222839, 0.6437487275634663, 0.6437487275634663, 3.731945117070643, 3.731945117070643, 6.479878295603079, 6.479878295603079, 9.444475343568305, 9.444475343568305, 7.041079037610504, 7.041079037610504, 3.725110648393656, 3.725110648393656, 4.1717406434724245, 4.1717406434724245, 1.7839059241441368, 1.7839059241441368, 5.075118209695794, 5.075118209695794, 12.172093712208754, 12.172093712208754, 12.335017327505575, 12.335017327505575, -1.7270897498492628, -1.7270897498492628, 18.43813653737238, 18.43813653737238, 6.7147686232990695, 6.7147686232990695, 7.1436827427654395, 7.1436827427654395, 9.194127944633403, 9.194127944633403, 8.634985315001979, 8.634985315001979, 10.261176641269989, 10.261176641269989, 6.639705137007685, 6.639705137007685, 7.800458828806867, 7.800458828806867, 3.7102662966264677, 3.7102662966264677, 5.985730630388747, 5.985730630388747, 6.558091783580783, 6.558091783580783, 3.2239012155849327, 3.2239012155849327, 4.8632849545011, 4.8632849545011, 8.817871054203088, 8.817871054203088, 9.60810059344323, 9.60810059344323, 1.9854484533736163, 1.9854484533736163, 6.564481866483686, 6.564481866483686, 7.790756628101579, 7.790756628101579, 1.2511301523990215, 1.2511301523990215, 13.31214355207946, 13.31214355207946, 7.339631078591256, 7.339631078591256, 5.455983570104438, 5.455983570104438, 3.1971270121814745, 3.1971270121814745, 4.9658067973943565, 4.9658067973943565, 5.591548001019777, 5.591548001019777, 6.105805458921304, 6.105805458921304, 6.260993314061595, 6.260993314061595, 7.46361269001893, 7.46361269001893, 4.878736618768038, 4.878736618768038, 10.65333389940336, 10.65333389940336, 2.0518722556583446, 2.0518722556583446, 7.765100999791844, 7.765100999791844, 5.737118791143599, 5.737118791143599, 2.2257428314532772, 2.2257428314532772, 8.118091596137502, 8.118091596137502, 1.8086473257327653, 1.8086473257327653, 4.692959106134404, 4.692959106134404, 9.77393277551774, 9.77393277551774, 15.499119679181097, 15.499119679181097, 8.353132551775785, 8.353132551775785, 15.298223327059604, 15.298223327059604, 4.365014700713225, 4.365014700713225, 5.346056142310483, 5.346056142310483, 3.4953556904915795, 3.4953556904915795, 10.894734251751292, 10.894734251751292, -0.624661818558478, -0.624661818558478, 7.432149498097914, 7.432149498097914, 8.620076751034748, 8.620076751034748, 12.788628933921126, 12.788628933921126, 4.665716334544764, 4.665716334544764, 6.170889120085482, 6.170889120085482, 6.789794708132943, 6.789794708132943, 3.3836158576162596, 3.3836158576162596, 10.819080433947564, 10.819080433947564, 12.063323563338278, 12.063323563338278, 6.147306712901834, 6.147306712901834, 11.87466787851985, 11.87466787851985, 2.013729365687059, 2.013729365687059, 1.5731239553854703, 1.5731239553854703, 5.23334505407546, 5.23334505407546, 5.357575721797143, 5.357575721797143, 7.0140607832704225, 7.0140607832704225, 11.35980506256502, 11.35980506256502, 6.712508765304467, 6.712508765304467, 2.6493472637431035, 2.6493472637431035, 11.248864536690485, 11.248864536690485, 4.26915240771208, 4.26915240771208, 6.745631778452458, 6.745631778452458, 3.012730978705256, 3.012730978705256, 6.276996906581996, 6.276996906581996, 1.8936069906883004, 1.8936069906883004, 9.247925794562176, 9.247925794562176, 5.577062833084294, 5.577062833084294, 4.13065870891109, 4.13065870891109, 9.952656664055802, 9.952656664055802, 3.453243788981525, 3.453243788981525, 4.469861405155276, 4.469861405155276, 8.86961309230757, 8.86961309230757, 4.71997645720626, 4.71997645720626, 7.185142612653884, 7.185142612653884, 1.036242274465795, 1.036242274465795, 10.551307959480818, 10.551307959480818, 2.5928246217957693, 2.5928246217957693, 11.300978573464088, 11.300978573464088, 5.495619081180784, 5.495619081180784, 5.886980948984969, 5.886980948984969, 9.55933456509504, 9.55933456509504, 11.557536621131234, 11.557536621131234, 3.797877850733015, 3.797877850733015, 1.1999821607879826, 1.1999821607879826, 10.066123743214389, 10.066123743214389, 5.7116940815801485, 5.7116940815801485, 4.786562061260569, 4.786562061260569, 2.088568651423871, 2.088568651423871, 6.745891970208878, 6.745891970208878, 7.6735068978075045, 7.6735068978075045, 2.823113986454496, 2.823113986454496, 5.806928900742873, 5.806928900742873, 3.3433655956930375, 3.3433655956930375, 7.160829478459177, 7.160829478459177, 6.954031649160726, 6.954031649160726, 8.790082508964712, 8.790082508964712, 4.527303620149975, 4.527303620149975, 10.163808605260773, 10.163808605260773, 7.889888656996139, 7.889888656996139, 6.640485771056589, 6.640485771056589, 1.1657770323701493, 1.1657770323701493, 3.2288342563848706, 3.2288342563848706, 4.133129160524482, 4.133129160524482, 9.806888711033986, 9.806888711033986, 1.5612389612576, 1.5612389612576, 4.58578211802481, 4.58578211802481, 1.9112277839873677, 1.9112277839873677, 4.677662091724147, 4.677662091724147, 12.769981432643416, 12.769981432643416, 2.2622007689502373, 2.2622007689502373, 5.282608397640101, 5.282608397640101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27851381056610575, "mean_inference_ms": 2.095775151551828, "mean_action_processing_ms": 0.09588169747195534, "mean_env_wait_ms": 0.5756597261239268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 189000, "timesteps_this_iter": 0, "agent_timesteps_total": 567000, "timers": {"sample_time_ms": 11067.363, "sample_throughput": 304.951, "load_time_ms": 0.698, "load_throughput": 4836109.46, "learn_time_ms": 1629.951, "learn_throughput": 2070.614, "update_time_ms": 19.136}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 14.950503826141357, "policy_loss": -0.008675123890861869, "vf_loss": 14.967451477050782, "vf_explained_var": -0.08197206258773804, "kl": 0.003451183796585694, "entropy": 0.8272066354751587, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.952186095714569, "policy_loss": 0.009168995730578899, "vf_loss": 2.950720763206482, "vf_explained_var": 0.46350860595703125, "kl": 0.005175084258548124, "entropy": 0.7705635309219361, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 189000, "num_agent_steps_sampled": 567000, "num_steps_trained": 189000, "num_agent_steps_trained": 567000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7560, "training_iteration": 56, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-00", "timestamp": 1706106060, "time_this_iter_s": 11.088340759277344, "time_total_s": 680.6675553321838, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E828B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 680.6675553321838, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.192857142857143, "ram_util_percent": 73.5142857142857, "gpu_util_percent0": 0.2778571428571428, "vram_util_percent0": 0.21391950334821427}}
{"episode_reward_max": 10.455800618667329, "episode_reward_min": -19.606793742509357, "episode_reward_mean": -0.3776234131381712, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.79036247825677, "policy_agent_": -2.7300650173160492}, "policy_reward_max": {"policy_adversary_": -5.02541998695807, "policy_agent_": 15.20022963636248}, "policy_reward_mean": {"policy_adversary_": -12.238731714591813, "policy_agent_": 5.930554150726821}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.158338672713165, 6.289581590675054, 1.4235497453374002, 1.5706622110163888, -4.008484558284292, 8.454133332557149, -4.9094375871893, 1.1726645047234978, -4.002292117492807, -0.3789367596821064, -2.9281894480101722, 5.779251177972149, 1.6010363194791997, 0.9467741097453717, -9.231354843682325, 1.6292229063736308, -4.349187300780149, -8.44321202241139, -3.8736260911198928, -5.747124110682633, -0.8932320682550825, -4.8373259939542175, 7.036147854575584, -5.173615422400803, 0.7931720296242932, -0.30473631718978855, 8.515589706457174, -4.506390725453589, 0.18691209204218837, -7.494927208266782, -2.7651617773020383, 6.805734491595788, 2.8598164775095007, -4.866510326119311, 1.9522740342301452, 0.11036279179623068, 3.2236270686851696, -5.828067118688285, 2.0675161265734565, 0.9143750555883589, 3.7745438655949357, 2.178327701965643, 4.726345440647427, -1.3253852543865028, 10.455800618667329, -1.4698554930770789, -1.8788033542167515, 2.3877317248504824, 3.9288532196172863, 8.656681146111397, -3.6759245362145796, 3.286227791986147, 3.3464183932831038, 2.3591507624862746, 7.006720178266037, 4.245304107273397, -13.239344882926337, -2.3535947440570792, -0.9788419686048159, -3.490213938354781, -0.04951594337625409, -1.064392585671003, 1.4746135620804262, -5.401256453701023, 5.2268708634693875, -1.477520816617485, -0.10649301807817069, -10.324210148619526, -3.886910531230871, 7.605063964731124, -5.4236230094214095, 4.159070082447831, -13.933412435454885, 1.6368095105086136, 1.484614138693486, 1.3824766281943814, -0.42631695485390764, -2.0159343561495926, 3.146136871603048, 0.690353439511588, -6.042064810667381, -16.60239974415627, 0.13833854692785835, -4.072099950222701, -1.847181661990541, 2.3005404778482204, 2.4102150666081243, -5.51061894007004, 1.9197611618858326, -1.0383393603877278, -1.0679393705065048, 10.426318139566835, -1.292296373347062, -0.15307074614910032, -1.106502564999271, 4.193097598575233, -5.801501485629878, -1.4968728491690535, 3.742121666824551, -4.675756107720122, -1.115061011645154, 1.1079328495292478, 3.4170732606817276, 5.526952983637263, 6.26296341803952, -1.324126660606599, -19.606793742509357, -13.542406426167126, -0.2830886505235494, 1.554918911513904, -1.1123258589674974, -6.76635317652016, 5.415577503382335, 3.9407987688084516, 0.5894052571140926, -0.2708545225942437, -0.7717369008371925, -1.9782190697110524, 1.462444197122614, -2.537608813780804, -1.8975384227812861, 4.70273742075953, 0.2807152408720617, 10.057705839775988, -1.2405455758756596, -3.5196435829038424, -0.3860146408394236, 1.299478847894605, -11.982776350173705, 5.70059222224555, -2.876905777087428, -1.7075771725004736, 0.5120910074487082, -0.3927200602117409, 5.492505131253357], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.769960585695225, -11.882990621515704, -8.756751274152359, -10.99047454544924, -9.966254303425101, -13.517038566313953, -5.068454895910538, -5.427323537462581, -10.277902538427224, -12.42685248411826, -5.02541998695807, -13.582641702607802, -8.886761581833, -8.15909624468597, -11.52363475283936, -16.472298973961742, -11.241157244103144, -9.898725252494618, -19.71386121040838, -5.36945465083925, -7.747187457469478, -12.875925933009377, -15.074849383729164, -13.290042943122227, -10.516136753244057, -10.984666780938891, -17.415400597090613, -5.770783111893976, -14.810128170021734, -14.167234277681764, -10.517314809703175, -21.545919322483744, -10.600573392729268, -13.358322878645932, -7.827613769353273, -16.649339858406627, -13.276873478925975, -15.902027380726004, -9.242774004056463, -15.712074407067949, -13.997465769020069, -15.640115336697253, -10.945535698103313, -12.966998099988773, -19.11186514481117, -7.285108610160188, -13.61138464726803, -8.526260806160478, -9.458436752096768, -19.515546677976456, -23.61379461852622, -13.406249517018459, -12.742818184849712, -9.226051900365368, -19.470086521026346, -10.408147026079636, -12.104991257723595, -13.845276807517338, -5.852129299563491, -9.62834477578795, -11.37748851638647, -15.36746863832737, -7.756778664889747, -16.903155747364462, -11.169600272826402, -5.813965280738058, -15.126195570961533, -16.9537843755731, -6.393359561131661, -17.103489934532753, -11.885318942215479, -9.633175166417246, -8.473282400822788, -7.006102722871139, -9.170117684913919, -10.151004656634573, -16.04930162740838, -8.271371348384465, -10.98484595642652, -7.97560340612461, -15.958375109185802, -26.79036247825677, -12.72792744966033, -14.998787200311385, -9.885967784946121, -8.1443724007758, -10.284253314844257, -5.1211837767207555, -8.71592517112885, -17.77441637159621, -10.21027385448385, -17.369514049666684, -20.46210472452306, -14.888125632458138, -18.923542079967646, -10.161841080729916, -18.48309138098749, -14.08544537359559, -17.119420757295686, -12.356383161253762, -10.297998259597072, -7.893556004328982, -9.013174974631575, -11.624789308450804, -16.117987964941534, -10.150689321167867, -18.067469139414687, -20.56982489942096, -13.793106729558945, -6.749117563573417, -8.905537386986195, -10.201129288365431, -10.875198027578998, -9.29530932247566, -9.564008550670922, -10.00022064205456, -11.380027318123757, -14.898360345127612, -7.597463150634429, -6.928961693008314, -14.614403002728853, -13.07417526924538, -7.46719253284222, -20.342753432948964, -14.035839964953157, -14.184150372466453, -13.541377016452335, -5.229209183438133, -24.34331209603946, -14.181028668408706, -9.34648634289259, -11.006627142346709, -12.698446393400209, -9.07108447918265, -11.543190940856645], "policy_policy_agent__reward": [4.964149629204194, 4.964149629204194, 9.086286106095379, 9.086286106095379, 5.0901505097448805, 5.0901505097448805, 6.280568378232819, 6.280568378232819, 2.978884872570403, 2.978884872570403, 10.985585949435547, 10.985585949435547, 0.07950865436061849, 0.07950865436061849, 3.299994021093039, 3.299994021093039, 3.137805210467208, 3.137805210467208, 6.023957862218076, 6.023957862218076, 1.048615269473949, 1.048615269473949, 9.680946440289972, 9.680946440289972, 5.243898950656099, 5.243898950656099, 4.552935177215671, 4.552935177215671, 1.1461399545785147, 1.1461399545785147, 9.050760940167688, 9.050760940167688, 3.4459849716614985, 3.4459849716614985, 0.727756615041613, 0.727756615041613, 7.920117559644244, 7.920117559644244, -0.1888347299216931, -0.1888347299216931, 3.4269776946071966, 3.4269776946071966, 4.019299969527582, 4.019299969527582, 11.055498619152376, 11.055498619152376, 4.058213760360709, 4.058213760360709, 5.654654391434175, 5.654654391434175, 5.339965231874552, 5.339965231874552, 12.965495151773897, 12.965495151773897, 0.6321961932201926, 0.6321961932201926, 7.498520131031963, 7.498520131031963, 3.3361535347074907, 3.3361535347074907, 3.8760765162005666, 3.8760765162005666, 14.17582690703976, 14.17582690703976, 6.730194935119387, 6.730194935119387, 4.2459062762633115, 4.2459062762633115, 4.889943901791709, 4.889943901791709, 8.37985132510143, 8.37985132510143, 8.250250273805571, 8.250250273805571, 5.0369801310188596, 5.0369801310188596, 5.65514506531496, 5.65514506531496, 8.313224731328155, 8.313224731328155, 8.8860048173075, 8.8860048173075, 8.90922151933145, 8.90922151933145, 7.835940569375373, 7.835940569375373, 5.820806422801136, 5.820806422801136, 14.78383288173925, 14.78383288173925, 2.9076265585415553, 2.9076265585415553, 5.8662906465256395, 5.8662906465256395, 5.45699626550548, 5.45699626550548, 6.693644985857027, 6.693644985857027, 14.086113912043931, 14.086113912043931, 9.968935041155826, 9.968935041155826, 8.346238654502303, 8.346238654502303, 8.04461828906641, 8.04461828906641, 5.792601331425821, 5.792601331425821, 13.23840334964619, 13.23840334964619, 7.326725566676518, 7.326725566676518, -0.5671768126013739, -0.5671768126013739, 5.745841031730131, 5.745841031730131, 2.4366436654793384, 2.4366436654793384, 3.069065418716585, 3.069065418716585, 5.663986286505108, 5.663986286505108, 7.151538026328181, 7.151538026328181, 4.615696113485086, 4.615696113485086, 5.750949646831718, 5.750949646831718, 8.198235568147895, 8.198235568147895, 2.1682222320602875, 2.1682222320602875, 7.509851276441681, 7.509851276441681, 3.3147871134767897, 3.3147871134767897, 1.2532245149503956, 1.2532245149503956, 12.354276949631938, 12.354276949631938, 3.230847966397036, 3.230847966397036, 6.89612262443254, 6.89612262443254, -2.7300650173160492, -2.7300650173160492, 4.321456116689876, 4.321456116689876, 5.327365911803702, 5.327365911803702, 5.766740642414477, 5.766740642414477, 7.8114923362772375, 7.8114923362772375, 3.1277184961174354, 3.1277184961174354, 7.065491414014782, 7.065491414014782, 4.332978422818099, 4.332978422818099, 4.958155149259212, 4.958155149259212, 5.093981367050253, 5.093981367050253, 6.4331329982940915, 6.4331329982940915, 5.4633436250443435, 5.4633436250443435, 4.019393061477788, 4.019393061477788, 5.222456439312012, 5.222456439312012, 6.347234190726188, 6.347234190726188, -0.19471758167463957, -0.19471758167463957, 5.317843166507339, 5.317843166507339, 8.36803850560424, 8.36803850560424, 4.571167241988673, 4.571167241988673, 13.897916094616757, 13.897916094616757, 9.584904175587997, 9.584904175587997, 7.367527443154518, 7.367527443154518, 8.90851975748419, 8.90851975748419, 7.177469339652576, 7.177469339652576, 6.340794947678806, 6.340794947678806, 6.294286262213268, 6.294286262213268, 10.430771212060119, 10.430771212060119, 3.8403135267668196, 3.8403135267668196, 4.591468623975961, 4.591468623975961, 4.500744426929115, 4.500744426929115, 6.215124117656648, 6.215124117656648, 8.575871146044031, 8.575871146044031, 11.19047569149053, 11.19047569149053, 4.4132813302806335, 4.4132813302806335, -0.7696623015473354, -0.7696623015473354, 3.5137092366269167, 3.5137092366269167, 6.755009039517699, 6.755009039517699, 4.152018237543661, 4.152018237543661, 3.896605764009349, 3.896605764009349, 1.717388055922636, 1.717388055922636, 8.145387765480665, 8.145387765480665, 6.618054045642058, 6.618054045642058, 5.0767069038925055, 5.0767069038925055, 4.86468305973016, 4.86468305973016, 5.304145208643284, 5.304145208643284, 6.4600706377082835, 6.4600706377082835, 4.529953673878521, 4.529953673878521, 2.195676439613756, 2.195676439613756, 6.358432289973785, 6.358432289973785, 8.888456345002458, 8.888456345002458, 3.8739538868571404, 3.8739538868571404, 15.20022963636248, 15.20022963636248, 6.397647194538749, 6.397647194538749, 5.332253394781306, 5.332253394781306, 6.577681187806454, 6.577681187806454, 3.264344015666368, 3.264344015666368, 6.180267872932882, 6.180267872932882, 9.940810445327129, 9.940810445327129, 3.2347902829025807, 3.2347902829025807, 4.649524984923119, 4.649524984923119, 6.605268700424459, 6.605268700424459, 4.339182209485455, 4.339182209485455, 8.517848036054996, 8.517848036054996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27798379679084695, "mean_inference_ms": 2.0910518718554982, "mean_action_processing_ms": 0.09565594583174744, "mean_env_wait_ms": 0.5746157722162233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 192375, "timesteps_this_iter": 0, "agent_timesteps_total": 577125, "timers": {"sample_time_ms": 11053.005, "sample_throughput": 305.347, "load_time_ms": 0.596, "load_throughput": 5667070.739, "learn_time_ms": 1628.854, "learn_throughput": 2072.009, "update_time_ms": 19.137}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 14.800571727752686, "policy_loss": -0.004244723415467888, "vf_loss": 14.81303825378418, "vf_explained_var": -0.04644510746002197, "kl": 0.0033123752494835373, "entropy": 0.822216272354126, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.6680860996246336, "policy_loss": -0.01202396333683282, "vf_loss": 2.687880825996399, "vf_explained_var": 0.4774544686079025, "kl": 0.006012115117428465, "entropy": 0.777312594652176, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192375, "num_agent_steps_sampled": 577125, "num_steps_trained": 192375, "num_agent_steps_trained": 577125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7695, "training_iteration": 57, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-11", "timestamp": 1706106071, "time_this_iter_s": 10.72610330581665, "time_total_s": 691.3936586380005, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D4AAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 691.3936586380005, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 23.792857142857144, "ram_util_percent": 73.62857142857145, "gpu_util_percent0": 0.325, "vram_util_percent0": 0.21491350446428573}}
{"episode_reward_max": 19.091219713116804, "episode_reward_min": -16.870429099922998, "episode_reward_mean": 0.21307136799469278, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.104645891871105, "policy_agent_": -3.0223881416771694}, "policy_reward_max": {"policy_adversary_": -4.608964283788256, "policy_agent_": 24.562136340859084}, "policy_reward_mean": {"policy_adversary_": -12.43862140004592, "policy_agent_": 6.3258463840203065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0514389449573125, -3.013656501511864, 0.5594609486220049, 0.2674588794559142, -0.4194653585353517, 0.03186813306564852, 1.2511845662640206, 3.0138622089529408, 3.506248553694069, -1.48615756071572, -2.4830799998292257, 5.110151107070403, -6.575418013403248, -3.1486756356674093, 2.8844971976972835, 3.659156009444656, -6.348006488970399, 0.7509229024413324, 3.2309549721793402, 1.0678602256546719, -0.05547177632620076, -9.47289181391505, 1.9786499014231689, 9.554718473247641, 7.847662361563573, 1.6598989778040947, -0.6842133127573107, 2.145161964143556, -14.85418796345573, -2.4524428370303104, 0.7696750859569303, 5.5028828238899665, -6.0237351073246455, 0.14973009081801575, -6.739243350485977, 13.188534006264186, 3.0948495832693887, 4.182702627058029, 4.15134286255298, 6.767990709937376, 2.6002695623242373, 5.184872106157584, -0.9769387538193968, 7.080511028890943, 1.5481873705731939, -1.7199182142429215, -2.90011515976769, 2.5595786414851895, 5.924850411300256, -5.939084251851847, -16.870429099922998, 6.062169008340691, -3.7158020694995235, -6.026173187600593, -2.938731230926699, 0.6619030758860409, 19.091219713116804, -2.077569251392674, -4.810402083169022, 7.71174244770441, 0.2499321794804612, -5.540385642961293, 6.047029889076156, -0.49912909141181755, 2.9130964271896103, 3.6961396051277964, 1.8786016576551368, -15.426049729938294, -2.5703301743765183, -3.51392914859256, -0.5724577534891819, -9.536678273506475, 5.338650712215465, 5.315540572603287, -4.064736005859287, -1.0934089876933855, -0.34376665456524774, 2.83610462159765, -3.908959431616137, 0.655614082513628, 9.854367774716225, 5.96852368972889, 8.712499467942335, 0.7547035510314299, -0.9372413036255025, 2.1550725085707794, -2.48015992730251, -5.882958846499378, -11.254898466089024, 2.602964974814982, 0.8171466832111004, -0.30982615941670505, 0.2804953796894559, -0.48255074002820586, 0.26580118059770036, 0.18416459567124357, -2.740581635717314, 2.6012756149860454, -1.457602196314403, 1.2583078995880241, -0.14207105824358235, 0.777335572044871, 4.53617534933481, 0.6752422207439239, 2.276360589211021, -1.5507163982693684, 2.5173444905225475, -2.849016257977698, 2.720426051610292, -4.306731681054499, -2.9305624057913224, 0.8462032168452486, -1.1972230166155629, 4.948698031258929, -0.1345059590845068, -9.266126985392727, -2.2177598639628506, 4.578628395066709, -9.501042652370698, -5.757256459043549, 4.835386168683274, 2.947775992431948, 1.7851876990334237, -0.8403096017960043, -6.9735587261058365, -1.1064653150511639, -2.8335361876647753, 7.107877537902291, -3.75785325967655, 5.933866413450477, 1.437643907391605, -0.6916677759515475, 3.9890793318881532, 3.9487039387478715, -0.883637982921847], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-21.577840112649433, -15.541504235408087, -7.980536053229528, -10.202335371048854, -11.210543132470836, -8.01135365820869, -8.826340272291764, -7.171588825693706, -16.41358184650426, -11.964818943116285, -6.613104837775338, -10.186651944408638, -13.182352032398269, -22.837774467623852, -11.516253533899999, -14.281749345898563, -15.02752683427051, -11.031377163715677, -9.192809426631502, -10.352240435960951, -15.183209356364326, -17.450553666446314, -17.560404001230065, -17.999469269115487, -14.033023663351365, -5.309791533217096, -9.462112764523102, -11.150390370561471, -8.809411680101395, -5.942418670787636, -17.856427915456674, -15.019136983013592, -19.68702238226622, -10.80559330702122, -4.755580739834501, -20.84778704996584, -10.265195662024786, -10.477903341601495, -13.998756713522354, -12.473112598112957, -14.380479035114007, -11.321258498979205, -16.237205873042292, -15.534053933275688, -31.104645891871105, -8.436827069830501, -9.073335939203272, -9.750947002740276, -11.958363314542032, -14.570765399817494, -16.816808777374344, -14.404574025060754, -7.078356892651979, -15.830455347499504, -6.998786615012645, -9.909809062817708, -30.03305296860136, -15.624913705187945, -8.30286006016883, -15.58419476648692, -10.522542972735994, -9.637123668959632, -13.544348686911611, -4.608964283788256, -10.061543951316619, -10.845642699018766, -11.144422528581854, -17.99938709672101, -13.846768433113665, -16.534008868470277, -13.877974184850627, -5.48626003014728, -14.363859797096652, -11.159865512414179, -9.12307090206405, -8.450201847956356, -14.631358194425895, -10.999892902018475, -9.804448328136559, -16.128338749179896, -16.76177802753247, -14.713046556188957, -16.55345030009143, -9.67603716635101, -16.153879240820075, -14.479997668682337, -14.104353164851377, -21.205677196592763, -18.20944210676923, -20.36662114752474, -8.266694940664989, -12.557218592745546, -12.396747865194982, -14.993986939281816, -12.426654159821283, -5.3689215768959855, -6.495117506267475, -17.862756268571115, -9.13497416141118, -8.256262014956055, -23.560162192242593, -9.348416270667572, -10.749695303263316, -8.338290970014508, -17.751572202606226, -5.727936236067761, -14.456493240747323, -15.152186088800038, -14.34041676998997, -12.095189084023295, -7.69283468645937, -5.972875823299747, -16.36410820950281, -10.713095189192247, -4.637796046133587, -23.444259892156595, -9.865588609696363, -12.677948516353137, -8.849215678669966, -7.778122332458162, -12.097112003343918, -9.54784089928618, -8.367769638092776, -5.516151311723825, -7.792453148489934, -10.047179400414135, -6.676080644913241, -19.039072570722595, -8.715207848087347, -15.429373663776632, -6.973739290800632, -10.07574338435423, -8.421090406196669, -14.521920804419175, -8.5620320891101], "policy_policy_agent__reward": [13.314639528803378, 13.314639528803378, 6.263923866948106, 6.263923866948106, 4.269998500925767, 4.269998500925767, 5.234897125252383, 5.234897125252383, 5.395538886967742, 5.395538886967742, 4.0216108956371714, 4.0216108956371714, 5.0387624192778935, 5.0387624192778935, 5.092725517323324, 5.092725517323324, 9.959915200099166, 9.959915200099166, 5.2393306912002835, 5.2393306912002835, 2.065012418973055, 2.065012418973055, 7.648401525739518, 7.648401525739518, 3.30346700949751, 3.30346700949751, 9.844549415978218, 9.844549415978218, 7.200375365798642, 7.200375365798642, 8.970452677671608, 8.970452677671608, 4.339760172650056, 4.339760172650056, 5.891150033078505, 5.891150033078505, 6.211882199405421, 6.211882199405421, 5.710050330807812, 5.710050330807812, 7.56386879001906, 7.56386879001906, 3.9888309262656345, 3.9888309262656345, 9.769526951326615, 9.769526951326615, 13.777093871181563, 13.777093871181563, 10.940343012457472, 10.940343012457472, 3.4848452555105958, 3.4848452555105958, 4.388949725882896, 4.388949725882896, 6.647776167352511, 6.647776167352511, -3.0223881416771694, -3.0223881416771694, 1.7449879168786635, 1.7449879168786635, 9.313051500706802, 9.313051500706802, 10.261009903451775, 10.261009903451775, 6.83164363747079, 6.83164363747079, 5.477661698919617, 5.477661698919617, -0.9918313053257354, -0.9918313053257354, 17.018160528115015, 17.018160528115015, 6.680022622647088, 6.680022622647088, 7.330302984329763, 7.330302984329763, 9.075049788037665, 9.075049788037665, 9.620551654025167, 9.620551654025167, 8.490374298719122, 8.490374298719122, 8.253065302568396, 8.253065302568396, 7.63013355961145, 7.63013355961145, 11.307282481083318, 11.307282481083318, 16.326416631222145, 16.326416631222145, 3.35845442779379, 3.35845442779379, 3.086610389717789, 3.086610389717789, 6.155262822112733, 6.155262822112733, 8.941606862921143, 8.941606862921143, 4.315840573982824, 4.315840573982824, -0.026810161274331112, -0.026810161274331112, 10.233371516700727, 10.233371516700727, 1.6812774115762297, 1.6812774115762297, 4.9021410799494545, 4.9021410799494545, 2.0300276920429723, 2.0300276920429723, 5.285856069351874, 5.285856069351874, 24.562136340859084, 24.562136340859084, 6.773672226897635, 6.773672226897635, 1.7462289884999052, 1.7462289884999052, 11.647968607095665, 11.647968607095665, 5.386237576108229, 5.386237576108229, 2.048369012999171, 2.048369012999171, 9.79568928799389, 9.79568928799389, 2.0549175961882193, 2.0549175961882193, 6.487320189253116, 6.487320189253116, 7.270891152073284, 7.270891152073284, 6.511512093118492, 6.511512093118492, 1.2866686833913585, 1.2866686833913585, 5.638219129368577, 5.638219129368577, 6.510039859938862, 6.510039859938862, 6.652758215680723, 6.652758215680723, -2.0252091216795973, -2.0252091216795973, 9.851255254656055, 9.851255254656055, 8.237703042508734, 8.237703042508734, 2.5291674481023825, 2.5291674481023825, 3.6783964301314858, 3.6783964301314858, 7.14379576993032, 7.14379576993032, 6.917998761808063, 6.917998761808063, 2.947744448260212, 2.947744448260212, 8.391976415846763, 8.391976415846763, 13.308072901124348, 13.308072901124348, 10.34078512295892, 10.34078512295892, 12.632974884016884, 12.632974884016884, 5.21537035869122, 5.21537035869122, 7.6083189685972865, 7.6083189685972865, 8.317535088626558, 8.317535088626558, 5.812096618774434, 5.812096618774434, 7.661359175046694, 7.661359175046694, 3.477271820340103, 3.477271820340103, 11.48479306116986, 11.48479306116986, 4.541920811938044, 4.541920811938044, 6.123696216664423, 6.123696216664423, 6.3386216224422185, 6.3386216224422185, 7.255718099626808, 7.255718099626808, 6.346227670209491, 6.346227670209491, 2.776543086283615, 2.776543086283615, 1.8772679352750803, 1.8772679352750803, 10.232015941778581, 10.232015941778581, 3.8386859825483897, 3.8386859825483897, 4.757284957272038, 4.757284957272038, 11.709045566999508, 11.709045566999508, 5.0628759213562216, 5.0628759213562216, 7.642935326299061, 7.642935326299061, 4.506766595379216, 4.506766595379216, 10.013966395908623, 10.013966395908623, 2.0886099188991962, 2.0886099188991962, 8.486918865634934, 8.486918865634934, 6.151584915411171, 6.151584915411171, 8.53042141080013, 8.53042141080013, 3.8942287014843964, 3.8942287014843964, 2.381136140334023, 2.381136140334023, 3.4095395200724985, 3.4095395200724985, 7.583442596443622, 7.583442596443622, 7.8308966102255875, 7.8308966102255875, 2.2516450435245394, 2.2516450435245394, 7.0890664533819345, 7.0890664533819345, 3.823914372866756, 3.823914372866756, 8.628288455709924, 8.628288455709924, -0.32591348685036625, -0.32591348685036625, 1.0104329367073073, 1.0104329367073073, 8.466249086013596, 8.466249086013596, 6.247808445859066, 6.247808445859066, 5.076478668563102, 5.076478668563102, 2.3379208549639103, 2.3379208549639103, 0.4094472111920475, 0.4094472111920475, 4.4703570426814885, 4.4703570426814885, 1.9212722286242325, 1.9212722286242325, 13.073475054312444, 13.073475054312444, 2.4786772942053985, 2.4786772942053985, 10.681620038613556, 10.681620038613556, 4.2056915990961175, 4.2056915990961175, 4.69203780420134, 4.69203780420134, 6.2050848690424125, 6.2050848690424125, 9.235312371583525, 9.235312371583525, 3.839197053094125, 3.839197053094125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.277767060384066, "mean_inference_ms": 2.0870640353629284, "mean_action_processing_ms": 0.09548215229019866, "mean_env_wait_ms": 0.5736089099731667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 195750, "timesteps_this_iter": 0, "agent_timesteps_total": 587250, "timers": {"sample_time_ms": 11045.72, "sample_throughput": 305.548, "load_time_ms": 0.496, "load_throughput": 6807297.908, "learn_time_ms": 1627.258, "learn_throughput": 2074.041, "update_time_ms": 18.74}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.250276565551758, "policy_loss": 0.0046134610776789485, "vf_loss": 16.253808784484864, "vf_explained_var": -0.055325019359588626, "kl": 0.007108808222695514, "entropy": 0.8144741296768189, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.352948772907257, "policy_loss": -0.00507847840199247, "vf_loss": 3.365592837333679, "vf_explained_var": 0.4578749895095825, "kl": 0.005541984071947626, "entropy": 0.756774079799652, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195750, "num_agent_steps_sampled": 587250, "num_steps_trained": 195750, "num_agent_steps_trained": 587250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7830, "training_iteration": 58, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-22", "timestamp": 1706106082, "time_this_iter_s": 10.914063692092896, "time_total_s": 702.3077223300934, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5F19D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 702.3077223300934, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.97142857142857, "ram_util_percent": 73.56428571428572, "gpu_util_percent0": 0.15357142857142855, "vram_util_percent0": 0.21669224330357142}}
{"episode_reward_max": 10.789161794413282, "episode_reward_min": -14.889349169273125, "episode_reward_mean": 0.4032203351886269, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.099224322985386, "policy_agent_": -1.557890707958019}, "policy_reward_max": {"policy_adversary_": -3.7045179925813643, "policy_agent_": 17.975251620127498}, "policy_reward_mean": {"policy_adversary_": -12.508196772012825, "policy_agent_": 6.455708553600727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.178624121787543, -1.355426492144925, 7.067175368639271, 3.3560892853900572, -4.382958794311307, 1.222410339062293, 4.438250285899238, 4.937495055322462, 0.5763317018207101, 6.44870420502391, 6.106697206954183, -4.9357192007944395, -13.41814856909443, -3.8801442376248465, 3.83854479656779, 2.7752588455694296, -7.138150678566309, 0.5356942816864032, 4.428048762448075, -0.21399747676908093, 10.111136167238975, 5.378874578545428, 6.127186980251894, -4.317633457481169, -2.986319914306773, 4.863268993157842, -4.4193820301394515, -5.896053813368146, 3.6205460856150813, -1.919349584405201, -0.4341304773044082, 2.0102746424851254, 1.7565695972303494, 0.8664063799268134, -1.6513437374146323, -0.14754828420680016, -0.36429779663264134, 1.9769467889810257, -0.29998084050666063, -1.2276971141231738, 5.173826049841301, 6.884300122183775, -10.106171801749333, -12.161437474211146, 3.899228219015095, 5.5165257660215365, 2.534665907012594, -9.39236363676974, 2.132326196815169, 0.19848631248246873, -0.5557956410232815, -2.0373941804755002, 1.29149459372634, 2.8096177731263507, 5.413203934621036, -14.889349169273125, 5.058234863766632, -5.141881070958279, -6.7673950269295124, -4.172569390116006, 3.3189291765088638, 5.547518151204588, 0.8820470076709792, -7.571147988405729, -9.266032930310175, 1.4275698519257487, 5.458399238642802, 5.103038069155831, 2.3084901399565054, 3.3090771360938676, 6.85802156619891, -1.108644558482185, 9.062320479141444, -2.422853881952041, 5.04150461167154, -5.134498865045322, -10.43798743328413, -1.0819944224637126, 4.8286265955354235, -4.389021027810056, -8.52110550235943, 10.784557924901176, -3.2818290588061703, -7.119559247630415, 2.293627067628699, -9.752166134175495, 3.7944031370738034, 7.741025122161375, 7.2620809403190485, -0.4544741915496854, 8.64975785979851, -8.463818989291111, -0.00834566804221093, 0.1890817824515188, 0.3284908997437237, -0.18917271865570423, 0.513947677158227, -6.832708117965738, -2.4969194301250597, -7.795035834999127, 1.9634164780949237, -3.7563038896144034, -3.43606002683193, 4.016314486178269, 5.4073920866466985, -1.83797171563615, 1.9947786198196709, -6.244802751900668, -0.19272353368688577, 6.551277601793164, 3.359362366008392, 2.5122517543567047, 2.6247018715263697, -2.1310391318600743, 7.559428139438835, 2.35898753376704, -6.665126662382225, -2.766817129213849, 9.534616814373418, 2.9657136577548675, 1.0680539624935983, 8.902058769230324, 4.722243819619636, 4.167816181973108, -3.4338406230762675, -1.9272701408589652, 8.552521028775448, 4.560813346462781, -1.8495842077598579, 4.025387275257247, 10.789161794413282, 6.082064269848837, 3.2368108382490597, -0.43955268090564903, -7.177089459419975], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.196185587775624, -9.040623719336043, -15.97292200893424, -12.842406659429333, -7.837446432577734, -7.412695390560036, -15.55637411231562, -8.687194840119007, -8.03390492532137, -14.000722400744726, -10.591102251387978, -13.975849335183101, -16.081375569823383, -12.194960772988846, -15.643288484928123, -10.361845782447746, -12.398860878538349, -6.003690197046592, -10.08385507732072, -7.074536959162147, -16.547524139237684, -29.099224322985386, -11.184088392371553, -14.014192971929015, -8.420567606515629, -24.808477251187703, -7.188130991327562, -5.9748760193778505, -13.099731024669234, -9.217930445651898, -11.54419208543168, -8.15984864414011, -6.209398611732779, -8.207750314556767, -19.250558841213525, -6.857760407685345, -13.162129029555187, -7.937202997731843, -13.82913803993395, -7.129594692485082, -19.95792986845284, -19.62561664240474, -15.80126508202766, -9.609112580877168, -9.237985282999158, -14.318641416929355, -8.954767181840058, -11.152188663169373, -6.921566523604321, -6.557307355507849, -3.7045179925813643, -6.265333252564477, -8.61710387385251, -7.629913681313718, -12.744611835730597, -12.722923006547953, -14.44269096298387, -16.625425336565343, -14.346714889253677, -10.654668189981598, -8.100290949381868, -15.823329220514088, -6.85914650428742, -9.483250500736853, -9.203507394887282, -12.957579493411702, -12.013180217325514, -14.245761422141316, -9.178428502557939, -12.183095979341344, -12.10304568894784, -9.46007935135798, -17.83502085328919, -5.584880026992274, -19.707483865497977, -15.180015438833053, -9.965578642930897, -9.746738870192903, -14.456653030194564, -10.880566642143682, -5.405324086443393, -25.165945315353817, -5.974998396903906, -9.979548625367784, -18.802763306093475, -21.46965402493107, -13.420461806984203, -15.595749538191397, -21.518801479407337, -8.060990276908854, -19.57492621535513, -21.36512769650907, -20.35599343683726, -15.285496314361756, -6.445302879276464, -6.667022688534979, -18.925828443191847, -11.901155030218213, -5.131220707876982, -15.747691094702876, -11.818184418305792, -7.671822402678206, -6.806385176336953, -11.872774565006994, -14.589265348429134, -14.07567170785379, -7.543251859455286, -12.825230492482019, -9.861639252596838, -19.511704625470703, -8.238669985177228, -17.73948846344256, -13.753388805241196, -21.403139970917938, -14.879155348477877, -8.91273241814291, -11.279251572031045, -11.895738979772439, -22.412648001559727, -11.241834482553074, -10.998756897478906, -16.944870645332305, -13.322859480873296, -18.431286825142355, -9.326033395104254, -19.93483321297002, -12.842582316257216, -11.092361070508563, -8.750357736474045, -18.648301279613705, -23.65637351628326, -12.156931119905119, -19.080173755635254, -7.597643960085673, -9.007145340872166], "policy_policy_agent__reward": [1.5087807329940388, 1.5087807329940388, 3.8425986135955577, 3.8425986135955577, 11.520048688786758, 11.520048688786758, 8.099247972409692, 8.099247972409692, 1.7272438191332131, 1.7272438191332131, 4.317552864811165, 4.317552864811165, 9.997312199107432, 9.997312199107432, 6.812344947720734, 6.812344947720734, 4.30511831357104, 4.30511831357104, 10.224713302884318, 10.224713302884318, 8.348899729171082, 8.348899729171082, 4.52006506719433, 4.52006506719433, 1.3316135003644747, 1.3316135003644747, 4.157408267682, 4.157408267682, 9.740916640747956, 9.740916640747956, 6.5685523140085875, 6.5685523140085875, 2.6303550999860197, 2.6303550999860197, 3.2696922393664973, 3.2696922393664973, 7.255951919884398, 7.255951919884398, 3.4302697411965326, 3.4302697411965326, 13.32933015323833, 13.32933015323833, 17.239049450765403, 17.239049450765403, 8.655637686311724, 8.655637686311724, 4.848279757223924, 4.848279757223924, 2.7171238461044283, 2.7171238461044283, 14.835873122172773, 14.835873122172773, 1.3843744805940563, 1.3843744805940563, 0.039411103004852066, 0.039411103004852066, 8.360138555142159, 8.360138555142159, 3.6492904306233482, 3.6492904306233482, 5.555030804063634, 5.555030804063634, 5.085061643312618, 5.085061643312618, 3.9829841044815644, 3.9829841044815644, 4.537078347241791, 4.537078347241791, 8.79960755189945, 8.79960755189945, 3.355106061739271, 3.355106061739271, 6.398915616461273, 6.398915616461273, 4.957074893356434, 4.957074893356434, 6.764578599713646, 6.764578599713646, 2.9509487891809525, 2.9509487891809525, 12.56587795914707, 12.56587795914707, 13.254958382294259, 13.254958382294259, 2.847546640139163, 2.847546640139163, -1.2761624466669863, -1.2761624466669863, 6.568606751007127, 6.568606751007127, 9.917583591475445, 9.917583591475445, 5.744716544426324, 5.744716544426324, 0.8799125131998147, 0.8799125131998147, 4.526946360209746, 4.526946360209746, 3.3778968339951576, 3.3778968339951576, 1.5743611757790417, 1.5743611757790417, 2.113969536044488, 2.113969536044488, 4.954299233789423, 4.954299233789423, 5.219765727220037, 5.219765727220037, 9.078907885175814, 9.078907885175814, -1.0832130813625869, -1.0832130813625869, 9.750462913375248, 9.750462913375248, 5.741772132803532, 5.741772132803532, 3.7896599311620833, 3.7896599311620833, 3.2410493999327965, 3.2410493999327965, 5.709610062945361, 5.709610062945361, 10.685423685859337, 10.685423685859337, 3.870596755979201, 3.870596755979201, 0.9560512561655616, 0.9560512561655616, -0.031262767711446426, -0.031262767711446426, 7.192574672668724, 7.192574672668724, 8.735789727984162, 8.735789727984162, 9.674399745648575, 9.674399745648575, 5.743459321257222, 5.743459321257222, 7.7460865577176055, 7.7460865577176055, 9.480533627573376, 9.480533627573376, 4.175717396437898, 4.175717396437898, 13.448670666215317, 13.448670666215317, 1.5810130725201172, 1.5810130725201172, 12.374494238584756, 12.374494238584756, 5.0227582868938665, 5.0227582868938665, -0.23620439517661512, -0.23620439517661512, 4.332372223864596, 4.332372223864596, 9.642639812865, 9.642639812865, 3.245772807166814, 3.245772807166814, -1.557890707958019, -1.557890707958019, 17.975251620127498, 17.975251620127498, 1.3465846690488683, 1.3465846690488683, 1.4299946888686808, 1.4299946888686808, 10.548195186861085, 10.548195186861085, 5.858743945377787, 5.858743945377787, 8.607432472029002, 8.607432472029002, 11.66838733017638, 11.66838733017638, 14.390441209863194, 14.390441209863194, 3.803258042679584, 3.803258042679584, 14.11234203757682, 14.11234203757682, 6.450654353608984, 6.450654353608984, 10.17382388439752, 10.17382388439752, 7.737289048406639, 7.737289048406639, 3.386896889510094, 3.386896889510094, 3.238924984939638, 3.238924984939638, 9.719888060175037, 9.719888060175037, 2.5342234561262402, 2.5342234561262402, 1.31715063887596, 1.31715063887596, 3.976327629851875, 3.976327629851875, 6.890800448200359, 6.890800448200359, 1.9577592565319029, 1.9577592565319029, 1.6851625747525125, 1.6851625747525125, 7.944544525592634, 7.944544525592634, 9.998328717537916, 9.998328717537916, 6.1188499961088185, 6.1188499961088185, 4.769015239637479, 4.769015239637479, 3.2902138702906742, 3.2902138702906742, 4.834457859454976, 4.834457859454976, 13.031491113631928, 13.031491113631928, 5.799016175592809, 5.799016175592809, 10.12587010889963, 10.12587010889963, 8.189045338383783, 8.189045338383783, 9.636050419528935, 9.636050419528935, 11.219291743958355, 11.219291743958355, 5.635859975954974, 5.635859975954974, 2.30706245482441, 2.30706245482441, 4.564460925279297, 4.564460925279297, 15.973632407966573, 15.973632407966573, 7.103774070153972, 7.103774070153972, 6.03340542998625, 6.03340542998625, 12.923464707281314, 12.923464707281314, 9.022551650246463, 9.022551650246463, 11.299551503557739, 11.299551503557739, 2.946096386013993, 2.946096386013993, 9.003781536055525, 9.003781536055525, 10.697551672516333, 10.697551672516333, 7.826587208485671, 7.826587208485671, 3.4503867643570945, 3.4503867643570945, 11.336844277435471, 11.336844277435471, 17.222767655348267, 17.222767655348267, 9.11949769487698, 9.11949769487698, 11.158492296942162, 11.158492296942162, 3.5790456395900123, 3.5790456395900123, 0.9150279407260985, 0.9150279407260985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2771565073833144, "mean_inference_ms": 2.0830660529528746, "mean_action_processing_ms": 0.09527018999140363, "mean_env_wait_ms": 0.5727471479368211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 199125, "timesteps_this_iter": 0, "agent_timesteps_total": 597375, "timers": {"sample_time_ms": 11040.461, "sample_throughput": 305.694, "load_time_ms": 0.493, "load_throughput": 6842175.069, "learn_time_ms": 1627.358, "learn_throughput": 2073.914, "update_time_ms": 18.643}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 15.551991176605224, "policy_loss": -0.013552249781787396, "vf_loss": 15.57351894378662, "vf_explained_var": -0.04427268505096436, "kl": 0.003927443696039279, "entropy": 0.7975242555141449, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.195054352283478, "policy_loss": 0.023026742972433567, "vf_loss": 3.1797239065170286, "vf_explained_var": 0.492798438668251, "kl": 0.0071268619670127546, "entropy": 0.7698992282152176, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 199125, "num_agent_steps_sampled": 597375, "num_steps_trained": 199125, "num_agent_steps_trained": 597375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7965, "training_iteration": 59, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-33", "timestamp": 1706106093, "time_this_iter_s": 10.838320970535278, "time_total_s": 713.1460433006287, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D4A8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 713.1460433006287, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 25.014285714285712, "ram_util_percent": 73.52142857142857, "gpu_util_percent0": 0.20142857142857146, "vram_util_percent0": 0.214111328125}}
{"episode_reward_max": 13.555540661832366, "episode_reward_min": -16.38617650463305, "episode_reward_mean": -0.38391213119364503, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.86720272560266, "policy_agent_": -3.724875765785379}, "policy_reward_max": {"policy_adversary_": -5.140916978111281, "policy_agent_": 17.012244862218946}, "policy_reward_mean": {"policy_adversary_": -12.107288805794704, "policy_agent_": 5.86168833730053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.412662110735129, -6.754269654643378, -2.0532433763448292, 6.321962225837466, -2.37514075298471, -7.0480663594567465, 1.0696748100212121, -0.14238064675277098, 1.9785737724727044, -1.0278481712546288, -0.9691989898696559, 1.8572046203477826, -5.763025953190042, -3.950928643322275, -6.543154045693742, 4.991841537632501, 1.3325000076040647, 1.7645573029894908, -5.8316416682874666, -6.40266703903584, 2.9069280640028796, -0.7527947046139271, -5.190037890018959, -6.928049045243507, -0.14043642506150034, 4.46989215121773, 0.7103928296359748, -1.5989999559594132, 6.121492298810652, 13.555540661832366, -6.423192792445612, -9.014142312350398, -1.175868522994517, -4.9398740667332435, 2.2058385010040356, 2.1497405982554407, -3.9162590648085427, 9.639034190558199, 0.6805647060172565, -0.44802485524379243, 1.8928435592692332, -2.4247649617308404, 5.079513338364153, 5.134804340089689, -2.1029613295675667, -0.6493443329699922, 6.446492748240563, -1.9833436259617794, 4.413640744552982, -1.523424254923763, 3.711082770371153, -1.8699595911270257, 1.166022697764248, 3.411306941698849, 4.951179777798059, -9.923580911402748, 0.0770971367073755, -3.614744116330664, 2.752928048056536, -3.3965971341517216, 4.7351301277482305, 3.5512693542006355, -3.9722169721484053, 0.47824306900544, 6.5318203437158004, 1.443135364311046, -1.2394439297601065, -14.34172421268839, 6.474570430098072, 3.9036856430275506, -6.300347147111558, 0.7733194360767871, -3.455426427816707, 2.733743986632491, -0.0894141111141119, 4.298668934049252, 2.7480752777091633, -16.38617650463305, -0.19437353438146168, -1.3007024003092678, 12.267222349218514, 5.825098370802421, -3.3377821347059284, -4.9790512209700815, -3.699079431174265, -4.849985814529914, 4.157864654188293, 1.7439460644482052, -1.5420058337194362, -12.253024871514356, 2.8710310493013473, -7.671807266708618, 0.6352959212132343, 3.3487177486758344, -2.427712581321509, 0.5084964322401332, -1.0132449531313599, 5.883833001029293, -2.7273689622474047, 0.44299878678483007, -1.4686101859744856, 10.119649531839485, -16.31236092548657, -5.932264918424138, 2.111760297030255, 0.8345463751268287, -8.880884062306231, -1.8518964448253072, 2.2230770215091455, -1.8362710438110483, 4.644958262046112, 6.975219671016456, -0.26919454603329057, -8.788314161121471, -6.516236703564221, 12.040391850466328, 0.7401542910460197, -1.0049535341272664, -2.920047191073232, -1.08424153965482, 0.012154542884950992, 3.3532976451910703, 1.097801984299379, -0.5136836166341088, -4.069512111242839, 3.8016213991883605, 3.802217142861699, 2.5762396996327075, -4.377873090711423, -7.616115560436739, -0.7761690026244071, -5.259253557685948, 2.0636471594160555, 8.125047044153318, -11.774664765015467], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.862218558117156, -14.674421850347006, -5.140916978111281, -13.505629423343256, -9.874762815553941, -8.122155160222013, -6.7671809120520106, -13.194464079157923, -13.393809962062452, -27.86720272560266, -11.665038312363807, -8.493545069754195, -5.485887814808868, -9.041979453088723, -11.849516574394421, -13.774013366956844, -6.802730806695129, -11.837491662873738, -8.569485017899606, -16.033316125266012, -14.128945945043066, -10.095454476603024, -7.808565215273345, -15.513548948364988, -7.032131572266202, -12.290166128523316, -8.229421018819952, -5.51179855529525, -12.635992301603792, -18.240764755364413, -12.291564733865421, -9.148761767148349, -7.377582205023603, -8.701052427888055, -12.197534431279019, -14.612571436524002, -7.393242238223421, -17.13489033714729, -7.468709181191307, -9.862905288627285, -7.501704795661385, -5.383370993386437, -17.37281263110662, -12.948631610099241, -12.6459503095487, -8.244236259717665, -15.55596553790418, -12.903949044675777, -9.12368762004275, -10.140321919664919, -9.127300385180254, -7.492214814976606, -8.46614657397321, -12.428633525047044, -13.190923672153504, -12.859133312226978, -11.817188729722382, -7.1358616327676545, -12.886848422156175, -11.406461045488346, -19.443023843320226, -13.995368956994138, -9.407461485559278, -9.014144503385527, -12.398125025467394, -19.61865747870583, -15.793216198770796, -16.303469154175605, -15.681138666559733, -13.414933000348404, -15.092529710152267, -11.027798889350656, -6.504561522868495, -6.831219739476235, -11.231319621740223, -8.01343264206569, -10.56991820229377, -15.895247615786749, -5.763189387103363, -16.518743890279612, -19.240114942814408, -17.13079165534211, -7.5824877779023225, -10.86343616844687, -12.225901386704427, -8.89139775478137, -11.831586299871931, -10.70537472285934, -8.442524544482648, -14.624778461538243, -9.75957855419358, -8.298183870732224, -15.337868429971625, -8.752325076389054, -8.005219058985523, -11.59423708453272, -14.632022724707145, -14.155049645273078, -16.415320054245807, -14.555505615803082, -11.726301761486203, -21.43185052376362, -8.862609393915815, -14.047376609420638, -11.700648047453296, -17.347693149261243, -12.045850794534447, -5.9862135498923905, -10.227576652934188, -15.922345743708576, -11.203109220122371, -10.984972913399561, -8.23848435680458, -14.940799051055718, -12.34307908123661, -21.98409787397156, -14.709759568588396, -5.144286705616016, -11.794823779171761, -16.17422890445192, -10.548047028606376, -11.584379411331913, -15.663156920499265, -10.059224979628038, -20.555494266548834, -19.475461168886692, -16.831996564941065, -14.80057685781139, -12.271153653767096, -10.504835893650535, -16.823219792737973, -8.705335651115472, -13.448842343953666, -19.480928395736353, -12.091312340054063], "policy_policy_agent__reward": [12.137440334426142, 12.137440334426142, 3.9600760978518137, 3.9600760978518137, 1.543836800883225, 1.543836800883225, 9.913795824590363, 9.913795824590363, 3.7498110312846156, 3.7498110312846156, 0.5370444003826353, 0.5370444003826353, 3.9184278610366112, 3.9184278610366112, 6.526041716202577, 6.526041716202577, 7.686191867267576, 7.686191867267576, 13.419677277174014, 13.419677277174014, 5.347919661247073, 5.347919661247073, 5.175374845050991, 5.175374845050991, -0.13856906919058773, -0.13856906919058773, 2.5455254048832248, 2.5455254048832248, 2.653181264350334, 2.653181264350334, 9.382927452294673, 9.382927452294673, 4.067615407149597, 4.067615407149597, 6.801024482931613, 6.801024482931613, 1.3689216748060702, 1.3689216748060702, 4.815324543115085, 4.815324543115085, 8.517937004522974, 8.517937004522974, 4.671329885994549, 4.671329885994549, 1.3092636626271916, 1.3092636626271916, 4.29274995156074, 4.29274995156074, 3.445847573602351, 3.445847573602351, 8.380029139870526, 8.380029139870526, 4.469906924227964, 4.469906924227964, 1.9563992996679185, 1.9563992996679185, 9.378742300207222, 9.378742300207222, 15.898152708598396, 15.898152708598396, 2.934185970709906, 2.934185970709906, 0.06730972739897444, 0.06730972739897444, 3.1008568410145427, 3.1008568410145427, 1.880589180577406, 1.880589180577406, 7.201686466141523, 7.201686466141523, 8.381156017389719, 8.381156017389719, 1.7384915867074404, 1.7384915867074404, 13.386962263852746, 13.386962263852746, 4.074636943604283, 4.074636943604283, 4.707440216691748, 4.707440216691748, 4.697274177465308, 4.697274177465308, 1.479303015827799, 1.479303015827799, 11.226162984735389, 11.226162984735389, 9.04171797509446, 9.04171797509446, 5.271494489990567, 5.271494489990567, 3.7974459633738356, 3.7974459633738356, 11.001229143072374, 11.001229143072374, 5.460302709356999, 5.460302709356999, 6.768664182297865, 6.768664182297865, 4.308448832370577, 4.308448832370577, 6.419191577775704, 6.419191577775704, 2.8111276119247894, 2.8111276119247894, 4.81608463586873, 4.81608463586873, 7.919970233372947, 7.919970233372947, 9.071051724975778, 9.071051724975778, 1.4677762004121149, 1.4677762004121149, 5.947142933214881, 5.947142933214881, 1.7605587582184947, 1.7605587582184947, 7.8198882351063554, 7.8198882351063554, 4.004931955668312, 4.004931955668312, 12.089076985534229, 12.089076985534229, 8.773319155597388, 8.773319155597388, 2.7176222567054364, 2.7176222567054364, 4.746193786195483, 4.746193786195483, 9.464972684591599, 9.464972684591599, 10.530896421508439, 10.530896421508439, 7.276886134505346, 7.276886134505346, 0.9808724707436044, 0.9808724707436044, 11.077854548328903, 11.077854548328903, 8.65930932168798, 8.65930932168798, 4.396091281520355, 4.396091281520355, 5.900559162713722, 5.900559162713722, 1.5245675475258937, 1.5245675475258937, 4.782481863054364, 4.782481863054364, 5.570952755313052, 5.570952755313052, 6.156050788057471, 6.156050788057471, 6.658996740001468, 6.658996740001468, -0.24546444442315157, -0.24546444442315157, 2.784407926360951, 2.784407926360951, 7.609020744985171, 7.609020744985171, 15.753668646016463, 15.753668646016463, 11.47794501307227, 11.47794501307227, 2.122352821598198, 2.122352821598198, 2.942192473738393, 2.942192473738393, 4.26341097776508, 4.26341097776508, 2.0207059701257264, 2.0207059701257264, 7.994725477030112, 7.994725477030112, 6.224660393653773, 6.224660393653773, 3.4502593553816054, 3.4502593553816054, 1.1858767950119444, 1.1858767950119444, 6.3153048017474624, 6.3153048017474624, 0.3131883020118033, 0.3131883020118033, 7.9865821755924316, 7.9865821755924316, 6.050521412532443, 6.050521412532443, 2.788753238832007, 2.788753238832007, 6.0513667583864255, 6.0513667583864255, 6.809388885787891, 6.809388885787891, 10.019441323151186, 10.019441323151186, 6.8439755459992, 6.8439755459992, 7.499252201293954, 7.499252201293954, 5.128845787755856, 5.128845787755856, 15.775750027801552, 15.775750027801552, -3.724875765785379, -3.724875765785379, 4.057555845498248, 4.057555845498248, 6.906204172241774, 6.906204172241774, 9.091119762194037, 9.091119762194037, 1.5824833661141078, 1.5824833661141078, 2.067158552533542, 2.067158552533542, 6.225326837221668, 6.225326837221668, 7.043037349948764, 7.043037349948764, 7.924033741084244, 7.924033741084244, 8.980096292208007, 8.980096292208007, 3.984644905385646, 3.984644905385646, 3.0762424449671233, 3.0762424449671233, 2.9134211888361956, 2.9134211888361956, 17.012244862218946, 17.012244862218946, 7.724956929817209, 7.724956929817209, 2.0696665857443755, 2.0696665857443755, 4.437388294049265, 4.437388294049265, 7.544993682398547, 7.544993682398547, 5.280100785745663, 5.280100785745663, 7.46883852826149, 7.46883852826149, 8.380479452399324, 8.380479452399324, 4.772770681496963, 4.772770681496963, 8.242991077652999, 8.242991077652999, 11.638541284037522, 11.638541284037522, 10.317106853901377, 10.317106853901377, 8.688408278722047, 8.688408278722047, 3.946640281527837, 3.946640281527837, 1.444360166606896, 1.444360166606896, 8.023525395056787, 8.023525395056787, 1.7230410467147632, 1.7230410467147632, 7.756244751684862, 7.756244751684862, 13.802987719944838, 13.802987719944838, 0.15832378751929968, 0.15832378751929968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2767983910014457, "mean_inference_ms": 2.079845398402667, "mean_action_processing_ms": 0.09515583719727173, "mean_env_wait_ms": 0.5718390827384184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 202500, "timesteps_this_iter": 0, "agent_timesteps_total": 607500, "timers": {"sample_time_ms": 11031.547, "sample_throughput": 305.941, "load_time_ms": 0.493, "load_throughput": 6842175.069, "learn_time_ms": 1615.689, "learn_throughput": 2088.892, "update_time_ms": 18.846}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 13.775523281097412, "policy_loss": -0.016384250298142434, "vf_loss": 13.800002193450927, "vf_explained_var": -0.04019496440887451, "kl": 0.005421025668350676, "entropy": 0.8094771325588226, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.998530411720276, "policy_loss": -0.0031086655333638193, "vf_loss": 3.0091545462608336, "vf_explained_var": 0.439551505446434, "kl": 0.0062555353020887165, "entropy": 0.7517873018980026, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 202500, "num_agent_steps_sampled": 607500, "num_steps_trained": 202500, "num_agent_steps_trained": 607500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8100, "training_iteration": 60, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-44", "timestamp": 1706106104, "time_this_iter_s": 10.974106788635254, "time_total_s": 724.1201500892639, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 724.1201500892639, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 26.36428571428571, "ram_util_percent": 73.58571428571429, "gpu_util_percent0": 0.3228571428571429, "vram_util_percent0": 0.21365792410714285}}
{"episode_reward_max": 17.272679724061526, "episode_reward_min": -22.103316661250993, "episode_reward_mean": -0.08401187629689044, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.018193139950057, "policy_agent_": -4.261935836680594}, "policy_reward_max": {"policy_adversary_": -4.77714359242603, "policy_agent_": 20.812424272601273}, "policy_reward_mean": {"policy_adversary_": -12.554543042782088, "policy_agent_": 6.2352655832426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.303592276139964, -4.309029697983575, -0.009792123715895398, 1.5528912287606187, -1.537936712335255, 2.163184196405236, -4.385906032219198, -10.29364081031077, 6.483167437680146, 2.5073627400176997, -1.4007863833417715, 3.4713207898837313, 0.1367445021572543, -7.009997580089746, -1.5213021665987336, -4.761138260337653, -7.935440437731759, -0.5479799045510321, -2.5437500778037645, 9.386425337960084, -2.6358716692252755, -1.0434277919220403, 0.47095840799694433, -5.136166783651609, -11.980522483740057, 3.1092630352970514, 7.912476467933169, 2.8031375507773917, 0.7619614153855566, -4.613010882470103, -3.272439187144566, -22.103316661250993, 1.2498590985876106, -5.584512408503729, -6.497248020314959, -3.4565289191471003, -1.206654370589947, -7.292697226372515, 0.1302189209493071, -0.9109947912847361, 5.322537793932138, 1.7853786848617028, 6.4334989801499605, -0.7206009975319951, -2.797933841608966, 1.0809936489756875, -3.634985027596315, -3.327920646789488, -0.8539454506830069, -10.021291175915456, -3.8016459368245954, -2.660211305103578, 1.001107653048166, 6.062567834305167, 0.5194417145034158, -0.8177158111272533, -3.323712914782292, 10.353186751830336, -8.14642437862177, 5.120984263369823, -2.2730803984009986, 5.967706917531727, -3.8928090378775293, 2.244624409305555, 8.83283187968977, 0.29350286272744985, 2.0907892884970165, -6.1293577462297995, -2.9100973922429874, 4.415376442311878, 4.016719945679029, 9.372678111121166, 9.106149327755949, 2.471520899008716, 2.3576613453528275, -5.154992866500616, 5.712764867480909, 3.3182765952710906, -9.28020464023918, 2.092970196458124, 4.09178498166992, -2.081251859801888, -2.5434785821646337, 8.867515690183035, -13.441516943486192, 3.98383406336057, 0.692505156028252, -0.2683640914847466, -3.208744521291867, -17.99970128439474, -3.7630710302207495, -11.955665948924864, 10.298617481394515, 4.747044822104453, 3.7539059769514878, 0.033964687914690234, 0.6863672405040663, -2.3622380245635197, 5.339806439278695, 3.8370491526989112, -2.496613214087001, 4.104363308722139, 3.326506315173407, 5.524712677510164, -4.488620090989594, 3.2999780685421447, 3.554780606889326, -0.7335735799663237, 1.4573323773867508, 1.5526373122077917, 0.44451965402377974, -3.1419422253122957, 3.2733881804855214, 9.504041536934675, -5.951947547056593, 8.873468284728578, -3.944794085407935, -0.8534386407375494, 7.950435053019835, 0.9907950765894546, 2.1622421544229944, -0.1930347503748281, 17.272679724061526, 3.047904666014045, -0.3482571514798283, 3.1998420415778273, -8.152024868634545, 1.1899747975301507, 1.7414663372505783, 5.225802371200468, -4.5936544029327875, 1.4254240560258988, 6.05533090053534, 2.5653563145714404, 1.033323719632975], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.779720602778778, -21.66828171366662, -6.607353892464121, -10.724360287912049, -13.53866281563902, -5.264703619264766, -9.996411284610053, -13.560804114586972, -11.966938579076636, -16.327585183362565, -21.159262226157825, -15.47362155511292, -10.601522913319663, -6.627678191435915, -7.0354992426944465, -6.760053789331311, -6.025932956867545, -11.391078921528583, -11.459109016460426, -20.58015612790108, -7.798662108651549, -7.9733268172029215, -7.625388122104784, -4.77714359242603, -11.61143104617751, -10.556769852419805, -18.281063990786663, -9.82483728300045, -8.407484361176884, -9.988800338147936, -9.967410611895719, -17.8239325979874, -11.957676145040807, -16.40674036729899, -14.835038009558067, -11.321645676397686, -12.046635443617317, -11.90391483528342, -18.35771620544176, -7.498515174134641, -11.81935567114228, -16.40372611487785, -18.403848243580367, -10.582598373831129, -6.407981619194791, -7.332461529432878, -20.092370313173003, -7.950953031002443, -7.382164905452086, -18.498696419936525, -17.27961260326395, -10.14885052431333, -13.577147570058221, -17.556371421266945, -14.126187745249718, -9.636954661519816, -19.99776832666287, -16.71263620918691, -9.832705464604553, -18.21303939874873, -5.317734541068169, -12.796249553112196, -11.428938833621913, -12.60450614268695, -28.018193139950057, -8.042286126780889, -16.857437719046626, -7.962626175687028, -6.6798307727314885, -20.125099543857207, -8.493171786103858, -24.061556391578037, -12.443259227718, -10.783370823330007, -12.236031461701629, -10.0201984458786, -10.182884320102517, -12.0715180876825, -10.652877712197283, -13.621160535179932, -14.626881268116511, -17.58751342983663, -7.606374042585525, -18.48585483737758, -10.894000343200155, -9.438435496443304, -9.415542858452316, -9.707673621679671, -7.1622384824685135, -9.862531905063502, -11.252743637895241, -8.061590236963912, -17.875291636210243, -9.687633085655213, -8.336006757464467, -10.932451352240927, -10.550128694815617, -8.709787373558235, -20.80257354314545, -10.766403180230807, -14.835811925555939, -12.539709134778095, -14.785376758511886, -20.567666556881363, -10.554779844988243, -11.913828044691174, -13.176391445585434, -19.287749410939572, -15.10641262751072, -13.4590826720204, -10.106680092476795, -19.40283276046649, -7.266718394244222, -23.879302172563992, -10.9184896697294, -13.629807520140833, -14.497792900588072, -10.304519411347531, -15.082379090445722, -15.418927510795497, -8.70090617888097, -6.959404617608363, -24.352168821141017, -14.200244787777155, -11.83311832108168, -10.954683669965137, -11.642482440277336, -7.4806063747162925, -17.797412046732173, -13.560361631822152, -8.354496147463339, -9.955369388482314, -11.949226225875028, -16.237492701112174, -14.522192595546906], "policy_policy_agent__reward": [-4.261935836680594, -4.261935836680594, 8.679626007841524, 8.679626007841524, 3.2987808843741124, 3.2987808843741124, 6.138625758336334, 6.138625758336334, 6.00036305165188, 6.00036305165188, 3.7139439078349996, 3.7139439078349996, 2.8052526261954265, 2.8052526261954265, 1.6335816521381004, 1.6335816521381004, 9.225053008378394, 9.225053008378394, 9.417473961690133, 9.417473961690133, 9.879237921408027, 9.879237921408027, 9.472471172498325, 9.472471172498325, 5.369133707738458, 5.369133707738458, -0.1911596943269157, -0.1911596943269157, 2.757098538047856, 2.757098538047856, 0.999457764496829, 0.999457764496829, -0.9547537404321053, -0.9547537404321053, 5.421549508488777, 5.421549508488777, 4.45767946932833, 4.45767946932833, 14.983290732930582, 14.983290732930582, 2.581395219713137, 2.581395219713137, 3.4649495126404397, 3.4649495126404397, 4.048173265050866, 4.048173265050866, -0.17951159561278981, -0.17951159561278981, -0.1845457187812753, -0.1845457187812753, 6.833016443858426, 6.833016443858426, 13.096770229359914, 13.096770229359914, 6.313987416888922, 6.313987416888922, 4.584722888281219, 4.584722888281219, 2.6878947278389163, 2.6878947278389163, 3.347485712375578, 3.347485712375578, -2.1396920316317916, -2.1396920316317916, 6.603767621814208, 6.603767621814208, 5.41111397939763, 5.41111397939763, 4.168894994621556, 4.168894994621556, 3.932558378625292, 3.932558378625292, 5.4199905365136845, 5.4199905365136845, 2.305608804455453, 2.305608804455453, 9.243967563195536, 9.243967563195536, 3.293760191424954, 3.293760191424954, 8.570946732537207, 8.570946732537207, 9.094552399869771, 9.094552399869771, 12.418673611865163, 12.418673611865163, 4.930998688149566, 4.930998688149566, 1.8050238887929129, 1.8050238887929129, 4.206727589204284, 4.206727589204284, 8.22869264278834, 8.22869264278834, 2.311516192106477, 2.311516192106477, 3.2641097273845405, 3.2641097273845405, 4.238702622010531, 4.238702622010531, 6.738983333219677, 6.738983333219677, 3.744319609604875, 3.744319609604875, 7.289127611553192, 7.289127611553192, 11.809469627786056, 11.809469627786056, 7.322814729876569, 7.322814729876569, 4.409619425196283, 4.409619425196283, 8.33702770594029, 8.33702770594029, 13.532911480508623, 13.532911480508623, 0.8431405429913914, 0.8431405429913914, 11.667011831059277, 11.667011831059277, 1.5223270713335846, 1.5223270713335846, 9.38197823532196, 9.38197823532196, 3.7680648978721925, 3.7680648978721925, 7.424565275996249, 7.424565275996249, 18.42551250981991, 18.42551250981991, 4.167894494754168, 4.167894494754168, 9.474113503771822, 9.474113503771822, 0.916634214728613, 0.916634214728613, 1.8848666902442508, 1.8848666902442508, 12.270237993084544, 12.270237993084544, 6.254945865891445, 6.254945865891445, 16.717117251349602, 16.717117251349602, 10.774704277736975, 10.774704277736975, 6.6274458611693605, 6.6274458611693605, 7.296846403527228, 7.296846403527228, 2.4326027896889935, 2.4326027896889935, 7.947824593791713, 7.947824593791713, 7.694897341476795, 7.694897341476795, 0.6863365359790536, 0.6863365359790536, 7.857065365819029, 7.857065365819029, 9.359333124893217, 9.359333124893217, 7.75313078501737, 7.75313078501737, 2.5314477302104446, 2.5314477302104446, 13.676685263780305, 13.676685263780305, -1.2737583001430157, -1.2737583001430157, 6.711134779901938, 6.711134779901938, 5.054024007240286, 5.054024007240286, 4.719654765097461, 4.719654765097461, 1.976746980588323, 1.976746980588323, -4.068584689665625, -4.068584689665625, 3.7448363038372463, 3.7448363038372463, -1.9470378559804757, -1.9470378559804757, 14.086954558802377, 14.086954558802377, 7.217338953879832, 7.217338953879832, 6.044956367207979, 6.044956367207979, 5.483208020077808, 5.483208020077808, 5.618247967659842, 5.618247967659842, 3.1737746744973565, 3.1737746744973565, 13.071189991212067, 13.071189991212067, 7.301726166464857, 7.301726166464857, 6.169599355734468, 6.169599355734468, 8.322036221750116, 8.322036221750116, 9.055941536842647, 9.055941536842647, 13.046189617195767, 13.046189617195767, 3.0330798769993224, 3.0330798769993224, 7.606903056616658, 7.606903056616658, 8.36558602623738, 8.36558602623738, 9.277087915486623, 9.277087915486623, 8.281872502448739, 8.281872502448739, 7.505859992114096, 7.505859992114096, 5.275599873250288, 5.275599873250288, 8.130445267577098, 8.130445267577098, 5.270053287364871, 5.270053287364871, 16.691671854749334, 16.691671854749334, 2.4832710613364055, 2.4832710613364055, 11.251637902434707, 11.251637902434707, 5.276499407590071, 5.276499407590071, 4.725540385304992, 4.725540385304992, 11.516407071732777, 11.516407071732777, 8.204861293692476, 8.204861293692476, 5.4315741666519815, 5.4315741666519815, 3.3831849336167674, 3.3831849336167674, 20.812424272601273, 20.812424272601273, 8.624074726895604, 8.624074726895604, 5.742430584800927, 5.742430584800927, 7.077262855771485, 7.077262855771485, 1.7452287858213937, 1.7452287858213937, 4.3352905861232225, 4.3352905861232225, 9.769439191991374, 9.769439191991374, 9.393082001511312, 9.393082001511312, 1.8804208722652767, 1.8804208722652767, 5.690396722254105, 5.690396722254105, 9.002278563205184, 9.002278563205184, 9.401424507841808, 9.401424507841808, 7.777758157589939, 7.777758157589939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2764000365691994, "mean_inference_ms": 2.076252709853221, "mean_action_processing_ms": 0.09505816168926928, "mean_env_wait_ms": 0.5709196593354701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 205875, "timesteps_this_iter": 0, "agent_timesteps_total": 617625, "timers": {"sample_time_ms": 10936.693, "sample_throughput": 308.594, "load_time_ms": 0.496, "load_throughput": 6806643.266, "learn_time_ms": 1618.276, "learn_throughput": 2085.552, "update_time_ms": 18.846}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.003548526763915, "policy_loss": -0.00786349861882627, "vf_loss": 16.01936330795288, "vf_explained_var": -0.048948121070861814, "kl": 0.003828508211050263, "entropy": 0.7951735258102417, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.6820273876190184, "policy_loss": -0.00023441091179847716, "vf_loss": 3.6898306727409365, "vf_explained_var": 0.44468117952346803, "kl": 0.00506924031947617, "entropy": 0.757080253958702, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 205875, "num_agent_steps_sampled": 617625, "num_steps_trained": 205875, "num_agent_steps_trained": 617625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8235, "training_iteration": 61, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-21-55", "timestamp": 1706106115, "time_this_iter_s": 10.929069995880127, "time_total_s": 735.049220085144, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5F19F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 735.049220085144, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 26.97142857142858, "ram_util_percent": 73.63571428571429, "gpu_util_percent0": 0.22642857142857145, "vram_util_percent0": 0.21449497767857142}}
{"episode_reward_max": 11.731526515621937, "episode_reward_min": -22.821215091800386, "episode_reward_mean": 0.48026573163037894, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.868505147458155, "policy_agent_": -1.7687301680005454}, "policy_reward_max": {"policy_adversary_": -3.119975909197928, "policy_agent_": 18.71309440576291}, "policy_reward_mean": {"policy_adversary_": -12.931282671522817, "policy_agent_": 6.705774201576599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.731526515621937, -0.6693052694298798, -13.974597996046267, -10.316923798909137, 5.8875951787856255, -3.2881064394505097, 4.785504920752864, -0.7367069841916816, 3.8531421455328947, 4.873239392116875, 8.64931307386682, -6.807286883715626, -7.147230090229816, -3.3742609864278603, 2.9749131796767307, -0.32126332224659454, 4.591834281642743, -1.634108924351834, 4.09261257037582, -4.619548827373928, 9.247890653647836, -2.2364808188114913, 5.687148318792442, -6.633185156022446, 6.4871708058607425, 6.104932578189661, 3.4192397948938758, -3.1293176239087286, 7.727191575708134, -2.0916507486808507, -1.0314371104713547, -1.6949688050086622, 6.869464640123115, 4.717270200359607, -1.0028670977197958, 4.691216765371372, 0.4514173636157392, -10.738463337494363, -0.9294220831935166, 1.6172872154880245, -3.8866458450491033, -4.740292022807074, 7.121052074631464, 0.3423609144516977, 1.5392739986025386, -0.6613359531581589, 11.62624449073161, -11.352692530184077, -11.294661127902039, 0.2951966934218465, 9.317393291408017, -8.755837689991132, -1.5224821317090345, 4.012610400955583, 0.849419603496442, -2.5898545897507788, -1.4855958739122008, -3.0735842875147528, -0.6694025820983751, 5.9354250975115175, -5.386100003706434, -11.051078258623487, -1.5886577154459365, 6.9813684271350205, -3.9627271045136903, 6.7427812845582435, -5.8700859141506365, -0.14643116716146964, -0.29476264860471824, 2.6105321338089915, 1.019544395049575, -4.87061071944603, 0.37785863558981614, 3.96177960909502, 8.438091609074206, 1.9902079339330363, 8.177034900253755, -5.334007113696171, 3.9994878400772125, -0.8519104706207092, -2.2180677052369657, -1.6305004596989774, 5.956372583616796, -10.699139852640064, 11.574353482434026, -15.430207383707481, 1.1778817195939268, 2.0891033997516244, -4.110422678104644, 3.0008055306348282, -6.2104773750434745, 7.499995710231569, -3.491469036771938, 0.43762270140054227, 3.1632914520500997, 2.0727172821991497, 0.47783342746038443, -1.8317706880394469, 4.386463133746082, -22.821215091800386, 9.624649825135714, 2.493767568814541, 1.4919064612296242, 4.175472130563353, 6.615320532745053, 0.3130347499425036, 4.525281720513901, 2.525468730463994, 6.777137778292586, 4.388041521221795, 7.655475831575827, 4.704536114491827, -5.0738096947683315, 8.490019258761453, -3.296630966484248, -5.185730508324213, -2.1131154433414263, -3.7759385631719122, -1.865460963976393, 0.5318857257761196, 7.597569931674769, 10.848833202645455, 3.8447236106142553, 4.259282326031544, 0.2364969138838387, -8.545616622202976, 6.451428092534152, 6.7827790528564185, 0.1789173489793741, 8.348201522281684, -1.4261355401885194, 1.2888905779843083, -0.1671620212745707, -6.278681994460384, -7.009821043273694], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.279833453506424, -6.225736761580036, -13.431162379802235, -22.75489903185564, -14.164245874247177, -9.60887003020209, -11.113411354189914, -15.062400788654362, -11.021185797413075, -12.102652351561545, -16.910594776085855, -10.232315871310702, -8.324745727506347, -19.40481049788544, -14.774778342947506, -15.473388134625084, -11.80429286164614, -6.7716721930487065, -9.099513663902597, -6.5635950187953185, -25.228403755756453, -6.831694261474743, -13.923477842663205, -7.247147757704825, -21.211895896101566, -13.17885969886126, -14.958572301049628, -9.340008415740224, -14.96708726778871, -6.27979217529538, -5.63934282838707, -6.71140358122214, -14.694831998358383, -19.984289636451113, -12.584469172558332, -11.389867551147582, -7.556947754239738, -9.450217547366652, -10.481553850284385, -6.969342733964321, -9.607623821806193, -3.119975909197928, -17.553636028498637, -16.268991114416867, -11.931450838541581, -10.159547124832365, -16.482525141168015, -13.007227139524312, -15.75764387300511, -9.895382395401137, -15.98154632486959, -18.375539260930676, -6.149519759029395, -8.062413714069342, -9.979553432832963, -18.36040429061466, -8.528797863878298, -12.275069368012593, -15.52600816801433, -21.514085312628797, -9.36296789052042, -21.647132299358198, -6.6367962283062685, -14.918448008737828, -13.6270094511335, -16.43358912538649, -13.457006828633736, -13.481902031066967, -16.330081085834944, -7.927786975649994, -6.849652551505247, -6.3577455606593825, -9.016389615576054, -15.108964347024976, -28.98809720245161, -6.179902164630981, -16.03374358080049, -17.90503895267747, -15.659051514139374, -19.382434738737345, -11.476078522884581, -9.840398627388792, -11.548069909053584, -7.161679516638971, -21.490177539099875, -16.63677100333214, -7.04831463104613, -10.799700380285584, -11.649317359564716, -9.234200751492038, -13.610729419910896, -17.324698237882696, -5.277908815810969, -18.426731209581728, -16.43152083204077, -11.444300130263638, -5.85329122117923, -5.176666697965006, -9.89259958270152, -21.16139833914211, -16.044403155156335, -12.253587395806122, -6.201953634542063, -16.326391596530215, -11.63583718799862, -8.676958915491044, -30.868505147458155, -9.986113215728311, -11.085242869340105, -10.98103102314198, -13.386208834956848, -10.534603728816752, -15.210141048346355, -16.367457105378676, -9.167621354660834, -12.178259326574066, -9.415502970871282, -14.528305104326352, -7.661828570533356, -10.240394286606499, -20.012909848013834, -17.608744576326973, -15.643754277286833, -18.036398177688152, -15.932259670912742, -9.697404314015719, -22.27859323392182, -21.698465238227218, -13.482926332394266, -15.82820806101843, -12.87271041324575, -15.116793459396595, -4.863676873375259, -14.662897633803716, -7.1585273751380685], "policy_policy_agent__reward": [15.50567998456418, 15.50567998456418, 2.778215746075079, 2.778215746075079, -0.27171780812201735, -0.27171780812201735, 6.218987616473249, 6.218987616473249, 10.025920526516407, 10.025920526516407, 3.1603817953757907, 3.1603817953757907, 7.949458137471388, 7.949458137471388, 7.162846902231341, 7.162846902231341, 7.4371639714729865, 7.4371639714729865, 8.487945871839209, 8.487945871839209, 12.77995392497634, 12.77995392497634, 1.7125144937975356, 1.7125144937975356, 0.588757818638262, 0.588757818638262, 8.015274755728788, 8.015274755728788, 8.874845761312116, 8.874845761312116, 7.5760624061892425, 7.5760624061892425, 8.198063571644445, 8.198063571644445, 2.568781634348436, 2.568781634348436, 6.596063117139209, 6.596063117139209, 0.9720230957106967, 0.9720230957106967, 17.23814720470214, 17.23814720470214, 2.2976067213316247, 2.2976067213316247, 9.805313080727826, 9.805313080727826, 0.3069813008411897, 0.3069813008411897, 13.849533350981153, 13.849533350981153, 9.64189613852546, 9.64189613852546, 9.188906047971747, 9.188906047971747, 3.105345395915748, 3.105345395915748, 11.347139421748421, 11.347139421748421, 2.0940707133072642, 2.0940707133072642, 2.303952858957857, 2.303952858957857, 2.5082173881067393, 2.5082173881067393, 10.782148319240749, 10.782148319240749, 12.350779918405356, 12.350779918405356, 5.790801037419263, 5.790801037419263, 8.040542158259477, 8.040542158259477, 4.00418255892774, 4.00418255892774, -0.6441228950638598, -0.6441228950638598, 4.776065883545435, 4.776065883545435, 4.293314974726173, 4.293314974726173, 2.860488988378544, 2.860488988378544, -0.8101580568045748, -0.8101580568045748, 12.337344051565053, 12.337344051565053, 8.305676014434283, 8.305676014434283, 6.735362418572063, 6.735362418572063, 4.749105585837102, 4.749105585837102, 14.054384815949815, 14.054384815949815, 0.8272673046701138, 0.8272673046701138, 2.231491372551539, 2.231491372551539, 5.095289544411493, 5.095289544411493, 12.649469808138804, 12.649469808138804, 4.8098507854697745, 4.8098507854697745, 2.313518813660181, 2.313518813660181, 6.03751205751246, 6.03751205751246, 5.414486518164702, 5.414486518164702, 7.8852748504319425, 7.8852748504319425, 3.521600994983048, 3.521600994983048, 4.600742540248919, 4.600742540248919, 7.4283027929579815, 7.4283027929579815, 13.724755205070155, 13.724755205070155, 1.988433943406995, 1.988433943406995, 5.2980270203673525, 5.2980270203673525, 2.5240692564301668, 2.5240692564301668, 10.949908217936425, 10.949908217936425, 4.832141173309901, 4.832141173309901, 11.588185204972367, 11.588185204972367, 3.7934604572415465, 3.7934604572415465, 6.667735431952747, 6.667735431952747, 8.017659218615114, 8.017659218615114, 5.269159554729493, 5.269159554729493, 3.934598473277412, 3.934598473277412, 0.7435674206066764, 0.7435674206066764, 4.6971241255829375, 4.6971241255829375, 9.535371978059999, 9.535371978059999, 18.71309440576291, 18.71309440576291, 4.085055049282008, 4.085055049282008, 12.105389240527119, 12.105389240527119, 6.285515919490645, 6.285515919490645, 9.82926967710829, 9.82926967710829, 9.265262134058318, 9.265262134058318, 4.62900540882381, 4.62900540882381, 4.104949083844908, 4.104949083844908, 8.75222124633519, 8.75222124633519, -1.7687301680005454, -1.7687301680005454, 16.53226551076695, 16.53226551076695, 0.6032818098123299, 0.6032818098123299, 4.113098175320029, 4.113098175320029, 6.444401890018604, 6.444401890018604, 3.769447340730038, 3.769447340730038, 6.117503141063433, 6.117503141063433, 3.7001260224337114, 3.7001260224337114, 12.412346974057131, 12.412346974057131, 0.8932198895195155, 0.8932198895195155, 9.432176955491135, 9.432176955491135, 9.797406142045432, 9.797406142045432, 6.758508706231392, 6.758508706231392, 3.1655623243198066, 3.1655623243198066, 1.6724480049627795, 1.6724480049627795, 7.139531358223802, 7.139531358223802, -0.8299083763291417, -0.8299083763291417, 12.834526490146025, 12.834526490146025, 7.373677482310331, 7.373677482310331, 3.8469300478858433, 3.8469300478858433, 10.250931863546784, 10.250931863546784, 9.125578860371832, 9.125578860371832, 4.494996832716772, 4.494996832716772, 17.69689343398603, 17.69689343398603, 6.255790973096152, 6.255790973096152, 8.931190323816349, 8.931190323816349, 7.68453627218189, 7.68453627218189, 10.520842333266343, 10.520842333266343, 7.619569921654287, 7.619569921654287, 5.068165676789011, 5.068165676789011, 12.428738182070065, 12.428738182070065, 2.9354951940882934, 2.9354951940882934, 3.4962644091249255, 3.4962644091249255, 3.6511937637649288, 3.6511937637649288, 5.376183270577224, 5.376183270577224, 2.8981838032784815, 2.8981838032784815, 5.386140006191309, 5.386140006191309, 13.805239889844305, 13.805239889844305, 14.228788889486216, 14.228788889486216, 9.744238943950544, 9.744238943950544, 11.14784025185985, 11.14784025185985, 8.08437829239829, 8.08437829239829, 0.5758938459063698, 0.5758938459063698, 14.36501066322798, 14.36501066322798, 14.240622145541822, 14.240622145541822, 6.830921840686822, 6.830921840686822, 12.088204791650064, 12.088204791650064, 5.723287436528615, 5.723287436528615, 8.202842018690456, 8.202842018690456, 2.3482574260503437, 2.3482574260503437, 4.192107819671666, 4.192107819671666, 0.07435316593218667, 0.07435316593218667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2759864126473993, "mean_inference_ms": 2.073142847539656, "mean_action_processing_ms": 0.0948563559707183, "mean_env_wait_ms": 0.5701506710768456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 209250, "timesteps_this_iter": 0, "agent_timesteps_total": 627750, "timers": {"sample_time_ms": 10958.178, "sample_throughput": 307.989, "load_time_ms": 0.496, "load_throughput": 6810245.357, "learn_time_ms": 1624.659, "learn_throughput": 2077.359, "update_time_ms": 18.946}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005000000000000001, "total_loss": 17.473205184936525, "policy_loss": -0.0011307016669888982, "vf_loss": 17.482090568542482, "vf_explained_var": -0.018118810653686524, "kl": 0.0038621348845787077, "entropy": 0.7755575299263, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.8019513368606566, "policy_loss": -0.01110824029892683, "vf_loss": 3.8205291867256164, "vf_explained_var": 0.47548496127128603, "kl": 0.005518470692571442, "entropy": 0.7471832185983658, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 209250, "num_agent_steps_sampled": 627750, "num_steps_trained": 209250, "num_agent_steps_trained": 627750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8370, "training_iteration": 62, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-22-06", "timestamp": 1706106126, "time_this_iter_s": 11.016627788543701, "time_total_s": 746.0658478736877, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E818B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 746.0658478736877, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.25, "ram_util_percent": 73.52857142857144, "gpu_util_percent0": 0.22285714285714284, "vram_util_percent0": 0.21437290736607142}}
{"episode_reward_max": 12.443034949089594, "episode_reward_min": -18.6785457431086, "episode_reward_mean": 0.4715620284759818, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.78878862410202, "policy_agent_": -2.1068137009770465}, "policy_reward_max": {"policy_adversary_": -2.9779235904672086, "policy_agent_": 16.942776761480847}, "policy_reward_mean": {"policy_adversary_": -11.942453521086227, "policy_agent_": 6.207007774781104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.53137204339406, -1.1351740581853058, 0.05507961289971042, -11.426604702778933, 2.6379793650282304, 2.736279533959425, 1.7118751954262226, 3.858540260641722, -2.7682186230241896, -1.0714507875099026, -3.1248725965837028, -9.954501438149684, 0.3392836829107331, 0.9654886830479776, 1.699536153343925, 4.371052524605413, 1.8053878962321965, 8.248881102548474, 1.3188673110915015, 0.5925128662962215, -9.351248763751027, 1.11617621403791, -1.1770284359412817, 5.526728072219024, -4.329047861080497, 2.214541084053824, -0.23260023990349932, 1.3639922286736965, 4.384102500762145, 5.1042810572215025, 0.8081938348880299, -0.5698051245682407, -5.16776424030897, -2.19717447499133, 12.039224301357246, -0.5607807296450302, 5.823364131120942, 1.217379306227038, 1.4832231170866024, 4.868042481182851, 0.9099506203612376, 5.216661503416744, -2.0575406341985336, 9.24750518940808, 4.603914828228103, -1.226541228881836, 0.4941501884604338, -6.1021910954756216, -1.3933552015481645, 0.1348423351990329, 7.100219223048581, -3.0052703110161367, -5.318768357501543, 1.2538197073608612, -7.1915509924212975, 1.0776352354568994, 12.443034949089594, -0.13998869427209693, 4.056238029537141, 0.6829525519078804, -8.503073041493682, -2.097033162613883, -0.49097214161816616, -1.5589126564815377, -4.089453357629489, -4.989764115905469, -3.8003111965282357, -5.455180807485799, 6.830455610592092, -6.153393300200583, -1.2250717609882618, 8.862637223421293, 3.102199672514579, 9.371554843594714, -2.852718688485503, -5.590213709394582, 2.7356531066914327, 2.151217095227637, -1.496738342973519, 0.04915009703886755, 4.683665824758937, 2.3345009238737804, 2.684951128397088, -2.30580192978519, 0.8334522148695325, -1.0733648806612588, 0.7391206862297572, -2.11257108739281, 3.5592601842310896, 3.70285702655733, -0.8855357316233287, 3.6874858171700278, 4.980815473195767, -3.3644797463560736, -3.8343108300113693, 2.879595518671937, 2.6379698103827667, 3.29336622142647, -4.711127753025301, 5.867053671056677, 0.8016060937577904, 2.599168933619268, 3.738385559463369, 4.456478417551091, -8.831644887406798, -2.2647878112968005, -1.6956417134578263, 2.221271711965464, -2.81660050403233, 5.694241622325111, 6.1256257210130265, -7.763477405183435, -18.6785457431086, 1.4233994048543932, 1.9127145086114754, -0.2928533727147694, 7.159256098388042, 2.6442749552062814, -4.977513249979298, 0.9911428393440453, 0.7694264474223937, -7.525168981627136, -0.2532786675354246, 8.442516988879447, -2.074588215001794, 6.385062502825356, -7.277097292272862, -1.0507897736906477, 2.63689744532872, 1.059140489267509, -0.6285604240329021, -1.4249965743559239, 3.876921719676574, 0.4933848389864064, 4.847737922226192], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.187762212583248, -9.48776567114756, -11.854503173197681, -18.43146746331375, -23.16139819391007, -8.894652414803863, -7.996643755719331, -11.634544198490804, -25.78878862410202, -14.552157569558918, -12.521932898410402, -7.805154165588479, -17.87539783301888, -12.365850775048878, -6.116353838546173, -13.915059549467006, -13.038027004290674, -17.22298422256986, -5.766391607551626, -11.633297698155527, -15.83026897497723, -7.04291344138742, -7.986345972315895, -10.365721808799028, -6.281629363682974, -8.841593337396924, -8.161151509417266, -8.701360098479503, -10.880307396455011, -17.456528496159454, -6.826686327038138, -18.998395928466742, -12.403397061926277, -14.583222779971951, -21.209305978724455, -15.022148440313686, -16.90745695708797, -7.3132176387669, -11.653143252533685, -18.48692046106703, -11.514460816638772, -12.269801834646533, -6.590195872156201, -23.001661239313982, -13.369630373751402, -9.704465982629147, -8.349885190504033, -15.377314242302658, -6.196104686635125, -9.197332551681622, -18.586677097053812, -11.367756138828643, -10.442912634712696, -9.866756921939599, -2.9779235904672086, -7.080917762922047, -21.44251857387209, -6.843276523899586, -17.084906509872283, -8.162466139034164, -16.201420490541757, -20.985501359930883, -6.417182852800162, -17.547462342340303, -12.079834390910234, -10.943227571678815, -12.354089547681218, -9.312643147517132, -11.209999740051492, -8.44002161809373, -7.7762163097639085, -14.299930409927041, -13.728594357052195, -17.582302467471163, -12.472827379928244, -17.344679404706667, -7.554700900141776, -16.63450581105838, -5.423165709367786, -7.684858758424127, -10.124065613102879, -9.454374701869343, -12.886084850528755, -9.258492663296858, -9.227013205126207, -10.021979859998194, -7.175485543450395, -10.07536269530981, -8.767312605484843, -10.096690986293178, -6.570037711837596, -11.405744699673967, -18.654105414241727, -8.518933866389087, -8.182439118311715, -10.995031007167045, -14.949526808465354, -10.243305168578365, -10.119419332617095, -15.42456689166029, -11.280346762652838, -7.989428410085424, -13.28746004235002, -11.443363116691303, -12.832761317037688, -6.148898033848003, -9.823230401109658, -11.467420161700359, -9.54397550790643, -19.162824775081603, -15.741664068424141, -10.655651983128172, -22.161874956210358, -11.932530649616604, -10.487983141810657, -8.692560714813991, -16.811433490089257, -11.972043095250545, -9.824528416992031, -13.619082954866988, -11.657917137869957, -20.17582807173023, -10.708885483400856, -18.690839394204048, -6.716216693871868, -13.299343310463644, -13.353132195714752, -10.229043962875203, -7.565129865881726, -8.734266791195356, -9.610020535170625, -8.226600845008887, -13.685292990133755, -5.806250771345243, -10.121445208014627], "policy_policy_agent__reward": [13.359567127988653, 13.359567127988653, 4.176295806481126, 4.176295806481126, 5.954791393048694, 5.954791393048694, 3.5024313802674114, 3.5024313802674114, 12.899688779469148, 12.899688779469148, 5.8154659743816435, 5.8154659743816435, 4.854259475572778, 4.854259475572778, 7.746542229566266, 7.746542229566266, 11.510285000538918, 11.510285000538918, 6.7403533910245095, 6.7403533910245095, 4.6985301509133475, 4.6985301509133475, -1.0746736362806062, -1.0746736362806062, 9.107340757964806, 9.107340757964806, 6.66566972904843, 6.66566972904843, 3.907944995945049, 3.907944995945049, 9.14305603703621, 9.14305603703621, 7.421707450261436, 7.421707450261436, 12.735932662559167, 12.735932662559167, 3.542629459321565, 3.542629459321565, 6.112905282225875, 6.112905282225875, 3.239510105613097, 3.239510105613097, 4.079544827712666, 4.079544827712666, 3.404658768187308, 3.404658768187308, 7.946224940509026, 7.946224940509026, 0.9762907513012399, 0.9762907513012399, 5.528067210725377, 5.528067210725377, 3.9642756347568833, 3.9642756347568833, 5.032676163576601, 5.032676163576601, 7.632204948608576, 7.632204948608576, 11.280404776690473, 11.280404776690473, 3.8174400809630837, 3.8174400809630837, 9.21429540194925, 9.21429540194925, 3.617816410808654, 3.617816410808654, 6.193024152490312, 6.193024152490312, 16.62426514004085, 16.62426514004085, 7.230683855334328, 7.230683855334328, 11.365410544104448, 11.365410544104448, 4.265298472496968, 4.265298472496968, 6.568183184810143, 6.568183184810143, 11.677481471124944, 11.677481471124944, 6.212205718500004, 6.212205718500004, 8.743231669031637, 8.743231669031637, 2.2663276189788326, 2.2663276189788326, 16.124583214361035, 16.124583214361035, 8.98677260098975, 8.98677260098975, 4.238962376873656, 4.238962376873656, 4.4220176894822325, 4.4220176894822325, 4.637561573413519, 4.637561573413519, 2.40137474254348, 2.40137474254348, 4.666087443440327, 4.666087443440327, 12.84344816005119, 12.84344816005119, 4.181242913906255, 4.181242913906255, 2.5620721386055743, 2.5620721386055743, 5.560288314650228, 5.560288314650228, -2.1068137009770465, -2.1068137009770465, 4.079276499189471, 4.079276499189471, 16.942776761480847, 16.942776761480847, 3.351643914813744, 3.351643914813744, 10.570572269704712, 10.570572269704712, 4.422709345471021, 4.422709345471021, 3.8491737245240363, 3.8491737245240363, 9.444234098658503, 9.444234098658503, 2.963105355590998, 2.963105355590998, 7.994274842929384, 7.994274842929384, 3.9951905166403723, 3.9951905166403723, 2.9767317278866727, 2.9767317278866727, 4.276889175576491, 4.276889175576491, 1.9287311700156669, 1.9287311700156669, 9.020227675321797, 9.020227675321797, 1.1433141589465707, 1.1433141589465707, 3.2755722743878226, 3.2755722743878226, 11.581283816674167, 11.581283816674167, 8.415397014783387, 8.415397014783387, 13.476928655532936, 13.476928655532936, 4.8100543457213725, 4.8100543457213725, 5.877232847656041, 5.877232847656041, 5.145177003416604, 5.145177003416604, 9.392861453143004, 9.392861453143004, 1.9632136831971334, 1.9632136831971334, 3.8670044277314983, 3.8670044277314983, 7.403865718930908, 7.403865718930908, 5.894437812871564, 5.894437812871564, 7.785517989462925, 7.785517989462925, 3.4763453667558335, 3.4763453667558335, 5.030232709997869, 5.030232709997869, 4.474307489668469, 4.474307489668469, 3.9573031148400757, 3.9573031148400757, 3.9813958039585, 3.9813958039585, 6.163286394857967, 6.163286394857967, 6.899774006425252, 6.899774006425252, 2.842250990107134, 2.842250990107134, 7.546615258421999, 7.546615258421999, 11.817460443718746, 11.817460443718746, 2.577227060016508, 2.577227060016508, 2.174064144150175, 2.174064144150175, 6.937313262919494, 6.937313262919494, 8.79374830942406, 8.79374830942406, 6.768335695002418, 6.768335695002418, 2.704145789795898, 2.704145789795898, 10.64581028135848, 10.64581028135848, 6.0409764282053136, 6.0409764282053136, 5.294298671852344, 5.294298671852344, 8.512922800906697, 8.512922800906697, 7.949920767121201, 7.949920767121201, 2.0005582148154475, 2.0005582148154475, 1.9420551112755997, 1.9420551112755997, 4.063794343825917, 4.063794343825917, 6.844345936832912, 6.844345936832912, 3.36368750193705, 3.36368750193705, 12.428533198703356, 12.428533198703356, 10.93364489471859, 10.93364489471859, 1.446087288972366, 1.446087288972366, 1.7416646065508747, 1.7416646065508747, 6.677965027235499, 6.677965027235499, 6.200348825211066, 6.200348825211066, 4.199853671049612, 4.199853671049612, 11.985344794238653, 11.985344794238653, 7.308159025228411, 7.308159025228411, 2.423507583506364, 2.423507583506364, 7.305112897105515, 7.305112897105515, 6.213671792646177, 6.213671792646177, 6.325329545051547, 6.325329545051547, 5.227803407932716, 5.227803407932716, 13.566678191541753, 13.566678191541753, 2.3208142394350366, 2.3208142394350366, 9.8422029066445, 9.8422029066445, 3.038017451720944, 3.038017451720944, 4.5891270945922775, 4.5891270945922775, 5.101013655605226, 5.101013655605226, 4.896703640231433, 4.896703640231433, 4.490730055568862, 4.490730055568862, 3.400802135326482, 3.400802135326482, 8.781107354905167, 8.781107354905167, 3.149817805165825, 3.149817805165825, 7.484591565120411, 7.484591565120411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2756290630352525, "mean_inference_ms": 2.0699513180873015, "mean_action_processing_ms": 0.09470217188714022, "mean_env_wait_ms": 0.5691312927984801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 212625, "timesteps_this_iter": 0, "agent_timesteps_total": 637875, "timers": {"sample_time_ms": 10971.04, "sample_throughput": 307.628, "load_time_ms": 0.496, "load_throughput": 6810245.357, "learn_time_ms": 1623.26, "learn_throughput": 2079.149, "update_time_ms": 18.949}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 14.963796138763428, "policy_loss": 0.007748370757326484, "vf_loss": 14.963743114471436, "vf_explained_var": -0.05741145610809326, "kl": 0.006040329477401768, "entropy": 0.7695344090461731, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.6286013960838317, "policy_loss": -0.009541872947011143, "vf_loss": 2.6457531809806825, "vf_explained_var": 0.526928249001503, "kl": 0.005507611118878658, "entropy": 0.7612095564603806, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212625, "num_agent_steps_sampled": 637875, "num_steps_trained": 212625, "num_agent_steps_trained": 637875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8505, "training_iteration": 63, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-22-17", "timestamp": 1706106137, "time_this_iter_s": 10.866210699081421, "time_total_s": 756.9320585727692, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D3F790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 756.9320585727692, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 24.528571428571432, "ram_util_percent": 73.5, "gpu_util_percent0": 0.22428571428571434, "vram_util_percent0": 0.21500069754464285}}
{"episode_reward_max": 15.238726771840277, "episode_reward_min": -18.890388262489324, "episode_reward_mean": -0.9824746387333475, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.031348197366352, "policy_agent_": -4.393193586450503}, "policy_reward_max": {"policy_adversary_": -4.330552710704745, "policy_agent_": 17.925579394834728}, "policy_reward_mean": {"policy_adversary_": -11.868828701156335, "policy_agent_": 5.443177031211494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.472884146573119, 0.5817172096474141, 3.5533178412128175, 0.6586749104613221, 7.199380905427189, -0.5254442449328462, -1.1013145897012455, -1.9859288527188945, -4.04897248428757, 2.4312933813475714, -18.890388262489324, 4.385485015285692, -0.2787549540635337, 1.036112202008214, -2.952200112896711, 1.0251143915299974, -3.764789522151601, -2.606807569659834, -15.746737434176051, 7.085497194900904, 0.4793805539458509, 5.679524032021246, -5.625973619318158, -2.0233881303712162, -6.523602592551702, -9.083239588155413, 1.8367472328433427, -8.449525740934638, -1.6780859706532159, 0.7582016782858847, -11.00266555651521, 1.3588593622546596, 15.238726771840277, -2.6134940582932087, 11.577823860794853, 4.459440600863185, -0.31512595840870206, -2.0116285572020125, -0.9179136927936704, -2.287500624560082, 0.9840539026152992, -10.978788983381497, -0.5588153514487194, -5.998819764742481, 5.149179808007914, 1.9704964540420535, -0.4714757660827442, -5.675480213486535, 0.1122175508904335, 4.05502131615425, -7.040397948817259, 6.9738178859279945, -2.4618624330598293, -9.261263550761887, 2.020990639646496, -6.60933761775204, -3.1298594683055603, 4.861880674879214, -9.14709975129208, -2.5240947914145413, 2.7646574874671614, 12.714059279675133, -7.100255002662274, 0.28941246478723515, -16.144687317993327, 2.0824345066924725, 0.7118604778634181, -3.561124733613953, -0.8040035448877898, 1.7648400565643567, -0.025621309025629063, -1.2606883014453976, 0.12586783274717256, -0.7290404055664435, 0.2767509370742962, -2.54673788462601, -6.489223172215271, -7.364798108903095, -4.464737189037442, -1.3070108867716943, 2.5112700615277266, 3.9136654934146287, 1.5409122701075606, -4.8463588938267295, 0.0253926848573634, 13.568423211748451, 0.5375615366280929, 0.7144885501641924, 5.032815429386718, 0.6325199219005334, -0.15957217872693974, -1.0319817781563043, 1.8924803774739218, -0.7650089911097375, -10.992818660156173, -1.4925029825736535, -3.7371675378672133, 5.299377117323131, -3.908290398210806, -5.555932327657258, -15.689379466256913, 2.143114437005493, -1.3236016681831106, 0.9392615465293666, 7.283334328349247, 2.269088536231318, -7.17851001462369, 6.622599542004539, 6.145406426225838, 0.276311233486246, -3.9863723893672365, 0.9698704563861988, 3.7605699570688516, 7.819282215356113, -1.551760310978223, -1.24831301146008, -4.26143221296145, -15.703822763592573, 0.198298664594392, 0.764968935774746, -4.71137755599905, 3.1433435407090236, -6.079473452985026, -5.031323330143495, 2.949818524052915, -3.813959062785431, 2.220756270844122, -7.997032026044039, -1.1588306121523932, 2.52457508671261, 1.7905861622415467, 5.489324132826096, -4.303036142396813, 5.038192647286369, -0.765076418008797], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.200110458983975, -14.05116379068932, -14.388494981946534, -8.390430863815975, -15.664839479052478, -10.12888008278584, -8.317708539816289, -8.840199211255143, -12.112417056828393, -8.23930634248559, -10.104001089588305, -8.549211538021957, -14.869069165632713, -9.422947418574177, -8.328588628267763, -15.661426468056188, -13.955328975388717, -7.68343166578658, -15.678578648212545, -13.682037115360316, -22.671790666903735, -11.931918554283083, -9.931911536944174, -9.138469619202748, -11.974421324326647, -12.04325335405857, -9.71229889843859, -8.044272811310895, -8.325214566483428, -15.546805223922755, -9.973686463813712, -9.863472569934018, -18.95614459183227, -6.7305615945365345, -17.940614092369913, -10.848201731553305, -7.906137896561302, -10.922856469957201, -10.425080567555618, -10.247371530758011, -9.454231290264874, -12.388450330680568, -4.772157340692465, -22.38889020376417, -10.705219153346, -10.489508574993252, -5.925344530365859, -8.329605959505612, -20.231191837981772, -7.561739705009047, -17.24357439317317, -18.520257375507864, -5.39527184694002, -11.214649667070267, -18.20670555963301, -7.173793698187428, -9.266028615558007, -12.275983861237252, -7.8910320010837385, -10.361327225180464, -8.57902324727564, -18.805414542262596, -6.061719619429494, -12.580363064806019, -12.864952160195154, -15.708774099435884, -7.47486214228288, -9.388896445798522, -7.963684764200043, -9.274656338561261, -5.027646637801903, -7.76402652528778, -22.672838824687677, -5.395796461746774, -10.62876659192313, -4.670975747682655, -11.796316060628753, -9.423979633719593, -8.729122543672407, -19.66286564824365, -15.126581173921624, -10.401873279894632, -10.490895852868706, -4.330552710704745, -10.619889583582628, -22.282735577921, -6.446456940159261, -17.86775975903082, -17.18680638368083, -13.982813265654347, -21.21528978995393, -14.812138303830936, -9.21384120636956, -10.704821397515888, -9.438480788689974, -12.082684726692667, -10.191861391506833, -19.389140459956884, -13.539224097879197, -11.953085082015958, -18.225983375583976, -15.985995595493826, -5.402364276640891, -9.559347205094207, -13.00209646154889, -10.016767491910848, -14.81667173058087, -15.756687252651705, -13.487461058927872, -10.410620560384555, -14.272530077848707, -15.760382643951306, -11.513127680705125, -11.86377203963621, -4.841478676911934, -18.526609779963934, -18.07858198088022, -10.594481273220692, -10.661426409380711, -7.979677543409335, -11.338751776306882, -12.009884619566467, -10.321624321956639, -13.770530871410916, -9.185633488870687, -28.031348197366352, -13.746144184427667, -10.26601605563351, -6.580080142311213, -12.50721696252844, -12.389445682222997, -10.796479035606273, -6.8781239287540625, -13.617972626157485, -9.147328021317755], "policy_policy_agent__reward": [2.3636131562054254, 2.3636131562054254, 7.316440500168366, 7.316440500168366, 8.970906411579676, 8.970906411579676, 4.524552887138649, 4.524552887138649, 11.432110192239834, 11.432110192239834, 4.8017179189265, 4.8017179189265, 3.6081969750575205, 3.6081969750575205, 3.4271351792681233, 3.4271351792681233, 4.031722286270409, 4.031722286270409, 5.335299861916579, 5.335299861916579, -4.393193586450503, -4.393193586450503, 6.467348276653822, 6.467348276653822, 7.295157105784589, 7.295157105784589, 5.229529810291195, 5.229529810291195, 2.688194257685525, 2.688194257685525, 8.343270429793092, 8.343270429793092, 5.095269726618562, 5.095269726618562, 2.5383120480633714, 2.5383120480633714, -0.03407939298175219, -0.03407939298175219, 10.383767155130606, 10.383767155130606, 11.575585610424794, 11.575585610424794, 8.805721293152164, 8.805721293152164, 2.152968958813007, 2.152968958813007, 3.5575407444157645, 3.5575407444157645, 2.7254093658874683, 2.7254093658874683, 1.480006882951575, 1.480006882951575, 5.774523065640966, 5.774523065640966, -0.2026264648118746, -0.2026264648118746, 3.3235642979151065, 3.3235642979151065, 8.15250345110432, 8.15250345110432, -0.5144895463507464, -0.5144895463507464, 5.6111659660943385, 5.6111659660943385, 17.097435681836274, 17.097435681836274, 2.0585337681216638, 2.0585337681216638, 14.759218976582384, 14.759218976582384, 7.653821166208244, 7.653821166208244, 3.7955059690762987, 3.7955059690762987, 4.455613956377592, 4.455613956377592, 4.753583437380975, 4.753583437380975, 3.9799354530989652, 3.9799354530989652, 5.219142596440086, 5.219142596440086, 0.7048306736495361, 0.7048306736495361, 2.1066709946218727, 2.1066709946218727, 8.195035219510846, 8.195035219510846, 7.927199480676958, 7.927199480676958, 6.230002514517653, 6.230002514517653, 2.726934382141557, 2.726934382141557, 1.327062873009537, 1.327062873009537, 10.171704694436103, 10.171704694436103, 5.808380510581649, 5.808380510581649, 5.1015882221779565, 5.1015882221779565, 12.74703763071793, 12.74703763071793, 1.466704706940096, 1.466704706940096, 0.9766930581541913, 0.9766930581541913, 10.11384809963975, 10.11384809963975, 0.2822280402176942, 0.2822280402176942, 3.0680845736262223, 3.0680845736262223, 8.568932268058232, 8.568932268058232, -0.6280338751041742, -0.6280338751041742, 3.9186162168829597, 3.9186162168829597, 5.6718403673714, 5.6718403673714, 15.759736910968867, 15.759736910968867, -0.5192676916163919, -0.5192676916163919, 6.4348877647966285, 6.4348877647966285, -1.6398675788990884, -1.6398675788990884, 8.89560430306418, 8.89560430306418, 4.093361310073149, 4.093361310073149, 2.913885856092284, 2.913885856092284, 3.5798406096561255, 3.5798406096561255, 5.519748197562809, 5.519748197562809, 2.5010126643881376, 2.5010126643881376, 3.251669111921191, 3.251669111921191, 11.399353328717426, 11.399353328717426, 2.333378028090166, 2.333378028090166, 5.452758764498714, 5.452758764498714, 1.0621189315283217, 1.0621189315283217, 2.6535464442067425, 2.6535464442067425, 1.02959076240825, 1.02959076240825, 2.1321926773174824, 2.1321926773174824, 9.177927380735976, 9.177927380735976, 8.818925617724673, 8.818925617724673, 7.157769386654629, 7.157769386654629, 6.015904061488133, 6.015904061488133, -0.25790309156099067, -0.25790309156099067, 5.322641134219997, 5.322641134219997, 17.925579394834728, 17.925579394834728, 3.4920092383936767, 3.4920092383936767, 9.291124154597508, 9.291124154597508, 11.109810906533774, 11.109810906533774, 7.307666593777439, 7.307666593777439, 10.527858805613494, 10.527858805613494, 6.890078262837315, 6.890078262837315, 5.553160791921739, 5.553160791921739, 4.969906203203076, 4.969906203203076, -0.7771689357330953, -0.7771689357330953, 5.2950908720595065, 5.2950908720595065, 3.2273469268198096, 3.2273469268198096, 12.344258788640005, 12.344258788640005, 4.815466849834191, 4.815466849834191, 3.19857637717935, 3.19857637717935, 1.2683019546635317, 1.2683019546635317, 9.06455501624966, 9.06455501624966, 2.0393813042288897, 2.0393813042288897, 5.249304375811786, 5.249304375811786, 10.142715394949068, 10.142715394949068, 6.142928014071083, 6.142928014071083, 3.819080857978588, 3.819080857978588, 11.18964339732812, 11.18964339732812, 9.81643374257685, 9.81643374257685, 5.343465896935401, 5.343465896935401, 5.143078844240736, 5.143078844240736, 8.36512655016875, 8.36512655016875, 7.636848818886983, 7.636848818886983, 9.841527127496164, 9.841527127496164, 1.6448591829668564, 1.6448591829668564, 8.639148384251925, 8.639148384251925, 6.908574883959384, 6.908574883959384, -2.5546707451859367, -2.5546707451859367, 5.429862536987552, 5.429862536987552, 4.372323239592041, 4.372323239592041, 3.3136871101539165, 3.3136871101539165, 7.576614080137747, 7.576614080137747, 2.121075434485808, 2.121075434485808, 4.369603770633709, 4.369603770633709, 6.067726006461803, 6.067726006461803, 12.108694567290456, 12.108694567290456, 7.983450227635894, 7.983450227635894, 1.1344920147947328, 1.1344920147947328, 2.71062476507941, 2.71062476507941, 7.515896024620527, 7.515896024620527, 7.090015922232273, 7.090015922232273, 8.142901584216181, 8.142901584216181, 1.2875438931786243, 1.2875438931786243, 9.328082636721925, 9.328082636721925, 4.191125801654479, 4.191125801654479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27548509812549193, "mean_inference_ms": 2.0682430978586446, "mean_action_processing_ms": 0.09460768620110223, "mean_env_wait_ms": 0.568780228236563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 11007.35, "sample_throughput": 306.613, "load_time_ms": 0.396, "load_throughput": 8523468.208, "learn_time_ms": 1626.346, "learn_throughput": 2075.204, "update_time_ms": 18.952}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 14.599956703186034, "policy_loss": 0.0009463920607231558, "vf_loss": 14.606795024871825, "vf_explained_var": -0.042606580257415774, "kl": 0.004094460713571157, "entropy": 0.7784715712070465, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.589214599132538, "policy_loss": 0.0047090531326830385, "vf_loss": 2.591732048988342, "vf_explained_var": 0.5211759209632874, "kl": 0.007008080522589391, "entropy": 0.7229248613119126, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 648000, "num_steps_trained": 216000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8640, "training_iteration": 64, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-22-29", "timestamp": 1706106149, "time_this_iter_s": 11.397977352142334, "time_total_s": 768.3300359249115, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E81430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 768.3300359249115, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 26.8, "ram_util_percent": 73.64000000000003, "gpu_util_percent0": 0.07666666666666667, "vram_util_percent0": 0.217333984375}}
{"episode_reward_max": 16.71802116832666, "episode_reward_min": -15.020433762316978, "episode_reward_mean": 0.2243770181019101, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.415870726273756, "policy_agent_": -2.2041799113308675}, "policy_reward_max": {"policy_adversary_": -4.12659884720422, "policy_agent_": 19.533747315225217}, "policy_reward_mean": {"policy_adversary_": -12.37428169809376, "policy_agent_": 6.299329358097834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.903697556509293, -2.1946101148994677, -4.669572032451431, 0.1671805140814589, -1.7657682593264028, 6.93810075018306, -12.152509911817198, -6.782671329800789, -3.2765356081076793, -9.957308928568526, 1.8427793372350423, -2.3642620255991242, 2.3208215377097865, -3.93713734395864, 3.025553133565216, -0.744771399385719, 4.381446708974253, -11.991544922935352, -4.124621939564269, -2.147764060214549, 4.263328301715225, 1.4073227006408988, -11.432688636605908, 0.24046518049766744, -5.729685901635381, 1.3597520801418068, -15.020433762316978, -4.797032333440911, -5.820661583808125, -4.591689702021973, 5.107865951150532, 4.413440078952807, -1.8874586882899738, 8.664811569874413, 3.7699734841771995, 1.24874675636073, -7.716336186960982, 7.6074263313984565, 2.865197977202958, 0.11847003192298375, 7.132181121431836, 10.876131939014455, -0.8578519785120265, 8.61228179966909, 3.809622878538023, 0.09796844060231161, -6.397497402756647, -8.108680144374047, -4.155913822841298, -0.6160305846623686, 2.3379406364062345, -4.203154793324437, 7.21061119404034, -1.054412337627273, 3.7640193156915465, -6.341072392838513, 0.14722679962812285, 1.798316318018334, -1.258216435202867, 3.8969871577720308, 13.108614700473503, -2.2168166570910484, 8.061489980491096, -3.1428324684585833, 2.4908087331777566, -0.2880473342972518, -6.130074191382272, 0.6054761010369952, -4.553842726831269, -5.268749201755905, -5.509164514407167, -1.3931523750681065, 1.4069642584406867, 8.509778151229678, 7.016490609992182, -0.8331376589914297, -1.299516314838066, 3.9929850284857813, 3.520623233866735, 1.6364860272948931, -4.051105625140105, 3.086206025402382, -3.9581799185758753, -3.644380455950038, -4.720908180871529, 8.663190902535948, -1.9162671389551469, -10.045421712736596, 3.836408654705506, 4.163594731864175, -4.587600128787395, -0.175767293357455, 7.895865892212621, -0.31890789746849424, 5.3739646668961205, 6.239317770029982, -1.5854502480362331, -4.6671254325644895, -7.524654576911302, -0.7259463564809117, -4.9147493077577815, -2.26618949531139, -1.2156993770480726, 7.269024406166843, 10.870981543850124, 0.03709645879160192, -0.06513734099020552, 2.3030393873023423, 4.604893929138795, -4.749520401970836, 7.884202487435747, -0.7585891652522245, -0.41439825097254945, -0.7640433129711915, -0.6241147218467852, 5.655313814383427, 10.019901663845587, 2.969660591364748, 16.71802116832666, 3.9244894694555534, 4.820114887423113, -1.0977656755256509, 1.7840821665122768, 0.7114220215136815, 1.1395843709075708, 5.9323910328989, 7.4132469962746494, 6.10578982495516, -8.721988304263226, -4.216545550384315, -0.2529290917056094, 1.859031001063553, 2.150608375703698, -4.335675499215864, 1.0397523762414973], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.498857304924325, -5.578575392464504, -4.142950965128174, -14.10837162452427, -9.320089929054545, -13.980713833552661, -22.27158974377511, -17.686191778229073, -16.821061664296597, -9.988686778785173, -7.141471004475163, -8.383363829876977, -17.443602945080272, -23.72449571593818, -13.331748125688105, -14.260927404609205, -11.938870361705295, -7.583185100273615, -7.969210854428301, -11.608417883795077, -10.663113322419704, -4.780291125758667, -14.921165291747535, -11.927901573063856, -5.970507807231883, -12.928366121876412, -15.463891299194142, -16.340117863051265, -8.573111144342189, -6.500209243037392, -13.44640022081806, -18.239365862386872, -7.4616416309550875, -18.270729485810985, -9.93933720506469, -6.051087955391598, -15.278601001911548, -13.807960874895164, -10.046350479883182, -15.080402187903681, -13.917572321648265, -15.929058625163432, -10.6649020663488, -17.528455196834052, -10.783187533141295, -9.806769853373307, -20.225040705695584, -17.83337118937937, -5.962666248539498, -5.187599087007094, -16.50941377741307, -14.491076751707626, -15.778156401297075, -19.2932608609287, -19.868073513980946, -11.455215443701317, -9.413131383627999, -12.217513085973918, -8.140778181254895, -13.435664436216891, -21.01920150784726, -7.965635855771697, -15.963338389753766, -9.395695547159917, -12.80995232015658, -12.833948140906637, -11.311153226522885, -4.6650242008132015, -5.997271402245961, -6.674295196010735, -15.678622199395962, -11.378354088695238, -12.288192107924994, -16.067532801928497, -16.8434530289679, -10.437946073490279, -18.291231417203385, -9.131567460235956, -24.415870726273756, -12.50382431041924, -6.591534891203213, -14.79003163625054, -7.790476324342831, -6.975511881336021, -4.596583379713399, -19.343827986317685, -6.162226968888319, -21.374285111374938, -8.517405969566852, -12.141266234360842, -7.726733976701879, -20.759019717519493, -16.00220031574341, -5.062551559157591, -11.643404952216299, -12.336358539878065, -7.945195241424959, -15.6034208534728, -17.402889201553027, -7.526418476066236, -14.768506269365263, -4.12659884720422, -15.403251375747345, -14.553894011798983, -22.886464072905998, -5.514411058831556, -14.910115947061694, -9.746051688787512, -12.790675225267234, -9.885738903811689, -16.5730232503841, -8.71160312964869, -5.927231781674242, -12.156061279885492, -10.268211715563016, -10.304539711184628, -13.395381429073856, -13.539106287845046, -22.349473462123772, -12.660361395225205, -11.907541878512573, -8.706515825042011, -7.561576258409175, -21.93562701566584, -11.583273546845403, -11.00189438592562, -11.82396035792278, -15.453978945756067, -18.941606101579083, -10.481383083510192, -20.343000261226276, -7.176542811861737, -6.97077702047583, -14.541809346995366, -5.750547740146048], "policy_policy_agent__reward": [1.7975798742075138, 1.7975798742075138, 1.6919826387825176, 1.6919826387825176, -0.2633105336616295, -0.2633105336616295, 7.1377760693028645, 7.1377760693028645, 3.7771608348640733, 3.7771608348640733, 10.459407291867862, 10.459407291867862, 5.059539915978957, 5.059539915978957, 5.451760224214137, 5.451760224214137, 6.77226302809446, 6.77226302809446, 0.01568892510832215, 0.01568892510832215, 4.492125170855102, 4.492125170855102, 3.0095509021389257, 3.0095509021389257, 9.882212241395031, 9.882212241395031, 9.893679185989761, 9.893679185989761, 8.178650629626661, 8.178650629626661, 6.758078002611743, 6.758078002611743, 8.160158535339773, 8.160158535339773, -2.2041799113308675, -2.2041799113308675, 1.9222944574320164, 1.9222944574320164, 4.7303269117902635, 4.7303269117902635, 7.463220812067464, 7.463220812067464, 3.0938069131997823, 3.0938069131997823, 1.7442383275708098, 1.7442383275708098, 6.0841833767807625, 6.0841833767807625, 0.12041095279825151, 0.12041095279825151, 7.14405910100911, 7.14405910100911, 0.22172876843858405, 0.22172876843858405, 5.771542764805178, 5.771542764805178, 1.3762247802670322, 1.3762247802670322, 0.9542597705077104, 0.9542597705077104, 9.277133085984294, 9.277133085984294, 11.32640297066984, 11.32640297066984, 2.7870914713325567, 2.7870914713325567, 13.4677705278427, 13.4677705278427, 6.854655344620946, 6.854655344620946, 3.6499173558761644, 3.6499173558761644, 3.781132407475285, 3.781132407475285, 10.707693603146812, 10.707693603146812, 6.455774228543069, 6.455774228543069, 7.59943610991333, 7.59943610991333, 10.524876721540048, 10.524876721540048, 13.402595282088942, 13.402595282088942, 4.903525043918387, 4.903525043918387, 13.07036849825157, 13.07036849825157, 7.29640520583966, 7.29640520583966, 4.9523691469878095, 4.9523691469878095, 6.913771651469468, 6.913771651469468, 4.862345522502663, 4.862345522502663, 0.903376212849099, 0.903376212849099, 2.2857842511723625, 2.2857842511723625, 9.423677206909653, 9.423677206909653, 5.143960979191594, 5.143960979191594, 11.494383797668709, 11.494383797668709, 9.119424261650709, 9.119424261650709, 11.816046414836245, 11.816046414836245, 2.5570715254314043, 2.5570715254314043, 4.780179091628063, 4.780179091628063, 7.007914701996125, 7.007914701996125, 3.4412808730260136, 3.4412808730260136, 8.666325796994458, 8.666325796994458, 17.063908104160383, 17.063908104160383, 2.874409599340325, 2.874409599340325, 12.01241418512243, 12.01241418512243, 3.126431539350666, 3.126431539350666, 7.650380526667169, 7.650380526667169, 6.272950403304691, 6.272950403304691, 2.590539517570307, 2.590539517570307, 2.635250150925098, 2.635250150925098, 0.7217143377073449, 0.7217143377073449, 0.7027729971274116, 0.7027729971274116, 5.084728842494397, 5.084728842494397, 4.992600856813567, 4.992600856813567, 6.847578183182841, 6.847578183182841, 12.288655476579088, 12.288655476579088, 11.929971819480047, 11.929971819480047, 4.802404207249426, 4.802404207249426, 8.49585755118266, 8.49585755118266, 6.562276244360869, 6.562276244360869, 13.96824698007024, 13.96824698007024, 7.070155168857066, 7.070155168857066, 1.270214633031554, 1.270214633031554, 8.93811883082646, 8.93811883082646, 1.9161482028834762, 1.9161482028834762, 1.6655657126929908, 1.6655657126929908, -0.06216240057906522, -0.06216240057906522, 14.00350944442682, 14.00350944442682, 2.122979914966586, 2.122979914966586, 5.664431699319175, 5.664431699319175, 6.176907312136179, 6.176907312136179, 8.152430483112509, 8.152430483112509, 1.569566923957241, 1.569566923957241, 10.291626212081015, 10.291626212081015, 11.949033103978016, 11.949033103978016, 2.3718218308445485, 2.3718218308445485, 8.508684809556213, 8.508684809556213, 9.287838154954025, 9.287838154954025, 3.1798724966943634, 3.1798724966943634, 5.468147710454154, 5.468147710454154, 4.939117312320863, 4.939117312320863, 3.4002360597926624, 3.4002360597926624, 4.92687848080374, 4.92687848080374, 0.9302046759464163, 0.9302046759464163, 7.093775999349636, 7.093775999349636, 10.911459208982912, 10.911459208982912, 16.878722808378065, 16.878722808378065, 2.7757537588115793, 2.7757537588115793, 7.4224893030357455, 7.4224893030357455, 6.024545538044927, 6.024545538044927, 8.697784577203015, 8.697784577203015, 2.568109250920426, 2.568109250920426, 12.22861286890992, 12.22861286890992, 3.9765069821982326, 3.9765069821982326, 2.756416765350846, 2.756416765350846, 5.69600898345715, 5.69600898345715, 4.822048496858116, 4.822048496858116, 7.979926762784028, 7.979926762784028, 11.707641546459723, 11.707641546459723, 8.254383439604895, 8.254383439604895, 19.533747315225217, 19.533747315225217, 8.292425432340378, 8.292425432340378, 8.363828382967842, 8.363828382967842, 3.8043750747581795, 3.8043750747581795, 4.672829212460724, 4.672829212460724, 11.32352451858976, 11.32352451858976, 6.361428958876492, 6.361428958876492, 8.46714270941226, 8.46714270941226, 9.618603677098715, 9.618603677098715, 10.779884385355611, 10.779884385355611, 5.109808898657931, 5.109808898657931, 3.1324187665629353, 3.1324187665629353, 10.045035584760335, 10.045035584760335, 4.517786906462645, 4.517786906462645, 4.560692698089764, 4.560692698089764, 5.1030669238897515, 5.1030669238897515, 3.3951500581937735, 3.3951500581937735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2750010249242869, "mean_inference_ms": 2.0648674835710312, "mean_action_processing_ms": 0.09441728713288725, "mean_env_wait_ms": 0.5681056821215437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 219375, "timesteps_this_iter": 0, "agent_timesteps_total": 658125, "timers": {"sample_time_ms": 11015.067, "sample_throughput": 306.398, "load_time_ms": 0.399, "load_throughput": 8465360.603, "learn_time_ms": 1622.055, "learn_throughput": 2080.694, "update_time_ms": 18.949}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005000000000000001, "total_loss": 15.40735158920288, "policy_loss": -0.004202771908603608, "vf_loss": 15.418945026397704, "vf_explained_var": -0.017977416515350342, "kl": 0.004762459175977063, "entropy": 0.7390610575675964, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 2.7278952836990356, "policy_loss": -0.00821395069360733, "vf_loss": 2.7434439659118652, "vf_explained_var": 0.5606886208057403, "kl": 0.004920508884760677, "entropy": 0.7336555004119873, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 219375, "num_agent_steps_sampled": 658125, "num_steps_trained": 219375, "num_agent_steps_trained": 658125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8775, "training_iteration": 65, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-22-39", "timestamp": 1706106159, "time_this_iter_s": 10.802990674972534, "time_total_s": 779.133026599884, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5F19B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 779.133026599884, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 24.692857142857143, "ram_util_percent": 73.60714285714286, "gpu_util_percent0": 0.03000000000000001, "vram_util_percent0": 0.21650041852678573}}
{"episode_reward_max": 14.979048010787913, "episode_reward_min": -18.012284868628974, "episode_reward_mean": -0.0024402565805765886, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.727312424605838, "policy_agent_": -2.8669996576598513}, "policy_reward_max": {"policy_adversary_": -4.7793543701656, "policy_agent_": 20.86396606898974}, "policy_reward_mean": {"policy_adversary_": -11.960987651340023, "policy_agent_": 5.979273697379723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.758156204052709, 9.931068540010102, -1.0704866639714132, -0.1821480064052805, -4.241597540406497, -2.7996096677188476, -0.7415743077828288, -2.7756325371916057, 1.0837878680135207, 11.081246400151795, 0.25093886112623776, -0.6462291074672193, -6.542078096648414, -5.448334965891128, 3.8244297998255314, -1.6703453699633324, -1.9796652568809612, -3.56218271536999, -3.7262048284924787, 0.20361143601735932, -0.7068108068529897, 2.045568195379365, -4.142321103814457, -10.2835139200872, 6.33171046093156, 10.41031440572407, -13.507919122709506, -5.029304296198758, -2.4257578364204817, -7.096237486008547, 3.310523630935346, 3.0250238643461236, 3.099420061150194, 0.08086591424516787, -1.9414589043388573, -4.193136507212524, -5.380949861494608, -0.14987924801696717, 6.198787738507732, -3.045024992867346, -0.0961325363545722, 0.13864773335258773, 2.727763516697703, -3.3509270593656613, 2.119588951808143, 0.4411213731631974, 3.2467400997302445, -0.15794217413027042, 4.496354158524074, -0.5269942531729717, 2.4109147851548167, 9.10457147001181, 2.9376338277123297, 1.4809865505061608, -9.631564063348861, 4.866669468950808, -1.1900980980231286, -2.5225743231163382, 4.5979594594358835, 1.5677571135098416, 7.257946670559007, 3.2363693881466546, 3.1138248942014624, 1.2685711053585877, 12.798862900804508, 0.6423350684354711, -1.415245849858953, -2.549739971925942, 1.8793365105336997, -1.1935650338415589, -6.527703933420372, 0.35120765330337483, 5.069551212344388, 7.132387193002371, 2.0185112061022106, 2.1392292068967143, 3.4366951019117122, 7.536672597278218, -8.081428242566892, 0.2877057164767082, 5.268626220655264, -18.012284868628974, 3.61440985254985, 6.833040876854449, -3.3541148013979436, -0.2917821162937534, -4.2170610420112995, -0.8089999305108236, 2.0570478591246655, -12.880047374373412, 1.1245902131369996, 1.382371448262683, -3.337510951340168, 6.292968410879803, 1.0053341514702667, -0.8296534600923238, 1.3152312357072609, 1.4638351093615234, 1.3920179008604512, 5.165475106867414, 7.801521272964333, 8.679019730608019, -3.0310582754520183, -6.02814965052595, -3.8378925412237566, -2.6715313738862054, 3.2674142404633595, -2.964309840424515, -0.5569271762258456, -6.3749499072864975, 4.932519734447026, -0.41091875691368607, -16.213469103447192, 2.3127786638058745, 4.788545909243041, 2.7889721808070354, -1.7157277488897416, -1.8171480227739263, -0.25870381956437993, 14.979048010787913, 2.151361640359306, -2.1442197622447168, -3.8439923215872875, -1.835267389995992, -0.8207242097594485, -1.22676251392529, -5.470758798852049, 1.5837108159584279, 0.1940548091712229, 7.283001429515426, -8.069703871912836, 0.12282168921657055, 2.945576755217668, -4.402953436928392, -4.5408440570916], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.939070890740716, -19.06233619712544, -4.879954687606329, -14.940669247107747, -21.86054641759566, -13.035354562985319, -7.939051434706351, -7.704293187518352, -9.557751026777991, -19.313262647396098, -7.368262052484067, -4.817339146997335, -11.037175170992803, -8.709254867082937, -15.571598270687403, -14.787799482475377, -14.897238176740501, -14.062994884037547, -12.519188789836216, -8.299913663083176, -6.761187532229971, -10.506896302952125, -15.690179536194728, -15.277971330068285, -11.794821369026613, -17.121884687613107, -9.23177527268976, -25.17590865167696, -6.71776722923407, -11.847807731901717, -9.151772429217182, -9.215539103849144, -9.48488410582849, -16.08658294138546, -4.7793543701656, -6.467392588311994, -7.551224166563054, -12.573488051449237, -10.418803714256942, -12.189568268142285, -8.49189515507741, -16.181080722936553, -6.728621035458478, -11.829335613461442, -6.748957196226733, -10.312909651447706, -14.340410381582613, -5.176428654558031, -26.263744130959367, -8.6896385667505, -9.183681398619536, -15.548830730178423, -9.676254592555152, -11.991983390406078, -9.916630118062596, -14.164920572331624, -11.944315836826053, -9.487071816946335, -16.5515514118837, -13.427832046116464, -20.86593266840558, -13.204626725956537, -9.531010080688155, -8.768118939462552, -17.070716408347447, -17.746465134617548, -9.361756626542437, -5.649881490540194, -11.605090137871446, -18.598156847356382, -7.77589471125087, -7.496986901493782, -12.214733978274353, -18.753897344880603, -11.790758629822319, -7.407778113241404, -13.493465492825878, -14.114011246037421, -16.807358931982996, -9.69834318914531, -14.758541760780716, -12.278285553309289, -14.00458650836723, -15.939632961631705, -7.456369705651835, -5.997615000457601, -16.9438118051424, -6.4671554906454105, -12.643503662983484, -15.595420866846403, -6.849468549460548, -10.38393512306589, -5.881241845675356, -12.273746533919224, -5.807396522590255, -7.469822834812299, -9.04218368176182, -6.752221252171493, -8.974731093816375, -11.046545693356585, -23.44376485433795, -15.770337613079125, -11.039478703523642, -30.727312424605838, -10.365496122159461, -12.510122508638313, -15.502207748245628, -8.922402977749483, -6.326273640906967, -8.786249296395624, -10.177640388936435, -13.47098085547476, -23.462298866258156, -8.176282594876746, -8.670836181194131, -12.877255846016787, -7.329837271350653, -15.857382923994413, -8.879899798600666, -26.74888412719157, -8.683487851881628, -10.75659687223174, -14.046246725957065, -12.413727730073944, -8.685559457576927, -11.18977939133593, -13.584946093916933, -9.357885242602292, -6.426909164404715, -17.356892666917926, -8.208041211696479, -11.164074478902023, -13.704515658914682, -12.444758152077787, -8.139810234568639], "policy_policy_agent__reward": [4.090457343344004, 4.090457343344004, 14.496702368567774, 14.496702368567774, 1.9047340118174572, 1.9047340118174572, 7.379260620351229, 7.379260620351229, 8.809474438594584, 8.809474438594584, 5.117872447633234, 5.117872447633234, 3.598738563461761, 3.598738563461761, 2.4643303251633735, 2.4643303251633735, 5.320769447395756, 5.320769447395756, 15.197254523773946, 15.197254523773946, 3.809600456805152, 3.809600456805152, 2.0855550197650583, 2.0855550197650583, 2.2475485371721953, 2.2475485371721953, 1.6304599505959039, 1.6304599505959039, 9.698014035256467, 9.698014035256467, 6.5587270562560205, 6.5587270562560205, 6.458786459929767, 6.458786459929767, 5.250406084333778, 5.250406084333778, 4.396491980671868, 4.396491980671868, 4.251762549550267, 4.251762549550267, 3.027188362688491, 3.027188362688491, 6.276232249165744, 6.276232249165744, 5.773929216190135, 5.773929216190135, 2.497228704990543, 2.497228704990543, 9.063265914979086, 9.063265914979086, 13.766099546668588, 13.766099546668588, -2.1380719250098754, -2.1380719250098754, 10.073302177739103, 10.073302177739103, 2.146004696406793, 2.146004696406793, 2.375785122946587, 2.375785122946587, 6.231148030076262, 6.231148030076262, 6.120281484097634, 6.120281484097634, 6.292152083489344, 6.292152083489344, 8.083724427815312, 8.083724427815312, 1.4189477329133717, 1.4189477329133717, 1.1371280405497346, 1.1371280405497346, 1.0851371525342217, 1.0851371525342217, 6.211804401716134, 6.211804401716134, 8.308795726382339, 8.308795726382339, 4.57227163763747, 4.57227163763747, 4.197881309361419, 4.197881309361419, 8.15986422814457, 8.15986422814457, 4.728192276078089, 4.728192276078089, 4.239204277047889, 4.239204277047889, 4.4342730740174385, 4.4342730740174385, 5.3770155123054515, 5.3770155123054515, 8.793575240656427, 8.793575240656427, 2.50924324021388, 2.50924324021388, 15.380049144741724, 15.380049144741724, 4.081322156788765, 4.081322156788765, 5.7972980918871775, 5.7972980918871775, 12.326701100095116, 12.326701100095116, 6.306944210133742, 6.306944210133742, 6.736484970456118, 6.736484970456118, 0.14253302735686485, 0.14253302735686485, 9.515795020641214, 9.515795020641214, 5.377108869401464, 5.377108869401464, 3.482248746914999, 3.482248746914999, 10.574755435659789, 10.574755435659789, 7.497794579813151, 7.497794579813151, 14.061939669482294, 14.061939669482294, 8.220498057051595, 8.220498057051595, 6.322417487444809, 6.322417487444809, 5.0183450224105695, 5.0183450224105695, 14.93478965457598, 14.93478965457598, 9.194400101526508, 9.194400101526508, 3.9732553883417427, 3.9732553883417427, 1.5500707593071248, 1.5500707593071248, 6.742213324202575, 6.742213324202575, 8.702295906757415, 8.702295906757415, 0.6240953889152482, 0.6240953889152482, 3.924097277398578, 3.924097277398578, 8.642142595309371, 8.642142595309371, 12.943142268941488, 12.943142268941488, 6.904634917962267, 6.904634917962267, 4.77350366006906, 4.77350366006906, 8.465080297368795, 8.465080297368795, 10.82534192165782, 10.82534192165782, 4.362965344708056, 4.362965344708056, 4.993024452811008, 4.993024452811008, 10.013583990717994, 10.013583990717994, -2.8669996576598513, -2.8669996576598513, 8.80949818045854, 8.80949818045854, 11.386336919243082, 11.386336919243082, 2.051127452126944, 2.051127452126944, 2.852916442081924, 2.852916442081924, 6.363375381565554, 6.363375381565554, 2.8290777800672933, 2.8290777800672933, 7.350275761054073, 7.350275761054073, 1.3576867462364972, 1.3576867462364972, 3.9870293812987727, 3.9870293812987727, 5.883153285664286, 5.883153285664286, 1.2718654471675954, 1.2718654471675954, 9.283357472399516, 9.283357472399516, 3.406365337030261, 3.406365337030261, 3.3200846873599867, 3.3200846873599867, 5.178707458734539, 5.178707458734539, 4.1080281807665076, 4.1080281807665076, 5.183374497338415, 5.183374497338415, 8.106010400111998, 8.106010400111998, 15.622643063651145, 15.622643063651145, 12.22467867184357, 12.22467867184357, 4.004210214035814, 4.004210214035814, 12.349581387039947, 12.349581387039947, 3.263801790467853, 3.263801790467853, 4.919295567376053, 4.919295567376053, 9.384810994354496, 9.384810994354496, 2.979046568662484, 2.979046568662484, 2.8846732323405617, 2.8846732323405617, 1.2056496945545652, 1.2056496945545652, 7.555080061691729, 7.555080061691729, 6.530031049280537, 6.530031049280537, 3.62441488140548, 3.62441488140548, 5.244530629341311, 5.244530629341311, 6.729691045218588, 6.729691045218588, 7.833114013411908, 7.833114013411908, 2.8070547612304555, 2.8070547612304555, 7.020117450610243, 7.020117450610243, 4.310597989518144, 4.310597989518144, 20.86396606898974, 20.86396606898974, 5.417424746120466, 5.417424746120466, 4.30618855499351, 4.30618855499351, 5.101127202184885, 5.101127202184885, 5.289230170038975, 5.289230170038975, 3.932417623908738, 3.932417623908738, 4.981508438705319, 4.981508438705319, 4.05709364753244, 4.05709364753244, 5.470798029280359, 5.470798029280359, 3.31048198678797, 3.31048198678797, 12.319947048216672, 12.319947048216672, 0.06916866989182342, 0.06916866989182342, 5.643448084059298, 5.643448084059298, 8.325046207066176, 8.325046207066176, 4.020902357574697, 4.020902357574697, 1.79948308873852, 1.79948308873852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27450615547814505, "mean_inference_ms": 2.0626456325271505, "mean_action_processing_ms": 0.09422196950146955, "mean_env_wait_ms": 0.5675186590586063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 222750, "timesteps_this_iter": 0, "agent_timesteps_total": 668250, "timers": {"sample_time_ms": 11007.777, "sample_throughput": 306.601, "load_time_ms": 0.399, "load_throughput": 8465360.603, "learn_time_ms": 1621.762, "learn_throughput": 2081.07, "update_time_ms": 19.046}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005000000000000001, "total_loss": 15.167338275909424, "policy_loss": -4.80685819638893e-05, "vf_loss": 15.174980163574219, "vf_explained_var": -0.025724875926971435, "kl": 0.0058112489875683185, "entropy": 0.7593740224838257, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0005000000000000001, "total_loss": 2.464223825931549, "policy_loss": -0.008660804480314255, "vf_loss": 2.48022745847702, "vf_explained_var": 0.5723885297775269, "kl": 0.006209480367299874, "entropy": 0.7344040453433991, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 222750, "num_agent_steps_sampled": 668250, "num_steps_trained": 222750, "num_agent_steps_trained": 668250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8910, "training_iteration": 66, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-22-51", "timestamp": 1706106171, "time_this_iter_s": 11.070220708847046, "time_total_s": 790.2032473087311, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 790.2032473087311, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 73.54285714285713, "gpu_util_percent0": 0.03071428571428572, "vram_util_percent0": 0.21515764508928573}}
{"episode_reward_max": 18.32273811771724, "episode_reward_min": -17.554705694070197, "episode_reward_mean": 0.25724619014136785, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.829325904454546, "policy_agent_": -2.5786977189807554}, "policy_reward_max": {"policy_adversary_": -4.7056972041103675, "policy_agent_": 21.44150241364899}, "policy_reward_mean": {"policy_adversary_": -12.11536142724583, "policy_agent_": 6.1863038086936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6876028033985416, -10.771138894764738, 2.0498988110543865, -8.300002301306922, -2.1149969860892686, -8.023771795431411, 8.372113796615318, -2.60309785693849, 3.3199779906049534, 5.0643593481921005, -0.6007286501339396, -2.1228417632262118, 18.32273811771724, 6.652065940386848, -3.908624154026417, 7.852022509240307, 2.8936897245015896, 6.4497225945818855, 0.7940054259905055, 6.555477639788944, 1.7360585028447602, 7.82156978431653, 8.004475796853681, -3.878921662545397, 4.753237017868681, 5.222589500180707, 0.210308053581096, 5.395871301626629, -15.197520234366173, 6.325341429252032, 5.644688885491369, 5.686939399559642, -2.592708468242881, -2.1321942111364085, -0.1900656591326425, 2.5868814201271357, -1.8931976574890428, -9.017912301787689, -0.1738722179942459, 1.4649729460908594, 2.8059696664961664, 3.6482686120132266, 7.621443580596749, 8.613553656905902, 5.533522778629626, -1.9929731469787662, 2.3431166817114897, -0.13108647542799995, -6.713674696695991, -5.55991601503755, -2.8675888245017123, 4.523302796936913, -7.64093495445038, 2.3667980156353963, 4.225745112574365, -6.080581320189115, 0.48537154914720704, 6.008329922953737, 0.7408320752397959, -8.097917703711108, 0.2124169005062988, 2.0443490536311324, -3.129160662956042, -2.132299979788034, 3.691622817334162, 7.5112071118107755, -0.29999937660445375, 7.7483391124097905, 3.7098638172191225, -9.58608844290829, -3.2162951196824423, -3.093762219784684, -6.0687057105462925, 6.395603732626358, 3.8165044883935435, -1.9967734176909926, -2.0098184383006963, 8.1408876917937, 2.95368402820949, 3.9286218357057194, 5.9860859106532835, 14.366853969924351, -5.168311850847445, 2.9686522752958133, 6.2672090041076025, -4.138134355455794, -1.0476351060540228, 1.6260083512509018, -0.186476743893074, 1.7183908305065494, -17.554705694070197, 1.547139255575979, 3.2738977477959468, -4.202973961954497, 5.90367687053798, 2.2043784295344664, -5.246582043813564, -2.4648113590643277, -3.48024479917275, -0.9442328627123795, -1.8299776073868612, 3.836544441332398, -7.599071913873832, -1.2995355975864047, 1.2953641844770276, -2.5988524005754363, -3.7914936169264677, 3.2569347556203425, -1.414759740039637, -4.0559605268538075, 1.3239087030403407, 3.8522078567807925, 9.017673441580309, -0.2692646893929729, 2.785511872069311, -2.2533135718827157, -4.730472505055848, 2.6108204869143052, -5.759516295429161, -5.566996626551688, -9.738969904965707, -0.7116034794449754, -1.689248978711688, -2.595852374972759, -8.355036731511502, -1.2432581214488663, 5.071765436660045, 0.030206169140603673, -9.84064819997802, 2.0681759996843208, 3.565919802833383, 1.874114609794564, -3.577180230447574, -6.415789125760242, -0.7490861786717224], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.251822116769201, -13.20685607893879, -9.872634256357236, -16.001298639355884, -9.25600290958459, -14.375872325682067, -20.533261257801858, -6.2346425142384065, -22.56684889921501, -10.697925128490997, -14.293763485425359, -7.593408349425931, -24.560266709580738, -17.436665425436747, -6.621944873259111, -17.04187949390676, -15.782569350799482, -14.974942426486843, -11.165825414909836, -11.468007099512885, -9.722592558522473, -13.347593599117271, -15.08907434910763, -10.46291690899568, -13.578825776475696, -11.917998950289917, -8.71761104844698, -10.900977162474055, -10.040124796404669, -15.412436135009512, -14.54134119016015, -15.820293579987812, -7.598661812871372, -10.797444727329184, -6.503099062970045, -5.513011233100821, -7.915494613556891, -9.44293081012097, -7.681922050798613, -19.959990770609014, -7.254204808156785, -7.101767669873283, -30.829325904454546, -18.246540631098114, -17.1884017118831, -7.700617281246018, -9.854937881815559, -23.818502174302395, -15.046121103481768, -8.251521038904263, -8.61471048237831, -10.381111921472208, -7.818676169607046, -8.3184294198573, -15.276175620871411, -5.832372194575863, -7.624187016233337, -11.76778025356268, -9.119743387351095, -10.060525257837968, -9.394458197764253, -9.003369088382703, -7.049883601618396, -16.866707977846474, -14.811089958855586, -13.104486424717908, -6.589847920040559, -16.868491427364102, -14.305992381635818, -12.585903991167754, -6.804698555771526, -11.992573355018878, -18.793310266714055, -14.61526421186217, -15.173240319906387, -15.432983914850436, -10.097720057880323, -16.344657562394776, -17.115163988360944, -10.809830591350739, -18.7708763775096, -19.822853205998058, -9.840533872522439, -13.233124813451036, -18.327525013154986, -8.52696212852003, -7.237961620166104, -17.533466359724592, -9.907981431927269, -7.231233305344652, -14.007007266807044, -16.361724874038607, -8.701553240405751, -7.233202746079452, -16.182524470031073, -17.643032847425655, -11.008799112019815, -7.348515110609765, -7.393687958925852, -8.748324506372079, -15.058407077247804, -7.962919488486556, -5.145819173709783, -4.7056972041103675, -5.306317521570039, -9.205647267996012, -8.895340454845167, -8.70833065476966, -7.3022353865834395, -9.830827795511594, -7.188423321712289, -19.136365344747194, -13.535547155352127, -9.727576326908926, -14.172140428508287, -16.15675559432677, -13.153509564209255, -13.00540693514443, -15.062101462706616, -11.770203391495194, -18.844773996814126, -11.232836425192572, -15.276746421909708, -14.908121425079287, -17.437277267646778, -11.993610076702446, -12.084679778074129, -7.101961223737129, -10.923598078026334, -11.547502730892589, -9.049142812051794, -13.700024724900473, -5.648300708248629, -8.937037843220294, -9.031613740722433], "policy_policy_agent__reward": [5.9697124600838745, 5.9697124600838745, 1.217858592087029, 1.217858592087029, 5.96126653370581, 5.96126653370581, 3.8506481690244847, 3.8506481690244847, 3.570502961747662, 3.570502961747662, 3.1760502651253284, 3.1760502651253284, 14.452687527208587, 14.452687527208587, 1.8157723286499574, 1.8157723286499574, 12.943413444909979, 12.943413444909979, 7.88114223834155, 7.88114223834155, 6.846517417645712, 6.846517417645712, 2.7352832930998603, 2.7352832930998603, 21.44150241364899, 21.44150241364899, 12.044365682911796, 12.044365682911796, 1.3566603596163465, 1.3566603596163465, 12.446951001573531, 12.446951001573531, 9.338129537650538, 9.338129537650538, 10.71233251053436, 10.71233251053436, 5.979915420450172, 5.979915420450172, 9.011742369650912, 9.011742369650912, 5.729325530683616, 5.729325530683616, 10.584581691716899, 10.584581691716899, 11.54677507298066, 11.54677507298066, 3.291997623225141, 3.291997623225141, 9.166031397172187, 9.166031397172187, 8.570294225235315, 8.570294225235315, 4.463959551014036, 4.463959551014036, 8.148424232050342, 8.148424232050342, -2.5786977189807554, -2.5786977189807554, 10.868888782130767, 10.868888782130767, 10.093015037825756, 10.093015037825756, 10.75361648977373, 10.75361648977373, 2.502976672314246, 2.502976672314246, 4.332625258096388, 4.332625258096388, 3.1565167019187017, 3.1565167019187017, 4.049946326613977, 4.049946326613977, 3.0111484780339244, 3.0111484780339244, 0.2125092541666395, 0.2125092541666395, 3.7540249164021833, 3.7540249164021833, 10.71248185834994, 10.71248185834994, 5.030087237326477, 5.030087237326477, 5.375018140943257, 5.375018140943257, 19.22538474252565, 19.22538474252565, 13.430047144002016, 13.430047144002016, 11.36096224525636, 11.36096224525636, 2.853822067133628, 2.853822067133628, 6.099027281763526, 6.099027281763526, 11.843707849437198, 11.843707849437198, 4.1662232033928905, 4.1662232033928905, 1.3458025119333568, 1.3458025119333568, 2.8735608289382975, 2.8735608289382975, 7.45220735920456, 7.45220735920456, 0.08887060757833187, 0.08887060757833187, 5.3426137177463495, 5.3426137177463495, 9.750960366722886, 9.750960366722886, -0.12410456280662711, -0.12410456280662711, 4.054779282690272, 4.054779282690272, 8.888055088258207, 8.888055088258207, 4.930287731295444, 4.930287731295444, 0.9813037770634299, 0.9813037770634299, 4.803437549135276, 4.803437549135276, 5.5238590710069175, 5.5238590710069175, 1.9603614693311784, 1.9603614693311784, 7.36720399902922, 7.36720399902922, 9.251356388094873, 9.251356388094873, 10.30784676826434, 10.30784676826434, 3.144924271718052, 3.144924271718052, 12.308415269886952, 12.308415269886952, 9.007928099427476, 9.007928099427476, 1.4999077741297342, 1.4999077741297342, 1.7942017180445406, 1.7942017180445406, 4.449405567617097, 4.449405567617097, 6.3623022780838845, 6.3623022780838845, 10.505433972244266, 10.505433972244266, 9.494872404149964, 9.494872404149964, 6.71810524857972, 6.71810524857972, 4.043950809789813, 4.043950809789813, 12.242772627094242, 12.242772627094242, 10.034424008285214, 10.034424008285214, 7.369226213528228, 7.369226213528228, 12.378481144081446, 12.378481144081446, 17.0948535879612, 17.0948535879612, 2.336111010837496, 2.336111010837496, 8.100888544373424, 8.100888544373424, 12.297367008631296, 12.297367008631296, 2.194413886532118, 2.194413886532118, 3.09516325705604, 3.09516325705604, 9.579737355487746, 9.579737355487746, 4.860752344017098, 4.860752344017098, 4.4748120679256, 4.4748120679256, -1.7738492136315902, -1.7738492136315902, 8.954432064807294, 8.954432064807294, 5.987725494100848, 5.987725494100848, 1.515114392062477, 1.515114392062477, 11.043100670284531, 11.043100670284531, 9.923705638480063, 9.923705638480063, 2.8811085341031277, 2.8811085341031277, 2.441851875772718, 2.441851875772718, 1.9567215798765514, 1.9567215798765514, 3.90204582182985, 3.90204582182985, 6.6142147349304725, 6.6142147349304725, 5.899731964909475, 5.899731964909475, -1.2266263700820252, -1.2266263700820252, 1.7030808032619813, 1.7030808032619813, 3.300840853023532, 3.300840853023532, 3.303397433710286, 3.303397433710286, 2.55192341895935, 2.55192341895935, 5.982632705195003, 5.982632705195003, 2.9437378232719005, 2.9437378232719005, 2.8874336343288944, 2.8874336343288944, 4.256166012376315, 4.256166012376315, 11.494286600763994, 11.494286600763994, 11.276610298466219, 11.276610298466219, 4.729155818757975, 4.729155818757975, 8.478826150288798, 8.478826150288798, 6.951721011222027, 6.951721011222027, 4.211518529576703, 4.211518529576703, 7.808113711029368, 7.808113711029368, 4.651292583638731, 4.651292583638731, 3.1016033824717506, 3.1016033824717506, 4.552902045924211, 4.552902045924211, 5.260616472873799, 5.260616472873799, 6.793748721599013, 6.793748721599013, 6.1561345250532655, 6.1561345250532655, 4.541120268067636, 4.541120268067636, 5.375175977626787, 5.375175977626787, 8.578222607367088, 8.578222607367088, 3.5660836964388674, 3.5660836964388674, 0.5414749390241569, 0.5414749390241569, 6.807839365288453, 6.807839365288453, 6.307531307442587, 6.307531307442587, 7.787069667347517, 7.787069667347517, 1.0355602389005276, 1.0355602389005276, 1.2606243587300259, 1.2606243587300259, 4.141263781025353, 4.141263781025353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2747318687662651, "mean_inference_ms": 2.0639030729284027, "mean_action_processing_ms": 0.09430818993723455, "mean_env_wait_ms": 0.5678380497324272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 226125, "timesteps_this_iter": 0, "agent_timesteps_total": 678375, "timers": {"sample_time_ms": 11160.608, "sample_throughput": 302.403, "load_time_ms": 0.499, "load_throughput": 6768888.251, "learn_time_ms": 1660.262, "learn_throughput": 2032.812, "update_time_ms": 20.043}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005000000000000001, "total_loss": 15.285978507995605, "policy_loss": 0.008224843395873904, "vf_loss": 15.285406398773194, "vf_explained_var": -0.013361775875091552, "kl": 0.004448005806947375, "entropy": 0.7652877867221832, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0005000000000000001, "total_loss": 2.8962180495262144, "policy_loss": -0.014192358311265706, "vf_loss": 2.9180837512016295, "vf_explained_var": 0.5794437229633331, "kl": 0.004842724643929314, "entropy": 0.7674201995134353, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 226125, "num_agent_steps_sampled": 678375, "num_steps_trained": 226125, "num_agent_steps_trained": 678375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9045, "training_iteration": 67, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-23-03", "timestamp": 1706106183, "time_this_iter_s": 12.65380597114563, "time_total_s": 802.8570532798767, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5F19550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 802.8570532798767, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 38.825, "ram_util_percent": 73.81875000000001, "gpu_util_percent0": 0.039999999999999994, "vram_util_percent0": 0.2205810546875}}
{"episode_reward_max": 15.995376298407844, "episode_reward_min": -15.219399211437665, "episode_reward_mean": 0.5636443034647115, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.553717186808296, "policy_agent_": -1.123448070479679}, "policy_reward_max": {"policy_adversary_": -3.168205018001713, "policy_agent_": 19.238233032505043}, "policy_reward_mean": {"policy_adversary_": -12.0146516925391, "policy_agent_": 6.289147998001906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2067740140327496, 3.2029039946356104, 9.403431203879451, 1.5059694919051638, -2.222497182866687, 8.330479937499243, -1.2191710737388086, 5.118203317026143, 3.806039772679033, 0.9841652284903384, 1.704818052949481, 4.844471570146063, 2.7633808109073454, -0.33230275547111476, -2.084950937911814, 4.975098430742818, 2.9754938126262807, 3.008432457420089, -8.54231778692026, -0.6352959045604893, 0.7199479502560541, -6.761499643467017, -5.341132873746, 0.5267645728089375, -0.8621050251173097, 1.6976765726757332, -5.761297403682216, 12.965289763375655, -1.4175081552893711, 6.6510855595920555, -2.839102593007051, -6.16305493773689, 10.35650622049647, -3.677020976614097, 10.289327106406246, -4.95510482536959, 0.677104767299461, -8.763900428772752, 1.9085629801173445, 1.800927204901122, 2.721654933791118, 0.849264734931504, 0.0955382682740932, 7.544772270245629, 8.371780912551536, 8.124385598606866, 5.295233414114092, 1.3077106168856425, -1.8868571548504245, 9.57936640127597, 1.7494412766935004, -15.219399211437665, 10.352410751405184, 6.906307395293065, -6.222545776744481, 15.995376298407844, -7.144775429334527, 0.5864525748764305, -1.5096449331839326, -2.8605547660696127, 0.1037336828978968, 1.5081183101036277, 0.2769635790386829, 5.076694251603103, 4.787141734620213, -0.5194734568806478, -3.9244357849801954, 5.858933502109307, 4.25038805970383, -2.253789694632381, 1.98414974601586, -4.753224710908932, -3.4617877784506623, 0.8886745380700085, -6.828965414749417, -1.129433261697463, 2.771597971887927, -3.3846522998504724, -9.922335042621297, -3.8253474877889286, 2.301084881323415, 5.196695385663761, 9.475825238258153, 4.900253706864961, -8.190245601285662, -2.015573933901714, -6.577590302449374, 1.1312052969499387, -0.04677215385086364, -8.313174768947073, -1.156544805779349, -2.586541664679514, 0.37261263451794235, -2.038824808659111, -0.6293988438883493, 9.724454889599562, -2.90775377836058, 0.4918161748465719, 0.5542810887672681, -2.687582853298277, 9.98115350684008, 3.462842737421285, 4.538280664834332, 0.19651717236627836, 2.357473321717562, -4.978188784026015, 4.13676352985713, 0.859170514697821, 1.6057842845619996, -0.944876505944604, -14.243724820241068, 3.9020539985417666, 1.969412854572958, -1.0404074730995123, 2.2024326049425875, -1.5898576613582802, -0.22518949976094613, -2.6273729824132626, 0.12138049684526156, 3.6786249486676876, -0.9170113127933007, 1.7146159330943669, -2.5893697023983515, 0.021556302162358074, 4.023690377109686, -0.6703371758554566, -0.7728300607445855, -5.252946033786713, -3.512494460039776, -0.1762135885420636, -4.650679717140642, 2.2703808507750085, 7.091923717230657, 5.8243484087566335, -8.656612168625848], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.566596258776785, -10.166573710938263, -19.52930196577227, -9.4200471877231, -18.81944323827983, -13.313839164087694, -9.617898067605962, -11.371256850542254, -9.132778494548067, -5.77220931726234, -11.963592529613772, -18.45921434215748, -9.21941536670658, -5.108760674029973, -8.975544776460525, -12.07206261110162, -10.799491711126693, -13.031709167935553, -6.295421645960901, -6.48128374105115, -8.446893986809306, -13.900044411821867, -12.504411292207124, -18.456731254317422, -9.600379515482338, -11.088060739385979, -6.476761698554312, -18.63203314348301, -11.065582430575466, -15.0690947068982, -6.372268665155429, -6.549136960525568, -17.38103755999537, -6.96917938357741, -14.736201352409362, -10.91094880652254, -6.937107443520177, -11.637914944846745, -7.782358240674199, -10.474161917275993, -10.424911982184412, -13.902777988037345, -5.704854396284797, -27.553717186808296, -18.966285456643075, -12.84908806057974, -10.60166524137747, -10.114712184377048, -14.215244160532347, -17.58491369205406, -9.870431997048673, -16.904373830220763, -21.398362669416212, -12.780348947572502, -16.391646103602618, -22.481089766602242, -19.053565466848088, -5.116057451059049, -12.815087262214506, -7.933676447152809, -10.491456324983464, -14.40879178854992, -8.815566976201632, -13.75202677943344, -19.190599812656146, -4.941874124750364, -12.154835911541513, -12.163628796178338, -15.062964705014586, -11.41771484618092, -8.12862387006211, -14.271888295205423, -16.831585667145863, -6.574915711254145, -10.046369057825519, -4.287126999875889, -6.2541395393237265, -9.1343402740516, -19.640468948353636, -18.839846857486098, -18.937892060508556, -14.185355385228261, -15.375418701406996, -12.16187803843938, -17.78212209502824, -14.237450486286047, -7.535075807962141, -14.245875779654426, -6.718908471519266, -17.754678112057235, -7.766107562669326, -10.100930933925577, -10.876791765865686, -6.453725744377884, -11.78391549573753, -24.90315373743414, -14.535410678707327, -5.920647473507698, -7.591598229013299, -8.488913409020341, -15.93506923165911, -8.91986798409972, -9.069294326549857, -5.132220855479772, -8.168757342170737, -7.535937888525535, -11.862762000909196, -8.518846657752267, -12.508757110748457, -7.9057353891201565, -20.217553992781294, -13.626416665792918, -8.29218905788421, -3.168205018001713, -9.779342071839308, -19.68627598429633, -10.230775426220665, -8.09572608421078, -12.340636181219269, -15.913440735275879, -6.697574463004796, -9.283499619675963, -11.749088483122923, -10.541361411837014, -13.311479913676415, -11.889932250903918, -6.849942086691846, -21.222014231906755, -18.55187134606496, -10.45420868328573, -15.150371196706043, -11.47899745580431, -13.338576126678653, -13.379086142370529, -14.637990255753238], "policy_policy_agent__reward": [6.386685136404766, 6.386685136404766, 6.684738852786937, 6.684738852786937, 14.46636658482586, 14.46636658482586, 5.46300833981413, 5.46300833981413, 8.298473027706574, 8.298473027706574, 10.822159550793472, 10.822159550793472, 4.199363496933576, 4.199363496933576, 8.244730083784196, 8.244730083784196, 6.46940913361355, 6.46940913361355, 3.3781872728763407, 3.3781872728763407, 6.834205291281626, 6.834205291281626, 11.651842956151771, 11.651842956151771, 5.991398088806963, 5.991398088806963, 2.388228959279429, 2.388228959279429, 3.445296919274355, 3.445296919274355, 8.523580520922216, 8.523580520922216, 6.887492761876488, 6.887492761876488, 8.02007081267782, 8.02007081267782, -1.123448070479679, -1.123448070479679, 2.922993918245331, 2.922993918245331, 4.58342096853268, 4.58342096853268, 3.5692723841774234, 3.5692723841774234, 3.5816392092305613, 3.5816392092305613, 9.491747913563177, 9.491747913563177, 4.369137245182515, 4.369137245182515, 6.3928686560308545, 6.3928686560308545, 0.35773214743604653, 0.35773214743604653, 15.798661453429336, 15.798661453429336, 4.8240371376430495, 4.8240371376430495, 10.860090133245127, 10.860090133245127, 1.7665830360741899, 1.7665830360741899, 0.19304101139433905, 0.19304101139433905, 13.868771890245922, 13.868771890245922, 1.6460792034816571, 1.6460792034816571, 12.512764229407804, 12.512764229407804, 2.977921990576474, 2.977921990576474, 3.8071061054098196, 3.8071061054098196, 1.437007258036994, 1.437007258036994, 4.845460610395772, 4.845460610395772, 6.137544561088555, 6.137544561088555, 6.573283457987763, 6.573283457987763, 7.376021361484423, 7.376021361484423, 2.900196332279445, 2.900196332279445, 17.54924472852696, 17.54924472852696, 13.669033184597305, 13.669033184597305, 10.486736829593301, 10.486736829593301, 7.948449327745781, 7.948449327745781, 5.711211400631348, 5.711211400631348, 6.164193502840962, 6.164193502840962, 13.58214004666502, 13.58214004666502, 5.809936636871086, 5.809936636871086, 0.8424873093915537, 0.8424873093915537, 15.875386710410694, 15.875386710410694, 9.843328171432786, 9.843328171432786, 5.08455016342907, 5.08455016342907, 19.238233032505043, 19.238233032505043, 5.954395018756778, 5.954395018756778, 2.851255012967741, 2.851255012967741, 5.652721164515287, 5.652721164515287, 2.5365608405415956, 2.5365608405415956, 5.297595003940682, 5.297595003940682, 7.958455049326773, 7.958455049326773, 4.546265277620157, 4.546265277620157, 9.414360515518268, 9.414360515518268, 11.988870773638178, 11.988870773638178, 2.211200333934857, 2.211200333934857, 4.115200063280658, 4.115200063280658, 9.011281149143823, 9.011281149143823, 9.656676382359207, 9.656676382359207, 4.581962575774269, 4.581962575774269, 5.056386808038986, 5.056386808038986, 4.759331792148249, 4.759331792148249, 6.684898944347602, 6.684898944347602, 3.7317951246620775, 3.7317951246620775, 1.6087018215380542, 1.6087018215380542, 1.578846869089213, 1.578846869089213, 4.512868755605826, 4.512868755605826, 2.874843987100565, 2.874843987100565, 4.8590669528661685, 4.8590669528661685, 7.507249684848585, 7.507249684848585, 10.619488470915986, 10.619488470915986, 9.691025385446013, 9.691025385446013, 12.425621969832575, 12.425621969832575, 8.531065872652173, 8.531065872652173, 4.795938246871292, 4.795938246871292, 6.110938276192165, 6.110938276192165, 0.4787427527563826, 0.4787427527563826, 7.68854053830218, 7.68854053830218, 3.3360681588342014, 3.3360681588342014, 4.7207516715550835, 4.7207516715550835, 3.304781378444989, 3.304781378444989, 3.757194634623031, 3.757194634623031, 5.624702200191814, 5.624702200191814, 2.2074504678593847, 2.2074504678593847, 5.577258325924592, 5.577258325924592, 17.313804313516847, 17.313804313516847, 5.813828450173373, 5.813828450173373, 3.2062318241771357, 3.2062318241771357, 4.072939658890284, 4.072939658890284, 2.900665277861033, 2.900665277861033, 12.958111369249595, 12.958111369249595, 6.191355360760504, 6.191355360760504, 6.803787495692095, 6.803787495692095, 2.6643690139230256, 2.6643690139230256, 5.263115331944149, 5.263115331944149, 1.27887455224976, 1.27887455224976, 7.999762765383164, 7.999762765383164, 4.689008586225043, 4.689008586225043, 7.0572706976552295, 7.0572706976552295, 3.480429441587776, 3.480429441587776, 2.986914586270113, 2.986914586270113, 8.764235332167342, 8.764235332167342, 5.130800956228583, 5.130800956228583, 1.0638987724511006, 1.0638987724511006, 5.990887338390948, 5.990887338390948, 9.048209161469025, 9.048209161469025, 5.002792963229863, 5.002792963229863, 2.7341765508987574, 2.7341765508987574, 6.231008339032266, 6.231008339032266, 9.79603284197178, 9.79603284197178, 2.8902815751057482, 2.8902815751057482, 5.499057776385166, 5.499057776385166, 4.579859390362286, 4.579859390362286, 5.2814588569996825, 5.2814588569996825, 8.667585145393048, 8.667585145393048, 5.609797537524228, 5.609797537524228, 3.0385560129736304, 3.0385560129736304, 7.984534099060019, 7.984534099060019, 7.519688443012593, 7.519688443012593, 5.138997547371834, 5.138997547371834, 5.249845739782701, 5.249845739782701, 6.874689153289661, 6.874689153289661, 10.21524992195466, 10.21524992195466, 9.601717275563582, 9.601717275563582, 2.9906890435636972, 2.9906890435636972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2764117170336631, "mean_inference_ms": 2.0756998009735703, "mean_action_processing_ms": 0.09494483855539917, "mean_env_wait_ms": 0.5708278051096717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 229500, "timesteps_this_iter": 0, "agent_timesteps_total": 688500, "timers": {"sample_time_ms": 11690.189, "sample_throughput": 288.704, "load_time_ms": 0.499, "load_throughput": 6768888.251, "learn_time_ms": 1699.913, "learn_throughput": 1985.395, "update_time_ms": 20.642}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 14.916548919677734, "policy_loss": -0.010046171816065907, "vf_loss": 14.934359645843506, "vf_explained_var": -0.009422606229782105, "kl": 0.005456966663659279, "entropy": 0.7764297604560852, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.605655735731125, "policy_loss": 0.004214277281425894, "vf_loss": 2.6090598523616793, "vf_explained_var": 0.6021662443876267, "kl": 0.005816193850594969, "entropy": 0.7618945747613907, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 229500, "num_agent_steps_sampled": 688500, "num_steps_trained": 229500, "num_agent_steps_trained": 688500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9180, "training_iteration": 68, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-23-19", "timestamp": 1706106199, "time_this_iter_s": 16.200629949569702, "time_total_s": 819.0576832294464, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 819.0576832294464, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 51.857142857142854, "ram_util_percent": 77.39047619047619, "gpu_util_percent0": 0.1352380952380952, "vram_util_percent0": 0.23003859747023808}}
{"episode_reward_max": 13.343077851822017, "episode_reward_min": -15.307970786274614, "episode_reward_mean": 0.37597866428748894, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.31689522339796, "policy_agent_": -1.5268555814562}, "policy_reward_max": {"policy_adversary_": -4.232475453213356, "policy_agent_": 18.211850071451806}, "policy_reward_mean": {"policy_adversary_": -12.194809368400058, "policy_agent_": 6.2853940163437745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6434672485236298, -5.347970184227047, 0.9575428319904187, 5.047978709234686, -9.419687632072469, 2.9570736699377176, 1.1249631386354346, 1.7874916474519722, -0.39821855604805, 1.9244305796559567, 3.3816966695076025, 4.839668042093974, 2.50687247208088, -13.71316198876424, 0.47832569291260396, 2.8083546307067837, 4.011080188658257, -13.746413852119876, -6.310565259916636, -0.1245934763749639, 1.1754844594160658, 8.189110432921874, -2.1586135873928045, -2.479925877693585, 10.968264853762635, -9.688666430656326, 0.2478217963252765, 9.684350102427361, -6.031729240255858, -0.01767028864758735, 1.3149388143246146, 7.751528180252641, 10.593127477613406, 2.98495901745693, 5.393549017119345, 1.885288968826275, 6.779007550892514, 2.3457472518149514, 4.049757630035456, 2.739523136760086, 3.659053925118167, -15.307970786274614, 1.127615978171358, 2.788945398113419, -0.5330244533224161, -0.5367194515104156, 5.590915294632939, 7.8833822078138, -10.441898945903796, -6.057367945403672, -0.4622995897258152, -13.77387922114701, -1.0176503809720174, 1.384896448693197, -0.059031828993803104, -6.212117657934325, 1.5578342347922605, -5.256750654381857, 2.6314512983926233, 0.6853521219012285, -4.257349096468553, 8.803924477798871, -3.5022666608228334, 5.621033492777936, 1.0317164120380322, -3.919805755353115, -3.306985454019851, 0.32161637515960534, 7.04506464612536, 8.387216542699143, 5.3955887883833045, 3.835427038071843, -1.115332854717507, 5.491802738169067, -1.6876152415514936, 0.07625931783474749, 4.292415806008926, 6.290418776203936, -0.26492255169267853, 3.6770186997191288, -3.15702606476104, -2.8564490931962454, 4.2575867686324855, 0.06409205630141696, 13.038264555368205, -1.7601365769200332, 4.660170586489507, -0.5542088594878938, -1.795345668768642, 1.5418800758202929, -1.9527638756508976, -3.422125790899818, 6.420584572745944, 3.130559959204107, -6.8499491004698365, -6.521106885615452, 0.02726606792409117, -4.949811948609414, -1.8256307544909312, -1.1356699786667626, 2.2862864391769318, 4.493648259042087, -0.8818401582685851, 5.001462031038626, -10.29895512560071, 0.8942476688728457, -4.814416830093073, -4.989735717957257, -0.8651333210610046, -4.708042130102744, 8.83040455896478, 0.5700417398360738, -6.4076343913709115, -10.893681644155198, 9.6533628027111, 1.4983089264628613, 0.6122716197442062, -9.008053199587302, 9.858600429139884, -0.2859441365529545, -5.8171622207150016, 4.165787710991301, 13.343077851822017, -0.8772603842593533, -4.291728771902989, 2.8375156639747554, 1.037717536761615, -4.321129304276939, 0.010871867958641146, -1.4503426988077874, 7.035348623063408, -5.716657757514016, 11.053845193706069, -0.038381613388946634, -2.1199092093835428], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.93646230419172, -8.873470250175995, -8.88466314536323, -12.439056620182345, -19.76200652606302, -11.527122018837666, -9.480827582928976, -14.103692299256483, -8.05765594713164, -9.985377711420446, -28.31689522339796, -12.454188024826799, -9.499871363795721, -13.819677541753805, -13.52877809994312, -7.119019756212227, -10.771554624194515, -19.583126219080068, -14.129764282133676, -9.823951409825572, -17.147757819131634, -15.426391702231866, -7.631643166739492, -5.202163798134579, -19.29340815070602, -16.916195728380906, -15.176693628425618, -15.742887947998431, -15.50702582525243, -17.340691928030985, -6.011720615092829, -22.204311403522937, -20.838243718429894, -12.340810859768304, -9.591070327481884, -8.381243316269702, -18.089218341687417, -9.676730369762494, -12.15664699385871, -17.511434016468783, -13.121518787261506, -12.254259623362215, -9.377005058692665, -9.522264380413255, -5.354669248585862, -12.970421397215361, -13.29386792557022, -12.70632639528105, -18.603427891976217, -16.966160618155897, -9.379960018406306, -13.78978335425156, -7.606217845930363, -14.369383568584427, -8.83087798285224, -9.914341831676156, -7.662291618735192, -15.948628563446258, -8.020656839957901, -10.174150348838335, -7.67241263704017, -13.86104896593455, -6.691716068941596, -8.440287387715077, -14.98019998004967, -11.943249314971117, -10.64501812157769, -7.833349301314524, -17.699865748744056, -14.986004189326199, -12.737271268932679, -11.617589847841737, -7.569311649559031, -12.562120997839045, -8.990051222128866, -8.825900520648485, -16.726807406138004, -17.25282723661631, -10.290527856074327, -11.261963838191088, -10.333751995611559, -8.61564684271385, -13.649441793991539, -6.226662061450726, -23.385435587535415, -10.385313859230944, -10.64341993772545, -12.803472265123604, -8.743965027950969, -8.675162030446186, -10.499927756231406, -10.31105242300994, -12.686377181230753, -8.395915528915937, -18.12816548711954, -6.938900006231427, -7.195509475487267, -4.812142999715485, -8.930558073935092, -10.265417682316789, -16.27061932832944, -10.570408438853729, -9.746187479286936, -11.218018642459613, -13.393150667473435, -10.96126831151231, -7.13554738915849, -10.499465990778043, -11.814598026169215, -6.1846351733379565, -14.870258030139555, -12.607231313081108, -4.347894212009822, -10.151114365801558, -17.26174291473876, -14.391588445401746, -9.863531616472006, -16.557809831990937, -17.255746494493795, -8.831435708874995, -10.688399050996303, -8.851395838412172, -20.73954859979111, -4.232475453213356, -13.012647453427428, -7.937649813012988, -18.792287748616477, -13.361085134242353, -14.540767108950948, -12.865769338063448, -22.270629858438138, -12.143846769646391, -24.15955857869905, -11.807098107514868, -8.600428017778416], "policy_policy_agent__reward": [5.289964776357674, 5.289964776357674, 1.7627500329744756, 1.7627500329744756, 4.921102988676824, 4.921102988676824, 8.743517664708515, 8.743517664708515, 5.171159446995276, 5.171159446995276, 7.242097844387691, 7.242097844387691, 5.3028953607822045, 5.3028953607822045, 7.945591973354227, 7.945591973354227, 3.8297186955417932, 3.8297186955417932, 5.954904145538202, 5.954904145538202, 15.849295946452783, 15.849295946452783, 8.646928033460386, 8.646928033460386, 6.003371917938298, 6.003371917938298, 0.05325777649478597, 0.05325777649478597, 7.003551896427862, 7.003551896427862, 4.963687193459504, 4.963687193459504, 7.391317406426388, 7.391317406426388, 2.9183561834800984, 2.9183561834800984, 3.909599511108521, 3.909599511108521, 4.849678966725303, 4.849678966725303, 9.16162113927385, 9.16162113927385, 11.807751067576874, 11.807751067576874, 2.7365147896733446, 2.7365147896733446, 1.3611189602204967, 1.3611189602204967, 15.130836502234333, 15.130836502234333, 3.6137646488622877, 3.6137646488622877, 7.712257712375447, 7.712257712375447, 12.713619025212896, 12.713619025212896, 4.737648292498287, 4.737648292498287, 8.6615108196917, 8.6615108196917, 3.663329714708722, 3.663329714708722, 14.977919791887789, 14.977919791887789, 15.715685598021645, 15.715685598021645, 7.662884938612616, 7.662884938612616, 7.492309672300615, 7.492309672300615, 5.13326614254799, 5.13326614254799, 12.434112946289966, 12.434112946289966, 6.011238810788723, 6.011238810788723, 8.10320231194708, 8.10320231194708, 10.125478576614437, 10.125478576614437, 8.39028635618984, 8.39028635618984, -1.5268555814562, -1.5268555814562, 5.252310518432013, 5.252310518432013, 6.155604889263339, 6.155604889263339, 2.4108223976317236, 2.4108223976317236, 6.216850972852473, 6.216850972852473, 9.442391610101577, 9.442391610101577, 10.294854301547431, 10.294854301547431, 4.080764473036209, 4.080764473036209, 5.454396336376111, 5.454396336376111, 4.458830214340247, 4.458830214340247, 0.007952066552275358, 0.007952066552275358, 3.2942837324791725, 3.2942837324791725, 7.87714000863881, 7.87714000863881, 4.3859230769292195, 4.3859230769292195, 1.8511120868709163, 1.8511120868709163, 4.610062926763727, 4.610062926763727, 5.345938954532199, 5.345938954532199, 5.326054069175264, 5.326054069175264, 5.429751235369783, 5.429751235369783, 1.7075317702858084, 1.7075317702858084, 11.332486721866713, 11.332486721866713, 1.5947247040593813, 1.5947247040593813, 7.030660440246507, 7.030660440246507, 8.005958196043851, 8.005958196043851, 4.011721779809001, 4.011721779809001, 3.669016333778919, 3.669016333778919, 4.0774828382370645, 4.0774828382370645, 12.372465197434709, 12.372465197434709, 11.686610366012669, 11.686610366012669, 9.06643002865799, 9.06643002865799, 7.726508442956791, 7.726508442956791, 3.226989397420762, 3.226989397420762, 9.02696186800406, 9.02696186800406, 3.6512179902886857, 3.6512179902886857, 4.451079919241618, 4.451079919241618, 10.509611606073467, 10.509611606073467, 11.771623006410124, 11.771623006410124, 5.012802652190825, 5.012802652190825, 7.469491268955108, 7.469491268955108, 3.588362965425261, 3.588362965425261, 2.879598874758803, 2.879598874758803, 8.953514281312012, 8.953514281312012, 3.1453770588760714, 3.1453770588760714, 18.211850071451806, 18.211850071451806, 4.312588641155454, 4.312588641155454, 7.651795262107481, 7.651795262107481, 6.124631702817855, 6.124631702817855, 3.4743096795911628, 3.4743096795911628, 5.108521053133241, 5.108521053133241, 4.273581940290255, 4.273581940290255, 3.4444633160550624, 3.4444633160550624, 9.553480876988342, 9.553480876988342, 5.7632377440600235, 5.7632377440600235, 5.639108193324849, 5.639108193324849, 0.2088965603079922, 0.2088965603079922, 3.611387771705679, 3.611387771705679, -0.06883447444696524, -0.06883447444696524, 3.552463659722083, 3.552463659722083, 4.564873851825013, 4.564873851825013, 9.278452883753186, 9.278452883753186, 7.532028348947907, 7.532028348947907, 4.4321736605091795, 4.4321736605091795, 8.109740336749116, 8.109740336749116, 1.5470977709363636, 1.5470977709363636, 5.927757990192578, 5.927757990192578, 1.1605652795327082, 1.1605652795327082, 2.754865136410394, 2.754865136410394, 5.4747323525541045, 5.4747323525541045, 0.7382965216176053, 0.7382965216176053, 11.850331294552172, 11.850331294552172, 6.5886365264585915, 6.5886365264585915, -1.0298700896805457, -1.0298700896805457, -0.3712836391768189, -0.3712836391768189, 13.45755285872493, 13.45755285872493, 7.944948685932303, 7.944948685932303, 5.237901618108108, 5.237901618108108, 3.7748783162018196, 3.7748783162018196, 13.557173461816838, 13.557173461816838, 4.2727457861610185, 4.2727457861610185, 2.4356184151406493, 2.4356184151406493, 6.508591774701737, 6.508591774701737, 17.041313225806576, 17.041313225806576, 1.6776075344770014, 1.6776075344770014, 4.360459340762224, 4.360459340762224, 5.387582738493872, 5.387582738493872, 9.915002642689043, 9.915002642689043, 4.519977914982706, 4.519977914982706, 7.275819488454794, 7.275819488454794, 5.707713319627831, 5.707713319627831, 14.652989240750777, 14.652989240750777, 3.213594506066187, 3.213594506066187, 17.606701886202558, 17.606701886202558, 5.88435824706296, 5.88435824706296, 3.240259404197437, 3.240259404197437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27721920138900413, "mean_inference_ms": 2.0825375643859383, "mean_action_processing_ms": 0.09514461626983352, "mean_env_wait_ms": 0.5730749317049351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 232875, "timesteps_this_iter": 0, "agent_timesteps_total": 698625, "timers": {"sample_time_ms": 12076.78, "sample_throughput": 279.462, "load_time_ms": 0.501, "load_throughput": 6731549.765, "learn_time_ms": 1727.458, "learn_throughput": 1953.738, "update_time_ms": 20.944}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 14.19345121383667, "policy_loss": -0.01705133318901062, "vf_loss": 14.217951393127441, "vf_explained_var": -0.006699573993682861, "kl": 0.006839394947795041, "entropy": 0.7448800504207611, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.346127474308014, "policy_loss": -0.0002784993499517441, "vf_loss": 2.353813087940216, "vf_explained_var": 0.6029256820678711, "kl": 0.006438312208606789, "entropy": 0.7407763689756394, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232875, "num_agent_steps_sampled": 698625, "num_steps_trained": 232875, "num_agent_steps_trained": 698625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9315, "training_iteration": 69, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-23-34", "timestamp": 1706106214, "time_this_iter_s": 14.566506624221802, "time_total_s": 833.6241898536682, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E089D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 833.6241898536682, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 46.84444444444445, "ram_util_percent": 76.84444444444446, "gpu_util_percent0": 0.07555555555555556, "vram_util_percent0": 0.2172309027777778}}
{"episode_reward_max": 12.985538904714117, "episode_reward_min": -13.958164150444762, "episode_reward_mean": 0.07301978996757086, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.97897654017919, "policy_agent_": -1.1485439080684627}, "policy_reward_max": {"policy_adversary_": -4.492899468963238, "policy_agent_": 17.825897672845276}, "policy_reward_mean": {"policy_adversary_": -11.755560762350978, "policy_agent_": 5.914290276159274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8581358271563546, 5.041108217023123, 2.622367592516789, 1.4343062208666661, -4.8957526809083864, 1.6245996600016712, -1.592212385726274, -0.1917858374101945, 5.2059537567372285, 1.905454409813891, 3.657816346062363, 1.562297452968459, 0.24271613622783383, -4.30678938291319, -2.977237758857934, -2.522986559708027, 0.726346348736089, -10.532635337629012, 4.652836038394939, -2.8200842151928027, 0.17883776722205597, -5.8835492259492606, -2.2854090526816453, -3.731256918416051, -10.629195012564953, -2.438638194534148, -7.81582295500286, 2.639438657861241, -7.145292793702802, -0.4928094550672404, 3.3052474672135035, -1.1522147527474313, 0.7522316118641581, 2.5808443266029326, 1.799737210556461, 4.780826835958141, -4.304197675052258, 7.264045071719746, 2.0011659225764165, 3.485258537746681, 2.577466594413325, -8.008141195511843, 5.842918087528771, 1.229539083867586, 8.59523025851536, 2.35849273399476, 7.16936923225045, -11.435188659320684, -1.2419666361189878, 4.499817281291502, 2.689614620554233, 0.8827645285571253, 1.6673606302105188, -1.6485980790424932, -0.352848955752733, 8.0883892034946, 0.34165868473356636, 3.334144380829774, 1.1234417488230513, -7.391970831936343, -0.16585280657131368, 0.4301934577405394, 2.4139840015184957, 2.7515527705325606, -3.825697682027911, 1.9992584962922226, 1.537173986944549, -4.2698359743045575, 1.7474422409906885, -3.3012228682509095, 6.3648958752353515, 2.5051990440013467, 9.910108979413176, -1.283565866724648, -5.253984083752591, 6.160428480007658, 0.7899871087461621, -2.8598312154679855, -3.7656404440123894, 1.8875325769910627, -0.9378636181618519, 8.565471073426982, -4.355722620163205, 7.310182095673765, 0.2715202633728823, -13.958164150444762, -1.8644032781854867, -2.7120561552108096, -8.627354232618575, -0.323825358535891, 10.407452316645267, 2.7547527830456304, -11.635255230656368, 9.145911470332056, 0.8853313536288286, -5.710918840546337, 0.7966123909560578, 4.810961453421309, -1.679514452560694, -9.573871195714638, 7.461200566304176, 4.15278421346428, 3.940481877042264, 3.530746776320912, -4.46324613607059, -7.441353267227563, -4.85511384406182, -0.9762198426918128, -11.552177220763022, -2.2377798477670945, 1.760414609451184, 5.217379265470487, -1.5779401399804405, -2.2185626828205134, -6.959501327247793, 0.44825190087294997, 3.314797983087566, -2.0930390257563913, 12.985538904714117, -10.379305397069883, -0.4272376608116341, -0.3786049007869373, 6.536396893158476, -6.984276083755175, 6.577368902463567, 1.0051266074764051, 5.813672731757729, -8.592768730025378, -8.841457722732851, 8.322065897649539, 3.258432361743628, 11.176419254942985, 2.168789560480865, -1.7009758529013248, 2.6007969435416793], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.485908784738173, -11.114121183705482, -14.912410871868902, -8.999245546229718, -25.565666391496176, -8.650383327766793, -11.595449295620464, -7.934839644891605, -11.222255000902488, -12.814364686448197, -12.162128387939674, -11.151099682641316, -12.573304448693586, -7.903461660525867, -5.152050617151431, -10.35181601875196, -15.336947950326751, -11.518833060154327, -12.485957370643266, -7.261548476148904, -7.379412829116099, -17.107386021642657, -9.672032540567217, -15.50043382544529, -14.854274539876098, -14.912446325757136, -13.879065804162705, -6.275534343855107, -15.105348282591512, -5.173543266774488, -14.205220543766298, -10.150694572627936, -13.455943412416495, -8.02719073246636, -11.687955421496332, -16.57655436744763, -11.446761415689114, -17.17411968523752, -10.204223472923452, -7.725602000442653, -20.526616870944583, -9.608712585075338, -20.0114676424397, -7.214636753746577, -13.208127402490641, -11.381541322263999, -20.352965146520308, -9.13810084318375, -9.704095942702567, -15.315195757083929, -14.246530170968363, -6.350132088374847, -7.499313969810147, -6.958351702392772, -7.186713144652289, -17.202294317373177, -11.052071846769783, -12.341612036888518, -15.771325213598725, -15.85974718734554, -9.136308937488382, -15.87111477872975, -10.496358040493849, -9.723584249489548, -10.72336253215033, -6.188125797644878, -15.625715881292129, -7.755836067008186, -9.811674803743811, -9.301473754301457, -14.107414387674384, -10.57383010797924, -19.728817825389445, -14.586551134575402, -8.260666851129058, -15.367652790929906, -7.245628915840848, -7.810553904804918, -8.911000372381197, -9.393179498652886, -11.332046221540468, -13.545135485054676, -17.058465942510583, -20.195659322951492, -5.239881569003992, -13.461858892982221, -9.445906042031229, -10.074479164762266, -7.61657819596727, -11.258085952996622, -17.471902021445324, -9.495834808951107, -10.756763660013368, -19.95457894430491, -26.97897654017919, -7.1501649799728115, -7.109689464356288, -13.210736698612102, -9.28625494275009, -17.35694675337038, -11.49186287077289, -9.896447025646749, -10.70051765243832, -16.662481812137013, -4.78522616859542, -9.700440010974043, -11.11825112304977, -4.492899468963238, -10.093429823389389, -7.015732827513335, -7.031280706704239, -11.722494046268066, -7.854295705013368, -17.335484557020745, -8.510877686366731, -6.53141650056303, -9.760756887140975, -9.258424797745342, -22.666256440976422, -11.923771203233857, -7.016219616025252, -11.392256817469251, -10.733097075939993, -17.333417981759204, -13.302077305258448, -10.717908206151924, -12.286955369311743, -12.41447681766398, -14.804572650663033, -14.486272857238626, -9.045923169011834, -16.60677148280749, -9.481435851056313, -8.415661195497265, -9.157425215986152], "policy_policy_agent__reward": [7.172022305947263, 7.172022305947263, 8.077614700364302, 8.077614700364302, 8.767389232192848, 8.767389232192848, 5.216775883548191, 5.216775883548191, 10.334956855293889, 10.334956855293889, 5.137491493884235, 5.137491493884235, 5.001618454947093, 5.001618454947093, 3.8715269037407047, 3.8715269037407047, 8.214104378819862, 8.214104378819862, 7.359909548131043, 7.359909548131043, 7.909972367001015, 7.909972367001015, 6.356698567804887, 6.356698567804887, 6.408010292460712, 6.408010292460712, 1.7983361388063388, 1.7983361388063388, 1.0874064291467487, 1.0874064291467487, 3.914414729521968, 3.914414729521968, 8.03164714953142, 8.03164714953142, 0.49309886126265495, 0.49309886126265495, 8.569396704519106, 8.569396704519106, 2.220732130478051, 2.220732130478051, 3.7791252981690757, 3.7791252981690757, 5.611918397846698, 5.611918397846698, 3.693311743942787, 3.693311743942787, 5.884588453514615, 5.884588453514615, 2.112539763655575, 2.112539763655575, 6.236904065611497, 6.236904065611497, 3.0316214245799253, 3.0316214245799253, 4.457486500858175, 4.457486500858175, 3.9800277444443517, 3.9800277444443517, 2.340366905853624, 2.340366905853624, 8.755234005489898, 8.755234005489898, 4.499239909940253, 4.499239909940253, 7.104087512140329, 7.104087512140329, 5.3040175295346454, 5.3040175295346454, 6.743846316026398, 6.743846316026398, 10.678690601702888, 10.678690601702888, 3.5712818703184284, 3.5712818703184284, 12.219082378478637, 12.219082378478637, 6.102694697749935, 6.102694697749935, 5.605430269094669, 5.605430269094669, 11.552041732678951, 11.552041732678951, 0.8002856947817459, 0.8002856947817459, 12.92719286498424, 12.92719286498424, 4.222087918807082, 4.222087918807082, 10.901678830502998, 10.901678830502998, 6.870017028129379, 6.870017028129379, 13.76116718938538, 13.76116718938538, -1.1485439080684627, -1.1485439080684627, 4.23106465329179, 4.23106465329179, 9.907506519187715, 9.907506519187715, 8.468072395761299, 8.468072395761299, 3.6164483084659866, 3.6164483084659866, 4.583337300010334, 4.583337300010334, 2.654876811675139, 2.654876811675139, 3.416932094449778, 3.416932094449778, 12.645341760433887, 12.645341760433887, 5.696865265751674, 5.696865265751674, 7.837878208859144, 7.837878208859144, 8.44738348121089, 8.44738348121089, 4.233888177704599, 4.233888177704599, 4.485228065458535, 4.485228065458535, 8.150654118235142, 8.150654118235142, 6.455171021006171, 6.455171021006171, 6.237568510011052, 6.237568510011052, 3.4488324250612092, 3.4488324250612092, 4.093692146968551, 4.093692146968551, 8.581444934118341, 8.581444934118341, 1.7430000463518134, 1.7430000463518134, 5.7795585223672505, 5.7795585223672505, 3.0001254430252726, 3.0001254430252726, 10.236155131454865, 10.236155131454865, 6.539514575990296, 6.539514575990296, 14.819463402401308, 14.819463402401308, 6.651492633925377, 6.651492633925377, 1.503341383688236, 1.503341383688236, 10.764040635468781, 10.764040635468781, 4.017808012293504, 4.017808012293504, 2.4753613446684657, 2.4753613446684657, 2.5726799641844034, 2.5726799641844034, 5.640356037821973, 5.640356037821973, 5.197091301689309, 5.197091301689309, 11.05530327924083, 11.05530327924083, 6.351371661173687, 6.351371661173687, 13.75292070931263, 13.75292070931263, 2.7557009161884376, 2.7557009161884376, -0.24815262873127386, -0.24815262873127386, 3.7907513819228713, 3.7907513819228713, 3.6812115047757277, 3.6812115047757277, -0.5053880183256532, -0.5053880183256532, 5.467130297230365, 5.467130297230365, 13.939677169045295, 13.939677169045295, 6.12529379599837, 6.12529379599837, -0.4392457853214993, -0.4392457853214993, 14.550245207318483, 14.550245207318483, 13.932153946904004, 13.932153946904004, 0.7196230697132358, 0.7196230697132358, 3.9531509276561723, 3.9531509276561723, 9.010849076016706, 9.010849076016706, 3.803370245094699, 3.803370245094699, 3.891537778827873, 3.891537778827873, 9.476531718538533, 9.476531718538533, 7.024615619555515, 7.024615619555515, 7.320499764740292, 7.320499764740292, 10.09661429422896, 10.09661429422896, 0.16099001626241405, 0.16099001626241405, 1.1295433718732415, 1.1295433718732415, 3.131568639493975, 3.131568639493975, 1.7583398131357126, 1.7583398131357126, -0.7293736986868188, -0.7293736986868188, 2.3889764898731203, 2.3889764898731203, 4.3958476580777095, 4.3958476580777095, 8.469936655869274, 8.469936655869274, 3.138177782516464, 3.138177782516464, 7.558460937100116, 7.558460937100116, 0.7756881795594684, 0.7756881795594684, 3.4898342007179903, 3.4898342007179903, 6.5377774351142675, 6.5377774351142675, 3.5826928859944758, 3.5826928859944758, 17.825897672845276, 17.825897672845276, 0.7722329030819854, 0.7722329030819854, 3.2944909776068076, 3.2944909776068076, 5.506825958341156, 5.506825958341156, 8.634746984549237, 8.634746984549237, 5.174570949002014, 5.174570949002014, 9.939723103861006, 9.939723103861006, 5.861517406814164, 5.861517406814164, 9.050314050534736, 9.050314050534736, 1.910854043819297, 1.910854043819297, 2.9815574639650935, 2.9815574639650935, 11.40416937744408, 11.40416937744408, 6.152177765377729, 6.152177765377729, 13.891595368875238, 13.891595368875238, 5.82511270576859, 5.82511270576859, 3.357342671297971, 3.357342671297971, 5.879111079763916, 5.879111079763916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775050113179334, "mean_inference_ms": 2.083933008953885, "mean_action_processing_ms": 0.0952652894436254, "mean_env_wait_ms": 0.5735821315215809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 236250, "timesteps_this_iter": 0, "agent_timesteps_total": 708750, "timers": {"sample_time_ms": 12254.734, "sample_throughput": 275.404, "load_time_ms": 0.501, "load_throughput": 6731549.765, "learn_time_ms": 1743.029, "learn_throughput": 1936.284, "update_time_ms": 21.043}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 13.518618202209472, "policy_loss": -0.005635990286828018, "vf_loss": 13.532000732421874, "vf_explained_var": -0.014930939674377442, "kl": 0.006025350341959823, "entropy": 0.774637085199356, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.1589544236660005, "policy_loss": 0.0030238652601838113, "vf_loss": 2.1632413148880003, "vf_explained_var": 0.5868913948535919, "kl": 0.007274074112498125, "entropy": 0.731146365404129, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236250, "num_agent_steps_sampled": 708750, "num_steps_trained": 236250, "num_agent_steps_trained": 708750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9450, "training_iteration": 70, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-23-47", "timestamp": 1706106227, "time_this_iter_s": 12.623119592666626, "time_total_s": 846.2473094463348, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4B87430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 846.2473094463348, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 33.12352941176471, "ram_util_percent": 76.34117647058824, "gpu_util_percent0": 0.06588235294117648, "vram_util_percent0": 0.21800321691176472}}
{"episode_reward_max": 18.994796128566207, "episode_reward_min": -9.630866536027032, "episode_reward_mean": 1.358283869616755, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.430456368239057, "policy_agent_": -1.6934435101289111}, "policy_reward_max": {"policy_adversary_": -3.8268990037440904, "policy_agent_": 23.212626248402632}, "policy_reward_mean": {"policy_adversary_": -11.615669925167868, "policy_agent_": 6.486976897392312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.152418590092821, -5.906880489304604, 2.3895129481556228, 4.357836876892145, 2.507922468532728, -7.03257520324002, 4.1792453392585385, 3.3298510410161066, 7.862206027215008, -0.7682045396146591, 0.20845292072515192, 9.33883021251105, 0.489381475166491, -1.4084880494173873, -9.611298653456611, 1.3739404949876597, 6.388840804236173, 4.910669051287214, -0.3852456560848774, -0.30300364460386064, -3.0971699258915084, 6.561371317162066, 5.445415056260073, -0.4767965417535067, -0.6699767553254072, 2.6297806920221074, 4.980766836015084, -9.630866536027032, -3.8017571802114736, 0.5177242913380768, 5.264290499168689, 1.4903388076579005, 6.6730532708607955, -0.4083137246660704, -7.905484547591222, 2.7267629221136045, 4.164931135262745, -2.5660065755976205, -2.1216358647102935, 15.519416381190576, 5.056268821264754, -2.4841233420782176, -1.1948367848390804, 0.852348130728465, 1.3440567058592907, 0.1818861795368339, -2.6863054124744354, 3.968057900884569, -1.5435634181823812, 15.222785614464819, 1.2172193339797812, 1.813307237368339, 6.700120169087802, 6.039362843566397, -3.315000863779293, -3.6865654983406184, 5.015911349718912, 4.145611759421772, 1.435189662740064, 5.799053002791959, 2.7155785706342717, 6.421614486616599, 8.543779792682987, 7.531296472296821, 0.6271921238184877, 0.5576985040587399, -8.580691634967785, 5.101463635310905, 4.608185320734313, 7.3691041150937755, 0.2558113262866064, 2.421656016957765, -0.6994839302695088, -0.2663406351863498, 0.49895781503615877, -3.9092658046424944, -4.064486153858918, 3.8961466485169525, -2.1769753214690826, 0.4825323317044383, 3.5610806434211506, -0.10158659137931514, 0.9584808570933412, 8.68854701604267, 4.31651793516815, 4.9333309473759, 2.7456153315207463, 5.717001606544679, -0.37945481581488205, 2.6572799117935686, -9.36584532529861, -8.270214047511065, 3.9875636705801636, 4.20748534957, -2.7111783720625233, 5.312704635860911, -1.4518253855341332, 4.084230946285876, 2.7959623290300772, 0.5899430662768578, 5.150464881469507, -3.047046137253556, 0.13448467982204387, 2.0582656603965725, -2.270736652011063, 1.8516881775306007, 0.6240601891718488, -4.61740179292781, 0.6816101065539559, 3.62996190721637, 1.778527852350336, 0.27038026250933933, -2.4235159681297764, -8.094202095036756, -3.4609512406108447, 3.962689810970444, -7.38545271162117, -4.275365011081714, -0.9063596197637769, 2.5139398951107697, 1.2788334347940928, -4.923252697407368, -4.878238994282686, 5.46644720639268, 5.5541180997595285, 0.5196214786498077, -1.0499261417262717, 1.6684001148107837, 2.0915765939533135, 7.18797014966832, 0.7231522774794245, -3.5300462039077836, 10.692795805809503, 18.994796128566207, 2.842417779552463], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.962884096815394, -11.199618233231407, -8.302948360924923, -15.015291411692006, -15.138917458237948, -10.16643578537853, -13.821983162931792, -14.405418168607147, -17.429447822431193, -12.456775252694806, -12.16566055179028, -14.062458824367726, -6.629690545117496, -8.35230534247163, -9.751034977107262, -9.026834306272978, -13.85748518041647, -8.397998369102906, -4.939724618470722, -4.406431383735911, -14.17372337798687, -13.470549016723565, -14.161745090769996, -5.800552003251102, -17.28581579756451, -8.104543475507972, -13.991994218930559, -16.345765712009165, -12.192179182927527, -5.2720082772474735, -12.615767222042747, -9.870217718613304, -11.121115794520426, -11.840506435439782, -7.071509911717871, -7.831201682589923, -13.570111909308316, -13.225045487814949, -11.962185625353484, -18.53441147574401, -9.789558410239795, -8.861411518953359, -6.737114347415396, -13.466156110914044, -6.211223647284369, -7.581605607492466, -13.261929609428947, -8.838388143411638, -8.90827294454233, -22.8882619207768, -12.34336351647604, -9.245879738722454, -9.479545825353004, -13.887130552482873, -7.292557168379966, -13.813889163381987, -11.119385482166924, -13.503728535808202, -9.855795485572562, -14.764775568945977, -9.6297832946114, -11.833078080946269, -14.290551826503576, -10.82136063597431, -16.635338589731777, -7.310517003865764, -5.193804614709961, -11.093303160520826, -11.90036572798779, -14.970860888717953, -5.403225588169974, -15.922469308951973, -20.7822232015675, -21.96225458502652, -8.476519745042015, -7.9249995681835985, -13.754609728820267, -10.714817442536557, -10.396969783276509, -7.416017149313937, -12.713232276166806, -9.245723021019385, -11.76739183790095, -15.128582949895263, -17.64913494712575, -9.639732056770377, -8.536701164501833, -11.573763067608294, -6.035253850630509, -15.610955981455435, -14.408407877360881, -14.75733874334846, -10.948855379140209, -11.529578794818228, -8.231226205346797, -9.49278940266133, -11.716649192529289, -14.912065110525699, -10.567064396788043, -9.317455147498322, -9.754848750784783, -7.682314793467389, -5.330247057711417, -8.612648637382264, -15.991092534964617, -11.22194141275224, -11.195013562141922, -8.072711764734942, -16.839599343665434, -11.028666772758417, -13.214279367940703, -3.9282675909289493, -7.638322478441191, -10.281133639657332, -14.579693450961104, -20.009023696602515, -14.965941628436386, -9.705855882714411, -3.8268990037440904, -14.168134790204402, -10.837053591355314, -16.447859008630214, -9.4560291944436, -13.615312421790044, -10.530018728632465, -23.99552096770826, -10.213500921625668, -6.512467034468946, -6.422682771522702, -14.84949018222753, -9.188335538703459, -10.575243959236637, -16.721374703844347, -27.430456368239057, -10.278220452077825], "policy_policy_agent__reward": [6.405232753361288, 6.405232753361288, 2.646368871963401, 2.646368871963401, 5.346230654540271, 5.346230654540271, 9.686564144292072, 9.686564144292072, 8.823419963385339, 8.823419963385339, 1.566930291069258, 1.566930291069258, 9.000614251095165, 9.000614251095165, 8.867634604811624, 8.867634604811624, 12.645826924823105, 12.645826924823105, 5.844285356540076, 5.844285356540076, 6.187056736257715, 6.187056736257715, 11.700644518439386, 11.700644518439386, 3.5595360101419935, 3.5595360101419935, 3.4719086465271203, 3.4719086465271203, 0.06986816182532982, 0.06986816182532982, 5.200387400630319, 5.200387400630319, 10.12316299232632, 10.12316299232632, 6.6543337101950595, 6.6543337101950595, 2.2772394811929213, 2.2772394811929213, 2.051713869566025, 2.051713869566025, 5.538276726047684, 5.538276726047684, 10.015960166942818, 10.015960166942818, 9.803580073515032, 9.803580073515032, 2.6618777307487984, 2.6618777307487984, 8.307919521119555, 8.307919521119555, 5.367162083765039, 5.367162083765039, 9.486380527472818, 9.486380527472818, 3.3574495879910704, 3.3574495879910704, 4.195211001358024, 4.195211001358024, 2.8948662842927746, 2.8948662842927746, 8.940028860605716, 8.940028860605716, 5.680278263135601, 5.680278263135601, 8.897084532690615, 8.897084532690615, 5.716096355386858, 5.716096355386858, -0.41698731793667526, -0.41698731793667526, 5.278982302351762, 5.278982302351762, 8.86752152228553, 8.86752152228553, 5.329519456108665, 5.329519456108665, 4.920274880321597, 4.920274880321597, 17.02691392846729, 17.02691392846729, 7.422913615752274, 7.422913615752274, 3.18864408843757, 3.18864408843757, 2.771138781288158, 2.771138781288158, 7.159252120821254, 7.159252120821254, 3.77764017657183, 3.77764017657183, 3.88174589351465, 3.88174589351465, 5.287812098477255, 5.287812098477255, 6.403223022148103, 6.403223022148103, 3.682354763179976, 3.682354763179976, 19.055523767620816, 19.055523767620816, 6.78029142522791, 6.78029142522791, 5.529593488045397, 5.529593488045397, 8.089832997220403, 8.089832997220403, 9.963246698024633, 9.963246698024633, 1.9887781523003378, 1.9887781523003378, 5.0636618325206815, 5.0636618325206815, 8.067648415942918, 8.067648415942918, 8.824670147614986, 8.824670147614986, 5.645492574156312, 5.645492574156312, 10.281914285868973, 10.281914285868973, 6.1726809326228365, 6.1726809326228365, 9.12734628378143, 9.12734628378143, 11.41716580959328, 11.41716580959328, 9.176328554135567, 9.176328554135567, 8.631265356775131, 8.631265356775131, 3.934107753962251, 3.934107753962251, -1.6934435101289111, -1.6934435101289111, 8.097383397915864, 8.097383397915864, 8.254275524361054, 8.254275524361054, 11.169982501905865, 11.169982501905865, 2.829518457228289, 2.829518457228289, 9.172062662954868, 9.172062662954868, 10.041369635648998, 10.041369635648998, 10.847956974920088, 10.847956974920088, 4.487738780039089, 4.487738780039089, 2.007866881770551, 2.007866881770551, 4.845061787480676, 4.845061787480676, 7.305482045526755, 7.305482045526755, 4.109997230903712, 4.109997230903712, 3.9492747405091886, 3.9492747405091886, 8.137156459793978, 8.137156459793978, 4.572068214820036, 4.572068214820036, 6.362936347497145, 6.362936347497145, 11.908564982968965, 11.908564982968965, 10.98282644114695, 10.98282644114695, 7.28653150207314, 7.28653150207314, 5.641158248011291, 5.641158248011291, 8.645382337076489, 8.645382337076489, 2.8278995174078108, 2.8278995174078108, 9.134117946624503, 9.134117946624503, 2.521281276031136, 2.521281276031136, 3.2435623479186986, 3.2435623479186986, 7.468209524860187, 7.468209524860187, 7.868532072194112, 7.868532072194112, 2.7600239166421354, 2.7600239166421354, 7.402747019261118, 7.402747019261118, 5.132411903497576, 5.132411903497576, 9.498148028405787, 9.498148028405787, 6.68151336290906, 6.68151336290906, 4.953699106887589, 4.953699106887589, 7.4526568161271465, 7.4526568161271465, 2.3176343281069194, 2.3176343281069194, 2.73236586876673, 2.73236586876673, 5.335457148889418, 5.335457148889418, 6.860177941476777, 6.860177941476777, 6.536814795141423, 6.536814795141423, 5.909536875656887, 5.909536875656887, 1.727654985903567, 1.727654985903567, 8.760604725109697, 8.760604725109697, 7.329314339987393, 7.329314339987393, 7.496403610145519, 7.496403610145519, 2.099323926719145, 2.099323926719145, 2.607403255155708, 2.607403255155708, 1.0934657723102879, 1.0934657723102879, 5.5593711051751304, 5.5593711051751304, 11.98585675378648, 11.98585675378648, 3.7902444584076083, 3.7902444584076083, 2.7152454358163505, 2.7152454358163505, 1.4602696919901568, 1.4602696919901568, 8.341037342657586, 8.341037342657586, 6.057943513074701, 6.057943513074701, 5.762303155611423, 5.762303155611423, 2.2888951000804574, 2.2888951000804574, 9.54087981409136, 9.54087981409136, 8.042068414195997, 8.042068414195997, 12.257571223179033, 12.257571223179033, 4.581787389949699, 4.581787389949699, 4.090433574639864, 4.090433574639864, 4.257129682738008, 4.257129682738008, 11.018730165947924, 11.018730165947924, 4.955743908091442, 4.955743908091442, 3.522598877664428, 3.522598877664428, 13.707085254826925, 13.707085254826925, 23.212626248402632, 23.212626248402632, 6.56031911581514, 6.56031911581514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2776652934454392, "mean_inference_ms": 2.0868765354391297, "mean_action_processing_ms": 0.09538456828069462, "mean_env_wait_ms": 0.5744145378718284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 239625, "timesteps_this_iter": 0, "agent_timesteps_total": 718875, "timers": {"sample_time_ms": 12472.78, "sample_throughput": 270.589, "load_time_ms": 0.402, "load_throughput": 8401552.614, "learn_time_ms": 1756.271, "learn_throughput": 1921.685, "update_time_ms": 21.442}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 12.037272071838379, "policy_loss": -0.013814155850559473, "vf_loss": 12.058691501617432, "vf_explained_var": 0.0016313612461090088, "kl": 0.0063737637518217925, "entropy": 0.7604981958866119, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.8187913358211518, "policy_loss": 0.01655483916401863, "vf_loss": 1.8094498217105865, "vf_explained_var": 0.6498938471078872, "kl": 0.005164280692037612, "entropy": 0.7213828712701797, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 239625, "num_agent_steps_sampled": 718875, "num_steps_trained": 239625, "num_agent_steps_trained": 718875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9585, "training_iteration": 71, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-24-00", "timestamp": 1706106240, "time_this_iter_s": 13.098714113235474, "time_total_s": 859.3460235595703, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 859.3460235595703, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 37.98823529411765, "ram_util_percent": 74.88823529411764, "gpu_util_percent0": 0.14058823529411765, "vram_util_percent0": 0.21788832720588236}}
{"episode_reward_max": 17.218384792206727, "episode_reward_min": -16.306038939306546, "episode_reward_mean": 0.9707724090757488, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.137892000530396, "policy_agent_": -4.5238355480460966}, "policy_reward_max": {"policy_adversary_": -3.8181178607008404, "policy_agent_": 21.678138396368556}, "policy_reward_mean": {"policy_adversary_": -12.207222259809765, "policy_agent_": 6.588997334442757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.8022658601121275, 0.04685273639468465, -0.9290384016841453, -0.35956575245155253, 9.235382162796157, 7.3214684523252, 4.684101931883818, 2.613697778723765, 5.409888876276839, 1.6592509959275996, -5.6996656338041864, 8.935720646022727, -1.063589846241499, 7.056653453790272, 0.09360052165475896, 1.8862820489354275, 1.0340127978512228, 0.36803222414743375, 7.1574552820591375, 7.406918824674767, 6.265232666891497, 4.260002189210237, -1.6677785018829798, -16.306038939306546, -0.3881638540956945, -0.5370704250989833, 4.245148753654828, 6.392077057853656, 7.790865709630096, 3.656912789782209, 6.191322687068792, 0.27706211765582633, -2.929418595867325, 2.180184996477699, -3.080657278590006, -1.719815796778008, -6.835275503799873, -3.6714324840696104, -0.6321708573670013, -9.183910936443894, -6.681704830326811, -7.453297482715014, -2.220204185841745, 7.491446651974094, 10.005837771306785, -0.4668199992118621, 1.689643406526196, 10.455159211324968, -0.0437503419242655, 2.2570826965982187, 5.623732068159426, -0.248613446285034, 4.004862784475594, -0.47676016546126043, 4.488474262350061, 1.7723126756766518, -4.004905832494368, -2.114774065215574, -3.3891641543267395, 3.310649647410866, 2.747761723700857, 1.2063306503972586, 6.576829479423196, 3.9418244666509183, -5.273139098455544, 5.387383591858628, -1.281419957580189, -0.6197330469111187, 2.316594950666145, -2.630371623365562, -5.353016226047816, 5.349655452414747, -1.0491393372754625, -4.901740060409314, 7.062095116469439, 0.17448395879360312, 4.458195463351501, -10.14688291920205, -1.983768435060387, -2.362366862790918, 3.583407342380993, -6.404546698553774, 3.8907447353837306, -4.027658220548737, 8.246690193953718, -5.594442386955287, -0.5651450226245107, -1.5635593942311088, -1.8231445661931, 9.24349920094577, 12.517397697339868, -1.0003517597229437, -4.285415908508363, -0.22385814821794325, -14.005477699648166, 2.13037966374784, -1.7237375271129158, 7.393371695781329, 2.5381014892930693, 0.026505660533403197, -1.606326529290027, 0.9841572848496174, 1.4315527783759738, 9.7139239027252, 1.5377791957027027, 5.689669460967274, -1.3263096340102418, 0.00201757489241447, 1.7858105380301792, 4.258423128041645, 3.8969821062290895, -6.908565287580813, 17.218384792206727, -0.42837459926623833, 4.289703526616171, 3.410828569541869, -4.004261709022343, 3.40897380196965, 5.770235252095674, -4.765978426977874, 1.0801176972890822, 1.7060098067977485, 2.9990713125179527, -0.7925783540221116, 1.1582105419836048, -2.689483211158782, 5.923723068822165, 10.074919592784916, -3.3088609463165817, -2.3437900583666926, -7.1345742738514755, -11.784051068594126, 2.6102103797695753, 4.3922891773305, 4.470622494377457], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.038066870363828, -5.771913321761191, -7.368108695740168, -13.77262079183159, -18.673849734178756, -18.753124542294984, -12.773180319809208, -10.72770506202404, -10.0245840326856, -10.26428592691266, -13.431828745458608, -14.143738925884005, -8.179311511373134, -11.527573427647258, -14.448612960942405, -15.125547955715799, -9.521802470388034, -20.66017645169585, -12.21320061404165, -14.810177862718781, -10.170608215420197, -9.967546038432294, -7.180294210044884, -7.258367843214368, -11.959906175009966, -11.649744708722118, -9.355966697012379, -14.307170707479516, -14.288968572967473, -11.612084338078727, -14.942472668555379, -8.669324678345404, -16.668125520405844, -9.979098707576863, -8.143622882600194, -11.89047726715203, -14.617591412841312, -10.226068358358186, -6.477867186405392, -19.077961373284367, -9.19579962279966, -22.387353820978365, -11.408516722385531, -17.505760811529175, -18.29802991539938, -5.963520577923147, -13.150453774505097, -14.116645675987105, -14.6896453989131, -10.658035254948869, -14.788473706827256, -16.084919524683944, -8.673884184678284, -8.424206366586056, -11.392871312806523, -23.613799258648026, -11.883444360291625, -9.331108140126435, -14.613806840819315, -12.017029373334326, -8.791305547491984, -7.873764260895541, -10.5343968126954, -17.36380229845428, -11.914824696973637, -12.187874784762116, -8.29680532841769, -7.679607908402012, -11.085628227838965, -5.384865432622476, -10.092234608766656, -17.86133726672614, -9.759198563896371, -9.229890379801217, -10.447341209736283, -8.566920594072942, -8.038630059007877, -12.135263321764278, -11.98362210729764, -17.68550373818526, -7.614798224861954, -6.1570998368272, -17.098723696756846, -13.529759900222148, -17.308098608206706, -7.651660826660276, -10.94966395360999, -13.581785259688242, -7.956309063899527, -13.905327862366626, -22.26013419199379, -3.8181178607008404, -9.404425193549393, -14.394151452523982, -15.330608247879999, -12.4393113376679, -7.564832180928078, -14.038212501374693, -12.537999799648754, -8.165568082222402, -9.95021798859733, -13.792534435784386, -8.906317483806943, -13.099319075646056, -5.358817098072966, -17.248985233505287, -16.708736017006277, -12.414003321805506, -13.566686654177158, -16.313171100390694, -16.600980359900767, -19.196804531123902, -26.137892000530396, -9.119164170151839, -19.73174674196696, -9.133740086712447, -13.769609170138374, -11.02378992890583, -13.553977293335157, -5.442910553936863, -11.884235361833902, -18.437054633702427, -7.305103217123299, -8.179207190336083, -7.315186212071116, -8.591277149736118, -11.851846154989335, -15.003791274671334, -15.026368653213298, -6.790338182878423, -20.58866330370889, -9.534834901316826, -10.940000301941499, -13.031853530385364, -9.936454101971478], "policy_policy_agent__reward": [2.117900505125849, 2.117900505125849, 2.9093830290779374, 2.9093830290779374, 3.2195351470280116, 3.2195351470280116, 6.7065275196900185, 6.7065275196900185, 13.954615948487458, 13.954615948487458, 13.037296497310088, 13.037296497310088, 8.728641125846513, 8.728641125846513, 6.670701420373904, 6.670701420373904, 7.717236454481217, 7.717236454481217, 5.96176846142013, 5.96176846142013, 3.8660815558272112, 3.8660815558272112, 11.539729785953364, 11.539729785953364, 3.557860832565816, 3.557860832565816, 9.292113440718763, 9.292113440718763, 7.271106741298583, 7.271106741298583, 8.505915002325615, 8.505915002325615, 5.27790763411963, 5.27790763411963, 10.514104337921642, 10.514104337921642, 9.685327948050398, 9.685327948050398, 11.108548343696775, 11.108548343696775, 8.217920441155846, 8.217920441155846, 7.113774113821265, 7.113774113821265, 2.756257854080952, 2.756257854080952, -4.5238355480460966, -4.5238355480460966, 5.785871160457137, 5.785871160457137, 5.556337141811567, 5.556337141811567, 6.800557725333601, 6.800557725333601, 10.349623882666586, 10.349623882666586, 11.039917141298783, 11.039917141298783, 7.63449856393047, 7.63449856393047, 10.566897677812088, 10.566897677812088, 4.473193398000615, 4.473193398000615, 6.869353462269259, 6.869353462269259, 6.079641852027282, 6.079641852027282, 2.5314828020050952, 2.5314828020050952, 5.08533073518701, 5.08533073518701, 3.89115795452072, 3.89115795452072, 3.2773179371442884, 3.2773179371442884, 2.922848164519195, 2.922848164519195, 4.947025218420232, 4.947025218420232, 1.257047396236422, 1.257047396236422, 7.467028169131674, 7.467028169131674, 4.594156268271897, 4.594156268271897, 12.498603731751633, 12.498603731751633, 14.151933843353081, 14.151933843353081, 2.748350289355642, 2.748350289355642, 7.420048590515647, 7.420048590515647, 12.285902443656036, 12.285902443656036, 7.322947528494419, 7.322947528494419, 6.457558975773544, 6.457558975773544, 10.206102887493339, 10.206102887493339, 7.918153039199455, 7.918153039199455, 6.33937348457694, 6.33937348457694, 3.973723100562398, 3.973723100562398, 7.940672787578291, 7.940672787578291, 12.693055967162339, 12.693055967162339, 3.9392692638986286, 3.9392692638986286, 3.608167037455427, 3.608167037455427, 5.612321343246288, 5.612321343246288, 7.663839510372595, 7.663839510372595, 5.76953363559642, 5.76953363559642, 4.540047455646399, 4.540047455646399, 8.555613146059295, 8.555613146059295, 10.652813382552598, 10.652813382552598, 3.320842799259048, 3.320842799259048, 8.787629188310374, 8.787629188310374, 3.5076926854187525, 3.5076926854187525, 3.529937430745446, 3.529937430745446, 6.701111589252555, 6.701111589252555, 1.3772469046284552, 1.3772469046284552, 2.369609191359418, 2.369609191359418, 11.605496359570438, 11.605496359570438, 4.355029613310451, 4.355029613310451, 2.164075159695951, 2.164075159695951, 8.75471816310286, 8.75471816310286, 4.370702276433274, 4.370702276433274, 6.24841276117969, 6.24841276117969, 0.9941902012811149, 0.9941902012811149, 4.999926836118624, 4.999926836118624, 7.6615684376971664, 7.6615684376971664, 5.599102783621475, 5.599102783621475, -0.12372343086328755, -0.12372343086328755, 10.494734216070285, 10.494734216070285, 4.751050839836706, 4.751050839836706, 12.777394401080214, 12.777394401080214, 1.028609219852495, 1.028609219852495, 5.19225946549274, 5.19225946549274, 6.009112932728566, 6.009112932728566, 3.0665822488532135, 3.0665822488532135, 11.574413531656198, 11.574413531656198, 17.388765944666837, 17.388765944666837, 1.4088830504889491, 1.4088830504889491, 2.559504642520514, 2.559504642520514, 7.085146652153022, 7.085146652153022, 0.6625652741159208, 0.6625652741159208, 7.28484550070787, 7.28484550070787, 2.9205473269075797, 2.9205473269075797, 10.71579209857801, 10.71579209857801, 7.538050644470911, 7.538050644470911, 4.096036871377901, 4.096036871377901, 4.17194572965365, 4.17194572965365, 7.388345860317003, 7.388345860317003, 5.168935131091457, 5.168935131091457, 11.406621489185628, 11.406621489185628, 3.4482981468878346, 3.4482981468878346, 11.46932734723628, 11.46932734723628, 7.691213191498017, 7.691213191498017, 6.20801044834896, 6.20801044834896, 7.676248596103667, 7.676248596103667, 10.285797114216171, 10.285797114216171, 10.248981233064928, 10.248981233064928, 6.144119621771541, 6.144119621771541, 21.678138396368556, 21.678138396368556, 4.3453947854428, 4.3453947854428, 12.010725134291564, 12.010725134291564, 6.272284328127157, 6.272284328127157, 4.882673730558014, 4.882673730558014, 7.2163818654377385, 7.2163818654377385, 9.662106272715416, 9.662106272715416, 0.33846606347949615, 0.33846606347949615, 6.4821765295614915, 6.4821765295614915, 10.071532220250088, 10.071532220250088, 5.152087264820624, 5.152087264820624, 3.6933144181569846, 3.6933144181569846, 4.236698377027361, 4.236698377027361, 2.950896969288669, 2.950896969288669, 8.88778461190575, 8.88778461190575, 12.539355433728124, 12.539355433728124, 5.858753853448359, 5.858753853448359, 2.2232740622558658, 2.2232740622558658, 6.727044514928707, 6.727044514928707, -1.1246080836386514, -1.1246080836386514, 6.775105340855537, 6.775105340855537, 8.712071353857931, 8.712071353857931, 7.203538298174464, 7.203538298174464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27807283607718586, "mean_inference_ms": 2.090778269162475, "mean_action_processing_ms": 0.09551272815661194, "mean_env_wait_ms": 0.5752497632302901, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 243000, "timesteps_this_iter": 0, "agent_timesteps_total": 729000, "timers": {"sample_time_ms": 12714.544, "sample_throughput": 265.444, "load_time_ms": 0.302, "load_throughput": 11170027.618, "learn_time_ms": 1778.618, "learn_throughput": 1897.541, "update_time_ms": 21.943}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 14.198193454742432, "policy_loss": -0.005530326743610203, "vf_loss": 14.210886383056641, "vf_explained_var": 0.02171759009361267, "kl": 0.0034831810411112716, "entropy": 0.7162364244461059, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.420718050003052, "policy_loss": -0.012566791474819183, "vf_loss": 2.4404058337211607, "vf_explained_var": 0.6197463572025299, "kl": 0.00580810737204272, "entropy": 0.7121560662984848, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 243000, "num_agent_steps_sampled": 729000, "num_steps_trained": 243000, "num_agent_steps_trained": 729000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9720, "training_iteration": 72, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-24-14", "timestamp": 1706106254, "time_this_iter_s": 13.543907880783081, "time_total_s": 872.8899314403534, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 872.8899314403534, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 40.523529411764706, "ram_util_percent": 75.10000000000001, "gpu_util_percent0": 0.17941176470588235, "vram_util_percent0": 0.2216796875}}
{"episode_reward_max": 12.770674751671779, "episode_reward_min": -13.116988344847423, "episode_reward_mean": 0.5968456654001614, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.985840161953476, "policy_agent_": -1.0258539175703323}, "policy_reward_max": {"policy_adversary_": -4.190692619446361, "policy_agent_": 17.60663175952428}, "policy_reward_mean": {"policy_adversary_": -11.532946068616033, "policy_agent_": 6.0648958670080955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.339848861287907, 7.780902042385661, -3.745563954146479, -5.189015838280529, -3.55809871629651, 1.2612248535945128, 6.7819621401434755, 2.6479470199449278, 0.6730641843252761, -1.7820836207029056, -3.9662134084058294, 2.22559777684673, 5.436915106923184, -0.6914618983011229, 1.571798701806316, -8.231397583901632, -1.3427844219840064, 6.157656919131259, -7.707795721148646, -1.810258816189807, -4.960316484288526, 2.8167760403726256, 2.9058669448722787, -3.606882115079388, 5.799373334791316, 0.5466694398142058, 12.770674751671779, 6.695992377567638, 2.8054549357561696, 5.081366361824475, 4.784398773014319, -2.826850339234707, 3.9437681600420005, 0.03480708094108251, -3.8935182151859444, -1.6138736993582383, 2.740212969723727, 4.384543062632258, 6.544810673413458, -1.0147018635751335, 1.3841906242307123, -4.791343912217746, 5.808036678915428, 4.269558367118248, -7.68546312347654, 1.2020291228720674, -7.057829898888698, 1.068117881821075, 1.0064701193713215, 3.214552016598547, 0.6526521076979341, 4.8731224620848765, -6.872495429989913, 2.797824237384237, -6.098635443290208, 4.980786906038662, 3.3607021210944117, -2.1020383515757217, 4.667552021180458, -1.8072112634178623, 4.022493148107949, 3.831968648135147, -0.3709340509642149, 2.0786246074904318, 0.9862611808623643, 3.3632716076328855, 0.9585139948484984, 0.9725532749429994, -2.9237078567304757, 2.306772486901231, 6.484677850432961, 11.522880428122068, 5.187986241979, -0.9507070586683654, -1.136072601420235, -1.8166693103673914, -0.722693778956927, -0.1564018773070441, -0.6876655564915926, 5.432768082940255, 5.90290555211548, -1.7565768352233078, -13.116988344847423, 7.313716751715084, 4.397450879930408, -1.053864958973838, -12.47643402935587, -6.248396926381696, -4.274775917454356, 5.076145919166701, 0.963324240992526, 6.258764969388841, 1.1193920941387414, -0.10968549070838675, -0.44297127759656957, -3.859269259906645, -5.7139252805718215, -4.1117165976418795, -1.51415184531087, -4.533769903142156, -0.22982287194702333, -1.1846129167190693, -8.082829332499577, 4.126041581516826, 3.477268933124291, -4.950378054016649, 1.818731328483126, 0.10479257917619828, 2.997582202843745, 3.4296640752675867, -12.649296166659989, -7.9125444867972226, -0.8622604165676971, -1.818057807285363, 2.9318018371578543, 4.882274811628123, 2.8415714389326734, -3.9792099429447862, -4.50746021587809, -1.5445907912174237, 8.643175990412663, -4.468785384736732, 6.263910145319384, 6.789970976653816, 1.5898105239039895, 1.6711141762386987, 5.331921254538807, 0.6478677674959987, 5.132882784548756, 2.1523742166626376, -0.6376821061987519, 0.14011312243534024, -1.5510670988379383, -2.594252330363231, 10.709658743229841], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.616781646633775, -13.34482151238157, -9.300583992864876, -4.513687128629383, -11.7607241268289, -5.321524358472255, -13.729259872144596, -14.361795473653226, -12.788386835363541, -6.695857883495209, -9.798204093437267, -6.682343229845896, -13.746310291265607, -9.559536437243214, -7.273794534600532, -8.048043242536327, -13.176212331442272, -16.437939000241528, -9.680147780553952, -4.190692619446361, -14.352843991528019, -9.592792068445288, -8.35622140511907, -6.5703031582168006, -23.985840161953476, -9.071705975537423, -20.298701885725816, -14.634689577113205, -11.697583381526472, -9.54524205761853, -19.483010564493778, -9.485978176336573, -9.287793592331607, -9.139363669974761, -14.005624740393108, -10.17242796470583, -11.465459266331292, -9.86324049351514, -15.493690206064704, -7.766772079391295, -11.265175194314534, -8.825812602873285, -14.705707736333805, -14.731393184251766, -13.122649070734774, -7.878680552948781, -11.807317960581543, -8.170263126945471, -5.292016204013155, -10.972429372414863, -8.48851215421078, -10.510482594326056, -8.502449217666198, -14.113955377860952, -6.231859207975402, -13.036296996397471, -12.930352968313205, -14.14636779831195, -15.518000141240435, -16.0655672323879, -17.18512229026276, -12.86854765907005, -7.749085091920654, -8.774417461177087, -5.326648751894129, -15.468373375866824, -7.9268264928327685, -12.52234665058621, -6.629600729248962, -11.2065988398113, -12.354202648197413, -23.690383090926495, -14.153717070557393, -11.082815312110721, -12.579721691226379, -7.5142879533401254, -8.810256670127696, -12.609484271960273, -5.310458195186259, -13.776504905360746, -14.877255207385652, -8.4806358705141, -15.686662507614292, -13.606354963516914, -22.971973286881887, -10.785685623802063, -21.326028400159664, -16.810110936231247, -14.962859297401954, -12.823331323776454, -6.06160901662204, -16.288220993102566, -16.779108100858306, -6.110201396220825, -11.308234684426122, -9.001730392611274, -9.666467739398637, -19.910736352560164, -10.766743189842657, -7.794647042809874, -8.343808451761547, -7.281870858353492, -14.597204795986736, -10.732823907498389, -9.855378127811772, -11.683055280387858, -7.601607339620124, -6.791053325497462, -11.185161824154797, -17.454879248582134, -10.597588331519333, -9.163814646910533, -10.212976999521942, -13.544516763826042, -11.958157101598662, -11.051382386810424, -12.067686113303443, -7.50916249539717, -9.893984442216942, -9.219735025284427, -13.62675672974021, -7.123371308589323, -14.10501227711477, -19.36198381271718, -13.339860098984568, -6.662057991128594, -12.083265833990515, -19.8012784433958, -11.55139759831554, -9.653361893723885, -10.674100967430093, -7.569017198096066, -8.561537470067698, -4.468884777072052, -15.450770417848897], "policy_policy_agent__reward": [12.978315253960844, 12.978315253960844, 10.56286177738361, 10.56286177738361, 2.777510019359201, 2.777510019359201, -0.3376643548255712, -0.3376643548255712, 4.101312705266192, 4.101312705266192, 3.2913746060333855, 3.2913746060333855, 10.255611006144038, 10.255611006144038, 8.50487124679908, 8.50487124679908, 6.73072550984441, 6.73072550984441, 2.4568871313961527, 2.4568871313961527, 2.9159953425157195, 2.9159953425157195, 4.453970503346312, 4.453970503346312, 9.5916126990944, 9.5916126990944, 4.434037269471042, 4.434037269471042, 4.422796618203424, 4.422796618203424, -0.09167717068265369, -0.09167717068265369, 5.916713954729134, 5.916713954729134, 11.297797959686392, 11.297797959686392, 0.9861760297026521, 0.9861760297026521, 1.1902169016282775, 1.1902169016282775, 4.696263753619748, 4.696263753619748, 6.204784054408956, 6.204784054408956, 5.631044174995676, 5.631044174995676, 1.481710521568707, 1.481710521568707, 14.89260674837239, 14.89260674837239, 4.809187707675813, 4.809187707675813, 16.53468831869879, 16.53468831869879, 10.665340977340415, 10.665340977340415, 7.251519158641321, 7.251519158641321, 7.313304209721501, 7.313304209721501, 12.133704668754046, 12.133704668754046, 3.3295639185509334, 3.3295639185509334, 6.615780876186801, 6.615780876186801, 4.587085375457922, 4.587085375457922, 5.056053262603579, 5.056053262603579, 4.279277132673797, 4.279277132673797, 7.102836118027508, 7.102836118027508, 7.1238917780737, 7.1238917780737, 11.019250439739086, 11.019250439739086, 3.3760351079080824, 3.3760351079080824, 6.324682909272624, 6.324682909272624, 2.0172343453277715, 2.0172343453277715, 10.256872207624617, 10.256872207624617, 9.500475775685008, 9.500475775685008, 2.7185929736291143, 2.7185929736291143, 4.540354837910424, 4.540354837910424, 2.374744030846422, 2.374744030846422, 4.619190504383273, 4.619190504383273, 3.1492431616922385, 3.1492431616922385, 7.093490694506704, 7.093490694506704, 4.570582130954354, 4.570582130954354, 7.691802528205466, 7.691802528205466, 0.8149768938381403, 0.8149768938381403, 8.455889807622594, 8.455889807622594, 0.06661188234259857, 0.06661188234259857, 9.008541951218067, 9.008541951218067, 8.145527544703809, 8.145527544703809, 6.022164723368117, 6.022164723368117, 10.092776081210447, 10.092776081210447, 7.129177984485017, 7.129177984485017, 10.60380771918535, 10.60380771918535, 8.350258153602597, 8.350258153602597, 3.68907552047822, 3.68907552047822, 5.4265210343337635, 5.4265210343337635, 3.156454966378246, 3.156454966378246, 9.415822491749852, 9.415822491749852, 4.4426702438406345, 4.4426702438406345, 6.7474499627646045, 6.7474499627646045, 1.8529464362592436, 1.8529464362592436, 6.756685663356267, 6.756685663356267, 9.419440249315185, 9.419440249315185, 17.60663175952428, 17.60663175952428, 9.67085165626819, 9.67085165626819, 5.06605412672118, 5.06605412672118, 5.721824544903072, 5.721824544903072, 2.848809321486366, 2.848809321486366, 4.043781445585385, 4.043781445585385, 6.226541197326616, 6.226541197326616, 2.3113963193473324, 2.3113963193473324, 9.604636494150498, 9.604636494150498, 10.390080379750565, 10.390080379750565, 3.362029517645396, 3.362029517645396, 1.2848370813834369, 1.2848370813834369, 10.460035857615997, 10.460035857615997, 13.684712083406145, 13.684712083406145, 4.8659103324141135, 4.8659103324141135, 4.4247971854019, 4.4247971854019, 5.280857004924776, 5.280857004924776, 5.344041689973801, 5.344041689973801, 8.94973862147158, 8.94973862147158, 3.5124666288072826, 3.5124666288072826, 11.273492981245706, 11.273492981245706, 8.949250097498517, 8.949250097498517, 3.0002579527562174, 3.0002579527562174, 5.432631703414777, 5.432631703414777, 2.571230566352313, 2.571230566352313, 1.976271229413406, 1.976271229413406, 7.899509877459139, 7.899509877459139, 4.626295672265895, 4.626295672265895, 1.6304385698338582, 1.6304385698338582, 4.056992789907261, 4.056992789907261, 3.0486289708172123, 3.0486289708172123, 3.257187731743578, 3.257187731743578, 7.429432744507608, 7.429432744507608, 6.6663235304680315, 6.6663235304680315, 3.366338613185604, 3.366338613185604, 4.710169334051624, 4.710169334051624, 3.44792295233683, 3.44792295233683, 7.091372013499272, 7.091372013499272, 10.442271661924861, 10.442271661924861, -1.0258539175703323, -1.0258539175703323, 0.6256350800566539, 0.6256350800566539, 4.675358291477123, 4.675358291477123, 5.863229478270341, 5.863229478270341, 7.444979469378259, 7.444979469378259, 7.966828599219273, 7.966828599219273, 7.454628776118057, 7.454628776118057, 1.764976276226192, 1.764976276226192, 2.6932621131694265, 2.6932621131694265, 3.8375721170335013, 3.8375721170335013, 11.134966360076438, 11.134966360076438, 1.3272929619262948, 1.3272929619262948, 10.184461211217075, 10.184461211217075, 13.075977394685497, 13.075977394685497, 7.464835311444281, 7.464835311444281, 4.1665860836836455, 4.1665860836836455, 8.707593544264663, 8.707593544264663, 10.224573105445902, 10.224573105445902, 8.342140191432152, 8.342140191432152, 5.9028680551932595, 5.9028680551932595, 5.018209430615671, 5.018209430615671, 3.8545651602657025, 3.8545651602657025, 3.50523518561488, 3.50523518561488, 0.9373162233544109, 0.9373162233544109, 13.08021458053937, 13.08021458053937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782372919272521, "mean_inference_ms": 2.0923493030249474, "mean_action_processing_ms": 0.09553015321111888, "mean_env_wait_ms": 0.5754910172855044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 246375, "timesteps_this_iter": 0, "agent_timesteps_total": 739125, "timers": {"sample_time_ms": 12897.812, "sample_throughput": 261.672, "load_time_ms": 0.302, "load_throughput": 11170027.618, "learn_time_ms": 1806.797, "learn_throughput": 1867.946, "update_time_ms": 22.896}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005000000000000001, "total_loss": 12.650368976593018, "policy_loss": 0.005567761010024696, "vf_loss": 12.652000522613525, "vf_explained_var": 0.023886460065841674, "kl": 0.00402123039239406, "entropy": 0.7199632406234742, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.8931147098541259, "policy_loss": -0.005959267448633909, "vf_loss": 1.9063881516456604, "vf_explained_var": 0.646941089630127, "kl": 0.006045436122252906, "entropy": 0.7314764320850372, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 246375, "num_agent_steps_sampled": 739125, "num_steps_trained": 246375, "num_agent_steps_trained": 739125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9855, "training_iteration": 73, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-24-26", "timestamp": 1706106266, "time_this_iter_s": 12.750804424285889, "time_total_s": 885.6407358646393, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E29C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 885.6407358646393, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 35.2875, "ram_util_percent": 75.38125, "gpu_util_percent0": 0.14250000000000002, "vram_util_percent0": 0.2169952392578125}}
{"episode_reward_max": 13.747336824576635, "episode_reward_min": -17.818558619646883, "episode_reward_mean": 0.44037003026169164, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.550497075297773, "policy_agent_": -3.5460964854258377}, "policy_reward_max": {"policy_adversary_": -2.9951641650877185, "policy_agent_": 17.456076883534607}, "policy_reward_mean": {"policy_adversary_": -11.830657110661674, "policy_agent_": 6.135513570461683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7485144027021775, 1.6067565741418774, 2.1006646200358126, 5.650017208795695, -2.126487656193433, -0.3363478866196302, -0.47520868691764173, 7.724681043350552, -2.3320966948998314, -4.067651520363355, -4.126888519525005, 3.1815486999979106, -4.771497930952301, 4.654261921957845, 0.7231061174130914, 2.7830500127994795, 7.808651694169419, -2.225544397060353, -2.595392565024551, -8.355857190902299, 7.6781000181525965, 8.224764734848007, 6.329413057385159, 1.20833606024088, 4.962429412439744, 5.904889282355527, 3.777489450330637, -5.575912661531739, 4.628386962786621, -0.4581020652642644, -13.487900410350852, -4.223775949873737, -11.883638636962909, 1.172536792174196, 1.3194198940051827, -4.555177388993265, 4.921680685486496, 0.7763883384768926, 0.4492691698164936, -6.254890769243186, 5.653097465535681, 0.16016193044141547, 3.4541829086197495, -1.6494585984505234, 0.4120427558014347, -3.105182832777512, 3.0111236855708685, 7.879656764997037, 6.145370394871661, -0.31678529469242034, 3.0973023505106667, -0.24280911904246913, 3.6474057828460005, 0.07922039231998984, 6.973657749144647, -5.3609053404222085, -6.340729694451949, 7.153383458196693, -9.071766700105208, 3.3821220571435315, 5.2624737291381525, -2.3223620460406633, 13.747336824576635, 1.93801901361799, 0.761481440033029, 8.548894437601309, -5.926050228233447, 3.82493187089767, 2.2514836571580568, 1.916593286687284, 0.5361101965217909, -4.725796522060093, -6.778735768307746, 5.842350227454497, -0.6207763797630155, 1.6746301966860588, -1.572947291383101, 0.03429429314581313, 4.668237863587392, 0.5363761876201087, 3.2239806873821006, -1.8407857243212702, 1.841167425837206, 4.4410967915547825, -2.950358833513324, 0.08619255635532305, 0.3947803751459075, 0.13892965258999473, 7.875651911704013, 3.660298148683676, -1.5893571332273022, 6.370921365525314, 2.610557845643467, -1.9001873098959619, -10.849279477285757, -0.4277933504652804, 2.8198381583750827, 0.6887967751051176, 0.2605662502569114, -1.0615493294179807, -2.9418069064076278, -5.485517179401357, -3.1034049980737026, 8.14470165386807, -0.10802798801755242, 9.42344885682491, 3.127192691734577, 5.735306333753451, -5.738426011551672, 0.6386400737718417, -7.139114743459827, 1.099963267236076, -7.118222225266812, 2.8701875681938955, -5.254211635999324, -17.818558619646883, 1.5776056741077114, -2.8416591166463117, 4.528755260673575, 6.254513721914441, -3.209306841684544, -9.15545136672413, 3.291381169572053, 0.4138619069047852, 9.670079748542019, 1.9216832340685368, 4.508789475566879, -2.2011738962228993, -4.721921839832484, -0.26706259476631555, 1.445953018271426, 0.615707298891154, -4.948244226002299, 3.4469271098096317, -7.0457209028836845], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-27.550497075297773, -18.91368835054263, -11.827778777929952, -15.535067016835999, -8.948670431971722, -8.116249735740388, -7.182566817012294, -15.70431694693559, -3.8806126295990304, -12.470900232455877, -16.06913912233871, -9.229715277667989, -4.828391231029934, -10.666874954885158, -9.438783613528237, -7.948843576492979, -18.7193339517801, -14.920719942412958, -19.2004456377667, -19.259681091899072, -14.719109814047606, -16.12560154724756, -16.726006440946623, -10.266521700039092, -9.821184747190875, -14.1592087448413, -16.394138354884902, -8.80988435993945, -11.075363063476013, -14.511331521585866, -15.079086796048948, -5.273015164307497, -15.971428607677622, -5.858900983263952, -6.400242023445876, -9.742067700669242, -15.517621799426568, -8.383848813896773, -11.461129832237951, -14.274792219138616, -12.728950967800275, -17.448556453292795, -8.850473875948511, -14.856058480852742, -10.222561731420805, -8.32431066189908, -10.392795231126813, -14.789678751484155, -11.993561544375538, -11.043900488170953, -11.756556050356895, -6.567287770102919, -10.774680463740758, -10.920785021246635, -14.16396463619539, -14.470010124644071, -13.50585566718451, -16.78903798791722, -19.947080922907833, -14.611509278205885, -13.326970029519341, -21.97030202091538, -21.164816942492592, -8.481496885782587, -6.7371286643262165, -24.688442988469312, -9.121672104824475, -14.879458477537748, -8.177682459103004, -16.52241311698048, -11.451905506327789, -11.636767759981563, -13.075874249402512, -10.196355304498566, -11.507884715933285, -6.261673447519254, -6.355255571127096, -5.4707930802938005, -14.74292360594956, -13.746810283346699, -11.035862831660205, -3.3476148392005274, -11.141997407744585, -9.289640942510582, -7.140058235507543, -6.9942314375061425, -5.622880678856023, -11.452520252750706, -12.726591223417834, -9.849243962911624, -16.720085179034957, -16.342846881473832, -9.972124439521082, -13.516067405883293, -18.625457626186154, -9.353705827229996, -12.225843458591552, -7.6914265773430746, -16.196636910567005, -6.536457714615207, -7.156412212555139, -12.795932985301505, -11.715041048451901, -14.080967532241518, -9.871598419759287, -20.575259982094245, -7.232288212417656, -17.418963044686173, -5.467800450653216, -9.41387925481646, -2.9951641650877185, -9.750388534582763, -8.99113603173478, -9.41518897790259, -16.569401787437773, -10.72636564879521, -8.092503325143525, -10.0537457979249, -15.919059435971077, -12.16243957094671, -7.298880862853535, -7.195585564889756, -9.901052533023076, -7.829605999824691, -17.288267598395382, -9.707324719888637, -14.20169808955773, -6.1538139191516406, -19.590903916780587, -7.876044323692308, -9.22906965432444, -5.090510394822812, -16.45657724909252, -8.966925409617579, -9.510615480754707], "policy_policy_agent__reward": [14.649505738999974, 14.649505738999974, 10.260222462342256, 10.260222462342256, 6.964221698982884, 6.964221698982884, 10.59254211281585, 10.59254211281585, 3.411091387889144, 3.411091387889144, 3.8899509245603783, 3.8899509245603783, 3.3536790650473245, 3.3536790650473245, 11.71449899514307, 11.71449899514307, 0.7742579673496005, 0.7742579673496005, 4.2016243560462625, 4.2016243560462625, 5.971125301406852, 5.971125301406852, 6.205631988832952, 6.205631988832952, 0.028446650038817092, 0.028446650038817092, 7.6605684384215, 7.6605684384215, 5.080944865470663, 5.080944865470663, 5.365946794646231, 5.365946794646231, 13.263992822974759, 13.263992822974759, 6.347587772676301, 6.347587772676301, 8.302526536371076, 8.302526536371076, 5.45191195049839, 5.45191195049839, 11.1986049161001, 11.1986049161001, 12.175183141047784, 12.175183141047784, 11.527709749165894, 11.527709749165894, 5.737428880139985, 5.737428880139985, 7.391807079815309, 7.391807079815309, 10.032049013598414, 10.032049013598414, 10.08581390260777, 10.08581390260777, 1.6169858492038562, 1.6169858492038562, 7.851875013131316, 7.851875013131316, 7.026614728160801, 7.026614728160801, 0.7955931928490431, 0.7955931928490431, 0.5246196072168816, 0.5246196072168816, 2.0438949853573543, 2.0438949853573543, 3.5157188877190717, 3.5157188877190717, 3.8598309587255293, 3.8598309587255293, 2.593445155837989, 2.593445155837989, 10.21965124245653, 10.21965124245653, 4.580118576186831, 4.580118576186831, 5.955199501027221, 5.955199501027221, 4.009950724947713, 4.009950724947713, 9.191024216667977, 9.191024216667977, 8.804359191867109, 8.804359191867109, 6.152328392284133, 6.152328392284133, 6.603299941201112, 6.603299941201112, 5.3173022436111195, 5.3173022436111195, 2.609563914560784, 2.609563914560784, 6.70195945834884, 6.70195945834884, 11.334667758240595, 11.334667758240595, 9.0694659696236, 9.0694659696236, 5.363557596739266, 5.363557596739266, 7.426929200433781, 7.426929200433781, 3.162239325530226, 3.162239325530226, 7.211043123293378, 7.211043123293378, 5.500002706783314, 5.500002706783314, 10.568811192670022, 10.568811192670022, 4.5545523921109305, 4.5545523921109305, 3.5825629863662813, 3.5825629863662813, 11.971210723056956, 11.971210723056956, 5.437657111401311, 5.437657111401311, 8.996815667674708, 8.996815667674708, 9.294721879328744, 9.294721879328744, 9.823969987437358, 9.823969987437358, 17.456076883534607, 17.456076883534607, 5.209757949700289, 5.209757949700289, 3.749305052179622, 3.749305052179622, 16.61866871303531, 16.61866871303531, 1.5978109382955152, 1.5978109382955152, 9.35219517421771, 9.35219517421771, 5.214583058130531, 5.214583058130531, 9.219503201833879, 9.219503201833879, 5.994007851424792, 5.994007851424792, 3.4554856189607355, 3.4554856189607355, 3.148569240547382, 3.148569240547382, 8.019352765976528, 8.019352765976528, 5.443554168085134, 5.443554168085134, 3.968151822102655, 3.968151822102655, 2.3911541398719978, 2.3911541398719978, 2.752543686719807, 2.752543686719807, 9.705580734768478, 9.705580734768478, 7.141593235483404, 7.141593235483404, 7.129921759521153, 7.129921759521153, 0.7534145574396289, 0.7534145574396289, 6.491582416790897, 6.491582416790897, 6.865368867032683, 6.865368867032683, 2.0948497009971088, 2.0948497009971088, 3.5402119969307324, 3.5402119969307324, 3.008830527000966, 3.008830527000966, 5.795724952670351, 5.795724952670351, 10.301121567560923, 10.301121567560923, 6.75477105579765, 6.75477105579765, 7.565364022903826, 7.565364022903826, 11.356884123499578, 11.356884123499578, 6.291341142582276, 6.291341142582276, 5.807940047993666, 5.807940047993666, 3.888089074450195, 3.888089074450195, 4.4629562383823576, 4.4629562383823576, 7.522840808483319, 7.522840808483319, 4.190111676224096, 4.190111676224096, 8.228601580411956, 8.228601580411956, 2.7374541925986136, 2.7374541925986136, 2.107302653073757, 2.107302653073757, 3.6552079029500764, 3.6552079029500764, 4.305818025189098, 4.305818025189098, 11.112834593054801, 11.112834593054801, 4.881785215870869, 4.881785215870869, 14.999354419459578, 14.999354419459578, 5.179740452076118, 5.179740452076118, 11.577134689219811, 11.577134689219811, -0.1353127804492319, -0.1353127804492319, 5.026259664294149, 5.026259664294149, -2.0719752891860552, -2.0719752891860552, 5.4251759009094185, 5.4251759009094185, 0.936456903233983, 0.936456903233983, 6.142688273048246, 6.142688273048246, 5.6575950757192235, 5.6575950757192235, -3.5460964854258377, -3.5460964854258377, 4.8350544996256195, 4.8350544996256195, 3.606043340639295, 3.606043340639295, 10.223907348322326, 10.223907348322326, 9.208476646430572, 9.208476646430572, 2.0447870105844967, 2.0447870105844967, -0.979932900917195, -0.979932900917195, 6.596216851297565, 6.596216851297565, 4.121733953364739, 4.121733953364739, 13.479173673468699, 13.479173673468699, 5.814503976978587, 5.814503976978587, 9.355243782562304, 9.355243782562304, 1.976320011464373, 1.976320011464373, 7.434491038474046, 7.434491038474046, 3.8044908644629967, 3.8044908644629967, 5.337511336297932, 5.337511336297932, 2.853108846856984, 2.853108846856984, 5.754166511545109, 5.754166511545109, 6.206926259713602, 6.206926259713602, 1.2324472889355098, 1.2324472889355098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27865188018575354, "mean_inference_ms": 2.0943804510699557, "mean_action_processing_ms": 0.09562835383154333, "mean_env_wait_ms": 0.5763442053186268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 249750, "timesteps_this_iter": 0, "agent_timesteps_total": 749250, "timers": {"sample_time_ms": 13074.873, "sample_throughput": 258.129, "load_time_ms": 0.302, "load_throughput": 11170027.618, "learn_time_ms": 1822.306, "learn_throughput": 1852.049, "update_time_ms": 23.293}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005000000000000001, "total_loss": 13.634469318389893, "policy_loss": 0.006186121772043407, "vf_loss": 13.635465621948242, "vf_explained_var": 0.013831597566604615, "kl": 0.0035054923758062627, "entropy": 0.7183301150798798, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.08463693857193, "policy_loss": -0.02322007822804153, "vf_loss": 2.115039509534836, "vf_explained_var": 0.625414577126503, "kl": 0.004795571563344763, "entropy": 0.7182945102453232, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 249750, "num_agent_steps_sampled": 749250, "num_steps_trained": 249750, "num_agent_steps_trained": 749250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9990, "training_iteration": 74, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-24-39", "timestamp": 1706106279, "time_this_iter_s": 13.025205373764038, "time_total_s": 898.6659412384033, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E293A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 898.6659412384033, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.27058823529412, "ram_util_percent": 75.23529411764706, "gpu_util_percent0": 0.2029411764705882, "vram_util_percent0": 0.21764418658088236}}
{"episode_reward_max": 15.59377927075178, "episode_reward_min": -18.61912073221895, "episode_reward_mean": 0.168106178010729, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.883503396278403, "policy_agent_": -0.15455339394210701}, "policy_reward_max": {"policy_adversary_": -4.046039284328701, "policy_agent_": 20.238641333515094}, "policy_reward_mean": {"policy_adversary_": -11.363061854123938, "policy_agent_": 5.765584016067332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9623807490105059, 2.1442397777682554, 6.655070232142412, 9.360206973210872, 2.2093840831783202, -4.1140295332910135, -4.891656926289929, -0.08133123097344913, 6.565197436173699, 5.9088760765858, -5.948751985388804, -2.9660045063258274, 0.9869883247793595, -3.0472083766015614, 5.8960315716044, -4.479053161625677, 5.763504520336201, 1.3391631009577782, 11.478877676912745, -2.4129762492217597, 2.2518992624910585, 0.022911858370700533, 1.0116721964828066, -3.5890557203415883, 3.978723327026138, 0.6421683573756712, -1.2071594261735417, -3.1288077283770117, -2.7859768773078217, -1.5469339442283512, 5.974279071808402, 4.884429459728675, -4.025282026874056, 0.8335534927608172, -1.6882697356139302, 0.2744674977469713, -1.2937522649730824, -0.9987765320160888, -4.076673884808661, 0.9749229112514852, 15.59377927075178, 4.516873336756455, -2.594774482190971, 6.3336341654014365, 4.1977813693692845, 1.0634275251783343, 2.798156487636935, -10.874735082368726, 3.8050341328407913, 7.581105898383335, 7.550347764849443, -9.783765919503155, -2.395900229128599, -1.6846067479171838, -1.1512287976470952, -1.5550634138072117, 0.9136447464865391, 2.7830398463059463, 0.38922304076267833, 9.371184415904555, -2.863064847374934, 8.680137356971668, -9.414264728687906, -0.3446688929694028, -9.746598557249406, 3.5948446686264934, 2.870435719760879, -2.793086970498388, 1.1127643593479122, -14.738607993387719, -2.3887106621469303, -1.1158601209788965, 4.942731333090611, 4.702018454505688, -0.03789791111486254, -12.01242732460073, 2.494869648257635, 5.70271884465487, 5.816639215574162, -1.103115456914244, -10.90164903574889, 2.6816920803015445, 2.183839926638699, 2.6248240194982797, -18.61912073221895, -5.385176102133872, 2.7358619706926204, 6.323654111799356, -2.1094620165054025, 1.0119185701109685, -1.8734089022778881, 1.3428735176012385, -1.31955620613466, 5.228417205441554, -0.2940629372780561, -2.359587312003531, -1.4536504317506247, 0.4821911424745338, 1.2142862021780334, 2.639494376697994, -1.8187040460508737, 2.9335101119809854, 3.6126091112681444, -0.038574193278317986, -0.7291977308513469, -7.658488878793761, 0.48819728696244036, -2.7427544754382516, 4.8221102744728865, -8.16006707259336, -7.229883739566619, -0.3641691656485396, -0.36613565416317606, -5.031962705871696, 3.747926565207125, 3.487554227815697, 8.387280408248104, -8.16733202774408, -2.2194027832411596, 12.9008537095197, -4.699567194259192, 4.471339808012616, -11.312399584263813, -3.742479215718749, 0.5441664503537014, 3.421100684640861, 1.369442933074676, -0.5268935691492316, 0.08526569130624448, 1.7364641892113135, -0.6369438649432803, -3.021552275286538, 3.0353198557010197, -1.2648766230532482, 5.175936766003197], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.570863155571491, -6.158673690511002, -14.498285172739179, -13.194646683639416, -10.86974514294855, -8.624762668905074, -14.848807814210643, -6.837773808413815, -14.512353252585534, -15.362510396911011, -9.633292882291338, -11.17854555274046, -7.580417566527465, -15.117614493540117, -10.86080648824139, -6.324765174976765, -15.823445467275358, -7.055233031486935, -19.385441652685614, -6.938683078373701, -10.26991436903179, -13.792142562138773, -14.376203552800808, -7.328496631352481, -12.156840216525364, -7.071245563116006, -9.023019643866855, -8.097065266255266, -15.268838603486412, -5.8538294724184725, -10.330254885543297, -12.378634743689856, -9.338264308304366, -5.719777133937826, -6.485117977491524, -11.918798373351658, -5.203506317157059, -15.742409839721388, -9.949794176188306, -7.456253481544101, -24.883503396278403, -7.816836930264112, -4.849221402587402, -12.182617733951844, -21.200187038440237, -6.121464534955189, -10.569494172651938, -21.057639207069098, -12.273946414449783, -19.60789339002557, -11.419158855999216, -15.305287052711057, -18.602517837053647, -9.031583985866932, -6.575222770198304, -14.509281315924786, -9.510028808436653, -8.676482444580358, -9.36077779347948, -15.29230030839148, -4.958210522415428, -15.848580704533653, -14.81675333778254, -4.046039284328701, -15.56451518840125, -10.208358726963914, -21.42540830118926, -15.824113984827015, -6.6229396392089805, -15.548607869364067, -10.747923910233787, -6.463407614925668, -13.976913876965181, -13.647590685944625, -7.496424595668013, -18.80999565956572, -10.208585969661335, -10.598111926827329, -14.557714355574804, -10.843324279454151, -11.398924214768048, -10.844394762842303, -9.935550202975486, -9.545573848798101, -19.527254640771574, -13.118974940265996, -10.033589754770029, -10.725213012801134, -8.11927480744126, -9.886563352887253, -14.200582724414755, -7.410576640561254, -13.04735457993487, -10.706524867595501, -9.166470920818465, -14.203227594882623, -17.36700107074694, -9.659073226243393, -12.916433741368026, -16.50858222072418, -13.38087926468821, -14.726247928297434, -9.565266964101381, -6.409636367541439, -10.655178608003775, -10.572122057553578, -9.074340587269136, -4.766196701276323, -15.937774691339905, -20.8313794162864, -6.920776951682407, -6.363127355457369, -10.557681372498717, -5.116155659835342, -15.4189878699612, -9.473363112977966, -13.793682816954446, -15.549342860650656, -11.117906624376902, -18.68207676419697, -6.343653997383004, -7.7600017919801845, -12.053698729311423, -7.047917806319669, -15.400006851513137, -8.52155826293131, -12.804744072310907, -7.599553325740933, -8.326437506236964, -10.173300107425339, -15.827447375063917, -5.0635819695445825, -11.592598738348798, -4.161738747465026, -12.907805804948115], "policy_policy_agent__reward": [4.266621952290999, 4.266621952290999, 4.1514567341396305, 4.1514567341396305, 10.576677702440794, 10.576677702440794, 11.277426828425138, 11.277426828425138, 6.539564613063437, 6.539564613063437, 2.2553665678070307, 2.2553665678070307, 4.9785754439603584, 4.9785754439603584, 3.3782212887201823, 3.3782212887201823, 10.538775344379617, 10.538775344379617, 10.635693236748406, 10.635693236748406, 1.8422704484512642, 1.8422704484512642, 4.106270523207317, 4.106270523207317, 4.2837029456534115, 4.2837029456534115, 6.0352030584692775, 6.0352030584692775, 8.378419029922899, 8.378419029922899, 0.9228560066755456, 0.9228560066755456, 10.793474993805777, 10.793474993805777, 4.197198066222357, 4.197198066222357, 15.43215966479918, 15.43215966479918, 2.2628534145759707, 2.2628534145759707, 6.260906815761423, 6.260906815761423, 6.907527210254736, 6.907527210254736, 7.693937874641806, 7.693937874641806, 1.8697204555054454, 1.8697204555054454, 8.067781771775751, 8.067781771775751, 3.8567069602458384, 3.8567069602458384, 3.907930108846657, 3.907930108846657, 2.4841287689391267, 2.4841287689391267, 6.2414308630892945, 6.2414308630892945, 2.1534477640950613, 2.1534477640950613, 8.15226697867585, 8.15226697867585, 8.631532101709263, 8.631532101709263, 2.6564911407151555, 2.6564911407151555, 3.276665313349321, 3.276665313349321, 2.3984241209387984, 2.3984241209387984, 6.096632935549316, 6.096632935549316, 1.9548770260919892, 1.9548770260919892, 7.371816653852651, 7.371816653852651, 2.9365601456898216, 2.9365601456898216, 4.215588196397791, 4.215588196397791, 20.238641333515094, 20.238641333515094, 6.166855133510284, 6.166855133510284, 1.127223460198215, 1.127223460198215, 9.25812594967664, 9.25812594967664, 12.698984203904761, 12.698984203904761, 3.5924460300667604, 3.5924460300667604, 6.683825330144437, 6.683825330144437, 5.091452062350189, 5.091452062350189, 8.039490273645287, 8.039490273645287, 13.594499644204452, 13.594499644204452, 9.484753310424328, 9.484753310424328, 2.7607605666039516, 2.7607605666039516, 8.103308803962527, 8.103308803962527, 3.6734886189748726, 3.6734886189748726, 2.7119969862756057, 2.7119969862756057, 6.477108951058787, 6.477108951058787, 5.211836777461598, 5.211836777461598, 5.729761145443153, 5.729761145443153, 4.875000417121078, 4.875000417121078, 12.331742362148017, 12.331742362148017, 1.0475728375202475, 1.0475728375202475, 12.264359030752663, 12.264359030752663, 2.701244304547313, 2.701244304547313, 1.8506851956796488, 1.8506851956796488, 2.908958315575923, 2.908958315575923, 6.901601697795203, 6.901601697795203, 12.147922010475071, 12.147922010475071, 6.515513507164313, 6.515513507164313, 3.8678519992784466, 3.8678519992784466, 0.4049999379881722, 0.4049999379881722, 4.179606624043428, 4.179606624043428, 2.6737737469733847, 2.6737737469733847, 9.459822605027895, 9.459822605027895, 9.174804570225158, 9.174804570225158, 3.729263342276574, 3.729263342276574, 3.3987841674824963, 3.3987841674824963, 6.3517278089594855, 6.3517278089594855, 8.150415385741102, 8.150415385741102, 10.187176785574481, 10.187176785574481, 4.870104411269953, 4.870104411269953, 0.24863758950957854, 0.24863758950957854, 6.763043421571923, 6.763043421571923, 6.059695064807092, 6.059695064807092, 6.085198934148193, 6.085198934148193, 0.45406695427630195, 0.45406695427630195, 3.8668994190660606, 3.8668994190660606, 6.384725862731324, 6.384725862731324, 8.524433562300244, 8.524433562300244, 3.0049063954679283, 3.0049063954679283, 5.449240961499111, 5.449240961499111, 6.163586911068431, 6.163586911068431, 4.376725079081246, 4.376725079081246, 5.863899186900107, 5.863899186900107, 7.967471036518527, 7.967471036518527, 4.436203991770204, 4.436203991770204, 5.921820141439547, 5.921820141439547, 7.956675319498158, 7.956675319498158, 5.0706321843589635, 5.0706321843589635, 7.065359971773033, 7.065359971773033, 9.574038298711082, 9.574038298711082, 5.781087609318668, 5.781087609318668, 8.829879020139208, 8.829879020139208, 6.588938037684765, 6.588938037684765, 3.185531087131561, 3.185531087131561, 4.962990438576214, 4.962990438576214, 1.4568165893799125, 1.4568165893799125, 4.781268937115788, 4.781268937115788, 1.0117211129190362, 1.0117211129190362, 10.379942482906397, 10.379942482906397, 6.3356561718465185, 6.3356561718465185, -0.15455339394210701, -0.15455339394210701, 2.9994790949044146, 2.9994790949044146, 5.095772859167769, 5.095772859167769, 0.04209647698182217, 0.04209647698182217, 9.583457217584161, 9.583457217584161, 6.480458670396833, 6.480458670396833, 11.090481612601273, 11.090481612601273, 3.691005416453284, 3.691005416453284, 4.449251920567873, 4.449251920567873, 15.791465236858333, 15.791465236858333, 0.8220434015619067, 0.8220434015619067, 6.115670799996402, 6.115670799996402, 0.3706495725238073, 0.3706495725238073, 1.6527192953004604, 1.6527192953004604, 7.9720866509334165, 7.9720866509334165, 5.971329473786084, 5.971329473786084, 7.08709350269279, 7.08709350269279, 3.5363298782958514, 3.5363298782958514, 4.205851598771604, 4.205851598771604, 5.954882148318324, 5.954882148318324, 7.595251755060318, 7.595251755060318, 1.0210148471290217, 1.0210148471290217, 7.313959297024908, 7.313959297024908, 1.448431062205889, 1.448431062205889, 9.041871285475656, 9.041871285475656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2791316252663398, "mean_inference_ms": 2.0995292686405085, "mean_action_processing_ms": 0.09593252645269806, "mean_env_wait_ms": 0.5775534105548424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 253125, "timesteps_this_iter": 0, "agent_timesteps_total": 759375, "timers": {"sample_time_ms": 13390.118, "sample_throughput": 252.052, "load_time_ms": 0.2, "load_throughput": 16902419.104, "learn_time_ms": 1886.206, "learn_throughput": 1789.306, "update_time_ms": 24.535}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005000000000000001, "total_loss": 12.174875640869141, "policy_loss": 0.0023253709142750266, "vf_loss": 12.179995346069337, "vf_explained_var": 0.036649560928344725, "kl": 0.0075654921381381746, "entropy": 0.744510555267334, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.8612062990665437, "policy_loss": 0.006037985906004906, "vf_loss": 1.862398236989975, "vf_explained_var": 0.621318182349205, "kl": 0.006706696595858342, "entropy": 0.7230278611183166, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 253125, "num_agent_steps_sampled": 759375, "num_steps_trained": 253125, "num_agent_steps_trained": 759375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10125, "training_iteration": 75, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-24-54", "timestamp": 1706106294, "time_this_iter_s": 14.450579643249512, "time_total_s": 913.1165208816528, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E745E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 913.1165208816528, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 45.71666666666667, "ram_util_percent": 74.59444444444443, "gpu_util_percent0": 0.0638888888888889, "vram_util_percent0": 0.2261691623263889}}
{"episode_reward_max": 16.161043927631155, "episode_reward_min": -12.013989398767668, "episode_reward_mean": 0.4488613174916262, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.33980933103241, "policy_agent_": -2.0578688374669136}, "policy_reward_max": {"policy_adversary_": -3.1100772004528245, "policy_agent_": 18.431923697627173}, "policy_reward_mean": {"policy_adversary_": -11.340819836670352, "policy_agent_": 5.894840577080989}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.870664456208254, -0.1670786953597645, 2.4428439823478607, 0.7176075375900561, 0.22663563385867408, 5.268676828038815, -3.671967293824537, -3.8793677527903783, 7.66690182158762, 7.685214821022482, 6.560031517966646, 3.059903528889978, -2.010065597631864, 2.2081764929849808, 0.17764658015983764, -3.2110978030327653, 5.394044657808455, -0.6607493376177334, 3.5226808141578547, 3.4431995206761115, -7.006981915292074, 6.28900241337827, -8.08988579794869, -9.479455266598487, 0.17578190348210188, 4.733550836677936, -12.013989398767668, 2.754054055292335, -6.68139528191217, 1.7729853662022201, -4.906270696125688, -1.1879576129255482, 16.161043927631155, 3.120428337246841, 0.315088205806644, 5.122031397138193, -1.4468970822949239, 2.5428667578715265, 2.2278035680226336, -3.989832447534008, 2.3786423200398845, -2.616438257671347, 0.6977872464825882, 0.2513823513123522, -7.618144223158929, -7.682157931209539, 4.226414579811275, 0.657622103614446, 6.467731765274589, 9.603436151755833, -6.10028380162286, 5.416631116236705, 2.278319847291368, -3.2804461946442407, 3.745064467512642, -5.533121373654434, -2.9218642098018286, -4.673111771052357, 2.92234494388802, -4.02024608543149, -1.4607011909492837, -9.725729229923433, 2.2916440011894084, 4.871013836213853, 0.4596710565989342, 3.7053709427636816, -1.9091250361691294, 8.473750269776385, -1.2134359076518177, 2.9772797805034914, 3.038908389891958, 3.495415326571468, 5.130106669367226, 2.494573474141441, 5.109313050343268, 4.115621943822743, -3.6253186751246336, -1.9902231858019526, -1.4536005386518398, 2.1284104611854264, 1.3141459166565768, -4.421549879428317, 3.177662229258381, -0.016852248201269848, -2.211733545387642, -2.4360205718026404, -1.5557921312674914, 6.538891384301998, -4.710049485967206, -6.975997591058964, -3.476114258195773, -0.17182233727609608, -0.12674427848586858, -3.3780890568021826, 5.6446541864407145, 1.6499069480521535, -2.6238958190224353, -6.394540948150402, 2.8158285426951495, -2.249770844962758, 4.945242266677864, 5.228150661641389, 7.28044350180941, -0.9505542893694063, -2.139412215278761, -2.125614475817787, -3.504867749570523, -1.4986443441814281, -4.3342782076992465, 1.1207668211937538, 3.0222332016254505, -9.292853193594384, 1.5244034579941572, 2.878695724077174, 3.3726909293237592, 2.844714406722881, 3.090692623829315, -4.746700433344305, -1.5708820705446696, 11.709189992460823, 13.024965973385292, 6.788347013361845, 0.8380545107369887, 1.6818005432102516, -0.06151894622143217, 5.0729180231177, 5.565815142693655, 0.5413019162106872, -2.4324820819491495, -5.662973728537967, 2.5895164171526353, -7.708772608612188, -4.8226463841538925, -2.6372182866909264, -1.5947439271464376], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.321603558888658, -4.492660060397638, -7.976622119863774, -10.72554171636462, -12.827676860525932, -14.770354101174165, -6.041498861635976, -4.918263630260323, -12.325416596193298, -14.705038976870016, -16.96217739686185, -8.577923993628858, -7.526673781080134, -14.610675988443418, -7.919639901571226, -6.027549007837112, -12.253986087989768, -8.76026340154945, -8.30989537074255, -11.172896124156953, -8.720361019442738, -12.10767837027465, -19.652398872349362, -9.033851984363457, -16.080182225437824, -11.51020500411204, -7.898251723833833, -15.115466143745065, -15.939447738950742, -10.167192724894786, -14.718550994302902, -22.123564300659506, -20.70280346762318, -11.096138553628002, -17.842423916729743, -10.228009516341865, -13.96159450448537, -16.082591710823575, -9.79703025862535, -9.865308173544944, -8.835586335102656, -6.759874975434554, -19.89003873788426, -8.294033744041423, -13.029255480717964, -14.884412438452449, -11.260123485351002, -5.568457824051842, -28.33980933103241, -15.300749970987171, -9.48002621936655, -10.20033368638132, -12.000924893423374, -12.442380132670852, -17.905221428183882, -3.1100772004528245, -17.96376810622168, -7.594809595629021, -7.977281509450444, -11.885161847136573, -13.1014557119045, -8.949434637059824, -13.740033472122539, -8.840574660243004, -12.822573430314831, -9.956617406520998, -13.563077314110037, -13.64834980698532, -8.910422654886919, -12.40267403171755, -10.638272358784896, -14.07864733285501, -15.042205893955634, -9.646982499353777, -11.438136278477172, -9.316234566730506, -7.301101851943036, -11.3919872596429, -3.5396404923785916, -7.113709761461311, -12.483326036766679, -8.292516992696996, -11.329934045044256, -6.59677789851775, -5.262191259964217, -6.7524031373096625, -4.655793508429631, -13.72102265906508, -18.489137989763268, -22.625020235060546, -4.400068367901854, -9.214312577840964, -8.593651940222005, -10.060255053475439, -11.939788584520986, -8.220735729020255, -6.286029250627804, -10.539435454331212, -18.56568099307685, -6.586167599788155, -12.62546622046681, -11.54453204932303, -20.73417832273026, -15.835289055828904, -8.389414552684718, -9.420823922820201, -6.600624835812129, -10.002149423302557, -10.496919758245586, -6.311484801245896, -10.757812929230855, -10.903433283785395, -11.256948938703134, -6.612438856868019, -8.695473802311291, -6.768835390431414, -12.147282137828917, -11.450052049617284, -10.216922853234005, -18.62418066735355, -18.75788109438358, -15.218106748565031, -9.533316548974366, -13.77108198527468, -7.471622504048863, -16.182230707585504, -19.593083480788167, -9.34932771537473, -4.908580370665959, -7.708890630004587, -8.078676239220886, -11.732944545618466, -9.36228758154638, -7.529120400045205, -9.771147129528513], "policy_policy_agent__reward": [11.096134007548457, 11.096134007548457, 2.1627906825189367, 2.1627906825189367, 5.209733051105814, 5.209733051105814, 5.721574626977335, 5.721574626977335, 6.527156247192303, 6.527156247192303, 10.019515464606492, 10.019515464606492, 1.1847657839057177, 1.1847657839057177, 0.5194479387349711, 0.5194479387349711, 9.996159208890457, 9.996159208890457, 11.195126898946251, 11.195126898946251, 11.761104457414245, 11.761104457414245, 5.818913761259417, 5.818913761259417, 2.7583040917241344, 2.7583040917241344, 8.409426240714197, 8.409426240714197, 4.048643240865531, 4.048643240865531, 1.408225602402173, 1.408225602402173, 8.824015372899114, 8.824015372899114, 4.04975703196586, 4.04975703196586, 5.916288092450203, 5.916288092450203, 7.308047822416538, 7.308047822416538, 0.8566895520753337, 0.8566895520753337, 9.198340391826456, 9.198340391826456, 5.781256537200333, 5.781256537200333, -0.22280164111751605, -0.22280164111751605, 8.127982064459962, 8.127982064459962, 8.121877920394986, 8.121877920394986, -2.0578688374669136, -2.0578688374669136, 8.934760099518702, 8.934760099518702, 4.629026228519287, 4.629026228519287, 5.970089045548503, 5.970089045548503, 4.906140149088609, 4.906140149088609, 10.467803343866972, 10.467803343866972, 18.431923697627173, 18.431923697627173, 7.1082834454374195, 7.1082834454374195, 9.078756061268196, 9.078756061268196, 7.67502045674003, 7.67502045674003, 6.257348711095226, 6.257348711095226, 9.31272923434755, 9.31272923434755, 6.012416913323993, 6.012416913323993, 2.9377378630054682, 2.9377378630054682, 5.6071143275712725, 5.6071143275712725, 2.0717183588816033, 2.0717183588816033, 10.29391299218342, 10.29391299218342, 4.272708047676887, 4.272708047676887, 2.705555628779518, 2.705555628779518, 3.6011272536214545, 3.6011272536214545, 7.743269032581139, 7.743269032581139, 3.1130399638331436, 3.1130399638331436, 17.4037705481535, 17.4037705481535, 12.452093061371503, 12.452093061371503, 1.6898712088718457, 1.6898712088718457, 7.8084824013090115, 7.8084824013090115, 7.139622370357368, 7.139622370357368, 4.5809669690133035, 4.5809669690133035, 10.825142947848258, 10.825142947848258, -1.211522086600804, -1.211522086600804, 7.520951948209926, 7.520951948209926, 1.4608489122883312, 1.4608489122883312, 5.449813226669232, 5.449813226669232, 3.9324578808525414, 3.9324578808525414, 5.820377260477608, 5.820377260477608, -0.38814729643180407, -0.38814729643180407, 8.015838736655972, 8.015838736655972, 6.8557942482284275, 6.8557942482284275, 6.641122243456884, 6.641122243456884, 6.83099417464234, 6.83099417464234, 5.826976138970453, 5.826976138970453, 11.061050038380857, 11.061050038380857, 3.8484933736175497, 3.8484933736175497, 7.68997690611052, 7.68997690611052, 6.8385903743384295, 6.8385903743384295, 8.787031329713235, 8.787031329713235, 10.086156281661433, 10.086156281661433, 6.070777986747609, 6.070777986747609, 8.273724664410219, 8.273724664410219, 6.715928255276626, 6.715928255276626, 1.8378915884092013, 1.8378915884092013, 4.700882036920474, 4.700882036920474, 1.0430199768633766, 1.0430199768633766, 4.62106011132337, 4.62106011132337, 6.898735976711629, 6.898735976711629, 1.935483556634341, 1.935483556634341, 7.253798137151319, 7.253798137151319, 3.2899628251582396, 3.2899628251582396, 1.5252288572882868, 1.5252288572882868, 2.15819128275351, 2.15819128275351, 1.550000688581071, 1.550000688581071, 10.129957021683534, 10.129957021683534, 6.889544251898029, 6.889544251898029, 7.824511322000792, 7.824511322000792, 0.46197705485304064, 0.46197705485304064, 4.521245120282434, 4.521245120282434, 4.233453830868069, 4.233453830868069, 3.3410829983366295, 3.3410829983366295, 8.79222138548085, 8.79222138548085, 4.935321338536206, 4.935321338536206, 1.8310667158026837, 1.8310667158026837, 2.0724472530904032, 2.0724472530904032, 10.690754767885998, 10.690754767885998, 2.168198377412699, 2.168198377412699, 8.785354243572334, 8.785354243572334, 8.386341355482209, 8.386341355482209, 14.007310912269832, 14.007310912269832, 7.442367383229751, 7.442367383229751, 3.125001168702979, 3.125001168702979, 3.647604723501207, 3.647604723501207, 1.547878543120801, 1.547878543120801, 4.251752539560564, 4.251752539560564, 3.08132077527317, 3.08132077527317, 3.716125811219824, 3.716125811219824, 6.890023065428151, 6.890023065428151, 0.805290045095505, 0.805290045095505, 6.390676198348646, 6.390676198348646, 4.745567290472596, 4.745567290472596, 6.034082365817523, 6.034082365817523, 4.806774898577148, 4.806774898577148, 7.618987380829111, 7.618987380829111, 3.3516758081364886, 3.3516758081364886, 4.323020391344669, 4.323020391344669, 15.166685329907187, 15.166685329907187, 15.891423533884435, 15.891423533884435, 11.003226880963437, 11.003226880963437, 5.185685529855676, 5.185685529855676, 7.726441264242467, 7.726441264242467, 3.705051778913715, 3.705051778913715, 10.627574365351608, 10.627574365351608, 12.579449311740913, 12.579449311740913, 4.945314815792709, 4.945314815792709, 1.2380491443584059, 1.2380491443584059, 1.02295845073331, 1.02295845073331, 5.33409632818676, 5.33409632818676, 2.01208596850314, 2.01208596850314, 2.269820598696245, 2.269820598696245, 2.4459510566771394, 2.4459510566771394, 4.088201601191038, 4.088201601191038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27925373427306277, "mean_inference_ms": 2.1016593462925206, "mean_action_processing_ms": 0.09597859552667463, "mean_env_wait_ms": 0.5783317843897772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 256500, "timesteps_this_iter": 0, "agent_timesteps_total": 769500, "timers": {"sample_time_ms": 13632.134, "sample_throughput": 247.577, "load_time_ms": 0.2, "load_throughput": 16902419.104, "learn_time_ms": 1902.862, "learn_throughput": 1773.644, "update_time_ms": 24.74}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005000000000000001, "total_loss": 12.462946796417237, "policy_loss": 0.007511810678988695, "vf_loss": 12.462929344177246, "vf_explained_var": 0.040435421466827395, "kl": 0.0025501244428135506, "entropy": 0.749450957775116, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.9041477143764496, "policy_loss": -0.00898222231771797, "vf_loss": 1.9203469932079316, "vf_explained_var": 0.6565754383802413, "kl": 0.006353632837636203, "entropy": 0.7217317193746566, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256500, "num_agent_steps_sampled": 769500, "num_steps_trained": 256500, "num_agent_steps_trained": 769500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10260, "training_iteration": 76, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-25-07", "timestamp": 1706106307, "time_this_iter_s": 12.98347020149231, "time_total_s": 926.0999910831451, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D72E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 926.0999910831451, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 36.01176470588236, "ram_util_percent": 73.41764705882353, "gpu_util_percent0": 0.05764705882352942, "vram_util_percent0": 0.21174172794117646}}
{"episode_reward_max": 15.829304895086436, "episode_reward_min": -13.357258335356866, "episode_reward_mean": 0.7662157554131254, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.215616162142148, "policy_agent_": -2.273996898879052}, "policy_reward_max": {"policy_adversary_": -5.025028259840819, "policy_agent_": 19.412416154474904}, "policy_reward_mean": {"policy_adversary_": -11.567041027153943, "policy_agent_": 6.166628391283535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1137771376932872, 1.5367129103323516, -1.4761085918215748, 4.681191406810523, -2.170210991839558, 1.1270579269563894, -8.248436992889147, 6.886286859157986, -4.557283584548678, -0.7823700395860786, 3.8115338406082624, 1.4735534739362703, -5.833860900601191, 4.706991985045262, 9.967024517868639, 6.772876001360535, 5.417009136420908, -13.357258335356866, 2.5409377592638003, 7.048852250831774, 7.785640400948128, -0.7265855563014683, -2.485127111404973, -3.845759181315803, 1.4068210523930182, 4.495332966706393, -2.540639386877066, 0.6276077136964389, -4.388437701110988, 2.332077007080722, 3.0927679531803416, 4.121580458468702, -5.107717758237092, 5.384128707245903, 8.809824386820639, -2.3840457982925947, -1.9192232859060763, 0.9141097798344308, -10.82769520845646, 4.7792644370012, 3.1757596135595016, 4.057139255510049, 3.3015691712188224, 4.674271035129038, 3.31220704028134, 1.3147171118243173, -1.9301115323904385, -3.584572630699211, -0.7707909632654035, -12.665398124549156, -2.536999316971241, 0.29424999854393485, 1.984851336543619, -4.568279542265405, -0.8074532150952677, 11.738006267365956, -1.5450055172483834, 5.695049150649065, -2.117188915131844, 0.5180280667378538, 6.327123972144903, 4.396177882362184, 1.473720776685899, 7.006670709080359, -2.9380394775545766, 2.603350741354979, -1.4388627032415318, 3.0973679328558457, 0.7166906463111402, -9.290757658571819, 1.7906978398923323, 5.556803792470322, -0.37206173422918276, -0.8253280053136772, 0.8047549225502192, -5.660659099034526, 1.1987871372702266, 5.962439246107517, -9.473935629797388, 1.4295410561323085, 1.1927044831021976, -7.669319048454311, 7.073623557270676, -4.531065995559104, 7.140138059493921, -0.5450411719765127, -4.2031997984065415, 3.8298877233311024, -0.7245083241045229, -1.246464216292256, 1.4879007009688003, -1.4935576474410075, 6.534071955625615, -0.5977699763016876, 4.380741417498333, 3.1403524254188997, 0.16967793260187158, 1.1016159623929247, -3.068941337309844, -4.085429311332123, -1.062260527874642, -0.5597804490614378, 3.1920269421047633, -3.1651212466294303, 3.7128124189306013, -8.860377908086653, -5.7999295431422455, -6.4394776717562126, -0.8613857742655129, -1.3545324473329994, 7.431221800853355, 2.403845022482197, 1.1193171016650676, 2.850096604393585, 1.680878090700873, 3.415766773108312, -1.3728922809203312, 1.6630211538700048, 4.507257958035643, 2.6021156298755233, -4.446347701239792, -2.2802025435433926, 3.7476372507292597, 8.387248583786365, 2.7955115571902867, 2.856687388420243, 8.186578004433187, 1.800066806753327, -0.9076641284526303, -4.15573272649284, 2.171715983879751, 4.171160282936935, 15.829304895086436, -2.1703059959675626, 1.3787200034364795], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.448160536686363, -10.61873575922701, -5.670844046624853, -12.17345327361125, -5.55492183412095, -12.310601850841548, -22.643071093844444, -12.348058699449235, -10.302669271986103, -5.025028259840819, -7.898656830512929, -6.82790797324097, -6.386567141077622, -11.443426799391057, -16.45299763468662, -11.81234351871408, -14.462637837954835, -9.014348749322245, -11.916984738270994, -11.906371529534999, -15.419490378467582, -14.318057392936344, -9.387967309402594, -11.113042377058358, -10.2220849945832, -11.502171730947191, -7.892772098826198, -10.655949699949241, -13.981452503495408, -8.447807237929567, -10.82354909074246, -9.006946321837987, -13.931816014177, -10.586804195211391, -16.868944442367226, -8.896640474966544, -10.415813459141077, -6.63874204624974, -17.727455747804395, -12.239753220191261, -7.405219333424554, -10.582582282724337, -22.958101580888602, -16.70769679011748, -15.137619376775223, -6.75218448871197, -16.23081157137095, -7.057795076986486, -7.729513021358642, -8.117404326791046, -5.418272629050865, -9.714842082273364, -9.236214718245767, -5.677660244117712, -10.886596927079932, -18.140075798286908, -8.125253416995477, -23.631427927666532, -12.109386095027523, -7.459987475532311, -17.358266959576735, -11.385351458689973, -11.780753388862063, -15.518155438167692, -12.089999575043102, -13.86958835472612, -8.764864806741008, -13.486056765441619, -12.323119159186446, -15.31951245381026, -8.642186701876089, -12.842742438952602, -12.697204360898873, -7.8479136028800305, -11.688897512680168, -16.698611764332597, -7.523753503276737, -11.258930358333222, -27.215616162142148, -6.079513194601544, -10.928726448125435, -10.93452318458137, -15.187762376511579, -18.510926871763193, -16.831851737700386, -11.640040228496522, -14.596569340602874, -8.906677434193806, -13.671328568274001, -5.886633930627832, -8.982279398178068, -11.335579627304908, -10.890599430408452, -6.263445867129362, -12.168659342715934, -15.267865496921223, -13.355606142580447, -5.339095787905819, -6.140768245633896, -6.727441806793761, -13.698949451408057, -11.897153569046955, -13.754711185635271, -12.478206021187203, -12.414936909732965, -15.965247797451644, -13.776620664944843, -18.404069080614835, -7.475882025832819, -8.310019518563054, -12.551295981981102, -9.87391129102347, -9.205766257329778, -13.687576128692285, -8.007914437738131, -11.748887771446611, -12.776315538790941, -6.451227824909451, -7.282021170349579, -6.811864394778004, -6.9277794722032064, -15.98223337035888, -11.815779264847034, -18.320744113229182, -11.452066927411336, -10.580499095349348, -13.396337736155182, -12.298611253567548, -8.912549547862687, -7.474753707736004, -13.571493901821402, -11.758458382390828, -22.995527413863382, -8.514995401285132, -8.645019550927005], "policy_policy_agent__reward": [6.280968837189823, 6.280968837189823, 6.077724334779679, 6.077724334779679, 2.0973677274016387, 2.0973677274016387, 8.427322340210889, 8.427322340210889, 1.692355421140696, 1.692355421140696, 6.718829888898969, 6.718829888898969, 7.19731705047765, 7.19731705047765, 9.617172779303612, 9.617172779303612, 2.8726928437187125, 2.8726928437187125, 2.1213291101273706, 2.1213291101273706, 5.855095335560597, 5.855095335560597, 4.15073072358862, 4.15073072358862, 0.27635312023821745, 0.27635312023821745, 8.075209392218161, 8.075209392218161, 13.210011076277631, 13.210011076277631, 9.292609760037307, 9.292609760037307, 9.939823487187873, 9.939823487187873, -2.1714547930173085, -2.1714547930173085, 7.228961248767395, 7.228961248767395, 9.477611890183383, 9.477611890183383, 11.602565389707856, 11.602565389707856, 6.795735918317437, 6.795735918317437, 3.451420098998813, 3.451420098998813, 3.6336415978712764, 3.6336415978712764, 5.8144530234881096, 5.8144530234881096, 7.998752348826792, 7.998752348826792, 2.6760663559745668, 2.6760663559745668, 5.64177870682284, 5.64177870682284, 4.796507401192207, 4.796507401192207, 5.389942122505143, 5.389942122505143, 6.958158521961399, 6.958158521961399, 6.564263390153344, 6.564263390153344, 4.4120491279699525, 4.4120491279699525, 7.985466451228647, 7.985466451228647, 12.839384414593933, 12.839384414593933, 3.256297338336976, 3.256297338336976, 4.2482950866174995, 4.2482950866174995, 3.7764259130420856, 3.7764259130420856, 3.4498802696739705, 3.4498802696739705, 8.509508828596234, 8.509508828596234, 5.29048947349203, 5.29048947349203, 7.319860769117193, 7.319860769117193, 13.129835376053709, 13.129835376053709, 10.690983912623256, 10.690983912623256, 9.224913208528282, 9.224913208528282, 4.033450800268143, 4.033450800268143, 7.150350019490256, 7.150350019490256, 1.7366112231436344, 1.7366112231436344, 3.4793610290466206, 3.4793610290466206, -2.273996898879052, -2.273996898879052, 1.4406366560398134, 1.4406366560398134, 5.004546040408648, 5.004546040408648, 5.610533027394693, 5.610533027394693, 0.5546903509261557, 0.5546903509261557, 5.039571855992331, 5.039571855992331, 14.93904103282643, 14.93904103282643, 3.290123949873548, 3.290123949873548, 14.663238539157803, 14.663238539157803, 4.996098589947838, 4.996098589947838, 3.989007771135082, 3.989007771135082, 11.842695465860817, 11.842695465860817, 7.89076467052608, 7.89076467052608, 6.6272370827739815, 6.6272370827739815, 11.26241307362403, 11.26241307362403, 4.575980048744259, 4.575980048744259, 8.23646954804055, 8.23646954804055, 3.6630010517497396, 3.6630010517497396, 8.291712349148728, 8.291712349148728, 6.5199049027487925, 6.5199049027487925, 3.0143773976192225, 3.0143773976192225, 5.216442270884211, 5.216442270884211, 9.199773115711464, 9.199773115711464, 6.1625713133348485, 6.1625713133348485, 3.511292798783177, 3.511292798783177, 6.246826217615196, 6.246826217615196, 5.518976332649037, 5.518976332649037, 4.361270320273482, 4.361270320273482, 8.61068480222037, 8.61068480222037, 8.870840266172388, 8.870840266172388, 3.7545271253669252, 3.7545271253669252, 6.060715465613818, 6.060715465613818, 1.632602068063528, 1.632602068063528, 11.130692966891129, 11.130692966891129, 6.989930438102049, 6.989930438102049, 11.985994898597156, 11.985994898597156, 5.547499528260006, 5.547499528260006, 5.196684771098166, 5.196684771098166, 6.3682825787624555, 6.3682825787624555, 6.473410122084738, 6.473410122084738, 2.3200848571677883, 2.3200848571677883, 5.235090049573434, 5.235090049573434, 4.921010989931951, 4.921010989931951, 8.712335693017033, 8.712335693017033, 2.8328379454138384, 2.8328379454138384, 8.274700380107134, 8.274700380107134, 9.204108961170059, 9.204108961170059, 6.762642037591157, 6.762642037591157, 3.2203558751493713, 3.2203558751493713, 1.535913454162024, 1.535913454162024, 1.3210062477308204, 1.3210062477308204, 6.318344461766708, 6.318344461766708, 5.668686559992756, 5.668686559992756, 8.47336906387002, 8.47336906387002, 4.656542387278885, 4.656542387278885, 8.063874664331784, 8.063874664331784, 3.5524349446824983, 3.5524349446824983, 3.9883455609013003, 3.9883455609013003, 5.982295704429304, 5.982295704429304, 3.307248125783653, 3.307248125783653, 3.4777435356150277, 3.4777435356150277, 9.991258891417228, 9.991258891417228, 6.138878156752831, 6.138878156752831, 5.162541679497423, 5.162541679497423, 8.268836366542939, 8.268836366542939, 4.844396264219503, 4.844396264219503, 7.582327272277463, 7.582327272277463, 5.701711628935308, 5.701711628935308, 4.057124489389729, 4.057124489389729, 5.894639564192612, 5.894639564192612, 4.706990012326764, 4.706990012326764, 1.2407158854817069, 1.2407158854817069, 6.851015413407743, 6.851015413407743, 7.781708257788145, 7.781708257788145, 13.353996348507778, 13.353996348507778, 7.123789242300813, 7.123789242300813, 6.718593241884796, 6.718593241884796, 10.791457870294183, 10.791457870294183, 7.0493390301604375, 7.0493390301604375, 4.00244270970503, 4.00244270970503, 1.659510490621583, 1.659510490621583, 7.871604942850578, 7.871604942850578, 7.96480933266388, 7.96480933266388, 19.412416154474904, 19.412416154474904, 3.1723447026587843, 3.1723447026587843, 5.011869777181743, 5.011869777181743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792264357204848, "mean_inference_ms": 2.1036862583929254, "mean_action_processing_ms": 0.09610471699629779, "mean_env_wait_ms": 0.5786646605253538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 259875, "timesteps_this_iter": 0, "agent_timesteps_total": 779625, "timers": {"sample_time_ms": 13690.413, "sample_throughput": 246.523, "load_time_ms": 0.1, "load_throughput": 33833116.635, "learn_time_ms": 1884.986, "learn_throughput": 1790.464, "update_time_ms": 23.943}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 11.73281135559082, "policy_loss": -0.004614443503669463, "vf_loss": 11.744894981384277, "vf_explained_var": 0.045134502649307254, "kl": 0.005475701910598108, "entropy": 0.7469260215759277, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.6186015963554383, "policy_loss": 0.012068356992676854, "vf_loss": 1.6136533856391906, "vf_explained_var": 0.6560791254043579, "kl": 0.005599614461794302, "entropy": 0.7120417863130569, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 259875, "num_agent_steps_sampled": 779625, "num_steps_trained": 259875, "num_agent_steps_trained": 779625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10395, "training_iteration": 77, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-25-20", "timestamp": 1706106320, "time_this_iter_s": 12.871896266937256, "time_total_s": 938.9718873500824, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 938.9718873500824, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 33.98125, "ram_util_percent": 73.08749999999999, "gpu_util_percent0": 0.069375, "vram_util_percent0": 0.21142578125}}
{"episode_reward_max": 17.008542735467298, "episode_reward_min": -12.096281048501318, "episode_reward_mean": 1.2992650891652568, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.6259478100776, "policy_agent_": -0.7481828281596424}, "policy_reward_max": {"policy_adversary_": -4.038696038116068, "policy_agent_": 21.09512575376699}, "policy_reward_mean": {"policy_adversary_": -11.618203402726467, "policy_agent_": 6.458734245945862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.524357633198674, -1.3821659748533839, 3.472456696622146, 1.9360267558036057, 7.7921014717331785, 1.320628157993344, 5.747908156146952, 0.6931670268807741, 1.25109665744301, 8.507786308089015, 7.006054148005706, -4.365442752525726, 7.935721435150572, 6.447832141977165, -1.2137967837510721, 12.694835499825725, 0.22447258495482728, -0.8992220886573485, 3.3076440615869562, -6.6970561679965845, 9.282897928149042, -1.9802792252510768, -2.1737912543874374, 2.75316560717854, 6.400221444226105, -4.98030248624088, 3.527110665427693, 3.685683346007628, 4.916226189594498, 5.206628624680519, -6.139700663759709, 0.7035193327790995, 1.9890660245934135, 4.734159083048992, 12.575989269480024, 1.0963713574201526, 3.851293364343926, -7.690230402724353, -3.3730046704799452, 8.908456151667405, 10.152225016379559, 8.988334750924512, -3.910925803003834, -0.06980484949586932, -1.8493083283097569, -5.568960878777242, -3.2777375017959494, 5.271994630117519, -0.3955213756987675, 0.39699555562117195, -3.989925115392505, 2.443417430439957, 0.7690119020962911, -2.6499770765089594, 5.802954163864632, -4.491888072666317, -0.8087194309840887, -10.39747831248885, 17.008542735467298, 4.516314354205847, 6.098472954120298, 7.020983782617256, -11.59147747450253, -5.464982547118311, -4.50933532830223, 3.5784688945408845, -0.5623621273267208, -6.637966665088255, 7.633198277672573, -3.0470924830151915, 3.630366871309566, 0.7102497302585005, -9.83945968984898, 4.3810569668603, -5.071325364604385, 5.99762966758567, 0.009593215494064222, 13.146356895183327, 0.7822018604253771, 3.221315639965523, 4.971897886455945, 9.361673357089982, -0.4808760250173614, 1.9740560930951485, -0.9421320038531298, -2.3523633581501073, 0.08458987254603399, 6.90536584377047, 16.673604262465467, -9.056518505154846, 2.7449235541434818, 2.5092992484976993, -3.2248916172557953, 1.8272626293223322, 0.736630848636826, 4.790906710782872, 10.816432824625394, -1.5518063947571659, -0.1594840046138581, -3.8762725634851782, -12.096281048501318, 2.066989391256525, 12.123581409244917, -0.3196260667425517, -3.5773964659991093, 0.25152282318372016, -6.403463347732805, -4.310849783841157, -2.6909776627663127, 5.582621723298693, 10.024519576197894, -3.193136408604218, 5.823844433877375, -9.444061858912933, -9.563712045176228, 0.7007409081571971, -3.0113600681734587, 1.3148393857713718, -5.33726478638752, 1.2016211666150511, 6.5392029520804105, 0.22395049721332871, 2.2939980326350016, 6.053309806563812, -5.816127319423371, 4.264687511613244, -1.9116747971957206, 1.7188223244723662, -4.544742372533256, 3.266720000067944, -0.39848104533713596, 8.485517190734866, -0.3859799940041754, 2.1066449283885453, 4.587167864521941], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.256970247103887, -4.42257848765487, -8.84900455779148, -14.380761433443018, -14.508305188606858, -10.967521439725362, -11.51642156909922, -4.701001960769619, -23.504313829410183, -15.341429275275567, -11.405162756693882, -14.157740669907529, -13.685771884111544, -14.198956428539772, -10.49114664526199, -19.097309896305838, -7.814562311709537, -5.640599886686199, -8.07133423917739, -7.030421272655343, -16.435039266621246, -15.47676143057735, -13.890729961941918, -8.503457800394115, -16.306265885428264, -4.096138119666325, -27.6259478100776, -10.09446454179803, -13.323265456677419, -11.373261449658514, -7.471214580082605, -6.954088422976335, -7.395428544371959, -9.96987052600721, -17.180371213294023, -15.522932594458448, -14.344455257031736, -13.197950377159122, -15.256536841216356, -16.475619157022315, -14.213775760561097, -14.53102785177554, -9.15251573900335, -13.995033346179772, -6.007496420389096, -17.404901719870388, -8.98962524410315, -14.799253351875798, -7.885432765579763, -12.72243797294163, -6.276694306678869, -6.895353439005122, -6.922435511210928, -6.06349782072324, -12.90056834206695, -8.225218209785721, -5.964776643137833, -10.451895906329666, -25.181708772066674, -12.205281811748, -11.03981770455348, -12.417273418590483, -14.725332033274945, -8.997614043039162, -7.490946727718791, -12.7191047727374, -8.709734150362072, -14.64132868315492, -12.888569107220082, -7.464059414166434, -7.9972499458847786, -9.335352215173703, -15.858853360315326, -9.607083127544058, -15.977592138770248, -18.64750011158728, -5.113042307064133, -25.40417556613341, -9.48762038228797, -12.13638591258999, -14.487943541015627, -16.010489551567, -11.237871644587916, -5.356016816142058, -8.344004165347481, -14.875424928318811, -5.988126850350964, -12.841824616475915, -23.807953438487008, -7.560152848835565, -8.608055883106996, -6.497859363182206, -8.928918082842477, -6.646893909008486, -11.474946093297435, -9.352740167530149, -14.322757649185546, -7.4760973440100535, -9.194409337229647, -4.038696038116068, -12.174192051838334, -13.866918933798425, -19.601197829846605, -11.335435549628828, -19.966528296205233, -5.8782846829554884, -5.825074733376854, -12.473869537195853, -4.8588257956669585, -12.263803962820223, -19.43036208357725, -9.889344401284628, -9.594612316662463, -14.960701517861763, -12.64879545139353, -8.23213030930649, -10.63060131527901, -11.429015920024673, -10.652907725289658, -6.798759740419139, -13.33010607263174, -6.721533183546698, -10.094605898851448, -18.17927686574328, -17.36076817484383, -12.365425348007468, -9.903171045016421, -8.286988575787596, -7.226653663710512, -13.313565502202698, -9.318914679345163, -14.545279054556351, -10.920290293488048, -8.324285053437587, -13.621372260244131], "policy_policy_agent__reward": [8.39066394015128, 8.39066394015128, 1.5202062564007432, 1.5202062564007432, 6.160730627206812, 6.160730627206812, 8.158394094623315, 8.158394094623315, 11.150203330170017, 11.150203330170017, 6.144074798859352, 6.144074798859352, 8.632164862623084, 8.632164862623084, 2.6970844938251965, 2.6970844938251965, 12.377705243426604, 12.377705243426604, 11.924607791682288, 11.924607791682288, 9.20560845234979, 9.20560845234979, 4.8961489586909, 4.8961489586909, 10.810746659631057, 10.810746659631057, 10.323394285258464, 10.323394285258464, 4.638674930755459, 4.638674930755459, 15.896072698065783, 15.896072698065783, 4.019517448332181, 4.019517448332181, 2.3706888990144264, 2.3706888990144264, 5.689489150382172, 5.689489150382172, 0.16668255232937923, 0.16668255232937923, 12.858968597385145, 12.858968597385145, 6.748241102663135, 6.748241102663135, 5.858469353777241, 5.858469353777241, 5.628311703786329, 5.628311703786329, 11.353243664827184, 11.353243664827184, -0.44208218328727805, -0.44208218328727805, 15.576529237752649, 15.576529237752649, 6.890073943902829, 6.890073943902829, 9.119745823135961, 9.119745823135961, 8.289945037169517, 8.289945037169517, 0.6657569581614464, 0.6657569581614464, 3.8288038778777187, 3.8288038778777187, 4.6922472844826855, 4.6922472844826855, 7.352014804528098, 7.352014804528098, 14.878180241387023, 14.878180241387023, 8.3096519759393, 8.3096519759393, 9.097874310687827, 9.097874310687827, 2.753859987217385, 2.753859987217385, 5.941766085368206, 5.941766085368206, 12.692037654344858, 12.692037654344858, 12.183000388470328, 12.183000388470328, 11.759681301350026, 11.759681301350026, 2.620794967999758, 2.620794967999758, 6.962614248341952, 6.962614248341952, 2.079094046039669, 2.079094046039669, 5.917970420546575, 5.917970420546575, 2.8559438711535994, 2.8559438711535994, 10.035623990996658, 10.035623990996658, 3.744955694940498, 3.744955694940498, 6.5597167642814, 6.5597167642814, 1.143384595643181, 1.143384595643181, 4.669385434722541, 4.669385434722541, 3.845723706653609, 3.845723706653609, 1.7067603721071398, 1.7067603721071398, 9.351761252965789, 9.351761252965789, 1.8666650685597024, 1.8666650685597024, 2.5780286060768716, 2.5780286060768716, 0.027208796920404017, 0.027208796920404017, 21.09512575376699, 21.09512575376699, 8.360798082976924, 8.360798082976924, 8.569145329336889, 8.569145329336889, 9.719128600603872, 9.719128600603872, 1.5669272793862068, 1.5669272793862068, 1.7663157479604261, 1.7663157479604261, 1.4908056997082824, 1.4908056997082824, 8.14878683363914, 8.14878683363914, 4.073686011517675, 4.073686011517675, 4.001681009033337, 4.001681009033337, 10.26088369244633, 10.26088369244633, 2.208483465575619, 2.208483465575619, 5.813808408597172, 5.813808408597172, 5.0228009727161025, 5.0228009727161025, 3.009696835233173, 3.009696835233173, 6.99407004720218, 6.99407004720218, 5.453133387082928, 5.453133387082928, 12.322564889586479, 12.322564889586479, 2.5613177612790987, 2.5613177612790987, 19.275266230658374, 19.275266230658374, 5.134911121356673, 5.134911121356673, 7.678850776277756, 7.678850776277756, 9.729920713735789, 9.729920713735789, 12.686081454328495, 12.686081454328495, 5.3784978097852765, 5.3784978097852765, 3.6650364546186043, 3.6650364546186043, 3.7009360807471734, 3.7009360807471734, 6.261530785084353, 6.261530785084353, 3.0363583614484995, 3.0363583614484995, 9.873595230123192, 9.873595230123192, 20.24077885047624, 20.24077885047624, -0.7481828281596424, -0.7481828281596424, 5.676489718625241, 5.676489718625241, 4.503579305839954, 4.503579305839954, 2.8520132327933405, 2.8520132327933405, 4.2370782691654085, 4.2370782691654085, 6.105788470967131, 6.105788470967131, 7.071823439156512, 7.071823439156512, 12.569595236905469, 12.569595236905469, 2.962145474626443, 2.962145474626443, 4.517462666307893, 4.517462666307893, 0.08121173731544463, 0.08121173731544463, 0.03895550166850523, 0.03895550166850523, 7.9669541625274745, 7.9669541625274745, 15.86238961954576, 15.86238961954576, 5.507904741443137, 5.507904741443137, 8.194565915103059, 8.194565915103059, 3.0649037530696046, 3.0649037530696046, -0.28919430717797234, -0.28919430717797234, 4.081509876677352, 4.081509876677352, 1.0839240664503245, 1.0839240664503245, 8.923212843059458, 8.923212843059458, 14.727440829887575, 14.727440829887575, 3.348103996340207, 3.348103996340207, 7.709228375269917, 7.709228375269917, 2.7583198294744196, 2.7583198294744196, 1.5425417031086484, 1.5425417031086484, 4.466435608731843, 4.466435608731843, 3.809620623552775, 3.809620623552775, 6.371927652898021, 6.371927652898021, 2.657821469451068, 2.657821469451068, 4.000190453517097, 4.000190453517097, 9.934654512356072, 9.934654512356072, 3.4727418403800137, 3.4727418403800137, 6.194301965743223, 6.194301965743223, 12.116293336153547, 12.116293336153547, 5.772320427710229, 5.772320427710229, 8.315056429810356, 8.315056429810356, 3.99574812391035, 3.99574812391035, 5.0029054501299814, 5.0029054501299814, 1.3409556455886307, 1.3409556455886307, 8.290142751135322, 8.290142751135322, 4.460216817004016, 4.460216817004016, 11.515398122645605, 11.515398122645605, 5.267155149741935, 5.267155149741935, 5.215464990913066, 5.215464990913066, 9.104270062383032, 9.104270062383032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794017157218579, "mean_inference_ms": 2.104965858603941, "mean_action_processing_ms": 0.09613026984290145, "mean_env_wait_ms": 0.5790000966953357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 263250, "timesteps_this_iter": 0, "agent_timesteps_total": 789750, "timers": {"sample_time_ms": 13344.245, "sample_throughput": 252.918, "load_time_ms": 0.199, "load_throughput": 16918580.136, "learn_time_ms": 1861.234, "learn_throughput": 1813.313, "update_time_ms": 23.64}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 12.045654582977296, "policy_loss": -0.003423929546988802, "vf_loss": 12.056807231903075, "vf_explained_var": 0.09336470961570739, "kl": 0.005574983680175416, "entropy": 0.77290940284729, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.212316167354584, "policy_loss": 0.0015565959271043538, "vf_loss": 2.217826986312866, "vf_explained_var": 0.6468404501676559, "kl": 0.006909651288079461, "entropy": 0.7067804962396622, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 263250, "num_agent_steps_sampled": 789750, "num_steps_trained": 263250, "num_agent_steps_trained": 789750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10530, "training_iteration": 78, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-25-33", "timestamp": 1706106333, "time_this_iter_s": 12.68314814567566, "time_total_s": 951.655035495758, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D730D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 951.655035495758, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.05882352941177, "ram_util_percent": 73.09411764705882, "gpu_util_percent0": 0.36588235294117644, "vram_util_percent0": 0.21100930606617646}}
{"episode_reward_max": 15.34396506954227, "episode_reward_min": -12.442325380392305, "episode_reward_mean": 1.3804570742651647, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.673286063442884, "policy_agent_": -1.16537421724649}, "policy_reward_max": {"policy_adversary_": -4.144052751803654, "policy_agent_": 19.13778817047605}, "policy_reward_mean": {"policy_adversary_": -12.05672323316777, "policy_agent_": 6.718590153716467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.7571843515853622, 2.5357274382232093, -2.840649145585069, 9.67024362179327, -1.5094789436587353, 9.699091531539578, 4.187344548764551, 1.9920778518307163, 0.08465292831943097, -0.08293189042176963, 4.187439017846901, -3.7666575973934595, 7.044282586751403, 2.5105014404942, 8.224139518834818, 0.6330903862151555, -0.3414053564712714, 4.481364842700658, 5.472786010606105, 2.588292334677791, -8.257954563503622, -3.006880568550786, 3.967122930116369, -7.298380411564944, -5.220927469492891, 9.00423750766537, -6.946395639872694, 2.6930915164569336, -0.3836720713316757, -3.8706293278038064, 0.37169818986638475, -5.469830839272769, 11.522063308643672, -4.093523228909962, 6.133095440197263, 14.175404446137167, -0.3762650147673119, -1.0235990034093754, 0.5630839425224807, 4.270577299453476, -11.700837458385298, 2.9279169311402757, -12.249720189968466, 15.34396506954227, 8.11660922079673, -3.9344992955332194, -6.24156253193203, 5.899901103308775, 0.051816758095635684, 3.056692634581276, 9.364401042326492, 9.16622224701809, -5.071123163455718, 11.163046049727624, 0.9875014613736246, 0.3347758576627186, 1.3223918033193085, 9.11569125657304, 0.814865824946218, -2.1164418425882583, 8.697889849643985, -1.5875081010169836, 6.141700103896822, -4.029863533263578, -2.57777278452232, -10.067086764844314, 1.271958821030212, 8.0543115966816, 3.0351066912749416, 3.6606579968413135, -1.419502473650914, 3.246331915918236, 4.6816284125943515, 3.8640547948166932, 8.79540911409967, -10.443677188068264, 11.734926961423156, -4.777950481042831, 0.8715616370464812, -2.2968380342774357, -1.396862419461521, 15.17186225231278, 4.708496477972731, 5.47209415151769, -1.0240842389164715, -0.2887730428086588, 12.41518170279958, 3.64641379462465, -0.10875718777693422, 4.100034062373175, 4.872771272954823, -1.456265409396702, 1.0786562663297705, 2.1458993073165837, -0.7702120965404319, 7.074328385035724, 2.7268293266099546, 6.845025465818519, 5.8770457314762945, 0.2629892180885378, 1.6318642564984538, -12.442325380392305, -0.6807675898913226, 6.5973446376716165, 0.42027758272056515, 2.806896579112691, 3.0404688180998893, -1.723818420717369, -0.9032466246375279, -0.5890270041425851, 10.070356872494356, 2.3830334675787963, 1.4629727317839891, -10.360047941244309, -5.6641452017585525, -0.38857328519396295, -3.825606009080834, -0.16950706301007568, 3.309458640260174, 0.04209980961441284, -2.391762774430969, 5.705432448516017, 2.55861295075789, -4.319284200159696, 3.0931604631492813, 11.748602727104911, 4.321280880206732, -2.429459828770148, -5.926507157575436, 0.47827246067280904, 1.0494030479538783, 0.2559623894598768, -6.543442545394706, -9.241853876599674, -5.853457087551774], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.562646659067871, -6.818846978740363, -5.873396177909317, -17.094568816592634, -6.602723647143103, -18.025753492966516, -7.383795586937658, -6.568455413050998, -10.190966111000389, -5.106398542628202, -9.64006850969059, -12.80597833809619, -14.924318614902662, -9.135946571344695, -18.093945724750732, -9.637599017004293, -8.654537684287973, -8.863718494119865, -10.285141934969436, -7.97218033882798, -16.06793051897889, -10.915969923379338, -8.710901026672635, -14.630735516273722, -14.76336083367698, -26.673286063442884, -8.587453241288458, -15.574587569336984, -8.67868384698195, -10.28286204359831, -6.244269417119976, -11.916407735404924, -21.574433323180465, -13.784836052656662, -13.061733045673089, -24.100171894814924, -10.412520358094596, -9.579293703203788, -10.937244311524486, -7.93136833089369, -9.370089023892314, -10.97235510676447, -13.835278430469037, -19.64797660734658, -20.779225407926067, -18.327121504939043, -7.258898828099808, -15.638177979685638, -12.94275471187948, -21.207890862051972, -18.391232574248694, -22.152891075777415, -8.213823727477777, -17.739501453667124, -7.107085711924754, -8.60788194282616, -10.460979596550693, -14.870878405151549, -7.151576090745556, -9.903470347011869, -21.027036883307932, -6.924560564273709, -14.86532895213277, -14.107423869090178, -11.749985961705445, -20.924280458305095, -8.04854362542103, -19.10101422790626, -7.871565811341199, -9.791455923832144, -5.79733388606504, -9.225059199535982, -15.719698506307644, -7.900927648395532, -12.183515959358303, -20.00116609945842, -19.033907470184467, -15.293891206771818, -8.554959755678018, -9.190043503005604, -9.623599006844769, -20.85884516551365, -11.66391826830001, -13.338738653631635, -12.565844975207636, -14.585116345036287, -18.28171942776265, -9.317608680076114, -6.183514718027556, -12.297875842792342, -9.740245447267178, -11.3197501317037, -8.396885956129942, -9.652860833654003, -4.455599906314787, -11.096029068499721, -14.05423406954258, -14.582174127995929, -11.723309266404925, -13.518231050109451, -10.650670238494882, -11.753025974233983, -4.144052751803654, -18.752448685662504, -12.436964274449274, -7.822246254558884, -8.44048680843908, -6.702340349526402, -8.459876777633985, -7.089716712380976, -18.27798503428194, -6.817274174020033, -14.115378922086313, -15.79168317517595, -8.143372399372682, -13.178315528648778, -5.761662567592319, -10.842388361825977, -9.894610358346968, -13.312701821390434, -10.696185455108369, -12.515617153711217, -12.872876370029806, -9.072351586548496, -14.709570551639926, -21.218756761624206, -10.725557790662915, -13.404330963876042, -17.781067091539565, -5.687508159228914, -16.998611088217512, -6.351196931208401, -6.260128304748811, -11.619046162247393, -8.541705685776355], "policy_policy_agent__reward": [6.159915505326616, 6.159915505326616, 4.677287208481787, 4.677287208481787, 1.5163735161621248, 1.5163735161621248, 13.382406219192955, 13.382406219192955, 2.546622351742185, 2.546622351742185, 13.862422512253048, 13.862422512253048, 5.785570067851104, 5.785570067851104, 4.280266632440858, 4.280266632440858, 5.1378095196599105, 5.1378095196599105, 2.5117333261032164, 2.5117333261032164, 6.913753763768745, 6.913753763768745, 4.519660370351366, 4.519660370351366, 10.984300600827032, 10.984300600827032, 5.823224005919446, 5.823224005919446, 13.159042621792768, 13.159042621792768, 5.135344701609727, 5.135344701609727, 4.1565661639083515, 4.1565661639083515, 6.672541668410262, 6.672541668410262, 7.878963972787768, 7.878963972787768, 5.280236336752886, 5.280236336752886, 3.9049879777376337, 3.9049879777376337, 3.9545446774142743, 3.9545446774142743, 6.339011978394501, 6.339011978394501, 3.666177552354387, 3.666177552354387, 4.771216682092042, 4.771216682092042, 17.838761785554123, 17.838761785554123, 0.8205288007078829, 0.8205288007078829, 9.13383954289696, 9.13383954289696, 4.147505887825137, 4.147505887825137, 3.2061163578972502, 3.2061163578972502, 3.3079838034931806, 3.3079838034931806, 3.2232884480660764, 3.2232884480660764, 16.548248315912065, 16.548248315912065, 4.845656411873349, 4.845656411873349, 9.597414242935177, 9.597414242935177, 19.13778817047605, 19.13778817047605, 5.018127671663644, 5.018127671663644, 4.277847349897208, 4.277847349897208, 5.750164127023482, 5.750164127023482, 6.1009728151735825, 6.1009728151735825, -1.16537421724649, -1.16537421724649, 6.950136018952374, 6.950136018952374, 0.7927791202502839, 0.7927791202502839, 17.495970838444425, 17.495970838444425, 14.447917314361394, 14.447917314361394, 7.196311104702906, 7.196311104702906, 0.508668148083891, 0.508668148083891, 10.769039541497207, 10.769039541497207, 6.497285734987556, 6.497285734987556, 12.132291748316632, 12.132291748316632, 13.87781680828759, 13.87781680828759, 15.659556661397756, 15.659556661397756, 1.5713502820110283, 1.5713502820110283, 14.451273751697371, 14.451273751697371, 4.047293586649189, 4.047293586649189, 4.471328900244437, 4.471328900244437, 5.8916856999350005, 5.8916856999350005, 11.993284830862292, 11.993284830862292, 3.9832209578458864, 3.9832209578458864, 3.893514252211804, 3.893514252211804, 14.86246336647596, 14.86246336647596, 2.6685262316283627, 2.6685262316283627, 10.503514528014794, 10.503514528014794, 5.038780167913298, 5.038780167913298, 4.586106588591561, 4.586106588591561, 5.428596846730387, 5.428596846730387, 4.660251223225621, 4.660251223225621, 13.577662912293931, 13.577662912293931, 5.4533362513080705, 5.4533362513080705, 6.726056960336729, 6.726056960336729, 2.188915706207062, 2.188915706207062, 6.235695557727109, 6.235695557727109, 10.200663459450997, 10.200663459450997, 5.882491221606114, 5.882491221606114, 10.489462536728983, 10.489462536728983, 4.7787444556950796, 4.7787444556950796, 15.384417215803813, 15.384417215803813, 5.257970362864496, 5.257970362864496, 4.713260696362251, 4.713260696362251, 3.446602734364084, 3.446602734364084, 4.113368293691624, 4.113368293691624, 18.015353708913228, 18.015353708913228, 8.18620737313637, 8.18620737313637, 9.405416402574662, 9.405416402574662, 5.770880368145583, 5.770880368145583, 7.148171651113813, 7.148171651113813, 15.348450565281121, 15.348450565281121, 6.482011237350381, 6.482011237350381, 3.037378765125313, 3.037378765125313, 8.198954952582756, 8.198954952582756, 7.306508360111001, 7.306508360111001, 4.931742361153499, 4.931742361153499, 4.737771111229856, 4.737771111229856, 5.899380070485294, 5.899380070485294, 1.84269390488718, 1.84269390488718, 9.085178726767719, 9.085178726767719, 8.390531698076266, 8.390531698076266, 10.713599796907221, 10.713599796907221, 8.80017749894061, 8.80017749894061, 6.890610134098993, 6.890610134098993, 6.14126724749667, 6.14126724749667, -0.3446497030791649, -0.3446497030791649, 1.7316425809561644, 1.7316425809561644, 12.674896661667061, 12.674896661667061, 6.428620928584918, 6.428620928584918, 5.314571416835787, 5.314571416835787, 5.740477813269485, 5.740477813269485, 2.4892609644045156, 2.4892609644045156, 3.778315076498229, 3.778315076498229, 3.250344854119195, 3.250344854119195, 14.17417095338815, 14.17417095338815, 4.600153820799413, 4.600153820799413, 7.78917582693515, 7.78917582693515, 2.7158176169658246, 2.7158176169658246, 1.2396135988070618, 1.2396135988070618, 6.394871121727407, 6.394871121727407, 0.9680282792557443, 0.9680282792557443, 5.3364406494079475, 5.3364406494079475, 6.60203449930357, 6.60203449930357, 6.677400815502422, 6.677400815502422, 4.152211340338701, 4.152211340338701, 9.110524801113613, 9.110524801113613, 7.715744660393845, 7.715744660393845, 2.3765336931943977, 2.3765336931943977, 8.901365507394605, 8.901365507394605, 16.483679744364554, 16.483679744364554, 7.523419335434824, 7.523419335434824, 5.4874355675529465, 5.4874355675529465, 5.927279966982066, 5.927279966982066, 3.0828903099508613, 3.0828903099508613, 9.024007068085695, 9.024007068085695, 3.303579660334138, 3.303579660334138, -0.1416571203229468, -0.1416571203229468, 1.188596142823862, 1.188596142823862, 1.3441242991122888, 1.3441242991122888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279532190684253, "mean_inference_ms": 2.1074102144452995, "mean_action_processing_ms": 0.0962904409752521, "mean_env_wait_ms": 0.5795543897375223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 266625, "timesteps_this_iter": 0, "agent_timesteps_total": 799875, "timers": {"sample_time_ms": 13184.395, "sample_throughput": 255.984, "load_time_ms": 0.1, "load_throughput": 33841204.877, "learn_time_ms": 1868.709, "learn_throughput": 1806.06, "update_time_ms": 23.84}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.494264221191406, "policy_loss": 0.009080537315458059, "vf_loss": 13.492796707153321, "vf_explained_var": 0.07146461606025696, "kl": 0.003982991518730416, "entropy": 0.7613025486469269, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.189156138896942, "policy_loss": -0.01825982383452356, "vf_loss": 2.214450180530548, "vf_explained_var": 0.6814999133348465, "kl": 0.005551379898532788, "entropy": 0.703446426987648, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 266625, "num_agent_steps_sampled": 799875, "num_steps_trained": 266625, "num_agent_steps_trained": 799875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10665, "training_iteration": 79, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-25-46", "timestamp": 1706106346, "time_this_iter_s": 13.293549060821533, "time_total_s": 964.9485845565796, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D9E550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 964.9485845565796, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 38.44117647058823, "ram_util_percent": 73.25294117647059, "gpu_util_percent0": 0.15176470588235294, "vram_util_percent0": 0.2116986443014706}}
{"episode_reward_max": 20.438198568676427, "episode_reward_min": -13.273596384502007, "episode_reward_mean": 0.9429035084232487, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.039698586181157, "policy_agent_": 0.5709727791943474}, "policy_reward_max": {"policy_adversary_": -4.254818869176698, "policy_agent_": 24.238948577428786}, "policy_reward_mean": {"policy_adversary_": -12.394383921972912, "policy_agent_": 6.668643715198081}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.72638108422504, 0.8590221433724834, -2.657848110734985, 0.5350824985377343, -2.4027520995569764, 1.8965047558816917, 0.6616198235460444, -1.2775672856823626, -9.016362330137712, -5.010252328943289, -0.34513197027318526, 2.5160454427654986, 7.007867517257503, 6.825477564953127, 10.99793723780981, 0.31581532936415035, 2.5364602396611664, 8.984077847992216, 0.567059196696221, 2.573464608463659, -4.710649989545417, 4.042105567883109, 20.438198568676427, 1.0168981311095733, 1.9005613069175926, 7.4561691605511164, 1.8904604251171873, -0.8487597652713188, 7.09450879996576, 4.282161784815956, -6.3799569451579154, -5.787885439065821, -5.985530767419627, 1.3339886263911123, -8.168912172468596, 8.465853459112557, -4.700702262642835, 7.500097685863451, 0.5876656030919977, 2.6178687973424903, -5.6221393772334, -1.0841540468252433, 2.502145268555829, -4.588378143434103, 5.103215028246387, 0.05125635557506855, 1.7915768028601065, 0.2596337964833046, 1.645131759325262, 1.2114852790166075, 3.4089198827853284, 0.8191110760913576, 8.976327736899586, 3.0294521738224267, 4.972537420506081, -0.9204469327566016, 0.9778194869668437, 13.567581731778622, 1.3821181565367786, 2.2045502578544167, -4.518745525246141, 0.39825480774869887, 1.7973162965149445, 2.280910885468476, 10.012893797980503, 4.503532753387592, -6.526450094601554, 3.2135070114649515, 6.352210738073955, 1.793043683905687, 3.364940845065228, -0.6125623600030963, -11.045486576722924, -4.9894607748446544, 4.36223370738866, 0.0891001763883035, 8.76165422819785, 0.2900241727822525, -9.244125912364757, 3.1837039371974205, 1.4779423519053083, -0.8775918553980164, 1.0600177770208348, 1.4487971814558653, 1.2226213582908254, 8.259113768090668, 0.26362281803763926, 1.1818722010320584, 4.657241173972836, 5.115416599592737, 4.7418177275693205, 2.579618117694899, 2.21467169501468, -13.273596384502007, -2.7999240934940066, 2.820729313171966, -3.7798659849628122, -0.5967521879578115, 0.28654029395689673, -3.2913528719173786, 1.2291910127741439, -3.136523656159118, -5.668010187612738, 3.972013106598763, 1.038608026918529, 2.8412089181720535, -0.3099440894370371, -1.8894719757439051, 2.4319586308259864, -2.879933647975686, -2.6144423103742436, -8.756983246577338, -1.7242773322498497, -3.465043198962835, 3.0924165944465676, -3.047672647765274, 1.9972247488090282, -6.558167044537223, 0.07267615661922838, -4.005944247515704, 14.166316628154163, -3.547655830101204, 0.762712508469904, 5.380712338950422, -2.2115877754054307, -1.7304712654772296, 2.2043848153249552, -2.5120941835486104, -5.046619133180934, 2.5129606683544927, -1.707517019613665, -7.157796991490633, 8.010481317831163, 4.937243138593071, 5.409800560149579], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-22.781111975891026, -11.183169791472348, -16.821137414031064, -7.9394902647006145, -13.250758501110125, -8.027823706900723, -8.85725353612743, -6.620558705716374, -16.88366102711105, -6.1521978873319805, -6.894479110781689, -13.09617294450679, -11.800996286605704, -14.737367013420872, -17.53729049113116, -6.077838985795833, -13.092058607969484, -16.22725839804594, -10.233694212208086, -7.125626238138391, -7.415682781946853, -8.80475679188988, -28.039698586181157, -12.481243324358719, -11.158359198091127, -13.7192119602638, -11.287868361027364, -15.128762781882227, -15.399714563420583, -8.810615041476932, -13.117452592013532, -16.287106054623344, -11.061750698830016, -9.121288162529808, -14.951297253774957, -15.069907641681924, -10.856054122350335, -15.45856995214037, -11.1799770260194, -6.72888210128703, -24.574294437960447, -14.188447707179023, -6.374323817938342, -6.337985771424367, -15.656376633668543, -9.270381949125468, -16.70528054638568, -12.11511108150381, -16.469704675013705, -16.080259079542145, -9.182934827352371, -7.12696136431446, -16.966395145737046, -11.31036796097452, -13.755003216961635, -14.944151229458479, -4.254818869176698, -19.368648935348475, -10.871616053124676, -14.661125589795367, -24.00372090444171, -12.937654714786836, -9.54465070897194, -16.640010710430232, -23.615485053293916, -16.566164461560646, -13.899965983671406, -14.892778805400347, -17.416238690028553, -8.79804280754349, -12.304387296643444, -10.100993002700028, -12.4436634818454, -10.977600268137751, -10.2967145962556, -6.802907388816159, -15.004311644549711, -12.790464389517624, -19.255517726835357, -10.878021687698267, -5.2472357872198785, -8.266852474592087, -22.108746810084273, -7.925674124910315, -8.709347189907572, -20.786022578586522, -10.96441429865901, -7.286744603339581, -9.779701063875017, -13.027264366167273, -11.844430313379267, -6.617097191213669, -10.871096969799236, -25.374265888161368, -6.5011736344202635, -13.349695232930374, -10.350521061143198, -16.74085284331817, -8.131848388396914, -9.927800006980943, -9.716304467984157, -6.2380556817672606, -17.55601570309714, -10.400068952844427, -7.000574555386441, -9.48714315107375, -4.913552125324719, -10.92361719629731, -13.021065525320859, -5.201148627998657, -8.043048944380592, -17.54679646596432, -18.127147605532315, -14.839120775573992, -7.144284491005032, -11.010102962541154, -15.48200674217976, -12.022492371132753, -17.89634701158792, -14.328190671936625, -26.740651657762378, -8.659953634881097, -14.236805479646794, -10.087305977066938, -8.098375416202732, -10.080430949621356, -6.385482486145036, -7.7566756435126045, -7.939070583113909, -15.531035020554102, -8.93682709473505, -13.787507104468617, -14.658523858934325, -14.317142654635667, -10.51654573914852], "policy_policy_agent__reward": [17.25374653005803, 17.25374653005803, 6.021095967422419, 6.021095967422419, 7.081644651648035, 7.081644651648035, 4.237286381619175, 4.237286381619175, 5.424003200776575, 5.424003200776575, 4.962164231391207, 4.962164231391207, 4.759436679836738, 4.759436679836738, 2.671495710017007, 2.671495710017007, 3.933649348486671, 3.933649348486671, 0.5709727791943474, 0.5709727791943474, 3.2746735702542518, 3.2746735702542518, 7.806109193636145, 7.806109193636145, 9.404431901931602, 9.404431901931602, 10.781422289186997, 10.781422289186997, 14.267613864470482, 14.267613864470482, 3.196827157579993, 3.196827157579993, 7.8142594238153285, 7.8142594238153285, 12.605668123019077, 12.605668123019077, 5.400376704452153, 5.400376704452153, 4.8495454233010244, 4.8495454233010244, 1.3525163962007176, 1.3525163962007176, 6.423431179886492, 6.423431179886492, 24.238948577428786, 24.238948577428786, 6.749070727734147, 6.749070727734147, 6.529460252504362, 6.529460252504362, 10.587690560407458, 10.587690560407458, 6.589164393072271, 6.589164393072271, 7.140001508305454, 7.140001508305454, 11.247111681693172, 11.247111681693172, 6.546388413146444, 6.546388413146444, 3.3687478234278108, 3.3687478234278108, 5.249610307778759, 5.249610307778759, 2.538109965705197, 2.538109965705197, 5.2276383944604605, 5.2276383944604605, 3.39119254065318, 3.39119254065318, 11.767880550397244, 11.767880550397244, 3.0776759298537484, 3.0776759298537484, 11.479333819001907, 11.479333819001907, 5.883821314555698, 5.883821314555698, 4.673375449314761, 4.673375449314761, 9.47607753036352, 9.47607753036352, 6.5521468301768895, 6.5521468301768895, 4.438234543247086, 4.438234543247086, 0.8748038139951301, 0.8748038139951301, 10.379795830957468, 10.379795830957468, 4.660819152350269, 4.660819152350269, 9.248428674622891, 9.248428674622891, 6.187372438993557, 6.187372438993557, 9.057418217169486, 9.057418217169486, 8.64587217927938, 8.64587217927938, 6.29592735506885, 6.29592735506885, 3.9730362202029097, 3.9730362202029097, 12.971361441318317, 12.971361441318317, 7.1699100673984715, 7.1699100673984715, 9.363770318733858, 9.363770318733858, 7.011852148350938, 7.011852148350938, 2.6163191780717714, 2.6163191780717714, 16.46811533356355, 16.46811533356355, 6.126867104830727, 6.126867104830727, 8.432837923824893, 8.432837923824893, 9.742487689597782, 9.742487689597782, 6.667954761267768, 6.667954761267768, 5.670983502743441, 5.670983502743441, 9.46046079794936, 9.46046079794936, 16.814189425637206, 16.814189425637206, 10.534848607474121, 10.534848607474121, 3.6867579445349246, 3.6867579445349246, 9.053142908432644, 9.053142908432644, 11.884224714051255, 11.884224714051255, 5.295543245724589, 5.295543245724589, 7.834664070854337, 7.834664070854337, 4.744215321348465, 4.744215321348465, 0.6990884525612403, 0.6990884525612403, 2.9940697466465487, 2.9940697466465487, 7.3294741518221285, 7.3294741518221285, 3.446003782602231, 3.446003782602231, 11.882982936373779, 11.882982936373779, 6.5402442811499375, 6.5402442811499375, 5.005695907235298, 5.005695907235298, 7.030862812447844, 7.030862812447844, 3.3625890695625937, 3.3625890695625937, 3.694630309597035, 3.694630309597035, 11.584382293552551, 11.584382293552551, 4.687235653183092, 4.687235653183092, 4.965984274099198, 4.965984274099198, 14.522568173338597, 14.522568173338597, 5.614018558348325, 5.614018558348325, 4.2343084021858175, 4.2343084021858175, 7.218471118923922, 7.218471118923922, 9.071340482880005, 9.071340482880005, 8.293124020474291, 8.293124020474291, 4.598357654454283, 4.598357654454283, 6.542884332406956, 6.542884332406956, 6.050334751829678, 6.050334751829678, 1.8506247704631276, 1.8506247704631276, 8.085212273051168, 8.085212273051168, 3.2853275380901947, 3.2853275380901947, 8.072050327680177, 8.072050327680177, 4.209194341176905, 4.209194341176905, 3.3182235675317844, 3.3182235675317844, 5.47274774037915, 5.47274774037915, 1.5507660128040706, 1.5507660128040706, 5.9440027577422025, 5.9440027577422025, 7.186041029721593, 7.186041029721593, 4.0195912911524845, 4.0195912911524845, 6.164176034622902, 6.164176034622902, 2.3018040179438413, 2.3018040179438413, 4.517072610276702, 4.517072610276702, 7.726512078073421, 7.726512078073421, 1.1606074900114862, 1.1606074900114862, 2.7143033170031745, 2.7143033170031745, 4.394906609693499, 4.394906609693499, 8.201435136641232, 8.201435136641232, 5.68703878830558, 5.68703878830558, 5.118350542725798, 5.118350542725798, 3.98121515738794, 3.98121515738794, 8.739615745494394, 8.739615745494394, 2.732162663297765, 2.732162663297765, 8.984511584103581, 8.984511584103581, 5.161123212210459, 5.161123212210459, 20.453484142958274, 20.453484142958274, 2.5561489023899475, 2.5561489023899475, 7.499758994058351, 7.499758994058351, 7.73400915800868, 7.73400915800868, 2.943393820398651, 2.943393820398651, 4.174979842072062, 4.174979842072062, 4.294933650734995, 4.294933650734995, 2.622290729981997, 2.622290729981997, 1.4462257249664876, 1.4462257249664876, 9.021997844454297, 9.021997844454297, 3.614655037560693, 3.614655037560693, 3.314855056488991, 3.314855056488991, 11.33450258838274, 11.33450258838274, 9.627192896614368, 9.627192896614368, 7.963173149649048, 7.963173149649048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28017845384943285, "mean_inference_ms": 2.1128588660985965, "mean_action_processing_ms": 0.09656002431545785, "mean_env_wait_ms": 0.5808521514163909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 270000, "timesteps_this_iter": 0, "agent_timesteps_total": 810000, "timers": {"sample_time_ms": 13357.267, "sample_throughput": 252.671, "load_time_ms": 0.1, "load_throughput": 33841204.877, "learn_time_ms": 1868.263, "learn_throughput": 1806.49, "update_time_ms": 24.538}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 14.963594245910645, "policy_loss": -0.009433626104146242, "vf_loss": 14.980405521392822, "vf_explained_var": 0.058930253982543944, "kl": 0.005891181255691563, "entropy": 0.7378288507461548, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.1657993376255034, "policy_loss": -0.004492894932627678, "vf_loss": 2.1770873606204986, "vf_explained_var": 0.6756702244281769, "kl": 0.006017968099164775, "entropy": 0.6795383572578431, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 270000, "num_agent_steps_sampled": 810000, "num_steps_trained": 270000, "num_agent_steps_trained": 810000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10800, "training_iteration": 80, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-26-00", "timestamp": 1706106360, "time_this_iter_s": 14.283500909805298, "time_total_s": 979.2320854663849, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D72820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 979.2320854663849, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 44.75555555555556, "ram_util_percent": 73.45, "gpu_util_percent0": 0.06444444444444446, "vram_util_percent0": 0.21812608506944445}}
{"episode_reward_max": 12.15428394564473, "episode_reward_min": -20.1406439958264, "episode_reward_mean": 0.6604860667356246, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.097483654906814, "policy_agent_": -4.247905171448392}, "policy_reward_max": {"policy_adversary_": -4.360931610120137, "policy_agent_": 16.87702238386031}, "policy_reward_mean": {"policy_adversary_": -11.899670390879917, "policy_agent_": 6.2800782288077714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.44399551088759, -5.653248573087018, 4.427414745643277, 1.612365076334875, -6.245655542092986, 0.19314432113332988, 8.258606316187917, 2.202047036783619, 0.504633220307786, -2.1917008519161043, -7.292066924812007, 0.26415520755828864, -0.4203442901950269, 12.15428394564473, -0.4721554180681029, 11.220589273263252, -1.910159450125475, -1.5676979522722854, -5.593752175448534, 1.5047082444098436, 3.3312191189458513, -8.287804764707554, 2.33838724314269, 9.13109453675132, -1.4924863452831711, 1.1598395268072164, 3.19189263253553, 5.292730603239942, 3.132165369900579, -3.472455354878681, 5.343098953056186, 4.0060392254919375, 7.696684969818572, 7.72961044610023, 2.5256415094393105, -4.57241233875758, -4.324084327621009, -5.838749025247708, -0.07232400048855392, -3.777812118423501, -7.223276326261795, -0.8510685272953243, -0.1739636067925927, 3.2413506454093706, 0.839807673250589, 4.464371575241166, -2.193656750986754, 5.309799127149523, 3.942208076017083, 9.58988306201279, -3.4291387240120894, -8.84544697400509, 4.379898350564895, 2.9349000951216633, -1.4029483642840401, -6.778330322622549, 6.248018069276118, -1.3146342228678471, 4.423608114928847, 7.8170757766270205, 6.627850949410824, -4.88342390791903, -2.1208221864240033, 0.5658546795572293, -1.2767182858688546, -4.328729512882174, 3.5804415833199053, 3.7303435906105102, -2.1164247997206087, 0.9790453288532435, -0.2922150004018727, 10.432288770115532, 2.43550785827765, -0.8083371026367496, 6.731684882042352, 1.9089299890240021, -1.7255382006698254, 0.48620518956439074, 8.254945122045525, 4.885460049582627, -2.706965635712927, 3.8005723111959853, 6.005251042236153, 4.149023768820265, -0.8641504135191991, -1.7299681330705627, 6.979827434776203, -3.102728378624507, 0.05740013765159244, -3.2401564166087637, -4.757634745234976, 2.9064106592860304, -4.640381292282322, -5.913367620283494, -0.326299661877558, -1.1861247457986472, 2.5157291028614095, -12.109380199919027, -3.3535823633121415, 5.014188101014921, 1.91166543829334, 1.7826859876925982, -3.1970513714495583, 3.462709146032262, -0.3787867405267082, 4.350308230599712, 3.1182319636435434, -3.4530795324747388, -5.956097454412032, 10.01143682543567, 8.517580368486808, 3.2346548651787868, 0.3347837928108208, 0.2092211087378427, 5.722281368701998, 0.6509021455724324, -1.4984273942799518, -0.25728296812399326, 3.685109790489837, 7.463087700351308, -7.775866160934134, -6.742683000285724, 4.4885077297051685, 4.47681369419463, -10.351934381530034, 0.5454184476957734, 2.100037485341779, 6.616305449049793, -3.305756902500405, -20.1406439958264, 11.660671177575072, -3.930571609129504, -2.582897758111609, 0.5455869507923512, -0.28521663962087707], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.90488931379346, -15.627799847955593, -15.888197469059795, -7.61298053132265, -16.060116152264147, -8.816170185131373, -23.097483654906814, -10.648765803959757, -6.093092697828278, -11.30222211243643, -12.549249093302624, -8.051719025401177, -19.98871041388569, -21.59976082207589, -13.810354049689181, -18.618490548490364, -13.795489037320792, -6.864078424923752, -11.06804632302445, -6.621564887075237, -12.15223211243763, -11.943536227416057, -11.870604856071466, -16.332852582336074, -7.86761570053325, -6.396208614609975, -21.24070911896501, -11.016320177682383, -22.13659706645891, -5.965354664322486, -13.45443417144666, -13.196207101972634, -15.67470193616775, -16.821028400655646, -6.499376450677635, -13.581288934230185, -9.599807216465846, -6.590585791774984, -12.270045554760436, -14.031757951706236, -5.307957771934733, -16.950963505220155, -5.678500023755834, -12.759852187009628, -7.808121606483623, -9.136786280305259, -12.975912938482793, -18.26837823458457, -9.871532043455694, -15.378812002955547, -13.656669181178687, -13.671042406396792, -12.055823106265846, -20.408117307686148, -4.360931610120137, -13.396115654980774, -15.910510753429154, -16.77667245034526, -7.635610887096655, -12.177303335338218, -17.04381668803046, -8.873320871632684, -14.000692357384795, -4.942931566672209, -12.120157683963248, -8.56129123505805, -11.008539295006086, -16.546814056271867, -8.691140689485135, -7.9802004821753885, -10.04824820241633, -17.834075437613606, -5.847521782015144, -6.316120944990181, -15.734236538136791, -11.959462840966308, -11.387755383581863, -10.375808904160488, -14.784537506133839, -9.97764546885255, -12.494074770687293, -14.617729938091282, -13.760817545197138, -9.447640108380233, -12.896642713041711, -15.754202930907448, -12.203513619443807, -16.038583733930942, -8.495476751126152, -15.068525081224958, -14.586475545338924, -12.839573154851518, -12.647402642135894, -10.792759629119058, -5.982067710973204, -10.150096375713229, -11.57706864068337, -8.914985105699412, -14.026932997225973, -11.225660706209922, -8.818523962168792, -7.5231683028924206, -14.047280478709911, -8.996159889034491, -6.0450706632752835, -9.218978341820073, -7.089239697820594, -10.668134133232398, -6.320843604927804, -17.256582007656466, -14.31089217773296, -10.17602169738442, -5.07798496102224, -9.437915573072758, -13.08568422501018, -9.366328292653654, -12.218776731554252, -8.378363284012906, -6.827208643666338, -16.089253114355127, -12.978695404132676, -15.999110552648027, -16.6204657580722, -16.819629187580997, -8.192575934409, -7.943627792319445, -12.800930000885346, -13.140895931225979, -4.961544449413265, -11.64483365292961, -16.587748680162235, -11.338600168222747, -20.43973218025381, -5.4842632386643055, -5.149834109773355], "policy_policy_agent__reward": [7.730446901452935, 7.730446901452935, 4.98727563743429, 4.98727563743429, 10.157806107351538, 10.157806107351538, 4.612672803828762, 4.612672803828762, 4.907230305085582, 4.907230305085582, 4.504657253132351, 4.504657253132351, 15.678044985547363, 15.678044985547363, 6.425406420371689, 6.425406420371689, 3.2988629590680327, 3.2988629590680327, 4.555260630260166, 4.555260630260166, 2.6285910842453095, 2.6285910842453095, 4.157937116479735, 4.157937116479735, 9.784183061845326, 9.784183061845326, 16.87702238386031, 16.87702238386031, 6.669099315810541, 6.669099315810541, 14.91953991087681, 14.91953991087681, 5.942664793597657, 5.942664793597657, 2.648190236325734, 2.648190236325734, 2.737147073787957, 2.737147073787957, 4.063136565742542, 4.063136565742542, 7.741725615691743, 7.741725615691743, 1.82786573135425, 1.82786573135425, 7.104496049607076, 7.104496049607076, 12.731973559543697, 12.731973559543697, 3.1875646776250397, 3.1875646776250397, 3.778024070708596, 3.778024070708596, 12.21630087575027, 12.21630087575027, 8.15452539046116, 8.15452539046116, 12.634381218179746, 12.634381218179746, 1.246449654721904, 1.246449654721904, 9.398766562251428, 9.398766562251428, 8.601123163732286, 8.601123163732286, 11.685693452993162, 11.685693452993162, 12.275319423377935, 12.275319423377935, 4.512508980058473, 4.512508980058473, 4.504438297736304, 4.504438297736304, 2.637861444422416, 2.637861444422416, 0.37591838326364113, 0.37591838326364113, 6.0988607771359415, 6.0988607771359415, 5.126972916641365, 5.126972916641365, -0.9576592771635312, -0.9576592771635312, 8.049947488962411, 8.049947488962411, 2.75226820848162, 2.75226820848162, 8.000601416209498, 8.000601416209498, 4.323964639867107, 4.323964639867107, 6.800578927773211, 6.800578927773211, 5.391128093748019, 5.391128093748019, 11.789088680867048, 11.789088680867048, 6.906870059736387, 6.906870059736387, 12.484347532484168, 12.484347532484168, 5.113765228583295, 5.113765228583295, 2.4127977161958483, 2.4127977161958483, 8.217860728415369, 8.217860728415369, 11.6715087014039, 11.6715087014039, 1.4789916229180484, 1.4789916229180484, 3.308892666179114, 3.308892666179114, 11.079264411352634, 11.079264411352634, 7.731019113738706, 7.731019113738706, 6.029609501012751, 6.029609501012751, 9.997189555982619, 9.997189555982619, 11.835833818720642, 11.835833818720642, 1.9949484818568262, 1.9949484818568262, 5.939935085480394, 5.939935085480394, 2.7543931231147196, 2.7543931231147196, 5.421719699047198, 5.421719699047198, 2.11628086108794, 2.11628086108794, 7.294490439162995, 7.294490439162995, 10.138578823441188, 10.138578823441188, 3.2873579448822623, 3.2873579448822623, 4.479622905514316, 4.479622905514316, 4.878016601007227, 4.878016601007227, 14.13318210386457, 14.13318210386457, 4.141514820146397, 4.141514820146397, 2.7538919211767157, 2.7538919211767157, 11.232960710089573, 11.232960710089573, 6.934196414995155, 6.934196414995155, 4.83110859145602, 4.83110859145602, 5.4310070468624385, 5.4310070468624385, 11.519741314089684, 11.519741314089684, 7.431552759217588, 7.431552759217588, 4.893554567487184, 4.893554567487184, 9.209151124643633, 9.209151124643633, 9.883034293716642, 9.883034293716642, 6.7983319386002465, 6.7983319386002465, 6.016246149761253, 6.016246149761253, 7.012117398918441, 7.012117398918441, 9.591670527110008, 9.591670527110008, 6.467927677653215, 6.467927677653215, 4.276438444388873, 4.276438444388873, 5.914184332308097, 5.914184332308097, 4.914420400051974, 4.914420400051974, 7.872991907068777, 7.872991907068777, 4.003510674926788, 4.003510674926788, 2.439696004417781, 2.439696004417781, 2.8278840245478225, 2.8278840245478225, 4.481985814957291, 4.481985814957291, 7.046398871772387, 7.046398871772387, -1.597197547109807, -1.597197547109807, 5.336675316956916, 5.336675316956916, 8.119924403612423, 8.119924403612423, 5.365094700231066, 5.365094700231066, 4.652927145292507, 4.652927145292507, 5.425114553630174, 5.425114553630174, 6.229434517533377, 6.229434517533377, 2.8331419613742876, 2.8331419613742876, 6.784643286209892, 6.784643286209892, 5.103735830732069, 5.103735830732069, 3.6075273003788295, 3.6075273003788295, 0.18237307525788582, 0.18237307525788582, 13.634009416546068, 13.634009416546068, 11.414236273109882, 11.414236273109882, 6.705338281281604, 6.705338281281604, 2.7063843769165303, 2.7063843769165303, 4.8235683409053, 4.8235683409053, 9.40398279685609, 9.40398279685609, 5.008615219113047, 5.008615219113047, 5.36017466863715, 5.36017466863715, 4.060540157944457, 4.060540157944457, 5.25615921707809, 5.25615921707809, 11.776170407353215, 11.776170407353215, 2.601414621599275, 2.601414621599275, 4.628213776181152, 4.628213776181152, 10.554486743888683, 10.554486743888683, 10.648221440887811, 10.648221440887811, -1.0796792235605157, -1.0796792235605157, 4.244523120007609, 4.244523120007609, 7.450483743113563, 7.450483743113563, 9.878600690137882, 9.878600690137882, 0.827893773456431, 0.827893773456431, -4.247905171448392, -4.247905171448392, 14.124209928868654, 14.124209928868654, 3.704014279546621, 3.704014279546621, 8.928417211071098, 8.928417211071098, 3.0149250947283277, 3.0149250947283277, 2.4323087350762393, 2.4323087350762393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.280385800821182, "mean_inference_ms": 2.115702570135299, "mean_action_processing_ms": 0.09664531838704468, "mean_env_wait_ms": 0.5815490198153517, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 273375, "timesteps_this_iter": 0, "agent_timesteps_total": 820125, "timers": {"sample_time_ms": 13385.927, "sample_throughput": 252.13, "load_time_ms": 2.544, "load_throughput": 1326465.638, "learn_time_ms": 1898.791, "learn_throughput": 1777.447, "update_time_ms": 24.441}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 11.617418575286866, "policy_loss": -0.003887588664656505, "vf_loss": 11.628537845611572, "vf_explained_var": 0.12742839455604554, "kl": 0.003950409388456544, "entropy": 0.7231911420822144, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.650988095998764, "policy_loss": -0.0159646553453058, "vf_loss": 1.673584908246994, "vf_explained_var": 0.7060219585895539, "kl": 0.0056952919160769165, "entropy": 0.6632415235042572, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 273375, "num_agent_steps_sampled": 820125, "num_steps_trained": 273375, "num_agent_steps_trained": 820125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10935, "training_iteration": 81, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-26-14", "timestamp": 1706106374, "time_this_iter_s": 13.671900272369385, "time_total_s": 992.9039857387543, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FD9FDD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 992.9039857387543, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 39.983333333333334, "ram_util_percent": 73.64444444444445, "gpu_util_percent0": 0.060000000000000005, "vram_util_percent0": 0.21617296006944445}}
{"episode_reward_max": 19.800260571599335, "episode_reward_min": -19.828366026278353, "episode_reward_mean": 1.0065820610734708, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.658069923412985, "policy_agent_": -1.3905599136258553}, "policy_reward_max": {"policy_adversary_": -3.9563098683522995, "policy_agent_": 23.21435022878491}, "policy_reward_mean": {"policy_adversary_": -11.884368167113015, "policy_agent_": 6.445475114093243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8732367785763433, -0.683618099037411, 2.9409164215457517, 1.0693900897548336, 6.355591279756182, -4.269078960097958, -3.0367991590181225, -1.2756588416496892, 4.038207124091953, -0.171444136101928, 2.0492504364803046, -8.054189264361716, 8.612336366810023, 0.6660005749562933, -3.1717653961716654, 8.970880500795385, 10.919799085116466, 1.34092637626757, 0.428426259373639, 9.37368343371651, 1.1385699856505878, 1.4637470113818987, -7.271915618050519, 2.613716083765037, 2.4193902159822143, -6.684435020806527, -4.805328953096545, -0.6767699605742126, 5.58216954830423, -0.21952485899880578, 0.029974839147243887, 0.42387436820333574, -2.584049956708434, 7.213286223853583, 1.3657715711651068, 7.69366927814484, -1.670234224615524, 2.250358255555455, 0.45946148754741867, 1.5599179744466252, -5.549598216075086, 4.5131979619452025, -1.7186049798706993, -4.990210059355807, 4.428022789962394, 1.1070001531748617, -4.528330618125881, 2.7701290002663415, -0.7111567644053853, -3.985086815233825, 0.5397963555933002, 5.7222378103253915, 7.849865871877515, 1.6150149143935364, 5.56158418752815, 11.19332939739948, 3.9747412737880734, -19.828366026278353, 4.4111024935345995, 2.923643449788987, -1.520712080715932, -7.324916045815747, 5.7240296971772535, -2.1725815167812836, 4.315529031088675, 4.877181668884039, 5.286819191613856, 4.398370567427543, -5.280047307535867, 3.2290977806746333, 4.049831339414955, -6.959629533019659, 3.7080053631515755, -2.9590878164995718, 1.0368683389926832, -0.8880123217070103, 3.283656910356627, 3.156682234697822, -7.237092110634776, 3.2074691093297343, 9.201243916403252, 1.206687193703528, -8.493156886168268, -0.46493527133108414, -3.3817431336262933, 0.5950152170673124, -6.2244853433639475, 2.212696442541967, 2.6013422231396075, -3.0844331943529943, 16.628070370051592, 1.030087743346851, -1.9864945125394904, -8.893820772745373, 0.9227521418406177, -5.198835635694512, -2.0715360317916325, -5.664120845374729, -1.437448593920034, 19.800260571599335, 10.042533999076248, 4.552753176448477, 4.4791192471179935, 0.3211877804521238, 3.198153825589108, 3.5418200355741796, -2.106738169770234, -5.345142700295716, 4.172102463981592, 5.169958427870375, 1.2019089645416243, -7.106963395589227, 8.648870588322294, 0.15711375638296798, 3.797912486154982, 2.6122967021505947, 6.923702264000193, 1.4396504293057961, 0.23669668942307587, 7.5381429177171375, 0.7727487807032454, -0.24505379660004137, 5.499656789958435, 6.262985725810393, -9.528110836031757, -5.654251296351454, -0.8484826844755596, -0.23963353931293033, -0.6587232147303157, 3.2918077771994643, 2.9614044452358304, -8.227165610042379, -2.107485218435777, 5.295484931278027, 3.0336571020419827], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.25581947961012, -12.159560465458423, -13.13378349937192, -10.456140826352616, -15.525258367997122, -14.438054230538562, -7.65037403834053, -9.200125129700043, -13.873382743878414, -14.643735467342168, -9.98250181807745, -9.202357801985553, -14.254535517090245, -8.349504449893457, -14.478959323999645, -19.709780573965595, -18.661564926448616, -15.75799130206714, -4.047774720923505, -21.861696275300986, -13.292656266667466, -10.134891133258893, -14.680095499969946, -7.332395878141241, -16.826231438195595, -10.422449565032489, -7.158480642246234, -3.9563098683522995, -12.227892898674778, -19.635435000293775, -4.4845522811699245, -16.12964054310911, -8.115601611661546, -12.712406423028026, -9.017619747187776, -15.052364423926218, -7.777562719965163, -7.415732306971003, -9.46839230705618, -13.673893848986234, -8.996826604471392, -13.409275727664804, -16.582923530252717, -7.66471652730754, -10.071033690650006, -9.385550084206658, -8.560177252905914, -16.091521932170714, -5.540041651019786, -14.605357210775983, -10.474937806255431, -11.305236194704298, -18.742530104515847, -9.39286252783482, -13.743593634141911, -18.17342141928098, -8.624404064198197, -17.047246199026645, -12.872899048152462, -9.013113089403099, -7.413668217171354, -19.55566561805335, -12.338123149599996, -11.645407461963599, -8.987437366841275, -17.634135830837092, -11.96151225380573, -12.203161733895772, -13.014617929610028, -7.390345304191602, -9.768676697560297, -6.064469368025863, -10.236398106495953, -4.801603747853977, -7.121746364488226, -13.079916333255953, -10.690426270941554, -7.658277955992525, -10.01810223329756, -18.08536349607623, -28.658069923412985, -7.806264049443023, -9.727459022085538, -12.369572046936382, -4.321629707498467, -10.340391594062314, -14.151951322531094, -7.54138038349222, -15.499273177980262, -11.292386650059232, -21.053642298424847, -5.408280800094697, -7.456256754735025, -11.256090850142064, -16.091416002442845, -14.219153437417953, -8.119317563485684, -10.872771791600309, -12.75467344037979, -26.628439885970483, -17.389525395249414, -14.213808695982634, -10.427064109942501, -7.593091615335498, -9.280028250282987, -15.97299926676907, -5.199693060049598, -6.7652485742362884, -13.348883447032048, -15.518716517622154, -9.126943536818027, -12.37454601275836, -15.41894749839963, -9.71191357680337, -10.915996381428236, -7.699588198989673, -15.70917989971912, -10.375126097791393, -4.834165246580672, -13.35983626613353, -13.464829796892754, -8.141812737019595, -15.635737945958606, -12.735285315559647, -14.59124928889013, -15.14607269769702, -9.133803950475174, -10.788539889378226, -13.516325875202517, -7.857082374503724, -10.704054766417498, -15.839772748684636, -12.80694985125507, -15.41396826481186, -8.686265606258234], "policy_policy_agent__reward": [7.064528129093234, 7.064528129093234, 5.737971183210504, 5.737971183210504, 8.037349960458839, 8.037349960458839, 5.762765458053725, 5.762765458053725, 10.94042482387665, 10.94042482387665, 5.084487635220301, 5.084487635220301, 2.306787439661203, 2.306787439661203, 3.962233144025178, 3.962233144025178, 8.955794933985183, 8.955794933985183, 7.236145665620123, 7.236145665620123, 6.0158761272788785, 6.0158761272788785, 0.5740842688119162, 0.5740842688119162, 11.433435941950137, 11.433435941950137, 4.507752512424877, 4.507752512424877, 5.65359696391399, 5.65359696391399, 14.340330537380492, 14.340330537380492, 14.79068200578254, 14.79068200578254, 8.549458839167354, 8.549458839167354, 2.2381004901485726, 2.2381004901485726, 15.617689854508747, 15.617689854508747, 7.2156131261590275, 7.2156131261590275, 5.7993190723203965, 5.7993190723203965, 3.704089940959715, 3.704089940959715, 4.9730559809531405, 4.9730559809531405, 9.622810827088905, 9.622810827088905, 1.8690072721129805, 1.8690072721129805, 1.1765758445748464, 1.1765758445748464, 1.6397699538890431, 1.6397699538890431, 8.905031223489505, 8.905031223489505, 9.70795507064748, 9.70795507064748, 2.2572635601585844, 2.2572635601585844, 8.276757455656222, 8.276757455656222, 2.7657758274765554, 2.7657758274765554, 9.962846323440806, 9.962846323440806, 5.191695659176441, 5.191695659176441, 11.373016851035532, 11.373016851035532, 3.0536642476748193, 3.0536642476748193, 4.833045281263228, 4.833045281263228, 4.963926897301798, 4.963926897301798, 7.616905911716432, 7.616905911716432, 1.7236141941981549, 1.7236141941981549, 8.961236844805002, 8.961236844805002, 7.432159275191011, 7.432159275191011, 1.3372532339758672, 1.3372532339758672, 7.2495282403062005, 7.2495282403062005, 5.246275118690759, 5.246275118690759, 2.015923317390018, 2.015923317390018, 9.430825466218527, 9.430825466218527, 2.414442443307201, 2.414442443307201, 5.31013519777108, 5.31013519777108, 5.507367080924365, 5.507367080924365, 8.513737002514842, 8.513737002514842, 13.296197988196683, 13.296197988196683, 5.503938721114179, 5.503938721114179, 9.652588910835032, 9.652588910835032, 14.683375408340227, 14.683375408340227, 6.299572668993137, 6.299572668993137, -1.3905599136258553, -1.3905599136258553, 8.642000770843532, 8.642000770843532, 5.968378269596045, 5.968378269596045, 2.94647806822771, 2.94647806822771, 6.115374786118798, 6.115374786118798, 9.031076423388624, 9.031076423388624, 4.736412972591155, 4.736412972591155, 6.651483198964975, 6.651483198964975, 11.255658749860562, 11.255658749860562, 8.624165722709792, 8.624165722709792, 8.300766150661657, 8.300766150661657, 3.86728531103708, 3.86728531103708, 5.309721542433116, 5.309721542433116, 6.909254018487626, 6.909254018487626, -0.44758008249689946, -0.44758008249689946, 6.972201734823763, 6.972201734823763, 0.9212579656772044, 0.9212579656772044, 4.079307351740455, 4.079307351740455, 6.095952005774474, 6.095952005774474, 6.987041590649091, 6.987041590649091, 5.407480095345175, 5.407480095345175, 1.390505061331395, 1.390505061331395, 10.646416302702983, 10.646416302702983, 18.929656919908112, 18.929656919908112, 4.5064756215732755, 4.5064756215732755, 0.617151067958638, 0.617151067958638, 5.9523183878026495, 5.9523183878026495, 0.4699432869360873, 0.4699432869360873, 5.467703405564815, 5.467703405564815, 3.963732989583573, 3.963732989583573, 4.877038413017091, 4.877038413017091, 9.050307700559939, 9.050307700559939, 4.103976727853117, 4.103976727853117, 18.840856334238214, 18.840856334238214, 3.2191842717207746, 3.2191842717207746, 2.7348811210977684, 2.7348811210977684, 1.181135038698349, 1.181135038698349, 8.50708407214173, 8.50708407214173, 4.5101589008617236, 4.5101589008617236, 3.023890765847024, 3.023890765847024, 2.604325473112792, 2.604325473112792, 5.658612423229878, 5.658612423229878, 23.21435022878491, 23.21435022878491, 13.716029697162826, 13.716029697162826, 9.383280936215556, 9.383280936215556, 7.453091678530248, 7.453091678530248, 3.957139697893812, 3.957139697893812, 6.239091037936049, 6.239091037936049, 9.757409651171628, 9.757409651171628, 1.5464774451396819, 1.5464774451396819, 0.7100529369702884, 0.7100529369702884, 8.760492955506818, 8.760492955506818, 10.344337472746265, 10.344337472746265, 5.164426250679825, 5.164426250679825, 2.6337913085845663, 2.6337913085845663, 12.033909043360964, 12.033909043360964, 4.934513666593169, 4.934513666593169, 7.35695443379161, 7.35695443379161, 5.155942450570134, 5.155942450570134, 11.316441081859658, 11.316441081859658, 5.907388263548594, 5.907388263548594, 2.5354309680018736, 2.5354309680018736, 10.448989591925335, 10.448989591925335, 7.118789288797998, 7.118789288797998, 3.9483794702097765, 3.9483794702097765, 10.567697367958523, 10.567697367958523, 9.499135520685025, 9.499135520685025, 2.531569226429188, 2.531569226429188, 4.745910700672783, 4.745910700672783, 4.142660632999807, 4.142660632999807, 5.274453175032647, 5.274453175032647, 6.4288013302361025, 6.4288013302361025, 5.574445075851595, 5.574445075851595, 6.832729605826663, 6.832729605826663, 3.80630356932113, 3.80630356932113, 5.349732316409642, 5.349732316409642, 10.354726598044945, 10.354726598044945, 5.859961354150108, 5.859961354150108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28059328277216183, "mean_inference_ms": 2.117186006086322, "mean_action_processing_ms": 0.09678703005889272, "mean_env_wait_ms": 0.581701952794318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 276750, "timesteps_this_iter": 0, "agent_timesteps_total": 830250, "timers": {"sample_time_ms": 13363.192, "sample_throughput": 252.559, "load_time_ms": 2.642, "load_throughput": 1277620.174, "learn_time_ms": 1882.759, "learn_throughput": 1792.582, "update_time_ms": 24.344}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 11.861451053619385, "policy_loss": -0.0008343656620127149, "vf_loss": 11.869718933105469, "vf_explained_var": 0.12623435854911805, "kl": 0.005507171827716939, "entropy": 0.7433606803417205, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.8628246366977692, "policy_loss": -0.0018248999607749284, "vf_loss": 1.8713202953338623, "vf_explained_var": 0.7005517214536667, "kl": 0.0049113247474950215, "entropy": 0.6670944780111313, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276750, "num_agent_steps_sampled": 830250, "num_steps_trained": 276750, "num_agent_steps_trained": 830250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11070, "training_iteration": 82, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-26-27", "timestamp": 1706106387, "time_this_iter_s": 12.775531768798828, "time_total_s": 1005.6795175075531, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4B87D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1005.6795175075531, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 32.881249999999994, "ram_util_percent": 73.775, "gpu_util_percent0": 0.03875, "vram_util_percent0": 0.2213897705078125}}
{"episode_reward_max": 12.214644120175624, "episode_reward_min": -11.878418273795237, "episode_reward_mean": 0.6486036453591632, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.912942145457016, "policy_agent_": -2.6537132606259295}, "policy_reward_max": {"policy_adversary_": -3.861287005955806, "policy_agent_": 18.980996810349318}, "policy_reward_mean": {"policy_adversary_": -11.737004873808418, "policy_agent_": 6.192804259583789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.397157806185879, 0.42207068428354244, 5.952977260725851, 3.5430978741313237, -1.5573586160827453, 0.2061579859512755, -1.4930862690542677, -0.5109189318990275, 4.4569811330584805, -2.5583421317648445, -0.2267747471300873, -0.6796469849860343, -0.25181224344039155, -0.15129224825420362, 1.827675169445455, -3.574609037324545, -3.276204693468812, -1.771634873151503, 0.4379744450374783, -5.214396156367083, 1.9435624161132854, -6.650661776269924, -1.6519637844986628, 1.1648601114155115, -4.086561617877281, 1.0685787217021556, -1.6167980026292303, 0.6653345843840452, 2.0587126758018326, -7.236406150826989, -4.041698187845412, 1.8140816571039582, 11.18150710502212, -10.136061942767883, 0.5105087140908422, 2.3282691197243555, 0.4377314521366142, 7.7524830224331875, 6.566821399061098, -0.1583869785654945, 1.722762209824666, -6.050114979739304, 6.834010138907315, 12.214644120175624, -3.945945900510827, -7.380255902599247, 2.4314833852748143, -4.435905993862132, 0.26204320585475577, -11.878418273795237, -7.460039910273675, -7.220486850891659, 4.159245039861282, 7.31422808606196, -10.273506350426093, 2.6126495655871476, 3.300798469072803, -5.154631820739762, 4.004393770431891, 11.4987818926007, -1.843204657565705, 6.336794561760486, -0.6321516657923012, -5.3872868166837655, -0.07925041755360018, -1.7061130124420902, 1.9486865440287575, 6.457112151224038, -2.5759309399802994, -6.411239537944468, 0.04863832150592462, 2.592417626978544, 5.233614196151787, 1.0909423867227654, 3.676352288787117, 2.1134682933995177, 4.426064220687688, 4.091054236738806, 10.04905147524163, -5.245760896300133, 2.016405926207681, -0.9145338068077691, 6.042541753277218, -2.1661669961305803, 2.2278598327672796, 1.2259941749008845, 1.556685656930267, -2.466885566733436, 2.8995692274073486, -2.4267874484742302, 5.6714766713516065, -4.914557143095407, 0.9636730680958261, -4.524492377764131, 0.6676186051102179, 0.4431880001101913, 6.086329434620583, 9.875552646374691, 0.5377496307330747, -3.5592927616634866, -8.820363633668478, -0.6362598578201586, 3.4865766262330276, 11.744029470970661, 4.532408631254824, 2.750110358013269, 1.8751965266153978, 1.8642444734098504, -2.749508235681094, -2.899302887458601, -2.80607367825121, 9.623854038973967, -3.7832060586438185, 5.5307851632926, 4.885839442034243, -2.046416984960044, -1.3126766089860897, 2.3157270921899933, 4.231774733877627, 0.5505604715058986, -0.8455863866038309, 3.3895166948253275, 2.8281312788922044, 3.234583083707405, 2.8061636066024973, 7.671989276935873, -4.880440717698521, 4.928050423515753, -0.22989958509247652, 9.169241398755814, 8.159094130813799, -1.005378109116297, -8.922121861308588, -0.3275030857346169, 3.169819753861152], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.97915404765638, -13.412426766654777, -14.213263656243495, -12.069429214600103, -4.712320661657044, -8.617791837113916, -4.53118387529315, -8.572496891460375, -9.592212673017098, -4.259144045104662, -14.514070355754344, -9.142383855163933, -5.003089592833369, -5.139355999884852, -12.450952902446705, -7.581709338581758, -5.846641523772167, -6.573329766186436, -9.159100302983227, -8.301563784562381, -16.75610535660712, -8.057122061227263, -8.16667088522836, -7.993119255319136, -5.425214095738748, -6.751575132912765, -9.627943296857339, -4.605473543130127, -7.084577964190478, -17.565184573218975, -14.208253042707245, -10.69976209530226, -21.10860724162719, -19.725503579471376, -10.136339152241627, -8.974886598316008, -6.659160141567492, -12.530423502355134, -15.051297764217248, -4.352116179442882, -7.577990116594026, -4.1512561781914545, -15.277161289276307, -15.800126003179994, -21.496388519675286, -10.54921914330952, -8.151800700008575, -8.668031943479814, -11.610075143572107, -6.570991752543368, -17.872413100640877, -10.978917055070847, -7.716674811838378, -15.244518427238905, -8.901212660262589, -11.418866536483531, -14.733681767540316, -12.636877780068438, -18.92967565813378, -17.696164820821863, -15.113221810138938, -24.035772463692588, -3.861287005955806, -10.831276324873043, -7.082267363899702, -13.027799522605864, -12.373406314066218, -12.004620877760821, -9.405984868694995, -24.849751537226403, -6.613430699017456, -10.175903986653028, -13.951815861429408, -8.71355701440566, -8.058622836418381, -6.814808216566439, -13.29467693621506, -13.186653843761086, -27.912942145457016, -14.688875559697056, -13.479004761112824, -21.849489693970156, -12.741045459483336, -13.98229815383539, -11.11203581215668, -6.245426749620312, -6.999097732696549, -10.849769549984142, -11.729704585980615, -10.940537043785797, -19.312342894487543, -11.975606593544937, -4.865378319089044, -10.53719165903297, -15.600144918833982, -8.665212165872077, -14.871607639604457, -16.779465554795635, -13.498380476449316, -14.239832903931932, -11.252073840054992, -13.473740566375426, -13.7921988040992, -18.338958800017398, -10.571750333703656, -8.326886545198311, -11.869990846000942, -11.658225325042663, -18.447023568673565, -22.83341737634809, -12.399408253717368, -16.560323594520497, -15.486838538054295, -9.04131015579256, -17.518336122374773, -17.455169996854845, -10.545797927502033, -7.297438062027712, -8.784836743873838, -8.929063703402933, -16.440096598027804, -9.867787820431703, -14.870385887332825, -11.655234695616036, -11.605319412318039, -14.815210132303378, -8.415696918597702, -8.526761641669276, -10.021850561909538, -17.42697061415254, -13.198051006472737, -10.457672152718398, -7.883674765990097, -7.426550333767956, -7.898358501811614], "policy_policy_agent__reward": [7.290998120735245, 7.290998120735245, 6.917248725469158, 6.917248725469158, 10.083120458484673, 10.083120458484673, 7.806263544365714, 7.806263544365714, 1.5774810227871487, 1.5774810227871487, 4.411974911532595, 4.411974911532595, 1.5190488031194407, 1.5190488031194407, 4.030788979780675, 4.030788979780675, 7.024596903037789, 7.024596903037789, 0.8504009566699087, 0.8504009566699087, 7.1436478043121285, 7.1436478043121285, 4.231368435088949, 4.231368435088949, 2.3756386746964884, 2.3756386746964884, 2.4940318758153235, 2.4940318758153235, 7.139314035946081, 7.139314035946081, 2.003550150628606, 2.003550150628606, 1.2852184151516763, 1.2852184151516763, 2.4008474465174667, 2.4008474465174667, 4.798537374010351, 4.798537374010351, 1.543583814097652, 1.543583814097652, 9.349833886360203, 9.349833886360203, 0.7032301424786703, 0.7032301424786703, 3.257353550364847, 3.257353550364847, 4.578989683367325, 4.578989683367325, 0.6693262389307336, 0.6693262389307336, 3.9100769273074594, 3.9100769273074594, 4.005572647114055, 4.005572647114055, 2.635404063757086, 2.635404063757086, 4.571645319996154, 4.571645319996154, 5.164389211195993, 5.164389211195993, 5.083277427430915, 5.083277427430915, 6.25692187620311, 6.25692187620311, 16.145057173324656, 16.145057173324656, 4.794720818351751, 4.794720818351751, 5.323423933166237, 5.323423933166237, 5.651577859020181, 5.651577859020181, 3.5484457968520533, 3.5484457968520533, 10.141453262394162, 10.141453262394162, 10.80905958163917, 10.80905958163917, 2.0968646004386944, 2.0968646004386944, 4.650376163209343, 4.650376163209343, -0.949429400773926, -0.949429400773926, 11.055585714091812, 11.055585714091812, 14.007385061677807, 14.007385061677807, 8.775221309582225, 8.775221309582225, 1.5844816203551348, 1.5844816203551348, 5.291642042641694, 5.291642042641694, 2.11606297480884, 2.11606297480884, 5.9360591747134315, 5.9360591747134315, -2.6537132606259295, -2.6537132606259295, 5.206186595183603, 5.206186595183603, 1.8792151020895915, 1.8792151020895915, 5.937959925849829, 5.937959925849829, 11.279373256650436, 11.279373256650436, -0.6861468450817518, -0.6861468450817518, 7.015758051035342, 7.015758051035342, 9.017240118306562, 9.017240118306562, 3.7411229796643375, 3.7411229796643375, 11.46703471428283, 11.46703471428283, 14.59747335671128, 14.59747335671128, 6.6350085762866176, 6.6350085762866176, 15.186283512726536, 15.186283512726536, 1.6145676700817526, 1.6145676700817526, 2.7219947540946388, 2.7219947540946388, 3.5015084731730495, 3.5015084731730495, 5.660843255081888, 5.660843255081888, 7.161046429047487, 7.161046429047487, 9.230866514492433, 9.230866514492433, 3.415026964357347, 3.415026964357347, 9.219255999640966, 9.219255999640966, 3.3310345102616896, 3.3310345102616896, 6.384160806815785, 6.384160806815785, 9.592715028790597, 9.592715028790597, 4.90224970056421, 4.90224970056421, 5.86748756260275, 5.86748756260275, 4.464138254982977, 4.464138254982977, 8.860370578451377, 8.860370578451377, 8.638854040249946, 8.638854040249946, 18.980996810349318, 18.980996810349318, 4.721557331698461, 4.721557331698461, 7.74770534366025, 7.74770534366025, 10.467477943581192, 10.467477943581192, 9.391793606380276, 9.391793606380276, 5.908065578852404, 5.908065578852404, 6.66994782246198, 6.66994782246198, 3.735710462260598, 3.735710462260598, 4.277891694813407, 4.277891694813407, 4.191441991625352, 4.191441991625352, 7.314636906693982, 7.314636906693982, 4.256874797655784, 4.256874797655784, 12.491909782919576, 12.491909782919576, 3.530524725224766, 3.530524725224766, 2.914525693592435, 2.914525693592435, 3.0063496406344195, 3.0063496406344195, 8.1338817619721, 8.1338817619721, 4.554200082991134, 4.554200082991134, 10.47896853711252, 10.47896853711252, 13.327509100585166, 13.327509100585166, 7.0180650535911955, 7.0180650535911955, 5.340270071134222, 5.340270071134222, 1.215855103193257, 1.215855103193257, 6.418740354277631, 6.418740354277631, 8.639387715166109, 8.639387715166109, 15.041494135494029, 15.041494135494029, 7.552079482479241, 7.552079482479241, 5.538498451605789, 5.538498451605789, 6.8725936863081705, 6.8725936863081705, 6.761234899226256, 6.761234899226256, 7.8487576664962315, 7.8487576664962315, 9.967057244444748, 9.967057244444748, 4.79666728773308, 4.79666728773308, 13.092088816747236, 13.092088816747236, 5.851816239705239, 5.851816239705239, 7.2860476595425805, 7.2860476595425805, 11.20208778220451, 11.20208778220451, 7.704376505947399, 7.704376505947399, 4.616560659257973, 4.616560659257973, 4.806582577108851, 4.806582577108851, 6.508305738875731, 6.508305738875731, 4.739812087454415, 4.739812087454415, 7.797255105711987, 7.797255105711987, 6.628652257628514, 6.628652257628514, 8.849258583112517, 8.849258583112517, 7.444908889661719, 7.444908889661719, 7.205741509460267, 7.205741509460267, 11.243599704619623, 11.243599704619623, 1.7676281004495895, 1.7676281004495895, 6.727406032592514, 6.727406032592514, 4.89597548840853, 4.89597548840853, 13.298106006454178, 13.298106006454178, 10.678572568643268, 10.678572568643268, 4.726147021801052, 4.726147021801052, -0.5192235476592445, -0.5192235476592445, 3.54952362401667, 3.54952362401667, 5.534089127836383, 5.534089127836383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2807255956977456, "mean_inference_ms": 2.1172682825541806, "mean_action_processing_ms": 0.09689313896761095, "mean_env_wait_ms": 0.5816802947059425, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 280125, "timesteps_this_iter": 0, "agent_timesteps_total": 840375, "timers": {"sample_time_ms": 13317.365, "sample_throughput": 253.429, "load_time_ms": 2.739, "load_throughput": 1232383.755, "learn_time_ms": 1875.574, "learn_throughput": 1799.449, "update_time_ms": 23.787}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 12.514533424377442, "policy_loss": 0.006864277366548777, "vf_loss": 12.515346908569336, "vf_explained_var": 0.13261605501174928, "kl": 0.0019101549770902614, "entropy": 0.7677743971347809, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.6215752601623534, "policy_loss": -0.004183313064277172, "vf_loss": 1.6325606405735016, "vf_explained_var": 0.7179362446069717, "kl": 0.005974185047660607, "entropy": 0.6802188843488693, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280125, "num_agent_steps_sampled": 840375, "num_steps_trained": 280125, "num_agent_steps_trained": 840375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11205, "training_iteration": 83, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-26-39", "timestamp": 1706106399, "time_this_iter_s": 12.386640071868896, "time_total_s": 1018.066157579422, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FDA5B430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1018.066157579422, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 33.01875, "ram_util_percent": 73.9375, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.213897705078125}}
{"episode_reward_max": 12.708076882124237, "episode_reward_min": -18.828651617122286, "episode_reward_mean": -1.0471704550116814, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.257506455638964, "policy_agent_": -3.820934093367639}, "policy_reward_max": {"policy_adversary_": -3.5592634490147943, "policy_agent_": 15.534353539553347}, "policy_reward_mean": {"policy_adversary_": -11.05679588644546, "policy_agent_": 5.00481271571689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.387133787530352, 9.098934523031508, -8.334715787083363, 0.9515736323675714, -0.45965196956673005, 9.591916513879367, -2.38015556320766, 3.8848324474703846, -5.10720485735085, -6.358781970324387, 4.167273779895951, -4.148346285219468, 10.303663969500008, -7.138765019813625, -2.2137805848075898, -9.622111376963058, 2.536887843895758, -9.818998806563526, -6.927843512979215, 4.834198184360244, 0.1916760558561822, -3.8217473965587554, 7.367145128085355, 0.17294659636321574, 2.4067636039338747, -18.828651617122286, 0.17054107738276872, 7.246733331080436, -4.933422836242708, 1.976626629611735, -12.103575864861407, 7.844155048121629, -0.05809435928350726, -5.288101213167267, -6.216559811568013, 4.9896368579830455, -8.259197184853006, -4.084574175810852, -0.38070260603685374, -0.03989730414700887, 4.27843468005773, -6.6217081769598485, -0.8923245106365243, -2.501243952244258, -3.411003548978028, 2.4154262346541557, 4.423823845181171, 3.431077966361017, 7.633322162401576, 11.26301765107107, 0.223968483181786, 1.2077235006680898, -5.929927824112369, 2.230796836645163, -2.3209110911621442, -0.24888584886541254, -4.257798059628614, 1.020961973550016, -2.337113427938341, 0.5383158758924642, -5.61743828443524, -14.289750906475781, 0.12036802206783836, -5.795703878016524, 4.12747076718519, -2.680319897356073, -8.776371357412009, -1.8462333852161654, -13.575121581231157, -0.5280274013159119, -3.750321935700601, 0.2678130504888421, -1.8118508676201477, -0.931785716796816, 1.3030385956255115, -4.2528813568859345, -7.475248943788503, -3.1136162211779226, 0.17967717325268007, -13.771322943230043, -0.9768446271606723, -3.987716483063307, -2.097070018816175, 0.19015999872118217, -3.422164104327045, -7.043319526797911, 4.816146709039747, -1.2540122390114048, -1.6028669252422252, 2.5896664995159133, -6.764201219455175, 1.0729223111593849, -6.066211779391062, 5.842255628981997, 0.4112389943606247, -6.275563975589221, 0.5651102832513101, 12.708076882124237, 5.071207169948454, 4.293724102608115, -1.4281214670279034, -3.625557296118724, 4.971451135858885, -10.999964199688513, 7.314518059809543, -5.862523641955285, -7.102078725985197, -2.56069148313585, -0.17610619614488512, -6.353025370584361, 4.971227339242985, -1.2975758706662317, 4.400062809765542, 4.544431481867148, -7.969259953976317, 0.8066185895476629, -1.6358424216941925, -2.269193144173874, 0.5099415286931824, -7.696300557755539, 1.7900960398072194, 2.0405234604535285, 3.1438039793286143, 0.8192339950459192, 5.0522510231260505, -3.677014150160445, -13.488856310626621, 2.348142793808573, -0.0907079042786455, 6.976059516744426, 1.23510261412923, 3.8417615384960864, -2.0465172756771777, 6.299115769716216, 2.0246281539176985], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.656632668516256, -20.076253296076292, -19.073460338163184, -13.955910372635914, -8.395515985226554, -16.051791849103232, -9.627091835667846, -9.388267879262989, -12.29261092248143, -11.36543853645253, -14.046475856386213, -12.538528311079704, -14.969965519973934, -14.138677997242747, -9.864777200104681, -14.731216660522655, -7.87065787338096, -16.777382045038994, -11.313679916410255, -12.007056311802891, -9.168938246976333, -6.276236226033672, -14.778567110097743, -10.259704572078046, -8.299707995518453, -11.186783430386992, -11.660512077111507, -15.52977902650837, -15.199411739678597, -6.996205095338294, -18.22878477774628, -16.494165129447996, -6.037718077964624, -8.220274996801809, -6.2900434003054055, -9.380455066919518, -9.028761468366792, -4.911185195371008, -13.512070593533828, -19.147474808291804, -9.879761930474997, -14.114144142319198, -15.640678491506494, -7.488497630687063, -9.692234614365098, -13.287824441905949, -12.544069483018623, -9.322140868764475, -19.076772245659345, -18.26388861567184, -6.803375834862976, -9.231111283188591, -9.401770814513231, -7.50938333684979, -9.329996171917957, -6.120610705765828, -7.114580573563849, -12.655500000271187, -6.897453993749784, -11.748162207777503, -9.979866647586274, -20.719086804206334, -6.680805545207937, -10.73517173814286, -14.892284898971706, -9.562564680361998, -14.354463809219201, -11.54465695258386, -9.25563434909129, -10.646073435501444, -8.4999146631189, -4.60987972398378, -6.205398232097348, -10.73510170381578, -7.724641074690909, -4.611572001174625, -5.415524933857012, -10.353581051195603, -11.82403338428361, -11.697151606807239, -10.901189841751137, -7.975235249102372, -14.701987677931912, -7.582622795636904, -5.3473233853982265, -10.967861583841977, -11.257251326170792, -3.5592634490147943, -15.972652253450718, -12.354357189784121, -6.721440941045809, -10.17539067247989, -12.66510204623832, -12.513932256131463, -6.830959082537302, -10.263442869115728, -13.629155601772384, -18.360630196982456, -25.257506455638964, -9.7316457707216, -11.857182122869682, -7.314321510000247, -9.611542138041473, -8.510541793500598, -14.738219407985905, -11.973794631178714, -7.416089000488159, -5.974798302553346, -6.4666445602708515, -10.531387861198349, -13.983565621063542, -12.264383638929907, -8.346633355970132, -18.692636281980036, -12.552169528524432, -8.993206837222537, -15.269080207394177, -13.280541620543344, -11.763665782424466, -9.307062766032118, -7.090692776736867, -7.933602570254262, -12.453600933031323, -6.005530279721741, -14.315650812255885, -6.189877836073427, -9.692484935109087, -5.548583295545203, -8.609009374914978, -14.655969909144247, -10.126844384387848, -7.932731803197879, -12.030112110467694, -16.857705986531833, -7.6910950171082755], "policy_policy_agent__reward": [5.634749440492953, 5.634749440492953, 14.587593909553902, 14.587593909553902, 5.369372275539912, 5.369372275539912, 7.453742002501743, 7.453742002501743, 3.967932007829912, 3.967932007829912, 12.821854181491297, 12.821854181491297, 3.623468136230093, 3.623468136230093, 6.636550163366686, 6.636550163366686, 3.5927030325652902, 3.5927030325652902, 2.5033282830640706, 2.5033282830640706, 9.106874818141081, 9.106874818141081, 4.195091012930116, 4.195091012930116, 12.63681474473697, 12.63681474473697, 3.4999564887145587, 3.4999564887145587, 3.825498307648545, 3.825498307648545, 2.5545526417797966, 2.5545526417797966, 5.2037728586383585, 5.2037728586383585, 3.4791916192377332, 3.4791916192377332, 2.1929182017155164, 2.1929182017155164, 8.420627248081567, 8.420627248081567, 4.680307151416258, 4.680307151416258, 1.2272444147374562, 1.2272444147374562, 11.072856119091544, 11.072856119091544, 5.2163255842206295, 5.2163255842206295, 5.353235799726162, 5.353235799726162, -3.820934093367639, -3.820934093367639, 5.91552657724714, 5.91552657724714, 11.388256178794403, 11.388256178794403, 5.132994451717944, 5.132994451717944, 4.486415862475016, 4.486415862475016, 3.062604456442446, 3.062604456442446, 12.16916008878481, 12.16916008878481, 2.989811859340558, 2.989811859340558, 1.4660868918172705, 1.4660868918172705, 0.036741794368697095, 0.036741794368697095, 7.185045962451281, 7.185045962451281, 0.38478214175689085, 0.38478214175689085, 0.4133055097800773, 0.4133055097800773, 6.565683993748488, 6.565683993748488, 9.553788752072398, 9.553788752072398, 7.079098305266366, 7.079098305266366, 3.7462179826796747, 3.7462179826796747, 7.374176990434984, 7.374176990434984, 2.4936268392214034, 2.4936268392214034, 3.140615532693533, 3.140615532693533, 7.851625338280053, 7.851625338280053, 8.483946664099898, 8.483946664099898, 6.376609417562744, 6.376609417562744, 13.355047204030459, 13.355047204030459, 14.763453133371451, 14.763453133371451, 3.513672159022381, 3.513672159022381, 5.219417391928343, 5.219417391928343, 1.735921495200428, 1.735921495200428, 4.870090086747476, 4.870090086747476, 3.5045425403779054, 3.5045425403779054, 2.9358624284502084, 2.9358624284502084, 1.4283912569676196, 1.4283912569676196, 6.8382309869106015, 6.8382309869106015, 2.280170282905721, 2.280170282905721, 6.143239041834985, 6.143239041834985, 2.1812141815755175, 2.1812141815755175, 3.214667948865273, 3.214667948865273, 3.4005867836378876, 3.4005867836378876, 2.469733930063169, 2.469733930063169, 9.509877833078448, 9.509877833078448, 3.441122391502961, 3.441122391502961, 2.789046225903594, 2.789046225903594, 4.849211783683846, 4.849211783683846, -2.1597436160699335, -2.1597436160699335, 5.059023017092765, 5.059023017092765, 2.374796363709151, 2.374796363709151, 2.4388463872363104, 2.4388463872363104, 2.1967736822386006, 2.1967736822386006, 4.901657993509483, 4.901657993509483, 4.51383983515821, 4.51383983515821, 0.1793453221443451, 0.1793453221443451, -1.0298620049657425, -1.0298620049657425, 3.619982415008838, 3.619982415008838, 6.001855278768143, 6.001855278768143, -1.0370856682113994, -1.0370856682113994, 4.962172607295232, 4.962172607295232, 1.9937593830195321, 1.9937593830195321, 6.3024588295578665, 6.3024588295578665, 3.8863913971790423, 3.8863913971790423, 0.9625796405355895, 0.9625796405355895, 1.9622710285220315, 1.9622710285220315, 8.03669901760527, 8.03669901760527, 1.1526256050016948, 1.1526256050016948, 7.18489266410425, 7.18489266410425, 7.472011844650019, 7.472011844650019, -0.021380139204681403, -0.021380139204681403, 5.624156491819638, 5.624156491819638, 3.2994451334236325, 3.2994451334236325, 9.178093942556732, 9.178093942556732, 3.621099038448963, 3.621099038448963, 1.9939394467632539, 1.9939394467632539, 7.097132942511847, 7.097132942511847, 15.534353539553347, 15.534353539553347, 15.164356812793715, 15.164356812793715, 7.012684936664859, 7.012684936664859, 5.2145303279208886, 5.2145303279208886, 1.844382106940762, 1.844382106940762, 7.2914966369501775, 7.2914966369501775, -1.2447112030939638, -1.2447112030939638, 11.026368733897725, 11.026368733897725, 3.055635494611719, 3.055635494611719, 0.15700513725148246, 0.15700513725148246, 1.7070534097087473, 1.7070534097087473, 3.1452691820629832, 3.1452691820629832, 2.089181245306993, 2.089181245306993, 9.477396480153264, 9.477396480153264, 5.483403884131838, 5.483403884131838, 6.373348082867837, 6.373348082867837, 11.618533881923595, 11.618533881923595, 2.2914547872740605, 2.2914547872740605, 4.899912713385098, 4.899912713385098, 6.816618892849993, 6.816618892849993, 5.505674238184734, 5.505674238184734, 6.136803655558822, 6.136803655558822, 0.8053811041382928, 0.8053811041382928, 4.440394408272044, 4.440394408272044, 4.987063015353894, 4.987063015353894, 7.798702456179969, 7.798702456179969, 3.4123821373838306, 3.4123821373838306, 9.68395091769097, 9.68395091769097, 1.2564318429564907, 1.2564318429564907, -1.89818568775877, -1.89818568775877, 3.9483630446768885, 3.9483630446768885, 4.2591507353181655, 4.2591507353181655, 10.81601471294433, 10.81601471294433, 5.680973499258537, 5.680973499258537, 5.887246670846981, 5.887246670846981, 4.991797417395259, 4.991797417395259, 11.57841087812403, 11.57841087812403, 4.857861585512988, 4.857861585512988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28074935047452987, "mean_inference_ms": 2.1175717889876395, "mean_action_processing_ms": 0.09676412154902553, "mean_env_wait_ms": 0.581835738722234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 283500, "timesteps_this_iter": 0, "agent_timesteps_total": 850500, "timers": {"sample_time_ms": 13245.798, "sample_throughput": 254.798, "load_time_ms": 2.838, "load_throughput": 1189011.465, "learn_time_ms": 1867.556, "learn_throughput": 1807.175, "update_time_ms": 23.69}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 10.547314071655274, "policy_loss": 0.0005964250100078061, "vf_loss": 10.554561710357666, "vf_explained_var": 0.10041852593421936, "kl": 0.007669457725564604, "entropy": 0.7844018578529358, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.5590337932109832, "policy_loss": 0.0069482941180467606, "vf_loss": 1.558505231142044, "vf_explained_var": 0.6504586696624756, "kl": 0.0063439019831318996, "entropy": 0.6419857919216156, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 283500, "num_agent_steps_sampled": 850500, "num_steps_trained": 283500, "num_agent_steps_trained": 850500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11340, "training_iteration": 84, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-26-52", "timestamp": 1706106412, "time_this_iter_s": 12.310842752456665, "time_total_s": 1030.3770003318787, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1030.3770003318787, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 32.775000000000006, "ram_util_percent": 73.83124999999998, "gpu_util_percent0": 0.18875, "vram_util_percent0": 0.2119598388671875}}
{"episode_reward_max": 15.997348924655572, "episode_reward_min": -16.843303714826327, "episode_reward_mean": 1.6402525250826185, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.22011525433075, "policy_agent_": -2.0679450677180635}, "policy_reward_max": {"policy_adversary_": -3.6489145535732894, "policy_agent_": 19.317162691441105}, "policy_reward_mean": {"policy_adversary_": -13.12890830319486, "policy_agent_": 7.384580414138738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.520588042712115, 3.5153409565061793, 0.3358527393089533, 2.881623939904432, 11.655268403469002, 3.3386193389100605, 0.28408122852211803, -0.941999868731591, 6.264921787693405, -5.065979234004802, 7.888434658464044, 4.695653562410744, -10.970663135652888, -2.6024629719659607, 14.251048216785797, 2.043841005551137, 0.8029246243994311, 10.350551138613511, -0.4252497545725698, 11.55934936789493, -4.601552679794507, -1.6566382957259451, -1.3412077565155394, 3.926516836356048, -3.3151909446362215, -1.135469496677679, 0.8837239117527442, 2.0000070799207035, -3.963433680651495, -9.835926796476505, 8.312087437343633, 4.124716472898589, 6.492035734928033, 2.8362647349017474, -16.617049879935433, 5.00731263221067, -4.982494998759458, 1.3766890006210457, 1.8627816327312452, 2.6590742534327094, 0.694652288140878, -11.472246724053523, 6.991435135928429, 7.68994273865522, 1.2442831780695065, -1.5042794468360863, 0.8068844003465185, 2.500733661464077, 1.3289940329478291, 1.2546639144436653, 4.8328260142266855, 7.494295570506805, 2.452255326150376, -4.749622095339367, -5.6309864525657956, 5.920996092514431, 3.719324297247037, 12.206900384597839, -5.512877070475565, 3.3812517901271795, -2.5883501383127188, 0.399937909070216, -7.532961491340398, 7.712840457878357, -4.106220533189146, 3.215633442152462, 5.235940659292644, -0.039297864752088046, -3.124896758957661, 8.463639639918547, 3.0432813293479857, 5.508072917085366, 15.997348924655572, -2.5908139028508277, -1.2076631086373966, -0.7241998442162139, -16.843303714826327, 4.572789779871345, 13.651444753907816, 5.461152034111263, 10.767284024336773, -3.7164107515317824, 3.150890849115019, 6.305532914569383, 3.84529389720862, 3.228181520992722, -8.246084317621932, 1.051061658985324, 2.4886642370360708, 10.535938732553864, -0.9646319468683204, 0.9610249836028314, 1.5595290662712356, 4.186749760945239, 7.281442953629886, 3.5567067060645385, 2.5002970782063016, 3.453910560857386, -0.4172553939867121, -4.626443609652652, -2.3243683251998597, 3.5671903162252288, -3.838098529989386, -3.4787769531900374, 6.976213413082333, -1.0722560354067794, 8.565855563584199, -1.3491868050584575, 0.6737985122591048, 0.38394809091642124, 4.125530984959679, -2.073958473222141, -1.1264083488026233, -5.132549900712858, -5.045677080211511, 0.23237060617510996, 2.106636531606892, -5.992021801232616, 11.887382671670425, -4.629800447321979, 3.6181123102724593, 8.593920070158532, 2.667102078520729, 8.666710988308221, -0.5153161283043097, 11.145040234862346, 1.1289376372521396, 4.605816718654181, 3.625498121806843, 1.0428787037214677, 13.617033669407034, -11.589044417697583, 0.48261648201259816, 4.143477197373479, -2.7239904654868985], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.066079728526365, -13.458948335720315, -11.051501513106833, -21.508067809207223, -21.171757487375615, -22.24060007836629, -19.40406232515265, -9.750943749579449, -17.16941367738793, -17.041963814118443, -14.779043872131677, -12.743357458471763, -7.0380284267495785, -6.435329858530067, -20.876513156475347, -11.3677131284596, -12.585442388395279, -12.933798310986948, -8.843535825856726, -19.54125962039146, -19.425185866130132, -6.343560303608684, -8.009534502893652, -8.59833810125585, -4.264627037100223, -14.852192745913182, -14.27743819041028, -16.91620719450031, -8.858902147636268, -7.664312888937745, -30.22011525433075, -12.251863686457552, -15.043206994288248, -16.055293436370928, -16.84625030967534, -11.681893594193559, -6.766041756287702, -9.73837644130445, -9.230225499038548, -8.310358371722426, -15.673843519337625, -9.672599753308518, -14.813299106463127, -14.971828787057174, -18.11384176371389, -6.344663554617517, -24.844298467223076, -11.909599919879408, -17.777116948619675, -9.468105019262346, -13.490407906984943, -19.954003900749882, -8.636306468075169, -19.63022590498551, -13.657812743021404, -11.654666957140183, -11.537591575536737, -19.724302817022412, -14.648953991106314, -13.697640696374226, -23.685317704716745, -8.985363672894183, -5.178096977429864, -19.99214133724015, -11.281831278517686, -9.725290557031446, -20.53497700827274, -5.364156641497221, -8.645229429763797, -16.370994427385583, -9.39626547607658, -12.839958936901574, -22.636976458226634, -7.696654764891506, -9.618743623707491, -8.25327349534078, -12.707413579390186, -8.51825853751971, -23.23074494868211, -12.174205310626254, -18.297271187916905, -11.084497672118651, -15.866188130036075, -12.985880992499748, -9.605004534474661, -9.020999531704259, -14.546517459349872, -14.385193425938159, -10.529728369908158, -26.17219650061706, -6.870697152603377, -9.235861643492484, -6.087826721921493, -12.816828039448172, -16.169816810612375, -11.664890054959088, -7.998560853099398, -11.324962391850496, -11.199196438823707, -10.912939489092851, -24.44638871581045, -9.442985389452542, -18.271595212949812, -8.014634980597782, -12.995166203783333, -16.47531473877617, -17.63096019850375, -6.046950166878857, -9.071353394209149, -10.07438498281108, -11.28427334743832, -4.516172591566482, -12.541173587094006, -13.730426783013579, -3.6489145535732894, -8.783528626403482, -8.82772465203047, -12.636927263737832, -20.893189997716885, -14.353214812904934, -8.674878122040644, -16.017722882016827, -12.87951923984251, -18.233128509061963, -13.789246867587845, -15.072539991083769, -6.364538379649977, -10.016687555382596, -15.216134848711867, -10.13065480178987, -17.439064061748756, -13.814073475696492, -11.038044622353969, -16.25298767273735, -8.58477344824544], "policy_policy_agent__reward": [9.793333885619242, 9.793333885619242, 8.487144646113249, 8.487144646113249, 5.693677126207894, 5.693677126207894, 12.19484587455583, 12.19484587455583, 16.413512945422312, 16.413512945422312, 12.789609708638178, 12.789609708638178, 9.844071776837383, 9.844071776837383, 4.404471940423928, 4.404471940423928, 11.717167732540668, 11.717167732540668, 5.9879922900568205, 5.9879922900568205, 11.333739265297861, 11.333739265297861, 8.71950551044125, 8.71950551044125, -1.966317354451648, -1.966317354451648, 1.9164334432820522, 1.9164334432820522, 17.563780686630565, 17.563780686630565, 6.70577706700537, 6.70577706700537, 6.694183506397356, 6.694183506397356, 11.642174724800224, 11.642174724800224, 4.2091430356420805, 4.2091430356420805, 15.550304494143193, 15.550304494143193, 7.411816593167813, 7.411816593167813, 2.343461003941369, 2.343461003941369, 3.334163373189055, 3.334163373189055, 6.26242746880595, 6.26242746880595, 0.47471804623200137, 0.47471804623200137, 6.858361624617751, 6.858361624617751, 7.580581051081511, 7.580581051081511, 9.458107137210508, 9.458107137210508, 2.447734233492388, 2.447734233492388, -1.0858069537693795, -1.0858069537693795, 19.266101345837193, 19.266101345837193, 8.188290079678072, 8.188290079678072, 10.767621364608143, 10.767621364608143, 9.445779085636337, 9.445779085636337, 0.11460021486995998, 0.11460021486995998, 8.344603113202117, 8.344603113202117, 0.8917733787641229, 0.8917733787641229, 5.557532720962747, 5.557532720962747, 5.546503565884897, 5.546503565884897, 5.484716312577569, 5.484716312577569, 8.184247903739251, 8.184247903739251, -0.899823485372499, -0.899823485372499, 10.902367121195782, 10.902367121195782, 11.3308857628562, 11.3308857628562, 9.679062470891694, 9.679062470891694, 2.4201920538907147, 2.4201920538907147, 12.825591433784796, 12.825591433784796, 7.205166790671741, 7.205166790671741, 9.553055490783757, 9.553055490783757, 5.361384466853005, 5.361384466853005, 9.161616960605812, 9.161616960605812, 13.72414973562834, 13.72414973562834, 5.544280897112772, 5.544280897112772, 7.440301904823071, 7.440301904823071, 4.013413145227806, 4.013413145227806, 8.787831524827308, 8.787831524827308, 7.628457936391885, 7.628457936391885, 15.965601600810125, 15.965601600810125, 4.568038460315371, 4.568038460315371, 8.539446243250701, 8.539446243250701, 10.548483783202009, 10.548483783202009, 4.6926507909822, 4.6926507909822, -1.177432256955268, -1.177432256955268, 13.852490897559251, 13.852490897559251, 3.5878053726642705, 3.5878053726642705, 6.470461999591954, 6.470461999591954, 12.885458833782689, 12.885458833782689, 2.662429388372566, 2.662429388372566, 2.7601663354030657, 2.7601663354030657, 12.417317033652063, 12.417317033652063, 6.21977340271228, 6.21977340271228, 9.17401592699347, 9.17401592699347, 19.317162691441105, 19.317162691441105, 2.5529204310203397, 2.5529204310203397, 4.205540257535046, 4.205540257535046, 3.7645368255622835, 3.7645368255622835, -2.0679450677180635, -2.0679450677180635, 6.545524158695526, 6.545524158695526, 18.441094851294967, 18.441094851294967, 8.817678672368757, 8.817678672368757, 14.532277606126838, 14.532277606126838, 3.6840434602934353, 3.6840434602934353, 9.508539489575547, 9.508539489575547, 9.645706953534564, 9.645706953534564, 6.725149215841641, 6.725149215841641, 6.124590526348491, 6.124590526348491, 3.15021657086397, 3.15021657086397, 7.718127542461739, 7.718127542461739, 6.509196303472116, 6.509196303472116, 18.354067616585457, 18.354067616585457, 2.953032602867529, 2.953032602867529, 5.098443313547656, 5.098443313547656, 3.8236778940963627, 3.8236778940963627, 8.50178890019671, 8.50178890019671, 11.725629882121124, 11.725629882121124, 7.610798380511814, 7.610798380511814, 5.249428965652848, 5.249428965652848, 7.389436476353943, 7.389436476353943, 5.390970522418499, 5.390970522418499, 3.1432479397201023, 3.1432479397201023, 11.061010195305292, 11.061010195305292, 6.505087852838889, 6.505087852838889, 7.216748341480216, 7.216748341480216, 2.2679290137038715, 2.2679290137038715, 9.985689808432834, 9.985689808432834, 7.701529351684696, 7.701529351684696, 13.098407881043974, 13.098407881043974, 2.3488816809101984, 2.3488816809101984, 4.872575953234127, 4.872575953234127, 5.229166536863751, 5.229166536863751, 7.704902166199, 7.704902166199, 1.2211070591721693, 1.2211070591721693, 5.707382619145691, 5.707382619145691, 4.298938441150359, 4.298938441150359, -0.6983812633191117, -0.6983812633191117, 4.507949616289296, 4.507949616289296, 5.46718059181868, 5.46718059181868, 3.322452731252609, 3.322452731252609, 16.39028633469365, 16.39028633469365, 4.861707182791476, 4.861707182791476, 6.14649521615655, 6.14649521615655, 12.305821476087676, 12.305821476087676, 7.77331065918162, 7.77331065918162, 13.44991974868509, 13.44991974868509, 6.636965369641769, 6.636965369641769, 13.108790112973058, 13.108790112973058, 3.7467380084510573, 3.7467380084510573, 7.311252137018389, 7.311252137018389, 9.420816485259357, 9.420816485259357, 5.5867667527556675, 5.5867667527556675, 15.528048865577894, 15.528048865577894, 1.1125145289994574, 1.1125145289994574, 5.760330552183283, 5.760330552183283, 10.198232435055417, 10.198232435055417, 2.9303914913792686, 2.9303914913792686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.280906383987352, "mean_inference_ms": 2.1182690182206354, "mean_action_processing_ms": 0.09685237688816203, "mean_env_wait_ms": 0.5823277515946927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 286875, "timesteps_this_iter": 0, "agent_timesteps_total": 860625, "timers": {"sample_time_ms": 13107.43, "sample_throughput": 257.488, "load_time_ms": 2.938, "load_throughput": 1148662.82, "learn_time_ms": 1835.306, "learn_throughput": 1838.93, "update_time_ms": 22.949}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 14.761196613311768, "policy_loss": -0.009595315018668771, "vf_loss": 14.778921127319336, "vf_explained_var": 0.15761149525642396, "kl": 0.0064909240017132054, "entropy": 0.8129005551338195, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2.250545585155487, "policy_loss": -0.004277534410357475, "vf_loss": 2.2613909602165223, "vf_explained_var": 0.7216602683067321, "kl": 0.006566560696808321, "entropy": 0.6567989677190781, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 286875, "num_agent_steps_sampled": 860625, "num_steps_trained": 286875, "num_agent_steps_trained": 860625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11475, "training_iteration": 85, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-27-05", "timestamp": 1706106425, "time_this_iter_s": 12.820101499557495, "time_total_s": 1043.1971018314362, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4E08040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1043.1971018314362, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.081250000000004, "ram_util_percent": 73.85624999999999, "gpu_util_percent0": 0.236875, "vram_util_percent0": 0.2145538330078125}}
{"episode_reward_max": 14.57447072680122, "episode_reward_min": -13.522428870521683, "episode_reward_mean": 0.8811769714145603, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.58136783321905, "policy_agent_": -0.34772666694705473}, "policy_reward_max": {"policy_adversary_": -3.834500801284607, "policy_agent_": 19.096703056574892}, "policy_reward_mean": {"policy_adversary_": -12.518590332999311, "policy_agent_": 6.6998836522069345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7379579898698685, 3.3802762187304864, 0.6975457579236277, 0.16343618561438428, -2.036881904859421, -4.701540287790284, -4.265812819221419, 5.615121177440588, 0.30822991511828945, -2.843837633045591, 0.038682039428239556, -0.4601968451387456, 2.208066917392574, 2.590657826605485, 4.302009755366298, 2.1831983336604037, 4.4579286699562495, -4.393682957382367, 4.910646664239208, 8.78722088722922, -5.345734092665449, 8.062102162700759, 1.541813549693564, 6.235983836879274, -8.470575079608881, -3.4678897442149497, -4.5523863210466216, 12.505650974528793, -2.9493046515220955, 1.773519600833065, 2.1436032518692616, 2.4272243326587684, 0.8101595373242114, -1.1969679436945195, -5.31054649282631, -0.7018864256536193, -3.095507918212824, 1.1150408840589652, 3.734768075038635, 9.123767017874545, 9.992038473912896, -6.984802785159952, -3.4292374211128087, -0.1885836270075702, 7.4674126128750435, 1.26840365783906, 0.960028094556777, 5.638046778829564, 4.364797472832999, 5.100281489750804, -1.725856771782721, -10.209545991502596, 0.5783284164246176, 0.19610799572621956, -1.4900670216749554, -2.5604191202405904, -0.48478685139713185, -13.522428870521683, 7.773551336228968, 10.373802168334652, 11.303609096450009, 2.5040009263174383, 2.5496857899624876, -4.655168330181281, -3.368552504247603, 3.428225031522095, -7.077702567532012, 3.538213359213347, -1.6762300644058512, -8.407531401053122, 2.901032327456068, -2.156040061431834, 14.57447072680122, -2.512468144419955, -1.6982994305815926, 9.066782772332237, -0.5115977422818574, 7.7057873539114645, 2.2849708077405153, -5.098678093440273, 2.230408592606855, 11.659123915236002, 2.6560519872263986, -3.326758637640437, -0.07613088957905823, 4.507311326935039, 1.3966709565378732, 5.363441892311191, 5.46262176110598, -1.7575194664043907, 3.361746415918312, 0.16619754053391517, 9.892449917268687, 3.679277987261108, 0.662445177969397, -4.432181810716589, -0.4213087477929458, -0.7120200804001349, 9.278481022472542, -2.2067263485537945, -3.0090669805938948, 9.681276612738136, 3.6631525625290733, -0.12003552296913945, 3.898035841415207, -4.919555059300706, 0.649687735555144, -3.122749643047729, 0.23615222007755543, 1.0968640350748269, -1.1066982371182708, -3.4003198752915953, -10.866286884247991, -0.0411608883785366, 3.749841094891609, 3.300735545635196, 6.764489421390571, 2.2948295701353296, -4.4447399011067175, 1.6587832360344712, -3.8690373529732445, 1.7050016389703422, 2.767319321334563, 3.290785438405607, 4.915113739865745, 3.3535935848837797, -13.252692636073483, -1.7589812726968923, 9.011487678171155, 4.091608102776015, -6.659582975553191, 8.796810207641279, -4.775264184709795, -6.730724340637323, -2.670887558612433], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.08528186971283, -9.483186091517169, -5.340509230471227, -15.487152754779823, -20.49629936289368, -8.940400272001295, -13.025569577954276, -16.678708514373003, -7.253288031800051, -3.834500801284607, -5.348671502214236, -15.469290815237324, -9.3480409693521, -10.725058300490437, -11.612415759040909, -8.549523523821449, -15.975504428209849, -6.048075905734509, -20.593929631371207, -20.871903525172566, -6.42163394274306, -14.08744015628207, -13.545965306844298, -13.800875963381687, -15.478194949496164, -18.024763505879907, -11.166196847197266, -17.08922074151804, -15.473710788530823, -8.048077847357199, -8.30231864646683, -9.837891083828437, -8.915458934887324, -13.934376845837864, -15.81410636535306, -8.992494675794244, -6.534906271549432, -6.7412687140324365, -18.010652089933668, -13.754240276718829, -14.165524596017402, -8.657338660247797, -12.17869263123386, -13.456051900181363, -11.548972510606008, -13.554877200088864, -9.1168052555579, -14.474407410400948, -11.939646044052067, -13.506940370878638, -15.00062953354808, -15.547352719785552, -9.31821829923992, -23.828515203410525, -15.147168189886541, -5.9604402550882964, -11.627423564143093, -24.016623966245827, -15.275850596290482, -17.551288811428208, -17.856919710125556, -7.478590047372027, -12.870296672104853, -18.286507569511222, -6.375510459779633, -16.4764737686494, -18.14761951811825, -8.004919075011705, -10.383868202535934, -9.034300266677631, -9.221429765534594, -8.97900668421435, -23.618935386348557, -9.67839985701425, -11.664186305090148, -16.252701778172586, -7.1314817438691875, -14.730495214799907, -8.07604623660479, -7.816990652163274, -10.517449908728397, -17.950430610791297, -20.90153458983774, -13.833471982410183, -7.601959968038141, -15.609362770326335, -9.790797382059258, -9.700925758147607, -18.410594658997265, -18.353863398257158, -17.14539761484771, -18.531687771713987, -17.70835647714715, -8.212054972732286, -12.240902607575407, -10.097978481841444, -11.712523705399054, -11.670258060594145, -13.399237932218952, -7.9945432595803405, -17.051650050371563, -16.91721638214432, -14.7125103636851, -7.93200104959186, -12.089098667619282, -10.298152724034, -6.270864171049875, -12.715053701972796, -15.416218635444483, -11.849218395584073, -10.877191426628022, -8.236436818679516, -10.170833550353887, -7.282682069533743, -11.846636388982741, -11.820913745645623, -15.501052995508285, -8.850024715851163, -10.597884115620815, -7.779885644339337, -10.146614314499413, -9.248697965804638, -13.080017217158204, -18.230564044977033, -8.841310804455448, -9.064305257869849, -15.205320186840698, -7.671058621758549, -13.16755302446253, -12.215285556212823, -18.167033570744543, -27.58136783321905, -10.156453231578967, -8.974886886045939, -9.561817462300231], "policy_policy_agent__reward": [4.173661939921483, 4.173661939921483, 6.431731155123829, 6.431731155123829, 3.0190274941974264, 3.0190274941974264, 7.825294470197105, 7.825294470197105, 9.229708729017132, 9.229708729017132, 2.1194299921055073, 2.1194299921055073, 4.379878379366428, 4.379878379366428, 11.1469148459068, 11.1469148459068, 3.7807589734591707, 3.7807589734591707, 0.4953315841195079, 0.4953315841195079, 2.693676770821238, 2.693676770821238, 7.504546985049291, 7.504546985049291, 5.7780539433723375, 5.7780539433723375, 6.657858063547962, 6.657858063547962, 7.957212757203604, 7.957212757203604, 5.366360928740926, 5.366360928740926, 10.21671654908304, 10.21671654908304, 0.8271964741760719, 0.8271964741760719, 12.752288147805206, 12.752288147805206, 14.829562206200894, 14.829562206200894, 0.5379499250388057, 0.5379499250388057, 11.074771159491418, 11.074771159491418, 7.54388942826893, 7.54388942826893, 10.018429900130478, 10.018429900130478, 3.5038099349436433, 3.5038099349436433, 7.278436880832478, 7.278436880832478, 3.3069052630753233, 3.3069052630753233, 14.797435858023414, 14.797435858023414, 6.262203068504366, 6.262203068504366, 4.910798724095132, 4.910798724095132, 5.222960949168046, 5.222960949168046, 6.132557708243601, 6.132557708243601, 4.862809236105768, 4.862809236105768, 6.368704451071674, 6.368704451071674, 5.251779936263375, 5.251779936263375, 4.145304125070311, 4.145304125070311, 1.7196991766683043, 1.7196991766683043, 3.9281547990456995, 3.9281547990456995, 10.872710082486154, 10.872710082486154, 11.439003647296687, 11.439003647296687, 12.078781534965147, 12.078781534965147, 0.8362679375439221, 0.8362679375439221, 4.374727605060525, 4.374727605060525, 6.633734136586896, 6.633734136586896, 9.508192561740525, 9.508192561740525, 7.411640428963963, 7.411640428963963, 5.038416675057339, 5.038416675057339, 10.056227094615256, 10.056227094615256, 8.152221758442534, 8.152221758442534, 9.30361093031472, 9.30361093031472, 6.637386380882679, 6.637386380882679, 2.668903364141474, 2.668903364141474, 4.948273357832269, 4.948273357832269, 12.012311599568378, 12.012311599568378, 6.828550584105791, 6.828550584105791, 1.7000105674238546, 1.7000105674238546, 5.57131835637298, 5.57131835637298, 5.247097547862068, 5.247097547862068, 11.524700966259726, 11.524700966259726, 13.962545489881428, 13.962545489881428, 14.580264403287782, 14.580264403287782, 4.991295486844732, 4.991295486844732, 7.709991231033671, 7.709991231033671, 6.815669619664968, 6.815669619664968, 1.5034789777660134, 1.5034789777660134, 9.952349400085748, 9.952349400085748, 5.534958475293118, 5.534958475293118, 5.771566217112523, 5.771566217112523, 4.353819069065045, 4.353819069065045, 0.313384432812255, 0.313384432812255, 6.0612310464953305, 6.0612310464953305, 3.411483311391259, 3.411483311391259, 19.096703056574892, 19.096703056574892, 3.5829658562971485, 3.5829658562971485, 4.982943437254279, 4.982943437254279, 12.659742275252412, 12.659742275252412, 3.309942000793665, 3.309942000793665, 11.218141284355681, 11.218141284355681, 5.180508522172654, 5.180508522172654, 1.3591562793615013, 1.3591562793615013, 6.373929250667625, 6.373929250667625, 14.804777263013653, 14.804777263013653, 11.778793288532073, 11.778793288532073, 5.2533566723848715, 5.2533566723848715, 3.7629145392295413, 3.7629145392295413, 10.058337048630689, 10.058337048630689, 5.593734169298565, 5.593734169298565, 7.532183825229398, 7.532183825229398, 11.936608210051624, 11.936608210051624, 8.29817196592639, 8.29817196592639, 10.25357201538301, 10.25357201538301, 9.34894265612395, 9.34894265612395, 13.80040319720792, 13.80040319720792, 5.9456664799966985, 5.9456664799966985, 6.451673892772403, 6.451673892772403, 2.8328983355624255, 2.8328983355624255, 5.645607478803057, 5.645607478803057, 5.479118990097004, 5.479118990097004, 11.33885947734575, 11.33885947734575, 2.893908455513274, 2.893908455513274, 7.021291534888834, 7.021291534888834, 13.29924649744123, 13.29924649744123, 9.187831463107091, 9.187831463107091, 3.90598276331136, 3.90598276331136, 7.993567254517242, 7.993567254517242, 2.689298832366648, 2.689298832366648, 3.460275953302511, 3.460275953302511, 4.796152029462535, 4.796152029462535, 7.82618542776102, 7.82618542776102, 6.473041215329451, 6.473041215329451, 4.885246594754873, 4.885246594754873, 2.4180584716939624, 2.4180584716939624, -0.34772666694705473, -0.34772666694705473, 3.6207605905776035, 3.6207605905776035, 7.798238741937177, 7.798238741937177, 7.560824645640408, 7.560824645640408, 11.132771208449425, 11.132771208449425, 5.572427142993246, 5.572427142993246, 3.076572107257049, 3.076572107257049, 4.7193344401869055, 4.7193344401869055, 3.1387884807630844, 3.1387884807630844, 5.476849802387491, 5.476849802387491, 7.923668269246382, 7.923668269246382, 10.76067474169132, 10.76067474169132, 6.878212272160597, 6.878212272160597, 6.208949421376814, 6.208949421376814, 0.9763137753836072, 0.9763137753836072, 2.956038674530828, 2.956038674530828, 11.08952035131684, 11.08952035131684, 8.15344682949442, 8.15344682949442, 5.753725297595675, 5.753725297595675, 18.189089020430163, 18.189089020430163, 2.6905945234345867, 2.6905945234345867, 1.1220812727043092, 1.1220812727043092, 3.4454649518438996, 3.4454649518438996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28142906685799796, "mean_inference_ms": 2.120523822322824, "mean_action_processing_ms": 0.09689056822271559, "mean_env_wait_ms": 0.5827455225681775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 290250, "timesteps_this_iter": 0, "agent_timesteps_total": 870750, "timers": {"sample_time_ms": 13103.315, "sample_throughput": 257.568, "load_time_ms": 2.938, "load_throughput": 1148662.82, "learn_time_ms": 1841.614, "learn_throughput": 1832.632, "update_time_ms": 23.046}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 12.335663986206054, "policy_loss": 0.0009666049969382584, "vf_loss": 12.342937755584718, "vf_explained_var": 0.1535856008529663, "kl": 0.0020215205776890955, "entropy": 0.8240162968635559, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.6200332462787628, "policy_loss": -0.011939606489613652, "vf_loss": 1.6383729696273803, "vf_explained_var": 0.7351283699274063, "kl": 0.0054651920108354955, "entropy": 0.640022948384285, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 290250, "num_agent_steps_sampled": 870750, "num_steps_trained": 290250, "num_agent_steps_trained": 870750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11610, "training_iteration": 86, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-27-18", "timestamp": 1706106438, "time_this_iter_s": 13.284006118774414, "time_total_s": 1056.4811079502106, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E5E82040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1056.4811079502106, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 39.05882352941177, "ram_util_percent": 73.96470588235294, "gpu_util_percent0": 0.049411764705882356, "vram_util_percent0": 0.218505859375}}
{"episode_reward_max": 17.281989120601736, "episode_reward_min": -17.008080467268318, "episode_reward_mean": 0.889340468646696, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.940086849227228, "policy_agent_": -1.2984063188927002}, "policy_reward_max": {"policy_adversary_": -3.9980179820027595, "policy_agent_": 21.611037984914482}, "policy_reward_mean": {"policy_adversary_": -11.813530032265364, "policy_agent_": 6.3514352504560305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7551911306331004, -3.313949180806839, -0.14478864856750812, 2.5939865229112256, 5.731868521691039, -3.855157606800519, 4.511009874271464, 15.261433540016744, 7.737213161391861, 5.338338267711078, 3.1163940712841605, -3.6455200952469644, 8.987601486080314, -2.8421104716908956, -1.0662744597719431, -2.9189703010990558, -2.9144986238678117, -13.062794475034964, -6.1360297084976585, 3.3202186384613426, 7.543297416792059, -2.830516636710328, 5.849499939340246, -0.5127006613671465, 4.405451964550564, 0.9723561190488583, 2.1949264956506185, -2.840030410464696, 2.7084481504549927, -0.4484309202524453, -4.178291512107308, 6.4215185702305435, -1.7854794459373484, -5.918178946195194, 9.33943680444144, 4.108346384134778, 8.654348299230715, -12.957796632575024, -2.400868113972496, -4.292727004294514, -0.9929316084003762, 3.3626979246518305, -4.398843940612257, -3.800147594556255, 1.3829212470839263, -1.0760026166180556, 4.7580394662431384, -4.222249182646585, 3.3433568622317793, -1.7418164010071906, 4.909120708055448, 4.217816984545675, 0.42931866720851086, -4.5298401981433125, -3.849245031662131, -4.98918707140728, -1.5667296634743006, 1.3828547041628254, 2.4479439792430453, 4.0935622656856285, -0.7572603794647653, -2.4300990848651884, -0.6717218026169826, 2.6338762315084363, 0.8423400541087599, 6.103185599030458, 0.029951220955963476, 3.3458734895502205, 4.8251601609598405, -9.596658613924934, 1.9113980970977065, 4.2281319111845095, 5.869808601923267, 17.281989120601736, 3.2564432331925666, -5.07122916465777, 5.431166138961967, 0.4746303082910951, 5.218265441701365, 6.1190547231567916, 4.36963871372569, 0.515212687799897, -2.018502882464433, 2.3865784063715165, 7.0503578499480515, 6.432268971848887, 4.541752405617136, -2.876434485101524, 5.539940499432318, 2.241312237987193, -8.150255347294609, -5.7442328474402835, -1.4815413184374517, 1.4032318304395222, 7.973878732898942, -6.435402190281823, 4.5392165117125245, 10.041534410876524, -17.008080467268318, 4.882136794647225, 3.2720553636835716, -6.35467840365354, 2.0752400847709143, -2.5219376583056827, 4.873374376737677, -2.034148668301737, 5.2818306189048245, 4.785473134954801, 4.511981926637542, -1.1768447882254534, -16.10038860739225, 1.1746319567830654, 2.5748686093038686, 2.8122894632686934, 3.593042031129285, -5.246943982002793, 0.6619707920454208, -0.7864291306360984, 7.618929628600322, 2.664351965345637, -4.399925162518333, 1.820491108775163, 3.991937762674056, -0.13546390670482955, 2.9092754480198475, 1.4620445962655024, -3.0085361523133676, -2.0019361254629158, -4.921391174390279, 6.004903970975295, -2.2325683491105646, 3.5703681249013743, 10.445211650867167, -1.6468724580235048, -1.368571585661306], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.51384956247629, -15.26398718477941, -17.938377811189554, -13.33187486865991, -9.47844546512455, -8.663084955697565, -14.183579135744239, -25.66018727112907, -25.84598277547724, -20.918413143954485, -14.02953964058948, -12.930567863653906, -16.585760182967338, -17.763417507116582, -9.159205685191761, -7.596858844671602, -13.158541415270065, -14.110024401726054, -9.142735102357436, -13.14762603461413, -11.796473947467192, -12.793244050671772, -9.948925699301915, -15.698376892105598, -13.550431714222592, -12.681314579585214, -8.240140869225124, -11.4584096341292, -7.002344101911915, -7.851481691032188, -5.656719030016845, -23.018669645664552, -6.43025823121165, -10.936675851026724, -12.632080708946857, -22.293967762218056, -13.644707186196168, -19.638393910118793, -8.089595208746175, -15.05644078314738, -4.256194360982573, -10.725194643951061, -13.26254053614264, -7.561962320155746, -3.9980179820027595, -7.797231536308533, -7.971362057551018, -4.9812572499615255, -9.48366229955438, -13.611516621199181, -16.348754956598935, -9.833813960192906, -11.503852899521831, -12.956040884656586, -13.79397918211454, -10.67445883324056, -10.350925734355267, -9.117429348062803, -9.195739783377855, -8.604519396416977, -6.502481765830265, -5.577926265345051, -6.091058243821057, -12.353203947109048, -11.857946220297615, -16.102965143440027, -13.646459599002046, -12.673733343714877, -8.912052851805958, -14.545945398566936, -8.328385864646384, -8.429948087661073, -10.276293443174662, -25.940086849227228, -10.226628981089405, -10.249837617529698, -10.067319201751205, -5.427954410205522, -15.039582289805876, -14.311731796759268, -17.717375458988343, -12.553828636033682, -6.548620529763783, -9.606920133533778, -17.86543999733458, -11.441990714054295, -15.773891765723034, -6.880289119933256, -11.355980232508744, -17.891046055236632, -16.2616389302124, -18.508106858126492, -6.568968833291515, -10.127756819417367, -15.420253383255746, -4.609445822025949, -13.045770316317483, -16.518826755915043, -14.411267829482917, -11.906626912762306, -9.571017678934698, -8.051364726815429, -11.181526061729057, -4.4886005578211705, -11.651858092780458, -7.298029642717676, -12.411582941399617, -14.34467256919452, -10.012639686354937, -6.14941414845733, -15.087027996160822, -14.753815896966605, -12.395603987061268, -9.00564829508305, -12.60003574085282, -11.422257889400038, -8.327192291469313, -12.126352539576489, -16.88731228597786, -12.471993796845561, -8.224237982871363, -14.121727531966593, -13.07956736149485, -4.7844943370547846, -9.116303984919305, -16.71787206749705, -12.572619711211196, -9.326346676292983, -9.32362924194736, -11.777297019043825, -13.967417024360905, -10.098853281452579, -18.101294937775585, -6.982334133308231, -4.949860878644187], "policy_policy_agent__reward": [3.634520346554696, 3.634520346554696, 5.975019001986286, 5.975019001986286, 8.89679458131102, 8.89679458131102, 7.962930695785564, 7.962930695785564, 7.605156993407795, 7.605156993407795, 2.403963674448523, 2.403963674448523, 9.347294505007852, 9.347294505007852, 20.460810405572904, 20.460810405572904, 16.791597968434555, 16.791597968434555, 13.12837570583278, 13.12837570583278, 8.572966855936821, 8.572966855936821, 4.642523884203472, 4.642523884203472, 12.786680834523821, 12.786680834523821, 7.460653517712847, 7.460653517712847, 4.046465612709909, 4.046465612709909, 2.3389442717862736, 2.3389442717862736, 5.122021395701129, 5.122021395701129, 0.5236149633455495, 0.5236149633455495, 1.5033526969298896, 1.5033526969298896, 8.233922336537733, 8.233922336537733, 9.669885682129623, 9.669885682129623, 4.981363706980719, 4.981363706980719, 7.899212819321081, 7.899212819321081, 7.592838115369227, 7.592838115369227, 8.977941839386574, 8.977941839386574, 6.826835349317036, 6.826835349317036, 5.217533682437872, 5.217533682437872, 4.309189611832253, 4.309189611832253, 4.855396126183453, 4.855396126183453, 3.7015253853898704, 3.7015253853898704, 0.7392137589547689, 0.7392137589547689, 14.720094107947546, 14.720094107947546, 2.32238939263715, 2.32238939263715, 2.5092484524157648, 2.5092484524157648, 10.985758756694148, 10.985758756694148, 13.20115707317642, 13.20115707317642, 11.14952774271344, 11.14952774271344, 3.340298638771879, 3.340298638771879, 2.8443635473868407, 2.8443635473868407, 5.381856889426432, 5.381856889426432, 1.6316313762910981, 1.6316313762910981, 7.0439462843014455, 7.0439462843014455, 4.431848297765191, 4.431848297765191, 1.8809073627997448, 1.8809073627997448, 2.690469614543343, 2.690469614543343, 3.360614459845238, 3.360614459845238, 6.364700761897079, 6.364700761897079, 0.3795040336574731, 0.3795040336574731, 6.413509580893079, 6.413509580893079, 5.934850110095995, 5.934850110095995, 10.628937832327193, 10.628937832327193, 7.025815472369291, 7.025815472369291, 5.96658578336517, 5.96658578336517, 4.213100343256638, 4.213100343256638, 4.972367075226202, 4.972367075226202, 2.842635880916643, 2.842635880916643, 4.392098035440483, 4.392098035440483, 5.250142026112816, 5.250142026112816, 5.82184188131045, 5.82184188131045, 6.349040831051303, 6.349040831051303, 2.8726106931827506, 2.8726106931827506, 1.5739135902399313, 1.5739135902399313, 2.7096682206020373, 2.7096682206020373, 7.493540089308744, 7.493540089308744, 6.3501431372031885, 6.3501431372031885, 11.103075371235246, 11.103075371235246, 6.8382054099790075, 6.8382054099790075, 8.00980341663255, 8.00980341663255, 6.868606506382901, 6.868606506382901, 2.474643392320994, 2.474643392320994, 5.119891980872046, 5.119891980872046, 6.329039999422789, 6.329039999422789, 8.073051022548965, 8.073051022548965, 21.611037984914482, 21.611037984914482, 6.741536107140988, 6.741536107140988, 2.589304226435962, 2.589304226435962, 7.749242670356587, 7.749242670356587, 2.9512923592483076, 2.9512923592483076, 10.12892386575362, 10.12892386575362, 10.215393259958025, 10.215393259958025, 11.043507086357016, 11.043507086357016, 6.534520661916792, 6.534520661916792, 2.265058823649675, 2.265058823649675, 5.996749269952648, 5.996749269952648, 12.457898923641313, 12.457898923641313, 8.93712984295159, 8.93712984295159, 10.157822085670087, 10.157822085670087, 2.001927317415866, 2.001927317415866, 8.447960365970534, 8.447960365970534, 10.066179146611905, 10.066179146611905, 4.055691791458893, 4.055691791458893, 6.381937005343107, 6.381937005343107, 2.5437137574270325, 2.5437137574270325, 5.7654943249284445, 5.7654943249284445, 11.697066058077352, 11.697066058077352, -0.912978184127937, -0.912978184127937, 8.792493414015004, 8.792493414015004, 13.280180583395781, 13.280180583395781, -1.2984063188927002, -1.2984063188927002, 8.394381853704765, 8.394381853704765, 6.421536521309137, 6.421536521309137, 0.8483431615809442, 0.8483431615809442, 6.628383073249983, 6.628383073249983, 0.9833314497577443, 0.9833314497577443, 8.26261623475907, 8.26261623475907, 2.6319404872079684, 2.6319404872079684, 8.846706780152221, 8.846706780152221, 9.565072852074659, 9.565072852074659, 7.2623108064962345, 7.2623108064962345, 2.486284680115939, 2.486284680115939, -0.5066803056157126, -0.5066803056157126, 7.964223926874836, 7.964223926874836, 7.485236298182567, 7.485236298182567, 5.908968879175872, 5.908968879175872, 8.096538885991052, 8.096538885991052, 3.0876569536986223, 3.0876569536986223, 4.494581541757365, 4.494581541757365, 5.669961704470198, 5.669961704470198, 12.253120957289093, 12.253120957289093, 7.568172881095599, 7.568172881095599, 1.9121564101765143, 1.9121564101765143, 7.97110932037088, 7.97110932037088, 8.535752562084452, 8.535752562084452, 2.324515215174977, 2.324515215174977, 6.012789716469578, 6.012789716469578, 9.089958331881276, 9.089958331881276, 4.782041779448915, 4.782041779448915, 3.6622052754150345, 3.6622052754150345, 2.201119033778541, 2.201119033778541, 8.89110049500956, 8.89110049500956, 5.867424337625172, 5.867424337625172, 6.834610703176976, 6.834610703176976, 14.273253294321373, 14.273253294321373, 2.6677308376423623, 2.6677308376423623, 1.7906446464914398, 1.7906446464914398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28154653219877024, "mean_inference_ms": 2.121765712436197, "mean_action_processing_ms": 0.09695131474054028, "mean_env_wait_ms": 0.5829722147777722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 293625, "timesteps_this_iter": 0, "agent_timesteps_total": 880875, "timers": {"sample_time_ms": 13102.129, "sample_throughput": 257.592, "load_time_ms": 2.938, "load_throughput": 1148662.82, "learn_time_ms": 1898.142, "learn_throughput": 1778.055, "update_time_ms": 24.345}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 11.460340881347657, "policy_loss": 0.006671468378044665, "vf_loss": 11.461706066131592, "vf_explained_var": 0.16690491437911986, "kl": 0.00666418081097051, "entropy": 0.8037024915218354, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.6847478747367859, "policy_loss": -0.024115294450893998, "vf_loss": 1.71528599858284, "vf_explained_var": 0.7078412026166916, "kl": 0.005464250742705295, "entropy": 0.6422977298498154, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 293625, "num_agent_steps_sampled": 880875, "num_steps_trained": 293625, "num_agent_steps_trained": 880875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11745, "training_iteration": 87, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-27-32", "timestamp": 1706106452, "time_this_iter_s": 13.380828380584717, "time_total_s": 1069.8619363307953, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4DB4E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1069.8619363307953, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 36.76470588235294, "ram_util_percent": 74.18823529411766, "gpu_util_percent0": 0.033529411764705884, "vram_util_percent0": 0.21639476102941177}}
{"episode_reward_max": 13.215988441141786, "episode_reward_min": -13.806850714563726, "episode_reward_mean": 0.09995600376498776, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.855470127075087, "policy_agent_": -0.7641047671112077}, "policy_reward_max": {"policy_adversary_": -4.265431908547858, "policy_agent_": 18.29578170266675}, "policy_reward_mean": {"policy_adversary_": -11.875536656235086, "policy_agent_": 5.9877463300000375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.7084600867226718, 5.707292850688535, -9.990138874290203, -3.57201949944606, 4.276320942324262, 3.638707576179512, -2.8686471477226165, -0.11179204758813654, -1.6556401557810545, -3.0000510138363228, -3.8890018066132703, 0.851361367423012, -6.914236805793376, 8.82207426367151, -2.400188409297977, 1.8637586198739116, 2.885327407858028, 5.8073543099894955, 2.6010538166646353, -1.5414582296309738, 2.0366919028247814, -1.0162637533338879, 2.414141394960159, -1.288883579929348, 5.193139220930325, 2.880686515629017, 5.18094553595285, 3.1411339448299413, -4.490555587937576, -10.923269208309625, -0.5420186788690726, -8.654390266437582, -3.128994792543099, -5.3898601017522, 1.5741157148521987, 1.2309085481086826, 2.9999837001907244, 7.657134625777211, 6.249094001437522, 6.374313281761663, -2.018107806781291, 11.884882173908146, 7.664340860466092, 3.1967305889921196, -13.623458691828828, 2.485598149801944, 10.957189933990783, -5.62672150800346, -4.557694163675685, -1.695036616893014, -3.1097490650811666, 7.589134014906001, 2.2551710866063175, -6.38684631615943, 4.63395718379494, -0.3028047323977648, 1.7246281017983258, 7.474208379693233, 3.0137864263224334, -0.13384568337332492, 0.462299953505806, 2.606793686135847, 5.146945575281645, 0.25300898760576884, 3.185515127427834, -2.2581507098268334, -1.215033190944794, 1.95382009021252, 2.0833803869543774, -7.951874148036681, -9.340630624368652, -11.821419537327772, 7.278749879804173, 5.961212223783811, -3.5427955101709667, -3.29497403537472, 0.46779536661348825, 4.134526923549817, -3.090508790599558, 0.5334016503128023, -5.423628255136741, 1.1504645468348949, 3.2698258749431863, -4.471324411194296, 0.9381327273488891, -6.319520809415197, 6.338271127912461, -5.465100107395911, -0.9829182305133666, 7.415442285714944, -5.300032206818874, -0.8900786611731382, -1.340338700622142, -13.806850714563726, -11.961475511214394, 7.772718426068224, 2.4403654610123, -8.514997667742145, -3.01183710799125, -3.578557179284548, -0.28623473324256055, 1.4512433235848456, -6.373736779041645, 3.1310106713938826, 1.6799785657646633, 1.9052694969957134, 0.9280566370459112, -3.431507303519632, 1.6250889218458426, 0.036060642579152646, -10.06081441413139, 1.2261413173654505, -3.33474335802842, 1.6669206056104167, 10.52082798835676, 1.9004300071139262, 5.771394034073786, -0.4794127311328043, 1.672700314651998, 2.2617466260197476, -8.602153305025153, 3.556261338825899, 2.906114248713239, -1.95862613419475, 4.401071038687519, -7.379698993230687, -0.654041805552506, 5.169211650189851, 13.215988441141786, -2.530094359347861, -10.194332025867476, 4.7808486097560055, 1.8887784447369096, 7.8440311554543, 3.7046263671942543], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.346698898946276, -12.243192655266133, -11.421597776862486, -7.641159808610073, -16.033971307376135, -11.300622870104444, -10.500037034637469, -5.485937336031739, -7.878026980582253, -23.855470127075087, -11.355827442821337, -6.071144083728527, -6.635445729186122, -14.59527248605124, -7.484803946632478, -16.599617397448135, -7.1303044226004735, -13.571627492809947, -9.57907963399712, -7.618286754964169, -8.111568387743507, -7.310985905340962, -12.804042530602112, -6.972558374501999, -11.219063127723551, -20.688072483475164, -14.289400305634478, -8.729130200794996, -9.907674096012439, -18.87632522210354, -12.161791956328777, -15.702676476541587, -14.779166595109626, -13.221506183929245, -11.908238578327015, -10.84937436318948, -13.03397726147822, -15.148058928545373, -14.197037063301199, -13.72140225962253, -8.483273427607608, -17.401215901535007, -14.845398420581475, -6.694153579156191, -21.4022243683229, -15.265557507474073, -18.52501359130802, -8.01132034217616, -11.83457902086474, -7.859523451484852, -4.867939037293821, -17.751807409294607, -5.684653231069792, -18.976299192387334, -14.038436372159422, -20.02043740702057, -12.545672562889582, -15.298808255391078, -11.245545550172627, -7.15926170111673, -16.148347158668454, -9.6114821907032, -12.973645322278527, -14.524767478928617, -7.138703568587222, -12.097883622698667, -12.638100611186207, -8.060708549103934, -6.641686840594593, -8.864002702495656, -13.50231262983502, -11.574513450757756, -12.229388783248334, -13.313127865049644, -13.505691812193897, -14.931397868070366, -8.613828884753914, -19.79720727770755, -11.880333720627462, -9.86679686562312, -21.233222334409874, -6.484695685841661, -10.02031941635327, -14.285666114722178, -10.440918023236724, -8.068342495670443, -9.885741925333198, -7.620285872099243, -9.26032966161332, -19.561801703214915, -14.93056649829182, -8.668317723786307, -23.591902972285514, -20.133711934078818, -12.049530328361445, -15.047748043463, -9.460542650018047, -11.190872459180317, -6.484344255986956, -14.144726836760716, -11.412060115497486, -7.763552001120341, -11.563456701603302, -9.226150359043826, -10.403248614519192, -9.063846429328741, -7.2729015935893635, -12.864851333067143, -10.273528924690375, -9.51504330990788, -11.541318113509593, -4.265431908547858, -11.252829137454306, -8.820932299347001, -15.864369621524977, -11.78935385090072, -20.998746609910896, -8.842950251273578, -6.547472713721792, -7.425016415926255, -13.200016297035651, -10.789218787057736, -9.462675973313264, -18.56627816979897, -9.313858863935215, -5.851489459008272, -7.255790852208611, -10.998502004541866, -23.375574964191717, -7.474514899634176, -17.201791064994456, -12.382986551475488, -8.239089578420035, -15.45012622659275, -7.559665641879861], "policy_policy_agent__reward": [4.319119406111802, 4.319119406111802, 8.975242752977335, 8.975242752977335, 0.7157294512861445, 0.7157294512861445, 2.034570154582007, 2.034570154582007, 10.1551461248502, 10.1551461248502, 7.469665223141975, 7.469665223141975, 3.8156949434574257, 3.8156949434574257, 2.6870726442218005, 2.6870726442218005, 3.1111934124006, 3.1111934124006, 10.42770955661938, 10.42770955661938, 3.7334128181040316, 3.7334128181040316, 3.4612527255757697, 3.4612527255757697, -0.13939553830362733, -0.13939553830362733, 11.708673374861377, 11.708673374861377, 2.5423077686672513, 2.5423077686672513, 9.231688008661026, 9.231688008661026, 5.007815915229249, 5.007815915229249, 9.689490901399719, 9.689490901399719, 6.090066725330879, 6.090066725330879, 3.0384142626665964, 3.0384142626665964, 5.074130145284143, 5.074130145284143, 3.1473610760035378, 3.1473610760035378, 7.609091962781137, 7.609091962781137, 2.8418373972863256, 2.8418373972863256, 8.206101174326939, 8.206101174326939, 11.784379499552088, 11.784379499552088, 9.735172920793662, 9.735172920793662, 5.93513207281247, 5.93513207281247, 2.708559254037434, 2.708559254037434, 3.97652800689696, 3.97652800689696, 5.809886638729852, 5.809886638729852, 3.5241431050520027, 3.5241431050520027, 5.825085901283263, 5.825085901283263, 3.9158230410885264, 3.9158230410885264, 6.7411771465896075, 6.7411771465896075, 6.040141455649081, 6.040141455649081, 8.016980480834473, 8.016980480834473, 11.402596777161294, 11.402596777161294, 10.223065532369365, 10.223065532369365, 10.047857770692094, 10.047857770692094, 3.2325828104131595, 3.2325828104131595, 14.643049037721578, 14.643049037721578, 11.254869640523788, 11.254869640523788, 4.945442084074156, 4.945442084074156, 3.8893828382470406, 3.8893828382470406, 8.875577828638008, 8.875577828638008, 14.7411017626494, 14.7411017626494, 1.192299417086351, 1.192299417086351, 3.638442428594526, 3.638442428594526, 3.0822434172959197, 3.0822434172959197, 0.8790949861063271, 0.8790949861063271, 12.6704707121003, 12.6704707121003, 3.969912158838055, 3.969912158838055, 6.294726438113953, 6.294726438113953, 9.33619677797718, 9.33619677797718, 9.858816337311403, 9.858816337311403, 7.135150332343958, 7.135150332343958, 11.386508317542159, 11.386508317542159, 7.12966598824753, 7.12966598824753, 3.5127080088717024, 3.5127080088717024, 8.30532355608713, 8.30532355608713, 6.109137938419525, 6.109137938419525, 9.060295448780085, 9.060295448780085, 7.388888233267194, 7.388888233267194, 5.1621093480075295, 5.1621093480075295, 4.919866456435918, 4.919866456435918, 5.711533710120706, 5.711533710120706, 5.007264319658228, 5.007264319658228, 4.362533613774486, 4.362533613774486, 0.4560642772294844, 0.4560642772294844, 2.0808410027331874, 2.0808410027331874, -0.12345304328500645, -0.12345304328500645, 9.754069331526255, 9.754069331526255, 9.637170044416731, 9.637170044416731, 4.981448151011463, 4.981448151011463, 5.81821191634782, 5.81821191634782, 4.540812125683702, 4.540812125683702, 11.965867100628683, 11.965867100628683, 4.394912465013952, 4.394912465013952, 5.200099257967963, 5.200099257967963, 7.904797039636562, 7.904797039636562, 3.817580116338277, 3.817580116338277, 6.645072645648228, 6.645072645648228, 4.907170851763945, 4.907170851763945, 5.689525375292806, 5.689525375292806, 0.8744108431276234, 0.8744108431276234, 8.112006526622828, 8.112006526622828, 1.0775928823516647, 1.0775928823516647, 4.1387057155499765, 4.1387057155499765, 13.48862199446493, 13.48862199446493, 4.815267145736476, 4.815267145736476, 3.889119531306584, 3.889119531306584, 11.12578213583168, 11.12578213583168, 3.16343060975754, 3.16343060975754, 0.044027408573528604, 0.044027408573528604, 11.41023323476561, 11.41023323476561, 5.9504540555151735, 5.9504540555151735, 1.3379373957190857, 1.3379373957190857, 1.7362535739978517, 1.7362535739978517, 5.283084828738088, 5.283084828738088, 5.5629126911274644, 5.5629126911274644, 4.607397662352593, 4.607397662352593, 2.5948599612808287, 2.5948599612808287, 6.178580515218851, 6.178580515218851, 6.041613590141927, 6.041613590141927, 5.484557963162227, 5.484557963162227, 4.100479115317638, 4.100479115317638, 4.7166720147737555, 4.7166720147737555, 5.9493089232681085, 5.9493089232681085, 4.775551976243516, 4.775551976243516, 0.7402518496891062, 0.7402518496891062, 2.7457866129566537, 2.7457866129566537, 3.9590428897129435, 3.9590428897129435, 5.243926452478709, 5.243926452478709, 13.192598804940868, 13.192598804940868, 6.844891929007322, 6.844891929007322, 13.385070321992343, 13.385070321992343, 4.181768760070387, 4.181768760070387, 4.110086514186893, 4.110086514186893, 4.843381520973001, 4.843381520973001, 2.298931496005249, 2.298931496005249, 7.172740062941815, 7.172740062941815, 6.1843951110132505, 6.1843951110132505, 8.30382601780211, 8.30382601780211, 6.857464951311368, 6.857464951311368, -0.7641047671112077, -0.7641047671112077, 3.3008745233280528, 3.3008745233280528, 8.083856827365858, 8.083856827365858, 18.29578170266675, 18.29578170266675, 2.4722102701431576, 2.4722102701431576, 3.503729519563487, 3.503729519563487, 8.581917580615745, 8.581917580615745, 5.063934011578471, 5.063934011578471, 11.647078691023529, 11.647078691023529, 5.632146004537058, 5.632146004537058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28185636289076965, "mean_inference_ms": 2.1253209899323044, "mean_action_processing_ms": 0.0970824818490912, "mean_env_wait_ms": 0.583970586738594, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 297000, "timesteps_this_iter": 0, "agent_timesteps_total": 891000, "timers": {"sample_time_ms": 13270.486, "sample_throughput": 254.324, "load_time_ms": 2.938, "load_throughput": 1148653.5, "learn_time_ms": 1902.889, "learn_throughput": 1773.619, "update_time_ms": 24.547}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 10.966744232177735, "policy_loss": -0.010011445730924606, "vf_loss": 10.984680080413819, "vf_explained_var": 0.20001046657562255, "kl": 0.003974030348223634, "entropy": 0.792468535900116, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.5401904940605164, "policy_loss": 0.016961240879027173, "vf_loss": 1.5294858455657958, "vf_explained_var": 0.6939639568328857, "kl": 0.0044038190323195, "entropy": 0.6256739616394043, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 297000, "num_agent_steps_sampled": 891000, "num_steps_trained": 297000, "num_agent_steps_trained": 891000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11880, "training_iteration": 88, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-27-45", "timestamp": 1706106465, "time_this_iter_s": 13.8173987865448, "time_total_s": 1083.67933511734, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8E4D731F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1083.67933511734, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 41.766666666666666, "ram_util_percent": 74.46666666666667, "gpu_util_percent0": 0.15555555555555556, "vram_util_percent0": 0.2224392361111111}}
{"episode_reward_max": 10.886424355929208, "episode_reward_min": -16.743156677667745, "episode_reward_mean": 0.35348077492639113, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.363467326243295, "policy_agent_": -1.259830058766418}, "policy_reward_max": {"policy_adversary_": -3.9163928880886005, "policy_agent_": 15.058402128290952}, "policy_reward_mean": {"policy_adversary_": -11.665324348454227, "policy_agent_": 6.009402561690309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5207448559844625, 2.6489008813633665, 10.681842120442282, -1.5404419133973348, 0.3905260244116546, 5.898449696378118, -0.5047531277376711, 2.3226751351420125, -2.6686651209147714, -0.2046329768286247, -0.7306015066281561, 0.49062856088443246, 0.18150796493178384, -0.45003679281760095, 7.08566830609244, -1.3830712036263075, -1.4855080308201436, 5.09426865605656, -11.98913882536161, -16.743156677667745, 5.637203990908111, -4.59365708128757, -6.602705289058472, 2.8876948168682093, 9.988102853936608, -3.1954751933027965, -5.873884237598488, 2.1115957275864696, -5.383720506474667, 1.2965273259872738, -2.082652589049265, 2.102514111582961, 3.555820351001178, 4.325721468787361, 6.428609650948355, 9.032486838280219, 1.1565410894057877, 3.425737916009514, -3.2177588366573877, -1.789061688256709, -0.9361929320035558, -5.22594604404622, 0.27786836166361556, 0.9555609399097479, -2.502241702902923, -4.100992014547311, -2.6615746343605586, -2.5403661706794827, 4.815614200253292, 1.2193545251373192, 3.2312962399953697, 8.550528103040614, 0.269760606784637, 1.0789841306953303, 5.119414177236466, -10.069959122803523, -1.8488250713431262, 3.0650350068826344, -1.4414148376689238, -1.1015285687744734, 7.362050899370338, 4.848616716568949, -12.603096681886804, -4.0112226005754765, 9.534111225237227, -3.752618660120694, 0.5543409065794271, -1.2214771565139064, -0.14729133641826642, 0.04297649701036288, 2.9578947911084628, -7.779827266645786, 5.43560622351491, -1.8894578681621481, -6.414153218899894, -0.6311010357821143, -2.4796387725712528, 8.191304545749098, -1.2439201768117538, 8.613788164867204, -1.5202342531230348, -5.716034166558768, 0.42227619389327603, 6.504789554053301, -8.229877151463858, -1.316215286866047, 0.5568071789577687, 9.718349926562912, -3.422093638724318, 6.059997460277135, 1.2066604113014143, 3.365928621028678, -3.4821556758110663, 3.212728666269446, -0.7240225642726905, 6.254269210225293, 3.0010360888478242, 5.9973388664720195, 1.7913084822030565, -9.132231248079693, 3.0473688643115, 0.07625452151884266, 0.5964858982158541, 3.1267927636177157, -4.971825641009673, 10.886424355929208, 5.585101509103116, 1.8973725221417794, 6.009366940418136, 4.702974254061243, -4.267962120040314, -5.91116207655784, 0.678733295917792, 0.3688643340362164, -8.381506087896105, 0.8472609792890784, 3.583689784984498, 1.025419858929841, 8.508516423229793, 0.9837163613548291, -8.360979362427003, 8.2480034932967, -0.251530532247798, -2.8396380139003474, 1.6172940295867053, 6.858044491536772, 0.07682013510037138, -2.235697097284644, 4.915087104231811, -15.167707377317775, 3.8490507536030014, -3.894025011001271, -0.7190710786099332, -5.412298233711369, -2.2500692361312407], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.28756183465875, -8.52557601830172, -15.306622642437963, -8.05391805898441, -7.822994122784007, -11.30783639463366, -13.963137996587221, -12.350294837982416, -10.700760584058125, -3.9163928880886005, -9.115592464585987, -5.770244425177427, -7.177817493234418, -7.920999275954099, -14.015556629250423, -8.532139163667155, -15.02712177505034, -9.717671256690902, -15.090116226994096, -24.363467326243295, -14.272952842356524, -9.314992434711158, -10.289685207111045, -11.913342285373988, -20.12870140264529, -9.333267298973444, -5.097365820614526, -8.084445738490452, -12.66643028248112, -11.935456787857685, -7.766315045509305, -8.040189721491675, -14.466571964107414, -15.210553115956385, -18.299092710524427, -15.829147737469999, -9.753801572839318, -12.945492010510344, -12.523976074902844, -7.180555231297793, -6.0932013617513885, -12.713573366066994, -8.023793504182775, -8.653761442506525, -7.3785759853156065, -11.769289397837795, -7.3318096872089935, -15.412050150641395, -13.122649462225846, -10.939668902875622, -13.135464618893003, -19.029805632116354, -6.121028023845476, -14.086281650272626, -13.035422920748513, -20.770278969059355, -15.71298840680378, -11.781278798797079, -5.579924437121556, -9.57235405653653, -12.972082295390571, -9.709218450769665, -14.020911217790323, -6.847180030047811, -20.046479372647376, -10.708583487005756, -16.364850781886517, -18.003477098802833, -7.77882604040253, -6.765023150032601, -6.880440326864838, -10.060749602356092, -15.496967522462972, -17.32883235286434, -6.363140064615642, -6.520860770403882, -6.010069172519403, -15.163090783294253, -6.740800380683621, -12.993527361607866, -10.800953713833428, -10.836985855845477, -12.335032466167311, -13.811976504204171, -11.498718729124944, -8.878933055248318, -13.08428511572529, -15.558917688961584, -13.151575010625702, -11.641606290141894, -5.117650280915388, -15.892882322852694, -8.26614986521451, -12.422373869293454, -17.559028777200442, -10.196525888085413, -9.184395372573489, -15.201618851248265, -7.0538230351592714, -17.941004123215915, -8.275051107220394, -10.284058158689028, -15.4517478321635, -12.20604910991644, -9.211918985285713, -16.975835634494995, -10.952196938687761, -6.922660632788119, -18.697539193882722, -12.002125973588214, -21.831863093640944, -7.946558582712024, -6.458297858376407, -14.659681296404695, -12.830687254086975, -6.973323405022234, -9.133799322952065, -9.014303530142765, -13.476365370523983, -11.405841853114987, -13.774902353589852, -18.297499682075223, -6.514700647379691, -15.628915338566442, -17.660577369017037, -12.377419126315004, -6.33271553993052, -7.543427114021182, -19.7072106309932, -12.648047259784942, -16.663564418112003, -7.077964976474052, -7.5636115766103424, -13.127477019225426, -10.699944302048907], "policy_policy_agent__reward": [7.904153345321608, 7.904153345321608, 5.587238449832542, 5.587238449832542, 12.994232381440126, 12.994232381440126, 3.256738072793537, 3.256738072793537, 4.106760073597831, 4.106760073597831, 8.603143045505885, 8.603143045505885, 6.729192434424775, 6.729192434424775, 7.336484986562216, 7.336484986562216, 4.016047731571675, 4.016047731571675, 1.8558799556299879, 1.8558799556299879, 4.192495478978915, 4.192495478978915, 3.130436493030929, 3.130436493030929, 3.679662729083101, 3.679662729083101, 3.7354812415682486, 3.7354812415682486, 10.55061246767143, 10.55061246767143, 3.574533980020422, 3.574533980020422, 6.770806872115095, 6.770806872115095, 7.405969956373732, 7.405969956373732, 1.5504887008162427, 1.5504887008162427, 3.8101553242877837, 3.8101553242877837, 9.955078416632317, 9.955078416632317, 2.360667676711792, 2.360667676711792, 1.843489959026285, 1.843489959026285, 7.400518551121099, 7.400518551121099, 15.058402128290952, 15.058402128290952, 3.0688960528353246, 3.0688960528353246, -0.3882592084919805, -0.3882592084919805, 5.098020733038459, 5.098020733038459, 3.641354888003226, 3.641354888003226, 6.61599205692248, 6.61599205692248, 2.8418312282300207, 2.8418312282300207, 5.07135191653732, 5.07135191653732, 9.011196157554298, 9.011196157554298, 9.76813729237187, 9.76813729237187, 12.363851180736388, 12.363851180736388, 12.430817287875112, 12.430817287875112, 5.455171331122554, 5.455171331122554, 8.185614963259932, 8.185614963259932, 4.653108619122728, 4.653108619122728, 2.695746771520542, 2.695746771520542, 2.578504214873916, 2.578504214873916, 3.7438136610103863, 3.7438136610103863, 4.150830932923196, 4.150830932923196, 4.804661191208137, 4.804661191208137, 2.4381671412063417, 2.4381671412063417, 3.834148691645239, 3.834148691645239, 2.3351175264242165, 2.3351175264242165, 6.435841989980952, 6.435841989980952, 8.969131831239567, 8.969131831239567, 6.079511714006474, 6.079511714006474, 8.183380429444188, 8.183380429444188, 13.79016686757848, 13.79016686757848, 3.1953943153150566, 3.1953943153150566, 7.582632890483981, 7.582632890483981, 9.07741854899249, 9.07741854899249, 5.350159923127909, 5.350159923127909, 6.932081667730328, 6.932081667730328, 7.423156902839855, 7.423156902839855, 2.0692547997263144, 2.0692547997263144, 4.235412743881031, 4.235412743881031, 10.167066597380453, 10.167066597380453, 7.278917583669306, 7.278917583669306, 0.7089072679517653, 0.7089072679517653, 1.4179787147361667, 1.4179787147361667, 14.790295298942302, 14.790295298942302, 3.4779824134425317, 3.4779824134425317, 8.459595844232972, 8.459595844232972, 8.390999971144467, 8.390999971144467, 3.8157673519921325, 3.8157673519921325, 3.4039998235214814, 3.4039998235214814, 4.91916755898665, 4.91916755898665, 1.1404611678551542, 1.1404611678551542, 10.46628687298894, 10.46628687298894, 7.719687242351094, 7.719687242351094, -0.02550657714212537, -0.02550657714212537, 2.944879867310884, 2.944879867310884, 1.7652151999740755, 1.7652151999740755, 11.677197664521678, 11.677197664521678, 2.7484401019359335, 2.7484401019359335, 10.803657763237533, 10.803657763237533, 4.640359730355196, 4.640359730355196, 2.560475844643357, 2.560475844643357, 6.378654330030293, 6.378654330030293, 10.158383029128737, 10.158383029128737, 1.634420788830543, 1.634420788830543, 3.7813588841911354, 3.7813588841911354, 6.82054614734153, 6.82054614734153, 12.638633807762247, 12.638633807762247, 4.864740685950692, 4.864740685950692, 8.85080187520951, 8.85080187520951, 3.162155346108402, 3.162155346108402, 9.629405471940688, 9.629405471940688, 2.3919970947017255, 2.3919970947017255, 7.8175512677814485, 7.8175512677814485, 8.417503106463874, 8.417503106463874, 8.225397549155353, 8.225397549155353, 6.092715730710655, 6.092715730710655, 10.599478858860143, 10.599478858860143, 4.422565758681165, 4.422565758681165, 4.404386437568115, 4.404386437568115, 5.661209985765947, 5.661209985765947, 5.1801563401039346, 5.1801563401039346, 8.024116865189677, 8.024116865189677, 7.666420936767077, 7.666420936767077, 2.1200466721380202, 2.1200466721380202, 13.931129995212103, 13.931129995212103, 8.268649223895439, 8.268649223895439, 4.410016577464949, 4.410016577464949, 12.353453067150435, 12.353453067150435, 8.35255011382473, 8.35255011382473, 8.781950486800318, 8.781950486800318, 1.017698253077091, 1.017698253077091, 3.5685155771471, 3.5685155771471, 7.5142728152204565, 7.5142728152204565, 2.224590583095434, 2.224590583095434, 3.9102921921556564, 3.9102921921556564, 6.358744553968282, 6.358744553968282, 5.019861694536301, 5.019861694536301, 10.992440896876888, 10.992440896876888, 6.1947791072349085, 6.1947791072349085, 2.7069614955814267, 2.7069614955814267, 13.27275158768596, 13.27275158768596, 3.1315850575659456, 3.1315850575659456, 6.394638662333049, 6.394638662333049, 9.638935699301873, 9.638935699301873, 9.617731808925889, 9.617731808925889, 3.204767837515446, 3.204767837515446, 2.653865008368268, 2.653865008368268, 12.311148867612506, 12.311148867612506, -1.259830058766418, -1.259830058766418, 10.256307585857504, 10.256307585857504, 1.5919699827363916, 1.5919699827363916, 3.4222702490002055, 3.4222702490002055, 3.8575893927570273, 3.8575893927570273, 4.224937532958834, 4.224937532958834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28197842753198926, "mean_inference_ms": 2.1258698748782807, "mean_action_processing_ms": 0.09707664102363525, "mean_env_wait_ms": 0.584144194063648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 300375, "timesteps_this_iter": 0, "agent_timesteps_total": 901125, "timers": {"sample_time_ms": 13224.523, "sample_throughput": 255.208, "load_time_ms": 2.938, "load_throughput": 1148653.5, "learn_time_ms": 1878.562, "learn_throughput": 1796.587, "update_time_ms": 24.346}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005000000000000001, "total_loss": 10.007899951934814, "policy_loss": -0.017450500652194022, "vf_loss": 10.033229064941406, "vf_explained_var": 0.22521024346351623, "kl": 0.003576275611134627, "entropy": 0.7879166662693023, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.408510798215866, "policy_loss": 0.012639406323432922, "vf_loss": 1.4020258128643035, "vf_explained_var": 0.7289021164178848, "kl": 0.005491044810457068, "entropy": 0.6154510915279389, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300375, "num_agent_steps_sampled": 901125, "num_steps_trained": 300375, "num_agent_steps_trained": 901125, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 12015, "training_iteration": 89, "trial_id": "3458f_00000", "experiment_id": "973765ce6b9e457795ea0240ba7ec597", "date": "2024-01-24_15-27-58", "timestamp": 1706106478, "time_this_iter_s": 12.537254810333252, "time_total_s": 1096.2165899276733, "pid": 10800, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 25, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000001D8FDBC7AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1096.2165899276733, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.4625, "ram_util_percent": 74.46875, "gpu_util_percent0": 0.034375, "vram_util_percent0": 0.2177581787109375}}
