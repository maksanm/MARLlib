{"episode_reward_max": 45.89313045391471, "episode_reward_min": -71.50575132122289, "episode_reward_mean": -14.903725122760541, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -63.84068802817615, "policy_agent_": -29.859603675550247}, "policy_reward_max": {"policy_adversary_": -5.771938503970196, "policy_agent_": 53.55041143430761}, "policy_reward_mean": {"policy_adversary_": -29.00109288363436, "policy_agent_": 7.048683880436908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.144306027006918, -10.517425209107731, 10.828924541015917, -8.280222006575947, 32.13054829477193, 12.982530159718403, 12.499652961838233, -36.399914137791015, -3.9738340092917226, -12.713262021172028, -7.057218020020059, -25.589306087520516, -7.3989750320960095, -41.18294893730051, -12.093910745899066, -20.659646589440523, 10.277154240426876, -24.656430055750835, -41.0608935898853, 24.66364726478393, 11.874911204078757, -27.190073606346385, -26.62512103000625, -23.880577734286344, 2.3957917059536564, -28.513997639447915, -33.75507472153706, -16.033949687660197, 0.8787996505948272, -9.652504649667229, -5.851718069572657, -22.215637280046774, -26.849296903469234, -16.02621746073946, -10.888955210386323, -71.50575132122289, 8.755063436486413, -26.777038437425727, 13.75531849257408, 6.118284682636153, -47.87925257379751, -32.86841809976982, -39.71523176966801, -7.08984620012634, -50.91974917787251, 14.085179887252966, -18.690493688146795, -3.0123308088054612, -7.752122351541603, -12.770856323613211, -21.210841464062064, 9.834416824505517, -14.325545607916268, 18.818399459998528, 21.409577226056637, -16.754956524234437, -5.181400647446788, -27.748300983045226, -34.56669184356403, 24.859578654363947, 4.975704722617958, 3.5624077557623113, 2.356116154417927, -50.03317165892992, -36.95155554138315, -46.015658363631765, -19.15518067368397, -2.392731529458594, -25.86638551704803, -31.68115024611358, -13.634248020874137, -26.834379637014205, 1.114578568955127, -43.79672403584289, -17.490192696602925, 10.114808437214984, -35.3640734380489, 2.50856416734144, -10.934440800377681, -18.8065910975328, -64.17565808885907, 7.807085020992649, -19.929247703372003, 21.844621529394338, -20.212827734283113, -43.14019780389253, 4.3341157028398625, -43.892065819989995, 5.095734252377611, -3.0835871973893934, -15.178497115070595, -13.313128195054052, -23.969074981847236, -58.61366088844638, -26.84293663817067, 8.618526848843612, -12.959820203376388, -54.47986197017933, -20.612860562320606, -33.83686757650159, -10.882720648052887, -39.79432303939225, -11.694274092240875, -39.04136352811278, -8.936369628334369, -32.662283784637914, -38.24861514070112, 13.586900343022908, -32.29878895874497, 9.179468058490357, -46.90712661561669, 18.937518417421078, 3.8647579132300605, -0.3751786457818742, -43.10489918467838, -34.15772869477795, -8.356389169945347, 45.89313045391471, -18.800223713842787, -33.797101455492445, -47.347955693044625, -8.095593248221945, -4.807305505530716, -38.67405530394066, -70.63143472517253, 10.30356418297965, 4.798727969264938, -17.589596648450105, -9.632339859117902, -20.257046434470656, -27.599982188797025, -10.56039805245526, -23.595557146157432, 1.5968744100693615, 24.361795956408475], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-25.182527097458518, -48.454942081108825, -41.27118941185233, -43.166773312967216, -46.05355115322861, -30.205302699252666, -40.97865560663314, -15.002771939075956, -32.95141884286823, -27.901505830757298, -26.49904555472717, -23.989399637756012, -39.69749057283734, -38.65821578444735, -42.8609508833955, -12.160393037783289, -54.05345962340228, -19.4778699866716, -15.148265605048232, -55.112662219875254, -46.43188322219616, -29.28691675648134, -25.34820290025726, -22.704114024276212, -36.88976288944904, -28.772850447286007, -11.452598321248677, -15.816672150871264, -53.69485092460012, -28.62534803248017, -19.151047055477246, -28.73970826139247, -29.445712515682462, -13.235749310513889, -49.050832036768476, -11.7865439701224, -57.6169438804712, -40.91488363311932, -24.34647021805973, -30.591767751359836, -7.097735548497561, -32.20924928519508, -39.69111453531579, -26.79642750784098, -44.15227641599927, -30.243669580544363, -14.500270609024495, -13.243821234764663, -46.24624037916562, -15.185982453755626, -39.380437583294814, -50.792844076144476, -10.688456792659887, -47.447377673622896, -58.244908326716995, -24.39025907106499, -31.02465306063146, -29.676196922104985, -15.214049829340768, -51.62966027984531, -30.89651547178832, -50.7011396306908, -63.84068802817615, -8.766626638055893, -22.13208783021727, -16.537096859146256, -32.21233017548, -29.890285568618136, -41.35618091060817, -25.127876761101504, -12.23915114354815, -26.978894779050425, -18.091995221869354, -6.7340887576145025, -33.63534319288553, -25.751555287815485, -30.683979243889667, -29.019215559927645, -8.630554861492762, -5.771938503970196, -11.492689719000778, -30.555945459935636, -33.67486549381187, -43.46598382119201, -11.20095414269022, -31.356765920153066, -16.762843032139475, -14.043789311288934, -31.555555002290692, -58.84187174402274, -21.343915942964845, -27.501797534459204, -8.372731061678314, -31.353845302302755, -10.807682319319794, -59.21054277661034, -15.851984937138488, -7.976172127028176, -26.525736205037962, -52.5022549085721, -22.941794048323747, -45.97958310499362, -18.231759737578013, -14.205502126523493, -14.358766815755498, -23.169682915374125, -18.11516631191158, -41.452688652917246, -23.435735589346056, -21.62353548891646, -22.7422041950899, -44.06347274703998, -22.76611249572615, -46.371376888294705, -8.988770121351145, -8.630038710201823, -35.631316493904066, -61.207692414700524, -19.88122027157464, -39.97590244231928, -12.890395093533897, -15.850303741334749, -20.451002387426183, -15.561058162524946, -24.689871923213012, -36.65810320297418, -35.09542782348698, -28.752371301761677, -15.016417611705826, -20.549552525828535, -36.58398215552713, -21.524915713063905, -13.914157716357087, -43.77611557367679, -46.08119125000816], "policy_policy_agent__reward": [10.5191105352258, 10.5191105352258, 18.96875843600054, 18.96875843600054, 26.050056976434135, 26.050056976434135, 17.443275653195627, 17.443275653195627, 39.092049724000276, 39.092049724000276, 21.59391642948553, 21.59391642948553, 26.739154284235696, 26.739154284235696, -10.69857109935753, -10.69857109935753, 14.488792416788256, 14.488792416788256, 7.594121904792632, 7.594121904792632, 9.72091376735356, 9.72091376735356, -0.7999532248822475, -0.7999532248822475, 16.149257770370664, 16.149257770370664, -1.262366576426575, -1.262366576426575, 15.383520068748217, 15.383520068748217, -4.249626775828616, -4.249626775828616, 32.16530693191457, 32.16530693191457, -2.589280034539623, -2.589280034539623, -12.956313992418533, -12.956313992418533, 39.88815474232959, 39.88815474232959, 29.15339721313746, 29.15339721313746, 1.048421575067476, 1.048421575067476, -0.6384590648744981, -0.6384590648744981, -0.5882318550050663, -0.5882318550050663, 19.642777297701347, 19.642777297701347, 0.12942640391904336, 0.12942640391904336, -11.151238200144194, -11.151238200144194, -0.10863876839446407, -0.10863876839446407, 27.28682528759747, 27.28682528759747, 9.48642169140647, 9.48642169140647, 6.649664492952295, 6.649664492952295, 3.2620354906728393, 3.2620354906728393, 1.2982078061066167, 1.2982078061066167, -1.3952340751127856, -1.3952340751127856, 19.080938413191078, 19.080938413191078, -29.859603675550247, -29.859603675550247, 33.18600365847881, 33.18600365847881, 7.068922597846793, 7.068922597846793, 19.050894355316903, 19.050894355316903, 18.355026216997995, 18.355026216997995, -20.39075851264997, -20.39075851264997, -0.3295844072873694, -0.3295844072873694, -0.012058617176104347, -0.012058617176104347, 9.853290653857323, 9.853290653857323, -3.383736380936613, -3.383736380936613, 22.164424733898667, 22.164424733898667, -2.0951115395611506, -2.0951115395611506, 5.1157452129796, 5.1157452129796, 19.24705901381201, 19.24705901381201, 1.2075630650712044, 1.2075630650712044, 9.084798059616366, 9.084798059616366, 30.313630450325007, 30.313630450325007, -1.8185444076281903, -1.8185444076281903, 33.13288856681071, 33.13288856681071, 39.82724277638681, 39.82724277638681, 3.8176512734152768, 3.8176512734152768, 12.921626206592336, 12.921626206592336, 0.963947969529884, 0.963947969529884, -9.676321007111634, -9.676321007111634, 38.24461946710462, 38.24461946710462, 17.936110097203137, 17.936110097203137, 27.131773693226556, 27.131773693226556, 33.09840209129703, 33.09840209129703, -20.633272510437006, -20.633272510437006, -7.409733855582934, -7.409733855582934, -14.739280752242756, -14.739280752242756, 6.528574750898012, 6.528574750898012, 13.748777019579766, 13.748777019579766, 7.744897696780064, 7.744897696780064, -3.276636742506037, -3.276636742506037, -0.6975484386629913, -0.6975484386629913, 0.0722575710181137, 0.0722575710181137, 9.60328689541224, 9.60328689541224, -18.5313176391142, -18.5313176391142, 8.072575248141302, 8.072575248141302, 17.933181862515234, 17.933181862515234, -2.340047097079617, -2.340047097079617, 15.763889863634544, 15.763889863634544, -1.1519429694424606, -1.1519429694424606, -6.517326296781304, -6.517326296781304, -26.341484184929154, -26.341484184929154, 19.181515240464144, 19.181515240464144, 6.872808895219929, 6.872808895219929, 32.65530267529318, 32.65530267529318, -4.505936795796446, -4.505936795796446, -5.891715941869726, -5.891715941869726, 10.548479367489668, 10.548479367489668, -14.92413825435053, -14.92413825435053, 18.32564462733415, 18.32564462733415, 27.87914227331667, 27.87914227331667, 3.082709413947125, 3.082709413947125, 7.094334669702577, 7.094334669702577, -7.798171960084458, -7.798171960084458, -13.629907793071816, -13.629907793071816, -8.017627159425437, -8.017627159425437, 33.91453481272698, 33.91453481272698, 1.4460823668810479, 1.4460823668810479, -23.25184492157558, -23.25184492157558, 2.9564378213586755, 2.9564378213586755, 9.332693666035253, 9.332693666035253, 6.029536700135429, 6.029536700135429, 3.0926300328006886, 3.0926300328006886, 3.2687428226685684, 3.2687428226685684, -12.417930700794635, -12.417930700794635, 2.711198593710566, 2.711198593710566, -4.7463004346318876, -4.7463004346318876, -10.066724414394765, -10.066724414394765, 27.51979449797008, 27.51979449797008, -4.431526684699452, -4.431526684699452, 15.401501773703407, 15.401501773703407, -12.082461210263398, -12.082461210263398, 31.500495582230528, 31.500495582230528, 13.315435204478106, 13.315435204478106, 22.998099121256416, 22.998099121256416, -17.058064531663618, -17.058064531663618, -12.76384499228807, -12.76384499228807, 13.637463661979362, 13.637463661979362, 53.55041143430761, 53.55041143430761, 0.5404982788659288, 0.5404982788659288, 3.0894004934134154, 3.0894004934134154, -17.228780299755368, -17.228780299755368, 3.8773552465564016, 3.8773552465564016, 7.821848440947737, 7.821848440947737, -11.556498570707877, -11.556498570707877, -22.970781400979767, -22.970781400979767, 23.48083369297691, 23.48083369297691, 19.94707789637596, 19.94707789637596, 5.581387326655785, 5.581387326655785, 2.6920388762939513, 2.6920388762939513, 0.14625304567893693, 0.14625304567893693, 4.491999983365059, 4.491999983365059, 5.482258830304323, 5.482258830304323, -4.840699714900166, -4.840699714900166, 22.68649499187308, 22.68649499187308, 35.221493603208316, 35.221493603208316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34340962450555024, "mean_inference_ms": 2.2174037517385283, "mean_action_processing_ms": 0.09983672317883649, "mean_env_wait_ms": 0.5863547043315624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 3375, "timesteps_this_iter": 0, "agent_timesteps_total": 10125, "timers": {"sample_time_ms": 11107.956, "sample_throughput": 303.836, "load_time_ms": 0.997, "load_throughput": 3384929.699, "learn_time_ms": 2221.08, "learn_throughput": 1519.531, "update_time_ms": 33.937}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 324.7797912597656, "policy_loss": -0.009359952778322623, "vf_loss": 324.80377807617185, "vf_explained_var": 0.0009327530860900879, "kl": 0.006994132003457554, "entropy": 1.6025468349456786, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 98.29031181335449, "policy_loss": -0.0006665758788585663, "vf_loss": 98.30495414733886, "vf_explained_var": 0.006818297505378723, "kl": 0.010096765631326438, "entropy": 1.5994964241981506, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3375, "num_agent_steps_sampled": 10125, "num_steps_trained": 3375, "num_agent_steps_trained": 10125}, "done": false, "episodes_total": 135, "training_iteration": 1, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-47-47", "timestamp": 1706107667, "time_this_iter_s": 13.334502696990967, "time_total_s": 13.334502696990967, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E06C03B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13.334502696990967, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.67058823529412, "ram_util_percent": 64.88235294117646, "gpu_util_percent0": 0.07647058823529412, "vram_util_percent0": 0.238037109375}}
{"episode_reward_max": 43.987016232094604, "episode_reward_min": -83.70978120871699, "episode_reward_mean": -13.844893705323507, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -56.497900019540154, "policy_agent_": -37.491001486567626}, "policy_reward_max": {"policy_adversary_": -5.091289294705813, "policy_agent_": 47.195923452657624}, "policy_reward_mean": {"policy_adversary_": -25.031204011461032, "policy_agent_": 5.59315515306876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.628460580515613, -9.198060790234335, -9.441650094462613, -20.645659859902306, 21.015150004187145, -5.346403482705771, -21.410022279372697, -64.28103026481794, -10.283419285849119, -36.78004346756031, 0.4675882398233895, -44.10046291759384, -4.498387040696459, 3.080342978202859, 13.881196943790494, -56.47103601004304, 2.115202190898245, -54.81715213134764, -4.101537979944421, 15.00514638914494, -9.098183791470365, -18.13479427110203, -19.402984837783976, 3.8073329724351987, -5.23675274896623, -10.716291083377238, -21.653240292975255, -29.838257902963377, -34.75470077056083, -18.755815181016338, -8.089543985589561, -26.23897503404364, -13.798923453424212, -12.8655785198616, 19.445778850623718, 13.56748123002849, -27.9390703700465, 31.26429290437594, 10.573600212286806, -44.0951266311813, -17.733289872514693, 0.2725712592919158, -32.2879986333605, -13.938907959536762, -7.640562114191791, -17.59633263210972, -47.03344646765195, -22.44691324205607, -8.425996059705689, 1.9700324627437755, -21.765484826599792, -61.11942668433108, -32.59850773510247, 26.835400399102884, 16.345738056473856, 1.0146907757674883, -42.22589815249642, -53.53765639268631, -15.757210670196915, -10.652176807538558, 16.37956625231243, -11.08955051881866, -15.018520294591495, -2.9462446106424416, -7.094963667931806, 11.177189167090914, 17.62893025585074, 0.8881640173161636, -4.7104829604296405, -33.8202090774393, -15.190831771591984, -7.645102517619231, -34.764021993330616, -19.065309343012043, -27.182631681260283, -5.115762825517526, 9.633333900942256, -5.327725467379843, -15.113769877885307, -59.345898282109296, -80.42628392301887, -22.453770153284864, 3.679900508164554, -12.921223082213176, -36.431969139618175, -4.9565356200282915, -15.75733156043209, 4.066641053403135, -2.6526072840232198, -30.45647273113003, -7.722379749312302, 7.8576542576056285, 2.659579556938782, -7.042563651157433, 2.524377340187391, -8.468313498662617, -16.67483780633722, -9.148684070725256, 14.82679211205933, -48.81324944834059, 6.392670359653009, -29.588795828501752, 2.0155986117641276, -32.20989349578633, -37.28313531545161, -14.261575670698717, 43.987016232094604, -11.30256814033863, -0.545630580523496, -17.418831615211985, 7.805594407460456, 26.095674938502796, -7.242546652431825, -6.70031908179536, -35.320728783788645, 25.572047704456423, -41.117587835666555, -7.73883596912819, -47.560965116171985, -45.90733581040628, -13.24006463964778, -14.370164580095956, -21.086705400340186, 0.4792523942516511, -2.726638559307537, -11.510189063981402, -83.70978120871699, -35.57991730082443, -29.14121948901991, -7.483383145128823, -40.558606384868774, 0.9487026234991004, -13.432628843738641, 8.176461194274603, -29.740674546775768], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-25.76942674727732, -22.22243171134845, -45.53941541496175, -8.42878516792907, -33.367740175390644, -16.016079349918506, -35.15708792067521, -17.345776287134832, -6.939346629257512, -37.68699418912311, -13.816435526249627, -13.26131248004944, -49.6343862534792, -16.59045542230309, -36.996017389163605, -19.09072804193376, -53.79577189176459, -16.12095741512743, -8.20466193673151, -25.91277395870998, -23.058415381596824, -31.60196428292207, -24.128888575764712, -19.17226401140561, -5.091289294705813, -48.634413740079744, -11.66552909669327, -29.672680241506463, -14.712919785022743, -38.44283212812963, -14.590212343993205, -23.34098585922524, -16.22813918331469, -10.57588701790027, -43.65025099585926, -22.617449638760046, -21.322859207387047, -56.497900019540154, -48.75356308693226, -22.417240559145107, -26.96260755881864, -11.524376700276019, -31.72290581899027, -20.03520788645704, -21.89765173745447, -12.452683400367443, -13.067816483064872, -23.67902022970683, -17.848156674016714, -28.311597562779134, -17.27234738168545, -34.63956218708065, -10.290932931202937, -43.28046650563011, -38.96913379430168, -23.720510856726964, -25.24409327794556, -25.200351518822973, -27.09234651988928, -21.396957453460196, -32.82324135725228, -25.069467987827245, -23.360123276654285, -29.565523784645517, -9.510310802476196, -35.509188419017185, -42.65322440206268, -16.508887611044404, -19.373924874009006, -13.658467844740061, -8.261541194830176, -16.012737731200748, -17.775135441402448, -13.813590051700096, -18.91260192755542, -6.782231479431806, -30.232121649665643, -13.697678057111455, -25.444740123518592, -14.024819582957337, -33.903559246267655, -7.594388054107769, -21.433645450154753, -32.6214196481569, -13.640939026083567, -20.861305354171854, -14.541200855536504, -45.08653877056619, -29.177221361551545, -9.040568998504195, -32.553002219413145, -25.51212078357159, -29.89522684977654, -37.24651722279592, -25.39904727136954, -33.28760685804709, -27.397455220277457, -37.09727360443054, -24.73618847630593, -37.81821584360837, -27.188833079548193, -20.52373162089588, -28.66492301027188, -23.668218207207303, -41.31997399303873, -18.854040503377295, -50.40483067322065, -43.095914910012354, -40.332646681412974, -15.917496966439758, -41.63388402689148, -52.33091230470888, -22.030640914988513, -32.911788074939984, -40.11207409934459, -50.392303635748696, -15.392834747390777, -10.135022573525898, -13.496471142757763, -27.471817598482975, -7.686998796261708, -47.65020095666776, -16.680053630618026, -27.445471477662068, -27.78244002127626, -9.977737945169613, -8.727778235581813, -9.219542342429996, -39.983347014011244, -23.171706830722275, -12.77235937664427, -18.945025309479046, -12.778318626681054, -27.47349496198911, -18.525713706950093], "policy_policy_agent__reward": [7.070483083380848, 7.070483083380848, 6.512185460557058, 6.512185460557058, 18.048882660249568, 18.048882660249568, -6.108437345986626, -6.108437345986626, 27.1914450897889, 27.1914450897889, 5.334837933606368, 5.334837933606368, 6.873532820651258, 6.873532820651258, -23.467626988841563, -23.467626988841563, -1.6720363282958037, -1.6720363282958037, 0.45347536078139683, 0.45347536078139683, 7.142011883036507, 7.142011883036507, -15.419575218772192, -15.419575218772192, 22.567999606391368, 22.567999606391368, 9.835399200252972, 9.835399200252972, 25.438607166477052, 25.438607166477052, -18.690153984054643, -18.690153984054643, 27.95548704133141, 27.95548704133141, -19.348097358110124, -19.348097358110124, 2.0515619783935444, 2.0515619783935444, 20.458960173927462, 20.458960173927462, 6.980115795063229, 6.980115795063229, 6.733585005910024, 6.733585005910024, 2.3629518689903657, 2.3629518689903657, 11.489798491920402, 11.489798491920402, -0.07273172713020948, -0.07273172713020948, 18.959061328351254, 18.959061328351254, -4.993855598140993, -4.993855598140993, -0.0827888307284601, -0.0827888307284601, -10.020890492769045, -10.020890492769045, 9.84350847355665, 9.84350847355665, 3.250334179201821, 3.250334179201821, -1.448994587409201, -1.448994587409201, 1.2146078649452388, 1.2146078649452388, -1.1448457509806684, -1.1448457509806684, 31.548014923241485, 31.548014923241485, 18.092465434394267, 18.092465434394267, -3.3081055813297198, -3.3081055813297198, 43.88109646195805, 43.88109646195805, 29.66358164960954, 29.66358164960954, -10.838943036018092, -10.838943036018092, 4.614658843151976, 4.614658843151976, 5.8984739797839705, 5.8984739797839705, -0.2825464071851156, -0.2825464071851156, 3.0481499634601428, 3.0481499634601428, 7.128544811631339, 7.128544811631339, -2.5718246158711335, -2.5718246158711335, -16.98281499229354, -16.98281499229354, 0.6160534938253794, 0.6160534938253794, 4.711080307155511, 4.711080307155511, 15.140815012761449, 15.140815012761449, -2.2465687224571727, -2.2465687224571727, -13.239932248625234, -13.239932248625234, -11.153787401949767, -11.153787401949767, 35.057933452366505, 35.057933452366505, 27.657435925387766, 27.657435925387766, 12.367600816247231, 12.367600816247231, -8.490902437275443, -8.490902437275443, -14.168652436931675, -14.168652436931675, 5.667567924846182, 5.667567924846182, 5.372390322960818, 5.372390322960818, 24.60140380478235, 24.60140380478235, 6.989958734504292, 6.989958734504292, 4.170801491031399, 4.170801491031399, 13.309639587001536, 13.309639587001536, 1.2076735672721937, 1.2076735672721937, 23.343188793054058, 23.343188793054058, 30.14107732895671, 30.14107732895671, 8.698525814180282, 8.698525814180282, 7.331720956789685, 7.331720956789685, -10.080870616349625, -10.080870616349625, -3.4646452883809045, -3.4646452883809045, 4.183817606790754, 4.183817606790754, -8.494443275964086, -8.494443275964086, -2.6258596456559724, -2.6258596456559724, -4.135014876852434, -4.135014876852434, 0.8332343269571394, 0.8332343269571394, 19.932727775303956, 19.932727775303956, 4.184976294865805, 4.184976294865805, 5.165485122816644, 5.165485122816644, -22.66053934957598, -22.66053934957598, -23.261362338375612, -23.261362338375612, -7.4296910495885475, -7.4296910495885475, 12.556772979159653, 12.556772979159653, 9.850098282971869, 9.850098282971869, -11.395515056767291, -11.395515056767291, 7.952384867071779, 7.952384867071779, -0.6080653524477947, -0.6080653524477947, 24.576589911984655, 24.576589911984655, 13.262307038764163, 13.262307038764163, -10.707951866312913, -10.707951866312913, 12.415311235050421, 12.415311235050421, 16.684887520588607, 16.684887520588607, 16.277403203357665, 16.277403203357665, 15.101976785819247, 15.101976785819247, 13.961712305778464, 13.961712305778464, 12.409646679692244, 12.409646679692244, 5.361308706970117, 5.361308706970117, 13.974294766852644, 13.974294766852644, 19.781490294182632, 19.781490294182632, -5.497516802366105, -5.497516802366105, 16.790751719600607, 16.790751719600607, -4.5325321038029385, -4.5325321038029385, 15.340260811018002, 15.340260811018002, -4.2708376442895215, -4.2708376442895215, 2.018419338793562, 2.018419338793562, 2.296232416339289, 2.296232416339289, 47.195923452657624, 47.195923452657624, 15.896673384836866, 15.896673384836866, 19.893508050444737, 19.893508050444737, -0.7506673243861139, -0.7506673243861139, 24.719739217175967, 24.719739217175967, 39.21329362160584, 39.21329362160584, 7.3940471312783504, 7.3940471312783504, 13.105734496572312, 13.105734496572312, 2.395672657777979, 2.395672657777979, 37.982175670102556, 37.982175670102556, -12.86237654413789, -12.86237654413789, 1.1980933021988542, 1.1980933021988542, -17.032246986707104, -17.032246986707104, -9.21775910596165, -9.21775910596165, -2.776532921693034, -2.776532921693034, 16.640018188285907, 16.640018188285907, -2.203325884861076, -2.203325884861076, 13.96236193595686, 13.96236193595686, 12.527900730984365, 12.527900730984365, -0.766225559405896, -0.766225559405896, -37.491001486567626, -37.491001486567626, -13.180187479197212, -13.180187479197212, 5.421063762495663, 5.421063762495663, 7.844161842796728, 7.844161842796728, -13.893123504112253, -13.893123504112253, 9.946863966489074, 9.946863966489074, -0.3271551085287926, -0.3271551085287926, 17.824978078131863, 17.824978078131863, -5.607480419912844, -5.607480419912844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3299287374705001, "mean_inference_ms": 2.1849243682170525, "mean_action_processing_ms": 0.0960149255654642, "mean_env_wait_ms": 0.5721948541538797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 6750, "timesteps_this_iter": 0, "agent_timesteps_total": 20250, "timers": {"sample_time_ms": 12040.563, "sample_throughput": 280.303, "load_time_ms": 0.499, "load_throughput": 6769859.397, "learn_time_ms": 2290.544, "learn_throughput": 1473.449, "update_time_ms": 28.949}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 231.07489471435548, "policy_loss": -0.0031338195723947136, "vf_loss": 231.09317321777343, "vf_explained_var": -0.001900160312652588, "kl": 0.0034147729063446542, "entropy": 1.5829025626182556, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 78.58830528259277, "policy_loss": -0.01425725309527479, "vf_loss": 78.61668128967285, "vf_explained_var": 0.01370430290699005, "kl": 0.008690974654460216, "entropy": 1.5857043504714965, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6750, "num_agent_steps_sampled": 20250, "num_steps_trained": 6750, "num_agent_steps_trained": 20250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 2, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-48-00", "timestamp": 1706107680, "time_this_iter_s": 13.01019811630249, "time_total_s": 26.344700813293457, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6DD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 26.344700813293457, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.794117647058826, "ram_util_percent": 65.17647058823529, "gpu_util_percent0": 0.08647058823529413, "vram_util_percent0": 0.25222598805147056}}
{"episode_reward_max": 36.558290184127934, "episode_reward_min": -42.311555711941516, "episode_reward_mean": -9.27238529367872, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -54.92457677730663, "policy_agent_": -17.746106472726016}, "policy_reward_max": {"policy_adversary_": -5.159489099767562, "policy_agent_": 45.74143348071728}, "policy_reward_mean": {"policy_adversary_": -23.556543362605698, "policy_agent_": 7.142079034463487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.731014857778867, -14.68921803251466, -14.132441983789676, -14.805687689691366, -4.3214871464965245, -2.5688469763456574, -4.346799029270542, 2.3656907855938254, -11.73536448130529, -33.585633709046505, -36.039904348016734, 9.989043192714218, 3.0419568078859127, -11.419151091895696, 13.390733035965722, 7.935709021855924, 1.8459595597706555, -27.439322286858747, -14.980724076411438, -7.2807675632055275, -11.716581133692655, -13.501122575934954, -11.19280245877381, 36.558290184127934, -19.34668115825523, 6.927140353841125, -41.56677336339232, 18.505075027050243, 3.5101088914059257, -25.469549002887113, -31.640477179238857, -20.014799951847795, -40.62031497635692, -27.942614260206682, 4.797086493244644, -0.32149844573477626, -11.173858489306445, -41.48714343785708, -7.434755028379019, -4.254169207030821, -7.789971050711294, -32.544967344665345, -32.130104018614226, -21.280843667119697, -21.094517179294137, 32.984735059283445, 1.127910345295473, 12.909340945502242, 1.6694999936088637, -5.123921107961547, 6.218480161489836, -1.4791669267201533, -10.914323261859494, -20.59756674045001, 23.432971455617626, -9.981349239232168, -31.748849312193364, -22.08999587314909, -0.48371891244104187, -13.134033154152513, -0.6497945641546491, 16.81939621091406, -7.502676955642562, -42.311555711941516, -22.153852916477344, -24.56161266899608, -15.987078954252729, -15.048542795143582, -17.13014900857397, -6.135661371534656, 7.1822741809438835, 4.769244139136528, -25.824344849710837, 13.215268025796805, -16.34638977514962, 5.061744450754201, -0.07101484436879352, -9.468824670915957, 16.597006092386824, -4.555892121839616, -1.6970288834003804, -12.938582634687197, -1.2019583368686062, -12.304836058724446, -6.605149281532036, -28.703297327850496, -9.20442725684729, -10.561469430288332, -16.840804007235874, 3.0865337577667256, -16.042726432906086, -16.869730932216438, -12.773658073578464, -18.479681511664246, -16.33390559679086, -13.214285546666162, -14.42740164671779, 22.487316403115415, -3.831647621659321, -13.667994922129528, -16.373648125491172, -12.302645339815268, -14.387159275505574, -0.9436342530802411, -7.130287696935821, -1.2179432058818183, 4.31036332038888, -5.196428413174913, -1.4230566631872383, 0.6495397980277653, -9.13764968071799, -6.394000425360786, 11.861394006258767, -24.949060998954753, 1.3784898527637348, -29.94244602538677, -31.07478162089131, -22.916110721919175, -34.338312716496276, -35.14960212238156, 6.909465891633222, -2.438261703774195, 5.923300078261371, 22.330372303622656, -28.270260899699938, -18.83970622072242, -35.039308283019125, -7.719450215729835, -25.28513994490498, -1.065329163029574, -37.445981208967154, 2.5308103223344727, -10.407162344672992, 4.4654816196134846, -16.035600419905354], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-30.00327951561259, -24.348140813462646, -17.00730644158776, -7.245528053055675, -12.730558450193769, -14.88804047496254, -13.618786744932976, -20.761105708146577, -24.151906343690097, -18.253570771347647, -16.52929948109213, -35.96717350799444, -13.058481713514158, -33.75448528535211, -33.3580076021313, -23.67554655295562, -24.255936947416302, -9.465129289364665, -21.92226572327409, -12.91777910181898, -7.2507399766424365, -38.7286893251248, -15.371942000414872, -54.92457677730663, -18.654981782330065, -34.85897547799081, -6.113659248486835, -39.03841155075207, -31.46352297113945, -26.11127970041494, -17.843766341014266, -22.059382852915384, -13.515059661982352, -43.55874654686996, -28.131837520028206, -28.548627979880777, -26.585102149270945, -39.526957613368594, -14.718607180248883, -20.8682757506919, -53.28620098793252, -9.453412135584587, -31.472829100531584, -13.909365659282372, -16.57718098197171, -46.653735839459266, -15.464446566956443, -29.184694560759603, -28.240472651979168, -13.713140929368898, -36.85206684069932, -14.7095685565568, -29.9596290729217, -34.6452683103812, -31.763852789733466, -21.66735302730394, -5.159489099767562, -9.540860515864933, -27.718600046380786, -26.67453392676149, -45.33966464926389, -32.37227336585027, -19.314008043225826, -6.819342766489464, -10.202373407532338, -6.088565691748324, -25.779326373702645, -24.108801717902047, -15.252321082858973, -8.353900723894318, -28.313083954040657, -23.100601324901305, -26.823116323467158, -36.611134830987574, -28.00547383974926, -31.43792653492139, -25.168472953131875, -10.776792213370541, -36.95153175300595, -8.733195542249302, -22.745257689359875, -18.037853621501995, -27.181485817087044, -11.662413298767682, -17.207946418849918, -17.38576855278172, -19.135966166925474, -25.498316840121884, -28.22894930000884, -21.450234372377235, -40.25876816020108, -37.15744716723509, -24.755444511276345, -19.983499027780837, -16.344450352331513, -13.643742725298981, -18.88981774582914, -37.86748586174392, -25.68974823790192, -20.25414745607514, -7.207533000224358, -35.94191693112808, -25.165202479318527, -19.146507820517012, -33.040832421610205, -16.739440545592323, -40.46311739587011, -11.186865001270286, -11.834915839206278, -35.06353807778395, -12.588607596080996, -12.41895955702149, -49.533559076546304, -21.322393892740024, -50.33454645898172, -17.673757568951288, -26.61262749783232, -19.991989101233536, -29.030452524321085, -10.058646155977398, -18.874607301832004, -25.971721694679626, -36.8537093211986, -36.541823375794806, -12.199084517191212, -11.928884633515102, -30.188483754758234, -45.06751930671004, -21.125221848628968, -34.30346242354043, -12.309572729250663, -13.428806838819636, -14.086594124547158, -30.249580462805604, -6.286049731562889], "policy_policy_agent__reward": [22.867147186695725, 22.867147186695725, 4.8294613904739965, 4.8294613904739965, 1.437432228899042, 1.437432228899042, -3.7800798183178457, -3.7800798183178457, 4.204535651848622, 4.204535651848622, 6.159596749308445, 6.159596749308445, 4.6359938578312185, 4.6359938578312185, 11.563398246870202, 11.563398246870202, 6.208270931192404, 6.208270931192404, -7.666031468849434, -7.666031468849434, -9.755302433462301, -9.755302433462301, 22.97810835035433, 22.97810835035433, 8.050219260700036, 8.050219260700036, 11.167667096728211, 11.167667096728211, 23.37437031904852, 23.37437031904852, 15.805627787405772, 15.805627787405772, 13.050948253593479, 13.050948253593479, -8.987096498747038, -8.987096498747038, 3.4707708234313346, 3.4707708234313346, 2.8185057693067304, 2.8185057693067304, -2.23292057852511, -2.23292057852511, 12.613783374594927, 12.613783374594927, 2.0895697708205305, 2.0895697708205305, 45.74143348071728, 45.74143348071728, -0.3458496879625828, -0.3458496879625828, 20.89305791591596, 20.89305791591596, -17.72655705745274, -17.72655705745274, 28.771743288901163, 28.771743288901163, 17.486815931272687, 17.486815931272687, 0.3208653487639189, 0.3208653487639189, -6.8983554191123, -6.8983554191123, 1.0222914505337997, 1.0222914505337997, -13.552627657187276, -13.552627657187276, 7.808066143331647, 7.808066143331647, 16.464462006636424, 16.464462006636424, 14.113564767072997, 14.113564767072997, 7.705621829982248, 7.705621829982248, -0.9800929122442444, -0.9800929122442444, 3.6419260759349315, 3.6419260759349315, 8.307053271830538, 8.307053271830538, 22.74811496861061, 22.74811496861061, -11.545777604540373, -11.545777604540373, -0.3286374590413276, -0.3286374590413276, -3.685739003918664, -3.685739003918664, -2.2586680986612127, -2.2586680986612127, 39.819235449371355, 39.819235449371355, 8.29617845612596, 8.29617845612596, 21.047017753130916, 21.047017753130916, 14.954986322794019, 14.954986322794019, 4.294609910703676, 4.294609910703676, 21.53527350109458, 21.53527350109458, 6.6152008149183255, 6.6152008149183255, 9.522652905531105, 9.522652905531105, 7.0238507849655925, 7.0238507849655925, 27.598412122675548, 27.598412122675548, 5.8430018940358845, 5.8430018940358845, -13.294680106212905, -13.294680106212905, -6.274567678642071, -6.274567678642071, 13.617440566969867, 13.617440566969867, 6.770250386304493, 6.770250386304493, 22.34493504255462, 22.34493504255462, 24.595834788382163, 24.595834788382163, 5.905665543791632, 5.905665543791632, -17.746106472726016, -17.746106472726016, -5.975739754472501, -5.975739754472501, -9.23652348862388, -9.23652348862388, 4.896123709724961, 4.896123709724961, 4.53012946137923, 4.53012946137923, -0.9389139628574951, -0.9389139628574951, 1.10911967617983, 1.10911967617983, 17.747679067492275, 17.747679067492275, 13.934922732018917, 13.934922732018917, 0.4993857368781598, 0.4993857368781598, 24.91320142839219, 24.91320142839219, 5.829542032299826, 5.829542032299826, 18.2498354928378, 18.2498354928378, 12.548729054381543, 12.548729054381543, 0.6539837712272915, 0.6539837712272915, 26.77426892269638, 26.77426892269638, 2.088651710204843, 2.088651710204843, 10.524114402979748, 10.524114402979748, 2.549635493407399, 2.549635493407399, 12.989763740109218, 12.989763740109218, -0.32121137997838317, -0.32121137997838317, 5.301398568658941, 5.301398568658941, -5.658764387534394, -5.658764387534394, 4.965769455039091, 4.965769455039091, 7.468423704916772, 7.468423704916772, 5.6940726463864815, 5.6940726463864815, 12.268384065071977, 12.268384065071977, 12.108020863647496, 12.108020863647496, 10.143858117509332, 10.143858117509332, 5.990893218848942, 5.990893218848942, 0.7519087580582934, 0.7519087580582934, 0.005272377770328074, 0.005272377770328074, 0.21472858931640915, 0.21472858931640915, 2.231208049555676, 2.231208049555676, 30.17740113242967, 30.17740113242967, 10.9290503081213, 10.9290503081213, 3.29307626697281, 3.29307626697281, -4.583057562633409, -4.583057562633409, 11.8196357956564, 11.8196357956564, 5.3890216019064745, 5.3890216019064745, 9.101436783718386, 9.101436783718386, 12.95527236233719, 12.95527236233719, 7.76074866985525, 7.76074866985525, 22.3867403581295, 22.3867403581295, 2.995218294047688, 2.995218294047688, 5.2059295880095195, 5.2059295880095195, 17.856538937905857, 17.856538937905857, 1.7254789576815068, 1.7254789576815068, 3.01247956583035, 3.01247956583035, 30.69747654140254, 30.69747654140254, -1.8133335531073653, -1.8133335531073653, 25.85651815587272, 25.85651815587272, -6.13434422821774, -6.13434422821774, -2.2310770615295064, -2.2310770615295064, -1.4620608103428205, -1.4620608103428205, -2.653930096087592, -2.653930096087592, -12.545477983202069, -12.545477983202069, 12.892036596732611, 12.892036596732611, 11.76672999545272, 11.76672999545272, 21.388504699729975, 21.388504699729975, 29.43609783970873, 29.43609783970873, -8.035588191254357, -8.035588191254357, -3.4554107936036558, -3.4554107936036558, -2.4254122641304425, -2.4254122641304425, 18.674034545490105, 18.674034545490105, -2.0799590481380075, -2.0799590481380075, 16.619066630255425, 16.619066630255425, -12.56820423985825, -12.56820423985825, 7.979808580577058, 7.979808580577058, 1.8397158899370807, 1.8397158899370807, 17.35753104120954, 17.35753104120954, -4.87477534417123, -4.87477534417123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32831155879741736, "mean_inference_ms": 2.168891390846965, "mean_action_processing_ms": 0.09503928260359039, "mean_env_wait_ms": 0.5722838274374361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 10125, "timesteps_this_iter": 0, "agent_timesteps_total": 30375, "timers": {"sample_time_ms": 12381.07, "sample_throughput": 272.594, "load_time_ms": 0.332, "load_throughput": 10154789.096, "learn_time_ms": 2286.702, "learn_throughput": 1475.925, "update_time_ms": 27.288}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 195.58963928222656, "policy_loss": 0.008709157328121364, "vf_loss": 195.59601593017578, "vf_explained_var": -0.007515215873718261, "kl": 0.004873359928270987, "entropy": 1.5567268013954163, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 54.25012607574463, "policy_loss": -0.018839668830332813, "vf_loss": 54.28332710266113, "vf_explained_var": -0.0011450976133346557, "kl": 0.006998716471289473, "entropy": 1.5759715914726258, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10125, "num_agent_steps_sampled": 30375, "num_steps_trained": 10125, "num_agent_steps_trained": 30375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 405, "training_iteration": 3, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-48-13", "timestamp": 1706107693, "time_this_iter_s": 12.935800075531006, "time_total_s": 39.28050088882446, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6F1430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39.28050088882446, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.864705882352936, "ram_util_percent": 64.87058823529412, "gpu_util_percent0": 0.11588235294117648, "vram_util_percent0": 0.26090016084558826}}
{"episode_reward_max": 19.135895838259263, "episode_reward_min": -48.599498146314694, "episode_reward_mean": -10.173268844048462, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -53.5655337443369, "policy_agent_": -16.68642865841156}, "policy_reward_max": {"policy_adversary_": -5.3822383176720745, "policy_agent_": 30.075559467269773}, "policy_reward_mean": {"policy_adversary_": -20.399118914450575, "policy_agent_": 5.112925035201059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000266678271203, 10.0945452598138, -4.618855489127124, -18.38242357093893, -1.9504170344743725, -15.756562318479176, -10.88195975568332, -13.031406837850014, 1.3703783377803491, -5.09436283455645, 0.6370872911276839, -38.93532029963801, -16.748984426673776, -14.922913576203925, -34.41056933210352, -7.77721055100197, -28.01830960607855, -48.599498146314694, -12.547833031964146, -9.78188660232393, -25.68723109932169, 0.08858542984550244, -4.43147618884585, 15.112180423601922, -1.21736564723669, -9.579467534717095, -21.764507117345975, -8.598144928068232, 1.7481748301714786, -17.00727730466748, -20.67468580334597, 0.959685174533628, -15.630071580404529, -11.389311303817971, 1.686628596855575, 0.06467247615264049, 14.461771602866133, -44.47133117813271, -35.41544193784386, -9.240887935681442, -6.779884112953388, -3.480541976573554, -7.728226996183113, -12.695134877021548, -4.141598575711178, -12.86597844898056, 1.008330668802691, -34.51243143647533, -19.657362896712335, 9.09907756806511, -17.701746140384092, -3.1255079549339495, -2.5645105425647845, -20.7422821123608, -13.17820481775143, -8.562462431066159, -18.058765547407898, 0.21948644140566126, -27.433650716580235, 9.7024978738918, 8.975278710999756, -6.220781748359542, -9.459504737853845, -32.73548621896119, -9.066480652246304, -20.921022038577203, 1.913428627702934, 5.945086344971315, 5.314517484562983, -9.787505423663356, -14.411150655167406, -12.40119716247267, -14.954226876278014, -10.362112804391336, -3.173452445878538, 6.090571946089487, -15.363063306496427, 0.985598914494036, 9.414622227123429, -0.55672142146943, -0.9620460606229627, -0.9855447689629003, -26.611697660113908, -24.95333019762267, -5.335326176519777, 2.92156194847439, -5.727101458038396, -25.337968040664727, -17.260439563343766, -3.7457978770057467, -21.034549532756333, -11.629656143027386, -4.234508451029987, -14.499943950900054, 11.447144637252594, -10.911926459204278, -28.73756687886365, -0.15235338216850147, -13.984860340795887, -40.17818928045015, -1.8537721239747316, -15.370520102177174, -35.30334553929353, -16.63264735071548, -4.888246390098347, 19.135895838259263, -29.72533535240952, -4.561290772351095, -10.477183342905139, 1.173181910555788, -28.172549501139265, -14.096767263278409, -9.396497828528831, -28.09727775275717, -7.83362199738845, -11.005781761915468, -10.204227694343928, -3.504309652894899, -14.697076586026206, -5.534593987216345, 2.702040213288301, 7.082344742411916, -13.821560105253909, -18.443461234988515, 7.098940954801995, 5.9228414153514715, 0.09428980420718369, -3.558160768137199, -24.514075001861354, -10.635939584177416, 0.3916938883832613, -37.9100875194788, -15.58328377068264, 6.5855851902026465, -14.52762678791598], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-31.58189290127951, -25.212842632492816, -38.69697965691012, -30.96361110474332, -24.192822689765972, -19.158139315298648, -40.939512589615504, -11.115804275779702, -25.04900180343491, -20.988871046134733, -13.649173969238113, -21.341799631786483, -20.27154541013839, -28.887848943278204, -10.527431932275379, -27.035810646374053, -43.50877431699528, -15.22664082949157, -8.025200348182427, -16.33054947821677, -10.144014596152708, -21.73193809503631, -29.002349143309107, -42.71754686266147, -17.218271268007943, -19.70459725496549, -19.244695474241617, -7.033734517053317, -22.52372605855535, -19.914586528358015, -20.58148861899536, -16.189301760629263, -15.33568231806516, -26.617648464115206, -14.096653134550527, -17.563027135909163, -28.14942818396436, -11.218805992015536, -22.590313639201224, -8.234093820495094, -25.60391237691452, -9.401421981025837, -22.68479875638663, -5.7084331794008225, -31.86687827185637, -14.343261980725153, -23.434719170339857, -13.628209979676647, -17.490125877388223, -25.143973218358056, -11.570737699595577, -17.83227566432199, -12.402561121443052, -20.294673692406267, -25.46611894500363, -11.460791573209045, -6.966714375116238, -22.2741769582537, -16.571978818822622, -35.04141541052277, -30.0297254498422, -9.01119519873075, -6.689318316816372, -17.807374642017628, -39.18773228680323, -16.16100075581226, -19.11942161710601, -41.19903526675315, -19.411807886816845, -12.332000389914434, -30.883651704768713, -14.273261592183133, -12.351652784483939, -6.404991344065369, -17.069952079465455, -28.337357862236026, -26.258238666994465, -25.036597275014405, -39.01415600580547, -16.655606498234945, -14.727966535863649, -20.648898892309766, -7.950136017417178, -24.685665817503924, -18.762261475855713, -23.924269787582194, -11.16290228306173, -13.92786751063132, -10.554861346140768, -21.235683003471717, -31.768177175343492, -25.509135246529745, -18.290247726364814, -15.94661857808343, -31.20867808733124, -18.79446162758975, -26.21896173453896, -23.112385381235747, -30.35340893421665, -13.210744188775344, -15.75262990258008, -6.615618923200597, -9.006832079982203, -20.492065658683096, -27.982082000418078, -33.23427466858545, -13.939002175849872, -13.43315072313001, -15.217182557295605, -10.116985724911597, -22.98591700951049, -26.012884957882722, -19.49855166467616, -5.3822383176720745, -13.576639439686144, -11.020123815966132, -17.432171630337592, -25.281309532454415, -29.449664449954106, -18.41795747688999, -30.30090957162949, -32.646585438347216, -27.301496246097884, -25.596704297550538, -18.642855612592808, -17.373519706378254, -7.354597246302697, -29.87369908221226, -17.240900247530018, -8.85896107643145, -19.444544694597504, -29.814079358543157, -11.080357694753296, -53.5655337443369, -9.008282311665004], "policy_policy_agent__reward": [7.290813111504156, 7.290813111504156, 17.65369394615331, 17.65369394615331, 17.039062083891494, 17.039062083891494, 6.2905937669022, 6.2905937669022, 11.121202827645797, 11.121202827645797, 1.7007884984097288, 1.7007884984097288, 15.028776416966094, 15.028776416966094, -0.9578012810351607, -0.9578012810351607, 13.209690070607635, 13.209690070607635, 7.947254105789141, 7.947254105789141, 7.143130630182899, 7.143130630182899, -8.796760333925763, -8.796760333925763, 1.7612804917323084, 1.7612804917323084, 6.982467683537136, 6.982467683537136, -11.94156869991406, -11.94156869991406, 9.629300047686039, 9.629300047686039, 7.745232355458375, 7.745232355458375, -16.68642865841156, -16.68642865841156, -2.261316341890859, -2.261316341890859, 3.274331437946419, 3.274331437946419, -7.771608251584485, -7.771608251584485, 10.910261762440904, 10.910261762440904, 12.285436477231624, 12.285436477231624, 28.914863643131707, 28.914863643131707, 8.000452810385626, 8.000452810385626, 5.0625648601242, 5.0625648601242, -1.2599058215521777, -1.2599058215521777, -0.7822052055074598, -0.7822052055074598, 12.135950444363415, 12.135950444363415, 1.4536546118452676, 1.4536546118452676, -0.046598592175311426, -0.046598592175311426, 8.574493467581446, 8.574493467581446, -0.14719463116969095, -0.14719463116969095, 7.614168580148613, 7.614168580148613, 7.8916408657030495, 7.8916408657030495, 8.813849806030904, 8.813849806030904, 21.30559989341525, 21.30559989341525, -16.626262593058573, -16.626262593058573, -6.412564149321316, -6.412564149321316, -0.503397057593173, -0.503397057593173, 9.412014131980568, 9.412014131980568, 2.960440002226143, 2.960440002226143, 7.4782858801017555, 7.4782858801017555, -3.493350848810363, -3.493350848810363, 13.8626398480726, 13.8626398480726, 0.7386417658722995, 0.7386417658722995, 12.221524919571273, 12.221524919571273, -10.442110728399335, -10.442110728399335, -1.0836185096620592, -1.0836185096620592, 17.121525393211584, 17.121525393211584, -3.0655042203942644, -3.0655042203942644, 7.353383854694023, 7.353383854694023, 4.919025289439131, 4.919025289439131, -0.2238042099772719, -0.2238042099772719, 6.143957063626097, 6.143957063626097, 1.4491645710714425, 1.4491645710714425, -5.546025586145828, -5.546025586145828, 11.246831699829684, 11.246831699829684, -5.430835948878811, -5.430835948878811, 22.371956642207287, 22.371956642207287, 19.50250208042098, 19.50250208042098, 1.395206725185603, 1.395206725185603, -1.385093210518735, -1.385093210518735, -7.46405578847178, -7.46405578847178, 15.060625817278464, 15.060625817278464, -2.3800106413824773, -2.3800106413824773, 10.516425122404469, 10.516425122404469, 23.572060805862233, 23.572060805862233, 12.363162685689913, 12.363162685689913, 1.272247483125538, 1.272247483125538, 8.23625052480066, 8.23625052480066, 0.936032214855231, 0.936032214855231, -1.3012870458970391, -1.3012870458970391, -1.9785607301629784, -1.9785607301629784, 6.94824981679346, 6.94824981679346, 17.213964904162758, 17.213964904162758, 5.447587680249021, 5.447587680249021, 13.011098094754216, 13.011098094754216, 24.21438911646445, 24.21438911646445, 8.04944253838276, 8.04944253838276, 6.882960237620346, 6.882960237620346, 9.831677061673437, 9.831677061673437, -9.330780821348359, -9.330780821348359, -0.13383219005936542, -0.13383219005936542, 6.71346764966797, 6.71346764966797, 13.422915868028289, 13.422915868028289, 2.717900412511664, 2.717900412511664, -5.7050502650167045, -5.7050502650167045, -3.352789108601495, -3.352789108601495, 8.744942563232986, 8.744942563232986, 5.366813821293577, 5.366813821293577, 6.939739551751177, 6.939739551751177, 7.02786963766741, 7.02786963766741, 0.723337313591689, 0.723337313591689, 21.32791136229192, 21.32791136229192, 3.941267584192738, 3.941267584192738, -1.2593025721623454, -1.2593025721623454, 11.480015999533626, 11.480015999533626, 8.184274296710381, 8.184274296710381, -13.483722545837397, -13.483722545837397, 6.949428889302671, 6.949428889302671, -4.37745058948829, -4.37745058948829, -13.148256729655664, -13.148256729655664, 1.9297091539838056, 1.9297091539838056, 11.546917805159868, 11.546917805159868, 26.185085253422358, 26.185085253422358, -7.893166588279821, -7.893166588279821, 4.435929975389457, 4.435929975389457, 2.3699996071952327, 2.3699996071952327, 5.645083817733693, 5.645083817733693, -2.5933162458143837, -2.5933162458143837, 5.958058847302155, 5.958058847302155, 5.051026918073664, 5.051026918073664, -11.357519717542544, -11.357519717542544, 2.871508721148847, 2.871508721148847, 0.007171027025331345, 0.007171027025331345, 3.6139719679968305, 3.6139719679968305, 10.888499939779756, 10.888499939779756, 7.376293931963952, 7.376293931963952, 6.441681744836821, 6.441681744836821, 16.5014748924589, 16.5014748924589, 19.864465090379564, 19.864465090379564, 6.73996807042199, 6.73996807042199, 3.576621531281015, 3.576621531281015, 12.870898283697404, 12.870898283697404, 11.648180560864862, 11.648180560864862, 3.7244435252549395, 3.7244435252549395, 13.15776915703753, 13.15776915703753, -3.6365873771656676, -3.6365873771656676, -0.888489253872982, -0.888489253872982, 9.918119291490386, 9.918119291490386, -4.048004080467823, -4.048004080467823, -2.25146303796467, -2.25146303796467, 30.075559467269773, 30.075559467269773, -2.759672238125486, -2.759672238125486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34328445585927025, "mean_inference_ms": 2.2505952141976606, "mean_action_processing_ms": 0.09969812890604214, "mean_env_wait_ms": 0.5961414339699641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 13500, "timesteps_this_iter": 0, "agent_timesteps_total": 40500, "timers": {"sample_time_ms": 12989.575, "sample_throughput": 259.824, "load_time_ms": 0.249, "load_throughput": 13539718.795, "learn_time_ms": 2301.573, "learn_throughput": 1466.388, "update_time_ms": 26.2}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 133.40597381591797, "policy_loss": -0.008432200719835237, "vf_loss": 133.42921295166016, "vf_explained_var": -0.006800007820129394, "kl": 0.0071825955323036265, "entropy": 1.5162047028541565, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 31.752888870239257, "policy_loss": -0.017398791131563486, "vf_loss": 31.783938694000245, "vf_explained_var": -0.03806722462177277, "kl": 0.00868511138802334, "entropy": 1.5388539493083955, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 13500, "num_agent_steps_sampled": 40500, "num_steps_trained": 13500, "num_agent_steps_trained": 40500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 4, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-48-28", "timestamp": 1706107708, "time_this_iter_s": 14.833421230316162, "time_total_s": 54.113922119140625, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A030EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 54.113922119140625, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.9842105263158, "ram_util_percent": 64.86315789473684, "gpu_util_percent0": 0.06526315789473686, "vram_util_percent0": 0.23087993421052633}}
{"episode_reward_max": 19.965098855636494, "episode_reward_min": -36.27648149742004, "episode_reward_mean": -7.270319181693151, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -47.30464971295578, "policy_agent_": -12.226425366503001}, "policy_reward_max": {"policy_adversary_": -5.7088951324922155, "policy_agent_": 27.051898807696098}, "policy_reward_mean": {"policy_adversary_": -20.085698517187755, "policy_agent_": 6.407689667747299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.372681571055082, 1.8309823076110323, -15.681381642294168, 10.446303289017909, 15.359823370775668, -6.002650510723834, 6.119781719565387, -35.821516402888136, -3.2929799469232868, -20.39343921128969, -3.7190452722761114, -8.114981340687656, -20.835183020374924, -4.58351057226154, -8.277619347837344, -14.857155365157965, -10.663843930508627, -11.210590895331032, -0.40126408052438245, -11.215547224135213, -8.315613116069054, -7.278619479903636, -0.4419717187634952, 8.274418225732461, -0.35673722345042647, 19.045130979467785, -5.05816961682487, -11.933534021899996, 1.1509756316849455, 11.415972820999956, -16.94629335360401, 3.087686707429154, -25.38323601536473, -1.6577901714532408, -3.940114499356917, -21.361388401794205, -1.2259332845930349, 13.35668885435792, -6.6456055180245235, -10.756526942631353, 3.6791756934754436, -6.936252362693475, 3.796375566620242, -24.895658109357374, -5.349386680226042, -8.357083569284313, -30.173226969783858, -21.42842798344787, -17.881915919842875, -17.62691467178309, 3.4742198909800894, 5.955771081439436, -3.2869233850832256, -5.592952227665148, 16.011437852733618, -17.242078827462638, -18.864953473833115, -21.492057079054693, 3.904666818083575, -11.863933509790193, -18.653265000530453, -9.677923632763804, -1.5728492182959601, -8.32995255837495, 7.533738878282584, -24.393097972699362, -13.766217688483371, -3.7216647650081844, -14.699449624737458, -13.690661373197925, -13.102523754581245, -25.91733975380246, -3.585103031776155, -6.165874141004615, -5.167853903598342, -19.995079898612534, -36.27648149742004, -6.1957726984309245, 5.817140467506226, 7.932562439760564, -13.24100158251645, -8.355916170127102, -6.893282819397292, -5.3707617408486, 11.93267940021, 7.819035610815577, -26.029358087355575, -1.0004719530387642, -9.572530023309353, -2.4220272607919346, -6.498064612386178, -16.491949143274134, -27.96482194628764, 1.5104182539177673, -14.881965408341333, -21.448232888672035, 19.965098855636494, -11.295725403767097, -13.27289436571139, -0.8577000533844085, -5.22717650777183, 4.572314140082274, 11.506382351707073, 6.83006426898704, -7.601419424567462, -30.882689168765186, -2.348952600566256, -2.877906196300379, -12.019701338709075, 1.7241107638138455, 8.322106713849031, -15.141294024734364, -29.435260158035547, -28.148452479380417, -5.710692717292582, 7.239881210228011, -9.205870533669321, -18.591095533924214, -17.095224795862865, -10.888448944192193, -2.7670736367961686, -5.298350051044716, 6.089554330028864, 2.7536503081473813, -0.6113426258473433, 9.201651189730095, -21.30950132120715, -6.380025300798007, 3.053612877896904, -30.619900886566043, -17.541657777021317, -7.230629804949643, 1.788089672331991, 13.885966899895436, -26.703390703537742], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.53881486331453, -18.088338227885547, -15.481928896552548, -32.75038261053195, -27.87552294828332, -12.515790766641526, -24.62805985556619, -11.368665669882137, -6.644219778460374, -17.916522277276773, -24.811090635585977, -30.680303346874684, -11.361445685404519, -28.123544165114062, -22.628248230701626, -32.56438304958635, -7.160075142739658, -16.513280253061783, -13.477656565612248, -7.906470027017201, -18.24473995845914, -13.324172568455271, -13.233045414979136, -14.21960653992274, -9.381118399683347, -31.912033360858974, -9.639475485551854, -15.2971828500646, -15.292978747488771, -32.73406199479476, -10.91349633978598, -23.061179384414864, -6.809226849746906, -13.401141577130366, -12.13052745317186, -36.25041294788382, -13.529144235304006, -30.748671843995943, -32.248160672284875, -10.522411472898892, -27.370617212101717, -17.641401613726966, -20.145271739196257, -24.835107649894432, -30.390834584788465, -13.219335939953785, -26.936702338430464, -9.18238960428581, -11.10647859065768, -8.246866164014888, -22.25398761293118, -24.60325626840327, -29.60554330994064, -21.456645902898803, -27.338741937218217, -14.415945830765718, -5.7088951324922155, -47.30464971295578, -26.069193123548548, -11.272585362987073, -9.55716541633424, -21.566880437120314, -13.936289653406133, -14.066099213830379, -32.91965997636204, -12.109310216987435, -8.700456514672121, -11.05430608479768, -26.40862744668395, -15.486466635898983, -14.751761426794012, -13.031615867219957, -18.513952146508327, -21.264313427367448, -31.389171097673298, -17.51535075687414, -21.18028398215459, -14.369525027033772, -23.267368753672176, -19.192608772887812, -21.644465292123314, -12.504700810261784, -20.342867666999283, -16.30564059589919, -21.418428464605483, -34.2774120184246, -28.07521787879797, -17.547965027981757, -19.423610576779165, -29.168714268708758, -19.378630557542373, -19.565466907350725, -14.178826093356465, -15.727267198925867, -9.447417306753488, -15.56333812486126, -34.13869875975571, -19.307485276016273, -22.132328160887944, -27.897185989596018, -12.778720789911473, -44.62455138820781, -20.78061674223073, -40.49270075317122, -26.496066175137425, -7.455739719179715, -31.08399360377221, -24.674347462137124, -22.623828247567317, -17.48834556553382, -25.3766865545995, -23.62023557057638, -10.801580889509607, -12.991748606110301, -15.366289512719643, -22.37140698191006, -16.94380033339306, -25.997594567277112, -27.516554630665553, -10.899701721942392, -20.60764083168735, -18.856318347122436, -27.969193121498215, -21.521216829687354, -23.47407054115562, -23.61683972438452, -24.694373059146635, -27.773516283237928, -14.918964706272824, -11.03258419779517, -24.727763461088145, -13.431444999767693, -26.58368027157226, -31.828601497210716, -17.789721579099634], "policy_policy_agent__reward": [1.5830666461297254, 1.5830666461297254, 9.959660267748289, 9.959660267748289, -0.0997263728708136, -0.0997263728708136, 21.598342949774928, 21.598342949774928, 21.617673159529495, 21.617673159529495, 3.256570127958849, 3.256570127958849, 15.373920787565783, 15.373920787565783, -12.226425366503001, -12.226425366503001, 1.6756199157685425, 1.6756199157685425, -1.2384584670064596, -1.2384584670064596, 10.546022681654932, 10.546022681654932, 11.28266100309351, 11.28266100309351, -4.736868667485202, -4.736868667485202, 11.770016796426264, 11.770016796426264, 7.175314441432141, 7.175314441432141, 8.853613842214196, 8.853613842214196, -1.7518843938844837, -1.7518843938844837, 2.651344678865378, 2.651344678865378, 6.538196242543933, 6.538196242543933, -1.6545385985590053, -1.6545385985590053, 4.964563421195041, 4.964563421195041, 3.0227765442758208, 3.0227765442758208, 6.39553684810782, 6.39553684810782, 11.247012382827599, 11.247012382827599, 4.51219058811646, 4.51219058811646, 25.47858217016337, 25.47858217016337, 2.2906529343634907, 2.2906529343634907, 1.6818244140822998, 1.6818244140822998, 8.221977189586859, 8.221977189586859, 22.07501740789736, 22.07501740789736, -3.0163985069090145, -3.0163985069090145, 13.074433045922007, 13.074433045922007, -9.287004582808908, -9.287004582808908, 5.871675702838563, 5.871675702838563, 4.095206476907469, 4.095206476907469, 7.444512273044807, 7.444512273044807, 6.151605475355484, 6.151605475355484, 22.052680349176924, 22.052680349176924, 12.801277577130172, 12.801277577130172, -0.11705773486622828, -0.11705773486622828, 15.524896452788584, 15.524896452788584, 5.352574625516746, 5.352574625516746, 11.970823652908253, 11.970823652908253, -0.030275229731470676, -0.030275229731470676, 12.520723952281207, 12.520723952281207, 2.4311261853347395, 2.4311261853347395, -1.6182623156766942, -1.6182623156766942, -6.123019189581035, -6.123019189581035, -3.3877186645926, -3.3877186645926, -4.690024253884099, -4.690024253884099, 12.864103751955634, 12.864103751955634, 15.279513674921352, 15.279513674921352, 13.159309962428706, 13.159309962428706, 7.931846837616832, 7.931846837616832, 21.675089894975912, 21.675089894975912, -1.4130664983484675, -1.4130664983484675, -6.578029170670449, -6.578029170670449, 12.906296316950547, 12.906296316950547, 14.986929970816059, 14.986929970816059, -0.29567407340156077, -0.29567407340156077, -4.548049792098103, -4.548049792098103, 5.9444784021782535, 5.9444784021782535, 6.181720217555089, 6.181720217555089, 2.868073327727716, 2.868073327727716, 20.226699427322316, 20.226699427322316, -6.141893877855964, -6.141893877855964, -2.532880586905624, -2.532880586905624, 3.6663206598947493, 3.6663206598947493, 5.854588910973245, 5.854588910973245, 0.8979026313505247, 0.8979026313505247, 0.8246188361063835, 0.8246188361063835, -6.442861943291249, -6.442861943291249, 7.464424557366086, 7.464424557366086, 7.549219643181415, 7.549219643181415, 13.110658597037474, 13.110658597037474, -1.2398645708692024, -1.2398645708692024, -7.548098757632725, -7.548098757632725, 4.086876164301424, 4.086876164301424, 14.542254610589204, 14.542254610589204, 13.562585606324186, 13.562585606324186, 4.201731854803435, 4.201731854803435, 2.0743923200673393, 2.0743923200673393, 6.724792423800993, 6.724792423800993, 5.4674394275252975, 5.4674394275252975, 16.67555393240774, 16.67555393240774, 21.048223814620094, 21.048223814620094, 1.0229298957211974, 1.0229298957211974, 8.2737465374715, 8.2737465374715, 4.925540276734907, 4.925540276734907, 13.373343503958415, 13.373343503958415, 6.440282972578101, 6.440282972578101, 1.5367588820383016, 1.5367588820383016, -6.892997926465589, -6.892997926465589, 8.618842726421818, 8.618842726421818, -2.7172740507939226, -2.7172740507939226, -2.9424473819053847, -2.9424473819053847, 27.051898807696098, 27.051898807696098, 4.005879936124586, 4.005879936124586, 4.429716897588277, 4.429716897588277, 13.519742968105808, 13.519742968105808, 3.7757721410698206, 3.7757721410698206, 24.598432764145045, 24.598432764145045, 16.1434995469689, 16.1434995469689, 23.661382511079125, 23.661382511079125, 9.44732337528498, 9.44732337528498, -11.713474724792743, -11.713474724792743, 14.367520501602973, 14.367520501602973, 10.898220632918374, 10.898220632918374, 5.302063454429123, 5.302063454429123, 9.606228164673832, 9.606228164673832, 16.849396634224263, 16.849396634224263, 4.2394707729210035, 4.2394707729210035, -9.316839634262978, -9.316839634262978, -7.578351936635054, -7.578351936635054, 4.827798397713532, 4.827798397713532, 14.805644096069031, 14.805644096069031, 3.8689648998618664, 3.8689648998618664, 3.7032495166764483, 3.7032495166764483, 5.21066491740134, 5.21066491740134, 0.005626388875105026, 0.005626388875105026, 8.920283597445588, 8.920283597445588, 6.778984148038861, 6.778984148038861, 17.029373725763545, 17.029373725763545, 12.137433568917363, 12.137433568917363, 11.43136395765414, 11.43136395765414, 16.40924545705731, 16.40924545705731, 1.692435868969746, 1.692435868969746, 10.696745491219959, 10.696745491219959, 8.986288792084864, 8.986288792084864, -9.793658344385438, -9.793658344385438, 3.593052842033421, 3.593052842033421, 3.100407597409025, 3.100407597409025, 14.185884971952124, 14.185884971952124, 22.857284198553074, 22.857284198553074, -4.456834562219055, -4.456834562219055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3463759492342293, "mean_inference_ms": 2.267192026304143, "mean_action_processing_ms": 0.0996176480851561, "mean_env_wait_ms": 0.5988275177301994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 16875, "timesteps_this_iter": 0, "agent_timesteps_total": 50625, "timers": {"sample_time_ms": 13193.715, "sample_throughput": 255.804, "load_time_ms": 0.399, "load_throughput": 8466373.206, "learn_time_ms": 2256.806, "learn_throughput": 1495.476, "update_time_ms": 25.947}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 125.03180160522462, "policy_loss": -0.003359966696007177, "vf_loss": 125.04949417114258, "vf_explained_var": -0.005231869220733642, "kl": 0.007413167003901889, "entropy": 1.4698038339614867, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 30.435400009155273, "policy_loss": -0.01685888587962836, "vf_loss": 30.465859031677248, "vf_explained_var": 0.011458677053451539, "kl": 0.008094472601362335, "entropy": 1.5219757318496705, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16875, "num_agent_steps_sampled": 50625, "num_steps_trained": 16875, "num_agent_steps_trained": 50625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 675, "training_iteration": 5, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-48-41", "timestamp": 1706107721, "time_this_iter_s": 13.680641889572144, "time_total_s": 67.79456400871277, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 67.79456400871277, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.66470588235294, "ram_util_percent": 65.00000000000001, "gpu_util_percent0": 0.049411764705882356, "vram_util_percent0": 0.22588752297794118}}
{"episode_reward_max": 20.39275323394201, "episode_reward_min": -35.02670169860413, "episode_reward_mean": -6.614896683933116, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -39.34193988757449, "policy_agent_": -14.668413168617919}, "policy_reward_max": {"policy_adversary_": -5.375842200802911, "policy_agent_": 27.967373497804466}, "policy_reward_mean": {"policy_adversary_": -17.798012984317527, "policy_agent_": 5.591558150192205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.777652168737628, 0.3583231972752825, -28.132269624368018, -35.02670169860413, -14.244238517223682, -5.517912882143174, 1.685568046771901, 0.15686210425915825, 1.8327145491601267, -4.723766732745035, 20.39275323394201, -12.690696106999319, -3.3597968542858903, -7.16142123858682, -23.565364915372772, 7.961110442617173, 1.0358458806078632, -4.258729829878248, 11.358582463271915, -13.273373352356018, -4.376718261160216, 6.338948114080353, -3.6178484961169213, -2.0483870126467574, -0.31951966318919933, -11.204837814453455, -5.831971421968578, 0.5345398265627507, -21.21174813667264, -11.388420928692778, -12.599086643987393, -3.468784751218097, -14.083270965059505, -1.3778675655407162, -17.734116845247513, 8.114897829215854, -3.2326623963149035, -20.24734442476732, -24.68851839890326, 1.8663461261972523, -15.175535831372489, -3.916306010063046, 16.247076714983, 13.692529443283403, 5.011570606573709, 2.9658640510387304, 2.1984107589831208, -15.550693268932584, -28.471907612861667, 10.147433982508812, -15.708266261232355, 0.08673149356194587, -6.6889684672813186, 3.0939748239556453, -8.561628412776628, -18.67378637431061, 8.323387588707323, -1.1508089540295192, -7.932069552475686, -1.6641962549737177, -6.107453507184632, 0.2992744340671679, -19.240519467291026, -23.28056958569977, 0.20857980644568053, -17.331306100799324, 7.557766035953498, -28.26341576840249, 6.947615097273767, 9.4690136541892, -17.28679020804414, -12.559893755616063, -31.834345496271318, -8.708849131835183, -25.991866664290566, -16.1532944863637, 2.188152833332355, -7.471444785903596, -8.762278901956877, -3.128670399270634, 1.3647897389982966, 3.924773508241765, -17.302884137529084, 9.321214339922422, -21.286687162325176, 9.053579252626358, -5.743745091840069, -7.110218401749446, -7.888914089183029, 5.83706156164985, -10.865448743497032, -8.981660327360427, 5.399229763912523, -11.278883826439117, -7.281085259873161, -8.015397478522914, -2.384922810071014, -22.09558230849141, -4.580315945211496, -12.169133052918857, -5.657325103996072, -16.825447379978197, -10.249554610688977, 1.9372328902165363, -2.546054772125016, 6.5024836450774695, -7.711898689919979, 2.732150448075208, 6.222952295145987, 7.227588856946366, -4.584368051459214, 0.9703524421542665, -19.622014727635907, 4.340541952294679, -0.9339644304294881, -9.908030544642468, -32.06192048858864, -15.928900307811904, -15.638111369706944, -16.73657854781884, -17.032612082846544, -20.790827754554567, 1.6823527421960942, -10.303466952759637, -1.8749176649822061, -4.448740434122737, -0.026373755310577396, -8.813779302016485, -13.512464577480532, -17.041026793869275, -20.489882304159835, -0.24908411097780958, -8.086521648202329, -7.423945596670527, -7.340645363001652], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-24.67190626130246, -24.495452651516594, -18.808287036517612, -5.689875361368272, -30.178919482649633, -10.57203435646577, -19.44725672413218, -20.22501685231361, -19.509784911560796, -20.77601663213728, -35.54199376166692, -27.708017182261763, -23.140524254381265, -13.850208996979916, -14.941998326798009, -20.657470694926555, -21.094262605328982, -20.568603044101582, -21.91183716561068, -11.162145287994083, -22.49826826068966, -19.292369330095315, -33.917580620407925, -24.417019340824243, -17.98166242508687, -15.473447793290742, -7.94204480874724, -16.59061300185627, -27.04701224229429, -16.478538887677583, -10.96382168910235, -20.03162659201479, -20.97317097408439, -12.545855279629846, -11.341338309358681, -25.765005747867566, -24.9822266552808, -35.67276095087457, -22.167779203601985, -19.36305076617132, -24.26012447200377, -18.152280223876836, -20.588087619677992, -26.17553350133848, -19.40654155147146, -17.223811952297858, -25.463095965009924, -8.404118328529206, -10.295181304689233, -25.98207543004629, -10.6722948977108, -10.316717189466182, -11.66652859800168, -22.27577575758522, -9.393536109895654, -15.307087346988897, -39.34193988757449, -8.420813234474112, -15.640262989687828, -10.903105133455925, -12.521078912649335, -26.516590603980358, -8.131174060129354, -18.63580291124436, -24.1354269692061, -16.52896483669493, -17.43309268249851, -14.685436475787645, -31.414225018918252, -24.15027247585654, -10.427701824524682, -10.999620740800722, -12.43831278190603, -12.582154786895368, -24.216908891905977, -5.7162255835196865, -13.225110272445285, -17.642489897890595, -13.540823707402197, -9.636640686530352, -26.069309957805398, -17.281513304477077, -17.690805747904033, -29.80287367590444, -16.930378772813434, -26.211882545552704, -7.823131130890572, -15.825346764229751, -5.375842200802911, -17.16672698704242, -22.76683732204844, -22.11798034731398, -17.048924644762057, -18.75978164204397, -13.287433742074239, -9.09126674683728, -14.25267797616469, -25.10622980208236, -15.813756833147753, -18.879133150242808, -14.073904197030352, -19.055104109507273, -10.174749013854983, -14.306514668341977, -13.377367330775998, -31.403579042883393, -9.073547628871685, -10.79100559157612, -24.47499598596973, -25.991011201351952, -16.74690933031328, -13.410883252685505, -10.981191891883967, -14.975739185481055, -24.229704719464035, -11.58571439988578, -13.143868385053828, -8.787596636960028, -13.529661804640517, -16.30115616144549, -7.949610367235765, -15.012373835010724, -21.013370970464504, -13.362134412834287, -27.33739491939925, -16.296807230303692, -16.336095257939633, -14.7365477644952, -16.60852228270509, -10.21355154328186, -8.7837116373956, -30.794976045445228, -9.901801049269736, -22.74458510773848, -13.060462543691354], "policy_policy_agent__reward": [8.447127046282418, 8.447127046282418, 12.426887924395938, 12.426887924395938, -4.661991293925194, -4.661991293925194, -14.668413168617919, -14.668413168617919, 7.967340482712974, 7.967340482712974, 2.527060737161296, 2.527060737161296, 10.566412385452043, 10.566412385452043, 10.190939478286388, 10.190939478286388, 10.671249730360458, 10.671249730360458, 8.026124949696124, 8.026124949696124, 27.967373497804466, 27.967373497804466, 7.508660537631223, 7.508660537631223, 9.890363700047681, 9.890363700047681, 3.344393879196546, 3.344393879196546, -4.311683294287382, -4.311683294287382, 14.30929056877186, 14.30929056877186, 11.06505424296842, 11.06505424296842, 8.154936607111669, 8.154936607111669, 16.6352098144413, 16.6352098144413, -1.0556140321809682, -1.0556140321809682, 9.060774999764725, 9.060774999764725, 12.815658722087838, 12.815658722087838, 15.149866062145504, 15.149866062145504, 11.184316164088742, 11.184316164088742, 8.831071380948835, 8.831071380948835, 2.1343049894186428, 2.1343049894186428, 1.055036693389333, 1.055036693389333, 8.562576414209511, 8.562576414209511, 2.9176320528108257, 2.9176320528108257, 2.545058979492404, 2.545058979492404, -0.8176324774425184, -0.8176324774425184, 8.281420920398348, 8.281420920398348, 3.444950004512439, 3.444950004512439, 5.583993857044565, 5.583993857044565, -3.1963892679444146, -3.1963892679444146, 16.93995178854171, 16.93995178854171, 10.87478212948295, 10.87478212948295, 7.712708263053621, 7.712708263053621, -1.2603695976506355, -1.2603695976506355, 10.614698446184287, 10.614698446184287, 4.542294320315646, 4.542294320315646, 7.117987106906895, 7.117987106906895, 18.417582167330497, 18.417582167330497, 19.934031472310945, 19.934031472310945, 12.209056079022586, 12.209056079022586, 10.094838001668293, 10.094838001668293, 13.830753361996523, 13.830753361996523, -3.5732874702016924, -3.5732874702016924, -9.088363154086219, -9.088363154086219, 18.06475470627755, 18.06475470627755, -2.5179856817607833, -2.5179856817607833, 5.201724341514064, 5.201724341514064, 2.4887800653601775, 2.4887800653601775, 12.684875290770428, 12.684875290770428, 0.4159538485595138, 0.4159538485595138, -1.6833495136608612, -1.6833495136608612, 23.83266373814091, 23.83266373814091, 3.635002140222296, 3.635002140222296, 3.8540967186060744, 3.8540967186060744, 4.619454439241102, 4.619454439241102, 3.206812702732348, 3.206812702732348, 13.407932519023761, 13.407932519023761, -5.554672703580838, -5.554672703580838, -2.3223833372276976, -2.3223833372276976, 12.17200338782589, 12.17200338782589, -0.40117063205220344, -0.40117063205220344, 12.495429359226003, 12.495429359226003, -6.788989646307428, -6.788989646307428, 19.180920058096014, 19.180920058096014, 16.80964306502287, 16.80964306502287, -3.4295441917597236, -3.4295441917597236, -0.7801365074076666, -0.7801365074076666, -9.698016357182635, -9.698016357182635, 1.9366528275300923, 1.9366528275300923, -0.8874788861922955, -0.8874788861922955, -5.218534451422004, -5.218534451422004, 7.706631552888817, 7.706631552888817, 5.085522555993499, 5.085522555993499, 2.3892724027226597, 2.3892724027226597, 3.2539851436298606, 3.2539851436298606, 13.71704984840185, 13.71704984840185, 10.60314340635942, 10.60314340635942, 0.19396080518747405, 0.19396080518747405, 19.562044007913432, 19.562044007913432, -2.1781541947558773, -2.1781541947558773, 17.632730899089527, 17.632730899089527, 1.0396930195252518, 1.0396930195252518, 4.35756418124015, 4.35756418124015, -1.2565359441900563, -1.2565359441900563, 11.501894274346132, 11.501894274346132, 5.950694289275701, 5.950694289275701, 6.568160009976776, 6.568160009976776, 11.224077204337291, 11.224077204337291, 3.7404489078024277, 3.7404489078024277, 3.0031742411005413, 3.0031742411005413, 0.5379346341571833, 0.5379346341571833, 5.933877583046836, 5.933877583046836, 1.505323746795467, 1.505323746795467, 5.616720443968128, 5.616720443968128, 3.355000048661982, 3.355000048661982, 4.208289546517138, 4.208289546517138, 1.1148283647645385, 1.1148283647645385, -0.03740279841699612, -0.03740279841699612, 8.121873779279257, 8.121873779279257, 5.415656279325489, 5.415656279325489, 18.95303134398043, 18.95303134398043, 0.6808244694758534, 0.6808244694758534, 6.761578019825665, 6.761578019825665, 15.348974140557862, 15.348974140557862, 16.609300029149153, 16.609300029149153, 6.08127063942703, 6.08127063942703, 7.190617847419888, 7.190617847419888, -4.320411417875971, -4.320411417875971, 9.658140568887866, 9.658140568887866, 11.647870144517267, 11.647870144517267, 0.8388419276216588, 0.8388419276216588, -9.459026051767399, -9.459026051767399, -3.5706518354259447, -3.5706518354259447, -1.0542247825332138, -1.0542247825332138, -0.21771119318667104, -0.21771119318667104, -4.541500857805391, -4.541500857805391, -2.889226959771917, -2.889226959771917, 11.3478618563303, 11.3478618563303, 1.5293337300373255, 1.5293337300373255, 12.731238627208526, 12.731238627208526, 5.924033398090477, 5.924033398090477, 8.154860751314526, 8.154860751314526, 2.9613842312393586, 2.9613842312393586, 1.5480288526122803, 1.5480288526122803, -3.413737625293706, -3.413737625293706, -5.853085333382118, -5.853085333382118, 15.27294596723371, 15.27294596723371, 0.9076397005337039, 0.9076397005337039, 7.660319755533978, 7.660319755533978, 2.859908590344852, 2.859908590344852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.347069617384919, "mean_inference_ms": 2.2734956907504613, "mean_action_processing_ms": 0.0986485086075086, "mean_env_wait_ms": 0.599600683990227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 20250, "timesteps_this_iter": 0, "agent_timesteps_total": 60750, "timers": {"sample_time_ms": 13254.441, "sample_throughput": 254.632, "load_time_ms": 0.332, "load_throughput": 10159647.847, "learn_time_ms": 2238.882, "learn_throughput": 1507.449, "update_time_ms": 26.604}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 90.8649299621582, "policy_loss": 0.0018933749641291797, "vf_loss": 90.87698211669922, "vf_explained_var": -0.027030324935913085, "kl": 0.004253380363351056, "entropy": 1.4161608338356018, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 23.25879783630371, "policy_loss": -0.02682643327862024, "vf_loss": 23.2987943649292, "vf_explained_var": -0.0037941694259643554, "kl": 0.008166931186325962, "entropy": 1.4803183794021606, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20250, "num_agent_steps_sampled": 60750, "num_steps_trained": 20250, "num_agent_steps_trained": 60750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 810, "training_iteration": 6, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-48-55", "timestamp": 1706107735, "time_this_iter_s": 13.586709976196289, "time_total_s": 81.38127398490906, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 81.38127398490906, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.62352941176471, "ram_util_percent": 64.95882352941176, "gpu_util_percent0": 0.06529411764705884, "vram_util_percent0": 0.22552849264705882}}
{"episode_reward_max": 22.097412313317985, "episode_reward_min": -41.839874398938235, "episode_reward_mean": -7.445749825644385, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -35.762411090897615, "policy_agent_": -14.059275502045443}, "policy_reward_max": {"policy_adversary_": -4.425782077177219, "policy_agent_": 25.26822603702442}, "policy_reward_mean": {"policy_adversary_": -16.335334367804617, "policy_agent_": 4.444792271080114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.839332694945687, 1.5590037933103256, -12.668730720994096, -7.525890546616289, -8.727343887454436, 3.508455618866986, -4.922358574238537, 2.4190121929012203, -4.597057587745516, 22.097412313317985, -9.717244724013266, -0.2892041563756076, 1.6194141364208106, -2.1568343405076855, -5.494074749232535, -6.876662097868796, -8.173658350010209, -16.873773641386734, -6.039950023080235, -2.5361382500442065, -13.615346113366328, -2.238807122125671, -3.781904831003163, -5.19355522095367, -17.50435193061934, -2.1618829703653732, -9.65981746050235, -0.9492096944543241, -15.882159632450806, -5.3759317006180485, -16.04345447684148, -14.888942548444419, -4.72250836543731, 3.988045094678757, 9.34890487759243, -19.60227592724636, -16.542550107267953, 0.31851204631575747, -15.836743571751935, 3.87484671528853, -3.8106863430625557, -41.839874398938235, -1.2286061143180964, 0.5024300654971537, -3.7631344545517846, -24.092776319138242, -7.857562861136405, -7.342646551298416, 6.631830751466281, 4.512631271017536, 2.321773502580299, -9.59352311525943, -13.852303660546662, 5.200916844402143, -31.58140679816216, -2.1854464677477132, -21.003715100054436, 0.10133753556497593, -2.156791812631641, -8.196006842331514, -6.271004053181429, -1.9405185749210072, 4.782108474291014, 2.478036559615112, -2.185496905135448, -15.354444726320043, -1.993861968182578, -3.6168765333125146, -3.5099375466389082, -7.184547443718602, -13.789798082254173, -10.872151420046587, -6.979752171851679, 1.091885808166588, -18.061392383339236, -20.736460644054876, -10.89684393286627, -17.351300497806196, -8.888496865965548, 0.919305023903703, 2.745778282192392, -8.167717148653963, -12.762540676465065, -11.56342578249594, -18.129091242281078, -8.08365327713516, -7.247259756206108, 3.1214382646186256, -28.575405131415152, -3.903443333346906, 12.619897992340318, -4.794291897414325, -8.29269952900583, -34.794755607763385, 5.4442590420882855, -13.55767632726629, -13.727636090212387, -4.0750639972069145, -15.522074534970923, -28.66379105436383, -18.456456717230726, -2.619658375541996, 4.757824642543392, 3.6398675300570464, -12.449304290157702, -30.40643477562851, 0.2672462490919312, -8.515577420494726, 0.2765747964025731, -5.298545953787048, -13.827512964760453, -13.27409824422802, -14.888337628822628, -2.9772575790982287, -23.779059853943753, -0.11975934582225409, -0.4324943454486938, 1.9168348932823012, -10.697358435929683, -1.989296572309978, -6.341017401351505, -14.244706073556147, -2.529556230583207, -4.704334994438153, -5.235639128521812, -15.657310636101954, -12.730370831152793, -13.468209207919207, -11.470934294817141, 4.432153800603977, -4.598762548629323, -14.663251523988487, -20.744654928777965, -12.30003338981193, -6.81844489461835], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-22.051546424622092, -7.7975173751066045, -20.503171000523654, -13.45946388410697, -11.05435918241463, -18.536963202482934, -12.322525252298394, -20.3843277029036, -19.07601284201759, -28.439039760730857, -13.011672490710367, -28.896525860819224, -17.592385696567817, -10.046087816985692, -12.471464616665601, -7.8498074979317005, -12.10058291509116, -20.936721921818265, -22.845667660719815, -5.930270862206524, -6.655428972081557, -11.089911810947374, -13.027310727532619, -9.479042828766886, -20.12610405515044, -9.624564776897238, -15.696901346149295, -16.59625913902904, -10.162216270708937, -13.393498938551218, -17.506569729762564, -8.222331102517066, -15.530464046749783, -23.101420338264507, -24.22750636048201, -23.88164983632377, -23.161615856516974, -15.011108786812214, -10.653181559440178, -32.68955823507915, -16.13128371002504, -13.721323394847332, -17.652300684990102, -15.548704614742395, -12.312697624499862, -31.237384883856326, -17.658935439280796, -30.748592714336137, -26.027112617608857, -25.572397879985846, -11.89464476127354, -20.28839965975892, -18.618240281196826, -23.73300891190066, -17.060018521788272, -20.561313585300013, -8.496860780236377, -18.00840226902804, -13.08661737294512, -12.599328597352567, -15.15501851169043, -19.67563026814636, -12.686921291992828, -21.63413670707002, -8.237037779202815, -19.00986206863945, -9.779072819398356, -12.918333169272394, -4.873304417606691, -11.614576059058683, -12.689622818431396, -22.91449483648513, -17.239118405272293, -12.339227953550369, -7.001466227935531, -12.547019647649634, -6.136986674195642, -29.25494659910956, -14.4457206496627, -18.410200567747424, -35.762411090897615, -6.607093042574707, -12.131497938362056, -24.206864512821696, -23.27365312823248, -22.319021453873866, -20.41799077770815, -15.989966505080018, -12.436200451337033, -13.391255255525406, -23.73267117143003, -13.825366830026935, -10.417988544431097, -12.338126848621698, -20.490215860301554, -15.351490005620168, -20.862606835387986, -13.403310870712293, -24.052261870429618, -11.069205742362307, -16.90707552837234, -16.104688178891678, -27.435420212434735, -17.577145049329577, -15.402912602894325, -26.15702960155868, -18.805853473257606, -9.461324454562677, -21.12963770590919, -18.347905392677102, -9.94615496275984, -4.425782077177219, -10.540382421616407, -15.27095625038635, -22.04554295526127, -15.933907947559396, -15.21268816552464, -19.404946997582382, -18.745007195428364, -10.60500584759031, -6.106746756979306, -23.13680209552603, -12.535529139346178, -14.43714539076234, -10.11994405000283, -10.224097100982679, -9.358507830704992, -7.849367671627458, -29.521869410360043, -17.57480038813553, -7.850127576361257, -17.166752183876117, -16.683660967063542, -22.010669612489377, -14.492529261337456], "policy_policy_agent__reward": [8.106106864838205, 8.106106864838205, 4.678260584208465, 4.678260584208465, 3.9172201397647806, 3.9172201397647806, 2.966786668745338, 2.966786668745338, 1.1635076474800958, 1.1635076474800958, 11.02270941067496, 11.02270941067496, 3.700083339029928, 3.700083339029928, 11.401669947902407, 11.401669947902407, 7.239477627136036, 7.239477627136036, 25.26822603702442, 25.26822603702442, 1.6472138833485537, 1.6472138833485537, 14.303660852221812, 14.303660852221812, 9.605899916494316, 9.605899916494316, 3.9446267382390032, 3.9446267382390032, 3.4886949337165323, 3.4886949337165323, 0.4865727000314535, 0.4865727000314535, 1.9634622825404748, 1.9634622825404748, 2.0314741402157703, 2.0314741402157703, 8.402858818819787, 8.402858818819787, 1.6970663060811582, 1.6970663060811582, -3.479958570642386, -3.479958570642386, 4.42555234441085, 4.42555234441085, 4.622702948264727, 4.622702948264727, 2.1427438039066087, 2.1427438039066087, 1.310876062265549, 1.310876062265549, 3.731340903265931, 3.731340903265931, 3.01854194282347, 3.01854194282347, 7.823524722287355, 7.823524722287355, -2.8599716808709372, -2.8599716808709372, 4.008783618966585, 4.008783618966585, 0.7315576264605405, 0.7315576264605405, -3.333305722963678, -3.333305722963678, 5.4039778406562355, 5.4039778406562355, 13.544732716471632, 13.544732716471632, 16.78820561903722, 16.78820561903722, 2.1396869545387074, 2.1396869545387074, 3.3095328746245105, 3.3095328746245105, 7.664810416563986, 7.664810416563986, -2.5917810061558715, -2.5917810061558715, 18.282202475183837, 18.282202475183837, 6.160298683481241, 6.160298683481241, -14.059275502045443, -14.059275502045443, 8.211847285336004, 8.211847285336004, 8.025567340119771, 8.025567340119771, 4.274781584974039, 4.274781584974039, 3.572304282359035, 3.572304282359035, 4.900686289072198, 4.900686289072198, 11.702973081518861, 11.702973081518861, 16.329471684537566, 16.329471684537566, 15.042514575501691, 15.042514575501691, 7.108209131926918, 7.108209131926918, 5.347438272249746, 5.347438272249746, 2.3829683103250843, 2.3829683103250843, 14.466962878151401, 14.466962878151401, -7.260694138186941, -7.260694138186941, 9.18793355877615, 9.18793355877615, -6.253427159909028, -6.253427159909028, 9.054869902296508, 9.054869902296508, 5.464912780156739, 5.464912780156739, 2.2016608775105277, 2.2016608775105277, 4.442007229254498, 4.442007229254498, 8.867555846612678, 8.867555846612678, 8.734514883141923, 8.734514883141923, 12.056086633342566, 12.056086633342566, 3.0257704370336844, 3.0257704370336844, 1.827708671159703, 1.827708671159703, 3.892605425607888, 3.892605425607888, 4.650728317979939, 4.650728317979939, 0.6816834354838903, 0.6816834354838903, 2.215014307670038, 2.215014307670038, -0.5500876319113901, -0.5500876319113901, 6.021171708219267, 6.021171708219267, 5.129683116710308, 5.129683116710308, 6.715556880858478, 6.715556880858478, -5.52996307770185, -5.52996307770185, -4.094720498202614, -4.094720498202614, -2.3799286293353177, -2.3799286293353177, 5.951823050651688, 5.951823050651688, 2.778611891848577, 2.778611891848577, 9.664752795825564, 9.664752795825564, 19.254094686545, 19.254094686545, -0.7803120530396253, -0.7803120530396253, -0.31552136905150296, -0.31552136905150296, 6.321719365162879, 6.321719365162879, 2.5722809429757008, 2.5722809429757008, 7.117684088369353, 7.117684088369353, 6.58536551075102, 6.58536551075102, 9.555702384849319, 9.555702384849319, -8.069602340039063, -8.069602340039063, 4.743905961089251, 4.743905961089251, 18.176284581885163, 18.176284581885163, 4.515537466306305, 4.515537466306305, 1.0626445077126336, 1.0626445077126336, -11.228314379570849, -11.228314379570849, 12.96723745119492, 12.96723745119492, 0.8969068391769401, 0.8969068391769401, 3.5674853725878006, 3.5674853725878006, 4.664123436752688, 4.664123436752688, 4.2650936677293405, 4.2650936677293405, -8.797292656000758, -8.797292656000758, -0.7746905944291915, -0.7746905944291915, 6.742514901674842, 6.742514901674842, 16.096622427489066, 16.096622427489066, 10.608506289693308, 10.608506289693308, 1.4768041563683083, 1.4768041563683083, -2.1247025870349123, -2.1247025870349123, 9.536549861174768, 9.536549861174768, 0.4728735170339745, 0.4728735170339745, 10.70310625115588, 10.70310625115588, 6.524679719445028, 6.524679719445028, -1.9406790010003074, -1.9406790010003074, -4.4241580835254055, -4.4241580835254055, -2.173977603603112, -2.173977603603112, 6.14684933564406, 6.14684933564406, -0.8667584493412438, -0.8667584493412438, 7.907074300868573, 7.907074300868573, 7.390096910037972, 7.390096910037972, 10.660890945432339, 10.660890945432339, 4.023824379749344, 4.023824379749344, 4.307854637640165, 4.307854637640165, -0.11713532218609962, -0.11713532218609962, 4.446048010984941, 4.446048010984941, 5.002986454381484, 5.002986454381484, 4.866405198162093, 4.866405198162093, 2.4421524607405076, 2.4421524607405076, -2.7166067675596377, -2.7166067675596377, -1.685931500223901, -1.685931500223901, -2.809420768145876, -2.809420768145876, 9.025467557771453, 9.025467557771453, 11.003477094369753, 11.003477094369753, 1.625682513865966, 1.625682513865966, 1.2517503299438153, 1.2517503299438153, -2.030496980857213, -2.030496980857213, 4.855318111338726, 4.855318111338726, 3.837042183359552, 3.837042183359552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3458249081691288, "mean_inference_ms": 2.2623758686469517, "mean_action_processing_ms": 0.09723076655334698, "mean_env_wait_ms": 0.5975104915699276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 23625, "timesteps_this_iter": 0, "agent_timesteps_total": 70875, "timers": {"sample_time_ms": 13241.384, "sample_throughput": 254.883, "load_time_ms": 0.285, "load_throughput": 11852922.488, "learn_time_ms": 2234.439, "learn_throughput": 1510.446, "update_time_ms": 26.226}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 72.9841323852539, "policy_loss": -0.017032196465879678, "vf_loss": 73.01511764526367, "vf_explained_var": -0.014784395694732666, "kl": 0.0035889715440042243, "entropy": 1.4046085834503175, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 15.706860685348511, "policy_loss": 0.0057665292173624035, "vf_loss": 15.714553165435792, "vf_explained_var": -0.07340207695960999, "kl": 0.005980405573306718, "entropy": 1.4655662178993225, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 23625, "num_agent_steps_sampled": 70875, "num_steps_trained": 23625, "num_agent_steps_trained": 70875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 945, "training_iteration": 7, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-49-08", "timestamp": 1706107748, "time_this_iter_s": 13.161293029785156, "time_total_s": 94.54256701469421, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08D62310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 94.54256701469421, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.941176470588236, "ram_util_percent": 65.02941176470588, "gpu_util_percent0": 0.17176470588235293, "vram_util_percent0": 0.22943474264705882}}
{"episode_reward_max": 13.274626969223146, "episode_reward_min": -33.412274503499255, "episode_reward_mean": -5.134446034171123, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.322780635624596, "policy_agent_": -9.741474359308713}, "policy_reward_max": {"policy_adversary_": -5.041903804956549, "policy_agent_": 23.28212997955733}, "policy_reward_mean": {"policy_adversary_": -16.62026343369818, "policy_agent_": 5.74290869976353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.71111233191556, -10.010517263051097, -3.3346749941776075, 1.9651556516918272, 2.719541553399805, -22.883903538135527, 9.523521939603254, -4.533649763064909, -24.823815136460006, -11.015316877239187, -6.900977300256126, -22.18284734594539, 8.908062068595473, 6.545272034267193, 6.404390842369544, -7.179394596477413, -2.2178637384888846, -2.910329968464342, 6.556809413205292, 1.566758083182817, -4.32930561296933, 5.200532070589663, -9.785935629914235, -17.0176701898867, 6.671961450856549, 6.305253420642938, 10.840951700527086, -33.412274503499255, 5.106638688961827, -11.905600719116432, 0.4232175415790673, -18.261520395126706, -15.96502657288872, -5.773795989359999, -22.20363185328077, -7.8434195263194155, -4.271995323313668, -8.83705974797239, 1.7878269746454167, -16.917040814851376, 0.5634302333469887, 13.274626969223146, -11.090692738916182, -0.9378149086291727, -8.329438824404729, -6.674516959445727, 7.992356873585031, -8.713543808454105, 0.6122443934589726, -31.44068189453837, 3.8757722732230597, -9.976770611953892, 0.996551402578895, 3.0596767256884974, -8.78916466704588, -11.325592840733414, 10.753523009440555, -0.34537381107144405, 0.9131205451610143, -11.122625679766339, 2.363495485151566, -0.9198370316222311, 3.8889213223234966, -22.50527595986463, -3.0600586086914308, -13.923431672517346, -9.332978557992117, -1.1570825175569772, -1.1885946836002148, -9.990478858189999, -10.891386598237531, -17.91897939998326, -1.6423270311792804, -29.05125508291637, -6.629946870451069, -14.999799590999801, 3.2146511701992377, 11.465872572054968, 0.08219820063693872, 0.1880189822373926, -3.7153741170974692, 9.0061144184167, -3.611452814225744, -13.256883240393766, -2.209816715923379, -1.4116866922410463, -2.679916288315516, 6.58845141187156, -5.506562880463125, -2.5196920604313133, 0.09209641458522788, 1.101719138771798, -8.809636018159521, -19.78922219476751, -5.3324767197248, -27.148323794524376, 3.5211898948340608, -8.72174343766682, -2.2486473973294028, 1.7755807448648278, 8.044850016558778, -16.788086055650275, -17.26777139656605, -5.3385504898053755, -6.1733220908335475, -5.186714530376255, -13.467350597465048, 6.563460600134967, 10.198012884370176, 3.593012114280712, -10.354919581201258, -5.170380031828129, 7.9564098743182985, -9.697304698522519, -3.573453431008363, -23.845955007648673, -2.831882026223295, -6.68960023018737, -13.949223320622453, -1.5050296879712879, -14.647052247353969, 12.483727048091977, -22.690775235061693, 6.070404805872781, -2.8352865489588814, -13.093492081512883, -0.26339727210359737, -15.917813564155006, -19.13377658380166, -8.060533420415382, -6.661236163836207, -13.477295329054012, 1.399648572142441, 3.326708432146935, 6.126010357573138], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.316587662708404, -12.999452799518238, -9.304883059770903, -23.32021872211851, -14.24983791744199, -10.070711294133565, -24.58014823976934, -20.021668460113226, -12.56596616577418, -10.26515166808997, -17.90429710405584, -9.079498858560937, -17.296344008005796, -33.322780635624596, -22.177481316532695, -17.19256911386891, -13.186778143674399, -12.8388138529103, -14.796736688451194, -17.12795555307861, -12.706206601149828, -27.430616314848493, -20.72229135375349, -8.212197828601997, -20.95113919792309, -18.19494135395544, -28.29771561184286, -14.482506067045462, -14.447583531425618, -16.657285284050165, -16.34460616489651, -13.334182669225404, -19.271880317817548, -8.670363959651878, -17.273685082189566, -10.650047028854345, -19.932335954305746, -11.41195215141105, -19.22849056011554, -24.062213016795244, -7.634298548250237, -33.289632989891516, -10.089821167510198, -6.972149952719348, -25.276064244728317, -15.142620700977272, -19.97427197143568, -13.225259278249412, -23.84328551610288, -11.95773317592094, -18.455446931232245, -16.95481056107996, -15.281371982663252, -13.686927645011332, -10.389579045896694, -22.06452805606649, -30.045553698688522, -15.191534685167914, -24.230642743596206, -5.537023281947802, -25.348523902570232, -10.559207065454125, -22.52724068179423, -12.070640440977565, -23.58866603388321, -11.641329912312916, -21.354861698689536, -12.160412435802712, -10.938203156882466, -10.486402254315673, -17.337608592106854, -18.464136695583353, -10.858647212982591, -18.213892092900743, -12.471891410417665, -9.486380829882757, -16.65595143927274, -22.102580992175017, -13.709490062284484, -9.386824676339192, -19.694148932214706, -28.343887119615903, -9.380923144361034, -16.141964264605683, -8.337520004751498, -14.324573798569538, -10.210190886284634, -29.44159237839006, -18.67198279687888, -12.291819658441879, -15.600757222851886, -16.57827071400131, -20.979781172744605, -13.024070365385267, -9.225356687247983, -12.053398658160864, -18.540300984944526, -16.159524458674294, -24.638377526672617, -12.638610122082751, -18.802592471096755, -5.041903804956549, -23.95021900523984, -22.690550488496765, -6.777251746401064, -10.595932739940455, -14.425103896704282, -33.25651283774268, -26.951344877025395, -16.72753857006117, -12.16044046182145, -6.651869136379959, -21.86337167528617, -6.918793436597041, -9.947688547477435, -18.86692961773646, -14.482013060064268, -9.9430356277738, -20.3139271401173, -9.080116439444167, -25.96196992522712, -22.072080194653978, -16.177741135613175, -17.48432054229115, -8.393600972362423, -22.246525489664705, -19.412415507833302, -14.179654441836597, -11.576815492964618, -14.725573334516845, -23.16914739872296, -14.374862127022906, -21.583901170438693, -28.99002844909034, -25.157171811947773], "policy_policy_agent__reward": [3.302737665396425, 3.302737665396425, 1.4944677682335705, 1.4944677682335705, 2.985104032796648, 2.985104032796648, 12.642687186905164, 12.642687186905164, 8.484689735420893, 8.484689735420893, -6.406596122000986, -6.406596122000986, 17.0518350896863, 17.0518350896863, 7.744009348524157, 7.744009348524157, -6.1289244853429174, -6.1289244853429174, -0.3750826045746123, -0.3750826045746123, 5.501659901899858, 5.501659901899858, -6.551674243692231, -6.551674243692231, 13.102203038300637, 13.102203038300637, 19.934026334945887, 19.934026334945887, 14.290936079451122, 14.290936079451122, 5.00658725869575, 5.00658725869575, 5.484457202592758, 5.484457202592758, 4.964241942222977, 4.964241942222977, 10.676773050828244, 10.676773050828244, 9.347356818130713, 9.347356818130713, 4.188450494090248, 4.188450494090248, 16.31557419271908, 16.31557419271908, 5.468177861919634, 5.468177861919634, -4.402736180642348, -4.402736180642348, 13.811550324389819, 13.811550324389819, 12.25009738729919, 12.25009738729919, 19.569333656184973, 19.569333656184973, -9.464884218226898, -9.464884218226898, 9.777111110193726, 9.777111110193726, 2.3758422824668672, 2.3758422824668672, 8.383911853237787, 8.383911853237787, -2.4636688629506533, -2.4636688629506533, 1.6534268724644081, 1.6534268724644081, 1.4482839851459395, 1.4482839851459395, -2.4649733855456013, -2.4649733855456013, 1.4033137512674627, 1.4033137512674627, 7.830170315496038, 7.830170315496038, 1.2874462017193289, 1.2874462017193289, 10.508158767380477, 10.508158767380477, 3.5725861009719306, 3.5725861009719306, 4.098864390798613, 4.098864390798613, 23.28212997955733, 23.28212997955733, -0.5004357857029885, -0.5004357857029885, 3.0171675220450873, 3.0171675220450873, 8.473312710161794, 8.473312710161794, 4.234051870765776, 4.234051870765776, 13.983314422510354, 13.983314422510354, 2.2558577348976487, 2.2558577348976487, 12.227764954780929, 12.227764954780929, -9.741474359308713, -9.741474359308713, 11.165609602227653, 11.165609602227653, 3.4890199745630377, 3.4890199745630377, 8.138961692621073, 8.138961692621073, 8.373302185349916, 8.373302185349916, 0.8002071894254084, 0.8002071894254084, 5.369467607666536, 5.369467607666536, 20.399538354064536, 20.399538354064536, 7.423080437048235, 7.423080437048235, 12.571881644378616, 12.571881644378616, -2.7928011989092685, -2.7928011989092685, 13.856009693860901, 13.856009693860901, 4.819685016915948, 4.819685016915948, 13.208081002058865, 13.208081002058865, -5.21731775944354, -5.21731775944354, 10.264303712595892, 10.264303712595892, -1.141050880102217, -1.141050880102217, 6.010941570348709, 6.010941570348709, 5.501664959122864, 5.501664959122864, 4.874804236641123, 4.874804236641123, 0.24796169806283802, 0.24796169806283802, 3.223110996934662, 3.223110996934662, 0.2725786478000447, 0.2725786478000447, 4.608160090901656, 4.608160090901656, -5.418681495007812, -5.418681495007812, 2.920972269983296, 2.920972269983296, -2.756709380558525, -2.756709380558525, 9.93530130473599, 9.93530130473599, 16.78422678211499, 16.78422678211499, 6.895844131460711, 6.895844131460711, 4.787421829288292, 4.787421829288292, 7.989387407558619, 7.989387407558619, 18.6750007690163, 18.6750007690163, 2.8847351650676463, 2.8847351650676463, 1.4425405121059611, 1.4425405121059611, 3.0638516444140595, 3.0638516444140595, 6.456443553164249, 6.456443553164249, 3.7651372989845595, 3.7651372989845595, 18.015021895130808, 18.015021895130808, 6.582709958207879, 6.582709958207879, 4.886063799005282, 4.886063799005282, 7.846426818718555, 7.846426818718555, 8.839994926386554, 8.839994926386554, 6.0850725772925385, 6.0850725772925385, -3.382575914691122, -3.382575914691122, 1.9464399837615898, 1.9464399837615898, -7.547462568181761, -7.547462568181761, 11.030745439889296, 11.030745439889296, 3.7188905105037398, 3.7188905105037398, 11.194865064671605, 11.194865064671605, 7.207095433473791, 7.207095433473791, 13.423721243827764, 13.423721243827764, -5.873091125346864, -5.873091125346864, 3.3412238043368925, 3.3412238043368925, 8.675999999345695, 8.675999999345695, 0.30196482778376, 0.30196482778376, 2.7046091047820995, 2.7046091047820995, 0.47887664961961895, 0.47887664961961895, 19.909986718938825, 19.909986718938825, 18.57467888069779, 18.57467888069779, 10.160275342170946, 10.160275342170946, 0.9027604403100974, 0.9027604403100974, 0.7407445522759164, 0.7407445522759164, 14.909890774802232, 14.909890774802232, -1.3892556309627402, -1.3892556309627402, 3.187117558234534, 3.187117558234534, -2.4895126949561024, -2.4895126949561024, 5.825065516920487, 5.825065516920487, 1.6267176987932161, 1.6267176987932161, 3.1823519097474255, 3.1823519097474255, 3.7875433757364387, 3.7875433757364387, 5.6574588389365745, 5.6574588389365745, 17.277903621372975, 17.277903621372975, -3.2565170497242657, -3.2565170497242657, 11.777362674081965, 11.777362674081965, 2.779157211701771, 2.779157211701771, 4.57651670407591, 4.57651670407591, 9.574509117864851, 9.574509117864851, -0.8690795611592061, -0.8690795611592061, -3.77848054541852, -3.77848054541852, 3.3325199570507307, 3.3325199570507307, 8.253955617443376, 8.253955617443376, 0.4487833989844478, 0.4487833989844478, 11.491774871290568, 11.491774871290568, 16.15836844061864, 16.15836844061864, 15.641591084760455, 15.641591084760455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34580295505825226, "mean_inference_ms": 2.2692388349312256, "mean_action_processing_ms": 0.09735651294121125, "mean_env_wait_ms": 0.5987035671613918, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 27000, "timesteps_this_iter": 0, "agent_timesteps_total": 81000, "timers": {"sample_time_ms": 13303.302, "sample_throughput": 253.696, "load_time_ms": 0.374, "load_throughput": 9035121.111, "learn_time_ms": 2255.587, "learn_throughput": 1496.285, "update_time_ms": 26.56}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 70.04052276611328, "policy_loss": -0.025577051378786565, "vf_loss": 70.0795509338379, "vf_explained_var": -0.011670243740081788, "kl": 0.006534247384520969, "entropy": 1.3534869074821472, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 16.158382654190063, "policy_loss": 0.010604542796500027, "vf_loss": 16.16090097427368, "vf_explained_var": 0.009207776188850403, "kl": 0.00606464049235933, "entropy": 1.4335425913333892, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 27000, "num_agent_steps_sampled": 81000, "num_steps_trained": 27000, "num_agent_steps_trained": 81000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 8, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-49-22", "timestamp": 1706107762, "time_this_iter_s": 13.89314079284668, "time_total_s": 108.4357078075409, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A738AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 108.4357078075409, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.18888888888889, "ram_util_percent": 64.51666666666667, "gpu_util_percent0": 0.1961111111111111, "vram_util_percent0": 0.22599283854166666}}
{"episode_reward_max": 15.43115034917793, "episode_reward_min": -22.123093657550907, "episode_reward_mean": -3.863297557454079, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.150848668227624, "policy_agent_": -5.305691600915121}, "policy_reward_max": {"policy_adversary_": -3.3761548357549183, "policy_agent_": 25.154675181806635}, "policy_reward_mean": {"policy_adversary_": -16.71151834066504, "policy_agent_": 6.4241103916054785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.852518270820622, -7.833844691827686, -16.85165362366257, 4.766496403277952, -2.6673244926143163, -3.0494351905048824, 8.918228207411243, -1.361414977938399, 6.529696381791614, -8.219657525206205, -15.382397412363197, 6.476924914615535, -2.9588705471893877, 2.592375183001237, -15.942227285925934, -12.503099078259806, 1.2765623996245548, -7.054291123920487, -12.41704882158542, -8.47196188587763, -9.269939827530317, -2.531746553010472, -1.466218657470782, -7.331626653349275, -11.029789731276065, -11.235512823063116, -15.35655411388992, -0.28845262974619146, -2.67225120050346, 2.2544426617388442, -0.9184793033195179, -12.592907813721316, 4.4511382170697695, -5.003698298060198, -9.372692483643775, -7.554265811520514, -5.443823271383749, -2.1101037593718406, -5.174795337124291, 8.265156659367436, -7.951754549535314, 7.649277405337603, -7.921444864598682, -2.2987815723313965, 3.414866517322287, -8.722616386053277, -3.7338461769569267, 0.14974264757304828, 3.620777422161401, -1.5313956870658987, -12.161794568191697, 0.2655036847326818, -9.22781898407672, -3.1903383251715036, 8.085504780141639, -7.71116381520557, -3.812426850740768, -7.248700262172015, 0.22494335277367172, 7.719814889581114, -15.363348337372642, -3.8052930367718587, -6.146954409369292, 15.43115034917793, 0.7919509947949227, -7.186893912206965, -21.366182206043348, 6.23716629943724, 5.54780344078962, 6.031689057663098, 2.7434411490979085, -0.43846469796518833, -1.4173567870604589, -16.611534428017535, 2.1464632238311165, 6.209691389555466, 9.091121583999668, -6.999619479910875, 5.273783461680941, 2.9760759838479864, -13.515489696335951, -21.69305202650392, 4.26879590345864, -5.342273026001896, -5.666832001820941, -2.3924061338140366, -6.767853342115576, -2.1254946100444947, -1.9500820499650007, -3.409093901009272, 0.3428305517321455, 1.9582574788277145, 4.159693981713351, 1.1585213460747343, 1.9352372057355889, 13.510314604930453, 0.8928701464233071, -10.88691461856923, 6.3548587959809755, -14.24766856788917, -4.284922774258107, -2.7311682926868324, -10.332611123848569, -11.683313905426767, -5.230032608834208, -13.859757881770488, -1.1089260432458794, -18.20122616284549, -5.052615073462583, -6.083114099841003, 9.52191362524492, -5.47708159699888, -10.175435518372883, -16.46403787515232, -5.323089634442394, -1.6287212018534887, 1.0469967106909746, 2.659299154994401, -20.83017890163861, -15.315652015380872, -15.604162237137249, -2.1408346822949493, -15.802682356572369, -22.123093657550907, 3.197111160796207, -5.260272633122859, -3.1447483288667395, -6.7406049415970495, -12.488801540850904, -0.9745845419628543, 6.621155563690821, -7.171752154531551, -1.9999982015636737, 2.4160650417018474, -3.7339676970151716], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.125752142252033, -20.5515523837333, -8.467067908319661, -18.15537076771525, -15.535276095786555, -22.580583665328998, -21.517924471246122, -15.877421815895524, -19.76757470945655, -10.508122160971533, -11.157039367757108, -26.830932173496564, -13.846438647260653, -13.56999331824322, -8.055389441479038, -14.78961914283017, -26.39504385550962, -16.05016127742108, -7.42748961132064, -13.305731686354724, -21.104977062102865, -36.150848668227624, -15.152904815719268, -13.32186406854429, -6.989107215609462, -15.726264331243504, -16.90165637744977, -17.861736838662193, -19.707866800611296, -13.992394411407679, -13.051657513292612, -10.58789042338695, -20.049595955312917, -11.465792891560186, -8.244547434370979, -8.921119195235454, -19.55800056380935, -12.995653094447253, -10.146128316790067, -26.075718693028097, -13.89548753330692, -28.286992703782488, -23.026481943370026, -11.74910467201418, -16.768101917635978, -17.89736747259751, -15.44927978862699, -15.485413477954925, -11.475141855674742, -8.274564930403386, -22.92670905778361, -21.22236688482527, -8.492111049863267, -9.582433517251905, -22.58945196704713, -20.691288334488082, -16.430372383913557, -19.956828216611964, -11.514928973352546, -18.06887167891105, -14.710242854416212, -15.084613573754202, -12.695030833648541, -34.87820001443531, -27.19412304205039, -6.295271459110738, -18.737319471783362, -19.555440402744953, -17.35142717243903, -13.24245411331899, -12.837472657725682, -21.55669736319604, -8.74965904524541, -9.140932272607452, -19.14703068309171, -22.124302657428096, -32.67379221385137, -14.445870093495106, -14.052138757245354, -14.924566411071197, -9.085937622490343, -22.003692188947916, -13.682571743551668, -8.42965652117087, -28.506290422466087, -25.02543943939808, -14.546593742394634, -6.863456747202447, -18.265212761051817, -10.685492173666768, -11.620565404918207, -16.148316078204708, -27.002486157450967, -12.096176168145933, -24.755094385124455, -25.64523115728771, -23.90870491510197, -10.390930409836008, -16.80867177985527, -18.260444736773326, -22.483076567431844, -28.663880638938785, -11.66042346484394, -7.293392476264273, -18.547542412467454, -11.40661208105252, -12.137277001433478, -7.589842961015241, -8.829952891697575, -12.094696452784309, -20.17727430389902, -3.3761548357549183, -19.605169795493364, -13.147412045132143, -13.741457786652386, -21.49408652768855, -25.86695563384658, -31.58936596651522, -20.795951647864126, -15.296296931843015, -13.56644809649107, -17.87093657821653, -21.472060809423287, -22.175723322932992, -26.831516667221234, -15.580952624083302, -25.497865321461322, -19.59759627754315, -10.693096135534462, -12.299455509118053, -17.295478385027145, -10.908890896297475, -18.311429024769016, -17.10158689658409, -14.624059702154153], "policy_policy_agent__reward": [7.136616935715706, 7.136616935715706, 6.35885384595281, 6.35885384595281, -4.192292857671455, -4.192292857671455, 11.460933585496605, 11.460933585496605, 6.4339758015861195, 6.4339758015861195, 9.765574237412062, 9.765574237412062, 15.218076339328682, 15.218076339328682, 7.258003418978564, 7.258003418978564, 13.148635545624082, 13.148635545624082, 1.1442323178826657, 1.1442323178826657, -2.1126790223030496, -2.1126790223030496, 16.653928544056047, 16.653928544056047, 5.443784050035633, 5.443784050035633, 8.081184250622231, 8.081184250622231, -3.943418922223445, -3.943418922223445, 1.1432600322851787, 1.1432600322851787, 13.835803127567086, 13.835803127567086, 4.497935076750297, 4.497935076750297, -2.49477960513239, -2.49477960513239, 2.416884900238546, 2.416884900238546, 5.917518617286273, 5.917518617286273, 16.809551057608576, 16.809551057608576, 6.843343079124241, 6.843343079124241, 2.9951187075975056, 2.9951187075975056, -2.020341257833303, -2.020341257833303, 2.2453757540901975, 2.2453757540901975, 0.7725511317799214, 0.7725511317799214, 8.786642104458, 8.786642104458, 8.51780780005392, 8.51780780005392, 8.123418536573258, 8.123418536573258, 6.066589104986547, 6.066589104986547, -1.0025086951671842, -1.0025086951671842, 12.250367086191341, 12.250367086191341, 3.2310472967499946, 3.2310472967499946, -0.5640725246363958, -0.5640725246363958, 0.6834266918574701, 0.6834266918574701, 7.0570886462128, 7.0570886462128, 5.442774667537706, 5.442774667537706, 2.485666489832888, 2.485666489832888, 17.170437676197768, 17.170437676197768, 2.9718664918857987, 2.9718664918857987, 17.968135054560044, 17.968135054560044, 7.5525185393856695, 7.5525185393856695, 4.725161549841393, 4.725161549841393, 10.09148421747913, 10.09148421747913, 4.587375543272113, 4.587375543272113, 5.8577168058350315, 5.8577168058350315, 7.817578062763988, 7.817578062763988, 7.5479596389180745, 7.5479596389180745, 3.371584621668744, 3.371584621668744, 5.382457244795961, 5.382457244795961, 10.743935284778976, 10.743935284778976, -0.3678539671067229, -0.3678539671067229, 3.1960475960402013, 3.1960475960402013, 15.33747837359438, 15.33747837359438, 6.490062259641257, 6.490062259641257, 6.308972766586393, 6.308972766586393, 6.354063977219973, 6.354063977219973, 5.869936163063107, 5.869936163063107, 12.894343284246085, 12.894343284246085, -0.32655274147822383, -0.32655274147822383, 5.639660268491172, 5.639660268491172, 3.274038212139625, 3.274038212139625, 25.154675181806635, 25.154675181806635, 13.993037018422653, 13.993037018422653, -0.44581122654811434, -0.44581122654811434, -1.3144313671299972, -1.3144313671299972, 12.896303351091092, 12.896303351091092, 11.449615306614325, 11.449615306614325, 9.63707158549104, 9.63707158549104, 7.790456903411793, 7.790456903411793, 10.559116332615426, 10.559116332615426, 3.666151129092476, 3.666151129092476, -3.7353010777050404, -3.7353010777050404, 10.646746953461413, 10.646746953461413, 14.166997023491785, 14.166997023491785, 20.882456898925525, 20.882456898925525, 3.7231253067921175, 3.7231253067921175, 9.662961109463147, 9.662961109463147, 8.950321197459589, 8.950321197459589, -2.2147760369228, -2.2147760369228, 0.15532008122199736, 0.15532008122199736, 8.975683823505152, 8.975683823505152, 1.5436917475844878, 1.5436917475844878, 11.419729210322577, 11.419729210322577, 11.316516652792021, 11.316516652792021, 3.889370200139529, 3.889370200139529, 2.3689810685789756, 2.3689810685789756, 8.157565355543406, 8.157565355543406, 3.638199136328748, 3.638199136328748, 5.981697978325176, 5.981697978325176, 9.05328677851621, 9.05328677851621, 15.581090069582162, 15.581090069582162, 6.627348757110332, 6.627348757110332, 13.345165795430022, 13.345165795430022, 19.57777288110908, 19.57777288110908, 12.400787530762642, 12.400787530762642, -0.24799210436661392, -0.24799210436661392, 11.581765287918127, 11.581765287918127, 2.0063880844420745, 2.0063880844420745, 9.09907689658687, 9.09907689658687, 12.966356173125979, 12.966356173125979, 0.6639061704976886, 0.6639061704976886, -2.19496071458125, -2.19496071458125, 6.658754901816623, 6.658754901816623, -1.2265729003589856, -1.2265729003589856, 5.514175479093799, 5.514175479093799, -5.305691600915121, -5.305691600915121, 1.8886689091174964, 1.8886689091174964, 3.0057911764716536, 3.0057911764716536, 14.849593964571966, 14.849593964571966, -1.0504633806219812, -1.0504633806219812, 4.714867138560242, 4.714867138560242, -1.658312915010093, -1.658312915010093, 4.209184076104997, 4.209184076104997, 9.93268266291753, 9.93268266291753, 13.456976172268778, 13.456976172268778, 17.124332560754812, 17.124332560754812, -0.017113626887251376, -0.017113626887251376, -0.009677541768932346, -0.009677541768932346, -1.018857070323084, -1.018857070323084, 7.865050947960789, 7.865050947960789, 2.834689226425449, 2.834689226425449, 0.026314832691037127, 0.026314832691037127, 15.014313914008724, 15.014313914008724, 5.160339995480223, 5.160339995480223, 11.176558496297293, 11.176558496297293, 6.428495667973054, 6.428495667973054, -0.8978527026582191, -0.8978527026582191, 5.662435483577601, 5.662435483577601, 11.958316974358985, 11.958316974358985, 1.868569370882962, 1.868569370882962, 8.155715411602669, 8.155715411602669, 9.758825969142965, 9.758825969142965, 5.445046002569494, 5.445046002569494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34485072321236415, "mean_inference_ms": 2.270611926026568, "mean_action_processing_ms": 0.09797231783171338, "mean_env_wait_ms": 0.5984486263635725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 30375, "timesteps_this_iter": 0, "agent_timesteps_total": 91125, "timers": {"sample_time_ms": 13356.106, "sample_throughput": 252.693, "load_time_ms": 0.443, "load_throughput": 7621103.308, "learn_time_ms": 2233.197, "learn_throughput": 1511.286, "update_time_ms": 26.493}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 69.87688598632812, "policy_loss": 0.009650341793894767, "vf_loss": 69.88045196533203, "vf_explained_var": -0.04331835508346558, "kl": 0.003981420818386953, "entropy": 1.3266876697540284, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 14.291713666915893, "policy_loss": -0.019426466431468725, "vf_loss": 14.324266529083252, "vf_explained_var": -0.06641696989536286, "kl": 0.005440236158510509, "entropy": 1.421480005979538, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30375, "num_agent_steps_sampled": 91125, "num_steps_trained": 30375, "num_agent_steps_trained": 91125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1215, "training_iteration": 9, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-49-36", "timestamp": 1706107776, "time_this_iter_s": 13.37156057357788, "time_total_s": 121.80726838111877, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08E48B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 121.80726838111877, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.39411764705883, "ram_util_percent": 64.43529411764706, "gpu_util_percent0": 0.058235294117647066, "vram_util_percent0": 0.22779756433823528}}
{"episode_reward_max": 13.53282308641304, "episode_reward_min": -37.07780790877643, "episode_reward_mean": -4.5222555885881635, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -38.61538031092631, "policy_agent_": -9.35640541266261}, "policy_reward_max": {"policy_adversary_": -4.957222230327723, "policy_agent_": 24.619258890166563}, "policy_reward_mean": {"policy_adversary_": -16.334484192238737, "policy_agent_": 5.906114301825289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0472148388313403, -8.97374026276848, -6.28946881047939, -9.61039846363934, 0.7080103219841922, 1.4383245224576489, -20.984893795125693, -0.4407385390266703, 13.53282308641304, 3.256515738515441, -9.781047124552696, 0.9223529958204191, -4.313842434841507, -13.959765416411502, 1.8994130976720003, -5.048007946730429, -0.5986808719087832, -5.114378582457694, -7.396789044560244, 9.879283856924625, -9.144079243141272, -0.7642302525115697, -3.6391201234588664, -13.882094130342608, 1.1857017642636136, -3.770077126190536, 7.495006913168656, 8.250872162192005, 9.12276366353231, -2.142620499424778, -2.4299787902116776, -0.8330870332211489, -8.086147189742677, -1.3835655166643304, -7.223252818420218, -7.36144330250101, -4.490955907478542, -4.412399518998405, -5.314281459497039, 2.221151767223346, 0.6207393591025626, -4.936401320482609, -18.964913761351788, -0.9273405188825812, -3.3718450409840255, -2.9526271048905532, -9.691030050958187, -3.052254169418298, 3.3425424046403074, -10.764003484424538, -9.50063610726132, -4.272162606197155, -4.631129455316507, -7.578472632365884, -0.8497248361625127, -14.223587518012623, 4.039946622743804, -11.900650970554874, 4.381123132217236, -0.1425878464073046, -20.03788753545988, -5.29899128987663, -3.1686023160783265, -3.798008378850544, -2.978752374647131, -0.8468916317469108, 5.67831327607797, -27.130631273413854, 5.8382497177686385, -10.452427030604444, -7.49042824691483, -9.404902087509404, 10.109748007086434, -1.2632392194355555, 0.8683583656177852, -5.026105809963832, -4.200574046145482, -11.827368799921773, 1.1259327061397282, -18.408983367395397, 0.7888259434738601, -4.214240997932192, -3.7599320851915388, -5.005005443425247, 3.1206590559285754, -25.32473848121146, -13.24232420391879, 3.3189005598640255, 0.5953840575317633, -8.666607337381743, -6.926840662390424, -1.4318588623563806, -4.817246811052436, -5.458316951499487, -32.23290983191957, 0.40248383431966106, 10.623137469406808, -2.973714005898762, -3.7139725911463435, -8.07158978099533, -2.3509228141348144, -9.704215714703045, 7.918681288160088, -15.382537306622735, -9.13156186905205, -0.6003645256322618, -2.2105834687299963, -10.432263181583885, -13.47289202767871, 0.05454263182638408, -17.498456999273586, -2.693375848351666, 1.3735097562129501, -9.3635736798259, -12.825891583347989, 1.6887507754933495, -16.828780635478772, -3.317528214581176, -3.896634630181611, -25.897335717773586, -7.485356190723843, -2.5120993946418504, 7.480144033072373, -37.07780790877643, -8.902255846737715, 1.5303120387723892, 6.3349115720378375, -2.013979704592154, -3.120436617085428, -5.991083081191445, 1.339545702981754, -0.6618454467379056, -2.5024587881987097, -0.1214819213450122, 2.2785847003669364], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.240722131193248, -11.278898338044499, -12.327760827971062, -7.496942966401994, -13.060387181049117, -15.740146320202681, -6.744771648047384, -21.045544389928992, -24.212779108301117, -16.946673411648483, -15.073100269435656, -18.40638599852304, -11.22317160729538, -15.973459509380495, -23.78934534864888, -11.57633964906966, -9.993307127895338, -14.763414229759093, -16.472458166485463, -26.807209968915757, -24.854825623917076, -13.241976034252, -17.78916367051887, -11.401020984619876, -20.30287637758727, -16.07256635958418, -27.529637820963874, -20.390045866592846, -25.12155532503691, -11.296924211575814, -7.913287085277467, -9.849424144779032, -6.472742728157354, -14.865235531163346, -12.465075329720392, -8.697823567082077, -19.32022989739712, -18.998145927585437, -15.187289647446153, -25.306052553613874, -12.069919980099469, -13.234613738332534, -30.360459394284256, -18.242054167337223, -10.116727730476674, -23.95709100429059, -8.031374912195815, -13.998062817361278, -23.094929180617054, -10.579619637424525, -15.79323831631118, -25.81929184209895, -9.144169011064188, -13.449415217398249, -17.42004317775162, -22.14584949073551, -23.17032428784204, -28.617659204788442, -17.982966082136354, -15.827835567614047, -20.716328295284825, -9.571089340724289, -16.115861529458215, -13.586967774630434, -18.477751131647366, -8.944116821853088, -20.885048823466775, -12.888118319810788, -23.28116453840163, -9.57624283417353, -8.047560421499371, -9.177988846760611, -21.32156224513262, -16.33007943439351, -16.556826018108744, -9.276364877081477, -15.857891145096731, -9.319513017624658, -15.920291619404344, -27.87021724951642, -18.926281291431664, -9.43092842443079, -8.240653797577357, -10.825344514632203, -23.123363513533864, -12.222967077025638, -8.460958904391608, -16.592613522539857, -19.886275318830776, -14.297604890816942, -10.616936239649144, -4.957222230327723, -9.486247151527367, -14.714636297211825, -13.520099006594343, -22.268338648143466, -38.61538031092631, -12.66840734432609, -28.681370013162756, -16.7791219005576, -9.770051507237154, -6.620055152508161, -20.747641851274437, -20.639860553704867, -29.967786101620938, -13.887581829591518, -13.217273530641723, -21.60101213791923, -18.95629739849688, -9.624594157823326, -10.430531045758716, -11.398971859049242, -13.414794950297368, -16.556661982001955, -14.803823692525, -14.234648532416603, -8.566693160504872, -18.91556009899277, -17.920888674174826, -20.383534452956397, -21.608428250112983, -10.88518502317327, -20.416990416302852, -23.53241568932616, -13.47757819756157, -17.18602078625961, -23.200293617890647, -25.237164222888346, -12.545596821397767, -11.939120637478007, -21.914595950876517, -19.058841631986798, -23.109628540251727, -17.33671190344807, -21.708435266844642], "policy_policy_agent__reward": [11.143968485012289, 11.143968485012289, 1.152579037638009, 1.152579037638009, 3.0191460087458357, 3.0191460087458357, -1.056727748618676, -1.056727748618676, 6.884198751516654, 6.884198751516654, 8.589235421330164, 8.589235421330164, -7.120061073539156, -7.120061073539156, 10.30240292545116, 10.30240292545116, 18.872801097357087, 18.872801097357087, 10.101594575081961, 10.101594575081961, 2.646026572441478, 2.646026572441478, 9.664369497171732, 9.664369497171732, 3.4546645862269365, 3.4546645862269365, 1.0068470464844983, 1.0068470464844983, 12.84437922316044, 12.84437922316044, 3.2641658511696146, 3.2641658511696146, 4.6973131279932785, 4.6973131279932785, 4.8245178236507, 4.8245178236507, 4.537834560962612, 4.537834560962612, 18.343246912920193, 18.343246912920193, 7.855373190387903, 7.855373190387903, 6.238872890870215, 6.238872890870215, 7.075021773530003, 7.075021773530003, -1.240536572861365, -1.240536572861365, 10.744289070925447, 10.744289070925447, 6.151244616696822, 6.151244616696822, 17.512322367066265, 17.512322367066265, 14.320459014392425, 14.320459014392425, 17.122159494284602, 17.122159494284602, 4.577151856075518, 4.577151856075518, 2.7416541475328957, 2.7416541475328957, 4.5081685557789415, 4.5081685557789415, -0.806702230792663, -0.806702230792663, 6.740835007249506, 6.740835007249506, 2.6209112556500886, 2.6209112556500886, 0.6681901322905324, 0.6681901322905324, 7.414636994959293, 7.414636994959293, 7.292873204293512, 7.292873204293512, 4.9365040939745555, 4.9365040939745555, 13.763602160418612, 13.763602160418612, 6.345329669601013, 6.345329669601013, 4.149106208924963, 4.149106208924963, 5.697772816466222, 5.697772816466222, 8.657356824227323, 8.657356824227323, 3.3724413447463237, 3.3724413447463237, 10.50223194970002, 10.50223194970002, -0.8298275693811841, -0.8298275693811841, 5.472904323971491, 5.472904323971491, 13.218735792628681, 13.218735792628681, -0.0921919235000066, -0.0921919235000066, 3.146301104524931, 3.146301104524931, 10.773564617950896, 10.773564617950896, 2.2565197778738386, 2.2565197778738386, 2.935471292516186, 2.935471292516186, 8.285159170794556, 8.285159170794556, 3.961130986361446, 3.961130986361446, 13.605135455292924, 13.605135455292924, 8.358504117116784, 8.358504117116784, 11.182044607176795, 11.182044607176795, 7.8426238606033705, 7.8426238606033705, 0.3392203799124694, 0.3392203799124694, 2.136049025423832, 2.136049025423832, 6.473629606689944, 6.473629606689944, 4.894479697889943, 4.894479697889943, 7.74949937850012, 7.74949937850012, 4.04861259505309, 4.04861259505309, 13.281681049772374, 13.281681049772374, -7.1212564768015305, -7.1212564768015305, 14.559707128085137, 14.559707128085137, -0.43809209821545736, -0.43809209821545736, 0.2785660872922728, 0.2785660872922728, -0.11345662037439455, -0.11345662037439455, 15.715655126109526, 15.715655126109526, 7.533420107478978, 7.533420107478978, 8.712592191863267, 8.712592191863267, 2.125129533558822, 2.125129533558822, 5.828658549475627, 5.828658549475627, -1.2539278911485576, -1.2539278911485576, 8.523112162772033, 8.523112162772033, 4.730616941060506, 4.730616941060506, 9.857553617452764, 9.857553617452764, 2.6083437132493006, 2.6083437132493006, 2.24036085619291, 2.24036085619291, 2.910169535603476, 2.910169535603476, 13.122011284731219, 13.122011284731219, -6.550885702092908, -6.550885702092908, -2.3906826497635922, -2.3906826497635922, 9.95575704120194, 9.95575704120194, 10.240829688181272, 10.240829688181272, 2.815498776717599, 2.815498776717599, 1.8450477886293628, 1.8450477886293628, 1.7626816839856718, 1.7626816839856718, 2.3345001702374653, 2.3345001702374653, 4.62815967285617, 4.62815967285617, -9.35640541266261, -9.35640541266261, 11.335411241231562, 11.335411241231562, 24.619258890166563, 24.619258890166563, 4.847346669213664, 4.847346669213664, 12.483698711008211, 12.483698711008211, 4.353766059781138, 4.353766059781138, 3.7095643465511694, 3.7095643465511694, -1.542080281097443, -1.542080281097443, 14.333161569717264, 14.333161569717264, 2.6286616235410643, 2.6286616235410643, 10.418112116284451, 10.418112116284451, 6.643608651979628, 6.643608651979628, 5.503345030955864, 5.503345030955864, 5.5843744781676765, 5.5843744781676765, 2.741702685409085, 2.741702685409085, 4.839568394824854, 4.839568394824854, -3.533962976757427, -3.533962976757427, 4.352798005348786, 4.352798005348786, 7.394152353255159, 7.394152353255159, 3.5965441510880267, 3.5965441510880267, 0.9889660545885077, 0.9889660545885077, 7.961699653954977, 7.961699653954977, -4.131043737486954, -4.131043737486954, 7.799015942205797, 7.799015942205797, 7.012127021996604, 7.012127021996604, -2.7569006324085983, -2.7569006324085983, 7.061536029694569, 7.061536029694569, 4.18654281426571, 4.18654281426571, 13.948567224687613, 13.948567224687613, -6.772696109725129, -6.772696109725129, 2.2876611754119267, 2.2876611754119267, 9.358166412516002, 9.358166412516002, 14.767602594964238, 14.767602594964238, 11.611592259148097, 11.611592259148097, 4.712580102156172, 4.712580102156172, 2.9740187781432823, 2.9740187781432823, 11.627070826929138, 11.627070826929138, 9.198498092624444, 9.198498092624444, 10.303584876026513, 10.303584876026513, 8.60761499105153, 8.60761499105153, 11.993509983605783, 11.993509983605783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3440323314973537, "mean_inference_ms": 2.2642224450618316, "mean_action_processing_ms": 0.09856121938175427, "mean_env_wait_ms": 0.597491705458948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 33750, "timesteps_this_iter": 0, "agent_timesteps_total": 101250, "timers": {"sample_time_ms": 13334.978, "sample_throughput": 253.094, "load_time_ms": 0.501, "load_throughput": 6731229.672, "learn_time_ms": 2228.336, "learn_throughput": 1514.583, "update_time_ms": 27.534}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 59.478908157348634, "policy_loss": -0.004371955948590767, "vf_loss": 59.49587821960449, "vf_explained_var": -0.06131834983825683, "kl": 0.006205701506045669, "entropy": 1.2638374328613282, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 10.88958673477173, "policy_loss": -0.0007519987877458334, "vf_loss": 10.903167486190796, "vf_explained_var": -0.04096091687679291, "kl": 0.004917533467807189, "entropy": 1.3812419414520263, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 33750, "num_agent_steps_sampled": 101250, "num_steps_trained": 33750, "num_agent_steps_trained": 101250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1350, "training_iteration": 10, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-49-49", "timestamp": 1706107789, "time_this_iter_s": 13.24159026145935, "time_total_s": 135.04885864257812, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 135.04885864257812, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.19411764705882, "ram_util_percent": 64.59411764705882, "gpu_util_percent0": 0.061764705882352944, "vram_util_percent0": 0.23077033547794118}}
{"episode_reward_max": 15.969271560137042, "episode_reward_min": -25.53137611490162, "episode_reward_mean": -3.2705513428353594, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.136886599847, "policy_agent_": -5.636937673505394}, "policy_reward_max": {"policy_adversary_": -5.665904342786241, "policy_agent_": 22.49361407711114}, "policy_reward_mean": {"policy_adversary_": -15.87680064564146, "policy_agent_": 6.303124651403049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.891441880008985, 0.15082146508236752, -13.926395690890859, 5.5603632251106045, -7.285026741234239, -9.80889124498663, -4.472411050800873, 1.7510726993548513, -8.15130932328042, -8.267047950493794, -5.090514517584034, -11.07043038863652, -8.743385542946312, 2.478488001807458, -5.383750433244687, -10.155795282744087, 3.079856967551654, -0.9323168992675052, 5.607530716777164, 1.9633809176194512, -4.605563176726966, -15.508220595776201, -2.401167218365609, -0.4281874649480537, 15.969271560137042, -1.3592237568401513, 3.308054952505021, 4.130913759445773, -7.4962841263849675, -13.286734033399162, 0.6443722652870097, 0.6062860997793763, 10.36395120540472, -1.4776979627464724, -0.5780607139286256, 7.556345558744769, 4.488309756381074, 7.836600944870518, 2.3532470609148888, 0.32298343217079584, -8.95733737675728, 1.6104016516384787, 7.063490763994329, -25.53137611490162, -7.192023125872529, -5.2374558709690735, -1.3506490379983447, 0.6802699937347643, -8.897082490185369, -9.46206014063904, -5.0886020187584675, -10.068919932306, 5.6490093565963395, -5.0826902255303175, 5.635863167719495, 2.0850035403250478, -11.336944763488537, -16.810136998723824, 6.87421419459025, -2.191892775227523, -3.354918941490711, 3.447472452834802, -3.7572637738602057, -8.350748346625224, -3.7828539514711927, -10.203389078383118, 1.7380312366727049, -12.976308615113265, -9.623349057555803, -2.096780321598573, -8.32941294335562, 1.8059598849532195, -9.872527256048206, -1.399088237100548, -14.676755774491966, 1.6468785068322631, -5.979860977719464, -2.240993710709882, 10.513152020966519, 0.6609929077595118, -0.8480413925039743, 3.682151049684638, 0.1250748780256199, 4.476157854834053, 5.205720996713961, -2.9006635992354495, -7.826492640999899, 2.199684697406711, 2.9035673608984536, 1.6566214932843755, 4.100328073662398, 2.794735821593516, -7.571343839612942, -8.362826101263925, -1.376430211403903, -7.651610255766965, -19.909027385068576, -2.3895949662194913, -4.983021319670143, -8.78489491145539, -12.00469027802706, -6.7716725523044214, -7.509618919323883, -3.9714860105164256, -9.205056814859455, -10.903987780293255, -9.474599555055637, -7.118882595822457, 1.7459146824540424, 6.4171246781710725, 12.177504683852652, 1.2246054796433201, -1.756881711126166, -7.473167516209155, 3.658832449539541, -5.9480477221380745, -11.628435531950267, -4.303734767236223, -21.85141412270206, 1.1814860399145495, -2.096368940542114, -3.572314012586611, -8.962705171380282, -10.667503072898041, -6.829500279668191, 5.846109505819064, -13.212922839171904, -1.5425120327968296, -6.82956218493435, -0.7729667351399718, -7.172054645735328, -3.138160301495423, -23.022506610601102, 0.6712154758265794, 0.5592366481539176], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.891068524470526, -7.612401845971503, -8.777717838334578, -12.370590315982373, -15.692595232630902, -9.745802764367385, -21.845839803760118, -17.91337394046755, -9.448026707334085, -19.4390731640561, -7.398789004763882, -21.956923443861275, -9.67849128427043, -18.47095900413081, -9.597627963421633, -16.216467483169723, -15.104904223447921, -10.26569303461901, -22.59930307218408, -17.621501116057228, -8.82207885989153, -16.53799740482831, -19.964194327562325, -21.314039309293232, -29.017956594085234, -12.646416106489323, -15.052714543265461, -17.529759604340224, -21.36159919463356, -23.372767913168254, -14.133246522994332, -13.523999295326744, -20.091521573066967, -13.289829903998655, -12.139377240873415, -29.272146028658486, -16.484866106772067, -32.591437373289644, -13.320934821435731, -18.88900512952072, -26.2685401737511, -11.203497598222457, -20.211058499672696, -22.195702345486787, -20.685796993672117, -8.037087142888932, -10.131712596618916, -17.808174842353775, -17.495853060521643, -7.7827198159814115, -7.994939579512666, -22.716932569391247, -26.287004039406476, -7.003456829790466, -19.9538463345109, -19.740716975568656, -18.7660316917594, -11.965152766521683, -27.86201485033894, -23.11625414713902, -15.317301230326533, -19.55674455028499, -9.148962788667454, -10.190592033239845, -6.819813326046899, -15.590330087712763, -21.249681416208162, -17.760690327231075, -20.224823345107914, -9.520318356735311, -10.384069930816358, -15.214411231511416, -8.01338608101419, -13.35291047976422, -15.043642114325106, -13.507699137855646, -11.699984213680178, -14.051151766711964, -23.04491139889742, -18.97805136117782, -14.876961742340034, -22.13339911213478, -15.967712498459907, -28.713934678441444, -20.318646108806636, -7.514442907790212, -8.898137602593529, -20.321471461913887, -22.145839509510125, -13.34767937355984, -9.74424945906666, -18.0420359877417, -5.665904342786241, -22.501784109696203, -11.327278349522782, -16.555285427362175, -23.926482152872875, -6.028849086955186, -8.521924163518857, -10.471783455189625, -10.830048014459916, -14.022981336226994, -13.394456531030226, -20.83903576844256, -5.79282939916047, -12.633814242161911, -14.669667084040718, -15.079403009677728, -25.450819428348215, -27.09488181220314, -20.590504142369454, -11.813493021047124, -13.024820560181585, -15.83661375035039, -14.993929133619051, -13.356416916808362, -23.768827284505615, -11.812400627252137, -22.68398778089975, -11.375839014054241, -5.7777973951189985, -12.839293005600005, -15.992030772892374, -14.859987382497053, -14.802275855932809, -20.250221625159938, -7.900943623971806, -13.676492249308579, -10.138018681373593, -9.93142666507714, -36.136886599847, -17.08207902361547, -11.748631263590315, -10.626324110355865, -21.61810286893374], "policy_policy_agent__reward": [10.891255202239753, 10.891255202239753, 3.8816116555269353, 3.8816116555269353, -2.5743389262781413, -2.5743389262781413, 8.96547677054649, 8.96547677054649, 4.20378424569833, 4.20378424569833, -0.031544240309625216, -0.031544240309625216, 8.686714376479623, 8.686714376479623, 9.8322233199112, 9.8322233199112, 0.6483586920268299, 0.6483586920268299, 5.586012606781157, 5.586012606781157, 1.1541372435899242, 1.1541372435899242, 5.443246527612377, 5.443246527612377, 0.4675528706620622, 0.4675528706620622, 10.474723502969136, 10.474723502969136, 2.1069387650884734, 2.1069387650884734, 3.0303361002128195, 3.0303361002128195, 9.092380595499785, 9.092380595499785, 4.666688067675752, 4.666688067675752, 14.103416894480626, 14.103416894480626, 9.792441016838339, 9.792441016838339, 2.108257841582283, 2.108257841582283, 0.5148884045260547, 0.5148884045260547, 8.781513554598359, 8.781513554598359, 10.442925922172588, 10.442925922172588, 22.49361407711114, 22.49361407711114, 5.6435961748245855, 5.6435961748245855, 9.180384747885244, 9.180384747885244, 10.830336681892998, 10.830336681892998, 6.932657534124298, 6.932657534124298, 5.043016939884549, 5.043016939884549, 7.388809394140671, 7.388809394140671, 7.0651426975530605, 7.0651426975530605, 15.227736389235838, 15.227736389235838, 5.9060659706260905, 5.9060659706260905, 5.780658263472396, 5.780658263472396, 18.414245793701628, 18.414245793701628, 10.486587931576569, 10.486587931576569, 20.21401915908008, 20.21401915908008, 7.83709094117531, 7.83709094117531, 9.605994280845762, 9.605994280845762, 8.655601398496904, 8.655601398496904, 6.406949624930465, 6.406949624930465, 13.637274631833511, 13.637274631833511, -1.6678368847074148, -1.6678368847074148, 6.746886933899796, 6.746886933899796, 1.3998156359599303, 1.3998156359599303, 4.390531779310285, 4.390531779310285, 9.244222418044268, 9.244222418044268, 4.299385285168139, 4.299385285168139, -0.8396701623288179, -0.8396701623288179, 1.4531687803771016, 1.4531687803771016, 6.32400631854262, 6.32400631854262, 15.968006698001405, 15.968006698001405, 0.9603833021300745, 0.9603833021300745, 12.7948547511152, 12.7948547511152, 10.912860257946846, 10.912860257946846, 3.7145434641354296, 3.7145434641354296, -2.4224921161010697, -2.4224921161010697, 17.368114522464595, 17.368114522464595, 10.462180685955746, 10.462180685955746, 5.981191144417911, 5.981191144417911, 11.502108501559894, 11.502108501559894, 2.695849507403625, 2.695849507403625, 0.9199218433073113, 0.9199218433073113, 1.518479687287853, 1.518479687287853, 2.6934705046648246, 2.6934705046648246, 11.49385632644043, 11.49385632644043, 2.3921908560589062, 2.3921908560589062, 5.300737143776055, 5.300737143776055, 3.711769017568369, 3.711769017568369, 1.0273284937303668, 1.0273284937303668, 8.510185558232317, 8.510185558232317, -0.9295705875170084, -0.9295705875170084, 5.976911121331837, 5.976911121331837, 0.18344316991656884, 0.18344316991656884, 7.577288822343958, 7.577288822343958, 2.860061617980359, 2.860061617980359, 5.905079028001042, 5.905079028001042, 16.779031709931967, 16.779031709931967, 9.819522134468665, 9.819522134468665, 7.014460174918029, 7.014460174918029, 12.907775080909712, 12.907775080909712, 8.046393688242762, 8.046393688242762, 16.595046266637745, 16.595046266637745, 12.762183552760298, 12.762183552760298, 2.306889654277381, 2.306889654277381, 0.5358224807968177, 0.5358224807968177, 11.260578079660295, 11.260578079660295, 12.524703435204291, 12.524703435204291, 7.50215043342211, 7.50215043342211, 6.922288766364529, 6.922288766364529, 10.418385904667607, 10.418385904667607, -0.9527197484133524, -0.9527197484133524, 7.069479004216142, 7.069479004216142, 4.975424069059439, 4.975424069059439, 4.451837585797609, 4.451837585797609, 2.0087273839021473, 2.0087273839021473, 1.8196270603678477, 1.8196270603678477, 1.7694514219243573, 1.7694514219243573, 0.8434442718671183, 0.8434442718671183, -0.5873211317835743, -0.5873211317835743, 3.6256543919612834, 3.6256543919612834, 2.942418805853173, 2.942418805853173, 8.433774878963069, 8.433774878963069, -1.706113707849493, -1.706113707849493, 0.8649132309343228, 0.8649132309343228, 2.5975337644925407, 2.5975337644925407, 3.9802602069276345, 3.9802602069276345, 13.598367055401132, 13.598367055401132, 16.756003245187102, 16.756003245187102, 16.384004413111054, 16.384004413111054, 6.519049250345222, 6.519049250345222, 5.6339694245277085, 5.6339694245277085, 4.18172311707062, 4.18172311707062, 9.326380791579293, 9.326380791579293, 3.7041845973351424, 3.7041845973351424, 6.070195876277674, 6.070195876277674, 3.7543329300079553, 3.7543329300079553, 0.41628682909884535, 0.41628682909884535, 6.278662526984395, 6.278662526984395, 1.8407142272884427, 1.8407142272884427, 4.633489496506698, 4.633489496506698, 3.5146628007560454, 3.5146628007560454, 2.096242154799506, 2.096242154799506, 3.9863877881323115, 3.9863877881323115, 13.048165565489501, 13.048165565489501, -2.6559896076000475, -2.6559896076000475, 6.066990108255875, 6.066990108255875, 1.6542282482196218, 1.6542282482196218, 4.579229964968584, 4.579229964968584, 14.482415977055835, 14.482415977055835, 6.9719593610600255, 6.9719593610600255, -5.636937673505394, -5.636937673505394, 5.648769793091222, 5.648769793091222, 11.088669758543828, 11.088669758543828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34267811716909446, "mean_inference_ms": 2.2525936308948253, "mean_action_processing_ms": 0.0982401912506559, "mean_env_wait_ms": 0.5950895182476578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 37125, "timesteps_this_iter": 0, "agent_timesteps_total": 111375, "timers": {"sample_time_ms": 13519.109, "sample_throughput": 249.647, "load_time_ms": 0.402, "load_throughput": 8402051.282, "learn_time_ms": 2226.786, "learn_throughput": 1515.637, "update_time_ms": 28.229}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 48.84252243041992, "policy_loss": -0.009783787280321121, "vf_loss": 48.86476440429688, "vf_explained_var": -0.07735111713409423, "kl": 0.0032898435668939686, "entropy": 1.248088788986206, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.247091674804688, "policy_loss": 0.0022555626928806305, "vf_loss": 10.257614946365356, "vf_explained_var": -0.045551192760467527, "kl": 0.008341180778918445, "entropy": 1.3613013684749604, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 37125, "num_agent_steps_sampled": 111375, "num_steps_trained": 37125, "num_agent_steps_trained": 111375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1485, "training_iteration": 11, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-50-02", "timestamp": 1706107802, "time_this_iter_s": 12.895156860351562, "time_total_s": 147.9440155029297, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FA4AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 147.9440155029297, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.129411764705885, "ram_util_percent": 64.69411764705882, "gpu_util_percent0": 0.15882352941176472, "vram_util_percent0": 0.23446116727941177}}
{"episode_reward_max": 16.776404048095795, "episode_reward_min": -24.336251173922722, "episode_reward_mean": -2.100824685661936, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.756436267299144, "policy_agent_": -7.063582950565812}, "policy_reward_max": {"policy_adversary_": -2.789002027481409, "policy_agent_": 22.338200968406806}, "policy_reward_mean": {"policy_adversary_": -15.06042954349021, "policy_agent_": 6.4798024289141365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.728866935598381, -5.644791080777229, 6.077131101632739, 1.4379071383670836, -3.270338466104905, 10.280671493499803, -9.350704606140319, -24.336251173922722, -5.216840497155243, -10.137418634464066, 5.501875206822102, 3.528019145469061, 4.55489311327281, -0.7426876609369808, -17.49615482946266, 2.8407068081691698, -8.318976237424758, 2.97157489926916, 5.100475897790447, 2.561676843122082, 5.585228090842449, -4.484286445980381, -4.321671297493087, 2.2865176042994793, -1.3710699200239986, -9.678449923744472, 3.0739869157567923, -3.7849140771799874, 7.21185843306514, -10.71255332661494, -3.1125358533290974, -10.760025793358846, -10.17378564532136, 4.211085380060243, -1.2625702713855023, 3.6045142407276396, -6.272074051494205, -0.6041633091319873, 1.1595340424349037, 2.1871378410846374, -1.9300604483654114, 0.3380287824212146, -5.171618885300749, -5.931784981602348, 9.287699149248159, -4.321736876334274, -2.9407445592051547, -2.036487044890655, -8.457226954824748, -11.169648493522399, -1.1200855013715243, -9.162156146635096, 3.4017699624625335, -4.166891489298665, 2.5264727096045054, -4.504407844462823, -5.32712720840788, 6.584231393908247, -4.7189026714977595, 1.0256493178332704, -2.0563062658025926, -5.516223562308532, -8.495831722191193, 3.8518635836960793, -8.384665067588244, -11.340683643532357, 0.24818990806609725, 1.0324721995362114, -0.5658828495223966, 1.6614149223399801, 8.457377278326526, 5.473914548892122, -1.2756835066062981, -3.1616663369026115, 0.7375096886538792, 6.2451691078097795, 1.3687159836789253, 5.824574421290531, -3.4889862029879293, -4.218585194738025, -22.91221040697047, -1.5349233377547786, 3.6607482002101546, -4.37183227864047, -2.755754098695979, 5.34245037356118, -5.414479061891728, 5.212282189872959, 3.392340170696655, 4.084961959829369, -9.707666475437343, -19.385917425334227, -11.58077609345358, -0.21543884179145362, -7.988595619391829, -5.1784103514405, -10.034058555379724, 0.8261259202065538, 5.154736204821924, -12.51770398267992, -8.260769711381478, 7.157126745133916, -7.302250159920792, -1.694651604945347, -1.0317515142599947, 10.97415322669901, 16.776404048095795, -4.755318945041604, -0.5581506173817663, -3.4642689584123536, 0.3607322204006152, -1.3389300907909956, -4.100580129902968, 0.20888932333229207, -0.8278608422499911, -1.0328263852402455, -1.008732674983688, -8.833297646558435, 6.144982841594844, -3.6375394605529197, -3.7300029317953065, -3.6859157784850556, 3.049988306180569, -1.5325827442479776, -2.957230398311658, -16.67727701177246, -4.620633014087187, -8.718159866522726, -15.84973399882337, 0.6026091276453465, 2.4515975151668776, 0.8378152443838701, 2.6736174869836944, 7.098475304339279, -6.4004616174949405], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.989928077799444, -10.502016871099352, -21.523724419462926, -12.960084692260207, -6.569536049485918, -22.474166486450066, -12.526415313849352, -14.424069288007837, -23.429426071845594, -28.756436267299144, -19.66022216041947, -19.775889176733195, -27.255757040039857, -14.942401761988444, -25.451850238275878, -22.954940534140444, -13.256182462902142, -12.845995079431416, -19.35108695398218, -20.18573537737222, -18.172814485802085, -8.49715401788443, -10.571205157007862, -8.312816234576902, -14.759396927288961, -11.58412285226948, -15.579234151976646, -11.37158830190426, -19.21232185004456, -12.048296540903985, -12.827426843399321, -17.880592464012622, -8.319748923524834, -19.219681329066205, -20.076527415384128, -18.3953583729414, -11.668884892229036, -12.657259827724621, -20.619523754609858, -19.778626922825055, -12.672185526209056, -10.10749478601067, -9.828925250716408, -11.04947528430018, -19.887282207124006, -7.470765817305817, -21.037327911816973, -7.302420970443995, -19.909048641345553, -28.54901158158798, -6.215164267834321, -19.983856658591613, -17.989241712527736, -10.428204238184463, -14.42030417287185, -7.284244923140543, -21.800562642987835, -15.677620806368894, -11.276693950179814, -16.275106553333845, -11.094026997231555, -8.36986113428745, -8.03260194570597, -16.470936762906707, -13.303442233871758, -6.953009542164512, -12.045735902204669, -12.223473874635577, -11.787804689165034, -19.497883662660566, -27.25193510577672, -13.485440748938737, -22.33068898639892, -14.761528592993747, -9.798637326668798, -25.921325603387373, -13.293949014677406, -14.667864422484973, -22.58234747074382, -6.939269955305337, -8.785044505838847, -8.823607766785168, -11.109135552192278, -6.897017149752111, -23.239797519546734, -15.208396413776352, -9.920288059861011, -12.812984420521449, -17.34177026118076, -15.172049738786217, -15.126129283958594, -19.293127550439976, -13.22353529428326, -15.517872114289602, -18.965072709785268, -8.101478953198573, -10.055268793042616, -13.75718640304313, -13.353833011309547, -6.868903534073779, -16.044668237733713, -17.415737086546294, -20.802445622262255, -18.536820305433427, -13.92808480880933, -22.35614214916307, -27.899997888717813, -12.51032003625512, -11.708884345245043, -9.64175264320617, -13.435119305917347, -14.827285988493495, -14.710002640616189, -13.140524951232484, -10.26542939361995, -6.9808283679310765, -9.985666694909499, -11.381632640532196, -18.526493668937594, -10.251238328689674, -12.269293204147678, -14.592021786884334, -21.477909925861, -13.04292477798097, -2.789002027481409, -20.79139207587019, -21.403872662012706, -20.996343735144137, -15.367506547042359, -16.951980734298427, -17.313191855286163, -21.624598776420168, -14.594125366554199, -19.16901081395622, -10.488092479008747], "policy_policy_agent__reward": [3.13053057110053, 3.13053057110053, 2.4286128951610615, 2.4286128951610615, 13.80042776054783, 13.80042776054783, 7.198995915313645, 7.198995915313645, 1.6495987916905048, 1.6495987916905048, 16.377418989974938, 16.377418989974938, 1.5878553538545137, 1.5878553538545137, -4.9560909429574505, -4.9560909429574505, 9.106292787345176, 9.106292787345176, 9.309508816417539, 9.309508816417539, 12.581048683620784, 12.581048683620784, 11.651954161101125, 11.651954161101125, 15.90532507665633, 15.90532507665633, 7.0998570505257295, 7.0998570505257295, 3.977847704406612, 3.977847704406612, 12.897823671154809, 12.897823671154809, 2.468603112738691, 2.468603112738691, 7.908784989350289, 7.908784989350289, 12.225781425886312, 12.225781425886312, 11.37370611024715, 11.37370611024715, 11.879021288322267, 11.879021288322267, 2.0064337859520265, 2.0064337859520265, 3.1247669297573863, 3.1247669297573863, 5.29966691943819, 5.29966691943819, 6.69416350363248, 6.69416350363248, 0.952836464262506, 0.952836464262506, 9.326610533866718, 9.326610533866718, 3.793337112362137, 3.793337112362137, 13.212090141554846, 13.212090141554846, 0.6678716071445228, 0.6678716071445228, 4.857445495035112, 4.857445495035112, 3.5602833353268886, 3.5602833353268886, -0.927018360898263, -0.927018360898263, 11.715383354563222, 11.715383354563222, 9.406978571999312, 9.406978571999312, 10.99993630683452, 10.99993630683452, 2.6984054203674166, 2.6984054203674166, 6.026548259296314, 6.026548259296314, 10.88952889852238, 10.88952889852238, 10.982882381954848, 10.982882381954848, 5.371062538921822, 5.371062538921822, 5.222761784215945, 5.222761784215945, 2.3286531827078276, 2.3286531827078276, 2.5588451513489137, 2.5588451513489137, 14.587490678186082, 14.587490678186082, 1.5745144704857728, 1.5745144704857728, 9.04829167630591, 9.04829167630591, 2.632966962776669, 2.632966962776669, 5.725910843260406, 5.725910843260406, 8.689681544032789, 8.689681544032789, 2.547539383231399, 2.547539383231399, 5.410850255978259, 5.410850255978259, 10.695505837495135, 10.695505837495135, 3.130656374442899, 3.130656374442899, 8.473388441238178, 8.473388441238178, 1.3899185393388602, 1.3899185393388602, 8.236717717289975, 8.236717717289975, 11.13092610013857, 11.13092610013857, 3.278895639341026, 3.278895639341026, 8.650377935583558, 8.650377935583558, 4.518860365714482, 4.518860365714482, 1.4268187859894597, 1.4268187859894597, -0.23161488824261145, -0.23161488824261145, 10.16140017330139, 10.16140017330139, 2.4593885831417563, 2.4593885831417563, -2.1938370506839204, -2.1938370506839204, 6.146962905135382, 6.146962905135382, 6.627973037085892, 6.627973037085892, 5.610960919821317, 5.610960919821317, 10.579649292500273, 10.579649292500273, 17.85465619205163, 17.85465619205163, 9.479677648915429, 9.479677648915429, 10.527502739896308, 10.527502739896308, 5.79993112804557, 5.79993112804557, 5.268073507661339, 5.268073507661339, 16.083247355598576, 16.083247355598576, 7.331332499178167, 7.331332499178167, 10.246219421887751, 10.246219421887751, 9.546680633877946, 9.546680633877946, 1.3603423802836567, 1.3603423802836567, -7.063582950565812, -7.063582950565812, 3.644342214515195, 3.644342214515195, 7.384941876201217, 7.384941876201217, 1.262592435555818, 1.262592435555818, 10.242021710425377, 10.242021710425377, 10.275423393668763, 10.275423393668763, 2.252904498984639, 2.252904498984639, 9.012633305197204, 9.012633305197204, 10.367055215938704, 10.367055215938704, 9.62850584930779, 9.62850584930779, 2.7092314042606236, 2.7092314042606236, -0.04639493744713763, -0.04639493744713763, 0.8213796004148386, 0.8213796004148386, 7.651216636249073, 7.651216636249073, 5.488238545196722, 5.488238545196722, 1.461534300879037, 1.461534300879037, 0.010605118831443161, 0.010605118831443161, 7.291656161624841, 7.291656161624841, 9.254284608065738, 9.254284608065738, -2.8244002243030684, -2.8244002243030684, 3.891949263176115, 3.891949263176115, 12.286431915840106, 12.286431915840106, 6.750097731170731, 6.750097731170731, 8.421084350244039, 8.421084350244039, 6.448166647274668, 6.448166647274668, 16.665147687931036, 16.665147687931036, 22.338200968406806, 22.338200968406806, 3.877500545606758, 3.877500545606758, 5.575366863931638, 5.575366863931638, 3.088741842396909, 3.088741842396909, 6.897925763158979, 6.897925763158979, 6.744177948851249, 6.744177948851249, 5.304711255356611, 5.304711255356611, 6.674707137282386, 6.674707137282386, 4.718784275684981, 4.718784275684981, 2.9740009913454157, 2.9740009913454157, 4.488467009962906, 4.488467009962906, 1.2741674969868828, 1.2741674969868828, 12.33573825526622, 12.33573825526622, 3.3068494340683765, 3.3068494340683765, 4.269645136176184, 4.269645136176184, 5.45305300419964, 5.45305300419964, 12.263949116020784, 12.263949116020784, 5.7551710168664965, 5.7551710168664965, -0.08411418541512461, -0.08411418541512461, 2.057057532048863, 2.057057532048863, 8.391619823962763, 8.391619823962763, 6.1390919343107075, 6.1390919343107075, -0.24111372589050986, -0.24111372589050986, 8.777294930971888, 8.777294930971888, 9.882394685226517, 9.882394685226517, 11.231207010402018, 11.231207010402018, 8.633871426768943, 8.633871426768943, 13.13374305914775, 13.13374305914775, 2.0438154307569025, 2.0438154307569025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3427129146238143, "mean_inference_ms": 2.254934676289309, "mean_action_processing_ms": 0.09828848740987968, "mean_env_wait_ms": 0.5947829805438323, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 40500, "timesteps_this_iter": 0, "agent_timesteps_total": 121500, "timers": {"sample_time_ms": 13578.664, "sample_throughput": 248.552, "load_time_ms": 0.501, "load_throughput": 6731229.672, "learn_time_ms": 2200.281, "learn_throughput": 1533.895, "update_time_ms": 28.526}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 37.37523422241211, "policy_loss": -0.0076522924937307835, "vf_loss": 37.39502487182617, "vf_explained_var": -0.1634972095489502, "kl": 0.0038866294095056945, "entropy": 1.2151961088180543, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 9.248290395736694, "policy_loss": -0.009822508040815591, "vf_loss": 9.270914363861085, "vf_explained_var": -0.05677860379219055, "kl": 0.006306764799364956, "entropy": 1.343220043182373, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40500, "num_agent_steps_sampled": 121500, "num_steps_trained": 40500, "num_agent_steps_trained": 121500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1620, "training_iteration": 12, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-50-15", "timestamp": 1706107815, "time_this_iter_s": 13.391392946243286, "time_total_s": 161.33540844917297, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 161.33540844917297, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.805882352941175, "ram_util_percent": 64.0764705882353, "gpu_util_percent0": 0.10941176470588238, "vram_util_percent0": 0.23753446691176472}}
{"episode_reward_max": 17.003810709507857, "episode_reward_min": -22.371089314697798, "episode_reward_mean": -1.7846658191160654, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.353311613050003, "policy_agent_": -2.8723293535279657}, "policy_reward_max": {"policy_adversary_": -4.227654713133788, "policy_agent_": 21.546562513671912}, "policy_reward_mean": {"policy_adversary_": -13.976371944594463, "policy_agent_": 6.0958530627392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.73981341429382, -2.278948164524589, 4.397665562047917, 3.200029212357041, -1.988542553169368, 8.0666766582091, -5.12617956140204, -6.918927938998345, -1.6218592948060175, -0.20725187073661377, 3.7494536523777713, 8.262048350719535, 0.541246377132541, -8.490941063288608, -14.717393607846596, 1.893889228813399, -13.489291825180894, 8.819034317138332, -2.3527127648860313, -4.816874531757126, -15.172639767012292, 0.7900012530930615, 4.534666678861252, 4.344643473768347, -9.739426857693582, -0.0467679719355556, 0.048027865089213695, 4.52742572201079, 2.699829672891282, -3.4590846159440356, -5.763801603887933, -0.7959136726119181, 17.003810709507857, 1.3242263874678801, -7.107745760063404, -1.0678423494121736, -1.8443765028276606, 2.49843632089878, 5.838235966724998, -2.877489936115886, -11.12767429808717, -1.8339924575423199, 2.5371391847395603, 5.817023986249655, -6.669272516667505, -0.9544746510531827, -3.7922225366380165, -10.036127866921719, 2.653000089605358, -6.4937174255999155, -13.350556806450339, 9.249802112019504, 2.2079564271081966, -10.936176048624617, -8.751104131133554, -3.250478003555895, -0.6760409550519402, -5.603844651573344, 3.890613588656616, 14.998391813962707, -2.7826493791853886, 0.29569005027249895, 2.9183562283720494, -6.312454769756498, -10.960114321486985, 0.15932314320867585, 1.0840064142386747, 4.640724183595567, -9.132074452428661, 3.904098164216985, -6.9455878940690505, -1.9223053843285518, -9.205495976450178, 1.6839336443973374, -3.12931686805338, 1.0287628474719686, -0.10282272749503574, -1.3146805157258625, 5.121204200565273, -5.839298019027344, -0.6532207479882091, -5.754711785594348, -1.309404728534707, -0.9192085768531224, 1.5078045289299746, -1.1971321845024363, -5.144881817121984, -6.004126401839194, -1.6247951718796114, 2.5998097671689, 4.275515494259758, -7.145665657282967, -0.4194863444774226, -3.4674274371417892, -4.39964470047249, -3.1872623279672516, -0.15984581442696322, -1.819008784562015, 2.9756432055026956, 11.704908472327975, -0.8704199211920232, -11.086557871689788, -0.07814755794436817, -3.881749914587007, 4.606899895440086, -0.7112551689916962, -22.371089314697798, -0.3369215090467341, -0.22289519002939906, -6.055490043205073, 4.439791675884921, -5.028042404975186, -0.06424904185518132, -9.89197304188752, -11.982288533035867, -11.550921034063892, 0.9457080327081901, -0.9073614311993325, -4.934864191258458, -2.704491435942045, 3.309696841622721, 4.584916022114279, -0.9621136893255805, 0.6732966835326493, -8.847369296300291, -3.9494791438141523, -10.210296158498032, -2.2054126824648717, -8.965333989839387, -10.64297917766677, -3.04402835235798, 0.9058350420656667, -10.188544656820305, 8.597697904396304, -4.620003944366139], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-29.353311613050003, -27.985635641526653, -14.207058568516723, -12.659440165124492, -6.701404049926055, -15.811393234176645, -9.700246546974245, -9.20097545990966, -17.11422692203807, -22.49458736687608, -13.126374413127712, -21.95286702206964, -8.836807239000466, -14.664222037725255, -18.237443613703512, -10.419145351994553, -17.167049130402734, -14.638216945429432, -12.375404629494376, -9.113621047755197, -18.59977029301707, -17.052447890113072, -16.090259774407766, -17.87267598415252, -14.0438632385088, -19.542808293613984, -11.01455974366647, -20.987966226566193, -10.401765531575649, -14.333830891048585, -13.904695053397026, -17.9513970902061, -23.771999251044864, -12.525775238199325, -21.93662919542795, -6.372333647820357, -12.3262847299063, -17.924152716794076, -15.133480946440795, -11.72258135080951, -8.191736020625918, -11.505056537595955, -15.841530411576318, -14.204286469204964, -10.454404626201095, -12.246263566387414, -16.190233702889696, -16.26714964522215, -11.745037962590665, -6.077873506872869, -14.040564725580133, -15.947424559812273, -13.776694503369749, -8.014604618937932, -9.489611279384372, -9.344959284432656, -24.538904930877344, -11.764613099467244, -10.937053945203395, -25.41665844961309, -13.665738877160406, -7.897966184430381, -20.242646675141025, -9.524776774776116, -5.215455614431052, -8.729674637464317, -6.715938688727239, -16.395999823124917, -11.300443089316513, -16.877195246951857, -16.88112364863346, -12.55247921955631, -8.454280214985513, -13.838128172929443, -14.664509844720767, -10.607325732026405, -13.718132761048867, -20.447707178533115, -14.149491669691653, -6.923223738732502, -10.748611908362106, -4.227654713133788, -11.591260358386682, -13.00971669231798, -14.635588388193597, -24.328250891771553, -5.024788497121731, -6.1903305556913635, -7.162102704207733, -13.324052310196786, -21.3562331076024, -7.083999749959391, -9.517264936331516, -10.284350171617076, -10.642287165805298, -11.168185487288936, -14.231912347873928, -7.852440410907073, -20.52050105191183, -20.029089051655067, -8.976780635295809, -11.988813912839806, -9.692455902767007, -12.038435883038343, -12.216674298362463, -15.91649654103155, -20.19357767069291, -7.261653166767255, -25.20473049733042, -8.274994185514384, -22.080768324334617, -8.366871931971122, -16.583978865841964, -18.146615534201644, -15.499539875347432, -15.198906917095288, -12.191587752783432, -15.971686223130446, -7.074575130974794, -14.70348991884365, -21.239952049110375, -26.089752033698517, -26.39992661388673, -15.992273589977142, -7.945118363344627, -7.074830053362985, -12.442388475220277, -12.860767391922982, -19.68213409270631, -11.219533155406701, -7.364884061413295, -20.173323053247792, -5.643417876932119, -18.605508428362988, -19.499541889394717], "policy_policy_agent__reward": [21.546562513671912, 21.546562513671912, 12.853343738501035, 12.853343738501035, 9.302362065282322, 9.302362065282322, 7.929734688740768, 7.929734688740768, 2.3564307483783438, 2.3564307483783438, 11.939034946192875, 11.939034946192875, 2.2870334927861027, 2.2870334927861027, 1.1410237604556581, 1.1410237604556581, 7.746183813616028, 7.746183813616028, 11.143667748069731, 11.143667748069731, 8.43791403275274, 8.43791403275274, 15.107457686394582, 15.107457686394582, 4.689026808066501, 4.689026808066501, 3.086640487218323, 3.086640487218323, 1.760025002928461, 1.760025002928461, 6.156517290403976, 6.156517290403976, 1.8388786526109124, 1.8388786526109124, 11.728625631283885, 11.728625631283885, 5.011345932304169, 5.011345932304169, 2.148373257999035, 2.148373257999035, 1.7135652630023905, 1.7135652630023905, 8.921224571603066, 8.921224571603066, 10.312463226634508, 10.312463226634508, 11.108659728960431, 11.108659728960431, 2.1522181904076074, 2.1522181904076074, 9.748020160839218, 9.748020160839218, 5.531293804377843, 5.531293804377843, 12.757695974288492, 12.757695974288492, 6.550797602233463, 6.550797602233463, 5.437373137552277, 5.437373137552277, 4.0704467247545475, 4.0704467247545475, 8.577741708797094, 8.577741708797094, 20.387904980276357, 20.387904980276357, 6.925000812833602, 6.925000812833602, 7.414441717682279, 7.414441717682279, 2.6522456492040916, 2.6522456492040916, 5.240954113539319, 5.240954113539319, 10.211294518846428, 10.211294518846428, 10.4858584565829, 10.4858584565829, 4.422545707346813, 4.422545707346813, -1.4679691387306273, -1.4679691387306273, 4.835532040026817, 4.835532040026817, 9.189334798157939, 9.189334798157939, 10.010655227727305, 10.010655227727305, 1.892566054766794, 1.892566054766794, 5.645894457667117, 5.645894457667117, 6.199005583125839, 6.199005583125839, 3.1155108891502112, 3.1155108891502112, 7.1990190260980125, 7.1990190260980125, -0.20792195936352198, -0.20792195936352198, 0.34500395956489593, 0.34500395956489593, 12.59861333591589, 12.59861333591589, 7.992325465238974, 7.992325465238974, -1.4607857148433439, -1.4607857148433439, 0.3692535741254076, 0.3692535741254076, 3.047240640438379, 3.047240640438379, 11.931431987912699, 11.931431987912699, 3.0803842239469503, 3.0803842239469503, 7.413833766930005, 7.413833766930005, 20.207525131787904, 20.207525131787904, 5.44154474898751, 5.44154474898751, 4.09682811735144, 4.09682811735144, 11.58050145175654, 11.58050145175654, 1.6061610025098092, 1.6061610025098092, -2.8723293535279657, -2.8723293535279657, 4.444498890336497, 4.444498890336497, 3.899972551482957, 3.899972551482957, 10.518362003360245, 10.518362003360245, 1.08418431844393, 1.08418431844393, 10.390646705584423, 10.390646705584423, 4.9677678772822, 4.9677678772822, 5.315086917613878, 5.315086917613878, -0.37560788073232965, -0.37560788073232965, 7.76103090866339, 7.76103090866339, 5.767596488333692, 5.767596488333692, 5.818044289749188, 5.818044289749188, 6.807655016776914, 6.807655016776914, 9.566513331403629, 9.566513331403629, 9.635347935128461, 9.635347935128461, 0.5419628598525779, 0.5419628598525779, 5.047695580186949, 5.047695580186949, -0.7635285362302785, -0.7635285362302785, 5.1409278149259885, 5.1409278149259885, 6.0452540577324285, 6.0452540577324285, 8.071696458561783, 8.071696458561783, 11.565559353634558, 11.565559353634558, -0.0600466600001264, -0.0600466600001264, 0.09310207692608452, 0.09310207692608452, 2.7686537661640607, 2.7686537661640607, 7.961931038682842, 7.961931038682842, 12.81587430093108, 12.81587430093108, -0.030832953661786275, -0.030832953661786275, 4.548889295927048, 4.548889295927048, 3.4084613672376425, 3.4084613672376425, 3.121321232666405, 3.121321232666405, 3.9904615796608427, 3.9904615796608427, 7.03603326672348, 7.03603326672348, 3.0167158131725302, 3.0167158131725302, 11.74807212870726, 11.74807212870726, 15.866998761991518, 15.866998761991518, 4.053180357051892, 4.053180357051892, 0.45112802057501067, 0.45112802057501067, 4.80715417241132, 4.80715417241132, 4.078342984225668, 4.078342984225668, 8.411787096901273, 8.411787096901273, 7.602620686019924, 7.602620686019924, -1.0887558220024482, -1.0887558220024482, 3.4623658288602597, 3.4623658288602597, 12.490917653650511, 12.490917653650511, 1.1097520711546558, 1.1097520711546558, 13.26028000010977, 13.26028000010977, 1.6694147634979668, 1.6694147634979668, 8.259864911993391, 8.259864911993391, 4.127321246157068, 4.127321246157068, 1.7586256711557793, 1.7586256711557793, 1.8239929415157, 1.8239929415157, 6.568647892745811, 6.568647892745811, 7.532162395965556, 7.532162395965556, 1.0698554698581677, 1.0698554698581677, 5.999499241450804, 5.999499241450804, 12.274824445366544, 12.274824445366544, 15.3373340279064, 15.3373340279064, 12.71890646228058, 12.71890646228058, 8.332785136754891, 8.332785136754891, -0.45112546647783075, -0.45112546647783075, 1.5626754547744157, 1.5626754547744157, 1.1160461583611225, 1.1160461583611225, 5.3276773547290555, 5.3276773547290555, 5.358400051433459, 5.358400051433459, 0.28827698886996633, 0.28827698886996633, 2.1604278545276583, 2.1604278545276583, 10.539579047656732, 10.539579047656732, -2.2725633899440956, -2.2725633899440956, 13.601603166379649, 13.601603166379649, 7.4397689725142895, 7.4397689725142895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34151261120765697, "mean_inference_ms": 2.2411886196868402, "mean_action_processing_ms": 0.09784601997540301, "mean_env_wait_ms": 0.5913080170339073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 43875, "timesteps_this_iter": 0, "agent_timesteps_total": 131625, "timers": {"sample_time_ms": 13525.843, "sample_throughput": 249.522, "load_time_ms": 0.601, "load_throughput": 5614252.399, "learn_time_ms": 2176.376, "learn_throughput": 1550.743, "update_time_ms": 28.725}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 27.293520355224608, "policy_loss": -0.006926192936953157, "vf_loss": 27.312052536010743, "vf_explained_var": -0.17989590167999267, "kl": 0.007472442165160065, "entropy": 1.161764144897461, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 8.9735267162323, "policy_loss": -0.00880729928612709, "vf_loss": 8.994890475273133, "vf_explained_var": -0.058323347568511964, "kl": 0.006618705398965247, "entropy": 1.3218636691570282, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 43875, "num_agent_steps_sampled": 131625, "num_steps_trained": 43875, "num_agent_steps_trained": 131625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1755, "training_iteration": 13, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-50-28", "timestamp": 1706107828, "time_this_iter_s": 12.430112838745117, "time_total_s": 173.7655212879181, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E046D3A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 173.7655212879181, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.28125, "ram_util_percent": 63.7125, "gpu_util_percent0": 0.049375, "vram_util_percent0": 0.219512939453125}}
{"episode_reward_max": 16.246245464762893, "episode_reward_min": -26.00935782638547, "episode_reward_mean": -1.7254738011935833, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.848755127617856, "policy_agent_": -3.938938055185063}, "policy_reward_max": {"policy_adversary_": -3.2820901865960934, "policy_agent_": 20.68597261922107}, "policy_reward_mean": {"policy_adversary_": -15.05135572098475, "policy_agent_": 6.662940959895582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6794182950778684, 12.202919438088896, 8.07699327030855, -0.6333278771365571, 5.197516383818735, -1.1328157333035598, -6.3534020230296235, -1.0696346530757148, -8.56225999581998, -10.430140855988792, -26.00935782638547, -0.7674554957782452, -14.47443334127304, -1.0648160269859548, -7.656792568903002, -5.841955351169313, -3.556333851771031, 1.9032144324900786, 4.401923770053141, -5.9671082423824755, -6.544331131313996, -1.0256828793760708, -9.524108290050311, -1.1331719967317908, 5.73324297451279, 0.4549895927884421, 0.24238075636147594, -4.471188168125072, -5.4508902133077415, 0.2667999422015558, 2.577356796134864, -19.4247070835643, -1.734386130440721, -11.609133565579208, 2.927123402307136, -3.379567481462924, -5.154798152482246, -2.417480023603265, -4.387211496873025, 7.521147172246478, 0.8399533344441279, -15.296262246378113, -7.299155669351926, 1.5481749729367378, -14.258679733574356, 3.027062201364386, 0.6757395270773913, 5.659214708251935, 5.908387777722561, -2.7323699663456797, -11.2563045036768, -3.744833834047978, 5.595504954435252, -5.501653805288272, -0.4226856746677401, -10.140329824699487, -10.306159024817893, -10.444308901871477, 0.8915207623951463, -3.264050646776888, -2.1984564397198527, -0.5052121793034205, 2.209547088044986, -6.463273870518211, -2.8920089976229093, 3.9592174104735816, -3.2381813960093613, 3.238910062834983, 0.6745414548697416, 1.1282172663053722, 6.7040249501086056, -4.955055768061756, -0.0509716903387869, -4.212540118498767, -6.648482261326895, 5.021625064798097, 10.983181930505484, 10.974636233177305, 5.384084601907998, -1.0219377928807003, -0.5622407658109777, -2.1764112494338423, -0.6434222309361385, 2.8383252575379947, 7.838825898055921, 3.8780226685987547, -16.177745640291256, 2.8818689490962566, 5.826432192307128, -1.6820894469446155, 1.427112350339351, 0.007520795766450705, 12.841344272437452, -4.680638964822222, -13.323400657051279, -9.097255548709056, -9.685522536483123, -8.916050890285595, 8.246061132025265, -5.736770041316707, 9.21127161141289, 3.9926527882112453, -0.19858400257256092, -8.399626192028155, 16.246245464762893, -7.4177048468198015, 2.320680711040502, 9.121106632248134, -3.936642287190036, 1.007510786859724, -8.387009570839897, 0.24696084614657, -9.78301292714621, -10.646809199197335, 0.08132303329703527, -10.210401720592664, -12.316926923901809, -5.8686924709364545, -3.8357645875145563, -0.1282144644575623, 1.136009669639691, 8.668011958539234, -9.712832253728916, 3.137699734165282, 8.141982271731983, 7.22267707655693, -5.102338820125538, 15.150091454360572, -5.2048576130224395, -1.9013987978315519, -1.497722396713507, -1.4811100158556485, -15.98234523047853, 4.665256330141127, -0.0007438895713811067], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-21.920021826373556, -23.65787740005534, -18.44179278253269, -19.930475862931104, -21.820962197182173, -11.814946789196757, -10.074400884064238, -17.925155213097813, -17.988184939668162, -9.371853483959033, -18.13148171601535, -8.11016764949807, -17.09562628688136, -12.53951665894163, -17.21275041804337, -15.396967680209931, -14.536449885305137, -19.675208247466045, -13.631067782536089, -10.696952706850826, -18.090517702323616, -11.166253744795256, -7.576472487134527, -16.170257846783077, -16.26440634024857, -17.198377175415214, -14.481517931428828, -11.16630351248403, -6.730957136743373, -12.61682792382464, -11.022201735072132, -19.12949228478902, -9.011095758184362, -13.14620838742344, -21.44638229681698, -8.365965987348856, -11.695143221115453, -8.322412339343327, -3.2820901865960934, -23.757855518858296, -7.620917082628716, -13.808877795271407, -8.113457374309315, -10.789197498516254, -19.643522289088864, -17.293776419661434, -12.574598391470845, -17.39493669416473, -14.068946852681774, -17.382928136244022, -24.282120356453056, -20.547403013244853, -29.848755127617856, -9.96775736233341, -7.606323923450534, -14.849848143940365, -8.854498065229528, -8.034578724507238, -14.32548043608907, -8.34696414747503, -8.75846689456377, -12.745895970402483, -19.732250410193924, -15.234671465814385, -25.286398967166306, -13.148361987122396, -8.662186577961872, -19.77628591297942, -18.69462560369216, -18.763802859749102, -20.90086366929331, -7.919516275681111, -10.968127088594397, -15.072125084422964, -18.506135299048236, -22.147806564994205, -23.382837860846625, -20.82809561088482, -18.924994969206075, -21.54984728297868, -5.032204247791613, -9.49989844941524, -12.101124136892796, -23.766795303462185, -18.36679266069415, -19.625186627220742, -11.205140416564223, -16.360814672067075, -16.687019292356478, -13.36780878101912, -12.293419435239281, -9.490811966748936, -27.525473338454457, -9.261305505269624, -8.823860651596277, -10.0055198469395, -6.6874786099544705, -12.495704192452836, -18.667607542004678, -16.8836024584285, -22.88186331115773, -17.76574315531526, -13.751121337261328, -14.293770771812923, -25.125699773679237, -19.949969485829914, -14.621760564930629, -15.224829520736023, -9.08183156578193, -16.014960155234235, -11.536309153514946, -21.93533882212086, -19.505601354457845, -10.167531995409279, -10.807305143859498, -12.249030469755835, -6.801775929328761, -9.56328811405271, -8.684413945002348, -22.767830592754045, -24.01974508613076, -23.94397869175457, -10.785257531360998, -18.62446971281686, -23.88462621597623, -18.23830498626645, -13.97003435466791, -26.130981659499362, -13.343151173493242, -8.83522489200041, -6.681313784196231, -13.393413351756134, -16.932781921314643, -11.829345869607621, -13.472065688019942], "policy_policy_agent__reward": [9.120301765647847, 9.120301765647847, 17.930398419072116, 17.930398419072116, 13.25939302642062, 13.25939302642062, 9.648573992897273, 9.648573992897273, 13.509239290500455, 13.509239290500455, 5.341065527946597, 5.341065527946597, 1.8604994305173073, 1.8604994305173073, 8.427760280011048, 8.427760280011048, 4.71296247192409, 4.71296247192409, -0.5291436860148796, -0.5291436860148796, -3.938938055185063, -3.938938055185063, 3.6713560768599125, 3.6713560768599125, 1.310596472804162, 1.310596472804162, 5.737350315977835, 5.737350315977835, 4.777978924570185, 4.777978924570185, 4.777506164520307, 4.777506164520307, 5.490058016767054, 5.490058016767054, 10.789211339978063, 10.789211339978063, 9.016495776294617, 9.016495776294617, 2.3649222322341745, 2.3649222322341745, 5.773093285504809, 5.773093285504809, 5.070285432709592, 5.070285432709592, -0.9738179014578924, -0.9738179014578924, 7.518542925025641, 7.518542925025641, 10.99882465738068, 10.99882465738068, 8.826683384101829, 8.826683384101829, 7.361949343895152, 7.361949343895152, 3.34755767217948, 3.34755767217948, 0.6400334617178179, 0.6400334617178179, 6.441813933013097, 6.441813933013097, 6.799779265603497, 6.799779265603497, -0.14760739938764172, -0.14760739938764172, 3.6383548138718194, 3.6383548138718194, 0.7685374109221121, 0.7685374109221121, 12.186752849562062, 12.186752849562062, 2.4931992529429663, 2.4931992529429663, 3.2701725343166075, 3.2701725343166075, 2.9524661578700298, 2.9524661578700298, -0.5525606551384681, -0.5525606551384681, 15.639501345552386, 15.639501345552386, 4.230435208536423, 4.230435208536423, -0.743692225553354, -0.743692225553354, 0.4071508524786951, 0.4071508524786951, 6.168686235726496, 6.168686235726496, 2.692421277757257, 2.692421277757257, 10.160419310512914, 10.160419310512914, 6.6251689592741165, 6.6251689592741165, 11.527075701208338, 11.527075701208338, 9.988667315202171, 9.988667315202171, 7.325279084949171, 7.325279084949171, 6.512907926388135, 6.512907926388135, 8.401284589598438, 8.401284589598438, 17.72213004102655, 17.72213004102655, 2.2330517785225696, 2.2330517785225696, 3.591819124391397, 3.591819124391397, 2.35475915962044, 2.35475915962044, -0.7258304797941789, -0.7258304797941789, -1.2048650886821213, -1.2048650886821213, 7.608500599242109, 7.608500599242109, 2.541456750349072, 2.541456750349072, 3.2800052274219587, 3.2800052274219587, 6.12034189554953, 6.12034189554953, 10.970898749119456, 10.970898749119456, 4.385698797648087, 4.385698797648087, 11.1971949847717, 11.1971949847717, 8.553789698797985, 8.553789698797985, 2.712002590976255, 2.712002590976255, 11.507597987907205, 11.507597987907205, 9.68458352928095, 9.68458352928095, 9.946010063027236, 9.946010063027236, 13.802444309700963, 13.802444309700963, 1.4822302538096754, 1.4822302538096754, 5.458577699127805, 5.458577699127805, 5.4297924829621005, 5.4297924829621005, 5.928826518860669, 5.928826518860669, 13.584715814896152, 13.584715814896152, 17.183009895676054, 17.183009895676054, 15.901365922031067, 15.901365922031067, 12.154539785557036, 12.154539785557036, 10.263954745048988, 10.263954745048988, 2.2349817409903183, 2.2349817409903183, 3.6617435999906993, 3.6617435999906993, 5.7288509529783305, 5.7288509529783305, 13.302560280500087, 13.302560280500087, 13.102809279375036, 13.102809279375036, 11.75160464790975, 11.75160464790975, -2.486302611863512, -2.486302611863512, 9.621341810581669, 9.621341810581669, 11.256725742331803, 11.256725742331803, 5.842859667037253, 5.842859667037253, 6.860265892789316, 6.860265892789316, 4.749166381257692, 4.749166381257692, 20.183408805445957, 20.183408805445957, 2.290333270223701, 2.290333270223701, -2.2497700027275016, -2.2497700027275016, 0.45413214911522054, 0.45413214911522054, -1.499021963264326, -1.499021963264326, 1.7898266510836192, 1.7898266510836192, 13.456834337014968, 13.456834337014968, 5.573416208555897, 5.573416208555897, 16.04656746128531, 16.04656746128531, 10.879197971763254, 10.879197971763254, 6.776268667344384, 6.776268667344384, 2.9470722898923842, 2.9470722898923842, 20.68597261922107, 20.68597261922107, 6.266132319505057, 6.266132319505057, 8.471220637985564, 8.471220637985564, 12.172968076492078, 12.172968076492078, 2.572594639295948, 2.572594639295948, 8.511235471046978, 8.511235471046978, 1.5746497913375241, 1.5746497913375241, 11.091149834133715, 11.091149834133715, 4.8612942136558175, 4.8612942136558175, -0.23963860189402975, -0.23963860189402975, 5.4443140885782695, 5.4443140885782695, 1.0193143745815827, 1.0193143745815827, -2.757575497286524, -2.757575497286524, 1.8472978215581268, 1.8472978215581268, 2.4243246787438952, 2.4243246787438952, 11.319808064148239, 11.319808064148239, 12.577877377885224, 12.577877377885224, 16.305995325146903, 16.305995325146903, 0.5362126388160381, 0.5362126388160381, 10.881084723491071, 10.881084723491071, 16.01330424385411, 16.01330424385411, 12.730491031411688, 12.730491031411688, 4.4338477672711845, 4.4338477672711845, 20.64053655692997, 20.64053655692997, 4.0691467802354, 4.0691467802354, 3.4669130470844296, 3.4669130470844296, 2.5917956937413624, 2.5917956937413624, 5.956151667950241, 5.956151667950241, 0.4752183454180653, 0.4752183454180653, 8.247301099874376, 8.247301099874376, 6.735660899224281, 6.735660899224281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400938139436217, "mean_inference_ms": 2.2347229651433738, "mean_action_processing_ms": 0.0980055441406679, "mean_env_wait_ms": 0.5886845709863419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 47250, "timesteps_this_iter": 0, "agent_timesteps_total": 141750, "timers": {"sample_time_ms": 13319.322, "sample_throughput": 253.391, "load_time_ms": 0.601, "load_throughput": 5614252.399, "learn_time_ms": 2165.5, "learn_throughput": 1558.531, "update_time_ms": 29.021}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 29.72017879486084, "policy_loss": 0.008085663500241935, "vf_loss": 29.723532104492186, "vf_explained_var": -0.15520877838134767, "kl": 0.003940577021281311, "entropy": 1.1446263670921326, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.793850946426392, "policy_loss": -0.025944189820438623, "vf_loss": 10.831598854064941, "vf_explained_var": -0.062145522236824034, "kl": 0.006708607234449482, "entropy": 1.2474535882472992, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 47250, "num_agent_steps_sampled": 141750, "num_steps_trained": 47250, "num_agent_steps_trained": 141750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1890, "training_iteration": 14, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-50-41", "timestamp": 1706107841, "time_this_iter_s": 12.897549152374268, "time_total_s": 186.66307044029236, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A738310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 186.66307044029236, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.81875, "ram_util_percent": 63.887499999999996, "gpu_util_percent0": 0.05437500000000001, "vram_util_percent0": 0.2213592529296875}}
{"episode_reward_max": 10.427576804410409, "episode_reward_min": -25.582236471022103, "episode_reward_mean": -1.741702976115385, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.228228762693202, "policy_agent_": -8.59477519101397}, "policy_reward_max": {"policy_adversary_": -4.31553956122179, "policy_agent_": 16.940416952999183}, "policy_reward_mean": {"policy_adversary_": -13.72212835430767, "policy_agent_": 5.990212689096144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.55478845319708, -1.747376836132415, 0.8226362694855931, 3.0455388798864895, -5.775721667775117, -6.616327803569007, 1.5732445698827675, 4.993756299910412, -7.236817032632715, 1.684239069139657, 0.20994342630474921, -5.6969382582732715, -1.6822192790831432, -0.2543434625220432, -7.567388491308514, 1.9048028862369626, -11.557104186303315, -2.564317607736082, 1.331227068790186, -9.524334352252922, 10.296827235605749, 7.1071246083403254, -0.03322068377044929, -8.707019011798817, -0.8986781394674883, 6.7715419435877795, 5.812778169005033, -3.9497143256682867, 1.9194440686745198, -2.8651000584306345, -0.8966105797439443, -2.0321995612678343, 6.424593775147043, -5.7764596445670975, -2.870147863035916, -5.415911945442829, 0.5318195484544836, -9.921084383062825, -4.459846805852076, 1.1448596076796709, 0.37145667395215276, -6.112485214299768, -3.142197982067359, -4.225097030694835, -10.571947476151479, -3.2248912381681563, -0.94339656993565, -0.6787289279775242, 0.8015357422726654, 0.6379288500790068, -2.155532058755905, -3.2608488548660644, -1.7852481122132047, -5.564750774463214, -3.7216220058627494, -2.127095686919403, 10.427576804410409, 2.2905503911871468, -7.30599935221567, -6.695657940724178, -0.2632972846074597, 2.735402148783914, 1.1298954173291855, 8.616752197237892, 7.222323757790948, -3.1930256143568956, -7.855725322988491, 0.02050562664706268, -11.777787218975439, 0.5691176113952812, -2.1171536352816, -5.577124710693052, 0.0023149039008650285, -9.415768741750194, -2.4094993466573795, 0.29770877731651363, 1.6308364091079577, 8.372335350953314, -1.5122921311050779, -16.617993424889967, 1.0908596025951116, 3.661462240097758, -14.020549149674224, -6.305559705969131, -17.111341321621648, 0.5940953293692512, 8.488184653860525, -1.052562261262163, -2.4577194048564883, 3.074821295022796, 8.613616464158618, -1.042069735781244, -13.545461329624613, 8.427281711171961, 0.741457387783439, -1.7972358975272278, 0.8996777575575765, -2.557712990472033, -7.421608621297676, 5.592911318723319, 3.3882581711236064, -2.605692421337087, 2.949990002861009, 3.0439481947811067, 2.0238033696822897, -10.847146958183401, 7.332646204916479, 1.0950082958250111, 1.8862732653999426, 3.5408684594157034, -6.207011785690426, -2.2616050480198573, -3.726299586820039, -1.7590694302760763, -9.426057223322927, -5.655757188086557, -5.02524356860997, -17.477784905843723, -2.1436717905315708, -7.696255216404584, -3.8360788743627214, -7.4247533962209555, -4.2950655645528535, -6.553156840860872, 0.3767697864298463, -25.582236471022103, -0.33587115522311495, -8.564107082161557, 4.5230299392062845, -0.4280059191392338, 3.43871663153929, 9.938297951268437, -2.9585134558595767, 1.0317644046462908, 5.286202182227699], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.054568210887616, -12.083244457701836, -10.266956010475191, -8.929163902319175, -15.177177584973183, -6.968780171806915, -23.039178697763663, -18.724120879829655, -7.052781191667762, -11.566213627865597, -8.002941401812448, -11.700287608557854, -13.594463574451725, -18.4382063242692, -11.440253338432207, -7.8016336736158785, -6.436426817850538, -19.877869052429592, -16.544004780916087, -19.94171000336716, -20.576005858188836, -23.275398532175, -13.658384622103377, -5.106996152218895, -15.661696176175715, -19.07835985284125, -13.588577846307738, -6.829640745243082, -17.955735711422353, -18.57914585887222, -13.911594397507592, -12.397778425633824, -12.926429890309842, -16.483465704483493, -23.936290189429304, -25.242276072271547, -10.930750202189952, -11.7005043383907, -9.28393319184896, -8.366346592447243, -8.76790052655287, -17.653206659501876, -9.948717743897571, -11.102114406014636, -26.65718961156582, -6.523621665184784, -7.241617929815879, -12.951944320252816, -17.031676190540736, -12.052196737409256, -11.620630866418406, -8.369295933132186, -9.461802242741634, -4.31553956122179, -11.727942848434562, -6.376166094014418, -21.530731872796643, -10.992730291419504, -15.252852471096958, -8.931353084788377, -12.639450464198926, -9.447989824836053, -13.894570920444577, -20.725562143968613, -26.658510148207423, -14.57088677477555, -17.109101518123282, -11.24297726461639, -9.979582083753169, -16.396298855161042, -16.304561001871896, -23.30201346285252, -13.773870312316236, -8.17595948615226, -11.250159641619224, -10.514961084300724, -11.877575124833404, -18.56038302535096, -11.081610477883078, -20.160856768973332, -12.742069652578818, -29.228228762693202, -13.81172828880632, -17.411431872241227, -10.791306944705713, -9.324035018374664, -15.318421350588771, -12.692979554494183, -12.597887639112761, -12.601898884431359, -22.64229671009059, -14.79631254923722, -18.28434029029193, -15.926049710466515, -12.119206712927522, -13.098401068053708, -25.335505763975398, -15.126673257134819, -7.670040607916566, -16.44164678170224, -14.075291831509569, -8.526574970746022, -13.152136276812808, -27.576226827464108, -9.774174316575005, -15.177974269829795, -18.331986301003656, -11.766908432804529, -13.537684570547782, -12.981506831153492, -10.903858493315049, -6.8170841157826905, -9.915131720644185, -14.20176206272918, -10.865411952451643, -8.552728544601347, -7.912633106402056, -13.534807663946133, -6.974199977980231, -10.061567171913467, -7.556257583956027, -17.91177367061023, -15.996227931566054, -8.16443986953746, -24.83212147616623, -8.392686088994159, -7.6780539900820335, -15.521930493009446, -14.871613997733675, -16.705519996632084, -14.153697011747921, -15.490027541842235, -7.848608637700039, -8.072969638628534, -14.385885933199704], "policy_policy_agent__reward": [12.304678332042352, 12.304678332042352, 5.167933810784709, 5.167933810784709, 5.544796139980394, 5.544796139980394, 5.987351391102832, 5.987351391102832, 4.700727958599033, 4.700727958599033, 0.17622618411895458, 0.17622618411895458, 12.306211633823217, 12.306211633823217, 11.858938589870034, 11.858938589870034, -0.09201792048247762, -0.09201792048247762, 6.6252263485026255, 6.6252263485026255, 4.1064424140586, 4.1064424140586, 3.0016746751422922, 3.0016746751422922, 5.95612214768429, 5.95612214768429, 9.091931430873581, 9.091931430873581, 1.9364324235618484, 1.9364324235618484, 4.853218279926421, 4.853218279926421, -2.560338684226385, -2.560338684226385, 8.656775722346755, 8.656775722346755, 8.93761592485313, 8.93761592485313, 5.208687825557121, 5.208687825557121, 15.436416546897295, 15.436416546897295, 15.19126157025766, 15.19126157025766, 6.812581969166462, 6.812581969166462, -1.8000114297899599, -1.8000114297899599, 7.381509018354114, 7.381509018354114, 12.924950898214515, 12.924950898214515, 9.700678007656387, 9.700678007656387, 1.4399632097873962, 1.4399632097873962, 9.93758989004843, 9.93758989004843, 7.857022900220793, 7.857022900220793, 6.5074919088818275, 6.5074919088818275, 5.182789432182995, 5.182789432182995, 9.675511832728441, 9.675511832728441, 5.353503029958199, 5.353503029958199, 10.533071163196695, 10.533071163196695, 9.913182063414352, 9.913182063414352, 5.731284875322218, 5.731284875322218, 0.8897099776639352, 0.8897099776639352, 2.4120431929984414, 2.4120431929984414, 4.755603100063455, 4.755603100063455, 4.5696786002525105, 4.5696786002525105, 5.770360722601054, 5.770360722601054, 3.403259880915107, 3.403259880915107, 3.4385086876599007, 3.4385086876599007, 8.042621067707174, 8.042621067707174, 1.6493652135083126, 1.6493652135083126, 3.1491106799401134, 3.1491106799401134, 6.136607696137648, 6.136607696137648, 8.916605966406701, 8.916605966406701, 6.345062793744133, 6.345062793744133, 4.73254940383125, 4.73254940383125, 2.5542235391330608, 2.5542235391330608, 3.838277065264214, 3.838277065264214, -0.6246056066207094, -0.6246056066207094, 4.003160421285906, 4.003160421285906, 2.124535203547508, 2.124535203547508, 15.979154338603525, 15.979154338603525, 6.641640341303326, 6.641640341303326, 3.9734265594406453, 3.9734265594406453, 1.1178475720320993, 1.1178475720320993, 6.188076589795731, 6.188076589795731, 6.091695986809982, 6.091695986809982, 7.512233168886887, 7.512233168886887, 14.671157170603248, 14.671157170603248, 16.940416952999183, 16.940416952999183, 5.688930580209327, 5.688930580209327, 4.6266880975673965, 4.6266880975673965, 5.631741445631726, 5.631741445631726, -0.899102567611137, -0.899102567611137, 8.482708233278162, 8.482708233278162, 7.093703683295149, 7.093703683295149, 8.862444376079736, 8.862444376079736, 6.8880926081085505, 6.8880926081085505, -0.6199046277989646, -0.6199046277989646, 4.420330147480923, 4.420330147480923, 5.406334930808617, 5.406334930808617, 6.754205766970678, 6.754205766970678, 13.46635918815214, 13.46635918815214, 4.784659173389, 4.784659173389, 1.771431672041681, 1.771431672041681, 6.916464627586965, 6.916464627586965, 16.444845501395488, 16.444845501395488, -0.10441043043395054, -0.10441043043395054, 5.552936083136048, 5.552936083136048, -3.160017188457966, -3.160017188457966, 4.959065173871958, 4.959065173871958, 11.903303002224648, 11.903303002224648, 5.820208646616009, 5.820208646616009, 5.070084117128135, 5.070084117128135, 7.838360089727076, 7.838360089727076, 15.627956587124602, 15.627956587124602, 6.877121406727988, 6.877121406727988, 2.3694394803336585, 2.3694394803336585, 12.176665710819236, 12.176665710819236, 6.430332050355481, 6.430332050355481, 5.6505825852632405, 5.6505825852632405, 13.11759176076649, 13.11759176076649, 6.284480133331394, 6.284480133331394, 0.124215993309445, 0.124215993309445, 11.017279050212784, 11.017279050212784, 8.731775001316583, 8.731775001316583, 2.960441274704469, 2.960441274704469, 8.05106313983691, 8.05106313983691, 15.31008751112261, 15.31008751112261, 5.898988843128648, 5.898988843128648, 2.1654136558232002, 2.1654136558232002, 12.832316252960066, 12.832316252960066, 6.430958364314771, 6.430958364314771, 7.711978917973862, 7.711978917973862, 8.261187645284595, 8.261187645284595, 2.3484233538123096, 2.3484233538123096, 2.2777395338814164, 2.2777395338814164, 3.0944160669120735, 3.0944160669120735, 6.22134631622655, 6.22134631622655, 0.7196773645643592, 0.7196773645643592, 1.4484856782573945, 1.4484856782573945, 1.4436947688960422, 1.4436947688960422, -1.9714886209487896, -1.9714886209487896, 2.41526409372433, 2.41526409372433, 1.1826559777544428, 1.1826559777544428, 1.8600893547966526, 1.8600893547966526, 5.243510137194637, 5.243510137194637, 5.850581183506602, 5.850581183506602, 0.8056415143382937, 0.8056415143382937, 12.60444563129804, 12.60444563129804, -8.59477519101397, -8.59477519101397, 3.6710914174294578, 3.6710914174294578, 3.4789117054239416, 3.4789117054239416, 9.697321968469982, 9.697321968469982, 8.138757038746421, 8.138757038746421, 8.796206821643608, 8.796206821643608, 12.714162746555335, 12.714162746555335, 2.4450475909202307, 2.4450475909202307, 4.552367021637413, 4.552367021637413, 9.836044057713698, 9.836044057713698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403525228734292, "mean_inference_ms": 2.2342138937940974, "mean_action_processing_ms": 0.09754008533369145, "mean_env_wait_ms": 0.5881770902012047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 50625, "timesteps_this_iter": 0, "agent_timesteps_total": 151875, "timers": {"sample_time_ms": 13252.299, "sample_throughput": 254.673, "load_time_ms": 0.502, "load_throughput": 6729309.755, "learn_time_ms": 2184.505, "learn_throughput": 1544.973, "update_time_ms": 29.024}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 22.559860610961913, "policy_loss": -0.011177815916016697, "vf_loss": 22.582539558410645, "vf_explained_var": -0.15593239068984985, "kl": 0.003749087619875102, "entropy": 1.1504083156585694, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 7.96936309337616, "policy_loss": 0.02202455309452489, "vf_loss": 7.959267950057983, "vf_explained_var": -0.06653885841369629, "kl": 0.005183402888499516, "entropy": 1.2447790622711181, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50625, "num_agent_steps_sampled": 151875, "num_steps_trained": 50625, "num_agent_steps_trained": 151875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2025, "training_iteration": 15, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-50-54", "timestamp": 1706107854, "time_this_iter_s": 13.325153589248657, "time_total_s": 199.98822402954102, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08E48F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 199.98822402954102, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.752941176470586, "ram_util_percent": 63.964705882352945, "gpu_util_percent0": 0.08235294117647059, "vram_util_percent0": 0.23619887408088236}}
{"episode_reward_max": 17.24719808746038, "episode_reward_min": -26.768998010593865, "episode_reward_mean": -1.3775760671297477, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.14330412483634, "policy_agent_": -7.47482866310356}, "policy_reward_max": {"policy_adversary_": -5.138681658727374, "policy_agent_": 24.195251106148355}, "policy_reward_mean": {"policy_adversary_": -14.691454663547127, "policy_agent_": 6.65693929820869}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.696173841395413, -8.619310989994386, -2.627952215305482, -3.3184307595351155, -0.45101628047390385, 0.39420660839564614, -1.4194130753754148, 4.884035091132924, 6.288290590323094, 5.485452897512976, 0.7516385444121916, -1.4130925327056194, -0.11938224158499855, -4.208621899985672, 3.0530599952443067, -0.07357900007985346, -1.4221625521752475, 14.952960128971778, 0.24500343600283703, -0.09205968098691653, -12.699078707373971, -6.407442098029646, -5.438267520399573, -9.120935589355717, -3.253930202171865, -9.978454168626055, -0.29996320244087826, -9.152323778865355, -6.519864630924893, 2.269517033788244, -9.779201690199233, -26.768998010593865, -14.849303250543434, 0.628232572875219, 1.9368240091736681, -1.9886172773292408, 10.282388951284293, 6.57515995223439, -3.8776147790726636, 2.534797731754213, 6.928316946354191, 8.906656106263465, 7.429704746418902, -7.919523945750067, -5.326394226410764, 2.671296621389606, 3.6713655120139754, 6.293257866393773, 7.406458722961411, -1.2093464037634802, -0.24599920397027053, -4.553866537382382, 3.8278731455160604, 3.365374145091603, -6.8525427509526455, -2.9533942400897586, -0.24678502002205543, -1.9569845903130356, -6.236408961197004, -3.005849203970294, -9.68262426857687, 2.8734983628740354, -3.7610799632881533, 6.7884991173606455, -18.915790182054053, 3.538508439193401, -3.0657366454277857, -4.260756795123767, -0.12316730881177629, -4.5077085107749735, -9.515409085847006, 8.393709358260953, 2.458930797856987, 14.796437928001883, -6.065591650796236, 0.2508764955529956, -6.804737076696013, -1.8906825479574982, 5.99505239502803, -6.11546247888848, -2.01570530495087, -4.445832936548892, -7.606815445747334, -13.781414164497818, 1.9255780450248856, -4.200338227278648, -2.161752909721806, -9.04278895303884, -1.6662201757657773, 16.419908288551945, 0.5372880548242545, -2.12938373514425, 4.291428903788335, 8.737489181165401, 2.5145361277430434, 10.74136136348588, -4.418095262934808, 5.725741558544496, 6.500916495150206, -3.473848333661265, 0.49911910892361816, -2.1854893578544967, -8.871377869979485, -1.9708797209886268, -5.895350133510986, -2.6476569863713055, 1.2995376172536772, 4.189851305698784, -7.027554208854109, -9.392809464851956, -0.9083405967559959, -13.321030234078046, 2.7370732963085542, 0.4740538147972114, -3.7353278678213124, -9.603427811595672, 4.994797045055597, -1.8103367705412756, -0.3161426634409391, -6.54093875718158, 2.0180325941592727, -2.594806469090318, -3.759873549964202, 9.555614066421276, 17.24719808746038, -4.704125389645512, -9.76772118832835, -8.783489917052568, -0.22316151292807554, -0.11380346620491516, -7.312818562785745, 0.6848174787585841, 0.5908551590064839, -13.056214667370991, -0.23944671419995237], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.467245220906094, -7.038668545891687, -15.158860350386076, -11.282085654821316, -11.123398004782622, -19.031814413198894, -7.430826779556083, -18.917152891157563, -15.887195198900901, -20.053637113079347, -10.669546096392985, -8.61765362708161, -22.596749178043208, -21.872403305804387, -12.16453781725341, -13.919614686890515, -8.83812969912051, -23.372699328041037, -13.543675812476648, -9.612523106338319, -19.335485899757966, -6.33503661932725, -5.138681658727374, -14.862456824646777, -7.27003919248158, -12.22596429493992, -12.678499270186533, -13.785531388225737, -18.23770559723095, -25.17829848128112, -10.614188591457303, -11.819340684386745, -13.827916022709013, -10.96472617276935, -11.174627977560608, -6.752703734288172, -23.053979966769344, -16.68390153818265, -14.255863399232092, -11.808793411697643, -22.084401857384897, -18.004730348337247, -16.43207086954847, -9.985582813252764, -6.428171042723276, -25.012413711724072, -12.218677331186743, -12.254793839886629, -18.709474740953674, -12.409713560716142, -20.88878153619738, -18.72847629965055, -16.119336910768652, -12.719835876271427, -26.077166414144934, -16.831776044163767, -13.142535063669346, -13.18120636013835, -13.09643688314894, -12.383720453835055, -8.698799412046984, -15.666105473652566, -19.238340652677074, -15.841934691953005, -8.58004789468025, -13.879373261176429, -10.967379950485608, -25.072955092404523, -6.37921804454393, -11.080799757489595, -8.783293546623275, -25.42458373469162, -10.574340838269741, -24.406352898983968, -9.517990504147663, -11.99384185744508, -30.82896995099008, -20.749937654307573, -11.703992767606959, -15.215392453895177, -15.296258887644957, -8.909053476979135, -17.0042323085086, -10.375600693603243, -20.884971049397695, -22.60480646745162, -14.307961255064315, -10.702873818255181, -8.031841354788178, -24.53842708338696, -9.260543139954365, -7.577572828658256, -15.87910656169889, -22.489564600421446, -27.583641258960963, -20.677945976450257, -12.628819939665362, -14.764960115478205, -16.72697656452945, -17.101215186717848, -10.384225243602074, -15.670629411108866, -14.984576960982366, -12.972318299609118, -8.532959971458595, -12.228130451186649, -16.181861618442294, -13.091753907104975, -8.708467682022812, -11.261333511213833, -11.429670073933165, -18.057995600712392, -15.039479936093976, -15.510210580082932, -8.661975487254622, -6.956891331760657, -12.497300113620673, -25.046476346722546, -12.363406037648577, -21.718104011367423, -9.50758122419293, -12.050773895254412, -11.622580465505814, -20.39508618489935, -31.14330412483634, -13.114279473905006, -9.967017952794638, -13.695829031249954, -19.275470972039713, -10.080418803644735, -18.974776858216867, -16.799576237436302, -9.119583849474061, -17.786040791320158, -14.254810618793757], "policy_policy_agent__reward": [1.8855356897553404, 1.8855356897553404, -0.790321222051351, -0.790321222051351, 6.265454067540296, 6.265454067540296, 3.9818274476431004, 3.9818274476431004, 5.336190862154359, 5.336190862154359, 9.713010510797266, 9.713010510797266, 3.0057068520903356, 3.0057068520903356, 11.900593991145247, 11.900593991145247, 11.087742894611997, 11.087742894611997, 12.76954500529616, 12.76954500529616, 5.710592320402588, 5.710592320402588, 3.602280547187996, 3.602280547187996, 11.238683468229109, 11.238683468229109, 8.831890702909359, 8.831890702909359, 7.608798906248858, 7.608798906248858, 6.923017843405328, 6.923017843405328, 3.7079835734726325, 3.7079835734726325, 19.162829728506406, 19.162829728506406, 6.894339624239743, 6.894339624239743, 4.760231712675699, 4.760231712675699, 3.318203596191993, 3.318203596191993, -0.036202739351197805, -0.036202739351197805, -0.14979293083609932, -0.14979293083609932, 2.8707606176455287, 2.8707606176455287, 2.0080544951548576, 2.0080544951548576, 1.1237550631569315, 1.1237550631569315, 6.189268033872829, 6.189268033872829, 2.3166038046801933, 2.3166038046801933, 5.858920483153028, 5.858920483153028, 13.72390775753468, 13.72390775753468, 0.41749345062903487, 0.41749345062903487, -7.47482866310356, -7.47482866310356, -0.5106936139172085, -0.5106936139172085, 5.796479372822284, 5.796479372822284, 6.555725993367141, 6.555725993367141, 2.3820432284794664, 2.3820432284794664, 16.66818445902682, 16.66818445902682, 11.629530745208521, 11.629530745208521, 5.18912431007971, 5.18912431007971, 7.17179557172593, 7.17179557172593, 14.506359401869547, 14.506359401869547, 13.455693227300355, 13.455693227300355, 11.930887807983686, 11.930887807983686, 1.0330294337513504, 1.0330294337513504, 0.5508884081562564, 0.5508884081562564, 13.84185516655684, 13.84185516655684, 7.94502142160036, 7.94502142160036, 9.274025853140198, 9.274025853140198, 13.05796673195755, 13.05796673195755, 5.600183578476331, 5.600183578476331, 10.321391166113557, 10.321391166113557, 7.087304881134086, 7.087304881134086, 9.973605028142355, 9.973605028142355, 8.042605010681514, 8.042605010681514, 9.612311831596148, 9.612311831596148, 6.939190902037008, 6.939190902037008, 6.447875021823645, 6.447875021823645, 5.612110884912653, 5.612110884912653, 3.4300139609759674, 3.4300139609759674, 4.6889356249323795, 4.6889356249323795, -0.491912428264946, -0.491912428264946, 9.269801918263301, 9.269801918263301, 7.738630344694458, 7.738630344694458, 11.315216904656827, 11.315216904656827, -5.167871143686894, -5.167871143686894, 8.708940850184915, 8.708940850184915, 3.9508216525289113, 3.9508216525289113, 10.40609914864038, 10.40609914864038, 3.128025367866077, 3.128025367866077, 3.2865456233573096, 3.2865456233573096, -0.36605776961186964, -0.36605776961186964, 16.909146546476286, 16.909146546476286, 6.516635818063365, 6.516635818063365, 19.601395413492924, 19.601395413492924, 1.7261994266757141, 1.7261994266757141, 6.122359176499037, 6.122359176499037, 12.01211643714703, 12.01211643714703, 9.429627553175042, 9.429627553175042, 8.849522581317492, 8.849522581317492, 4.549964987503349, 4.549964987503349, 6.640276791347045, 6.640276791347045, 2.231610270215122, 2.231610270215122, 4.698708431380631, 4.698708431380631, -1.7029067354472869, -1.7029067354472869, 11.405274547211295, 11.405274547211295, 9.202234120086485, 9.202234120086485, 6.073104172671254, 6.073104172671254, 0.8300424326081683, 0.8300424326081683, 3.1828105895111998, 3.1828105895111998, 20.479167685969447, 20.479167685969447, 4.898915597389308, 4.898915597389308, 2.7240945467570015, 2.7240945467570015, 10.085267732743617, 10.085267732743617, 15.61352689079342, 15.61352689079342, 15.049088693352008, 15.049088693352008, 15.709653669968064, 15.709653669968064, 4.1053623383652775, 4.1053623383652775, 10.245350837011351, 10.245350837011351, 11.613946529839827, 11.613946529839827, 6.813683426528293, 6.813683426528293, 5.441672176262846, 5.441672176262846, 6.742570026627185, 6.742570026627185, 3.0565995455014403, 3.0565995455014403, 5.500719289310245, 5.500719289310245, 1.3188049189738058, 1.3188049189738058, 4.790236732407671, 4.790236732407671, 8.740699617847984, 8.740699617847984, 8.640802606401884, 8.640802606401884, 0.8404567365843518, 0.8404567365843518, 0.9342620231809355, 0.9342620231809355, 5.260664738588586, 5.260664738588586, 2.368482683317177, 2.368482683317177, 8.888276616201265, 8.888276616201265, 7.992132197440071, 7.992132197440071, 2.4633238097166554, 2.4633238097166554, -1.3232682399175006, -1.3232682399175006, 8.746048579338137, 8.746048579338137, 11.61806978809064, 11.61806978809064, 6.023631687103819, 6.023631687103819, 7.588582627092918, 7.588582627092918, 5.762806909176102, 5.762806909176102, 4.7279837130820495, 4.7279837130820495, 3.931353457770808, 3.931353457770808, 14.975350125660311, 14.975350125660311, 24.195251106148355, 24.195251106148355, 4.205077042129749, 4.205077042129749, 0.09964838223314623, 0.09964838223314623, 2.456169557098695, 2.456169557098695, 9.526154729555818, 9.526154729555818, 4.9833076687199105, 4.9833076687199105, 5.830979147715558, 5.830979147715558, 8.742196858097444, 8.742196858097444, 4.855219504240272, 4.855219504240272, 2.3649130619745855, 2.3649130619745855, 7.0076819522969025, 7.0076819522969025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3412607327156312, "mean_inference_ms": 2.253093223124685, "mean_action_processing_ms": 0.09768152522110214, "mean_env_wait_ms": 0.5930662574521567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 54000, "timesteps_this_iter": 0, "agent_timesteps_total": 162000, "timers": {"sample_time_ms": 13374.535, "sample_throughput": 252.345, "load_time_ms": 0.601, "load_throughput": 5613584.487, "learn_time_ms": 2215.463, "learn_throughput": 1523.384, "update_time_ms": 28.828}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 26.076270866394044, "policy_loss": -0.006274592387489975, "vf_loss": 26.09372673034668, "vf_explained_var": -0.1677952766418457, "kl": 0.005889283327802969, "entropy": 1.1183666825294494, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 10.260766172409058, "policy_loss": -0.006556648499099538, "vf_loss": 10.278852510452271, "vf_explained_var": -0.024507731199264526, "kl": 0.006619798023622373, "entropy": 1.219187605381012, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 54000, "num_agent_steps_sampled": 162000, "num_steps_trained": 54000, "num_agent_steps_trained": 162000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2160, "training_iteration": 16, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-51-09", "timestamp": 1706107869, "time_this_iter_s": 14.929456949234009, "time_total_s": 214.91768097877502, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A7381F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 214.91768097877502, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 42.9, "ram_util_percent": 64.5157894736842, "gpu_util_percent0": 0.17842105263157892, "vram_util_percent0": 0.24746864720394737}}
{"episode_reward_max": 22.542424663811623, "episode_reward_min": -20.44068903831901, "episode_reward_mean": -0.4717060476946738, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -40.48354172018729, "policy_agent_": -3.722150015323797}, "policy_reward_max": {"policy_adversary_": -4.582187801196218, "policy_agent_": 31.512983191999457}, "policy_reward_mean": {"policy_adversary_": -14.84395702246209, "policy_agent_": 7.186125487383709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.25080810474923343, -1.112002568342339, -7.3267664829616255, -14.053272459908383, -1.607430145241308, 2.178410452025612, -17.34021092860126, 4.635258415423393, -5.492315859713375, -0.6263579106427679, 8.81699196293179, 6.00266160306594, -0.49533327305058217, 12.99399551158893, 2.5332753765833296, -6.115368115831806, 0.024882097472450848, 2.4179268443601583, -13.045103099660768, -4.090892462479335, -3.492631468156809, -6.370672154408793, 4.010206518688211, 6.343477423108784, -7.0479824376859215, 4.287712039037042, -5.599830856370532, 8.052085871364541, 5.69977331131655, -1.8292519452928937, -3.5217409259254673, -4.446337987591091, -5.796118917056927, -0.5205604694801474, 2.0141674216851895, -1.5983242462927647, -14.949534659243689, -5.7212972539651465, 0.40909252858726297, 6.024049514362755, -0.8497982130511958, -4.131144798353734, -1.9283497652300734, 2.839862715696124, 2.7246138035861804, 1.6687210587668737, 1.4892909059994297, 6.207860446130175, -7.891441507160976, -5.615887870692475, 16.390335365563978, 7.071938606329429, -9.198826913118555, 0.7496693205366586, -5.153652634100379, 1.0930177765908107, -5.514597852931621, -0.5333827992372633, 0.22803414254739318, -4.427467108250917, -10.613728972881054, -6.937356729042722, -10.626219275997023, -1.955619814595153, -10.239201076389499, 6.528309725241307, -5.857572822267549, -7.851906858082807, -1.1217309258535344, 4.225003685872935, 22.542424663811623, 5.766410364506061, -1.7664039701505412, 3.4111625044284812, 3.3212077194595007, 10.123690713695025, 5.531020408584002, 6.583500422266808, -3.3882767589930536, 8.352601445194171, -20.44068903831901, -17.946748185650765, -1.626805603709331, 0.961195485340772, -4.503016608719732, 20.543426483319383, 0.374516207607856, 2.3955105952113183, 1.7501896855332952, -7.258745954709488, 17.424902790202964, 1.7478695909152715, 1.6167544603935702, 10.152077391367637, -15.646838293350825, 1.8385692009700754, -9.144192516687259, -9.352777766223706, -2.320114317288742, -1.4151836116159333, -14.862204107078503, 0.9733586013522177, 2.9982032290108456, 7.397895077502355, 0.4612314433255599, 6.279883220938731, -3.5996262302860953, 0.44857846715112976, 2.8352267747275253, 9.497686837545924, 5.743047531407042, 0.4391285078841277, 1.318966730398431, -4.9470671038818335, 12.222012755072157, -6.155734551935912, -1.4899977715404942, 0.1733743143546836, -17.647174706467855, -0.1754166533801691, -11.973624476378284, 2.53872694898939, -1.8355820466790274, -0.39019167328326065, 1.4050543495677614, 6.336074338002588, -3.6930897378293857, 10.96524272215223, 1.6680207047298636, -1.7885557457045747, 0.7528749436815787, -0.5419842618382482, 7.998636645102073, -7.337585268438033, 5.412846261582853], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.240119023215273, -12.942769625423598, -15.055801095577646, -25.454943626221198, -10.654142231153285, -16.834132816211003, -13.584328401780684, -18.93626400119008, -17.377954176198422, -10.635456531315732, -19.04300130866845, -16.807914983915424, -16.258494213846213, -23.25461926598511, -14.677214433403027, -6.371527420668384, -12.762016849207642, -10.585364632048066, -12.683584180217782, -23.55656224257248, -10.668139167483837, -15.391737536854611, -15.32311009452563, -25.166818885146437, -13.140620716400425, -14.849087337797444, -7.63558403699961, -24.46386373695072, -16.76766644529785, -17.671222132711943, -17.68301332913992, -14.879667574512535, -11.595513726808022, -9.46288914078681, -10.316782731599647, -19.201593003721296, -15.705326544998606, -12.01149181526497, -5.393465188508714, -18.309773962769096, -7.738519635265375, -14.913569030866197, -11.253750143705902, -13.955762215365612, -9.31632263436926, -15.326816987345886, -9.708348212960264, -15.885957388237717, -19.069900124308823, -7.265802116264775, -25.277765529616754, -16.13182304013055, -14.923358939276827, -13.682395812181642, -10.584885852660083, -9.29124183999493, -9.08335582400764, -19.242355797810266, -15.900126791281066, -12.789309639985307, -23.40225209868264, -4.58607106184695, -10.442864769520927, -10.734065835017915, -18.906527890272624, -12.08637579551549, -21.99155081398176, -14.535454095818398, -11.207258294646534, -16.381347168441273, -40.48354172018729, -18.693323544588093, -10.38908799028054, -15.349327633916547, -12.093651831787584, -19.472137074496388, -15.604191812420382, -23.120980746367263, -11.16766199797944, -19.682921853329614, -15.72819666440061, -10.50244815500317, -7.373588880531589, -10.072730776151822, -20.210466260762555, -35.20215226616392, -8.380211557827188, -14.677500413632785, -19.774556466778577, -12.055196236523646, -34.76839771301764, -13.000744963328126, -13.544747671255188, -20.257466363646785, -12.007791199690232, -11.675073592342752, -18.860296328185054, -15.025821175349867, -9.436839072718367, -7.307532070934702, -8.299610381576006, -12.806397546259479, -16.62218429812648, -16.33555481817248, -8.460816279323875, -22.67080595141584, -5.5832741953931295, -9.463427734708038, -15.345127483563273, -21.7277477303878, -19.989600942744136, -12.767620506303361, -9.563600890065661, -8.152461017103622, -19.904100083716344, -9.950928619477795, -10.173004106869735, -20.818469336192283, -18.708330222337832, -15.519358004312956, -13.689324689410832, -13.286235430791141, -13.752835671182181, -15.49227916733272, -7.785687131071737, -15.053392066705769, -5.4820314917030615, -28.41885271958783, -24.49121036945211, -4.582187801196218, -13.31206449094473, -8.400882621410029, -16.6793891244135, -7.560474311527834, -18.1976332175278], "policy_policy_agent__reward": [5.245463563982254, 5.245463563982254, 5.915383528540631, 5.915383528540631, 3.8645173063080103, 3.8645173063080103, 5.700835583156407, 5.700835583156407, 4.523356042955988, 4.523356042955988, 9.506271634118306, 9.506271634118306, -1.8779412634102914, -1.8779412634102914, 11.785761208306738, 11.785761208306738, 5.942819158242522, 5.942819158242522, 5.0045493103364835, 5.0045493103364835, 13.929996635800116, 13.929996635800116, 11.40528829349068, 11.40528829349068, 7.881580470397812, 7.881580470397812, 18.12430738878702, 18.12430738878702, 8.605244904993176, 8.605244904993176, 0.1280796524182883, 0.1280796524182883, 6.3934494733400475, 6.3934494733400475, 6.501645738204112, 6.501645738204112, -0.18075945972148977, -0.18075945972148977, 9.732834890046567, 9.732834890046567, 3.5877538496635144, 3.5877538496635144, 4.5105326912229105, 4.5105326912229105, 9.666658306606921, 9.666658306606921, 15.755148154127609, 15.755148154127609, 3.0463191393572506, 3.0463191393572506, 9.56839968841724, 9.56839968841724, 1.0178765903145386, 1.0178765903145386, 16.25797480415763, 16.25797480415763, 11.233719878307204, 11.233719878307204, 7.920985093709525, 7.920985093709525, 7.080636201607232, 7.080636201607232, 5.216664793460721, 5.216664793460721, 2.899697404875545, 2.899697404875545, 4.47116433565333, 4.47116433565333, 6.1654750766424185, 6.1654750766424185, 8.801634378714265, 8.801634378714265, 0.37789594287744666, 0.37789594287744666, 3.145097280649911, 3.145097280649911, 2.9012788585479887, 2.9012788585479887, 12.166911738565926, 12.166911738565926, 3.444360711107089, 3.444360711107089, 5.391212116256232, 5.391212116256232, 4.662700189237914, 4.662700189237914, 8.397812465530867, 8.397812465530867, 6.0204682189777206, 6.0204682189777206, 8.49776902305638, 8.49776902305638, 5.5988195594798436, 5.5988195594798436, 11.046908917183945, 11.046908917183945, 5.589229308573925, 5.589229308573925, 0.8249571227861505, 0.8249571227861505, 20.834050447590364, 20.834050447590364, 11.601880823229985, 11.601880823229985, 2.8622660130791377, 2.8622660130791377, 7.216032566359148, 7.216032566359148, 2.715616609279851, 2.715616609279851, 5.19212980829287, 5.19212980829287, 1.7843789855380077, 1.7843789855380077, 9.354486499286503, 9.354486499286503, 8.06408046691423, 8.06408046691423, 4.180921265867195, 4.180921265867195, 6.394261562900796, 6.394261562900796, -1.1756428335978868, -1.1756428335978868, -0.09167725323804515, -0.09167725323804515, 4.389223010211379, 4.389223010211379, 4.333663406941566, 4.333663406941566, 9.307342760378397, 9.307342760378397, 8.066988995857105, 8.066988995857105, 3.3417736188677916, 3.3417736188677916, 5.042763684396501, 5.042763684396501, 10.303175427157102, 10.303175427157102, 31.512983191999457, 31.512983191999457, 12.229866954547077, 12.229866954547077, 4.311342010065, 4.311342010065, 9.380245069172515, 9.380245069172515, 7.7074297756235435, 7.7074297756235435, 14.797913894095705, 14.797913894095705, 10.567606110502188, 10.567606110502188, 14.852240584317034, 14.852240584317034, 3.8896926194931947, 3.8896926194931947, 14.01776164926189, 14.01776164926189, -2.3562461869591997, -2.3562461869591997, -3.722150015323797, -3.722150015323797, 2.87339163841113, 2.87339163841113, 5.516963130746298, 5.516963130746298, 7.85372482602141, 7.85372482602141, 27.872789374741654, 27.872789374741654, 4.377363882717526, 4.377363882717526, 8.536505504422053, 8.536505504422053, 10.762373076155937, 10.762373076155937, 2.398225140907077, 2.398225140907077, 26.096650251610296, 26.096650251610296, 7.374307277121697, 7.374307277121697, 7.580751065824376, 7.580751065824376, 15.204771877507214, 15.204771877507214, -1.819523546830302, -1.819523546830302, 6.756821396656414, 6.756821396656414, 4.8580519057489004, 4.8580519057489004, 2.836521704563084, 2.836521704563084, 3.5583623777148135, 3.5583623777148135, 2.9461742296593836, 2.9461742296593836, -3.2812968627512493, -3.2812968627512493, 6.88987807380585, 6.88987807380585, 9.810193763568662, 9.810193763568662, 11.866724947837415, 11.866724947837415, 4.461023861324717, 4.461023861324717, 14.475344586177279, 14.475344586177279, 0.9918239825535182, 0.9918239825535182, 4.956003100929585, 4.956003100929585, 9.090177129145397, 9.090177129145397, 15.612717283966859, 15.612717283966859, 12.866324237075588, 12.866324237075588, 6.6033745070937435, 6.6033745070937435, 5.441283810232045, 5.441283810232045, 1.6026969566108953, 1.6026969566108953, 16.063056419394254, 16.063056419394254, 1.8975970337709396, 1.8975970337709396, 4.341503167664619, 4.341503167664619, 10.495921825273486, 10.495921825273486, 0.5305777579349908, 0.5305777579349908, 7.671970675466396, 7.671970675466396, 0.8578501065162782, 0.8578501065162782, 7.912481189890267, 7.912481189890267, 5.958626812251575, 5.958626812251575, 7.551043747024729, 7.551043747024729, 4.5953707403197495, 4.5953707403197495, 10.694733202354177, 10.694733202354177, 0.894470876936839, 0.894470876936839, 19.69204772087003, 19.69204772087003, 13.079615537090994, 13.079615537090994, 1.396816027745822, 1.396816027745822, 7.032469717313154, 7.032469717313154, 3.929449179785889, 3.929449179785889, 12.339012884757787, 12.339012884757787, 0.11144452154489894, 0.11144452154489894, 11.80523973955533, 11.80523973955533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34172783731566664, "mean_inference_ms": 2.2567108794932547, "mean_action_processing_ms": 0.09741621769971967, "mean_env_wait_ms": 0.593604713940112, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 57375, "timesteps_this_iter": 0, "agent_timesteps_total": 172125, "timers": {"sample_time_ms": 13454.229, "sample_throughput": 250.851, "load_time_ms": 0.698, "load_throughput": 4835283.509, "learn_time_ms": 2207.248, "learn_throughput": 1529.053, "update_time_ms": 29.221}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 27.108081436157228, "policy_loss": -0.0006030803953763098, "vf_loss": 27.119790077209473, "vf_explained_var": -0.1164551019668579, "kl": 0.007160105791001315, "entropy": 1.1107576370239258, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 12.830058717727661, "policy_loss": -0.006954610580578446, "vf_loss": 12.848505449295043, "vf_explained_var": -0.049321350455284116, "kl": 0.004436734867264797, "entropy": 1.1935541749000549, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57375, "num_agent_steps_sampled": 172125, "num_steps_trained": 57375, "num_agent_steps_trained": 172125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2295, "training_iteration": 17, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-51-23", "timestamp": 1706107883, "time_this_iter_s": 13.581520080566406, "time_total_s": 228.49920105934143, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 228.49920105934143, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.96666666666667, "ram_util_percent": 65.2, "gpu_util_percent0": 0.08500000000000002, "vram_util_percent0": 0.23148600260416666}}
{"episode_reward_max": 17.52826825138547, "episode_reward_min": -22.998041251573945, "episode_reward_mean": -0.24325738935003566, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.54239778021705, "policy_agent_": -6.590185554514241}, "policy_reward_max": {"policy_adversary_": -4.314147490949556, "policy_agent_": 22.33236612294019}, "policy_reward_mean": {"policy_adversary_": -14.442439659449954, "policy_agent_": 7.09959113504996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.407877096768628, -6.583481636725462, 11.108164308662877, -1.8108658304818985, 7.272759865884641, -0.4317812919440374, -1.310567488418747, 0.6605076582125075, -3.297682881209391, 5.817727855991324, -6.351235572638944, -3.27941971264396, -7.59205256237241, -3.0609278116278866, 3.0065743157908074, -0.7429835747230575, -0.8588125908259476, -11.037707835989918, 1.2902803849861317, -12.071336173537137, 2.5719607191460927, -6.430304578521409, 3.6633190192910408, -8.1952364133743, 8.119994673331018, -3.6165634248997085, 4.056105820063074, -3.398033603325909, -2.3329826340549946, -2.908894840259781, 0.47060534139832777, -1.099042540771765, 1.8744357322922236, -1.7751100446222177, 3.1592392536132166, 3.6258715077733563, 0.15284275294139027, -7.574238937270659, -15.63195504584665, -1.706357258310684, 3.0244789784760338, -8.091323979171145, -1.7884806447786863, 2.209098395527518, 1.4859633741770457, 3.7434336702284896, -8.180699843459866, -1.037704839170482, 3.699362789929296, -0.8653655445232062, -13.089050165661837, 5.973475659126708, -1.9670295599517955, -7.612889602175242, -8.084499243756275, 3.4327588784723364, 4.5390490467517655, 4.147131663119281, 2.104452179500724, -6.057364471555696, 1.6000645736002879, -0.8632278241769502, 0.038119821800443515, -10.934286748232783, 8.619183181415135, 2.949930252792244, -7.4984973599256515, 1.6310866151534305, 7.47923567812923, 3.1594912576187832, 10.597561481422817, 3.0460598433067587, -9.011067683935009, -0.8247643775546385, 2.9199063430958034, 17.52826825138547, -0.04045931224381749, 5.0390004394166095, 11.906001476243775, 12.25525848036792, 0.1908205388393544, -1.9323743954018675, -5.940813456919653, -0.46578029099736296, -1.797509417684265, -2.770162288421424, -0.029480088639849106, -1.2995483698125487, 7.169314935960975, -5.744023065404045, 1.9433472747820444, -11.680517543299304, 1.1552564886274514, -0.20264087642458428, 5.5145848231988595, 0.7369780048853103, -8.388279927165435, -6.183888821102204, 8.016117484213098, -7.960559114457621, 0.7265432493566838, 1.4497882679855418, -0.4083358977094281, 1.549105433679492, 3.0334033365550592, -0.8508494456571938, 9.007063149972073, -2.421995355703021, 1.6311882179299122, -1.681331051377211, -22.998041251573945, -14.45156503372604, 9.343656173900051, -5.076950344680632, 3.695237080218308, -1.1773019916133785, 2.4339435775698934, 1.8398788138980282, 7.1972732691750325, -1.5659994813301066, -0.26340317853109196, -7.91977722467937, 4.661433269013393, -0.6806672197572166, -0.49377190287778117, 6.241135764565085, 3.7277100169369892, 7.596251470339922, 2.8322001385448106, -6.312916093439467, 9.1158569767474, 0.9810266331597948, -1.0694221654262717, 1.0388688333248588, -4.242178644356546], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.648149497815968, -18.687469444002538, -31.11200183953236, -11.419002840538331, -18.473149324585492, -13.652459253314312, -7.569499493769673, -14.941063330535433, -20.803117489818757, -11.356267426148152, -9.203902307719698, -8.51049200977861, -4.314147490949556, -12.393319886865536, -11.344129833275836, -9.635043966483883, -7.581810602815471, -8.275619753263499, -10.323495736162318, -13.183086103521013, -12.896984537125578, -14.775940495599457, -13.662315113860654, -16.595610478236704, -15.464045401640504, -13.19972456305191, -21.88718592211663, -16.076213062019356, -8.508781006443122, -5.745566692946832, -27.723660172258295, -20.96501978330568, -23.17823259478076, -19.324898060431916, -20.72123049474089, -11.575462637731365, -12.144099107266607, -13.996622535404548, -12.554245136012781, -11.918568691805543, -13.302273721776467, -16.210895172539065, -15.046034388745799, -10.08130022559639, -11.07971259005446, -12.726688419732868, -11.217147815623438, -9.921088839524574, -10.764174463789946, -11.886502034491432, -12.512657639991962, -16.41043939744072, -6.702121594670753, -11.285737316281883, -10.670155308703297, -14.55189376395915, -15.055259528115817, -20.085672592011733, -15.461443830637997, -11.931927983475342, -17.10410862934335, -13.450528565379546, -12.968678255012628, -10.555546254645222, -22.873774776332304, -9.054318415446925, -14.136774206635991, -9.553195984486255, -16.77399882770614, -14.284783681679711, -14.552587711653562, -15.684873143695079, -24.713813690260313, -21.546866050108942, -15.20935300083779, -27.136463994494903, -14.682162298601487, -14.456399535107964, -21.888918187940327, -31.54239778021705, -10.09400036289154, -6.465775737861386, -7.52094266496205, -12.560847714115932, -20.2731433176714, -14.719563900254851, -12.039473515466511, -11.659676059785943, -19.590560681286483, -11.986958577925096, -10.097162636333433, -15.087506306004732, -7.973028870022032, -18.420383783588097, -17.82039409084454, -11.756586378583513, -9.69585271218704, -9.95413020679195, -17.041978431340873, -16.10461977252162, -15.386722841605186, -12.566040029470377, -16.615281725839694, -14.20410910384814, -13.703576803556, -10.044184159235911, -25.673328468967338, -25.499331063144687, -19.592177244433255, -9.39913170860859, -9.81767014254546, -23.171081550568964, -19.31198744390543, -16.472023660078847, -13.780459111569929, -14.973236264174398, -17.00334779759885, -12.248767031559684, -17.4546314234228, -16.379962100907882, -20.42988269612286, -6.4598563232565835, -11.753176346105274, -6.576985488033197, -5.129686531775322, -20.649623834214406, -15.120762493413938, -20.897625846299995, -14.16147605649393, -8.813622430999294, -20.701091161044555, -17.682828918425834, -6.663247897560768, -12.56785657674973, -6.547692295343481], "policy_policy_agent__reward": [13.0280132972923, 13.0280132972923, 6.051993903638539, 6.051993903638539, 21.11008307409762, 21.11008307409762, 4.804068505028216, 4.804068505028216, 12.872954595235067, 12.872954595235067, 6.610338980685135, 6.610338980685135, 3.1294660026754633, 3.1294660026754633, 7.800785494373969, 7.800785494373969, 8.75271730430468, 8.75271730430468, 8.586997641069738, 8.586997641069738, 1.4263333675403742, 1.4263333675403742, 2.6155361485673247, 2.6155361485673247, -1.6389525357114259, -1.6389525357114259, 4.666196037618823, 4.666196037618823, 7.175352074533322, 7.175352074533322, 4.446030195880411, 4.446030195880411, 3.3614990059947605, 3.3614990059947605, -1.381044041363211, -1.381044041363211, 5.8068880605742255, 5.8068880605742255, 0.5558749649919381, 0.5558749649919381, 7.734472628135837, 7.734472628135837, 4.172817958539025, 4.172817958539025, 8.662817066575851, 8.662817066575851, 4.200187032431205, 4.200187032431205, 11.79202003748576, 11.79202003748576, 4.7915805690761015, 4.7915805690761015, 12.971645871089851, 12.971645871089851, 6.339089729346724, 6.339089729346724, 3.0878991861940635, 3.0878991861940635, 1.4183359263435251, 1.4183359263435251, 14.097132756828307, 14.097132756828307, 9.93298862126696, 9.93298862126696, 12.526334163536493, 12.526334163536493, 8.774894007904843, 8.774894007904843, 11.940234874177055, 11.940234874177055, 7.600667072752361, 7.600667072752361, 6.148470930103999, 6.148470930103999, 3.211191799066943, 3.211191799066943, -1.5388549549169332, -1.5388549549169332, 5.106105716747429, 5.106105716747429, 8.163376350126248, 8.163376350126248, 4.059785596683961, 4.059785596683961, 6.628776871983554, 6.628776871983554, 6.145199310561956, 6.145199310561956, 6.282837982115752, 6.282837982115752, 8.23506104498068, 8.23506104498068, 1.5182239860817812, 1.5182239860817812, 4.441692000177046, 4.441692000177046, 7.23176862685962, 7.23176862685962, 5.510568244984112, 5.510568244984112, -0.2881962628349369, -0.2881962628349369, 11.191957528283709, 11.191957528283709, 2.3675460173594782, 2.3675460173594782, 1.836423857053322, 1.836423857053322, 1.2928280324735069, 1.2928280324735069, 8.992326321215742, 8.992326321215742, 9.797154287433791, 9.797154287433791, 12.116402127565504, 12.116402127565504, 8.782948005069361, 8.782948005069361, 2.9372817559598245, 2.9372817559598245, 9.352086601471823, 9.352086601471823, 6.293650370601297, 6.293650370601297, 6.503399038406539, 6.503399038406539, -0.18937024679378156, -0.18937024679378156, 15.74647897887372, 15.74647897887372, 6.002124334119582, 6.002124334119582, 3.3191384233551675, 3.3191384233551675, 5.592141299819844, 5.592141299819844, 12.126617252917685, 12.126617252917685, 8.722137469649248, 8.722137469649248, 12.575074596538188, 12.575074596538188, 9.365466493500922, 9.365466493500922, 7.851373003162655, 7.851373003162655, 10.361050836277155, 10.361050836277155, 9.064629671966797, 9.064629671966797, 22.33236612294019, 22.33236612294019, 7.320851493178835, 7.320851493178835, 9.747699987262287, 9.747699987262287, 16.897459832092053, 16.897459832092053, 21.89882813029249, 21.89882813029249, 5.142410450865445, 5.142410450865445, 2.2667006712297595, 2.2667006712297595, 0.7900646040211957, 0.7900646040211957, 6.047533711559283, 6.047533711559283, 9.237816949993574, 9.237816949993574, 5.9747008059167115, 5.9747008059167115, 6.004996713413332, 6.004996713413332, 5.180063844986699, 5.180063844986699, 13.379937808623731, 13.379937808623731, 3.1214677562605275, 3.1214677562605275, 6.020254955557737, 6.020254955557737, 1.7034943813527157, 1.7034943813527157, 4.5641426793247435, 4.5641426793247435, 9.108871453581758, 9.108871453581758, 11.667489457021697, 11.667489457021697, 6.246782191734412, 6.246782191734412, 0.6537863925107994, 0.6537863925107994, 1.885120692844873, 1.885120692844873, 12.529047957776982, 12.529047957776982, 4.072030329032003, 4.072030329032003, 8.056633045480938, 8.056633045480938, 7.007914148727959, 7.007914148727959, 8.103472914065133, 8.103472914065133, 7.8766072687638164, 7.8766072687638164, 8.368490070055532, 8.368490070055532, 4.59666735678936, 4.59666735678936, 17.340195809469705, 17.340195809469705, 11.538667853720831, 11.538667853720831, 10.611682731181585, 10.611682731181585, 3.85890032861569, 3.85890032861569, -6.590185554514241, -6.590185554514241, 4.359758258421458, 4.359758258421458, 14.327821808902739, 14.327821808902739, 5.697536657699109, 5.697536657699109, 8.73784809589412, 8.73784809589412, 6.897967136280507, 6.897967136280507, 9.718645687584374, 9.718645687584374, 7.044322922728854, 7.044322922728854, 12.325952346298912, 12.325952346298912, 7.406981309788888, 7.406981309788888, 10.083239758795884, 10.083239758795884, -0.7299604507113913, -0.7299604507113913, 8.207304807559334, 8.207304807559334, 2.9481591341379882, 2.9481591341379882, 2.3179573144487717, 2.3179573144487717, 13.445379799389745, 13.445379799389745, 9.424236255175462, 9.424236255175462, 14.246938658319952, 14.246938658319952, 8.496838097519369, 8.496838097519369, 1.2503531687799139, 1.2503531687799139, 14.908474068895977, 14.908474068895977, 9.331927775792817, 9.331927775792817, 2.796912866067248, 2.796912866067248, 6.803362705037294, 6.803362705037294, 1.152756825493468, 1.152756825493468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34096125278426753, "mean_inference_ms": 2.252004586809973, "mean_action_processing_ms": 0.09753685667464612, "mean_env_wait_ms": 0.592946770785326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 60750, "timesteps_this_iter": 0, "agent_timesteps_total": 182250, "timers": {"sample_time_ms": 13383.108, "sample_throughput": 252.184, "load_time_ms": 0.698, "load_throughput": 4832312.419, "learn_time_ms": 2178.826, "learn_throughput": 1549.0, "update_time_ms": 29.022}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 24.305499458312987, "policy_loss": 0.0056036937749013305, "vf_loss": 24.310981369018556, "vf_explained_var": -0.07444002628326415, "kl": 0.007797620707709269, "entropy": 1.1088104724884034, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 10.732417345046997, "policy_loss": -0.02123856879770756, "vf_loss": 10.765043020248413, "vf_explained_var": -0.036044493317604065, "kl": 0.008454379131518674, "entropy": 1.1810163736343384, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60750, "num_agent_steps_sampled": 182250, "num_steps_trained": 60750, "num_agent_steps_trained": 182250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2430, "training_iteration": 18, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-51-36", "timestamp": 1706107896, "time_this_iter_s": 12.974691390991211, "time_total_s": 241.47389245033264, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 241.47389245033264, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 65.51875, "gpu_util_percent0": 0.1225, "vram_util_percent0": 0.229156494140625}}
{"episode_reward_max": 19.195183346739718, "episode_reward_min": -18.640157889384955, "episode_reward_mean": 0.4302824714883461, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.72110893514579, "policy_agent_": -3.372211785797176}, "policy_reward_max": {"policy_adversary_": -4.601853597887357, "policy_agent_": 24.458146140942745}, "policy_reward_mean": {"policy_adversary_": -14.261733948904592, "policy_agent_": 7.3460082101964685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.8078802530947233, 0.8212978092355959, -2.2373650274741532, 9.827094187780183, 7.373014524682747, 7.1238208484384895, 2.997399402901734, 0.7702192649860892, 6.677525818056238, -5.601017548917346, 12.277193598267711, -7.959317200922835, 1.725817043484735, 9.232139407424764, -2.727743834067444, 0.7813208082678269, -0.38976722591295243, -4.225638615687559, 6.800371227235978, -0.012791977822040668, 7.880042865762178, 5.246196837350963, -2.5776675982688078, 19.195183346739718, 3.389229430954934, -1.481583380050535, -5.559715412542803, 5.7880881162682964, -2.1495784304240844, -3.314883025207865, 9.022987400289297, 5.089511966515726, -3.853814475014971, -3.6095800089269283, -9.380203298789102, 3.2485617791607937, -7.018427758524788, 0.937736476623835, 10.56367638587525, -2.8423388728801555, 11.002905948268808, -3.6872349140631653, 9.893510750765378, 5.085487273894344, -6.78428370991034, 2.4416821343773036, -1.2059858910950414, 6.173275354634761, 5.8192773802364, 8.702060519812356, 1.2979878670892444, -0.45083812283610175, -1.9434533796766564, -4.091379881789365, -1.750621371549224, -6.996953505879173, -11.676697060725726, 3.457786414605604, 7.811188687836469, 14.647260231049948, -1.9796297927128295, -0.3750539645276314, 6.436832017134189, 2.299211691120213, 7.369248459337534, 2.3504516004572444, 5.737676405866711, 8.332544254273754, 4.961192379603166, 0.1569794953904306, 3.079904248677596, -7.886712358109409, -7.637369498158624, -0.43404406751317354, -11.120407574453605, -0.6132184721689844, -2.9109431968968287, -8.991089335040193, -1.9280374603434165, -5.524261853752656, 0.06703694444258629, -6.270611074809624, -4.893422841042376, -2.1856912598836393, -4.963986588393611, 2.3109402302207114, -0.3857278423175454, -1.8342027743987155, 9.577850819923036, -0.9852761310846817, -10.921208798948479, -6.600513657943951, -1.538928971498776, -9.763210756397367, -1.619855675809105, -0.1526608642709407, 5.396660811537135, -1.432417335451754, 0.43858868320169864, -5.773796195501087, 5.505349151098061, -2.6879466596022126, -8.433235644633196, -0.5305133620003466, -18.640157889384955, 7.003054660854516, 8.971859615030128, -5.210674760643268, 9.246787039069854, -1.9417751232337626, -1.5192518156421913, -5.733471859708459, 10.800416087390305, 0.5034509208841761, 3.260054695719764, -4.402838493251406, 9.37337035540527, -6.169116525139987, 1.849513431675362, 4.679877963294813, 5.644884341074931, -1.7874626392307187, 1.1718409202029758, -2.037221488797615, 5.4689455676756, 0.03681599269548569, -6.25150247697345, 4.9260291405957375, -0.10530573102959018, -6.485665503525295, -7.835789505669986, 0.2465067577673234, -3.7307079175510314, 0.29197700529380455, 6.05310837463927], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.20773227654886, -8.353408909475977, -11.876012233853167, -15.042734555257084, -14.954982331913458, -19.40839482326301, -14.058055549514654, -19.434758647599296, -12.841677897759789, -18.61658829779582, -28.58260759385249, -8.222181295694988, -11.808119985495626, -28.58912571868605, -10.200239783583172, -23.270008990613306, -10.119144288952056, -11.188937703130872, -11.181457078792027, -17.38396983883306, -23.043012912757185, -15.198571079306435, -8.2756942683179, -29.72110893514579, -9.2745024150956, -15.494706759583465, -11.438474021808398, -14.037386709413052, -10.452387726519833, -13.244418342986787, -17.06704496898628, -12.684575015965137, -6.282032263144199, -11.485863939509182, -8.566391251878459, -16.376485030710835, -11.837518391568015, -8.552434913153585, -20.567602060105994, -9.550807426136581, -17.606663718164747, -7.594843216939629, -23.67859238134511, -18.301334148598528, -4.6365906243977415, -12.851189524804408, -8.721331174277086, -22.93758429394056, -20.31577642128333, -16.303019006321602, -10.471018156783362, -16.38829930503032, -15.492095136441925, -12.452349484599129, -12.878302601426997, -7.393544991233632, -7.111383896541386, -15.204201385462875, -17.053032572086632, -21.57037659625309, -9.388065242145487, -7.59051257395195, -18.306803760180173, -11.003795934582284, -19.474906541399832, -13.402581472424302, -14.796878996924608, -14.670401080801797, -19.465048628826327, -19.78206546286913, -14.894946812352075, -8.600260287171025, -8.812900122274701, -23.109973473677517, -7.865628010165829, -16.55395035722484, -7.250900115222477, -15.009240644789118, -10.866442594098995, -18.461607706575734, -8.38694582933613, -16.966103343935426, -10.124858500072813, -13.931687786756983, -17.4251368836745, -17.141231800190734, -8.459395412712173, -11.476224815044679, -26.444521999514144, -9.28948746008363, -20.816129376325033, -10.017179808868669, -16.510493905915013, -16.765106628335232, -21.14979173252044, -13.933209868125013, -18.57055340120384, -8.03606263569121, -11.38915117674692, -11.069196053450215, -18.531964166689548, -12.867804599297763, -20.85252625412499, -10.736959886121404, -11.895734317790609, -15.874292111926904, -19.360767075002617, -10.683591520843413, -14.921754500935451, -10.80750110580389, -8.10201809766919, -12.39260223784896, -27.46205271909105, -9.337134352741334, -16.019619528211546, -11.678280257757, -21.82010363890183, -15.049882546752919, -16.90906076880774, -14.111013985695413, -18.57971127199244, -9.68947537134845, -9.685858391222482, -13.50945731250763, -12.636483795729031, -17.851893605979047, -9.608433471564913, -15.73494347599741, -18.823489605487776, -6.891212683464876, -4.601853597887357, -15.93610489125397, -11.266948698355655, -13.334257593915815, -13.1072325585988], "policy_policy_agent__reward": [3.6999260117270665, 3.6999260117270665, 4.587353359355787, 4.587353359355787, 4.819323603189507, 4.819323603189507, 12.434914371518634, 12.434914371518634, 11.163998428298102, 11.163998428298102, 13.266107835850747, 13.266107835850747, 8.527727476208193, 8.527727476208193, 10.102488956292692, 10.102488956292692, 9.759601857908013, 9.759601857908013, 6.507785374439235, 6.507785374439235, 20.4299005960601, 20.4299005960601, 0.13143204738607572, 0.13143204738607572, 6.7669685144901806, 6.7669685144901806, 18.910632563055405, 18.910632563055405, 3.7362479747578643, 3.7362479747578643, 12.025664899440564, 12.025664899440564, 4.864688531519551, 4.864688531519551, 3.4816495437216566, 3.4816495437216566, 8.990914153014002, 8.990914153014002, 8.68558893050551, 8.68558893050551, 15.461527889259678, 15.461527889259678, 10.222383958328697, 10.222383958328697, 2.849013335024546, 2.849013335024546, 24.458146140942745, 24.458146140942745, 6.331865923025267, 6.331865923025267, 7.006561689766464, 7.006561689766464, 2.939379304632796, 2.939379304632796, 9.912737412840677, 9.912737412840677, 4.1514046480478735, 4.1514046480478735, 4.964767658889461, 4.964767658889461, 13.045016184637788, 13.045016184637788, 8.887043491240433, 8.887043491240433, 1.2141088940646139, 1.2141088940646139, 3.938141965291126, 3.938141965291126, -0.40690602345531834, -0.40690602345531834, 9.812523404935813, 9.812523404935813, 2.4095453165216107, 2.4095453165216107, 4.745085694888708, 4.745085694888708, 15.565639222990626, 15.565639222990626, 3.354234276628212, 3.354234276628212, 14.304784833216779, 14.304784833216779, 1.953804151438232, 1.953804151438232, 16.786051566055242, 16.786051566055242, 11.693410711246438, 11.693410711246438, -1.0738465427563006, -1.0738465427563006, 7.646435829590857, 7.646435829590857, 3.757672641591021, 3.757672641591021, 14.555429824287664, 14.555429824287664, 13.067526900759862, 13.067526900759862, 12.502539763066977, 12.502539763066977, 5.884503011936303, 5.884503011936303, 7.968730591097107, 7.968730591097107, 6.774320878382635, 6.774320878382635, 4.180484801404883, 4.180484801404883, 5.563840614938887, 5.563840614938887, 0.1982957426772312, 0.1982957426772312, -2.282656582092168, -2.282656582092168, 9.33099390003424, 9.33099390003424, 12.432110629961548, 12.432110629961548, 18.108818413651527, 18.108818413651527, 3.7042177247163273, 3.7042177247163273, 3.6077293047121572, 3.6077293047121572, 12.371817888657183, 12.371817888657183, 6.651503812851248, 6.651503812851248, 13.422077500368683, 13.422077500368683, 7.876516536440776, 7.876516536440776, 10.267277701395662, 10.267277701395662, 11.501472667537778, 11.501472667537778, 12.213120504214745, 12.213120504214745, 9.969522479129777, 9.969522479129777, 8.987425530514834, 8.987425530514834, 0.35677396453080845, 0.35677396453080845, 0.5877653120580362, 0.5877653120580362, 11.337964703082175, 11.337964703082175, -1.6273897821438872, -1.6273897821438872, 7.970365942527928, 7.970365942527928, 2.1699784591628237, 2.1699784591628237, 3.0090756548744615, 3.0090756548744615, 4.469202566877791, 4.469202566877791, 6.46867292641154, 6.46867292641154, 4.226991386889359, 4.226991386889359, 5.347746134562899, 5.347746134562899, 2.6157178295152153, 2.6157178295152153, 5.872998263436671, 5.872998263436671, 6.230575147640442, 6.230575147640442, 9.726086015205723, 9.726086015205723, 4.036833785197313, 4.036833785197313, 4.821011020322984, 4.821011020322984, 18.011186409718583, 18.011186409718583, 4.152105664499475, 4.152105664499475, 4.94746028868827, 4.94746028868827, 1.7083330754623567, 1.7083330754623567, 7.485782467208117, 7.485782467208117, 3.50094793596893, 3.50094793596893, 9.764968028355668, 9.764968028355668, 6.890274501927038, 6.890274501927038, 11.983607106370489, 11.983607106370489, 3.3018226501197283, 3.3018226501197283, 5.913869929974311, 5.913869929974311, 2.647699928974566, 2.647699928974566, 12.018656658893805, 12.018656658893805, 5.089928969847776, 5.089928969847776, 6.209645304745894, 6.209645304745894, 5.103223262060529, 5.103223262060529, -3.372211785797176, -3.372211785797176, 11.438673386390713, 11.438673386390713, 14.166313345016373, 14.166313345016373, 2.736458380100073, 2.736458380100073, 12.084270770002655, 12.084270770002655, 4.432862991285064, 4.432862991285064, 3.291383141013501, 3.291383141013501, 3.329565189070251, 3.329565189070251, 19.13123440324068, 19.13123440324068, 4.920292636812755, 4.920292636812755, 9.639837111965655, 9.639837111965655, 3.6377208822527978, 3.6377208822527978, 15.59673699715355, 15.59673699715355, 4.440383010806465, 4.440383010806465, 9.37928710024155, 9.37928710024155, 9.395445974495116, 9.395445974495116, 12.112297806533684, 12.112297806533684, 3.951006366058866, 3.951006366058866, 5.42884965571273, 5.42884965571273, 5.736117911855008, 5.736117911855008, 9.052714681702321, 9.052714681702321, 8.944354799337264, 8.944354799337264, 1.6784654972957307, 1.6784654972957307, 10.330486308296576, 10.330486308296576, 9.359091937229097, 9.359091937229097, 0.20277358996979108, 0.20277358996979108, -1.6169679538913138, -1.6169679538913138, 8.091305824510645, 8.091305824510645, 3.7681203904023124, 3.7681203904023124, 6.813117299604808, 6.813117299604808, 9.580170466619032, 9.580170466619032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3414933613903764, "mean_inference_ms": 2.2526082783778536, "mean_action_processing_ms": 0.09769717826252028, "mean_env_wait_ms": 0.5935490192717037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 64125, "timesteps_this_iter": 0, "agent_timesteps_total": 192375, "timers": {"sample_time_ms": 13355.214, "sample_throughput": 252.71, "load_time_ms": 0.599, "load_throughput": 5637280.873, "learn_time_ms": 2196.526, "learn_throughput": 1536.517, "update_time_ms": 28.82}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 23.660119819641114, "policy_loss": 0.00893228619825095, "vf_loss": 23.66224536895752, "vf_explained_var": -0.17129310369491577, "kl": 0.007845937169700345, "entropy": 1.1060523629188537, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 10.219137144088744, "policy_loss": -0.028490948863327502, "vf_loss": 10.258985948562621, "vf_explained_var": -0.03546976447105408, "kl": 0.00761704195951565, "entropy": 1.1738933861255645, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64125, "num_agent_steps_sampled": 192375, "num_steps_trained": 64125, "num_agent_steps_trained": 192375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2565, "training_iteration": 19, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-51-49", "timestamp": 1706107909, "time_this_iter_s": 13.553142070770264, "time_total_s": 255.0270345211029, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E06B2FD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 255.0270345211029, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.83333333333333, "ram_util_percent": 65.3, "gpu_util_percent0": 0.23111111111111113, "vram_util_percent0": 0.22977701822916666}}
{"episode_reward_max": 16.332973922022795, "episode_reward_min": -14.96474353185114, "episode_reward_mean": 0.8107385630508789, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.252559790337436, "policy_agent_": -1.3140763716597017}, "policy_reward_max": {"policy_adversary_": -5.156215811931075, "policy_agent_": 22.792766856180112}, "policy_reward_mean": {"policy_adversary_": -13.581763205418186, "policy_agent_": 7.196250884234533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5624043355087047, -1.343516031579798, 2.4673040542195066, -7.264978738109097, -2.6511753939515237, 6.19865285983038, 8.903544026707563, 5.123173004864924, -0.664526873152959, -7.120188475521647, -0.5568956507748826, 4.3694325886839565, -1.1348145737342996, 12.329356203304558, 3.3202960010343956, -3.300811936496812, 1.7740054409904273, 11.229871633656776, -0.08204025205903598, -8.333769756243793, 7.086365922687109, -2.557460041100917, 3.9153326237258073, 10.225839891197271, 4.538412505876821, 5.605700393776146, 10.66701262965321, 2.9801817078418575, -1.4282102442890705, -6.416428643289284, 5.234417658291186, -4.381371341279748, 1.3222904373426119, -0.2777428518911986, 2.1795755645375943, -1.0252867516856425, 7.683264039157463, 5.982174129348091, -2.40817131644635, 8.229559583926806, -10.865535640456269, 0.44868419442089563, 3.303558310872237, -1.6466005031749908, -6.249993655425331, 2.28100191105913, -2.3259540846890765, -3.9453732757600073, -3.718080719610116, 1.7954441092591356, -2.985249230608464, -3.8340819851275807, 11.537120604245308, -13.049635011701344, 6.19918214660603, 1.8566237590503976, 3.6001845599421385, -1.8751058438050936, 4.006268103568944, -1.852765873706046, -9.028192377385075, -1.2692898292457095, -4.014630985287167, -2.933282650783563, 8.667822057654273, -9.690574800850406, -2.1184352927072814, -0.5781235935621025, 5.911960334248881, 13.422319944549095, 12.248547079855504, 0.8856377938447972, 4.743698620993, 1.5229866045910554, 11.029781345458723, 3.0061178497468433, -2.2929296589996038, 0.5821671899361993, -1.1388349947828775, 4.482103486169182, -0.5358161607533207, 2.86885451528849, 1.1042394045193333, 4.554752066190579, -2.697335453346081, -3.6239579685501218, -8.142141687832465, 7.325615867888018, 5.278454803562078, 3.3979490183661407, 3.43880249144934, 10.568240995889687, -12.61218091350962, 3.920520260495837, -9.12247821157994, -4.055458207468848, -3.177993669577087, 11.104947593567205, 3.5614334725277863, 6.121907260142098, -14.96474353185114, -2.0153875181463925, 2.246851298539419, -1.913325114543908, 2.0601742853458163, 9.808913957493461, 3.237511424908284, -0.5724051621045076, 3.6603401969780247, -10.20397401308296, 0.08691726529522631, 10.144449533765481, -1.2225117521160502, -7.869051586509107, -3.9753854399435715, -5.926885147184383, 2.9883115387207213, -5.8994476813233385, -4.42547997720435, -1.5611582916095086, -5.110239602672017, 3.0757217324377084, 11.293380042755677, 0.6671142262938872, -2.2941614989726484, 5.137919958144105, -0.22023523056142416, -2.533023335883357, 16.332973922022795, -7.222343756151637, -9.074934390960228, -4.584808628703147, 1.8021988305436496, 11.029975451001677, 4.213588837933914], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.156215811931075, -18.052666690247236, -10.675588040136448, -21.805519981667214, -14.001563706602992, -17.285944752655958, -15.736831137769318, -24.484982663389218, -18.85513021343017, -22.57132820747507, -8.26595041282086, -11.533239037588276, -10.033051049530568, -21.97416983526211, -8.412734209686016, -12.970651896471626, -17.04401757819122, -17.937655510990208, -9.788136867311731, -16.407103300310318, -14.27269172851263, -7.96945378165767, -12.1289023706977, -18.755006295147826, -16.526547155819525, -20.67347994831045, -20.336219270321195, -9.020095208058363, -14.149769104628595, -9.607749554007645, -13.478006710038878, -11.793578462198068, -15.675559097287088, -5.773979648670789, -22.800623598950526, -9.575541025494159, -20.05157656557101, -15.681362069268731, -6.153482658609724, -16.53165722693659, -15.697691266526325, -6.835595723229596, -11.219452155862106, -10.48768399981506, -11.521395682662213, -13.759753063479547, -7.001874097439083, -18.6327414751135, -15.278488595784442, -9.93609866673679, -15.730395625313726, -8.040178921962614, -22.080871424504235, -11.574095553262296, -14.520576508037722, -10.9025548081797, -15.814452281144415, -11.555170378635463, -16.703017595510016, -19.976378132701612, -11.59936048543438, -10.271432432573285, -10.136178537377548, -9.220163866067061, -16.36552917992851, -7.649631696346142, -6.923089264314118, -13.158462966023347, -16.6184846418549, -23.7577519512004, -20.856110656819947, -10.50894798349788, -12.154843684472398, -9.048515768729041, -16.914635687760782, -11.93329389239102, -10.059526920796648, -6.074763529311784, -10.301006263390697, -17.065600607894336, -7.81273203322446, -11.826052235896164, -7.175213005462474, -10.725871783369369, -7.474761720988812, -15.457368379135538, -11.566416321670255, -13.813594209923876, -13.55800658956444, -20.709221713599685, -16.32126354465895, -20.06341428305066, -16.684958511770972, -17.03495415087861, -9.102235958722295, -13.113264206984974, -19.450681863009176, -15.902407070127301, -12.711805403825693, -13.916134714049194, -12.336590788531742, -11.452632987446858, -19.989497860177288, -13.098186356766178, -18.22534871946788, -19.182850670008783, -14.683803731575411, -9.140754224826754, -17.15452607697916, -14.596912036656907, -10.271202139209784, -18.367912237919967, -23.086760652948634, -8.223993762421363, -11.02027845337551, -11.362911146872055, -13.36628454017623, -8.925225490610227, -14.42902057928141, -8.298414725130579, -5.381176055078517, -12.297756531731096, -18.524038873465592, -8.195835891594907, -10.384278917242963, -14.886580449225946, -8.011569422692128, -7.6392020527937206, -29.252559790337436, -13.750286003564176, -9.431892439011733, -8.494853229112328, -7.3348483199233145, -17.2588016798411, -9.227329839805147], "policy_policy_agent__reward": [1.2969057382111855, 1.2969057382111855, 8.354575329333718, 8.354575329333718, 6.571446047177978, 6.571446047177978, 7.270270621779056, 7.270270621779056, 5.675194156325732, 5.675194156325732, 11.742298806243165, 11.742298806243165, 12.320187582238443, 12.320187582238443, 14.804077834127076, 14.804077834127076, 9.095301670138607, 9.095301670138607, 7.725569865976711, 7.725569865976711, 3.8545273810229896, 3.8545273810229896, 7.951335813136117, 7.951335813136117, 4.449118237898134, 4.449118237898134, 17.15176301928334, 17.15176301928334, 5.866515105360205, 5.866515105360205, 4.834919979987408, 4.834919979987408, 9.409011509590822, 9.409011509590822, 14.58376357232349, 14.58376357232349, 4.853048307626348, 4.853048307626348, 4.036666772033261, 4.036666772033261, 10.679528825599865, 10.679528825599865, 2.7059968702783768, 2.7059968702783768, 8.022117497211756, 8.022117497211756, 14.490423093172549, 14.490423093172549, 10.532479830848173, 10.532479830848173, 13.139590171043295, 13.139590171043295, 15.501615949987201, 15.501615949987201, 6.000138457950111, 6.000138457950111, 6.360779430169759, 6.360779430169759, 1.5956604553591844, 1.5956604553591844, 9.356212184165035, 9.356212184165035, 3.706103560459161, 3.706103560459161, 8.49892476731485, 8.49892476731485, 2.7481183983897948, 2.7481183983897948, 12.490099581744062, 12.490099581744062, 4.275127136904259, 4.275127136904259, 13.867420302364238, 13.867420302364238, 10.83176809930841, 10.83176809930841, 1.8726556710816868, 1.8726556710816868, 12.380608405431701, 12.380608405431701, 2.416077813035023, 2.416077813035023, 3.6421399588252474, 3.6421399588252474, 7.261505233367172, 7.261505233367172, 4.420541748320033, 4.420541748320033, 2.6357010136184424, 2.6357010136184424, 8.02037748726934, 8.02037748726934, 2.337960006375003, 2.337960006375003, 7.343684099676746, 7.343684099676746, 5.780203938087164, 5.780203938087164, 5.865771387997964, 5.865771387997964, 6.372573197352631, 6.372573197352631, 2.103048468417516, 2.103048468417516, 16.808996014374763, 16.808996014374763, -0.7377697292195254, -0.7377697292195254, 10.359879327321876, 10.359879327321876, 6.379589283615047, 6.379589283615047, 9.707318420543277, 9.707318420543277, 4.840032267415182, 4.840032267415182, 10.35464284953948, 10.35464284953948, 9.06180612949778, 9.06180612949778, 1.2855840540246504, 1.2855840540246504, 4.501071301663789, 4.501071301663789, 3.06077377604519, 3.06077377604519, 3.143440607641749, 3.143440607641749, 12.516675618791387, 12.516675618791387, -1.0204715522521333, -1.0204715522521333, 2.4023269858034175, 2.4023269858034175, 6.29016968623062, 6.29016968623062, 11.265222488051888, 11.265222488051888, 18.590035947874746, 18.590035947874746, 16.552328868337717, 16.552328868337717, 5.697292888671339, 5.697292888671339, 8.449271152732697, 8.449271152732697, 5.285751186660047, 5.285751186660047, 13.972208516609752, 13.972208516609752, 7.469705871068929, 7.469705871068929, 3.8832986308985222, 3.8832986308985222, 3.3284653596239906, 3.3284653596239906, 4.581085634303912, 4.581085634303912, 10.773852047031754, 10.773852047031754, 3.638457936235569, 3.638457936235569, 7.347453375592326, 7.347453375592326, 4.139726204990904, 4.139726204990904, 7.640311924779972, 7.640311924779972, 2.3887131338213647, 2.3887131338213647, 5.916705205292708, 5.916705205292708, 1.7121373169188934, 1.7121373169188934, 10.569605038905948, 10.569605038905948, 9.41823069656326, 9.41823069656326, 12.05358536598291, 12.05358536598291, 9.880033018054142, 9.880033018054142, 15.315827639470172, 15.315827639470172, 2.036388799130676, 2.036388799130676, 10.477737205687223, 10.477737205687223, -0.010121126428820293, -0.010121126428820293, 4.5289029997580625, 4.5289029997580625, 8.136344096716048, 8.136344096716048, 13.503677331847257, 13.503677331847257, 8.136619438176742, 8.136619438176742, 10.019020987095645, 10.019020987095645, -1.3140763716597017, -1.3140763716597017, 4.718622734650234, 4.718622734650234, 11.118174579358351, 11.118174579358351, 5.5924306211111325, 5.5924306211111325, 10.142761502406845, 10.142761502406845, 14.49588231375112, 14.49588231375112, 8.960657578241847, 8.960657578241847, 4.284174531361122, 4.284174531361122, 10.407433136978591, 10.407433136978591, 2.196469011786969, 2.196469011786969, 5.179059702252508, 5.179059702252508, 14.256180885842722, 14.256180885842722, 10.932124450416293, 10.932124450416293, 0.17747108795612704, 0.17747108795612704, 3.5224465067159683, 3.5224465067159683, 2.7180129998438343, 2.7180129998438343, 8.177298039448477, 8.177298039448477, 1.5128889046434433, 1.5128889046434433, 5.001770301038531, 5.001770301038531, 3.3686282167605337, 3.3686282167605337, 0.13546822620324767, 0.13546822620324767, 7.686739132084401, 7.686739132084401, 14.908709458110637, 14.908709458110637, 4.431475058944397, 4.431475058944397, 4.045058709135158, 4.045058709135158, 10.012250203685024, 10.012250203685024, 3.8956670960653517, 3.8956670960653517, 2.553089358455182, 2.553089358455182, 22.792766856180112, 22.792766856180112, 3.2639711237062734, 3.2639711237062734, 0.1784790240257545, 0.1784790240257545, 1.9550223002045901, 1.9550223002045901, 4.568523575233483, 4.568523575233483, 14.144388565421389, 14.144388565421389, 6.7204593388695315, 6.7204593388695315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3414491749701204, "mean_inference_ms": 2.257522880994837, "mean_action_processing_ms": 0.09779148629859877, "mean_env_wait_ms": 0.5947285643274997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 67500, "timesteps_this_iter": 0, "agent_timesteps_total": 202500, "timers": {"sample_time_ms": 13429.453, "sample_throughput": 251.313, "load_time_ms": 0.598, "load_throughput": 5641999.203, "learn_time_ms": 2201.416, "learn_throughput": 1533.104, "update_time_ms": 27.825}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 20.147920036315917, "policy_loss": -0.004183668484620285, "vf_loss": 20.163112831115722, "vf_explained_var": -0.10252933502197266, "kl": 0.005002009048609246, "entropy": 1.1011797189712524, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 9.075778341293335, "policy_loss": 0.00022162869572639465, "vf_loss": 9.08720703125, "vf_explained_var": -0.03401961028575897, "kl": 0.00495061539411702, "entropy": 1.1897789537906647, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67500, "num_agent_steps_sampled": 202500, "num_steps_trained": 67500, "num_agent_steps_trained": 202500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2700, "training_iteration": 20, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-52-03", "timestamp": 1706107923, "time_this_iter_s": 13.84708571434021, "time_total_s": 268.8741202354431, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6BCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 268.8741202354431, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.12352941176471, "ram_util_percent": 65.27058823529413, "gpu_util_percent0": 0.12058823529411763, "vram_util_percent0": 0.23229262408088236}}
{"episode_reward_max": 25.36614705097654, "episode_reward_min": -20.67503575022242, "episode_reward_mean": -1.195209656929322, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -39.28997754248639, "policy_agent_": -4.490217975040544}, "policy_reward_max": {"policy_adversary_": -4.025121082500394, "policy_agent_": 32.32806229673147}, "policy_reward_mean": {"policy_adversary_": -13.999579842658447, "policy_agent_": 6.402185092864563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.8225405726262496, -1.827286756444345, 8.486010732566488, -4.103599579903716, 15.31637912273672, -1.1053073476074924, -4.328359760591379, 7.796915093269425, 3.0875079678048203, -1.6518694335048367, -17.530619378524552, 0.7992061976568058, -17.236098226514017, -0.07713697896391958, -1.5898269444131243, 5.191897372848854, -7.544465903602976, 2.864027982112114, -2.626975428280347, -1.9648308813731563, -0.26927251099299965, -0.7739102631441985, 4.340001943067356, -11.117462913510739, 3.6402459819367676, -3.941614247585152, -11.307074016442538, 6.9133623949006635, -4.436206485195657, 4.502487685370795, 2.74960848189584, -0.7900126144827111, -10.404463955250439, 7.835670543302137, -4.205309262884425, -5.9753114668021095, 1.722387223707611, 3.5749444036896394, 1.8490013639059162, -0.35064226382679986, -2.5036347458752863, 11.435718614795805, 1.2529197765436504, 9.795311858639055, -9.136217239678418, -5.156875586392821, -16.49532050206327, 3.1924605434963556, -6.913480981735352, -5.028486878975657, -7.8342246931141375, 3.681705921474059, -0.9020692906250574, -3.0997506860459456, 1.0746033619714148, -0.0042895171447971114, 7.190634165035521, -5.859299720507509, -8.709839642693336, -7.818790866655431, -8.784548135036902, 2.9643886143273286, 1.654188093244509, 2.95092000553839, -7.614415588331762, -3.0763399110319862, 5.744134917288568, -11.888643446992186, -1.0907951598361434, 1.3334212945956812, -2.9588251318793044, -6.498843668797799, -5.8198786816890085, 0.8018897465156589, 25.36614705097654, -7.18529622413564, 4.307929367692056, 7.14366545488245, -1.1084538921116172, -4.62524022525694, -1.676928455397496, -2.4892317995860833, -5.072606431285092, 0.9845290658135715, -5.037340678689509, 4.954379584128771, 6.758674250279441, -2.7082794444278946, -1.8810178544460272, 8.385955112952265, 0.3804679111313305, 0.14618915775372632, 10.113054075625868, 8.94563564888563, -1.1664369103914969, -4.756231144823901, -13.02250499815909, -4.221482683838872, 3.5069474501937745, -4.758692703325739, -0.10818461443068306, -3.968906398857344, -4.1210002872276945, -0.8078087636799424, 0.06699998833821075, -20.67503575022242, -5.25223784187165, -0.1191235285252471, 0.894016375422928, -2.5876241276125667, -5.895739939837565, -0.8421131866869342, -7.375226708699625, 9.40859369760499, 4.7209685231875085, 2.382388829231789, -6.095885306216241, 2.570360530722188, -7.626994921864163, -1.5368332890205403, -0.9804950674933774, -1.155556339266592, -13.557546549938312, -1.3046990928742965, 4.1753232022400395, 6.784038463173007, -18.865703096337153, 2.175745539154142, 0.2448596399489834, -1.1662484979462096, 3.850263316417053, -0.8643533674737642, -10.669359843449222, 7.293818919022263, -0.19501901149802314], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-20.693101262231195, -11.362745592237218, -21.31611426784314, -10.277871444171472, -24.820089167537933, -10.92793579812886, -5.4669135509356455, -17.673111502272583, -15.579592820345004, -4.660075690511836, -12.551660124224739, -6.048240362048607, -10.74498338732002, -14.511638850929032, -13.894700236068362, -19.357821806194497, -10.994250122048264, -9.28388681436518, -12.231144896983867, -18.535423761361077, -13.692587473047107, -11.84978285388741, -10.162970426172086, -19.670326064378894, -23.35502086684023, -11.659075895513244, -11.361329169930237, -15.197909904600635, -22.826623512036814, -13.156646251714118, -12.266667545177002, -15.229044383728834, -7.575493252519912, -24.81540737063329, -10.77994797566863, -16.981471290447328, -10.464909617404302, -14.096204327376423, -10.488012448371887, -12.429334815379017, -12.220097612846518, -17.3659929765274, -11.769512157949416, -21.415565800513317, -15.841648674532983, -10.25226356905944, -21.421113627686406, -10.904888936207126, -15.993137619754743, -10.729265599891356, -10.31642351492677, -13.011255163828297, -19.45376824916159, -16.706682276271575, -10.83219470358038, -7.348401801588609, -15.075143756346304, -6.23520576757189, -8.837651822150853, -6.951638784179999, -14.239755442356435, -9.345961898919922, -12.721528663566074, -15.180107121498514, -18.614439698558556, -13.186730366974059, -21.812471101557612, -10.021864980947973, -10.09560637390457, -22.533675548377115, -13.479041854203913, -11.550293944606898, -8.869624877703462, -14.094711704080419, -39.28997754248639, -16.42130516823612, -31.939121740791812, -19.15755675913892, -9.139684827114086, -7.840305351966974, -9.819887585493467, -8.99359905444319, -10.979664626944245, -15.980503077181835, -21.36793511928739, -10.846655826558726, -17.73866522820251, -6.00219513184159, -10.823685577323193, -17.415320132602755, -16.505833375039646, -9.29523464534583, -15.540892920641959, -17.4453765471487, -8.60444143650818, -8.365807083185912, -16.44059192218763, -11.164900018429831, -14.454062090764932, -9.625105836655134, -20.174305386855817, -12.139572518696895, -11.759233556685704, -7.968377199866279, -13.631408375987606, -11.694599800141345, -21.810978248419374, -11.333926738609781, -7.738487061203602, -12.344420405415079, -11.159078476799941, -13.469898701573998, -21.61404427644144, -19.477789530774366, -12.775482228943666, -20.94219253693567, -12.16842372356887, -17.657831626484253, -4.025121082500394, -12.255998920641558, -8.21530536439807, -16.469131825436374, -13.611090200614516, -17.765888216286847, -13.696156251878762, -22.95126008289825, -19.42387092862851, -16.22385082998849, -16.51035070600209, -4.81939054944836, -13.243178959846952, -12.488180555656887, -11.962609215379569, -21.568834445515964, -6.2369687104277185], "policy_policy_agent__reward": [8.935280344802472, 8.935280344802472, 4.767729417896438, 4.767729417896438, 14.901062500204816, 14.901062500204816, 3.087135932133879, 3.087135932133879, 20.06823414513733, 20.06823414513733, 4.911314225260684, 4.911314225260684, 0.5692768951721332, 0.5692768951721332, 12.735013297771005, 12.735013297771005, 9.33355039407491, 9.33355039407491, 1.5041031285035005, 1.5041031285035005, -2.489479627149902, -2.489479627149902, 3.423723279852707, 3.423723279852707, -3.2455574195970005, -3.2455574195970005, 7.217250935982555, 7.217250935982555, 6.152436645827618, 6.152436645827618, 12.274859589521675, 12.274859589521675, 1.7248921092226457, 1.7248921092226457, 6.073957398238646, 6.073957398238646, 4.8020847343517605, 4.8020847343517605, 8.28529643999396, 8.28529643999396, 6.711657481027053, 6.711657481027053, 5.537936295371605, 5.537936295371605, 7.251486184619722, 7.251486184619722, 4.276431575434082, 4.276431575434082, 13.497633424388498, 13.497633424388498, 3.8587308239640454, 3.8587308239640454, 0.02712757674385151, 0.02712757674385151, 11.055636149750649, 11.055636149750649, 9.195208513420578, 9.195208513420578, 8.829566968542457, 8.829566968542457, 7.50813801353642, 7.50813801353642, 7.219515884623063, 7.219515884623063, -1.4144853513652684, -1.4144853513652684, 16.325538956967712, 16.325538956967712, 3.2873193563921013, 3.2873193563921013, 5.50307991182261, 5.50307991182261, 6.093648420555956, 6.093648420555956, 8.835574365533029, 8.835574365533029, 6.168506906138901, 6.168506906138901, 6.03934627577611, 6.03934627577611, 4.858231433485615, 4.858231433485615, 14.400855795661604, 14.400855795661604, 6.511215967246535, 6.511215967246535, 15.605438829576187, 15.605438829576187, 3.3527157174272806, 3.3527157174272806, 2.547693991333311, 2.547693991333311, 2.4628965628115655, 2.4628965628115655, 7.048674739851741, 7.048674739851741, 4.539828319009698, 4.539828319009698, 2.8503893604578505, 2.8503893604578505, 1.2410994109063171, 1.2410994109063171, 8.346480542651177, 8.346480542651177, 9.275849479268265, 9.275849479268265, 6.803465795112818, 6.803465795112818, 5.953399032775897, 5.953399032775897, 3.672056142221905, 3.672056142221905, 11.13288896069091, 11.13288896069091, 0.18795302353219168, 0.18795302353219168, 0.06390608972876086, 0.06390608972876086, -0.4335760412377145, -0.4335760412377145, 2.7276036536597643, 2.7276036536597643, 6.155175256623624, 6.155175256623624, 7.187858378405295, 7.187858378405295, 9.065513563518449, 9.065513563518449, 5.500012055113396, 5.500012055113396, 5.055195227971035, 5.055195227971035, 13.778303009423086, 13.778303009423086, -0.9333892330221122, -0.9333892330221122, 4.502405607034212, 4.502405607034212, 11.93354842148639, 11.93354842148639, 5.260108361162304, 5.260108361162304, 2.525725137904548, 2.525725137904548, 1.524873098007228, 1.524873098007228, 7.448300725298038, 7.448300725298038, 32.32806229673147, 32.32806229673147, 4.6180044720502424, 4.6180044720502424, 18.12352555424194, 18.12352555424194, 13.150611107010683, 13.150611107010683, 4.0156154675012345, 4.0156154675012345, 1.6075325633550177, 1.6075325633550177, 4.071479565047985, 4.071479565047985, 3.2521836274285536, 3.2521836274285536, 2.9535290978295787, 2.9535290978295787, 8.482516071497704, 8.482516071497704, 8.165297220298939, 8.165297220298939, 7.900517705343747, 7.900517705343747, 12.248669739240977, 12.248669739240977, 1.6469578437068475, 1.6469578437068475, 4.471333861438582, 4.471333861438582, 12.900637622777511, 12.900637622777511, 8.443150643085486, 8.443150643085486, 4.720711901549779, 4.720711901549779, 12.826973498133912, 12.826973498133912, 13.195506098017164, 13.195506098017164, 3.719002263058343, 3.719002263058343, 1.8047879691810056, 1.8047879691810056, 1.7090434620142687, 1.7090434620142687, 3.47170866729548, 3.47170866729548, 8.98050477047935, 8.98050477047935, 2.433206566664695, 2.433206566664695, 10.033060386212567, 10.033060386212567, 4.085333059919777, 4.085333059919777, 3.8191166347290033, 3.8191166347290033, 3.580284218093168, 3.580284218093168, 6.849204182162908, 6.849204182162908, -4.490217975040544, -4.490217975040544, 8.279370203273865, 8.279370203273865, 5.6074016050422655, 5.6074016050422655, 4.316251718313265, 4.316251718313265, 4.878398138901255, 4.878398138901255, 2.631669268481188, 2.631669268481188, 6.313892757443531, 6.313892757443531, 7.119408783870906, 7.119408783870906, 14.443191614189681, 14.443191614189681, 8.748225376065589, 8.748225376065589, 11.662290683083729, 11.662290683083729, 3.0362692086763152, 3.0362692086763152, 10.114096078603223, 10.114096078603223, -1.8009369196818845, -1.8009369196818845, 5.359582815810509, 5.359582815810509, 3.6174051484523457, 3.6174051484523457, 7.656787743084887, 7.656787743084887, 0.026771825338106958, 0.026771825338106958, 8.230594561706276, 8.230594561706276, 8.935739727059403, 8.935739727059403, 14.867649273035628, 14.867649273035628, 0.2790839161456832, 0.2790839161456832, 9.199798184571314, 9.199798184571314, 8.377605172975539, 8.377605172975539, 1.826571025751076, 1.826571025751076, 8.546721138132005, 8.546721138132005, 5.811913594091563, 5.811913594091563, 0.6466246859651792, 0.6466246859651792, 14.43132668226911, 14.43132668226911, 3.020974849464847, 3.020974849464847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404541462567338, "mean_inference_ms": 2.251304734419851, "mean_action_processing_ms": 0.09723182833428157, "mean_env_wait_ms": 0.5931720346974222, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 70875, "timesteps_this_iter": 0, "agent_timesteps_total": 212625, "timers": {"sample_time_ms": 13420.07, "sample_throughput": 251.489, "load_time_ms": 0.7, "load_throughput": 4819151.631, "learn_time_ms": 2192.59, "learn_throughput": 1539.276, "update_time_ms": 26.428}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 23.796095085144042, "policy_loss": 0.009430775698274375, "vf_loss": 23.797405433654784, "vf_explained_var": -0.11660963296890259, "kl": 0.004397694278196007, "entropy": 1.0742873787879943, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 9.560138130187989, "policy_loss": -0.016446571797132492, "vf_loss": 9.58778223991394, "vf_explained_var": -0.035514792799949645, "kl": 0.007308817683324117, "entropy": 1.1380464911460877, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 70875, "num_agent_steps_sampled": 212625, "num_steps_trained": 70875, "num_agent_steps_trained": 212625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2835, "training_iteration": 21, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-52-16", "timestamp": 1706107936, "time_this_iter_s": 12.678496599197388, "time_total_s": 281.5526168346405, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6CD9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 281.5526168346405, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.982352941176472, "ram_util_percent": 63.90588235294117, "gpu_util_percent0": 0.04588235294117647, "vram_util_percent0": 0.2201861213235294}}
{"episode_reward_max": 20.163568381245977, "episode_reward_min": -27.246207128545613, "episode_reward_mean": -0.6754686387824844, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.384495020845048, "policy_agent_": -6.890113679740804}, "policy_reward_max": {"policy_adversary_": -3.8859619990389773, "policy_agent_": 24.274031701045516}, "policy_reward_mean": {"policy_adversary_": -13.949252360772318, "policy_agent_": 6.636891860994916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.82300509023424, -14.498480753757379, -6.108556330240594, -2.7606263004551908, 1.2314624249848964, -0.6029041320215754, 0.8764826322269894, 4.9060872625020036, -0.21769496530752808, -13.496675130012632, 4.145943949054157, -1.5360702676905822, -7.6023933553943595, -3.5114496393290446, 0.7845504365545151, -7.603377529968076, -9.378467106249165, 0.7938150100690589, -5.197388469110328, 6.890580980091958, 5.036275611209303, -1.0822660379556084, -3.0056634661276878, -1.6897730374748634, -3.4793566310863326, 4.489668397580535, 6.1207671329381315, 5.540498765146509, -0.1115243336125406, 2.866861926364674, -2.457639946803085, 1.8487036111569466, -6.286480807839787, 2.7615739643759754, -15.046269328861268, -0.05314372165654582, 5.800730503562251, -2.3377225766759393, 2.363059172787594, 7.860577333526782, -7.799432075459373, 0.5339553057179597, -7.177563508179567, 3.2436841906768183, -4.333566417265541, -2.5958084629411013, -4.59116787789584, -6.029143025369648, -3.596493291740611, -11.791330934361085, 1.4574951920784098, -9.099125681076341, 3.1591313994283086, -2.9272584775682002, -1.5659138628687246, 1.183729166913748, 2.032337765646455, -9.475570567970179, 5.38146597944141, 0.88457976992593, -1.8876247912263948, -2.960872606870804, -1.4571640979011011, 4.455972121429946, 20.163568381245977, -3.0741682478698626, 0.6570462204728662, 5.414784071900972, 11.878254478661736, -6.7893534452537985, 6.2540040155626055, -5.99292494789227, 1.6410172850173066, -11.348048463284828, 5.053282975382217, -2.4375969860408593, -1.2131772606008544, 4.543734483606092, 1.8012792427839286, -2.8749401718102394, -2.2598010303931577, -3.999530979427873, 4.387446966708649, 10.386366855172996, 2.384602370676884, -0.02435946258888977, 7.7161905493076395, 6.672861961746027, -1.3959144699430817, 7.396798425445914, 0.08053297283921768, -13.1855592876935, -5.687779618967473, -2.8404792452447207, -2.180769713450354, -9.819147417678643, 1.9739823106094152, -6.830956315650585, 7.071986523316931, 7.823373319660417, 12.519856454587213, -0.4554250727895896, -5.873460851319713, -4.425345919660863, -1.6417257413115691, 10.538397365567672, 2.8618838240777364, -12.148262977862979, 2.3269598732109595, 8.280370211609902, -1.8205855444099444, -9.620731162158489, -10.39110881963805, -4.343995980357217, -10.125945546893698, -6.511812111772825, -6.118680785296931, -0.6002892407284361, 7.092975038399411, -0.14477652311581757, -0.9200559656985625, 9.912078007307883, 8.950974746145295, -0.8872012670808873, -8.588395631958933, -1.3958039403871414, 6.04145117551674, 15.953920605936611, -6.602854090031543, 7.774760870053962, -0.7976191401402319, -27.246207128545613, -1.7515800615751496, -0.5917470320680394, 0.09407423112575361], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-23.331394699466795, -20.734404930797204, -20.89573669391815, -13.15612494034086, -15.809142477595024, -17.60612447821834, -10.673130095970487, -24.74469999552788, -9.209388620562112, -14.6094677765895, -18.49975014265125, -13.130568129548257, -7.386178246781288, -8.339753865596986, -6.965545271262892, -21.06116105987468, -10.002143255359751, -13.705879855939575, -8.650323193620418, -28.350505342347187, -17.21093001882401, -13.366972431701205, -10.114087223647868, -9.545730011311042, -8.865754670395695, -15.48100756665318, -23.62047178551644, -15.11815872153791, -15.279531034252047, -24.15792871679708, -12.242962310539463, -8.638034857891377, -17.672971149213115, -18.650325915991687, -14.448122284250775, -7.563861769826083, -25.996726820665167, -11.482215111198212, -10.463756985799558, -20.824590161757467, -15.06488757468119, -8.655363871069024, -22.43566282146358, -19.393774528210272, -7.284062569359384, -13.685007260326662, -9.929762879535767, -11.048814548586206, -8.438765576127377, -11.204912811433914, -24.163893048588953, -11.33931287602495, -14.886805118532067, -7.986005079326749, -21.606412395176484, -13.053330848856387, -8.838827887590515, -3.8859619990389773, -15.86540551052065, -10.091587241838083, -21.183986984089287, -10.875112065968409, -9.177093310187113, -12.368513592182175, -28.384495020845048, -13.238914619437184, -13.975806295685322, -13.578802065318321, -20.78790665958952, -10.334643201694464, -12.677564923462427, -8.823409211742167, -12.284829951839075, -7.97788013451551, -15.652021102695958, -6.636618415711032, -9.555822275819033, -13.427689329317667, -8.436708559804169, -15.982081638227998, -12.514830089640224, -14.893348688348524, -18.36048600362669, -16.27135578938866, -14.022850283254366, -12.735809466035736, -18.062656308967327, -19.889500596647185, -9.79810240868956, -20.54951754589601, -17.85916051480737, -11.852783733337352, -8.418456590356307, -9.519522859183098, -10.252882478211498, -18.047604355431666, -16.132761066425886, -9.217069859827474, -20.024640135581713, -13.790128931319837, -21.308643741447835, -16.127672287995004, -6.163503905767273, -7.5878221073764855, -11.746623341075573, -22.73019913415584, -10.702182812881851, -10.014139377848075, -14.168947876633947, -14.115475656706035, -7.59831233458634, -10.69901780148419, -15.399845469709447, -8.893225649773436, -6.326648745870441, -8.796612977603642, -16.732756608765392, -11.032662103877884, -12.900925948291153, -17.036970145128365, -12.119659530830713, -18.321622199910955, -20.11621011540899, -10.240147103713458, -7.224659562278397, -13.132155375120986, -20.241127526220332, -27.191377598615595, -10.469321261874876, -17.446148550037638, -11.554300025294843, -13.465979769063994, -7.698093596699085, -5.8728685084795, -13.93572382460147], "policy_policy_agent__reward": [15.077199894850516, 15.077199894850516, 3.1179620885199153, 3.1179620885199153, 7.3935901818387775, 7.3935901818387775, 5.197749319942834, 5.197749319942834, 8.520302451289957, 8.520302451289957, 8.501610173098385, 8.501610173098385, 5.774806364098737, 5.774806364098737, 14.825393629014943, 14.825393629014943, 4.495846827627293, 4.495846827627293, 0.5563963232884357, 0.5563963232884357, 11.322847045852704, 11.322847045852704, 5.797248930928839, 5.797248930928839, -0.1081075543065374, -0.1081075543065374, 2.4141521131339703, 2.4141521131339703, 3.8750478539087045, 3.8750478539087045, 6.728891764953304, 6.728891764953304, 0.31183807455529156, 0.31183807455529156, 7.249847433004317, 7.249847433004317, 1.7264673622550455, 1.7264673622550455, 17.620543161219576, 17.620543161219576, 11.123602815016657, 11.123602815016657, 6.142353196872795, 6.142353196872795, 3.554211878760091, 3.554211878760091, 3.92797848691809, 3.92797848691809, 2.6931990196546827, 2.6931990196546827, 9.98533798211686, 9.98533798211686, 14.870619459227287, 14.870619459227287, 10.32932874334221, 10.32932874334221, 7.584003350319755, 7.584003350319755, 13.51239532158088, 13.51239532158088, 4.8926611818681875, 4.8926611818681875, 5.243369234524161, 5.243369234524161, 5.693245170686662, 5.693245170686662, 10.705949940183832, 10.705949940183832, -0.29907352230524814, -0.29907352230524814, 3.7553590240847687, 3.7553590240847687, 15.898728662113712, 15.898728662113712, 4.572246267261135, 4.572246267261135, 6.413408079293573, 6.413408079293573, 14.34258374764212, 14.34258374764212, 3.6327277496109085, 3.6327277496109085, 4.59465958839349, 4.59465958839349, 7.629049656642004, 7.629049656642004, 11.318729359443545, 11.318729359443545, 1.4752480760469224, 1.4752480760469224, 5.544599398692781, 5.544599398692781, 2.6692975008199644, 2.6692975008199644, 2.5098357616082794, 2.5098357616082794, 2.4211361421933817, 2.4211361421933817, -0.2932090614635831, -0.2932090614635831, 12.810694120333677, 12.810694120333677, 1.120093597474304, 1.120093597474304, 9.02296825898019, 9.02296825898019, 2.529373300879275, 2.529373300879275, 10.020249266153877, 10.020249266153877, 7.118530007885069, 7.118530007885069, 5.435582826618486, 5.435582826618486, -2.794804284465603, -2.794804284465603, 10.623435744981029, 10.623435744981029, 5.488083505882005, 5.488083505882005, 9.648181096431447, 9.648181096431447, 3.9571197295488036, 3.9571197295488036, 3.8599646061430066, 3.8599646061430066, 8.412242856806058, 8.412242856806058, 24.274031701045516, 24.274031701045516, 5.082373185783662, 5.082373185783662, 7.316426258079094, 7.316426258079094, 9.496793068609643, 9.496793068609643, 16.333080569125627, 16.333080569125627, 1.7726448782203323, 1.7726448782203323, 9.465784469512517, 9.465784469512517, 1.415242131924948, 1.415242131924948, 6.96292361842819, 6.96292361842819, -1.685084164384659, -1.685084164384659, 10.352652039039086, 10.352652039039086, 2.0995107148350853, 2.0995107148350853, 4.17132250760909, 4.17132250760909, 8.985711906461885, 8.985711906461885, 5.118993901294051, 5.118993901294051, 6.55357073320888, 6.55357073320888, 5.127514529623533, 5.127514529623533, 5.446908854460326, 5.446908854460326, 11.373966485167673, 11.373966485167673, 13.328861322280828, 13.328861322280828, 8.203726326965622, 8.203726326965622, 6.355725001723423, 6.355725001723423, 12.88942342913749, 12.88942342913749, 13.281181279196602, 13.281181279196602, 4.20109396937324, 4.20109396937324, 13.97315798567096, 13.97315798567096, 8.969846743823293, 8.969846743823293, -0.6663877771780735, -0.6663877771780735, 1.365338485694416, 1.365338485694416, 3.3395218069691888, 3.3395218069691888, 4.036056382380573, 4.036056382380573, 4.114228468876511, 4.114228468876511, 9.053371688517654, 9.053371688517654, 1.193056772088445, 1.193056772088445, 13.548313329449325, 13.548313329449325, 10.80675112549013, 10.80675112549013, 16.914250098017526, 16.914250098017526, 7.836123607602707, 7.836123607602707, 0.14502152722377842, 0.14502152722377842, 1.581238093857809, 1.581238093857809, 5.052448799882001, 5.052448799882001, 16.634298249861754, 16.634298249861754, 6.78203331847979, 6.78203331847979, -1.0670618000074517, -1.0670618000074517, 8.24795387492245, 8.24795387492245, 11.197922934157967, 11.197922934157967, 2.888863395088198, 2.888863395088198, 0.5391433196628489, 0.5391433196628489, 2.5043683250356965, 2.5043683250356965, 2.2746148347081077, 2.2746148347081077, -1.89964840051163, -1.89964840051163, 1.142400432915407, 1.142400432915407, 5.307037911734228, 5.307037911734228, 5.216186431574725, 5.216186431574725, 9.996950493345281, 9.996950493345281, 8.446096811006274, 8.446096811006274, 5.599801782566074, 5.599801782566074, 14.116850103609421, 14.116850103609421, 14.533592430777148, 14.533592430777148, 4.6764729183162865, 4.6764729183162865, -0.6818680348402691, -0.6818680348402691, 5.868175717366923, 5.868175717366923, 13.141289350868535, 13.141289350868535, 21.572649102276106, 21.572649102276106, 1.9332335859216694, 1.9332335859216694, 12.610454710045795, 12.610454710045795, 5.378340442577303, 5.378340442577303, -6.890113679740804, -6.890113679740804, 2.9732567675619683, 2.9732567675619683, 2.640560738205731, 2.640560738205731, 7.0148990278636125, 7.0148990278636125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33992811049996885, "mean_inference_ms": 2.247818204141341, "mean_action_processing_ms": 0.09722734634505648, "mean_env_wait_ms": 0.5926828640351272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 74250, "timesteps_this_iter": 0, "agent_timesteps_total": 222750, "timers": {"sample_time_ms": 13371.067, "sample_throughput": 252.411, "load_time_ms": 0.601, "load_throughput": 5619155.287, "learn_time_ms": 2195.547, "learn_throughput": 1537.202, "update_time_ms": 26.126}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 22.293409729003905, "policy_loss": 0.007763977465219796, "vf_loss": 22.296146392822266, "vf_explained_var": -0.0819581151008606, "kl": 0.0024374372900206275, "entropy": 1.0501044034957885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 10.144546604156494, "policy_loss": -0.021796384593471885, "vf_loss": 10.177568721771241, "vf_explained_var": -0.03564737439155578, "kl": 0.0060168655714060715, "entropy": 1.1376131892204284, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 74250, "num_agent_steps_sampled": 222750, "num_steps_trained": 74250, "num_agent_steps_trained": 222750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2970, "training_iteration": 22, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-52-29", "timestamp": 1706107949, "time_this_iter_s": 12.986837148666382, "time_total_s": 294.5394539833069, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E06C03C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 294.5394539833069, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 31.00625, "ram_util_percent": 63.87499999999999, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.22332763671875}}
{"episode_reward_max": 15.97634197741463, "episode_reward_min": -17.80408066586196, "episode_reward_mean": 0.133126276629984, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.887089969688144, "policy_agent_": -4.4386855923082}, "policy_reward_max": {"policy_adversary_": -4.3725101158503605, "policy_agent_": 23.431715973551388}, "policy_reward_mean": {"policy_adversary_": -13.800993777203077, "policy_agent_": 6.967060026916531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6490754863757404, 3.077165486451556, 11.495575726830767, 2.6767782216867357, -2.575042115678262, -8.829718298929206, 0.46362747680223615, -3.0624825165407144, -1.5308163902501917, 3.2101199339822566, 2.913355405133077, -8.124651929382681, 6.081044870197187, 0.5769812017832094, -2.6930032410986136, -7.345998162736561, -7.16456608939138, -7.664584761040001, 2.0811698210221192, -1.0736996833895944, -1.1134134082976195, 2.411693304997854, 1.352479415683521, 5.948770594508282, 4.190506149566371, -1.689761213405536, 5.459504133633697, 1.6676229484853087, 7.621604745965471, -1.28600838252722, -1.1806879565756967, -1.8045507949582338, 0.5882480356174089, -0.05972185914821271, -7.73304299842464, -5.526672144698157, -17.80408066586196, -4.466416586501591, -4.637948977470131, 0.44674200570345524, -1.8762484683728033, 3.1708250235612896, -10.645963588998585, 12.256407021053878, 9.37644711627555, -0.5780403123455295, 4.072304340432343, 1.2518637293485948, 11.65480225822707, 0.835573822883304, 6.466788881239801, 2.5452990363584482, -4.924279424153126, 2.8880866172602877, 7.181059356440193, -4.009621378989232, 12.852103843344283, -2.739219010639165, -2.7773546689664297, 8.344365904957002, 0.09305936057704636, -2.159568436576732, -0.27300829477417765, -0.48698710347625146, 3.2759657591345634, 3.6579997237646036, 15.97634197741463, -0.42845730868936305, -3.2382893190280906, -0.25149246931365377, 1.4944123454224585, -1.0908970070054396, -2.859759464662717, 0.3352996417697088, 1.1408232648648597, -3.6534250490719864, 10.914475297003163, 2.9628205865979624, 6.941104655849456, 5.190676275676616, -1.5121183674933374, -0.665379976264597, 0.6105134959370293, -3.625122308386481, -0.385324032692254, 11.177867468677379, 4.324420615697965, -2.916116542119939, 2.1852168910044845, 3.238803450866648, 4.165174834105522, 1.5450503619987683, -9.629228760651655, 6.029781428271737, 1.4328019096940032, -5.430066113756735, 5.78612225035404, -3.252971273878131, 0.44401336359850596, 5.074706995550123, -0.42491503942980985, -4.772925633037541, 2.3199204600315397, 2.391586135510094, -12.924307171235577, -10.411408147240852, -12.280786376274092, -3.0723604006879244, 0.8471372387883193, -8.788013673920037, -4.845744656940596, 11.06566736089144, -4.112959796216502, -3.1741929334604895, 10.75267344503331, -3.28126886286792, -7.698778643246824, 0.043191337636274814, 9.830705122409476, -11.320216425833479, -0.8591197885687121, -1.436639739592453, 12.615236523394568, 3.8469701886399017, -9.439064360281991, 2.064236444539009, -8.037261794662182, 0.8446982404249866, -3.056130698057372, -2.1405016862783657, 0.879459162556998, -2.371505397298596, -5.137486927920473, 2.022832866968668, 5.301834930999565], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.376659254957632, -11.103256367345963, -24.31310928531238, -13.339883570857632, -6.843959898314344, -9.297822208333136, -23.383566258008525, -19.803101276780176, -6.9944633933704035, -16.85056294159034, -16.077199140075923, -10.562550844353384, -14.49971017972191, -13.045511223304368, -8.706679077381223, -8.696746576992302, -9.842989438932335, -5.8100889704861185, -18.90097831953631, -7.688145311994639, -7.106179835553683, -9.473922401359406, -13.37960132475798, -18.29033041925141, -14.548955612756892, -14.123005308114799, -14.562713271549677, -24.691960400502293, -14.841408295401726, -11.787952973158188, -12.95781688104645, -19.604446276468206, -19.601750648697838, -16.045263198789314, -5.2184847383482555, -9.01175972318681, -8.926709481245547, -14.83806540608796, -10.628432226153201, -6.332164630426918, -11.39436689929092, -10.386937241622226, -15.29773427659491, -18.357674528970332, -21.308743026906296, -20.659134002291907, -15.9652450424046, -7.734055571373874, -20.472942129100947, -11.83270965827598, -20.743105907298958, -16.148178166920886, -24.156364507486412, -11.674437845377113, -15.284593225921522, -10.829173871618025, -25.597143882787265, -11.529727825619274, -15.449520810106776, -23.535165259826574, -10.215285197707509, -12.74928770055483, -7.3396009661898916, -12.135539528238674, -15.080277624075313, -21.3062291103574, -30.887089969688144, -11.655470721582333, -15.010628553086585, -13.37105903340102, -8.228564403484476, -11.254301490689459, -6.879184715252327, -12.408918524877706, -13.28914298157634, -6.5245301782878515, -16.84524460776366, -10.778663432243347, -18.023953440065277, -12.564188971463722, -9.161334526819083, -14.142417796742288, -9.193002381079458, -8.92928913164371, -7.933691679245784, -16.883860282296123, -19.47920032669035, -8.596693924135575, -6.724980503033643, -18.746376559572944, -14.556036145570943, -9.974404591380976, -11.174978057611805, -15.563527709144344, -8.47543294195363, -9.161932639669356, -16.459664826832093, -12.423681685862855, -9.368852134713846, -14.756437864304154, -14.221347648250974, -29.974773093584965, -13.046049808122406, -16.01901158612003, -13.523455367362589, -11.217739402177012, -12.81625939110223, -7.170674960282211, -27.167339486479747, -5.03208912549367, -10.342195687888527, -24.585484417119417, -6.0119280655052325, -4.3725101158503605, -20.862776961041426, -19.387983344418075, -10.116743780470786, -13.485419100328752, -15.04929585330044, -14.94745872181514, -9.615218767762011, -9.844799185158507, -21.279022559050162, -17.605004768328527, -16.771070397637235, -8.4801927862369, -16.317538629354715, -8.37589430876061, -10.726781886019216, -6.524134621698838, -16.45630752683747, -6.596121178656255, -17.004989849572823, -23.689875564183044, -23.778854847255946], "policy_policy_agent__reward": [4.363791884290945, 4.363791884290945, 7.09021092689876, 7.09021092689876, 17.90434250607158, 17.90434250607158, 8.00833089627218, 8.00833089627218, 2.1344588913180416, 2.1344588913180416, 0.23405195470196766, 0.23405195470196766, 11.923596867405381, 11.923596867405381, 8.37030938011973, 8.37030938011973, 2.7318235015601067, 2.7318235015601067, 10.030341437786298, 10.030341437786298, 9.495277272604502, 9.495277272604502, 1.2189494574853492, 1.2189494574853492, 10.290377524959549, 10.290377524959549, 6.811246212543787, 6.811246212543787, 3.0068379181413043, 3.0068379181413043, 0.6753742071278697, 0.6753742071278697, 1.3392116747704756, 1.3392116747704756, -0.9272478952769425, -0.9272478952769425, 10.491074070279222, 10.491074070279222, 3.307222814302522, 3.307222814302522, 2.9963832136280333, 2.9963832136280333, 5.942807853178629, 5.942807853178629, 7.366040370220749, 7.366040370220749, 12.119550506879852, 12.119550506879852, 9.36973088116163, 9.36973088116163, 6.216622047354633, 6.216622047354633, 10.011108702591686, 10.011108702591686, 13.179791674493806, 13.179791674493806, 11.231506520683599, 11.231506520683599, 5.250972295315482, 5.250972295315482, 5.888564462235378, 5.888564462235378, 8.899947740754985, 8.899947740754985, 10.09499934215762, 10.09499934215762, 7.992770669820549, 7.992770669820549, -1.2572791300381918, -1.2572791300381918, 1.7425437892443265, 1.7425437892443265, -4.4386855923082, -4.4386855923082, 5.185824409793187, 5.185824409793187, 2.995241624341536, 2.995241624341536, 3.3894533180651853, 3.3894533180651853, 4.759059215459059, 4.759059215459059, 6.778881132591758, 6.778881132591758, 2.3258853437981575, 2.3258853437981575, 15.307040775012107, 15.307040775012107, 15.342595071590925, 15.342595071590925, 10.040546844973193, 10.040546844973193, 10.018774691418475, 10.018774691418475, 4.492959650361234, 4.492959650361234, 16.063872193664015, 16.063872193664015, 6.334141740579641, 6.334141740579641, 13.604947394269379, 13.604947394269379, 9.346738601639663, 9.346738601639663, 9.61604254166664, 9.61604254166664, 7.2812622313187, 7.2812622313187, 11.232826291180862, 11.232826291180862, 3.4097762463143977, 3.4097762463143977, 19.22462386306577, 19.22462386306577, 4.395254407490052, 4.395254407490052, 6.336083070570172, 6.336083070570172, 15.939765582391786, 15.939765582391786, 5.154172279142276, 5.154172279142276, 5.294859631989052, 5.294859631989052, 3.533296335707856, 3.533296335707856, 5.82427621238121, 5.82427621238121, 9.178121691604941, 9.178121691604941, 12.482114417061005, 12.482114417061005, 23.431715973551388, 23.431715973551388, 5.613506706446486, 5.613506706446486, 5.886169617029248, 5.886169617029248, 6.559783282043681, 6.559783282043681, 4.861488374453468, 4.861488374453468, 5.081702241842012, 5.081702241842012, 2.0097126252948043, 2.0097126252948043, 6.372109083323707, 6.372109083323707, 7.2149831232206, 7.2149831232206, 1.4355525646079335, 1.4355525646079335, 13.879859952383415, 13.879859952383415, 6.870742009420654, 6.870742009420654, 12.482529047957367, 12.482529047957367, 8.87743262357017, 8.87743262357017, 3.8246080796628723, 3.8246080796628723, 6.738518910238846, 6.738518910238846, 4.9017579385082435, 4.9017579385082435, 2.652083411628615, 2.652083411628615, 3.774183823276764, 3.774183823276764, 14.03086387548675, 14.03086387548675, 11.90181047119416, 11.90181047119416, 2.840288691007818, 2.840288691007818, 4.455098697019064, 4.455098697019064, 10.992590005219794, 10.992590005219794, 9.360605489838232, 9.360605489838232, 5.7597274766898705, 5.7597274766898705, 0.7728746484800765, 0.7728746484800765, 10.796654568708044, 10.796654568708044, 4.954117425823817, 4.954117425823817, 1.8659332629563123, 1.8659332629563123, 11.12289353859307, 11.12289353859307, 4.585355205992361, 4.585355205992361, 4.906432749156179, 4.906432749156179, 9.915572429927138, 9.915572429927138, 6.898216304410584, 6.898216304410584, 12.600923730273712, 12.600923730273712, 7.682985134076971, 7.682985134076971, 9.205298860815065, 9.205298860815065, 0.29957409806350604, 0.29957409806350604, 0.40316562746807894, 0.40316562746807894, 0.2677365074140695, 0.2677365074140695, 2.0491572797971433, 2.0491572797971433, 14.007238362634032, 14.007238362634032, -1.8779622742131838, -1.8779622742131838, 2.748225515473963, 2.748225515473963, 17.825575889005428, 17.825575889005428, 0.9494841346443648, 0.9494841346443648, 0.599158591194936, 0.599158591194936, 15.807725203037366, 15.807725203037366, 8.053357240775076, 8.053357240775076, 1.208982568611982, 1.208982568611982, 6.764305218982512, 6.764305218982512, 12.44000048785496, 12.44000048785496, 1.813621147990827, 1.813621147990827, 4.378049489596647, 4.378049489596647, 4.204079722783026, 4.204079722783026, 16.94712954122237, 16.94712954122237, 10.725987478484212, 10.725987478484212, 3.666003018677624, 3.666003018677624, 5.272214615387955, 5.272214615387955, 4.140138417346265, 4.140138417346265, 4.610296274592797, 4.610296274592797, 3.835325593980921, 3.835325593980921, 2.191816467710236, 2.191816467710236, 8.667883344697232, 8.667883344697232, 2.1123078906788284, 2.1123078906788284, 5.933751460826174, 5.933751460826174, 12.85635421557586, 12.85635421557586, 14.54034488912775, 14.54034488912775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3441902328152363, "mean_inference_ms": 2.2781635266194016, "mean_action_processing_ms": 0.09852099136716941, "mean_env_wait_ms": 0.5989751691233755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 77625, "timesteps_this_iter": 0, "agent_timesteps_total": 232875, "timers": {"sample_time_ms": 13782.034, "sample_throughput": 244.884, "load_time_ms": 0.501, "load_throughput": 6738278.751, "learn_time_ms": 2218.525, "learn_throughput": 1521.281, "update_time_ms": 26.024}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 21.709591484069826, "policy_loss": -0.010287081100977957, "vf_loss": 21.730168914794923, "vf_explained_var": -0.05738775730133057, "kl": 0.007161677841302838, "entropy": 1.0291061282157898, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 9.741414737701415, "policy_loss": -0.015741921216249465, "vf_loss": 9.76814432144165, "vf_explained_var": 0.017490994930267335, "kl": 0.006841464389197171, "entropy": 1.1158846855163573, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 77625, "num_agent_steps_sampled": 232875, "num_steps_trained": 77625, "num_agent_steps_trained": 232875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3105, "training_iteration": 23, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-52-46", "timestamp": 1706107966, "time_this_iter_s": 16.732134580612183, "time_total_s": 311.27158856391907, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 311.27158856391907, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 54.83181818181818, "ram_util_percent": 67.05454545454546, "gpu_util_percent0": 0.1109090909090909, "vram_util_percent0": 0.23293235085227273}}
{"episode_reward_max": 14.529131866673211, "episode_reward_min": -14.034690017168503, "episode_reward_mean": -0.8601722136751321, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -32.42059595074695, "policy_agent_": -2.096656903438245}, "policy_reward_max": {"policy_adversary_": -4.519099180931252, "policy_agent_": 23.474863908710088}, "policy_reward_mean": {"policy_adversary_": -13.382454585806897, "policy_agent_": 6.261141186065882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4998957599169871, -3.1320961196740487, -7.280421945440675, -7.503497071004232, -4.8607718625977485, -1.2933474822646525, -2.30653571954426, 0.9300133635053409, 0.13838766923203477, -1.6213242655759916, -2.4138958626182054, 5.630136783312302, 0.6255440114872816, 2.6475764185961133, -3.845386351431533, 3.0558073777723074, 2.501506719285958, -4.674268642425925, 3.3882338391460007, 7.934973211722917, -3.0983093088862117, -3.8769416769634075, -1.4962475729535927, -1.5171924954397, -3.2401080662803174, -3.609089933230318, -11.82243220983658, 5.4838332579898115, 4.943304645530989, 3.7120334934612784, -3.9027618521517526, 3.3256077417802747, 14.529131866673211, 7.300406174563401, -10.570041371036464, -3.3290973274337285, -10.523562670205397, -3.2399725665195813, 5.551572297447162, 4.1909205542029, 1.0780638109049898, 5.524220724183844, 2.8142305045596108, 8.303238059285581, 3.167549144846231, -8.199248782885839, -1.0304975578067657, 0.9904555632359662, 2.079829960185395, 4.694817444681356, 6.887830982086507, -1.678433742849081, 4.55318441354204, -3.566961296081246, -11.802264580166558, 5.256708055885328, -8.718063053746224, -5.736444268922833, 3.348854623155577, 9.334408207001156, 5.226698103462575, -6.79693988584157, 0.18211818314692757, -6.003104996723906, -6.125114429485703, -7.22655869135656, -0.07580751860840818, -0.7793138675635762, 5.856564041624157, -0.32373677449045823, -5.1232972682147935, -4.697469092742142, -4.917013428032959, -7.240043956619651, -10.731697749455643, 1.8518963903760393, -11.44071482824988, -3.905557545324388, 4.254433567735056, 4.174284843426133, 3.848493490347819, 0.6622593020837755, -3.9191274033806565, -10.393239679025601, -2.7397151849349397, -5.012498451792981, 4.000146926467006, 2.330493047986024, 0.6153177902762914, -3.9890166252498553, -4.31933946826557, -14.034690017168503, -2.5225116086976733, -5.081266738578962, -7.167808905001769, 0.45411097644661025, -3.9569945598856906, 1.1996708733615524, -6.277194200387496, 9.502816341900813, 1.0354090380556704, 0.8903725746774631, 0.54112531629618, -3.945369238975215, 8.24684961345502, 5.455240206589416, 2.2918803680117605, 3.7657977289485034, 0.03741103966470086, 4.372711008308944, 6.205791001170565, 5.055016125100258, -0.36634033221813267, -5.357997982017385, -2.55860316252049, 1.0559800892037765, -2.0911445289507573, 0.30220296918463685, -1.1074014306757962, -0.16664079579236465, -3.9793943503966873, 2.790323147719949, -10.398081341135558, -3.575320209830427, -2.002568054969971, 2.7231503988220083, -0.2561310252266795, 0.3523448336947954, -1.4707155523091053, 1.4290630556637305, 2.2544314253255555, -2.9299546061544635, -1.2348556628897562, -5.04177636919767, -12.338646169543738], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.73801924896165, -18.84391756202081, -13.743464781846173, -7.050594674822852, -6.627917181331452, -17.78349820953889, -16.887076256942056, -11.995636545794433, -17.077523980717476, -10.868278371338103, -18.94077431332717, -17.386498972085015, -19.595901650861926, -12.263898641826847, -12.815641768749643, -10.214511599888965, -9.907463448225567, -18.498462113012966, -19.925724335028054, -15.561847743037728, -10.026520630404345, -4.519099180931252, -10.102285570999065, -5.1954908452666535, -12.663831791136115, -16.82937520974422, -7.629118402960097, -16.383818663403318, -18.0470403360379, -9.103358587017961, -6.070189218341022, -9.614418386486578, -32.42059595074695, -20.477908496127288, -17.26899372108413, -10.95165822539306, -26.121822073838366, -5.688894988229967, -14.391577931371147, -9.09575728849091, -13.308106997833184, -13.005694479164953, -11.473054810271453, -21.988649036386672, -8.876582802337513, -7.799416021164851, -6.730508595579444, -7.2253670605266445, -13.013780805313022, -15.522519580578006, -17.566807724010648, -13.822558315774256, -17.42337220120249, -11.224330683151509, -8.705366869732503, -23.23924284717702, -16.416411271766012, -10.413144647773978, -20.65400278115226, -16.67063609777678, -12.502298378180415, -8.018025108626817, -15.187347005139822, -8.599794458479133, -6.621546143055132, -23.835413383282358, -18.587299268804873, -11.701204644546088, -15.371379007967587, -8.969069488249557, -12.41114150011776, -16.04200173769598, -6.734084904847279, -7.259647032408196, -10.055911108534229, -14.95928427639575, -15.938640681827781, -7.154355213098918, -15.53180415420994, -16.539327311047465, -10.41149192937884, -10.160742725895194, -13.430721914609663, -26.194228775707668, -10.543420789367904, -9.262843553802671, -18.92539493463837, -6.981572804752296, -18.272935529962773, -16.85746729778442, -9.855754214974562, -10.986061881067625, -7.419905587914676, -15.146004268728737, -8.671878501668573, -20.54868197701445, -7.112606176632063, -7.307618792236687, -15.25293386209955, -18.131702314119693, -10.322500954325955, -18.443602051594013, -16.21050084705787, -15.615086774670804, -17.207574517068277, -14.548307931098226, -17.244408081719346, -12.684564647197206, -9.73817127739336, -23.977422794591053, -20.779189968589908, -11.94023869864626, -7.609518348059345, -18.30352083170993, -14.511035329965637, -11.11203362856335, -10.127658391294492, -6.443876980053411, -11.32507078956414, -13.299716983238069, -9.936248132300285, -7.8172687626644795, -17.076120127733162, -12.15851328320944, -11.155354495721001, -7.711277873286467, -7.701814390269362, -14.215116435158063, -16.387975983425278, -17.391163818266808, -13.32781657658689, -10.004023953336754, -7.822661584536791, -18.967251950142554, -16.613258725980394], "policy_policy_agent__reward": [5.118957504439321, 5.118957504439321, 7.8559107211733785, 7.8559107211733785, 3.2315214182027505, 3.2315214182027505, -0.2264511980906906, -0.2264511980906906, 0.8835726593668519, 0.8835726593668519, 8.245075363637119, 8.245075363637119, 7.2902702686988965, 7.2902702686988965, 6.462824954649885, 6.462824954649885, 8.607955824974757, 8.607955824974757, 4.623477052881056, 4.623477052881056, 8.263439225354485, 8.263439225354485, 11.508317877698662, 11.508317877698662, 10.110722831174602, 10.110722831174602, 7.455737530211479, 7.455737530211479, 4.485127708659056, 4.485127708659056, 6.635159488830634, 6.635159488830634, 6.20448508375576, 6.20448508375576, 6.912096735293521, 6.912096735293521, 11.656979087087029, 11.656979087087029, 11.748410477380322, 11.748410477380322, 3.464105660759068, 3.464105660759068, 0.3210787519839218, 0.3210787519839218, 4.303018999022736, 4.303018999022736, 1.8391491749134765, 1.8391491749134765, 4.711861862427898, 4.711861862427898, 6.610142638256954, 6.610142638256954, -2.096656903438245, -2.096656903438245, 10.933825960696572, 10.933825960696572, 11.495172490784444, 11.495172490784444, 6.40769604023962, 6.40769604023962, 1.0837136830946357, 1.0837136830946357, 6.470013064133428, 6.470013064133428, 23.474863908710088, 23.474863908710088, 13.889157335345342, 13.889157335345342, 3.34947617502383, 3.34947617502383, 3.811280448979666, 3.811280448979666, 7.799129701816487, 7.799129701816487, 1.2244612108551929, 1.2244612108551929, 9.971575114409156, 9.971575114409156, 6.6433389213469045, 6.6433389213469045, 7.193085404369084, 7.193085404369084, 9.264957601674402, 9.264957601674402, 7.143642657415532, 7.143642657415532, 15.145943547836126, 15.145943547836126, 6.022065973591873, 6.022065973591873, -0.19991638086049476, -0.19991638086049476, 2.850005518886339, 2.850005518886339, 4.107911311881306, 4.107911311881306, 7.54680538274921, 7.54680538274921, 10.108668512629675, 10.108668512629675, 12.22731935304858, 12.22731935304858, 6.072062286462586, 6.072062286462586, 10.988278307372264, 10.988278307372264, 3.8286846935351315, 3.8286846935351315, -1.5484488552170301, -1.5484488552170301, 14.247975451531177, 14.247975451531177, 3.8491741090098923, 3.8491741090098923, 2.3383501894255723, 2.3383501894255723, 12.00142870215392, 12.00142870215392, 13.002522152388966, 13.002522152388966, 8.864498240821497, 8.864498240821497, 0.6105426113926244, 0.6105426113926244, 7.684732594143374, 7.684732594143374, 1.2983447308776137, 1.2983447308776137, 0.24821585678471347, 0.24821585678471347, 8.304427345962896, 8.304427345962896, 9.25574587509823, 9.25574587509823, 5.460945388491256, 5.460945388491256, 10.61397152479587, 10.61397152479587, 4.322666356879548, 4.322666356879548, 3.643922115951483, 3.643922115951483, 5.672266322476922, 5.672266322476922, 0.9085357384071602, 0.9085357384071602, 0.009801537894271628, 0.009801537894271628, -0.33789332046070536, -0.33789332046070536, 8.405590333385897, 8.405590333385897, 2.248962926788954, 2.248962926788954, 1.6243988338872648, 1.6243988338872648, 9.8931188609725, 9.8931188609725, 10.356806077236802, 10.356806077236802, 7.1299927098633304, 7.1299927098633304, 5.411501013989483, 5.411501013989483, 4.755797255614502, 4.755797255614502, 7.900494548341033, 7.900494548341033, 3.901852802216482, 3.901852802216482, 2.125172551004844, 2.125172551004844, 11.462770930552688, 11.462770930552688, 4.65603292636916, 4.65603292636916, 9.44412666011953, 9.44412666011953, 6.434225336267278, 6.434225336267278, 2.7682073733544947, 2.7682073733544947, -1.5243140680504403, -1.5243140680504403, 2.4486969896085005, 2.4486969896085005, 5.032368765074883, 5.032368765074883, 0.752034798333403, 0.752034798333403, 10.50139647673053, 10.50139647673053, 1.577805808373185, 1.577805808373185, 4.25364483279912, 4.25364483279912, 4.487869830856027, 4.487869830856027, 13.817259328010255, 13.817259328010255, 5.678954996190813, 5.678954996190813, 9.666987313135738, 9.666987313135738, 8.375813081677025, 8.375813081677025, 5.834858767847797, 5.834858767847797, 12.727212065261647, 12.727212065261647, 10.001774068843815, 10.001774068843815, 9.768144224865551, 9.768144224865551, 8.225181188072856, 8.225181188072856, 4.887791158529033, 4.887791158529033, 14.175066901449998, 14.175066901449998, 13.492490484880234, 13.492490484880234, 8.497627411873257, 8.497627411873257, 3.6215890079206057, 3.6215890079206057, 6.47276142484627, 6.47276142484627, 5.976216083722575, 5.976216083722575, 6.084006858883565, 6.084006858883565, 4.018256931171867, 4.018256931171867, 3.373039974619024, 3.373039974619024, 5.10883467944417, 5.10883467944417, 6.56653809372285, 6.56653809372285, 2.9784268909518, 2.9784268909518, 5.3037959551922125, 5.3037959551922125, 3.3390193932988033, 3.3390193932988033, 4.291596536689507, 4.291596536689507, 4.576393220375515, 4.576393220375515, 5.217214136054239, 5.217214136054239, 3.7228416825213415, 3.7228416825213415, 7.283730634426428, 7.283730634426428, 7.458630215558086, 7.458630215558086, 9.410113436965268, 9.410113436965268, 7.7911240009562235, 7.7911240009562235, 3.537034673591145, 3.537034673591145, 3.2939029608235186, 3.2939029608235186, 6.9627377904724455, 6.9627377904724455, 2.1373062782183294, 2.1373062782183294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3463041413165721, "mean_inference_ms": 2.2868984436529405, "mean_action_processing_ms": 0.09886453766489595, "mean_env_wait_ms": 0.6005659115048277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 81000, "timesteps_this_iter": 0, "agent_timesteps_total": 243000, "timers": {"sample_time_ms": 13975.389, "sample_throughput": 241.496, "load_time_ms": 0.501, "load_throughput": 6738278.751, "learn_time_ms": 2202.367, "learn_throughput": 1532.442, "update_time_ms": 25.924}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.498802947998048, "policy_loss": -0.004301490490615833, "vf_loss": 20.51335754394531, "vf_explained_var": -0.13207194805145264, "kl": 0.003912760887236711, "entropy": 1.0253475308418274, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.4919360160827635, "policy_loss": -0.010065010469406842, "vf_loss": 7.51278715133667, "vf_explained_var": -0.071206933259964, "kl": 0.006478128559481111, "entropy": 1.0948186278343202, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 81000, "num_agent_steps_sampled": 243000, "num_steps_trained": 81000, "num_agent_steps_trained": 243000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3240, "training_iteration": 24, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-53-00", "timestamp": 1706107980, "time_this_iter_s": 14.436431884765625, "time_total_s": 325.7080204486847, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FA4550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 325.7080204486847, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.93333333333334, "ram_util_percent": 65.73888888888888, "gpu_util_percent0": 0.07611111111111112, "vram_util_percent0": 0.2273627387152778}}
{"episode_reward_max": 22.135266172987368, "episode_reward_min": -22.38729462283285, "episode_reward_mean": -0.5303358527117964, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.81242741582229, "policy_agent_": -4.22781747410991}, "policy_reward_max": {"policy_adversary_": -3.319821613727283, "policy_agent_": 25.973846794404825}, "policy_reward_mean": {"policy_adversary_": -13.602995837036586, "policy_agent_": 6.536329992162394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.3416679939597878, 3.2224727287305996, -6.415957109251668, -13.098439902688186, -2.4036327472770003, 0.655206292942426, 5.9278164946806085, 1.8234685863837412, 2.9351616021239684, 8.209010760160764, 1.2044824172816777, -0.6602010750968618, 4.63612854726265, 2.594648992528854, -4.132300214600057, -6.746255792191845, 15.158404149647493, 15.938959697647075, -2.9808798427485064, -3.4862352375459715, -3.844027201586604, -7.339754464779939, 4.012545825067753, -6.513207919118109, -8.828656095226535, 1.934548533526476, 0.2762334782675387, -5.07938954985951, 5.311064786638225, -4.714588707978959, 0.15259821403954027, -7.431964158183698, 1.5399122108503471, 0.6252833133640656, -0.6561250392707312, -6.618560286265645, 5.898760540512975, -7.31837205324824, -8.987116290608107, -4.457026850383047, 1.9802782396350356, 0.12228239068724289, -0.23344343819657654, 5.220995486950843, 4.039276436733203, -0.8987888465846096, 2.983576451352155, -0.46693987749292254, -9.911487667250553, -1.014338808556334, 2.8777096361189467, -3.116300394477638, 5.0259160331441635, 4.320140795335037, -3.51818649966815, -11.662962580203173, 6.331338097319495, 3.642294848263866, 0.9186951896763946, 4.5661569816257535, 1.419703802181238, 22.135266172987368, 7.451105533100294, 3.6553707722582494, 12.661551260558102, 0.1522492422423194, -13.697477209606213, 1.0094222644721418, -7.167726822619385, -2.1016167990695416, -1.6443190347098873, -2.0190292029576815, 4.625866617347008, 2.2935102884810536, 8.541180428216819, -22.38729462283285, -6.655672860647253, 2.7904692187377673, 7.85246341475473, -4.427526911474177, 1.182145239365388, -13.410976534691583, -10.061019479359278, -9.146826622978761, 0.7190418562032748, -0.8068261094839282, 0.8328645567004691, -2.7755010426481013, -11.155696254868504, -7.493039150998008, -0.26719492620720964, -3.645349446258486, -0.30510929778549745, -0.034203441557916325, -2.4768785497908494, 2.739653537456536, 4.1933477468678575, 1.3408637942197483, 1.4971398748704983, 10.670321597532833, 1.7824069149819826, 5.980891341783058, 3.605372557539848, 2.015881227663623, 4.874058974279392, -6.912677167798601, -4.868410365903351, 6.023000109044958, -3.2581683058939097, 9.920091921444946, -16.56342435350723, -6.76006412874631, -2.57839294168343, -0.20724383353789724, -4.710563221430339, 4.150580047887367, -7.475017714486722, 1.9416421592600932, 7.212473095234198, -2.379241925944079, -0.5327032800512892, -1.143099274341914, 5.322515843375922, -9.164708403503132, -2.260952112014196, -12.068264525814902, 22.05828089292458, -9.647085373855793, -1.656055058329298, -11.298294770211976, -6.941511676030673, 0.559248379980993, -2.2798350186183356, 1.378453495381157, 7.992662362620203], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.945684132293946, -19.403166901115018, -10.009472297602636, -8.142714090821231, -9.254533562465573, -19.062729967481648, -21.082679339088752, -9.069119556157855, -14.645559436823211, -17.546681986863998, -10.596160308991943, -3.319821613727283, -16.29361018416983, -16.464786505107725, -16.90725540707921, -13.070260339408964, -21.02225608774347, -27.477285238555687, -7.410942082427866, -19.763202863157794, -8.143094849394934, -13.557889297575013, -13.935335658821888, -8.347946376485849, -11.51114922786001, -13.79750744474447, -9.436005313882815, -12.151358349897636, -12.09243275281525, -8.97641056655472, -12.684706930409563, -22.19417491087593, -10.913879977201391, -10.990564525536948, -8.71242405504489, -7.958497696057337, -20.543128481129955, -16.166781156524614, -10.280278253861585, -15.71432994581264, -16.018034950585776, -14.380804413138222, -13.433605995136231, -14.206143869593898, -11.363603313643072, -9.02098175049176, -12.613875692866952, -6.691128590119359, -15.68610158004899, -9.471905682134645, -18.93629732327634, -11.302701751425639, -12.794468577128384, -16.655083760879954, -11.168774496494715, -17.52372376159634, -17.352701564469037, -12.935771550508314, -9.43633318502434, -11.278400687204588, -9.688130552312588, -29.81242741582229, -14.050958345992266, -14.55293244554119, -25.31417839480672, -8.598489973763728, -5.241842261386407, -11.697265859682972, -16.609917543435355, -6.933561620490643, -8.763050448774754, -8.55100192362385, -15.09092910799279, -10.674693393890907, -15.439009334996804, -14.551925729500246, -16.10222098454983, -8.085062443894723, -13.927063985331143, -18.00085244578106, -14.928845161913891, -22.469279188923764, -16.861027555258786, -15.871881299690878, -7.582665789568221, -6.651331763870037, -13.301755715339938, -13.764681591555835, -17.323297957762186, -10.72844589062, -16.60570109950872, -9.673371882452006, -22.980859028112246, -12.550095953142288, -13.693628670878752, -11.466042720809938, -11.767757343345206, -12.625412667013606, -10.145129609373027, -22.84499402481926, -9.095408816519681, -24.319461789010862, -10.082565297620812, -11.53518794381284, -18.52928386847567, -11.18298443864469, -11.088170625195716, -27.026707012295983, -8.949556477152795, -16.69612410004402, -11.262500701939546, -9.328944106007443, -17.006883923072387, -13.209615183880922, -7.144742065682442, -19.913681425545697, -26.973131679373022, -8.087620433237186, -20.977875682183914, -8.97885802414824, -6.670668813397884, -6.63025810007974, -14.094795116348223, -10.227193167308895, -12.23939514564277, -17.501020348481166, -29.285461537974967, -10.820282943284743, -17.769876488576475, -9.365446979912162, -8.502542973149469, -14.647211809041975, -6.778992871343442, -9.756056131408345, -17.337952687278314], "policy_policy_agent__reward": [2.802008069167079, 2.802008069167079, 11.312819814922806, 11.312819814922806, 1.796757594175486, 1.796757594175486, -2.4778629059334807, -2.4778629059334807, 3.425450407594283, 3.425450407594283, 9.85896813021204, 9.85896813021204, 13.50524791688468, 13.50524791688468, 5.446294071270799, 5.446294071270799, 8.79036051947359, 8.79036051947359, 12.877846373512378, 12.877846373512378, 5.900321363136808, 5.900321363136808, 1.3298102693152103, 1.3298102693152103, 10.464869365716234, 10.464869365716234, 9.529717748818292, 9.529717748818292, 6.387477596239574, 6.387477596239574, 3.1620022736085573, 3.1620022736085573, 18.090330118695483, 18.090330118695483, 21.70812246810138, 21.70812246810138, 2.2150311198396806, 2.2150311198396806, 8.13848381280591, 8.13848381280591, 2.149533823904166, 2.149533823904166, 3.109067416397538, 3.109067416397538, 8.973940741944821, 8.973940741944821, 0.9173692286838694, 0.9173692286838694, 1.341246566316737, 1.341246566316737, 7.866027989135471, 7.866027989135471, 4.856119396075176, 4.856119396075176, 3.5359844000190623, 3.5359844000190623, 8.701748769726741, 8.701748769726741, 2.130910929287883, 2.130910929287883, 6.418652572224553, 6.418652572224553, 7.381105376346116, 7.381105376346116, 6.22689609402587, 6.22689609402587, 5.807923919450506, 5.807923919450506, 4.02814950788708, 4.02814950788708, 0.6699687048958476, 0.6699687048958476, 13.220944510821466, 13.220944510821466, 4.424204551638188, 4.424204551638188, 0.6465809816267425, 0.6465809816267425, 5.628651547714799, 5.628651547714799, 8.999156595110408, 8.999156595110408, 7.25154340191273, 7.25154340191273, 6.600081278469825, 6.600081278469825, 9.71356967827237, 9.71356967827237, 7.701439875188137, 7.701439875188137, 4.061096451953575, 4.061096451953575, 7.7987260721095515, 7.7987260721095515, 3.112094356313219, 3.112094356313219, 2.887306956399214, 2.887306956399214, 4.228783436789154, 4.228783436789154, 10.907003479697643, 10.907003479697643, 4.093200678474002, 4.093200678474002, 8.910192305136274, 8.910192305136274, 10.487612278107493, 10.487612278107493, 3.82529399841328, 3.82529399841328, 2.930380590696584, 2.930380590696584, 11.842019830894264, 11.842019830894264, 8.28903319938609, 8.28903319938609, 5.1775141873503685, 5.1775141873503685, 7.922278834415174, 7.922278834415174, 5.553917177246914, 5.553917177246914, 25.973846794404825, 25.973846794404825, 10.751031939546277, 10.751031939546277, 9.10415160889972, 9.10415160889972, 18.98786482768241, 18.98786482768241, 4.375369608003026, 4.375369608003026, -4.22781747410991, -4.22781747410991, 6.353344062077559, 6.353344062077559, 4.721095360407986, 4.721095360407986, 2.4159724107105496, 2.4159724107105496, 3.5593657070324327, 3.5593657070324327, 3.265986360333084, 3.265986360333084, 9.858397862669896, 9.858397862669896, 6.48410184118598, 6.48410184118598, 11.990094881606812, 11.990094881606812, -3.917684446666301, -3.917684446666301, 4.7232740619512885, 4.7232740619512885, 5.437765831316243, 5.437765831316243, 10.88976370004294, 10.88976370004294, 6.786662767153441, 6.786662767153441, 8.05549520063964, 8.05549520063964, 4.529151327116094, 4.529151327116094, 3.400004037949756, 3.400004037949756, 3.3625273383560597, 3.3625273383560597, 4.150853822885749, 4.150853822885749, 2.9222528271930543, 2.9222528271930543, 7.067310136020204, 7.067310136020204, 5.494590274453867, 5.494590274453867, 3.083800851446846, 3.083800851446846, 1.617703369810994, 1.617703369810994, 8.169253086650757, 8.169253086650757, 3.014011218096762, 3.014011218096762, 11.337874865163375, 11.337874865163375, 6.257946255792186, 6.257946255792186, 5.608375060543951, 5.608375060543951, 7.102848129133236, 7.102848129133236, 7.98055254510653, 7.98055254510653, 6.983138230616675, 6.983138230616675, 5.821134742121763, 5.821134742121763, 16.757657811176042, 16.757657811176042, 5.438907865750832, 5.438907865750832, 15.150176565396965, 15.150176565396965, 6.8439689275803275, 6.8439689275803275, 6.775534585738228, 6.775534585738228, 11.701671421377533, 11.701671421377533, 2.135153635423044, 2.135153635423044, 3.109880129646183, 3.109880129646183, 16.52485356067048, 16.52485356067048, 2.845694085629445, 2.845694085629445, 13.308108010744485, 13.308108010744485, -2.6504618257838386, -2.6504618257838386, 1.2844399886305662, 1.2844399886305662, 7.214245490694479, 7.214245490694479, 6.501185675171517, 6.501185675171517, 1.2170894221260513, 1.2170894221260513, 12.032130736716532, 12.032130736716532, 9.749056982443145, 9.749056982443145, 5.014631296248641, 5.014631296248641, 14.095174388709058, 14.095174388709058, 3.299808049102079, 3.299808049102079, 3.0689827666732983, 3.0689827666732983, 2.743579412868913, 2.743579412868913, 9.708655479862074, 9.708655479862074, 0.531242381902885, 0.531242381902885, 4.989221516814288, 4.989221516814288, 2.716377911333135, 2.716377911333135, 25.67187121544977, 25.67187121544977, 0.586598784714475, 0.586598784714475, 8.056910715123589, 8.056910715123589, -0.9664238951499006, -0.9664238951499006, 0.7805156485593969, 0.7805156485593969, 7.603230094511485, 7.603230094511485, 2.249578926362553, 2.249578926362553, 5.56725481339475, 5.56725481339475, 12.665307524949258, 12.665307524949258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3461172471545526, "mean_inference_ms": 2.286644708287504, "mean_action_processing_ms": 0.0991050971924106, "mean_env_wait_ms": 0.6001283092213077, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 84375, "timesteps_this_iter": 0, "agent_timesteps_total": 253125, "timers": {"sample_time_ms": 13984.845, "sample_throughput": 241.333, "load_time_ms": 0.501, "load_throughput": 6738278.751, "learn_time_ms": 2194.101, "learn_throughput": 1538.216, "update_time_ms": 26.024}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 21.02233600616455, "policy_loss": 0.000999722644337453, "vf_loss": 21.031282424926758, "vf_explained_var": -0.09870235919952393, "kl": 0.005092343350525058, "entropy": 0.9946266770362854, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 8.996346044540406, "policy_loss": -0.016760337480809538, "vf_loss": 9.02345643043518, "vf_explained_var": -0.04397806525230408, "kl": 0.007501178948088666, "entropy": 1.0537462770938872, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84375, "num_agent_steps_sampled": 253125, "num_steps_trained": 84375, "num_agent_steps_trained": 253125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3375, "training_iteration": 25, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-53-14", "timestamp": 1706107994, "time_this_iter_s": 13.498749494552612, "time_total_s": 339.2067699432373, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6CD4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 339.2067699432373, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 35.07058823529412, "ram_util_percent": 65.55882352941177, "gpu_util_percent0": 0.04294117647058823, "vram_util_percent0": 0.22472426470588236}}
{"episode_reward_max": 14.74060717524275, "episode_reward_min": -17.452363149963396, "episode_reward_mean": -0.3763381522121229, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -32.4698000473241, "policy_agent_": -3.411960169521708}, "policy_reward_max": {"policy_adversary_": -4.264331463097452, "policy_agent_": 22.209970681513614}, "policy_reward_mean": {"policy_adversary_": -13.530577359245928, "policy_agent_": 6.577119603516905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.347136209043202, 0.13544533948784243, 9.674868308980937, -1.6955908029085025, -0.16560061920802074, 1.8578445132246075, -8.44028417171604, -4.812597843450563, -0.33104354660191065, -3.2756293722673226, 6.867687723582516, -11.654466879884051, 4.667927546008, -2.646674099715498, 1.3393097052768141, -0.2660433470372187, -10.513471590104526, 9.169283928797416, 2.156126265615751, -1.4632917763470812, -7.197985605460755, 2.9476291993484782, 3.512618078937864, -3.3412000154936816, 0.7874055021816562, -5.156257732188042, -12.580868248931804, -2.6144614811773623, -2.045935491435604, -6.494732972511164, -8.61206282556066, 14.74060717524275, 1.1018762924981629, 2.297112227420814, -5.408152321928494, -8.492390101831715, -0.18147211461313695, -17.452363149963396, 8.387468502170067, 4.492377507696889, -3.740872840923218, 3.399048528283374, 1.864847596870212, -1.2875273908659384, -2.298033513299329, -6.946633115249072, 8.415192825939863, 2.0820927039086756, 8.09176512228762, -0.5096214761070694, 1.4085970049226313, -4.07610342145865, 8.262096066477724, -3.055599524042443, -4.820927558411724, -3.2584433446739713, 1.2994768810575366, -4.860951054636335, 7.726700761323193, -1.0900445367798324, -2.777235148917096, 0.35427010452508356, 10.700445393621619, 0.3336998747979955, 7.073290228188964, -1.579640819698088, 0.2928048558890501, 0.23123712084721687, 0.9511239271808667, 2.241069116345487, 4.198560033792726, -0.5865643102533105, 4.17392695687669, 8.327233162019118, 9.034587490265126, -6.637017260050122, 0.162753765373975, -6.057395415799437, 7.861485821113641, 6.000932129454648, 8.277952338020558, 4.3002448270506255, -1.3537129346244425, -2.297827474777457, 6.138555816659957, 2.2736000465387276, -6.508686604820797, -9.69772851295663, 3.2294410810448566, -1.706343110557852, -3.1363556833856134, 12.802297903495917, -10.96156294261095, -4.13519115564357, 1.6781402456941978, 3.2161799739445645, -1.2172485812472498, 3.0814726865345543, -0.30891504624411537, -6.507308260842747, -4.627943557572708, -1.2030907617780893, -0.45285704084930306, -1.0523629222898783, 6.9259500399445635, -4.631599058074587, -6.250975003856767, -1.0726968127115228, -0.5954598235357278, 0.49194333825742476, -1.3837336811319965, -2.2136021806130812, -4.256251041491085, -7.971291701083304, 3.7220066077508154, -2.084788785725305, -2.1956312734801635, 0.6606279525709866, 1.0394865972413019, 2.399692917389781, -7.363253049554471, 3.420522686682528, 1.5316543501198545, -0.9595831108713242, 3.826595313879565, -7.419950679319278, -3.731602696866796, -4.109684197205321, -10.165429236422321, 3.132158782028244, -0.9032494984593983, -1.5944965168616192, 8.411773461912706, -0.20529043652492052, -4.9407463786961445], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.867240445541317, -12.312938052186487, -17.656051988805345, -15.96872952636862, -11.232038315447827, -14.589186654146873, -11.325738036997581, -11.213733723911, -10.639025698401337, -17.553182182769387, -17.73927487613802, -12.505899282563298, -21.693770609961852, -12.216292407042651, -10.833412553438174, -13.953272437388698, -32.4698000473241, -18.71566056822099, -12.17922359062674, -4.968814720107833, -8.266830505183831, -12.564045457306642, -15.658888016163198, -16.458071589902296, -13.194601879484235, -13.20626986217506, -5.75694790988838, -10.588376243963358, -5.650098551007989, -14.612185655492246, -16.76565387591443, -29.679334187784473, -10.036660424858608, -8.715094491861924, -7.0341460869481605, -19.767601707178876, -9.315579604005814, -18.591259357906832, -16.927188317726888, -12.93198445552779, -7.15662691655983, -13.826228715150508, -8.738129141971273, -11.983336834713372, -10.751285308538073, -15.092352809194487, -14.929815540540154, -9.452067560750736, -13.925484580758152, -16.468124158699165, -12.549145150269949, -10.552382149333862, -16.66803513052098, -6.4487552314217815, -12.152806711010617, -12.59364467529844, -22.154190628891644, -8.902299469939347, -15.139138161885777, -7.870143150392096, -23.11517663922528, -13.875297022622332, -25.586171340345313, -6.8535079325521755, -15.896710194752997, -7.813192540433942, -7.134318450944345, -7.7304923231979, -9.88773222359974, -9.508886593831892, -31.33002105278771, -8.678608484496758, -17.35555491614324, -16.588193943899473, -24.087771125759403, -12.881034372685107, -7.055711362456045, -12.816062985419897, -25.186897670237308, -15.874156097532843, -16.353149625902205, -18.256546457081818, -14.178423995122545, -13.792026776383617, -15.485393197782221, -13.091737738398649, -15.386026406337756, -14.472719470565435, -12.764515393288468, -8.195274232174413, -11.615452010065049, -21.377939581579913, -14.868663386109759, -14.515273910166334, -7.095041684507426, -10.459672863217046, -13.57724071842795, -14.239204997473566, -14.562100070986382, -12.302424013249489, -8.31699385715592, -17.908448122239264, -15.076502773486377, -15.804821904078745, -16.698082018771135, -7.602796567245469, -8.04280144431215, -6.307937181648333, -19.776196544703396, -17.85204411217474, -12.480330589554358, -4.264331463097452, -11.634312189863342, -17.317343330156604, -8.701488820904455, -9.709267794703852, -11.338592648454865, -11.989787370251435, -18.558525164010906, -14.805754373917724, -13.935496692510927, -22.00082685129907, -11.100146429407133, -11.560190287273489, -13.168543714881267, -10.410951307589718, -7.400011884667966, -19.27310762316587, -12.354765400004466, -10.653711788519939, -10.702370025341613, -10.119050878219099, -24.334470131749537, -6.450222704089748, -8.425299783497163], "policy_policy_agent__reward": [4.7600521182490585, 4.7600521182490585, 6.224191695837167, 6.224191695837167, 13.665460148893146, 13.665460148893146, 7.13656936173006, 7.13656936173006, 5.533218848119905, 5.533218848119905, 8.223515583685744, 8.223515583685744, 1.4427269326407692, 1.4427269326407692, 3.200567940230219, 3.200567940230219, 5.153991075899713, 5.153991075899713, 7.138776405251028, 7.138776405251028, 12.303481299860266, 12.303481299860266, 0.42571620133962496, 0.42571620133962496, 13.180849077984929, 13.180849077984929, 4.784809153663577, 4.784809153663577, 6.086361129357492, 6.086361129357492, 6.843614545175738, 6.843614545175738, 10.978164228609787, 10.978164228609787, 13.942472248509198, 13.942472248509198, 7.167674928121245, 7.167674928121245, 1.752761471880375, 1.752761471880375, 0.5344224498615376, 0.5344224498615376, 7.75583732832756, 7.75583732832756, 9.585753047550533, 9.585753047550533, 6.558435787204307, 6.558435787204307, 6.9910036908329465, 6.9910036908329465, 4.02500606499351, 4.02500606499351, -3.411960169521708, -3.411960169521708, 3.986957381392998, 3.986957381392998, 1.8020815297861923, 1.8020815297861923, 4.058726341490539, 4.058726341490539, 4.076795525176884, 4.076795525176884, 22.209970681513614, 22.209970681513614, 5.5692683586783875, 5.5692683586783875, 5.506103359641371, 5.506103359641371, 0.8129968825098335, 0.8129968825098335, 5.637605802673582, 5.637605802673582, 4.567053744696337, 4.567053744696337, 0.569448103971723, 0.569448103971723, 12.657328409948484, 12.657328409948484, 8.712180981612342, 8.712180981612342, 1.7078770378183048, 1.7078770378183048, 8.612638621716943, 8.612638621716943, 5.301488369420741, 5.301488369420741, 5.347904721923716, 5.347904721923716, 4.226625897619373, 4.226625897619373, 4.072859846972709, 4.072859846972709, 11.672504183240008, 11.672504183240008, 5.76708013232971, 5.76708013232971, 11.008624851522889, 11.008624851522889, 7.979251341296049, 7.979251341296049, 6.978871077596288, 6.978871077596288, 3.238139363937605, 3.238139363937605, 12.465065598499354, 12.465065598499354, 1.69657785368967, 1.69657785368967, 3.665939576299448, 3.665939576299448, 4.667600665312232, 4.667600665312232, 11.726833754974589, 11.726833754974589, 2.0206742076515063, 2.0206742076515063, 11.432919461604484, 11.432919461604484, 3.3900493068061315, 3.3900493068061315, 10.168970745154091, 10.168970745154091, 7.114783563573707, 7.114783563573707, 18.143308366983465, 18.143308366983465, 3.5936039036750853, 3.5936039036750853, 11.48500021147098, 11.48500021147098, 3.1167758603679254, 3.1167758603679254, 3.713561653416697, 3.713561653416697, 3.9808647220225595, 3.9808647220225595, 5.419428075390303, 5.419428075390303, 5.874977855088692, 5.874977855088692, 17.76429054329022, 17.76429054329022, 4.046022087121725, 4.046022087121725, 10.764740936509964, 10.764740936509964, 12.457713552959294, 12.457713552959294, 16.561179308012267, 16.561179308012267, 3.1220085563174895, 3.1220085563174895, 3.6092325639150102, 3.6092325639150102, 3.3793337848102296, 3.3793337848102296, 16.52419174567547, 16.52419174567547, 10.937544113493743, 10.937544113493743, 12.315550981961387, 12.315550981961387, 11.27839564206622, 11.27839564206622, 6.412355530249052, 6.412355530249052, 5.7470996508030785, 5.7470996508030785, 10.811974507221086, 10.811974507221086, 7.682668892468689, 7.682668892468689, 4.43866990075848, 4.43866990075848, 2.3874954788044014, 2.3874954788044014, 7.99697823716666, 7.99697823716666, 3.2444655608082793, 3.2444655608082793, 4.239548163339719, 4.239548163339719, 17.090118742537914, 17.090118742537914, 1.9535502217494043, 1.9535502217494043, 5.190041377261381, 5.190041377261381, 4.386590965100812, 4.386590965100812, 6.837926418580805, 6.837926418580805, 6.1799960685903494, 6.1799960685903494, 8.660338842004062, 8.660338842004062, 7.126592512371134, 7.126592512371134, 2.8975578762033716, 2.8975578762033716, 1.844525149791607, 1.844525149791607, 8.352678680230587, 8.352678680230587, 7.311822866318538, 7.311822866318538, 7.376229490894432, 7.376229490894432, 11.81201602935785, 11.81201602935785, 1.485598754585442, 1.485598754585442, 0.8959132202276918, 0.8959132202276918, 2.617620184468404, 2.617620184468404, 9.590368360583833, 9.590368360583833, 9.171993725216085, 9.171993725216085, 5.548298454211179, 5.548298454211179, 1.0253646412421862, 1.0253646412421862, 3.6890305741861273, 3.6890305741861273, 4.673025814536649, 4.673025814536649, 6.211747714327635, 6.211747714327635, 3.8122395044892765, 3.8122395044892765, 4.571480687487351, 4.571480687487351, 6.325207661411211, 6.325207661411211, 9.799005880626103, 9.799005880626103, 8.602723645653754, 8.602723645653754, 3.2861218214782304, 3.2861218214782304, 12.710674768990797, 12.710674768990797, 6.3159003897634935, 6.3159003897634935, 5.30030358820108, 5.30030358820108, 8.497569514380416, 8.497569514380416, 1.495500314135219, 1.495500314135219, 1.834204593900585, 1.834204593900585, 7.581711712980274, 7.581711712980274, 1.0946680817910677, 1.0946680817910677, 6.892935285274088, 6.892935285274088, 4.899560263441108, 4.899560263441108, 4.262277180678742, 4.262277180678742, 16.373121796831118, 16.373121796831118, 3.122466133782414, 3.122466133782414, 1.7422767024005092, 1.7422767024005092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34628939564214284, "mean_inference_ms": 2.2868782658484004, "mean_action_processing_ms": 0.0992606481894368, "mean_env_wait_ms": 0.599267955226205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 87750, "timesteps_this_iter": 0, "agent_timesteps_total": 263250, "timers": {"sample_time_ms": 13863.905, "sample_throughput": 243.438, "load_time_ms": 0.401, "load_throughput": 8412536.994, "learn_time_ms": 2158.956, "learn_throughput": 1563.256, "update_time_ms": 25.822}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.287552070617675, "policy_loss": 0.006727293273434043, "vf_loss": 20.290627098083498, "vf_explained_var": -0.05478814840316772, "kl": 0.003693001109577232, "entropy": 0.9802080154418945, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.98736424446106, "policy_loss": -0.015676970954518765, "vf_loss": 8.013180589675903, "vf_explained_var": 0.01004897952079773, "kl": 0.005307761866788263, "entropy": 1.0272001564502715, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 87750, "num_agent_steps_sampled": 263250, "num_steps_trained": 87750, "num_agent_steps_trained": 263250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3510, "training_iteration": 26, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-53-27", "timestamp": 1706108007, "time_this_iter_s": 13.440109491348267, "time_total_s": 352.64687943458557, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08D62160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 352.64687943458557, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 34.71764705882352, "ram_util_percent": 65.70588235294117, "gpu_util_percent0": 0.049999999999999996, "vram_util_percent0": 0.22427906709558823}}
{"episode_reward_max": 14.027095620598713, "episode_reward_min": -17.74345778364122, "episode_reward_mean": -0.3800703167188594, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.092914935237904, "policy_agent_": -3.366559206869807}, "policy_reward_max": {"policy_adversary_": -4.006077157137588, "policy_agent_": 19.560005277918307}, "policy_reward_mean": {"policy_adversary_": -13.32278218841758, "policy_agent_": 6.471355935849361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5049415124598804, 2.6967319647264825, 2.356397694225432, 5.869857593849526, -4.27527462844133, -0.49490685142227564, 1.1232105153883514, -0.8917122250131897, -1.2243112520756447, -7.126214413123771, -4.624351571032402, 1.2177766531893617, 3.5385387533430888, -2.7694294222507536, -2.254689499956212, -0.21565509705759472, 8.662616646580757, 0.7829561559142668, -3.9229306753844986, 3.1669939355247942, -7.427675937540882, 0.33902966507916055, 3.23788811479703, 0.6645869156117837, 1.0568839923821223, 2.088047260823905, -6.334664380617296, -4.206299797050634, 0.4502347340747289, 0.09968283627314528, 0.6860427637999058, -0.9892765315113503, 0.2736434494200326, -8.649717828068432, -3.975866401571403, 14.027095620598713, 6.773670923511638, 5.270314190073609, 7.968764886986788, -0.6098100953518364, 5.808008547532261, 2.197109798986814, 2.13215076030116, -2.8562689408547515, -9.714419053881379, 6.722960303707264, -3.7705718747780512, 0.17698730272052893, -7.946057239051974, -1.4904515807575276, 4.0830788849325765, -4.217087633325677, -6.360821041781657, -5.590868484722655, -2.5825708927252102, -2.7162459082445753, 3.3394108087251064, -3.277741564300618, -12.826768351847127, 4.996624564040928, 0.5610656194841495, -1.5324837854759694, 0.7191244714457393, -6.7679061773868865, -8.974565535567542, 4.867682641472827, 10.037291360949672, -4.708139447107693, 6.396908563190672, 2.0180003895505134, -2.2815706948717343, -5.227807603826508, 9.451331781149973, 7.073989508466546, -17.74345778364122, -7.09220323022182, -3.5002852880728836, -5.429591029624939, -0.021602562714397838, 1.0528359410486272, -4.98810457698578, -7.7057959268702145, 7.253513734543715, -3.9753230325518323, -8.114005704758533, 2.402948864382376, 2.2529656631567265, 3.4985403335864858, 4.915847796807064, -2.3608264843685927, -2.1431625593366106, -0.12254904905387784, -7.611493973957527, -12.911309052895184, 3.5301486110357283, 4.99858068945945, -0.7839275093038832, -17.667880334863305, -1.3363422516962289, -4.802364727216121, -9.159005606875349, 5.692978435258267, 5.051095422661906, -4.589689925960529, -1.0779668600434236, -3.0447342137819478, 4.149227314091845, 3.105469722358102, 6.3544786594146965, 5.6687508399293565, 3.6530894599156425, -4.641934171751178, 4.901697427872815, 0.19584272318769233, -0.5155947369314346, 0.863223652813689, 4.21577882747506, 0.29037935886138455, 1.8702214480913524, 12.55025269441654, 7.663270954498245, -1.865543000960094, -2.009895901621356, 0.4904103601106149, 2.559689584639349, -9.12617046069977, 5.037341618682458, 2.3885143288777093, -9.128459083418132, 2.0134547805912466, 4.575424716636604, -5.364298094443972, 3.035954083323028, -1.2186716624466405, -1.0917316750212], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.686838547916732, -21.4440310754284, -9.054136570046735, -14.214454237494245, -17.365764272938694, -16.636292345904877, -15.67479742924507, -6.340407912805308, -10.469521934368382, -11.121947980718067, -9.835431481142477, -9.248066174655913, -10.954921411944074, -5.8103822931622355, -10.867007723848923, -7.6189287449291685, -18.591567348543865, -11.187732517012352, -18.909613514758924, -16.498942332716073, -15.901390526819954, -11.673202264325171, -15.113186806695788, -5.476583492665723, -15.505937394717236, -19.857907495753775, -6.382394490692997, -6.750797496294937, -18.814950563031267, -10.482006989821594, -12.528749098906491, -15.479509698310729, -7.756040244529893, -8.145488680751015, -14.42490315495954, -25.092914935237904, -15.728076284720366, -15.73517904658676, -13.214698189338533, -12.811772565275772, -13.85718099653693, -9.835039255101625, -12.249910037699275, -9.812171900744541, -6.349666864974816, -18.255203618464993, -23.696833309022242, -8.383815651496683, -16.556650059152165, -9.67522246381728, -20.85251011725539, -13.623698800369873, -16.218858241318127, -15.673404891294433, -11.779775511709172, -8.122822109691553, -18.455723665372386, -9.765780609042487, -8.225268138665479, -16.94460392292182, -15.987507891446983, -21.34418090948594, -11.451816012110486, -9.088330622534846, -12.332022521586763, -10.433124711884101, -18.88415395226202, -6.452728927401394, -21.731691852539086, -18.897139783106404, -6.61171919989532, -21.473609957681195, -20.890923639398938, -17.066402599832813, -11.01033936990161, -10.361235906409226, -10.619610431485276, -16.172508038843905, -6.12229451041498, -11.424438738677253, -20.48991799621141, -9.181717472205863, -15.81087221998155, -11.683290898585204, -15.311966300286217, -11.150453894224968, -9.413751132201584, -10.706595310814114, -15.70225419222345, -10.103729490689574, -6.211893260259661, -6.045538411829175, -15.300524092064204, -19.78883168558403, -24.666887732429327, -13.363459234322056, -14.710383304399878, -17.141353412888122, -11.403111586301888, -4.006077157137588, -10.73776653606912, -16.363808081764926, -12.744176434543206, -9.834856455196864, -18.45942539624585, -13.499088533249802, -15.673679551709352, -14.546180597705922, -17.511576783298874, -20.947723809779347, -12.516227790335465, -6.283906478287665, -12.9368164462538, -10.29238873586606, -17.551867936015295, -17.052179084727122, -10.203562130092305, -17.421027013769482, -11.074711976699831, -18.44366236388326, -18.23492810296571, -9.29648609546689, -5.114431847037731, -6.751696978272322, -10.672007031807318, -18.750921036368535, -14.034698784923217, -9.352806786993229, -9.575675113123648, -7.289479684656467, -12.52610130826593, -22.321530502139062, -16.976299518249235, -9.289715558947847, -9.005181156456908], "policy_policy_agent__reward": [10.595890030188308, 10.595890030188308, 12.070381520077445, 12.070381520077445, 5.705267132136083, 5.705267132136083, 10.042155915671888, 10.042155915671888, 6.545244822248684, 6.545244822248684, 8.070692747241301, 8.070692747241301, 8.399003972316713, 8.399003972316713, 2.7243478438960573, 2.7243478438960573, 4.622605341146371, 4.622605341146371, 1.9978667837971475, 1.9978667837971475, 2.605539955055039, 2.605539955055039, 5.232921413922637, 5.232921413922637, 7.246730082643583, 7.246730082643583, 1.5204764354557416, 1.5204764354557416, 4.306159111946357, 4.306159111946357, 3.701636823935787, 3.701636823935787, 13.627091997562314, 13.627091997562314, 5.985344336463309, 5.985344336463309, 7.493341419687213, 7.493341419687213, 9.832968134120431, 9.832968134120431, 4.2368572946395355, 4.2368572946395355, 6.006115964702164, 6.006115964702164, 9.17553746074641, 9.17553746074641, 3.0705852041387534, 3.0705852041387534, 8.281410693549677, 8.281410693549677, 10.972977378288835, 10.972977378288835, 0.023865055037852134, 0.023865055037852134, 1.2722488496221516, 1.2722488496221516, 9.632592648553, 9.632592648553, 5.290844913047368, 5.290844913047368, 6.607395931353197, 6.607395931353197, 7.245116583399692, 7.245116583399692, 4.014841846974964, 4.014841846974964, -0.2521145736587118, -0.2521145736587118, 5.224518376694068, 5.224518376694068, 19.560005277918307, 19.560005277918307, 11.250873604116002, 11.250873604116002, 10.502746618330185, 10.502746618330185, 10.591731538162662, 10.591731538162662, 6.100981234961967, 6.100981234961967, 9.832594772034593, 9.832594772034593, 6.0160745270442195, 6.0160745270442195, 7.19103039900022, 7.19103039900022, 3.4779514799448945, 3.4779514799448945, -1.6823760944532817, -1.6823760944532817, 12.489081961086125, 12.489081961086125, 9.963130717122093, 9.963130717122093, 4.280401477108605, 4.280401477108605, 4.305296410050096, 4.305296410050096, 4.092385441529876, 4.092385441529876, 12.467794501093984, 12.467794501093984, 4.7033055835220985, 4.7033055835220985, 4.9290185997682325, 4.9290185997682325, 5.04126820328589, 5.04126820328589, 4.598602309491978, 4.598602309491978, 2.703288100723489, 2.703288100723489, 10.897567237048742, 10.897567237048742, 3.2440195223709343, 3.2440195223709343, -2.300750106590825, -2.300750106590825, 10.970614243481378, 10.970614243481378, 8.274286755465566, 8.274286755465566, 9.905848562004982, 9.905848562004982, 6.085470241778111, 6.085470241778111, 1.1602122225739788, 1.1602122225739788, 1.6787284930096118, 1.6787284930096118, 7.650403676678466, 7.650403676678466, 14.460722656605844, 14.460722656605844, 0.8722947401468506, 0.8722947401468506, 14.064300207864878, 14.064300207864878, 10.457570086328461, 10.457570086328461, 2.165074252511791, 2.165074252511791, 8.122901176927341, 8.122901176927341, 15.171127710274458, 15.171127710274458, 12.07019605414968, 12.07019605414968, -3.366559206869807, -3.366559206869807, 1.634516338093702, 1.634516338093702, 3.5596625717061974, 3.5596625717061974, 5.371458504609482, 5.371458504609482, 3.0503459738502907, 3.0503459738502907, 6.238637339862943, 6.238637339862943, 7.750906709612815, 7.750906709612815, 0.7379607726678254, 0.7379607726678254, 11.532192977262635, 11.532192977262635, 3.853983933016687, 3.853983933016687, 3.5989802977638425, 3.5989802977638425, 6.776701379303673, 6.776701379303673, 5.833358397679155, 5.833358397679155, 7.102567822200301, 7.102567822200301, 10.309050994515259, 10.309050994515259, 3.8714515031604906, 3.8714515031604906, 2.0343653504615244, 2.0343653504615244, 2.9614946813876486, 2.9614946813876486, 3.8445150590533426, 3.8445150590533426, 3.4387613163444253, 3.4387613163444253, 14.098518171732522, 14.098518171732522, 9.181019961890753, 9.181019961890753, 6.9632278975479975, 6.9632278975479975, -0.2632634609875937, -0.2632634609875937, 5.033384667302831, 5.033384667302831, -0.3981437850392668, -0.3981437850392668, 0.7893804645968838, 0.7893804645968838, 11.028393258511592, 11.028393258511592, 8.897635928602552, 8.897635928602552, 2.622583264618168, 2.622583264618168, 8.690729268101213, 8.690729268101213, 5.227177159733928, 5.227177159733928, 9.911453432900595, 9.911453432900595, 8.825825160032013, 8.825825160032013, 11.93302772135679, 11.93302772135679, 13.308237324854353, 13.308237324854353, 8.084658625125554, 8.084658625125554, 0.8209861532682418, 0.8209861532682418, 8.919256937063304, 8.919256937063304, 5.244115729526877, 5.244115729526877, 8.518136599541933, 8.518136599541933, 8.957701368770405, 8.957701368770405, 7.209670478783682, 7.209670478783682, 8.855703186315433, 8.855703186315433, 6.472466712395592, 6.472466712395592, 15.496957529149896, 15.496957529149896, 12.949099528731978, 12.949099528731978, 3.715471547253399, 3.715471547253399, 1.5522679727081878, 1.5522679727081878, 3.621053669191468, 3.621053669191468, 6.615848308223332, 6.615848308223332, 4.812375287834382, 4.812375287834382, 9.53602020180284, 9.53602020180284, 5.8706605579354685, 5.8706605579354685, 0.2236080148527565, 0.2236080148527565, 4.6514672326238555, 4.6514672326238555, 8.550763012451268, 8.550763012451268, 8.478616203847542, 8.478616203847542, 10.006126800786129, 10.006126800786129, 4.0355219482506035, 4.0355219482506035, 3.9567247407178567, 3.9567247407178567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3458925045603711, "mean_inference_ms": 2.2828879673354843, "mean_action_processing_ms": 0.09915723902583688, "mean_env_wait_ms": 0.598288025570232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 91125, "timesteps_this_iter": 0, "agent_timesteps_total": 273375, "timers": {"sample_time_ms": 13769.642, "sample_throughput": 245.104, "load_time_ms": 0.304, "load_throughput": 11086917.293, "learn_time_ms": 2158.326, "learn_throughput": 1563.712, "update_time_ms": 25.622}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 19.236700439453124, "policy_loss": 0.004847808825434186, "vf_loss": 19.241795158386232, "vf_explained_var": -0.1153628945350647, "kl": 0.007838606096706325, "entropy": 0.9942581117153168, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.574854850769043, "policy_loss": -0.021356330602429807, "vf_loss": 7.606215953826904, "vf_explained_var": -0.08042725920677185, "kl": 0.005437447223885866, "entropy": 1.0140869557857513, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 91125, "num_agent_steps_sampled": 273375, "num_steps_trained": 91125, "num_agent_steps_trained": 273375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3645, "training_iteration": 27, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-53-40", "timestamp": 1706108020, "time_this_iter_s": 12.96997618675232, "time_total_s": 365.6168556213379, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A787430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 365.6168556213379, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.635294117647064, "ram_util_percent": 65.71176470588236, "gpu_util_percent0": 0.12588235294117647, "vram_util_percent0": 0.22380514705882354}}
{"episode_reward_max": 19.350386045845163, "episode_reward_min": -21.206112245462986, "episode_reward_mean": 0.07011551418527505, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.40900416145007, "policy_agent_": -3.408035565881279}, "policy_reward_max": {"policy_adversary_": -4.138282642490165, "policy_agent_": 21.380276310267142}, "policy_reward_mean": {"policy_adversary_": -13.894944227830502, "policy_agent_": 6.982529871007888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5555008670415438, 2.399651767791888, -2.523142337259607, -0.9117769922219632, -13.619342184401297, 6.363906048161809, 0.9281181976902168, -12.258388611002285, -2.945713100132524, -2.3700285205141913, -8.372030171432154, -3.2265195113192986, 1.1222138548915017, 6.8273912429227, 13.544481861592779, 2.8289891827545732, 3.404810307945346, 8.91052341212894, -0.4349820513429349, 4.24813435434076, -1.6414204402039698, 4.052977934866859, -1.556737779552927, -4.281365022414678, -4.514901815301723, -5.177656279644651, -0.047766991371796574, 1.1642538080226315, 3.433113533168228, 5.727174976592504, -15.234466019005302, -4.384529440501878, 0.05070754762211954, -9.29315210571289, 0.55757976605514, -1.1063471481506815, -8.66783329804482, -21.206112245462986, -1.8832721547034073, 8.967597698730154, 3.9857872119158704, 5.031940503864556, 1.489958496535912, 3.7520943323053175, -8.87780965732662, 2.9372595186501176, 7.1570463985004125, -6.331414898687613, 3.0575888384467413, 2.8297773286631984, 2.205674664258122, 3.406816470062788, -4.023917165274051, 2.8011524800409044, 2.992880846370488, -0.1564603638804148, 10.960870014853755, 5.637898506377283, 1.3275173698742306, 7.002199068576298, -12.014225608776986, 4.292644999330025, -9.523259373567194, 1.7942131856569756, 7.075841057717329, -7.984836081319719, -4.807121632193172, 1.5844272928600798, 5.825409865753285, 11.29100621000484, -2.0979749137397263, -9.306822612391732, 1.5489667133350462, -4.700415708002581, 2.974609803896667, -7.298379310367202, 0.4133199174730155, -4.218050051922932, 16.11054271462346, -0.01491625942860303, -3.717728937599099, -6.136245188105609, 3.8169741871881007, -8.63643115971529, 4.06232477252208, -2.3747087389800083, 2.4569007318997214, 0.8595552161048438, 7.635004063273393, 4.57124155660936, 2.2170009431049547, 19.350386045845163, -14.443925574776765, 6.331423603098974, -3.778570827343234, -7.308375143370987, 6.928479963319914, 2.86271814852622, 3.511278987265656, 1.7502822755374807, -4.568133738753763, 0.8969091038388899, -5.1454245558289395, 1.0240515309554405, -2.9560255964223807, -5.045532817748395, -0.08184546715498137, 6.092573759313602, 3.3228542306100124, 0.5377738158469054, 4.269576927485554, 10.896776376882343, 0.8557686970570477, 6.794257872569966, -12.747290089138044, -0.988897348777703, -12.32457293738067, 1.8563967219761124, 1.1789546188815323, -6.44327196158451, -2.876040447696002, 3.3629292325205675, -6.173129723282489, 5.43340131071958, 1.7354176851353955, -1.7866737791575598, 0.7206611779474953, 5.586941819210032, 4.940391810809698, 7.3097862715017135, 1.020881820638346, -10.707052456794559, 2.311415904921017, 9.061523620946957, -4.307824481047743], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.895600414758704, -21.06150504866784, -9.189906878992963, -14.169491735565096, -11.475843530006186, -23.00263177632151, -14.590097354915878, -16.908278157318264, -15.572818567127976, -11.619337977556103, -17.238014042821067, -13.08846196798487, -6.514655416078564, -16.193796901921033, -21.033116923668423, -12.177354482120037, -11.837009302741734, -18.722982619313342, -10.408540143877861, -13.901553048657616, -10.476481042322446, -15.961007622686255, -13.531095900268474, -11.454203478781, -10.22014307012774, -20.30157778647776, -16.070074596246272, -14.685689156250247, -8.840910020858187, -15.098801566605072, -9.500255432566231, -6.774627796770823, -9.371047689135057, -6.539088686236326, -14.99398994165675, -6.911606515867108, -15.94238868805245, -14.390041113700434, -7.014639557493145, -17.320802117903135, -15.710531110732264, -14.669890219503218, -10.448557574130525, -14.009367230507518, -11.48256599219688, -26.704130224408175, -16.084391357032647, -22.451987835227627, -6.990346564457042, -15.704281443061795, -13.016745266829306, -20.24846159876693, -10.635473027236621, -11.13034632069463, -11.982362989820647, -7.6827416747707655, -17.938360476436234, -15.28665768601866, -13.88148836404795, -33.40900416145007, -11.26893110954656, -20.37059592603081, -21.2052448720682, -16.44813178564404, -14.948702252930875, -21.830015335296594, -8.771408530438174, -11.074375438211849, -12.71087484887721, -17.64513328455839, -6.311357832069265, -8.241546210260317, -8.63779763255977, -24.792893499597824, -12.5963083001056, -14.734723835678196, -11.051296237876562, -12.771283753071282, -23.978978983518292, -11.726590739509584, -5.82537502056845, -8.218581031505634, -10.642586390245189, -14.563208943753772, -12.240514277739972, -17.36565964590551, -10.340398741861366, -14.043085089016575, -18.509316499298418, -12.744492204262219, -12.631396949158814, -23.410166574689125, -13.851438533637133, -12.405616435061, -8.553218096587923, -15.737310258077374, -16.788252125523638, -15.282959530020227, -10.388133043166016, -8.75126386256654, -9.157388050521313, -11.368747827230267, -15.15030075769218, -17.566127515539545, -13.88392287148394, -12.53710474584289, -10.66057241159049, -13.648169968489741, -12.625844098434019, -8.687260170849001, -18.801212784735597, -16.74108298230785, -25.44534482402056, -15.824477421768028, -14.73009374237037, -15.5003393679807, -10.649084616511098, -17.338497140049736, -9.83761964917327, -11.743319662869672, -9.520432929340343, -10.534912349994814, -9.956219425567738, -17.78953072822193, -17.078105641764154, -8.379179091018933, -10.483005286899871, -16.693692469780018, -16.239714683542804, -13.893418419789603, -12.606672679025763, -18.09998219883363, -13.139269436583154, -16.492219316560746, -4.138282642490165], "policy_policy_agent__reward": [5.670049773858577, 5.670049773858577, 11.730578408229865, 11.730578408229865, 3.333382270866678, 3.333382270866678, 6.628857371671568, 6.628857371671568, -1.0717493271975522, -1.0717493271975522, 14.683268912241656, 14.683268912241656, 7.759107776303046, 7.759107776303046, 2.324944773157986, 2.324944773157986, 6.313552733497726, 6.313552733497726, 4.624654728520956, 4.624654728520956, 4.432991935694453, 4.432991935694453, 4.930971228332787, 4.930971228332787, 3.8184346354850325, 3.8184346354850325, 11.510594072421867, 11.510594072421867, 17.288799392630597, 17.288799392630597, 7.503171832437307, 7.503171832437307, 7.620909805343541, 7.620909805343541, 13.81675301572114, 13.81675301572114, 4.986779046267466, 4.986779046267466, 9.074843701499189, 9.074843701499189, 4.417530301059238, 4.417530301059238, 10.006992778776555, 10.006992778776555, 5.987179060357773, 5.987179060357773, 3.5864192281831615, 3.5864192281831615, 2.8526206274130077, 2.8526206274130077, 7.561960753416554, 7.561960753416554, 8.011153802437235, 8.011153802437235, 7.924971482136439, 7.924971482136439, 6.137011777013207, 6.137011777013207, 10.412988271598788, 10.412988271598788, -2.8671052932195336, -2.8671052932195336, 1.1950491781344734, 1.1950491781344734, 4.710877618378588, 4.710877618378588, -1.3770317097382803, -1.3770317097382803, 7.775784853855941, 7.775784853855941, 2.9026296838582146, 2.9026296838582146, 3.637277695003817, 3.637277695003817, -3.408035565881279, -3.408035565881279, 2.565683701394869, 2.565683701394869, 13.144199908316645, 13.144199908316645, 9.848159161324068, 9.848159161324068, 9.850915361683885, 9.850915361683885, 5.96925803533322, 5.96925803533322, 8.88073078140642, 8.88073078140642, 1.3023781674351291, 1.3023781674351291, 14.820694871529147, 14.820694871529147, 11.620718877766532, 11.620718877766532, 8.06028646827001, 8.06028646827001, 5.023967701451891, 5.023967701451891, 9.2670293858625, 9.2670293858625, 7.611209965543712, 7.611209965543712, 11.827639034414856, 11.827639034414856, 3.305777930981287, 3.305777930981287, 6.965749400367768, 6.965749400367768, 7.4876219180955665, 7.4876219180955665, 3.7631406554451763, 3.7631406554451763, 14.449615245644992, 14.449615245644992, 10.462278096197972, 10.462278096197972, 7.60450286696109, 7.60450286696109, 20.20560161501319, 20.20560161501319, -0.3726472496152087, -0.3726472496152087, 12.331620462680421, 12.331620462680421, 5.840992749250501, 5.840992749250501, 9.121172485650508, 9.121172485650508, 11.012271655324097, 11.012271655324097, 6.922589626988435, 6.922589626988435, 1.9821434491225023, 1.9821434491225023, 6.329401365535965, 6.329401365535965, 9.26814235731525, 9.26814235731525, 14.468069747281616, 14.468069747281616, 2.106691459164769, 2.106691459164769, -0.5326382010657055, -0.5326382010657055, 5.093382172947409, 5.093382172947409, 10.046238895797622, 10.046238895797622, 7.7854590520011335, 7.7854590520011335, 3.7181722626554965, 3.7181722626554965, 5.732308077674786, 5.732308077674786, 4.276616850574174, 4.276616850574174, 20.044760849070872, 20.044760849070872, 5.855837240040491, 5.855837240040491, 1.0538230414846765, 1.0538230414846765, 1.0411679217000134, 1.0411679217000134, 7.229780288716644, 7.229780288716644, 2.9633888920192453, 2.9633888920192453, 8.151419525131026, 8.151419525131026, 7.495475453462753, 7.495475453462753, 6.39864973688054, 6.39864973688054, 7.45132015256071, 7.45132015256071, 13.072160281285907, 13.072160281285907, 8.657866880435789, 8.657866880435789, 7.424198946131884, 7.424198946131884, 21.380276310267142, 21.380276310267142, -0.29624352056981873, -0.29624352056981873, 9.368520019079988, 9.368520019079988, 2.3873236346223425, 2.3873236346223425, 4.214467557353193, 4.214467557353193, 11.858366044421773, 11.858366044421773, 9.072838839273228, 9.072838839273228, 6.949706015215833, 6.949706015215833, 5.250773069052008, 5.250773069052008, 2.2946271558837754, 2.2946271558837754, 6.13282846553458, 6.13282846553458, 5.00243810093162, 5.00243810093162, 9.295089523247489, 9.295089523247489, 5.463948637530779, 5.463948637530779, 3.745785964047251, 3.745785964047251, 5.289363472217755, 5.289363472217755, 9.870371863901672, 9.870371863901672, 7.974349164522015, 7.974349164522015, 4.612516993347953, 4.612516993347953, 11.535394856110578, 11.535394856110578, 13.818929679595099, 13.818929679595099, 13.150556760538805, 13.150556760538805, 11.309367647168994, 11.309367647168994, 0.9914018266161615, 0.9914018266161615, 7.255721009601499, 7.255721009601499, -0.8377441604347841, -0.8377441604347841, 9.597446931012923, 9.597446931012923, 5.508287134027399, 5.508287134027399, 2.6500238506425804, 2.6500238506425804, 3.32219624082217, 3.32219624082217, 6.948920791257691, 6.948920791257691, 1.8915448511426267, 1.8915448511426267, 11.611466019470752, 11.611466019470752, 9.406761663449771, 9.406761663449771, 3.2962526559306875, 3.2962526559306875, 5.601833232423683, 5.601833232423683, 11.140317144495025, 11.140317144495025, 10.590053247176245, 10.590053247176245, 10.601602345645658, 10.601602345645658, 6.813777249832054, 6.813777249832054, 3.6964648710195354, 3.6964648710195354, 7.725342670752084, 7.725342670752084, 12.776871468753853, 12.776871468753853, -0.08477091927878985, -0.08477091927878985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34436671593013424, "mean_inference_ms": 2.2742384259008466, "mean_action_processing_ms": 0.09889346051308708, "mean_env_wait_ms": 0.5966517083914215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 94500, "timesteps_this_iter": 0, "agent_timesteps_total": 283500, "timers": {"sample_time_ms": 13702.844, "sample_throughput": 246.299, "load_time_ms": 0.204, "load_throughput": 16506268.657, "learn_time_ms": 2183.453, "learn_throughput": 1545.717, "update_time_ms": 25.728}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.076909446716307, "policy_loss": -0.0028378694783896207, "vf_loss": 20.08965072631836, "vf_explained_var": -0.07706389427185059, "kl": 0.007200044562475494, "entropy": 0.990336936712265, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 8.144820833206177, "policy_loss": -0.002301872742827982, "vf_loss": 8.156885290145874, "vf_explained_var": -0.0073165327310562136, "kl": 0.006896576904334246, "entropy": 0.9935208678245544, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 94500, "num_agent_steps_sampled": 283500, "num_steps_trained": 94500, "num_agent_steps_trained": 283500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3780, "training_iteration": 28, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-53-53", "timestamp": 1706108033, "time_this_iter_s": 12.561251878738403, "time_total_s": 378.1781075000763, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FA4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 378.1781075000763, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.75625, "ram_util_percent": 65.60624999999999, "gpu_util_percent0": 0.044375, "vram_util_percent0": 0.2212066650390625}}
{"episode_reward_max": 13.21608345806688, "episode_reward_min": -19.680070991045493, "episode_reward_mean": -0.1623882336050591, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.028630810368817, "policy_agent_": -4.465253472060389}, "policy_reward_max": {"policy_adversary_": -4.022790942227094, "policy_agent_": 16.987941670071073}, "policy_reward_mean": {"policy_adversary_": -12.816285627742223, "policy_agent_": 6.326948697068582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.153045549736093, 0.20621890618759142, 10.323685097520436, 2.4023641735480825, 2.466017422808371, -1.7198837534761737, -2.2364795004493905, -10.007625610873472, 11.315474935473333, -0.47689175657470045, -1.6246264993641868, -0.475019505111098, 1.8836327981847045, -0.8560528438075399, -0.2001664413598816, -17.86415550133591, 2.965291522737852, 3.110650650368441, 1.8574418251585354, -2.9922795347279103, 1.6546912655068255, -0.37406294063403844, -0.1683332915250516, -4.19534589724006, 5.629064500081998, 0.6372056726371016, -6.318410991610415, 0.5898472841771036, -1.2690535057511565, -5.158562305416463, 2.407072443817253, -9.224054408593593, -2.924499838116461, -0.5025071331345607, 10.034821938530918, -1.0994284209194645, -12.253904267459442, -1.6072136521001594, 1.6181490790416881, 10.29250763210999, -7.529460252038016, -2.105304939082606, 8.114589675927403, -0.984879892467247, 3.2640781614606467, 5.691358187716452, 5.444769287181244, -10.513258484303508, -0.6078434425091382, -0.7098372041366627, 10.334501571318711, 0.2575509975598631, -7.349354606232041, -0.5159424986556731, 2.4715483745038, -3.6374559136514697, -13.152191747005197, 4.077472592264216, 2.184082779877065, 2.094270970277438, -9.929662616111784, -4.315356000261626, -2.3019223148381727, -3.3492095212638464, -4.505515780885099, -1.998860730627765, 2.883329102174817, 2.8009252022787043, 9.084525757251965, -7.431651022876391, -0.5310696046566461, 0.2210960576670491, 0.5451333218292531, -9.09184480581165, 1.781929393054337, -2.645740100523612, -0.590408552824617, 1.1697115624653924, -2.259071927140508, -1.7819161563455372, 5.836919516756408, 0.8736025878057965, 6.673233778071639, 1.9443072802736285, 10.410005606836963, -2.812808010751886, 1.090155714701436, 5.135580517417556, -3.1988459158830613, 1.8410606485603274, 6.300902120229021, 0.903297195932648, -4.240937759391187, -0.5277531221590541, -6.555997947058747, -9.213684811276014, 3.0508426850098713, -19.680070991045493, 10.069246170772947, -1.6506836685367015, -3.7631907122243673, -2.540569008508749, -5.9069455974687575, -3.6779744770654066, 4.977213566875326, 7.1986534116423595, -7.42733672560445, 0.07990040677920357, 0.6937202672765629, -4.849290729680546, -0.22628424053997187, 7.17610398406915, -2.0046371619862176, 9.640472746230099, 2.831100101292995, 3.544839160062307, 2.1571851432410822, -1.842452275420555, -1.68449105006047, 3.011712365483067, 13.21608345806688, 1.7763123624718504, -1.7509445876435454, 3.5631424446497544, -4.545044976642494, 3.906850115300383, 5.548252755615654, 3.827465846834629, -0.5821816589532183, 4.847628875813528, 0.8358795882358578, -2.347588414790644, -8.599508625036107, 12.189897539788205, -13.720405910185038], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.668258826353146, -14.363004177940956, -22.522686326021898, -7.032475737696268, -12.347784493565443, -9.693414446261784, -12.561960253671215, -10.87124795611222, -19.79209290603615, -7.567325785405502, -11.043218633912062, -8.26525489292251, -17.61095394466148, -12.093154224447476, -21.595523703690585, -14.090945475693582, -9.149172249567055, -11.384729985812873, -9.27933343904397, -10.327672934867433, -12.921896557217666, -15.493267656925413, -11.46197215951219, -18.476138267504133, -12.063836796806767, -7.720948889457678, -10.953461388494558, -12.311794339527557, -9.070165336751144, -11.177368935438277, -12.275952656853159, -12.38574948681429, -16.663243867269156, -11.959754635109181, -17.09911695635818, -17.318011736921918, -11.328398197763711, -16.144553548360435, -13.623341857841522, -19.34310234704845, -10.217895827465403, -8.640109642521953, -14.677833832913723, -7.3125268577025, -14.295207308411563, -19.430958705852692, -11.20119991025101, -13.438319523863978, -7.073907770276439, -9.685572664556176, -19.161448159824655, -10.832199450187654, -7.55331675654813, -16.816000886829002, -7.652211198087415, -7.729802930840283, -15.823599407330047, -14.546680428525766, -11.255984133285267, -8.635942087928715, -19.143168596975237, -8.640532495739317, -11.281343489690125, -8.656841664163206, -23.028630810368817, -12.983676201013807, -8.912796617303835, -11.241303552973182, -15.197267655881335, -7.81082699825615, -9.887511754626782, -11.34324030412053, -8.842114473668618, -7.556032039263344, -15.73302801793344, -6.692024562667603, -8.099821983701789, -15.613418623320031, -16.129627129586538, -10.547910501862306, -14.898270533968818, -7.8591614904552145, -16.133493424834153, -15.259625178688003, -20.337690304073394, -21.238919921603475, -6.340733214044411, -15.49581703592436, -11.949297405323296, -12.721749453070572, -18.168668578923597, -10.158936745160759, -8.310318107190941, -10.778266219805397, -16.414387913593835, -11.350388849775479, -15.799418392457946, -10.749564046924739, -15.883145793652046, -13.03352547027624, -10.039782713888536, -11.224496767862895, -10.449628090568734, -13.528407669843975, -18.732318514819912, -14.479937809517219, -13.680668342025731, -4.3145902621078625, -16.65937239123254, -15.1423822036617, -11.57717502858194, -21.324338518873933, -4.022790942227094, -17.722083772044034, -14.21504811471107, -15.157517812140405, -9.517323719413863, -8.319251578102552, -12.744672342235862, -13.216112929631231, -20.759799882075264, -9.785660370589278, -14.653231083243206, -20.2512125358847, -8.256996305292045, -14.956645154626315, -14.739934038810931, -13.92338258505505, -9.526801794300647, -12.231624877397207, -10.557275114198992, -8.936566882453002, -15.953511319160322, -20.41952376896808, -10.922995461929881], "policy_policy_agent__reward": [3.257606638308527, 3.257606638308527, 7.284611542064273, 7.284611542064273, 16.423185711771165, 16.423185711771165, 4.717419955622175, 4.717419955622175, 7.40690095818691, 7.40690095818691, 3.986765346392805, 3.986765346392805, 5.162740376610913, 5.162740376610913, 0.43181117261937485, 0.43181117261937485, 15.55378392075474, 15.55378392075474, 3.5452170144154, 3.5452170144154, 4.709296067273935, 4.709296067273935, 3.895117693905707, 3.895117693905707, 9.747293371423087, 9.747293371423087, 5.618550690319969, 5.618550690319969, 10.697678631165353, 10.697678631165353, -1.8866050128211638, -1.8866050128211638, 6.057231886152453, 6.057231886152453, 7.247690318090658, 7.247690318090658, 5.568387632101252, 5.568387632101252, 3.667696700069761, 3.667696700069761, 7.288293911362244, 7.288293911362244, 7.559602358145687, 7.559602358145687, 5.646819433993568, 5.646819433993568, 7.1403961851320386, 7.1403961851320386, 8.846450648444383, 8.846450648444383, 4.179077281047388, 4.179077281047388, 2.317525198442071, 2.317525198442071, 6.450820811852328, 6.450820811852328, 3.9005559154999925, 3.9005559154999925, 3.009403315010907, 3.009403315010907, 7.341512550335206, 7.341512550335206, 1.5808475391103458, 1.5808475391103458, 6.869372014576352, 6.869372014576352, 5.728623750987311, 5.728623750987311, 13.566969447444547, 13.566969447444547, 8.109291658001228, 8.109291658001228, -0.4627530348478623, -0.4627530348478623, 7.268669948130137, 7.268669948130137, 7.620745468441604, 7.620745468441604, 14.81780498957922, 14.81780498957922, 1.3442177877136947, 1.3442177877136947, 3.267402351719674, 3.267402351719674, 11.396211754420564, 11.396211754420564, 3.163823482617628, 3.163823482617628, 8.779642734936104, 8.779642734936104, 12.56115844678457, 12.56115844678457, 8.322984598716126, 8.322984598716126, 1.4625305197802387, 1.4625305197802387, 3.2330321638836494, 3.2330321638836494, 4.487867730209756, 4.487867730209756, 14.74797486557168, 14.74797486557168, 5.54487522387376, 5.54487522387376, 0.1019810751580458, 0.1019810751580458, 8.150029194086665, 8.150029194086665, 5.0618797862956075, 5.0618797862956075, 2.0461735085944057, 2.0461735085944057, 1.3357038301624233, 1.3357038301624233, 9.312076510394991, 9.312076510394991, 6.7200334565811675, 6.7200334565811675, 5.365106529103077, 5.365106529103077, 4.606752990431726, 4.606752990431726, 2.1625882477388463, 2.1625882477388463, 4.489710587425977, 4.489710587425977, 2.6538160714496826, 2.6538160714496826, 9.261557514741858, 9.261557514741858, 5.492407735193022, 5.492407735193022, 5.898062859739325, 5.898062859739325, 7.021114377625942, 7.021114377625942, 12.14089670656665, 12.14089670656665, 0.18958798768988133, 0.18958798768988133, 4.678221074985068, 4.678221074985068, 5.78216818089379, 5.78216818089379, 4.693623897748934, 4.693623897748934, -0.7679063832741491, -0.7679063832741491, 8.75747870549389, 8.75747870549389, 2.0231422310719953, 2.0231422310719953, 3.7547067154385863, 3.7547067154385863, 8.391565092892709, 8.391565092892709, 6.935277601223014, 6.935277601223014, 4.382997172758384, 4.382997172758384, 10.367595025362611, 10.367595025362611, 4.366382039130507, 4.366382039130507, 11.4033636014529, 11.4033636014529, 8.601966229480814, 8.601966229480814, 15.373847955455176, 15.373847955455176, 9.213055955425792, 9.213055955425792, 3.7154444643729243, 3.7154444643729243, 10.315698776670954, 10.315698776670954, 4.375225744720115, 4.375225744720115, 7.281405050815447, 7.281405050815447, 12.234785349576311, 12.234785349576311, 5.531116970546703, 5.531116970546703, 2.0346901738998753, 2.0346901738998753, 5.125256548823173, 5.125256548823173, 4.929194983267542, 4.929194983267542, 1.0683520192497358, 1.0683520192497358, 9.42513053873391, 9.42513053873391, -4.465253472060389, -4.465253472060389, 12.976195982212499, 12.976195982212499, 5.691420900869769, 5.691420900869769, 3.1382960008320864, 3.1382960008320864, 4.341963879677074, 4.341963879677074, 2.271341246549988, 2.271341246549988, 4.925216596389286, 4.925216596389286, 11.85476604084762, 11.85476604084762, 10.839295610579791, 10.839295610579791, 3.126665808210639, 3.126665808210639, 2.1972453344435325, 2.1972453344435325, 8.67654632925455, 8.67654632925455, 5.146545736990579, 5.146545736990579, 5.675445394020985, 5.675445394020985, 14.250221251471537, 14.250221251471537, 1.0090768901204388, 1.0090768901204388, 13.681278259137066, 13.681278259137066, 8.523074108002032, 8.523074108002032, 9.351178486101357, 9.351178486101357, 5.837254431327473, 5.837254431327473, 3.238399651340999, 3.238399651340999, 5.530090646087695, 5.530090646087695, 8.11391264755715, 8.11391264755715, 16.987941670071073, 16.987941670071073, 5.780986366530563, 5.780986366530563, 6.451143247799831, 6.451143247799831, 11.907177490267228, 11.907177490267228, 1.8559756643247773, 1.8559756643247773, 9.431747634963354, 9.431747634963354, 10.144093397213295, 10.144093397213295, 8.87542421594484, 8.87542421594484, 4.472310067673715, 4.472310067673715, 8.539626876605366, 8.539626876605366, 5.696577351217427, 5.696577351217427, 3.2944892338311806, 3.2944892338311806, 3.6770013470621064, 3.6770013470621064, 16.304710654378145, 16.304710654378145, -1.3987052241275784, -1.3987052241275784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34297638883345566, "mean_inference_ms": 2.2650035039204846, "mean_action_processing_ms": 0.09817196036684835, "mean_env_wait_ms": 0.5947976803916978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 97875, "timesteps_this_iter": 0, "agent_timesteps_total": 293625, "timers": {"sample_time_ms": 13594.477, "sample_throughput": 248.263, "load_time_ms": 0.304, "load_throughput": 11094737.832, "learn_time_ms": 2195.015, "learn_throughput": 1537.575, "update_time_ms": 26.825}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 16.663750457763673, "policy_loss": 0.00513472108868882, "vf_loss": 16.668612670898437, "vf_explained_var": -0.11892496347427368, "kl": 0.0038973144434254594, "entropy": 0.9996784567832947, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.4829322576522825, "policy_loss": -0.01531144194304943, "vf_loss": 6.507778263092041, "vf_explained_var": -0.034923842549324034, "kl": 0.007480564222263767, "entropy": 0.9721447587013244, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 97875, "num_agent_steps_sampled": 293625, "num_steps_trained": 97875, "num_agent_steps_trained": 293625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3915, "training_iteration": 29, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-54-05", "timestamp": 1706108045, "time_this_iter_s": 12.363513231277466, "time_total_s": 390.54162073135376, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A0B24C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 390.54162073135376, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.80625, "ram_util_percent": 65.38125, "gpu_util_percent0": 0.05875, "vram_util_percent0": 0.224365234375}}
{"episode_reward_max": 24.843810771207202, "episode_reward_min": -18.483099632580373, "episode_reward_mean": -0.6275501521434832, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.85245585011513, "policy_agent_": -3.3003728622251325}, "policy_reward_max": {"policy_adversary_": -4.407596868243217, "policy_agent_": 30.84813331066117}, "policy_reward_mean": {"policy_adversary_": -13.103378835439543, "policy_agent_": 6.237914341648031}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1009846945057937, -2.7230065389450324, -1.8529614756827602, -0.18775985307804033, -1.7868214295046734, -3.488024283111397, 1.9706096861732498, -6.5674166972559, -0.5892722942894413, -1.3336384112338378, 5.53548669780637, -0.15031997978995604, -5.85313030351199, -3.1725047030366627, 0.6583400350813742, -2.27760641964975, -0.32980351473169, 14.101704628649403, -7.197921001957669, -2.7909201910916552, 1.0734989616568995, -5.993496798107442, 0.185941162910099, 5.390623085442294, 0.2738099662374037, -5.027686763203851, -1.5634952526403183, -5.691281312796942, 1.0466900939795032, -0.040731064704528724, -4.700942043560366, 2.0109475486368478, -4.076268318503171, -7.0190194588455705, 2.035519964647755, 4.017234846850405, 0.8254061342087633, 0.14870596241202916, -2.9925824875829075, 8.12012839570865, 2.345184162475908, -1.2625545618280374, -2.15757091165037, 1.4015199324562329, -3.12984052230821, -0.5306197626056562, -1.514308137703747, -6.25499777065826, -3.5784874853314927, 1.123299443028579, 2.0646975999254904, -1.346266490870132, -1.1168461705392723, -18.483099632580373, -4.810395753028648, -2.7706766922354022, 5.257130225920811, 3.864587164075165, -3.768691736642273, 1.2548674981270174, 0.877694965400837, -2.6076051145966104, -0.28191718417182926, 24.843810771207202, 1.0373198116743616, -3.863564221686513, 6.717931564126062, -1.2997011242999323, 5.938198321425071, -5.492715710813192, -6.6127673544351175, 4.471656440641066, -4.222420583326244, -13.808530729455374, 1.5465556983045758, -0.8893403435547325, 4.594549159401728, 3.7320972423129484, -7.830050547671997, 4.684912295908057, -2.485200849388415, -4.15454365437722, -0.7224151055995865, -9.728116691862487, 3.287560216492932, -3.8844723045426557, 6.886377419037992, 3.16522377255229, -10.605563157120145, -1.5919874441682633, 4.5214596607982305, -7.078058286207806, -5.772444726150081, 3.3356050631408887, -0.21606297763749227, -10.762774897401941, 6.8158390609053665, -1.0457641973939438, 10.429310841775925, 0.07694251789416462, -6.348827057678895, -4.839563967134495, 3.1040195318824257, 11.817262655557943, 0.9328118109219469, 8.94196434390996, -1.2001137298432996, 10.368286270530586, 6.071447399767675, 3.4714529691758873, 6.4355407192055845, 2.931095538010638, 3.8145204293032746, 2.3006960826479035, 1.4663559272504665, 3.3496518162644673, -1.9793424123244439, -1.0971637544843245, -15.299713024161974, 5.235718047781144, -0.08094641403085956, -11.70942905539579, -1.634760316854823, -8.47533011865019, -4.932527372215584, 0.78204964505447, 7.90613402434488, -8.64704267789113, 2.0347612120596503, -10.135157611851007, -4.1301791382737045, 3.605584244486704, -3.437323210201004, -15.608946479571447, 0.5847638497803952], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.483502114607544, -12.035378489330352, -6.498411635661144, -24.216761732348324, -7.732689284892914, -15.573839037307875, -13.431128068876967, -8.3177281540264, -8.461642294493153, -21.933856140729002, -17.280888650288478, -10.480048557247525, -25.624753741463312, -13.426710798406335, -11.82577237755361, -12.749678204270804, -10.200632318097206, -22.26707945641196, -15.199265523852807, -20.745031520129714, -11.02448345084254, -15.904927953179744, -11.43598850747938, -16.250967231272377, -8.055950163958208, -8.643235782016852, -25.78994555774561, -10.361830016556812, -7.529698637701524, -10.89143006882121, -5.54145447460415, -11.737849329324334, -11.94022390169792, -8.994213413881084, -12.985746881573583, -9.639573671476382, -18.658762533474793, -17.470321365831285, -6.06152154059046, -23.080442531551988, -13.106300887902236, -11.655145526766557, -8.990236463964878, -16.80019052496542, -10.074647583310297, -13.872970321502478, -8.613728346357082, -14.824436541463271, -4.407596868243217, -8.430145898339674, -12.724507150847742, -15.677141282296633, -7.006257201578805, -20.057051207428223, -12.970145918708358, -10.295930517794915, -13.308804358664815, -19.874250715958663, -8.57833771420832, -11.684810579624324, -6.423490557237974, -8.851578616404197, -9.42409641861448, -36.85245585011513, -8.129969195850304, -6.068347873563166, -25.239475853430008, -8.392453731969649, -16.875679877591796, -28.26079167358563, -9.694212207249288, -13.700717797610517, -10.627352897878467, -17.154371437509063, -11.470456324304246, -16.235290647325357, -12.863332077488838, -14.561471590653028, -16.027871261806617, -15.558712487491112, -9.349355170402548, -7.132357432495892, -5.93318896563713, -6.295520577075741, -15.949990976082528, -9.319621717486784, -13.9342641783232, -7.758667492237212, -15.643937097339311, -12.76336079729574, -20.06969775684129, -9.242707609838654, -7.387705785290503, -13.933070469320178, -14.001067803846365, -11.437362206053455, -18.048391265549522, -11.529227686712153, -17.151874738667797, -10.165389685338205, -7.642163759845226, -11.80572507269912, -12.646852855154316, -18.837307525942634, -7.942452130334515, -21.23718516453026, -18.388797759034574, -18.89791815199926, -15.187782899914941, -10.567654492084118, -19.258309532894728, -11.20018343200032, -14.071702902552989, -18.77172416366001, -10.290353898573441, -13.352776944341027, -9.516830283697955, -7.353845971203545, -8.698967299711708, -14.9830186253422, -15.35759499020289, -20.558201353073024, -12.732303204337592, -10.225031139545239, -4.876471826531892, -9.600311039077525, -19.866780439336594, -17.95745742979325, -7.869878154622757, -11.539589749413974, -15.999144972561401, -11.006240194612289, -5.603644455320758, -12.369763050547656, -10.84728940683], "policy_policy_agent__reward": [5.292243404556668, 5.292243404556668, 4.656185975192657, 4.656185975192657, 2.322725079989193, 2.322725079989193, 12.014500939635143, 12.014500939635143, 2.9729339276941182, 2.9729339276941182, 6.042907377098241, 6.042907377098241, 7.700868877525112, 7.700868877525112, 0.8751557283852522, 0.8751557283852522, 3.936185000101857, 3.936185000101857, 10.300108864747582, 10.300108864747582, 11.408187674047422, 11.408187674047422, 5.1648642887287854, 5.1648642887287854, 9.88581171897566, 9.88581171897566, 5.127103047684834, 5.127103047684834, 6.242056206317493, 6.242056206317493, 5.236035892310526, 5.236035892310526, 4.935414401682758, 4.935414401682758, 18.184392042530686, 18.184392042530686, 4.000672260947567, 4.000672260947567, 8.977055664519028, 8.977055664519028, 6.0489912062497195, 6.0489912062497195, 4.955715577536152, 4.955715577536152, 5.810964835194739, 5.810964835194739, 10.820795158357335, 10.820795158357335, 4.164880065097805, 4.164880065097805, 1.8077745094064992, 1.8077745094064992, 12.113225152552648, 12.113225152552648, 2.335274351879936, 2.335274351879936, 4.288194365840514, 4.288194365840514, 5.425349502058341, 5.425349502058341, 0.42025621552189196, 0.42025621552189196, 6.874398438980591, 6.874398438980591, 3.9319777915973746, 3.9319777915973746, 0.9875969775177533, 0.9875969775177533, 7.510633423110669, 7.510633423110669, 6.828404259163396, 6.828404259163396, 9.742084333841778, 9.742084333841778, 8.809513664121654, 8.809513664121654, 1.5344695265037762, 1.5344695265037762, 15.600285463630325, 15.600285463630325, 7.7257425251890695, 7.7257425251890695, 5.196295482469258, 5.196295482469258, 3.416332776157254, 3.416332776157254, 9.100855228710827, 9.100855228710827, 3.4724035305010434, 3.4724035305010434, 6.671175279448412, 6.671175279448412, 3.5497101043266666, 3.5497101043266666, 4.2847193854025045, 4.2847193854025045, 0.414554691455861, 0.414554691455861, 4.776722670684128, 4.776722670684128, 7.3946023753866195, 7.3946023753866195, 7.16543739571325, 7.16543739571325, 2.9447055155197663, 2.9447055155197663, 0.7869757874239255, 0.7869757874239255, 4.0798750828398544, 4.0798750828398544, 3.7626269127797554, 3.7626269127797554, 9.282967292292813, 9.282967292292813, 11.869418940016908, 11.869418940016908, 2.4048229887830255, 2.4048229887830255, 6.469839038875672, 6.469839038875672, 3.650592761319405, 3.650592761319405, 3.121986750903792, 3.121986750903792, 4.571089617221325, 4.571089617221325, 30.84813331066117, 30.84813331066117, 4.583644503762333, 4.583644503762333, 1.1023918259383272, 1.1023918259383272, 15.978703708778042, 15.978703708778042, 3.546376303834858, 3.546376303834858, 11.406939099508435, 11.406939099508435, 11.384037981386221, 11.384037981386221, 1.5407224264070822, 1.5407224264070822, 9.086187119125793, 9.086187119125793, 3.2024661572761097, 3.2024661572761097, 1.6729203540268527, 1.6729203540268527, 6.5085060113044095, 6.5085060113044095, 7.672975151885314, 7.672975151885314, 8.728940618445282, 8.728940618445282, 9.146784416482987, 9.146784416482987, 4.09891035706731, 4.09891035706731, 10.121812391699587, 10.121812391699587, 3.432077160507064, 3.432077160507064, 1.488906889059336, 1.488906889059336, 2.605386930018771, 2.605386930018771, -1.7162980573933742, -1.7162980573933742, 9.618775596287726, 9.618775596287726, 2.7175747064720657, 2.7175747064720657, 10.410320798680598, 10.410320798680598, 5.461945632394751, 5.461945632394751, 2.519186970109586, 2.519186970109586, 5.585686676563737, 5.585686676563737, 12.295578708819761, 12.295578708819761, 1.082324661815421, 1.082324661815421, 0.8076305295702098, 0.8076305295702098, 8.634337766230534, 8.634337766230534, 6.892502413104437, 6.892502413104437, 0.3372936543257544, 0.3372936543257544, 12.432115163227444, 12.432115163227444, 5.241731744659104, 5.241731744659104, 13.79059279022186, 13.79059279022186, 5.121166101616186, 5.121166101616186, 0.6466683510831657, 0.6466683510831657, 3.4830805527823117, 3.4830805527823117, 7.875436193518371, 7.875436193518371, 15.32728509075029, 15.32728509075029, 4.43763197062823, 4.43763197062823, 15.089574754220116, 15.089574754220116, 8.594342014595634, 8.594342014595634, 14.633102211264925, 14.633102211264925, 10.629615149841307, 10.629615149841307, 7.019553730630001, 7.019553730630001, 12.846925126050156, 12.846925126050156, 7.065639485005481, 7.065639485005481, 8.94311166592813, 8.94311166592813, 10.536210123153962, 10.536210123153962, 5.878354912911953, 5.878354912911953, 8.351214380302745, 8.351214380302745, 3.7687439356867554, 3.7687439356867554, 3.128341108359611, 3.128341108359611, -3.3003728622251325, -3.3003728622251325, 10.10936833656167, 10.10936833656167, 7.638324288086019, 7.638324288086019, 4.424386148838616, 4.424386148838616, 5.548771443741385, 5.548771443741385, 0.8748505104475268, 0.8748505104475268, -0.02802777284184771, -0.02802777284184771, 5.191180342065998, 5.191180342065998, 13.886457231840739, 13.886457231840739, 4.655207375951055, 4.655207375951055, 4.952319683341203, 4.952319683341203, 0.7022160687814832, 0.7022160687814832, 5.934482917143846, 5.934482917143846, 7.305912219549495, 7.305912219549495, 1.0831606225598778, 1.0831606225598778, -1.6195917145118985, -1.6195917145118985, 5.7160266283051975, 5.7160266283051975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34381894775510574, "mean_inference_ms": 2.2666780230903845, "mean_action_processing_ms": 0.09827738432934649, "mean_env_wait_ms": 0.594961239297296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 101250, "timesteps_this_iter": 0, "agent_timesteps_total": 303750, "timers": {"sample_time_ms": 13601.322, "sample_throughput": 248.138, "load_time_ms": 0.302, "load_throughput": 11191221.44, "learn_time_ms": 2205.936, "learn_throughput": 1529.963, "update_time_ms": 26.623}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 19.625573921203614, "policy_loss": 0.009988803463056684, "vf_loss": 19.625203132629395, "vf_explained_var": -0.07647138833999634, "kl": 0.005215128544188863, "entropy": 0.961863923072815, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.76328604221344, "policy_loss": -0.0194577740970999, "vf_loss": 7.792210435867309, "vf_explained_var": -0.00265047550201416, "kl": 0.006308609769971862, "entropy": 0.9624540597200394, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 101250, "num_agent_steps_sampled": 303750, "num_steps_trained": 101250, "num_agent_steps_trained": 303750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4050, "training_iteration": 30, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-54-19", "timestamp": 1706108059, "time_this_iter_s": 13.878145456314087, "time_total_s": 404.41976618766785, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6BAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 404.41976618766785, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 37.727777777777774, "ram_util_percent": 65.96666666666667, "gpu_util_percent0": 0.07222222222222224, "vram_util_percent0": 0.2259250217013889}}
{"episode_reward_max": 17.980411256846377, "episode_reward_min": -17.130053571455505, "episode_reward_mean": -0.4869881258513403, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.58465561608552, "policy_agent_": -3.095600172982986}, "policy_reward_max": {"policy_adversary_": -5.385300600234942, "policy_agent_": 22.400550411742003}, "policy_reward_mean": {"policy_adversary_": -13.77516905537722, "policy_agent_": 6.64409046476294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.535430254542588, -2.0263099489922576, -2.5449548476345973, 2.4424772387926392, -2.4374934989840757, -5.849787971326282, -1.0558385825293914, -2.479063854318352, 0.6132520483223489, -2.422035347812371, -0.8095573349496722, 6.0977890547041405, 7.267492513172955, -10.674786469378832, -1.5666505282600465, -0.30204953210540864, -1.0454916846631224, 2.9069260998825777, 4.717746452540965, -2.418155101402529, -1.2687110437337399, 6.523621273391568, 1.5255461219724236, 4.918722057404175, 1.9692663681778537, -4.452204553498748, 1.6873948491723507, 17.980411256846377, -0.6232281995382629, 1.8214511510147553, -17.130053571455505, -5.748791315108165, -3.2313788061813966, -3.9568870865077046, 0.980622869109093, -7.715078642118055, -5.764615881055011, -0.31096477142416457, -2.483727854124121, -1.7837690526777346, 6.912696786413562, 5.140763639387485, -9.238818571820756, -6.395331277597098, -5.535280171435639, 17.966310882679092, 3.01035598792842, -3.160623320072628, -0.7114908193512011, 0.3396744928091924, -1.0305710256220832, -1.2293475684250925, -12.48391958847629, -6.185606292440593, -2.4890822218893147, -7.3102259341332285, -3.069843216739595, -3.939001384615829, -3.8935283070265148, -4.303729946757216, 0.31642883087340795, 9.107104822974826, -13.779094935506073, -4.196982270577503, -5.867547770451707, -2.8304312303144705, -4.000646677709528, -8.318983402012538, -0.23408717514314586, -6.106952889980683, -7.258120326441182, 1.043848073831942, -6.662030984780577, -3.0294395454754324, 1.4309193719304174, 6.0087782869706725, 0.595918242732292, 0.2308479524061824, 9.241584956075545, 2.9784134241051192, 0.2119378341616048, -2.1295942888993937, -3.227063460324289, 3.0316668644494436, 4.706647108170699, -1.8202922209826133, 15.032087233279288, 3.1022264396233696, -2.820048554724062, 4.015980854939543, -10.554451825621001, -11.801035663893403, 2.030830925557519, 5.16774557151156, -9.468038858897623, 7.4038881610160034, 0.8530253561209018, 6.173187091613283, 13.83632403820153, 4.108431832057292, -0.5502978541585193, -4.255729684921048, 3.444903280511701, 2.8699731160078428, -3.0313540517223747, 2.462956051736829, 4.4834661600422745, -1.486035042502834, 0.7178120041241483, 0.18961190645502107, 1.5176195376955937, -0.06001100263728487, 0.06422096769845625, 2.6255459270274426, 1.3886082703338847, -4.161355329419252, 6.807500355327842, -1.8188982826558324, -4.368478126084779, 0.07306305379852782, -1.63569087394786, -4.72791728795193, 10.514388608231963, -5.330368482540288, -4.5261192246987685, 0.5774101904292859, 2.2517151113263516, 3.032815250354175, -1.0722806153698976, -4.123261529865053, 1.0072251588222985, 10.591520204312527, -0.7381991418714468, 4.57522912852322, -8.785071696207151], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.64655057224807, -10.196541090806006, -7.893406587310645, -10.035994709390076, -7.650243392064206, -19.652800818323378, -5.987120163500524, -8.781764561427307, -6.22931912358644, -5.385300600234942, -11.39472811346068, -17.088137364053953, -18.1329516357408, -18.297714498493306, -7.255947681891408, -8.7799889845653, -9.335539944001455, -14.364034154461113, -20.85028257664375, -8.745033663027684, -11.545025847233742, -14.002159609430755, -14.651006360409427, -15.592109218700788, -6.72133470589358, -8.957216552656682, -14.093805911047614, -24.628843835922275, -7.262118080829438, -27.398110252521665, -10.938853225489536, -8.577940794664752, -5.894958885587311, -19.781480922801965, -9.070649411349466, -8.51999105848179, -23.47127335206024, -14.003952874785535, -6.506824378376959, -8.919785571747735, -19.114256367094054, -12.336695252413183, -28.092430512466827, -14.626653146825525, -10.3913185131177, -26.834789940804917, -12.539109937260179, -8.789148417072987, -9.363804329013918, -17.34267150767857, -9.045505376944787, -8.272063468609991, -10.340368639206922, -11.447325048632168, -16.967372024265938, -14.383759947580474, -10.89008313302551, -19.13083561728109, -7.326186461574667, -10.034008716157427, -13.825588334954759, -30.58465561608552, -16.695263044671435, -10.670721590885458, -8.472269281594528, -10.594450551520357, -18.98294955959777, -13.801717060383655, -13.86591265699232, -7.1128148153361765, -13.641940452154108, -11.391198842434141, -15.036367782981442, -11.338340937555254, -21.993128608776495, -19.988959552853842, -14.008732296916834, -10.305072790820027, -23.922592261889108, -12.887771291966185, -12.289998579582413, -5.793095845677905, -11.25631546931117, -24.845981193560995, -12.462760207840804, -10.400940636925938, -22.470781876413305, -18.22395543362525, -17.3460370119546, -14.130814612723036, -12.499446166935282, -21.8071881667497, -12.263806515250103, -17.66085886580039, -15.841582614643206, -20.20513273956807, -10.686823573640591, -13.660149037490768, -26.298266759203425, -12.195503037560153, -7.16645242039054, -10.480491616129624, -15.488205764061888, -12.871810503850499, -6.260818727362326, -12.075313182824946, -20.15483058524422, -12.034318623634267, -8.326216074167991, -9.737076859415486, -14.35889034825171, -12.120400626767395, -15.90611867664497, -9.138233886919044, -16.210699437652927, -14.346828666227053, -21.884184352100714, -22.986228953260103, -8.539102472435877, -6.344644833697146, -5.848472915507352, -10.305792550509286, -21.550695377781622, -20.84791443694889, -19.313206937737576, -16.386019953878975, -9.347867945541479, -9.558031709573818, -15.331979683159766, -14.206385329312544, -16.53683818445206, -23.97138468689073, -10.176369620152943, -20.90543648754707, -13.961446928816148], "policy_policy_agent__reward": [2.55556015885274, 2.55556015885274, 4.085115570906875, 4.085115570906875, 2.6742258698380224, 2.6742258698380224, 6.239235974091358, 6.239235974091358, 2.606374946540063, 2.606374946540063, 6.901506423498547, 6.901506423498547, 2.4656407904855664, 2.4656407904855664, 3.15135035355448, 3.15135035355448, 3.421285585954394, 3.421285585954394, 1.4816326262112847, 1.4816326262112847, 5.292585389255504, 5.292585389255504, 11.592963209379056, 11.592963209379056, 12.700222074456882, 12.700222074456882, 3.8114640145572403, 3.8114640145572403, 2.8446485768156804, 2.8446485768156804, 4.238969726229946, 4.238969726229946, 4.1450241296691654, 4.1450241296691654, 8.635480127171844, 8.635480127171844, 12.784014514592355, 12.784014514592355, 3.1634392808125775, 3.1634392808125775, 5.138157401749998, 5.138157401749998, 10.262890441411162, 10.262890441411162, 8.088276241190927, 8.088276241190927, 10.255415638052476, 10.255415638052476, 4.345300537035715, 4.345300537035715, 2.2525059995789665, 2.2525059995789665, 7.890600380109982, 7.890600380109982, 21.304627546384324, 21.304627546384324, 3.3194449406455857, 3.3194449406455857, 14.60978070176821, 14.60978070176821, -3.095600172982986, -3.095600172982986, 1.414574739778292, 1.414574739778292, 1.3317900397029567, 1.3317900397029567, 7.912296918147131, 7.912296918147131, 5.02563614022928, 5.02563614022928, 0.4024562081818673, 0.4024562081818673, 8.853328735502615, 8.853328735502615, 6.846494051680688, 6.846494051680688, 2.0115482621264196, 2.0115482621264196, 3.5680082595349996, 3.5680082595349996, 13.01347657675381, 13.01347657675381, 8.738729445900336, 8.738729445900336, 9.42680597032304, 9.42680597032304, 4.115660934614215, 4.115660934614215, 2.4280191708410306, 2.4280191708410306, 22.400550411742003, 22.400550411742003, 7.7747329625943005, 7.7747329625943005, 2.8142625485001798, 2.8142625485001798, 4.326156754831358, 4.326156754831358, 8.841173000243884, 8.841173000243884, 4.007467175661351, 4.007467175661351, 3.5213579500924497, 3.5213579500924497, -1.0717754746346788, -1.0717754746346788, 2.630859378095785, 2.630859378095785, 7.239144901188313, 7.239144901188313, 3.5367670067236245, 3.5367670067236245, 3.9101199581429573, 3.9101199581429573, 7.595917116332632, 7.595917116332632, 1.7163290772740774, 1.7163290772740774, 2.8651393847001065, 2.8651393847001065, 7.071008582914085, 7.071008582914085, 19.845880219530176, 19.845880219530176, 1.458084054582677, 1.458084054582677, 3.236869660153977, 3.236869660153977, 1.3023607555714096, 1.3023607555714096, 3.882009660602944, 3.882009660602944, 7.491151440944119, 7.491151440944119, 2.741366829185555, 2.741366829185555, 6.8159127409245865, 6.8159127409245865, 0.5029309626777465, 0.5029309626777465, 3.1919100628564623, 3.1919100628564623, 6.2175234581330425, 6.2175234581330425, 4.1871683991004325, 4.1871683991004325, 4.154450696039908, 4.154450696039908, 11.712023990353451, 11.712023990353451, 12.998868919912255, 12.998868919912255, 7.302325269824567, 7.302325269824567, 5.267960371613106, 5.267960371613106, 16.58208860898232, 16.58208860898232, 7.933092358035652, 7.933092358035652, 6.2509682068720105, 6.2509682068720105, 1.8317507783892566, 1.8317507783892566, 4.014626004493441, 4.014626004493441, 13.93882402900522, 13.93882402900522, 8.584703658005749, 8.584703658005749, 4.290324207971662, 4.290324207971662, 18.75143455484629, 18.75143455484629, 10.663090936624313, 10.663090936624313, 7.262994228615269, 7.262994228615269, 9.073397733831293, 9.073397733831293, 0.9724971706571404, 0.9724971706571404, 5.003076251428151, 5.003076251428151, 7.1473187204038116, 7.1473187204038116, 11.414302218655976, 11.414302218655976, 3.1867718778727916, 3.1867718778727916, 13.80451045029204, 13.80451045029204, 5.7699244648807495, 5.7699244648807495, 9.916668064552022, 9.916668064552022, 20.067295398702484, 20.067295398702484, 8.151967434808721, 8.151967434808721, 3.3080772831160097, 3.3080772831160097, 3.1123809656042862, 3.1123809656042862, 9.466554522286796, 9.466554522286796, 7.870891809929173, 7.870891809929173, 1.614732337819977, 1.614732337819977, 7.269134617280889, 7.269134617280889, 12.319148372643244, 12.319148372643244, 5.274141790565715, 5.274141790565715, 4.52201403914607, 4.52201403914607, 4.9633443829352535, 4.9633443829352535, 7.938254942973657, 7.938254942973657, 6.030194812065056, 6.030194812065056, 7.985169822171713, 7.985169822171713, 5.881889906973244, 5.881889906973244, 8.799653853993405, 8.799653853993405, 5.092736668403899, 5.092736668403899, 14.34584235371427, 14.34584235371427, 10.583665335302136, 10.583665335302136, 2.0853121731755477, 2.0853121731755477, 3.208853943747837, 3.208853943747837, 2.1063910207797463, 2.1063910207797463, 2.7889376312786798, 2.7889376312786798, 16.03254199300679, 16.03254199300679, 7.758772977204299, 7.758772977204299, 7.393543856519406, 7.393543856519406, 8.481715072154127, 8.481715072154127, 5.799791528433915, 5.799791528433915, 6.295423479963997, 6.295423479963997, 7.129849533894937, 7.129849533894937, 5.041561899723743, 5.041561899723743, 8.772031671637174, 8.772031671637174, 17.28145244560163, 17.28145244560163, 4.719085239140749, 4.719085239140749, 12.740332808035143, 12.740332808035143, 2.588187616304497, 2.588187616304497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34485737441691977, "mean_inference_ms": 2.2745138233922066, "mean_action_processing_ms": 0.09877400280040854, "mean_env_wait_ms": 0.5969392790087917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 104625, "timesteps_this_iter": 0, "agent_timesteps_total": 313875, "timers": {"sample_time_ms": 13799.62, "sample_throughput": 244.572, "load_time_ms": 0.199, "load_throughput": 16922625.224, "learn_time_ms": 2233.588, "learn_throughput": 1511.022, "update_time_ms": 26.524}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 20.72719535827637, "policy_loss": -0.008148995274677873, "vf_loss": 20.74491653442383, "vf_explained_var": -0.06328758001327514, "kl": 0.004435479639037909, "entropy": 0.9571292936801911, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.873741102218628, "policy_loss": -0.0015481260605156421, "vf_loss": 7.884611129760742, "vf_explained_var": 0.001776123046875, "kl": 0.0067941151011285394, "entropy": 0.949184513092041, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104625, "num_agent_steps_sampled": 313875, "num_steps_trained": 104625, "num_agent_steps_trained": 313875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4185, "training_iteration": 31, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-54-34", "timestamp": 1706108074, "time_this_iter_s": 14.842196464538574, "time_total_s": 419.2619626522064, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A0B2790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 419.2619626522064, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.1157894736842, "ram_util_percent": 66.49473684210525, "gpu_util_percent0": 0.1526315789473684, "vram_util_percent0": 0.23555715460526316}}
{"episode_reward_max": 12.652823993731305, "episode_reward_min": -19.14705890082542, "episode_reward_mean": -1.223613669747757, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.10416173184304, "policy_agent_": -3.0021716081132945}, "policy_reward_max": {"policy_adversary_": -5.5635052948999855, "policy_agent_": 18.54120984921781}, "policy_reward_mean": {"policy_adversary_": -12.75063014185949, "policy_agent_": 5.763508236055867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0272746136243303, -10.132823785190329, -0.2564931806789984, 0.17933659791973494, -16.09205918533907, -5.502836955366544, -5.132116850747679, -4.567707012831151, -4.742875801757171, 3.7626311066298532, 1.843531880075692, 4.479966789150053, -3.8111363429045424, 2.2917003007826935, -5.367650380345948, -3.7003895273115615, -1.2043979194101881, 1.5061780615737583, -0.8401615918730048, 4.7211026960017115, -4.018032439827243, 0.27865537872143453, -4.578818528010588, 6.577992296921201, -5.255746852792392, 1.315575589459955, 6.896700078915565, -0.7435709296242554, -1.1437469876607058, -0.17878595565260735, 3.78189029936702, -2.2031678467914255, 2.2061888983076496, -2.8407379283778735, 2.2749442682611396, 0.9316622685382148, 12.652823993731305, -6.716437352654955, 1.309768623624223, -3.2871069732869427, -1.5242060635821544, 0.800471921127005, -2.160330352003887, 6.204342417835405, -3.2621667985297225, -5.099590891580583, -0.35440966966191456, 9.16776126132394, 2.334915024598393, 3.2558793499600016, 0.5656204980901626, -3.060405126204573, 0.2789427624400578, -1.823019414365689, -6.829409196945113, -9.063584486177351, -6.310070745207057, -9.031740215864279, -19.14705890082542, 2.5701266116320243, -1.4521171162903395, -3.300278240626657, 2.7561129332024223, -5.403853168562031, -3.4127462074377797, -2.5934604485725865, 0.8601127316128422, -4.804447617916905, 4.2373015195344355, -10.264421901048063, 3.1748129079068126, -4.753578343007987, 0.13194828989273616, 3.3417494423043403, -2.181034337611991, -0.79686347270828, 6.843806199192419, -9.849121543623497, 5.38338369325972, -5.975862094002514, -10.151099421857436, 4.194021773945727, -6.17835857071899, -5.724307813436969, -1.2427924997881672, -6.325877273599012, -3.464114865847237, 3.8014484357789415, -0.33743890102620355, 3.2941013105912487, -8.753308426481375, -3.6718593544886113, 1.211726953412662, -8.180176989600609, -2.3457977609486274, -3.945553947296313, -6.984898829267814, -1.647605838971742, 12.440744376641932, -13.445008625401256, 2.825189069526288, -5.9841066626607935, 5.321446855730331, 4.1790745991416305, 2.0200634901747105, -3.985806454479027, 3.5506104478028337, -0.37023777325824025, 0.9290372285609536, 0.9917950033249423, 0.9006757440279538, 0.11926342082133362, -8.573120425231647, -1.152223858292077, 8.345403084805028, -0.05312960150449998, -3.5199903091862725, -1.154590479297868, 2.6833748223655562, -0.1576837865726618, -7.472165133679423, -1.4237601628009513, -6.1171524325321665, 6.372686927577188, -2.0749971773932647, -7.866048808440356, -0.6522070375240726, 4.272041706042752, -3.8840695109822487, 5.726720452452982, 4.029348084003541, 3.537675134680411, -2.356934837184601, -4.522862842570121, 0.6103574502377749], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.077812116500336, -21.12793787467441, -20.971642390121417, -16.171953797633144, -10.941592245906179, -8.359556215158388, -12.923898666145014, -6.711933996696472, -9.03525633602582, -9.486032819153165, -13.614366882684664, -21.203090816572434, -9.111045510280457, -9.813250970438311, -6.4111054360079045, -6.184698756802864, -7.44704984031606, -16.156579606036452, -8.805270012661765, -11.32937054370324, -8.92737660809553, -8.043676036900438, -17.670643965380677, -17.656160206253322, -15.239081231501228, -15.805529199927788, -20.5026973373303, -17.339698730161118, -6.376398138278935, -9.047545484590149, -13.231352652322444, -12.634194315048845, -10.133969723715776, -11.789520517200922, -11.387822513359104, -11.807145164733518, -19.601628678500926, -36.10416173184304, -13.210102740849793, -8.123474262548129, -10.296567050945404, -25.28134396201416, -12.194254585619229, -14.868496552274525, -11.634306737357232, -5.5635052948999855, -10.940086582000738, -16.462554825488542, -7.714952328221787, -8.285673907222325, -11.722107020242804, -6.0729406771408065, -19.25805221160292, -7.9575672771571755, -9.719071677432312, -15.226487122653737, -17.95943759046825, -8.190729385527943, -13.142715684598834, -14.05570782571174, -7.384675789667366, -10.490485226252655, -12.28162311390167, -9.949527888654778, -14.104868861299085, -9.747618048580987, -10.12470255020868, -5.632788868559154, -11.118821725823098, -11.443772637768726, -11.770865634644599, -6.388658995803013, -11.831618136163483, -9.227617307930952, -16.809187634805582, -14.34221490463057, -14.258688870925505, -11.634887346638907, -17.43211833886928, -15.267457837255074, -10.05638138635973, -11.394224541637701, -20.370222946800546, -17.461354345241837, -10.462548696785632, -20.30258242514955, -7.881098058856838, -13.78728218975591, -10.70309125100409, -12.81679672174941, -15.614528063034589, -10.127966970084067, -16.34153682947604, -17.347343810954914, -8.685927698534398, -15.894886825048435, -16.911945430616786, -10.487065478832616, -24.641675321793677, -13.313882797917762, -9.993961452708188, -11.492960354359148, -13.655358838071209, -19.23284992350384, -21.399131846177113, -11.084686642852741, -20.379644560386613, -8.41610917522952, -9.609421515425007, -9.436124079387799, -8.962044879969595, -9.64183416688023, -13.229117639400151, -11.692684369545749, -26.069223405335023, -9.154918018022103, -7.096110101702464, -6.499227902198692, -12.320700059657645, -8.976139519156204, -18.74224392173893, -8.336680712779742, -8.365578596715165, -13.204278237843681, -9.131631022162683, -19.35702580599333, -6.8604106198887, -12.704579641706513, -12.547751630998066, -16.658321116703927, -12.106060587816973, -16.359075523679277, -9.694574533357445, -12.711850845188959, -11.306034025830128], "policy_policy_agent__reward": [7.552543365062333, 7.552543365062333, 5.497557044742042, 5.497557044742042, 10.357574604721208, 10.357574604721208, 8.175645197776438, 8.175645197776438, -2.575233469716442, -2.575233469716442, 1.4283596298959236, 1.4283596298959236, 3.8958909076986723, 3.8958909076986723, 1.0721134919326636, 1.0721134919326636, 2.1461902671343234, 2.1461902671343234, 6.6243319628915085, 6.6243319628915085, 7.7289493813801755, 7.7289493813801755, 12.841528802861239, 12.841528802861239, 2.6499545836879568, 2.6499545836879568, 6.052475635610502, 6.052475635610502, 0.5217275278309778, 0.5217275278309778, 1.2421546147456515, 1.2421546147456515, 3.1213259604529364, 3.1213259604529364, 8.831378833805111, 8.831378833805111, 3.98255421039438, 3.98255421039438, 8.025236619852475, 8.025236619852475, 2.4546720841341454, 2.4546720841341454, 4.1611657078109365, 4.1611657078109365, 6.545912718685049, 6.545912718685049, 12.117076251587264, 12.117076251587264, 4.991667189354417, 4.991667189354417, 8.56055239469387, 8.56055239469387, 13.69969870812293, 13.69969870812293, 8.29806390026843, 8.29806390026843, 2.6163255753091144, 2.6163255753091144, 4.43437976446877, 4.43437976446877, 8.506621475844732, 8.506621475844732, 5.21551323412871, 5.21551323412871, 6.170079311011713, 6.170079311011713, 4.474391294411525, 4.474391294411525, 6.831383390810121, 6.831383390810121, 6.3694037166358655, 6.3694037166358655, 16.127226336116117, 16.127226336116117, 14.693862189594032, 14.693862189594032, 7.25993568223701, 7.25993568223701, 2.4181836446305938, 2.4181836446305938, 4.386180493681625, 4.386180493681625, 13.040907941570586, 13.040907941570586, 5.01696211680767, 5.01696211680767, 10.536419485054966, 10.536419485054966, 4.186069969413754, 4.186069969413754, 0.23195720165969944, 0.23195720165969944, 5.292838456169409, 5.292838456169409, 12.815158043406244, 12.815158043406244, 5.02493367641009, 5.02493367641009, 5.770776628591161, 5.770776628591161, 6.143863759166483, 6.143863759166483, 1.5062677754681175, 1.5062677754681175, 9.768497487021484, 9.768497487021484, 3.0672739313957424, 3.0672739313957424, 1.4448312402435992, 1.4448312402435992, 3.081451318238193, 3.081451318238193, 5.8246834226305975, 5.8246834226305975, -0.4205054151681652, -0.4205054151681652, -3.0021716081132945, -3.0021716081132945, 8.312917218671883, 8.312917218671883, 2.9662793366885136, 2.9662793366885136, 3.5951034928129992, 3.5951034928129992, 7.518868023552046, 7.518868023552046, 2.2728373600463714, 2.2728373600463714, 5.346061326930651, 5.346061326930651, 3.577078800004199, 3.577078800004199, 5.49240764091076, 5.49240764091076, 0.41417062532112436, 0.41417062532112436, 7.678061622678767, 7.678061622678767, 0.5896753683603286, 0.5896753683603286, 7.472839271275704, 7.472839271275704, 0.8175403263975125, 0.8175403263975125, 5.98178321302811, 5.98178321302811, 6.284683375117644, 6.284683375117644, 7.314076648596793, 7.314076648596793, 6.772675715961144, 6.772675715961144, 10.551247535058963, 10.551247535058963, 0.8928829015077078, 0.8928829015077078, 11.407751016064497, 11.407751016064497, 4.64579787162628, 4.64579787162628, -0.04735901774885268, -0.04735901774885268, 7.794123157791717, 7.794123157791717, 7.095932188040778, 7.095932188040778, 5.868523265902432, 5.868523265902432, 4.609878098498731, 4.609878098498731, 6.9883525757752665, 6.9883525757752665, 2.208491596504802, 2.208491596504802, 8.794365312767429, 8.794365312767429, 5.182826174988945, 5.182826174988945, 8.055449016170328, 8.055449016170328, 3.430609818276607, 3.430609818276607, 3.2280538077977265, 3.2280538077977265, 8.77663189144435, 8.77663189144435, 4.583583410677155, 4.583583410677155, 3.1700649687928855, 3.1700649687928855, 5.974666438876058, 5.974666438876058, 4.963523300674488, 4.963523300674488, 4.419729819930438, 4.419729819930438, 18.54120984921781, 18.54120984921781, -0.06556291374174916, -0.06556291374174916, 6.409575261117238, 6.409575261117238, 2.7544268458491765, 2.7544268458491765, 9.48840284690077, 9.48840284690077, 11.705962261322734, 11.705962261322734, 11.709597668175908, 11.709597668175908, 3.5494400941868562, 3.5494400941868562, 11.965127504094726, 11.965127504094726, 4.02293570098564, 4.02293570098564, 5.269229371992981, 5.269229371992981, 5.21395954135637, 5.21395954135637, 4.931360311998776, 4.931360311998776, 4.8805487938507826, 4.8805487938507826, 2.327998607084249, 2.327998607084249, 5.2702302556268386, 5.2702302556268386, 17.20731324507003, 17.20731324507003, 4.550894208258801, 4.550894208258801, 1.7880598962580956, 1.7880598962580956, 2.672318711450412, 2.672318711450412, 7.502037441011601, 7.502037441011601, 4.409227866291771, 4.409227866291771, 5.635039394029754, 5.635039394029754, 3.4564602749893933, 3.4564602749893933, 1.1242130820914993, 1.1242130820914993, 9.788482582710435, 9.788482582710435, 3.5283169223847097, 3.5283169223847097, 5.745488498776488, 5.745488498776488, 3.1041017911823134, 3.1041017911823134, 8.488310673874633, 8.488310673874633, 4.33184106000791, 4.33184106000791, 11.192520784578454, 11.192520784578454, 8.067704335910259, 8.067704335910259, 9.948375329179845, 9.948375329179845, 3.668819848086423, 3.668819848086423, 4.094494001309421, 4.094494001309421, 5.958195738033951, 5.958195738033951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34543139714087207, "mean_inference_ms": 2.278533574028472, "mean_action_processing_ms": 0.09892078431762562, "mean_env_wait_ms": 0.5982064857776406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 13933.266, "sample_throughput": 242.226, "load_time_ms": 0.299, "load_throughput": 11277705.545, "learn_time_ms": 2242.934, "learn_throughput": 1504.725, "update_time_ms": 26.722}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 18.1411563873291, "policy_loss": -0.008855891390703618, "vf_loss": 18.159669876098633, "vf_explained_var": -0.06942797899246216, "kl": 0.007815809727424072, "entropy": 0.9657585620880127, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.058183002471924, "policy_loss": -0.0009227290749549866, "vf_loss": 6.068211483955383, "vf_explained_var": 0.009358829259872437, "kl": 0.006279980779828931, "entropy": 0.9262913018465042, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 324000, "num_steps_trained": 108000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4320, "training_iteration": 32, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-54-49", "timestamp": 1706108089, "time_this_iter_s": 14.182857275009155, "time_total_s": 433.4448199272156, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FA4DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 433.4448199272156, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.016666666666666, "ram_util_percent": 66.10555555555555, "gpu_util_percent0": 0.10555555555555557, "vram_util_percent0": 0.2325710720486111}}
{"episode_reward_max": 18.180997341425723, "episode_reward_min": -22.63179053318022, "episode_reward_mean": -0.6330861743145235, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.148174989545375, "policy_agent_": -2.773628307073794}, "policy_reward_max": {"policy_adversary_": -5.933288932420925, "policy_agent_": 23.16458616548555}, "policy_reward_mean": {"policy_adversary_": -12.731884268105674, "policy_agent_": 6.049399046895576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1317753661397596, -10.34155599031385, -2.5158041983562986, 1.0274560077046624, -7.057415032779179, -2.777789967416642, -0.3569728347911266, -4.860245951326518, -7.401163969647064, 1.8297520596747172, 0.2154523651543385, -0.8527876955767931, -1.552145775987015, 2.2038323409714238, 2.878438575365709, -0.6148570428953923, -1.8071702977060207, -3.6249469439014095, 0.40346291336551554, -5.089638441645241, 1.5332031867960099, -3.266596194039326, -6.9272714531593955, -5.630192902057985, -8.60560311033004, -6.03428012244593, 1.169280659501342, 3.9277905846490144, 6.907210629549681, -13.554295721270746, 6.553830889083922, 2.683965755172801, 4.855487591750351, 1.1409875198782058, 4.532192934956217, 1.0174919308011943, 4.422006955494516, 5.8492502959050325, 6.606438505786658, 18.180997341425723, 1.6917173827522014, 6.208744875574926, -3.2991270477602344, 1.4993526224489302, -2.4372199693894396, 5.555007253597011, -3.0458858522724874, -0.5277635091862385, -5.10912457430501, -2.601873007216116, -2.025931132899534, -1.2909578286979433, 3.132255375676997, 0.08388859420634572, -1.0343343176060071, -0.1615123278172686, 4.883975270302798, -0.6381371150826971, 0.6246757351698145, -2.1122304859032432, -1.3048773877738113, -0.837606808486691, 1.3867177386161786, -2.6912844896805264, -1.0814905606358531, -6.94453443118492, -6.1406569888579385, -8.399351014558523, 0.9414401048239824, 2.7494723584756366, 5.719850002970038, -0.7322193568706837, -9.234209847927282, 3.5956463780066374, -3.7724582839051184, 1.422548825081178, -7.619854185544469, 2.201326377635689, 0.8043691634655699, -2.145816666401014, -3.302018926941372, -6.029943736587689, -0.023666771848489088, -2.1555623880826253, -12.214484418167704, -2.102096425790519, 3.030665034153102, -6.024551960882884, -0.5071285204820926, -6.593100552917188, -3.702190231162325, -6.978545818632852, 6.062667401655944, -6.239119387193738, 1.4221364334278985, 1.0457491916566497, 3.066810998607598, 1.229745580858785, -0.588191865176604, 4.168291879117027, 10.88658890543276, -1.9137807204877704, 2.224888328996001, 5.137661687484203, 0.6455913331593338, 13.591233263897648, -8.06376394949387, -2.9830999038255683, 3.415866190609466, -0.47223042400076615, -5.660349534916036, 7.077616135352867, 5.183434417157538, 7.430799859448926, -5.891836505582172, -9.339578467807181, 9.505212147553893, -2.476012494950692, -5.282731048604264, 3.31794761021513, -22.63179053318022, 2.562979166263444, 0.5798999508281655, -12.059270845849346, -3.1134048032945176, 7.768609275523192, -0.6303641986650412, 12.609736182031794, 0.8587377890404617, -2.8622746340270093, -5.141580380218795, 5.752486095069162, 0.07725678794151747, -8.607715393697454, 0.22258876448143677], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.304956001855675, -8.713104734019105, -6.585095390798408, -12.722816576747304, -9.937146850226656, -7.307774593526961, -6.208283915794256, -8.979210913688206, -8.171963845302196, -10.572122528429107, -16.407356437506063, -9.640273196489009, -16.818011494528665, -10.92827051086268, -12.539478194778354, -15.023954775127041, -7.074339583276576, -6.8520851138291095, -10.796881116091573, -8.017597879517009, -10.481794871245045, -14.25422840289267, -7.36867400304513, -15.897635698778338, -10.802267523145783, -14.555343294839087, -10.823808687769713, -15.494352806650005, -15.682634973467854, -19.204756472903522, -12.619147264853925, -10.965863875135302, -10.068473928801932, -5.933288932420925, -24.939526880250718, -9.797704474703334, -15.611142068957168, -15.288622439957022, -13.493215149277827, -28.148174989545375, -13.931138321856068, -15.503078392883943, -20.337651826617062, -10.997131731410926, -10.309799953669707, -12.177976962954087, -16.051800454812106, -7.437827589752708, -12.996844494433471, -10.102375145475168, -11.926937666069986, -15.342273558427992, -14.04184429360489, -8.259527252312882, -17.310547561978243, -7.468083938107182, -14.929623125785543, -8.110218906318357, -8.381214592717452, -10.39811454085691, -6.859387445109631, -7.7106632455103705, -9.361078222662305, -10.94100535658168, -18.71834170496686, -11.301575912547836, -21.63404329789811, -14.911369481403149, -7.246449312275533, -10.460910312887917, -17.818732407203907, -7.694290877235504, -12.5436331663811, -15.850091599724713, -14.934782574188683, -25.924697440100182, -15.333891432421785, -23.248922148948594, -9.671710114764451, -10.030808230771504, -12.076915682198939, -6.7005075515465675, -12.203190522261071, -13.08518729540026, -11.481762243509813, -16.374513317527448, -9.00450660680199, -10.585495957908066, -7.219327970121853, -13.931510997953685, -7.136563200746885, -17.069398709086762, -13.768220175789885, -10.985794042668813, -10.94862577904387, -10.713976018374261, -16.051223753523562, -7.993029332086387, -10.777338730975854, -15.351797659805321, -18.071321775108945, -12.288506811598776, -12.708171062156147, -13.06888395763498, -15.01523508165348, -20.424099774899656, -16.223965589995778, -12.92453094583316, -11.765307757364134, -11.973688647653177, -6.8455378279606975, -17.32909390503128, -21.790483361242554, -19.220134354959434, -11.005462502934913, -12.014422341657207, -16.6200295496834, -12.717981986056856, -6.6376588389141755, -12.742722239317027, -17.084533919032616, -12.148864639440683, -14.51116898940388, -16.621408020718537, -11.60392243869158, -18.28367062688549, -9.154623559470666, -18.03588343602466, -19.756416194867473, -16.167533515649033, -6.70760575740182, -13.984020711765094, -11.56144931469307, -8.649638945621804, -7.445737280949262], "policy_policy_agent__reward": [3.086590317857958, 3.086590317857958, -0.8142256281473683, -0.8142256281473683, 2.0346455962210546, 2.0346455962210546, 6.875136292225983, 6.875136292225983, 1.4398659087237369, 1.4398659087237369, 2.26499231305516, 2.26499231305516, 2.9256555405015643, 2.9256555405015643, 2.059482481180846, 2.059482481180846, 0.3853999378275629, 0.3853999378275629, 6.200937294051912, 6.200937294051912, 8.3114044013302, 8.3114044013302, 4.393742750456108, 4.393742750456108, 7.632932859270824, 7.632932859270824, 6.566051425917051, 6.566051425917051, 7.708958385072035, 7.708958385072035, 7.2045488661158235, 7.2045488661158235, 2.6335846427852783, 2.6335846427852783, 1.6135690849638504, 1.6135690849638504, 5.600172014728546, 5.600172014728546, 1.4639797189358856, 1.4639797189358856, 6.0074990290205275, 6.0074990290205275, 5.493816104426674, 5.493816104426674, 0.22070127494286879, 0.22070127494286879, 5.133721398360177, 5.133721398360177, 1.0983322064078709, 1.0983322064078709, 4.2605315861965805, 4.2605315861965805, 5.996544673635527, 5.996544673635527, 9.71107169564951, 9.71107169564951, 11.294922801508768, 11.294922801508768, 2.8252303758163895, 2.8252303758163895, 9.58648907696892, 9.58648907696892, 6.8249148151540515, 6.8249148151540515, 7.461980760276143, 7.461980760276143, 3.5371382261495645, 3.5371382261495645, 14.735859907603468, 14.735859907603468, 5.407598202752262, 5.407598202752262, 10.016574512225839, 10.016574512225839, 10.568936367931025, 10.568936367931025, 10.049826827532241, 10.049826827532241, 23.16458616548555, 23.16458616548555, 7.811427852304139, 7.811427852304139, 10.855911634229443, 10.855911634229443, 8.519262389428414, 8.519262389428414, 6.248242176929928, 6.248242176929928, 3.936289992140135, 3.936289992140135, 8.866492108275542, 8.866492108275542, 6.5029573012698085, 6.5029573012698085, 3.4550320402832355, 3.4550320402832355, 3.9438599600642297, 3.9438599600642297, 3.750251069129525, 3.750251069129525, 4.950503266585226, 4.950503266585226, 7.025657864865023, 7.025657864865023, 8.587049834640947, 8.587049834640947, 4.171707923259614, 4.171707923259614, 8.138106622186115, 8.138106622186115, 3.653285805144956, 3.653285805144956, 9.90679919804417, 9.90679919804417, 3.7360408956178293, 3.7360408956178293, 4.502945163943634, 4.502945163943634, 4.142942027476831, 4.142942027476831, 2.7772550286679096, 2.7772550286679096, 3.4365282185118398, 3.4365282185118398, 5.373897980639243, 5.373897980639243, 4.124860433450575, 4.124860433450575, 8.818425572165497, 8.818425572165497, 2.178520740681459, 2.178520740681459, 7.746693154520085, 7.746693154520085, 3.256009233422312, 3.256009233422312, 4.093944708549758, 4.093944708549758, 6.605191335681777, 6.605191335681777, 11.769291205086969, 11.769291205086969, 3.4810357601824093, 3.4810357601824093, 1.6547116592269124, 1.6547116592269124, 9.722868988865677, 9.722868988865677, 5.581162145141784, 5.581162145141784, 13.673623132590675, 13.673623132590675, 3.85701862343866, 3.85701862343866, 12.725124263292138, 12.725124263292138, 5.238039639115011, 5.238039639115011, 3.9424957821852438, 3.9424957821852438, 4.387448377628785, 4.387448377628785, 0.3352819074794379, 0.3352819074794379, 6.0897618752062925, 6.0897618752062925, 5.464812453658816, 5.464812453658816, -0.3663610873289475, -0.3663610873289475, 7.136208445868465, 7.136208445868465, 6.017585820477543, 6.017585820477543, 2.280471998512594, 2.280471998512594, 3.3560997248198787, 3.3560997248198787, 3.6692052225182463, 3.6692052225182463, 1.717186484792279, 1.717186484792279, 5.045426445226954, 5.045426445226954, 9.91544378872292, 9.91544378872292, 2.3733373277375387, 2.3733373277375387, 6.185381106235887, 6.185381106235887, 5.879862605015455, 5.879862605015455, 9.559017376065583, 9.559017376065583, 4.611387456472586, 4.611387456472586, 5.0945734328996215, 5.0945734328996215, 9.760044769461174, 9.760044769461174, 14.478955340270856, 14.478955340270856, 5.187363045555502, 5.187363045555502, 7.466529695576071, 7.466529695576071, 9.103272822559592, 9.103272822559592, 7.830413207406405, 7.830413207406405, 17.007666519398647, 17.007666519398647, 4.080100820250958, 4.080100820250958, 4.9707155210037985, 4.9707155210037985, 7.590586973986798, 7.590586973986798, 5.750729111826205, 5.750729111826205, 0.5925941465223322, 0.5925941465223322, 12.203355020192076, 12.203355020192076, 13.486958889200041, 13.486958889200041, 13.325467107204178, 13.325467107204178, 2.5568129986763717, 2.5568129986763717, 1.3374219369250122, 1.3374219369250122, 13.06262084861865, 13.06262084861865, 5.12098474555308, 5.12098474555308, 0.6774638951549573, 0.6774638951549573, 8.030334924766077, 8.030334924766077, -2.773628307073794, -2.773628307073794, 7.355921902852067, 7.355921902852067, 7.545534470116024, 7.545534470116024, 2.2810685874345924, 2.2810685874345924, 4.245258817698532, 4.245258817698532, 13.026139951204337, 13.026139951204337, 4.262129680402813, 4.262129680402813, 15.32280980902823, 15.32280980902823, 10.307576991953965, 10.307576991953965, 6.652629440811009, 6.652629440811009, 0.7830126885915142, 0.7830126885915142, 9.86825340341713, 9.86825340341713, 5.819353051317293, 5.819353051317293, 0.02096177596217147, 0.02096177596217147, 3.834163022715349, 3.834163022715349]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3452509189999705, "mean_inference_ms": 2.2783518385495007, "mean_action_processing_ms": 0.09916187754001353, "mean_env_wait_ms": 0.5983974299519551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 111375, "timesteps_this_iter": 0, "agent_timesteps_total": 334125, "timers": {"sample_time_ms": 13628.582, "sample_throughput": 247.641, "load_time_ms": 0.299, "load_throughput": 11277705.545, "learn_time_ms": 2236.237, "learn_throughput": 1509.232, "update_time_ms": 27.62}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 16.48173007965088, "policy_loss": -0.0014062789006857202, "vf_loss": 16.49262065887451, "vf_explained_var": -0.055507779121398926, "kl": 0.003025784918219787, "entropy": 0.9483888983726502, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.099422740936279, "policy_loss": -0.014772830903530121, "vf_loss": 6.123421621322632, "vf_explained_var": 0.01350162923336029, "kl": 0.007610734172967704, "entropy": 0.9416406393051148, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 111375, "num_agent_steps_sampled": 334125, "num_steps_trained": 111375, "num_agent_steps_trained": 334125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4455, "training_iteration": 33, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-55-02", "timestamp": 1706108102, "time_this_iter_s": 13.540987253189087, "time_total_s": 446.98580718040466, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E06C03700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 446.98580718040466, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.26470588235294, "ram_util_percent": 66.18235294117648, "gpu_util_percent0": 0.05352941176470588, "vram_util_percent0": 0.24385340073529413}}
{"episode_reward_max": 11.597528165540261, "episode_reward_min": -24.196106278410802, "episode_reward_mean": -0.9158591888283913, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.007551894434307, "policy_agent_": -2.3264178282476964}, "policy_reward_max": {"policy_adversary_": -4.826576228977135, "policy_agent_": 19.302540029987277}, "policy_reward_mean": {"policy_adversary_": -13.037919792584185, "policy_agent_": 6.0610303018778975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.15351752809806, -2.669098837782766, -0.39007415279546065, -6.3315936976200184, -0.7927935052864525, -1.6971178975939356, -3.2419458466426594, 2.3034558105014993, -3.34942021460238, 10.813759799867828, -2.1127237632108398, -3.311437874798678, -1.1723005455578461, 11.597528165540261, 2.6411139082013135, -0.49417126968433855, 8.236236945329093, -0.048524908316158216, -4.701863696989154, -1.355042082133595, -8.254243473948144, -1.5643530235835992, -0.6411612853970499, -0.2858842679056125, -2.3332674904991952, -4.893644717348614, -0.5316621963664551, 1.8495135540795937, 4.813077858271404, -1.1493224925249905, -1.5686244535746159, -1.8940233582992079, 3.936197892976527, 1.3656938315659215, -2.410615814748542, -4.771712209896027, -1.757783314775731, -0.5764054689205222, -2.422750711585438, 4.806156603245833, 8.422546210202514, -0.701899966698712, -4.380240210225987, -6.835657610839128, 4.770557209014766, -3.5312703737767306, -4.482522358478182, -7.505423695120917, -5.75559455313295, -3.193366312296163, 5.037511342187672, -0.9582347325351147, -4.867996035758092, 5.061217005541385, -0.7286697518436208, 3.1268783643334976, 2.485034955847423, 0.713119344784121, -2.044814729532959, -3.3637588725567276, 4.914470915843764, 3.042052456839073, 1.6738121300907687, -0.36909728478291526, -11.230278441232377, -4.866551885957152, 2.7676826990040784, -6.464865742216457, -10.235421340714296, 1.199562635584765, -24.196106278410802, 2.2487949182950135, -12.913041655867675, -1.4507541122910375, -6.3504336800958, -13.363113276484793, -2.2145445902159886, -3.040666476808533, 3.3674150442315027, 1.7366498931813406, 1.9471144894815935, 1.9322362818427132, -2.4185763047687487, -0.7166506502230885, -3.9655240377561647, 11.22035490202069, -4.481118084392094, -0.8983838331924587, -5.565809399191511, -0.7469120911452971, -7.672076544363183, 3.3563037775349187, 2.39152024923261, 2.133011600379009, 0.5669761057971614, -0.030521288381222145, -4.014390107222628, 8.707975232776988, 5.805512539817107, 0.9320141031210304, 0.6629090660511467, -3.3225723976234955, -7.275579322100741, 10.342399194452069, 0.6249838590670149, 8.310722516950086, 1.1961294348508003, -4.1534806414287715, 1.1101509079453935, 3.9473281358689767, 4.577135989916497, 2.134260580001576, 4.8115862843990485, 1.1698698520148338, -6.731891222944293, -8.720871853387019, 1.7340089879808025, 6.9792979318982855, -6.146383856061457, 7.022855450918661, -2.2551887985099066, -4.438081061058392, -8.001511408772783, -2.420620961968327, 0.6323636822661467, 2.5131454971649134, -8.218571678089564, -3.5770855458196955, -4.863745701122344, 4.075892038778202, 11.48793773935091, -5.068252347314268, -3.8752319335820506, -0.7513890566932633, -8.645202222801018], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.259175099649763, -11.942481660410492, -10.04113734217402, -9.915128365506552, -12.205216154788038, -11.318774303411223, -7.456155197915828, -11.91148755319453, -6.749085446063686, -21.271284722761653, -6.914067222484476, -11.484577099241095, -6.692978756456929, -27.007551894434307, -22.397661042699244, -5.552820310656902, -17.62240476668278, -8.203084219085431, -5.701530005036421, -11.747060327114786, -14.7772248449173, -9.825934544099, -11.918347037140606, -8.265433389196371, -4.826576228977135, -24.746283901886006, -10.322919106359976, -12.574083689998186, -20.429504107257234, -12.16497661639184, -9.171521979933706, -6.451459680249764, -18.723831621389635, -11.69559370459476, -4.964950142052983, -7.808865733482445, -12.5114007689206, -15.080958474917887, -8.962573560611387, -21.073498760739312, -24.483009500491402, -8.132910119673262, -7.698683868134675, -12.905669685566684, -13.060927555662474, -13.629431218720459, -11.851041308224637, -16.580741443353087, -15.916342169364817, -6.254164076045821, -17.3905715777978, -12.356925987383054, -13.24415322939708, -19.079443715894595, -10.805113846634502, -7.517437205378697, -14.654512121185535, -10.185070018501564, -15.909529575249454, -5.319408700983434, -14.159891669594215, -11.164231332868171, -6.918583521857692, -17.711367373205032, -23.87423347017156, -15.047816431668785, -12.781580406946958, -6.050027690762347, -14.674784498785815, -25.380214809267805, -25.992686627895505, -10.003366262556941, -8.260205999372277, -12.436092781960086, -11.690745588953462, -12.058847299835087, -9.153264183990968, -10.621028885528395, -12.083777576930542, -12.695952246317615, -18.315305009560944, -10.457444076648821, -16.564089042297937, -11.36879463705288, -12.148507458542216, -19.277857432460905, -15.214799257250272, -13.5532572211939, -8.938641673799784, -13.136533976363777, -9.394162657786914, -13.147008829098077, -11.610049175354513, -8.763888795381066, -14.90395533594251, -13.634493678385082, -26.542095157681622, -16.72930684574067, -13.18402068253382, -11.15732721533633, -7.142045399247622, -7.0053606513730795, -11.730538028594214, -15.980549442783703, -12.710721797890857, -19.408401386836157, -10.96142721458196, -13.697466736936796, -8.814113476005126, -17.282708370407335, -11.647621052535317, -11.542067557213889, -14.979681395437371, -14.562502817532177, -16.628907169731182, -10.855925358675956, -15.650383911459922, -17.022524254063402, -17.270660426292704, -18.771885058339336, -9.219868106943737, -9.169980140798199, -16.63129598627638, -7.670798485968626, -15.065862376698876, -12.22811949172183, -16.95634809766321, -8.46571719433811, -7.949373771605111, -20.574310678594607, -18.62510819178785, -13.398318658423596, -12.851953196551754, -13.860127815901272, -12.321575176245107], "policy_policy_agent__reward": [1.5528287857758483, 1.5528287857758483, 4.636691411313862, 4.636691411313862, 4.825531594689282, 4.825531594689282, 1.7917673339432696, 1.7917673339432696, 5.706211324750792, 5.706211324750792, 4.810828202908643, 4.810828202908643, 2.107104675636585, 2.107104675636585, 7.107471681848015, 7.107471681848015, 1.6998326157306523, 1.6998326157306523, 16.042522261314744, 16.042522261314744, 2.400671729636818, 2.400671729636818, 4.0865696122212105, 4.0865696122212105, 2.7603391054495416, 2.7603391054495416, 19.302540029987277, 19.302540029987277, 12.519387475450277, 12.519387475450277, 2.5293245204862815, 2.5293245204862815, 12.92932085600594, 12.92932085600594, 4.077279655384637, 4.077279655384637, 0.4998331540236338, 0.4998331540236338, 5.1960091224905955, 5.1960091224905955, 3.26149068548458, 3.26149068548458, 4.1307907602577, 4.1307907602577, 5.638592875871777, 5.638592875871777, 3.9897745606453787, 3.9897745606453787, 1.2466543692389702, 1.2466543692389702, 9.92631959226869, 9.92631959226869, 4.895628454996759, 4.895628454996759, 7.211798622038891, 7.211798622038891, 12.621290982764314, 12.621290982764314, 5.507827061933428, 5.507827061933428, 3.801448763179544, 3.801448763179544, 2.2787181609752785, 2.2787181609752785, 11.33001475718308, 11.33001475718308, 6.530643768080341, 6.530643768080341, 1.277167163652221, 1.277167163652221, 1.5185767617932102, 1.5185767617932102, 5.376808727072431, 5.376808727072431, 7.252276502998684, 7.252276502998684, 3.2699114245129755, 3.2699114245129755, 12.939827681992574, 12.939827681992574, 16.452777855346955, 16.452777855346955, 3.715505076487276, 3.715505076487276, 1.6592218289543441, 1.6592218289543441, 3.0350060373637744, 3.0350060373637744, 8.91574238233862, 8.91574238233862, 5.049080422471866, 5.049080422471866, 3.684259474873226, 3.684259474873226, 4.53765887411609, 4.53765887411609, 5.080373808115932, 5.080373808115932, 1.5303988818748304, 1.5303988818748304, 11.21404145999274, 11.21404145999274, 5.69934562742397, 5.69934562742397, 4.188078596819495, 4.188078596819495, 12.070330360717987, 12.070330360717987, 5.038222047395441, 5.038222047395441, 5.322157784856096, 5.322157784856096, 8.569773538516479, 8.569773538516479, 5.449094681642842, 5.449094681642842, 6.932357422858244, 6.932357422858244, 0.977824914213352, 0.977824914213352, 9.53718129271899, 9.53718129271899, 7.103141894853624, 7.103141894853624, 4.2961978259742315, 4.2961978259742315, 8.671135044211054, 8.671135044211054, 6.321977514469592, 6.321977514469592, 5.090632272855816, 5.090632272855816, 7.774631552975519, 7.774631552975519, -0.2074190257270522, -0.2074190257270522, 2.21968157903576, 2.21968157903576, 13.289888722426284, 13.289888722426284, 0.8982901747423577, 0.8982901747423577, 6.1260805904259765, 6.1260805904259765, -2.3264178282476964, -2.3264178282476964, 5.492669334834523, 5.492669334834523, 2.670155954428829, 2.670155954428829, -0.6521329883248552, -0.6521329883248552, 3.4693597968874896, 3.4693597968874896, 3.7901812043599308, 3.7901812043599308, 7.7255963105810235, 7.7255963105810235, 7.216301069749473, 7.216301069749473, 10.13120974952127, 10.13120974952127, 6.194840179245768, 6.194840179245768, 7.072756368764594, 7.072756368764594, 5.326071993414897, 5.326071993414897, 4.091491710393025, 4.091491710393025, 15.249106167240798, 15.249106167240798, 5.366840586429089, 5.366840586429089, 6.3274366940007205, 6.3274366940007205, 1.686416137304138, 1.686416137304138, 6.194810942609239, 6.194810942609239, 0.8610430567118663, 0.8610430567118663, 8.2516563033165, 8.2516563033165, 7.000784712293561, 7.000784712293561, 5.448450197880034, 5.448450197880034, 7.735465720869838, 7.735465720869838, 6.8019861950019305, 6.8019861950019305, 11.263852525229495, 11.263852525229495, 12.71864103925883, 12.71864103925883, 9.494766611175464, 9.494766611175464, 6.04467065922868, 6.04467065922868, 3.9024772326493844, 3.9024772326493844, 1.8413941268747922, 1.8413941268747922, 2.227479353246734, 2.227479353246734, 13.161474318617886, 13.161474318617886, 6.667852828478937, 6.667852828478937, 13.859561951893122, 13.859561951893122, 6.078778324716383, 6.078778324716383, 4.771993047754013, 4.771993047754013, 4.962132191975259, 4.962132191975259, 10.615018253138155, 10.615018253138155, 8.112378521225908, 8.112378521225908, 6.838164068607731, 6.838164068607731, 9.895633839918208, 9.895633839918208, 7.866186334773504, 7.866186334773504, 4.948507973393448, 4.948507973393448, 1.0675267526444643, 1.0675267526444643, 8.692196449720361, 8.692196449720361, 12.000911092980843, 12.000911092980843, 5.5621382851156245, 5.5621382851156245, 12.897370254628996, 12.897370254628996, 3.4823396542169145, 3.4823396542169145, 2.365949539869904, 2.365949539869904, 4.314892288751801, 4.314892288751801, 2.6250887620001495, 2.6250887620001495, 7.84911302948251, 7.84911302948251, 7.370632494443375, 7.370632494443375, 4.368888209786823, 4.368888209786823, 2.444315824259208, 2.444315824259208, 1.5428140352413835, 1.5428140352413835, 12.325101358686407, 12.325101358686407, 15.056522965569382, 15.056522965569382, 4.1650331555546645, 4.1650331555546645, 4.488360631484851, 4.488360631484851, 6.554369379604002, 6.554369379604002, 1.8381864767220444, 1.8381864767220444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3449755621030798, "mean_inference_ms": 2.276544268264074, "mean_action_processing_ms": 0.09905823991533004, "mean_env_wait_ms": 0.5979390997352267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 114750, "timesteps_this_iter": 0, "agent_timesteps_total": 344250, "timers": {"sample_time_ms": 13488.479, "sample_throughput": 250.214, "load_time_ms": 0.399, "load_throughput": 8458784.583, "learn_time_ms": 2243.07, "learn_throughput": 1504.634, "update_time_ms": 27.723}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 18.610013008117676, "policy_loss": -0.004781008965801447, "vf_loss": 18.624518966674806, "vf_explained_var": -0.0642358660697937, "kl": 0.0032596313608027395, "entropy": 0.9725080788135528, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 6.703405332565308, "policy_loss": -0.013221195619553327, "vf_loss": 6.725444436073303, "vf_explained_var": 0.024556645750999452, "kl": 0.005678402724261833, "entropy": 0.8959745526313782, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 114750, "num_agent_steps_sampled": 344250, "num_steps_trained": 114750, "num_agent_steps_trained": 344250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4590, "training_iteration": 34, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-55-15", "timestamp": 1706108115, "time_this_iter_s": 13.15932035446167, "time_total_s": 460.14512753486633, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A0D1550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 460.14512753486633, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.023529411764706, "ram_util_percent": 66.1, "gpu_util_percent0": 0.08411764705882352, "vram_util_percent0": 0.24593577665441177}}
{"episode_reward_max": 16.73682927790664, "episode_reward_min": -19.929765706008258, "episode_reward_mean": 0.16464108779045228, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.6269112910213, "policy_agent_": -5.201755224175379}, "policy_reward_max": {"policy_adversary_": -4.625240040901939, "policy_agent_": 20.76386142424896}, "policy_reward_mean": {"policy_adversary_": -13.642157982178436, "policy_agent_": 6.903399534984443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7928024097087605, -1.0331235928632232, 14.647128307557699, -5.083004464725739, 2.1806270814921294, 4.5819385220147195, -0.3073703611175962, -6.141140826432283, -9.661964267073452, -5.945997204002848, -6.548617881684393, 1.8400584208558994, 11.877033455151269, 0.413446347041433, 2.589186062896064, 7.628365903524459, -4.92923147839338, -3.304975844847313, 0.27854595384694253, 3.3531642287822145, 13.200348734091364, -2.401448720845139, -1.8310725397525953, 2.7892101076641196, 12.73115323338659, -4.0789690768254925, -1.5097351147740512, 3.2287534847360835, 8.138028299353826, 3.6085657094300356, 15.1022183673032, 2.6333794906830525, -11.664941133030222, -1.831337241298967, 2.3703776742217504, -2.8276865566502796, 2.7068734268815953, -5.838630550691251, 0.06002395963380858, -12.729124463463377, 3.6829821753595935, 5.034040379147522, -1.9023544784470672, -1.400395506879002, 4.827183901686024, -4.667021978285767, -4.9234345524949825, -0.48073424664919956, -5.660604232739136, -1.4812233207050107, -1.3243332607238585, -10.95271513262765, 3.5210174005365875, -6.695375603893623, 5.658076731702153, 4.690639027689366, 7.018016188539127, 0.776338509249621, -11.632029633325448, 6.919278220793642, 11.300181142493388, 4.730511482338506, 4.807540762050946, 0.5658388181020574, -9.076874730129767, 2.561484954366726, 5.939738321747814, 3.291971573898931, -4.613836296767161, 6.8461070160322155, 3.244824739370731, 2.99386319437011, 8.010965887655601, -4.358231854379367, 1.3590856525408015, -3.1170591658775026, 7.650584321529506, 1.262518455525843, -7.854537531565704, -5.205360639981711, 3.3715017517234225, -13.457721633030545, 2.963587941687594, -12.235208843541898, -9.478249763963044, -0.34836929980068, -7.1318507571199685, -0.25787614014574356, 6.245176928422028, 1.282642353774195, -7.831106687086229, -2.40044455162661, 1.1149549456665215, 6.592907021539345, -5.527926051897294, -0.23311908964951739, 14.07117319138415, -2.9347814961331897, 2.134906306510857, 3.0276987615838618, -3.0928067860008985, -7.021451051460213, 16.73682927790664, -1.3965283517920812, -4.3175623131761744, 7.486245561686637, -2.1800821687485867, 8.459893727181628, 6.475021248253428, 6.64651755225784, 0.8728122932675992, -8.369163779260274, 11.55316124919163, 1.3226820149514396, -3.7665861082857575, -1.9626414419716915, -5.4187909385035296, -3.8444500885305826, -5.334560765652274, -1.937799525161429, 5.334610815485871, -4.884389069575402, 6.88595458158793, 0.34564591744125406, -2.034196458175771, 6.958472866643147, -6.77143076724247, -3.621611797243663, 5.478328006411015, -6.6418025161904914, -19.929765706008258, -3.8090667755290863, 10.491358791482432, 1.8346159501007118, -8.718336034967027], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.639151348374552, -14.342474921896553, -24.157222945626433, -6.272286863363583, -18.36489243782054, -16.156063180333607, -11.064343625617587, -12.546810707725193, -19.232878233452055, -16.280144192298916, -11.231896639714872, -17.387747301483802, -20.24600562475116, -7.129521574904916, -15.897971592447638, -15.371837611673156, -4.625240040901939, -5.524314128276807, -6.782026020206165, -16.2511568875552, -17.38375610714296, -17.64830905222668, -10.79644086755937, -20.221480573981342, -19.99673556367793, -19.82799338393344, -7.725722627320705, -9.512086960674749, -17.75279778640122, -10.36661659983703, -20.911389234434864, -8.89402330130769, -17.595251067132466, -7.92051089784069, -9.98910354645226, -7.093207121044628, -10.258062553915966, -8.381127484235009, -9.594904305962835, -18.905717059120953, -8.118890673475413, -20.607105897664137, -5.602777304132379, -13.005634619480215, -19.273142497754662, -11.713495924863114, -10.927350479878122, -6.4538190283887635, -8.77263659015485, -9.033796882441965, -11.011322067641874, -9.787732102652495, -11.749884793000907, -11.41574056004147, -18.87949736813209, -21.79172580885043, -19.45686687982224, -14.44495237766644, -17.85609756500073, -14.59004246792507, -19.748099290715757, -14.765689433377208, -13.121200211560234, -21.788138903825654, -8.52176192265662, -16.730636527087963, -12.95058695249943, -13.325622990259978, -13.21512643136439, -15.03513844395723, -9.682664888409436, -8.709319612639625, -23.304928392192284, -10.705797985177584, -10.378861419371095, -7.516498418928081, -16.751928878621012, -11.315118299870088, -11.892957521204934, -15.864445151326168, -10.794387224802003, -14.019115617771693, -16.194888870071484, -23.6374188140482, -11.49860936094595, -10.205717297464014, -5.503900515019922, -6.142126550768944, -21.404587761572184, -9.184332325355143, -9.163644043656195, -10.195578165692432, -7.27323569300311, -15.090201591401787, -13.326688589971493, -12.506582236878785, -25.6269112910213, -16.804517798902953, -10.808155687737312, -12.842948224272725, -12.66173964769848, -9.048355943939862, -24.790893570591276, -12.419353254387941, -14.949279254794183, -13.505458358205845, -10.108042582030087, -18.247444455462944, -15.519875423187836, -22.71446831033858, -7.427809661370963, -14.488262972923021, -18.884633146797558, -20.132466203834273, -9.231162891871122, -12.916829145785085, -10.734714319979503, -12.42453058009064, -9.219034881277645, -8.568996672625607, -12.605929027885377, -5.963180340113154, -16.14201787356184, -23.59360985939605, -13.935889539473433, -13.87697768229461, -15.809446608501432, -17.057944782144286, -16.90088531997605, -6.433664972288801, -9.526255257657503, -19.9428420421793, -17.26533870195348, -13.006916503355809, -21.317274609117913], "policy_policy_agent__reward": [5.215976879041657, 5.215976879041657, 6.654675664516665, 6.654675664516665, 19.402175626592058, 19.402175626592058, 0.5946411993189213, 0.5946411993189213, 10.272759759656333, 10.272759759656333, 10.369000851174162, 10.369000851174162, 5.378486632249995, 5.378486632249995, 3.202834940646458, 3.202834940646458, 4.7854569831893015, 4.7854569831893015, 5.167073494148035, 5.167073494148035, 2.341639379015239, 2.341639379015239, 9.613902861169851, 9.613902861169851, 16.06151953995121, 16.06151953995121, 3.771483960973174, 3.771483960973174, 9.24357882767185, 9.24357882767185, 11.50010175759881, 11.50010175759881, -0.15199571874572154, -0.15199571874572154, 1.109669141714747, 1.109669141714747, 3.530285987026554, 3.530285987026554, 9.802160558168705, 9.802160558168705, 15.292052420617162, 15.292052420617162, 7.623430165690771, 7.623430165690771, 4.4826841639033885, 4.4826841639033885, 11.50534534082273, 11.50534534082273, 16.363944398532258, 16.363944398532258, 7.8745121535539715, 7.8745121535539715, 3.107993756273326, 3.107993756273326, 6.370420222705415, 6.370420222705415, 12.945413042877522, 12.945413042877522, 6.987591154633533, 6.987591154633533, 18.006803800869022, 18.006803800869022, 5.763701395995373, 5.763701395995373, 2.965154967051121, 2.965154967051121, 3.0445868282708615, 3.0445868282708615, 6.179740610337003, 6.179740610337003, 2.1327602821971747, 2.1327602821971747, 6.482467990398782, 6.482467990398782, 1.2712484667718775, 1.2712484667718775, 4.827464132798322, 4.827464132798322, 3.088296297828784, 3.088296297828784, 5.9009364244175035, 5.9009364244175035, 12.820573138405829, 12.820573138405829, 1.8502114128426563, 1.8502114128426563, 5.802619556300608, 5.802619556300608, 12.050163199720338, 12.050163199720338, 3.5232369732886735, 3.5232369732886735, 3.001957963691572, 3.001957963691572, 2.9865423908697832, 2.9865423908697832, 1.5560161787078535, 1.5560161787078535, 3.776286780868478, 3.776286780868478, 4.8434944034590055, 4.8434944034590055, -0.5824915149875786, -0.5824915149875786, 7.635451096768749, 7.635451096768749, 2.3601824780739253, 2.3601824780739253, 12.268787049917119, 12.268787049917119, 13.241182418269904, 13.241182418269904, 13.237441534180684, 13.237441534180684, 7.610645443458028, 7.610645443458028, 3.112033965837638, 3.112033965837638, 10.754660344359356, 10.754660344359356, 15.52414021660457, 15.52414021660457, 9.74810045785786, 9.74810045785786, 8.96437048680559, 8.96437048680559, 11.176988860963862, 11.176988860963862, -0.2775564037365727, -0.2775564037365727, 9.646060740727346, 9.646060740727346, 9.44516263712362, 9.44516263712362, 8.308797282079457, 8.308797282079457, 4.300645067298614, 4.300645067298614, 10.940622729994718, 10.940622729994718, 6.463744813890083, 6.463744813890083, 5.851591403504869, 5.851591403504869, 15.657947139923941, 15.657947139923941, 3.1737830653991086, 3.1737830653991086, 5.868973535955946, 5.868973535955946, 2.1997196265252885, 2.1997196265252885, 12.201256600075263, 12.201256600075263, 6.288818377697966, 6.288818377697966, 2.0192099948196165, 2.0192099948196165, 5.329542255672227, 5.329542255672227, 7.0829444882627115, 7.0829444882627115, 0.2806969923705729, 0.2806969923705729, 9.57923840587954, 9.57923840587954, 5.701104985253154, 5.701104985253154, 1.0101797984914547, 1.0101797984914547, 4.928673998831667, 4.928673998831667, -0.8139751210500229, -0.8139751210500229, 2.9421252053116, 2.9421252053116, 13.824882344997095, 13.824882344997095, 5.233487339564672, 5.233487339564672, 0.6662686782849812, 0.6662686782849812, 3.897566807032913, 3.897566807032913, 4.194095319334815, 4.194095319334815, 10.841554306470567, 10.841554306470567, 3.899381269037097, 3.899381269037097, 6.136731573614636, 6.136731573614636, 19.84904224120272, 19.84904224120272, 6.934868151384881, 6.934868151384881, 6.471530997124084, 6.471530997124084, 7.9353234929282905, 7.9353234929282905, 4.784466430848789, 4.784466430848789, 1.0134524462398242, 1.0134524462398242, 20.76386142424896, 20.76386142424896, 5.511412451297932, 5.511412451297932, 5.315858470809005, 5.315858470809005, 10.495851959946243, 10.495851959946243, 3.9639802066407523, 3.9639802066407523, 13.353669091322285, 13.353669091322285, 10.997448335720632, 10.997448335720632, 14.680492931298215, 14.680492931298215, 4.15031097731928, 4.15031097731928, 3.0595495968313764, 3.0595495968313764, 15.218897197994595, 15.218897197994595, 10.727574109392851, 10.727574109392851, 2.7322883917926815, 2.7322883917926815, 5.477093851906696, 5.477093851906696, 2.657961690737987, 2.657961690737987, 4.290040245780029, 4.290040245780029, 1.9422370578126866, 1.9422370578126866, 3.3155985737320894, 3.3155985737320894, 8.970269921685626, 8.970269921685626, 0.5393956352688767, 0.5393956352688767, 11.513986227574883, 11.513986227574883, 11.969627888418652, 11.969627888418652, 5.950846540648829, 5.950846540648829, 10.41772527446888, 10.41772527446888, 4.519007920629482, 4.519007920629482, 6.71816649245031, 6.71816649245031, 11.189606663193533, 11.189606663193533, -0.10406877195084621, -0.10406877195084621, -5.201755224175379, -5.201755224175379, 8.066887633325107, 8.066887633325107, 13.878348746717954, 13.878348746717954, 7.4207662267282615, 7.4207662267282615, 6.299469287075443, 6.299469287075443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34476013131281885, "mean_inference_ms": 2.2769930630436437, "mean_action_processing_ms": 0.09915000312584692, "mean_env_wait_ms": 0.5977071193145018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 118125, "timesteps_this_iter": 0, "agent_timesteps_total": 354375, "timers": {"sample_time_ms": 13496.846, "sample_throughput": 250.058, "load_time_ms": 0.399, "load_throughput": 8458784.583, "learn_time_ms": 2245.267, "learn_throughput": 1503.162, "update_time_ms": 27.717}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 19.04679126739502, "policy_loss": -0.010458157537505031, "vf_loss": 19.067178344726564, "vf_explained_var": -0.07397321462631226, "kl": 0.005271738074230231, "entropy": 0.9929000437259674, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.8148188829422, "policy_loss": -0.011154617369174957, "vf_loss": 7.834871292114258, "vf_explained_var": 0.01737634837627411, "kl": 0.0078040194083901825, "entropy": 0.909273874759674, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 118125, "num_agent_steps_sampled": 354375, "num_steps_trained": 118125, "num_agent_steps_trained": 354375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4725, "training_iteration": 35, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-55-29", "timestamp": 1706108129, "time_this_iter_s": 13.532811164855957, "time_total_s": 473.6779386997223, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 473.6779386997223, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.87647058823529, "ram_util_percent": 65.95882352941177, "gpu_util_percent0": 0.10294117647058823, "vram_util_percent0": 0.26220703125}}
{"episode_reward_max": 13.691692413796822, "episode_reward_min": -14.595769987631304, "episode_reward_mean": -0.009065857501607011, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.4920143637801, "policy_agent_": -2.7212404707985365}, "policy_reward_max": {"policy_adversary_": -4.568946506487274, "policy_agent_": 19.66347947768812}, "policy_reward_mean": {"policy_adversary_": -12.863448369483221, "policy_agent_": 6.427191255990807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5804159414108745, 2.365493040345029, 8.340553033944524, 0.06030304472622694, 2.929409357043807, -0.7888650678323283, 7.156893165784346, 1.3448097811142268, 0.13563328790979673, 5.923651040311877, -14.595769987631304, 0.16595810825335766, 13.691692413796822, 2.976423737025211, -5.367243346483992, -5.200541074028591, -12.707973810234053, -0.012775737384516317, -1.0404591250221715, 2.854441022795386, 2.3872724723923824, 10.834944591596129, 1.4306525638945544, -6.193984977029521, -0.13778511699668433, -13.485392051559753, 1.9157248729864, 5.198538853974273, 6.35035545728901, -2.9416637551893983, 7.910659637266356, -0.3399072559301627, -4.423909432452671, -0.642135544960837, 4.895245538971086, -6.814228789933172, -3.762569374077242, -3.4228352698179507, -3.8092527011533344, 1.3093151085109351, -2.1749148107834557, 1.719376618195917, -1.8728113169675875, 5.469409262962997, -0.4182840574353789, -9.991421337472982, -0.4367996904904116, -3.1749759258753674, -6.813370091979891, 4.7567131241261675, 8.48674136368914, -0.7012919815242653, -9.748547628286726, -1.7694209419373386, 0.5175668418568136, 0.6436652261549456, 0.8100379879105987, 2.441152864546103, -2.77825170030679, 3.751626472963377, -4.411592922326577, -2.71666980444539, -1.491790409986591, -1.8848656067948035, -8.956646502909035, 5.479603138572456, 0.05269150213414281, 0.6343120176112678, 5.291427812223328, -2.837117565015211, 4.236963550143925, 8.27211361178298, -1.9809561266851974, -4.247982844701241, 3.331846544416184, 3.6025014834652325, -1.3429454810220511, 8.591064831924525, 0.24971927063455018, 1.24376570398827, -7.870445861634744, -5.538839492298864, 2.588833297577078, 1.0192075028838208, 2.8969317637749996, -6.691461948951855, 5.151913174324592, -2.001895835270824, -1.2386254637083747, 0.5940556060896325, 2.635809418643236, -9.205983999293066, -2.4845113182875975, -0.5297530248154501, -0.8654646428975337, 8.121256637055522, -1.4423653218644192, 1.8104114062736039, 1.9819074010007631, -0.1414425089347825, 7.180056282960622, -0.6658952269796785, -9.50349206518334, -1.745378022565042, 0.8227085002600456, -2.2499324616379726, 5.27890243129751, 0.5913644480966636, -4.388283316908356, -6.194158123097264, 2.5306578698305167, -4.808739120062908, 2.0516923689715147, -1.8518566164044816, 1.1538078942859165, 2.9836243797304394, 3.1411242618616866, 4.298371492198305, -1.2920616297344012, -0.4904582448583868, 8.702200884726079, -11.558817792682838, -0.6421984063750676, 8.926092252963418, 10.427993992606428, -6.2755846023869415, -2.9653689182021097, -2.070972033966239, -2.0987385004428716, 7.979158916961158, 1.872924920711386, 3.386067790563605, -3.8585307853907733, 2.0150312533563253, -8.597477762867193], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.552010948073942, -11.274548866585679, -17.74759123025624, -10.154703206028246, -7.201191025795933, -11.57905713948601, -17.964338732278314, -8.094233711765796, -23.532760910573426, -18.547090459785185, -13.615267378459105, -6.8452597489289495, -20.769026503647336, -17.03448511646079, -21.365661334141354, -9.242011324548821, -7.265492868636978, -16.545960680207465, -17.102894399325226, -18.024205780723566, -7.194410818295678, -28.4920143637801, -11.560597177028813, -11.073436300320697, -12.214672913886478, -9.698979395465958, -17.161901451946918, -15.117045625468993, -17.987535086900944, -8.25706635437266, -19.68817311596473, -13.133737660762046, -16.589789819599233, -8.57422657645766, -10.09719385289039, -10.531517952181249, -16.052283818686597, -13.17399878059932, -7.163859683279952, -8.776363051871975, -7.803166449653727, -7.079395649417698, -6.897462061896461, -16.27071740716766, -9.11454416872541, -9.324594497359097, -6.984545676118942, -13.59315170506446, -9.87995282850995, -12.509645390365433, -17.1060928318775, -17.32876840253197, -9.848580291209844, -11.78491060861655, -11.266097418892869, -7.643593273185766, -12.525003653722191, -9.903675759923512, -8.076720628316163, -12.59506788798342, -11.362530496027961, -9.63036932231209, -6.7310193248567725, -14.884273493599977, -12.87386640840032, -10.80809475990827, -18.876320187189314, -13.272108106320871, -13.268525950152872, -10.159548257054611, -10.978184627816425, -17.72761391645274, -28.106853822277635, -4.916523586021414, -11.519939593939402, -13.604642271858848, -9.874903644181451, -16.988565374444672, -5.73905949418368, -12.520946818489495, -23.41861271449961, -6.801621406301711, -12.664044531887122, -9.841483609497644, -14.683708882503401, -15.80280319564834, -13.69380891132716, -13.854209656979016, -7.76674587098816, -8.992582586478543, -16.44680650403053, -16.520897743945667, -7.140098059982909, -10.852280405106278, -9.470990676663554, -15.387530978935176, -7.952108331482198, -6.272296025154448, -8.217048391157057, -13.618316464499983, -22.643558770354417, -8.714895979779127, -16.960206276537637, -13.459808516129833, -12.950923002904641, -6.144038400432816, -16.137484654979847, -14.016347331701434, -15.736610392674452, -21.31631527442519, -8.746034034663754, -14.701330191453433, -9.183746249290667, -12.953560693023778, -14.057409797312381, -18.007106644920217, -11.289566529996334, -14.295443917897993, -7.239894750166075, -9.399167911152059, -23.69962372221776, -9.000033877419524, -7.300653418753347, -18.884267444097727, -21.508504371947257, -16.529401116145795, -6.0564179266010605, -14.566051796950733, -4.568946506487274, -19.396426915852462, -8.00160941920068, -10.303841595847638, -9.977511206486733, -14.628340201650495, -17.41628488221568], "policy_policy_agent__reward": [11.566213444742411, 11.566213444742411, 6.820020953465354, 6.820020953465354, 13.04407213210038, 13.04407213210038, 5.107503125377238, 5.107503125377238, 5.0653001914198725, 5.0653001914198725, 5.395096035826841, 5.395096035826841, 12.560615949031328, 12.560615949031328, 4.7195217464400105, 4.7195217464400105, 11.83419709924161, 11.83419709924161, 12.235370750048526, 12.235370750048526, -0.4902513045861019, -0.4902513045861019, 3.505608928591153, 3.505608928591153, 17.230359458722074, 17.230359458722074, 10.005454426743, 10.005454426743, 7.999208993828683, 7.999208993828683, 2.020735125260113, 2.020735125260113, -2.7212404707985365, -2.7212404707985365, 8.266592471411471, 8.266592471411471, 8.031217637151528, 8.031217637151528, 10.439323401759472, 10.439323401759472, 4.79084164534403, 4.79084164534403, 19.66347947768812, 19.66347947768812, 6.495624870461685, 6.495624870461685, 2.4397256616455913, 2.4397256616455913, 6.0384438984449, 6.0384438984449, -1.893206328046899, -1.893206328046899, 9.538813162466658, 9.538813162466658, 10.157792239721633, 10.157792239721633, 12.168945272094977, 12.168945272094977, 2.65770129959163, 2.65770129959163, 13.79941637661555, 13.79941637661555, 6.396915202415942, 6.396915202415942, 6.082940193573282, 6.082940193573282, 3.9660455157484114, 3.9660455157484114, 7.496219695930734, 7.496219695930734, 1.8586445811240366, 1.8586445811240366, 6.144857222304678, 6.144857222304678, 4.875581755390687, 4.875581755390687, 1.677303491063309, 1.677303491063309, 5.042839080191455, 5.042839080191455, 2.814125819435135, 2.814125819435135, 4.399386133806808, 4.399386133806808, 2.512325372464436, 2.512325372464436, 10.870063335065332, 10.870063335065332, 4.348130055645016, 4.348130055645016, -0.3334134200569428, -0.3334134200569428, 3.2738729928142645, 3.2738729928142645, 5.209087889594545, 5.209087889594545, 1.5332913682650273, 1.5332913682650273, 8.6331792572458, 8.6331792572458, 12.796417097783317, 12.796417097783317, 8.313738210503852, 8.313738210503852, 0.05001633146155851, 0.05001633146155851, 5.007744833339605, 5.007744833339605, 5.891832130374839, 5.891832130374839, 4.143629249670357, 4.143629249670357, 6.667520820816396, 6.667520820816396, 6.172414312234807, 6.172414312234807, 2.649234464004688, 2.649234464004688, 8.173347180473398, 8.173347180473398, 3.475468786850692, 3.475468786850692, 3.4568497589333487, 3.4568497589333487, 2.6196144574350897, 2.6196144574350897, 6.4997039434025865, 6.4997039434025865, 1.95860995274564, 1.95860995274564, 8.143848949240363, 8.143848949240363, 9.464505844661728, 9.464505844661728, 6.953210061966072, 6.953210061966072, 9.279976881188102, 9.279976881188102, 3.6612153460197, 3.6612153460197, 7.607574088980176, 7.607574088980176, 12.999863764117864, 12.999863764117864, 13.062948847796223, 13.062948847796223, 0.33427037066008775, 0.33427037066008775, 7.425893069177794, 7.425893069177794, 8.603571877662041, 8.603571877662041, 4.2659790815797, 4.2659790815797, 12.7898151031846, 12.7898151031846, 2.994389382409116, 2.994389382409116, 6.882356261238882, 6.882356261238882, 7.774083426432433, 7.774083426432433, 0.6313909570014242, 0.6313909570014242, 7.626438914732095, 7.626438914732095, 5.430345556190732, 5.430345556190732, 8.7903203231392, 8.7903203231392, 4.555670623348242, 4.555670623348242, 9.422861042825877, 9.422861042825877, 5.926156910854097, 5.926156910854097, 3.2640602036398914, 3.2640602036398914, 4.79331909628409, 4.79331909628409, 9.541307961336887, 9.541307961336887, 3.6574568723263, 3.6574568723263, 2.3277933708476546, 2.3277933708476546, 5.161263690145414, 5.161263690145414, 4.30276301688301, 4.30276301688301, 11.754393807995353, 11.754393807995353, 3.25487150480889, 3.25487150480889, 4.041353715714026, 4.041353715714026, 5.099477896078908, 5.099477896078908, 6.738436977782602, 6.738436977782602, 14.91180752665752, 14.91180752665752, 4.0245003763997245, 4.0245003763997245, 3.728357105677147, 3.728357105677147, 5.857215246782394, 5.857215246782394, 6.886815751582342, 6.886815751582342, 1.9470529693974217, 1.9470529693974217, 10.70819354313868, 10.70819354313868, 7.303855889899047, 7.303855889899047, 5.6741635378830475, 5.6741635378830475, 7.561078575663963, 7.561078575663963, 5.638345952247135, 5.638345952247135, 4.9462955356952625, 4.9462955356952625, 5.61771930913109, 5.61771930913109, 5.550852038309648, 5.550852038309648, 7.60560884579915, 7.60560884579915, 10.495365512325328, 10.495365512325328, 7.215345395929009, 7.215345395929009, 9.296907705048152, 9.296907705048152, 2.973916560215836, 2.973916560215836, 4.4543548331468354, 4.4543548331468354, 16.200912303471927, 16.200912303471927, -1.2793919576316586, -1.2793919576316586, 3.32922750618914, 3.32922750618914, 13.905179848530572, 13.905179848530572, 15.968249182276843, 15.968249182276843, 5.12690825687943, 5.12690825687943, 1.545524504199475, 1.545524504199475, 6.247539881492245, 6.247539881492245, 1.2351040030222007, 1.2351040030222007, 13.68779291640681, 13.68779291640681, 4.937267169956033, 4.937267169956033, 6.844954693205622, 6.844954693205622, 3.0594902105479775, 3.0594902105479775, 8.321685727503406, 8.321685727503406, 4.40940355967425, 4.40940355967425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3445667475649589, "mean_inference_ms": 2.2755824109464475, "mean_action_processing_ms": 0.09906183553021218, "mean_env_wait_ms": 0.5973860470489609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 121500, "timesteps_this_iter": 0, "agent_timesteps_total": 364500, "timers": {"sample_time_ms": 13472.118, "sample_throughput": 250.517, "load_time_ms": 0.399, "load_throughput": 8458784.583, "learn_time_ms": 2266.41, "learn_throughput": 1489.139, "update_time_ms": 29.116}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 17.959711647033693, "policy_loss": 0.00346404837036971, "vf_loss": 17.96604690551758, "vf_explained_var": -0.06989243030548095, "kl": 0.0021114423643355585, "entropy": 0.9799980759620667, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.119190788269043, "policy_loss": -0.010504466757993214, "vf_loss": 7.138331317901612, "vf_explained_var": 0.023539143800735473, "kl": 0.00820341673861077, "entropy": 0.8840962260961532, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 121500, "num_agent_steps_sampled": 364500, "num_steps_trained": 121500, "num_agent_steps_trained": 364500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4860, "training_iteration": 36, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-55-42", "timestamp": 1706108142, "time_this_iter_s": 13.40523624420166, "time_total_s": 487.08317494392395, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 487.08317494392395, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.48823529411765, "ram_util_percent": 66.2235294117647, "gpu_util_percent0": 0.08529411764705881, "vram_util_percent0": 0.28502699908088236}}
{"episode_reward_max": 21.35326419320929, "episode_reward_min": -19.043450468796532, "episode_reward_mean": 0.500539298487502, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.67683354349224, "policy_agent_": -4.413215970697762}, "policy_reward_max": {"policy_adversary_": -3.448543689016392, "policy_agent_": 25.580956773236718}, "policy_reward_mean": {"policy_adversary_": -13.480198220468322, "policy_agent_": 6.990368759477911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.619892257595636, 1.1523662837002187, -2.844794670092943, -1.5885389238606886, -2.0644539432683757, 11.734742735299431, -2.387698137062291, -1.7186261151833762, -1.757644632760698, -4.0122884637592495, 6.375240872562743, -17.405352406394975, 1.9023784030046136, 12.311586843256427, 10.474773761896596, 7.445550277306647, -6.766341589503774, 5.999261902966412, 1.8755681966941653, 8.052306174736039, -9.832794807319912, 1.3352805775656713, -1.641014340051186, -4.473147257652885, -5.826212855685016, -0.7011586637400871, 2.320042065632098, -1.4789281442498523, -1.5703695465684255, -8.163739314930078, 4.562925847403393, 4.45947952215698, 6.331616255064773, 9.076787316044117, -8.354463752923897, -5.429124974304304, -0.05665680545711488, -1.4454647166375463, 2.176009093803405, -13.991733839454271, 7.945536914039922, 3.6564328623394937, -9.955287722133287, 1.5894476222777623, 1.2279633389426594, -3.6754491983524895, -6.22983476659927, -19.043450468796532, -3.168150734073556, -3.870089691828294, -6.361931260037019, 7.280075267850993, 1.5363582863648515, 5.254915447075198, -3.517998043944827, 8.104427359317295, 2.3592348281720983, -2.2394714088651795, 0.5626499374637395, 1.0070205051854833, 2.6810406155223516, -4.13981037590412, 2.3413342557247456, -2.030273881318844, -2.083079176050614, 6.367242371511854, 4.293869231760535, -3.168836529713241, -3.9303173811572143, -6.198620348707773, -15.844880362861346, -3.070032207346563, 0.8651908732365486, -4.117120532245989, 0.88172194460749, 1.6093365442889958, 9.231321822625866, 7.271745215914057, -4.037166600055553, -1.740583542113069, -7.521663334696718, 12.371131420019681, 6.37929035348222, 6.8503443691561845, 0.28773866644929336, -6.300710908984443, 0.35121735730049836, 6.790869847783602, -4.11756409678323, 2.4029899103328862, 7.62666363318726, -0.892667918071826, 1.1765169929638375, -1.741766317095499, 4.1518131767274165, 3.387079407834926, 5.191385206656032, 0.05147200099078185, 3.0289034223836198, 4.420969727367218, 0.5548472354326368, 7.6996791663005775, -1.6282403199034954, 5.348544119614729, 21.35326419320929, -4.793620523759406, 11.225575332559618, 6.152036025814946, 5.907936643068622, 2.065375056615698, -1.787694599498524, 1.6927703264969536, -5.1005563777674015, 0.8229986195754446, -6.522163297672878, 17.008700967516226, -2.920071987681608, 6.666002113680717, 2.658497504662987, 4.755938584607503, 8.007419659946148, -1.9149730600319408, -0.725829673690106, -13.835204207428658, -8.607262470360888, 3.8244380349248797, 11.403987251851532, -6.741764106230448, -13.019804981997936, 2.7734278963334775, -5.4347359854568165, 3.1090414455624904, 4.973694770723139, -0.3319266207141889, 1.6987241445601218], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.091874470111991, -12.44342358794337, -11.381120708773448, -4.659938024358729, -16.309069855560114, -19.704827480582846, -6.144656519239207, -9.903236265198933, -16.164236061262475, -17.104725614867977, -20.42568192009717, -17.10651822720491, -8.152755569720824, -19.44541943054777, -21.01567899754051, -12.636327137392046, -12.715131519449157, -12.657606892760466, -12.65313043864375, -12.834418483009863, -8.900103120870176, -10.571356541283784, -17.9676298389504, -9.483749431055795, -10.764191920146505, -10.878121549916926, -13.487944634400984, -7.360002974228835, -17.176752831125917, -9.716643089500714, -12.859776089198563, -15.54049555459377, -16.932936687009857, -14.597183093400705, -6.331459715915911, -16.387813803298073, -14.638568315435277, -10.013326322472688, -11.65349428551314, -14.152544270640597, -15.23259117395674, -11.414164658339, -8.234071634523199, -13.761681780446667, -12.717107461704527, -13.17329408456419, -9.712300570967892, -10.217018527401017, -6.129775215277714, -3.448543689016392, -5.328021521508679, -18.376127897078128, -7.4281103763553205, -16.082512026777998, -9.383643221495896, -17.888493670047385, -16.161616593604805, -12.262517867112434, -6.482240466196666, -10.62663167453627, -14.007195172768952, -14.025056808145296, -13.909634392894823, -8.11729248878228, -6.022960742705031, -20.675949919413004, -14.1417889432656, -8.484843145084453, -7.1412290028113246, -8.078744651598647, -15.322870392618503, -4.796445244371071, -12.835907859846008, -22.37680696163034, -18.39501590194541, -18.708088452960975, -17.76171483632917, -20.841652629940253, -17.811651430397003, -12.311645560269408, -14.364394678245624, -17.95842744916671, -18.47322349507604, -16.211134670046693, -6.529015668548189, -7.510011721615075, -15.55565939718717, -19.70071794945814, -12.010198153121161, -18.30061236442594, -14.712671025196931, -6.144417490856225, -11.036557509147007, -15.22202135690481, -13.531190061920524, -19.44047732477918, -20.9406466822739, -6.7022203196874655, -8.267036536262273, -11.2206298191826, -10.276800779322928, -20.075058182508386, -7.078965707456126, -14.43935138874635, -29.808649353264148, -8.809000687661024, -21.651063823910725, -16.937585760638363, -31.08622363929522, -9.256475259738998, -8.631999917606734, -9.578223181197476, -7.615551845848149, -15.634871183475077, -18.94587140452695, -33.67683354349224, -14.51389425540974, -13.286844873480954, -10.252537355680394, -20.99313376660587, -17.180697820866804, -16.21438539656179, -12.874767003543221, -11.208891242105532, -9.890765033593832, -20.325579425133668, -18.935514763715013, -6.879546644782874, -15.433245415897098, -9.367029106917798, -10.700297678841103, -15.774157126347895, -14.643574660576757, -8.513998183484775, -10.713280755975024], "policy_policy_agent__reward": [8.855883363853813, 8.855883363853813, 6.7978949358217955, 6.7978949358217955, 4.2681630193402516, 4.2681630193402516, 1.53569955024902, 1.53569955024902, 7.122307956145873, 7.122307956145873, 15.71978510794114, 15.71978510794114, 1.878479191088457, 1.878479191088457, 4.09230507500778, 4.09230507500778, 7.203295714250888, 7.203295714250888, 6.546218575554362, 6.546218575554362, 13.400461396329952, 13.400461396329952, -0.14941708959502986, -0.14941708959502986, 5.02756698636272, 5.02756698636272, 15.878503136902095, 15.878503136902095, 15.745226379718545, 15.745226379718545, 10.040938707349348, 10.040938707349348, 2.9743949649726926, 2.9743949649726926, 9.32843439786344, 9.32843439786344, 7.2643493176689615, 7.2643493176689615, 10.44336232887295, 10.44336232887295, -0.466345843224868, -0.466345843224868, 5.953318559424726, 5.953318559424726, 8.163307749449606, 8.163307749449606, 2.5053010867014547, 2.5053010867014547, 2.468989532230745, 2.468989532230745, 5.088481443088422, 5.088481443088422, 7.903993350016542, 7.903993350016542, 2.9405374149894925, 2.9405374149894925, 7.803191642278746, 7.803191642278746, 0.7764518872853186, 0.7764518872853186, 8.71135096830098, 8.71135096830098, 9.99998753837537, 9.99998753837537, 11.632276471037311, 11.632276471037311, 11.836985204722417, 11.836985204722417, -1.0115020185039925, -1.0115020185039925, 5.479344414496884, 5.479344414496884, 7.290955754989083, 7.290955754989083, 4.283930802917572, 4.283930802917572, 6.914751689658273, 6.914751689658273, 0.08040521559315977, 0.08040521559315977, 11.589064043998329, 11.589064043998329, 7.535298760339245, 7.535298760339245, -0.8606080438050423, -0.8606080438050423, 7.675564701362216, 7.675564701362216, 6.972535400323592, 6.972535400323592, 4.74892244310585, 4.74892244310585, 1.7412329021843092, 1.7412329021843092, -4.413215970697762, -4.413215970697762, 1.480812240602079, 1.480812240602079, -0.21077300140595145, -0.21077300140595145, -0.516954869264171, -0.516954869264171, 12.828101582464566, 12.828101582464566, 4.482234331360085, 4.482234331360085, 10.6687137369266, 10.6687137369266, 2.932822588775534, 2.932822588775534, 12.996460514682346, 12.996460514682346, 9.260425710888452, 9.260425710888452, 5.011523229123627, 5.011523229123627, 3.5224452018302035, 3.5224452018302035, 5.816826089860878, 5.816826089860878, 8.344117894145649, 8.344117894145649, 4.9426232161205865, 4.9426232161205865, 8.125484324309783, 8.125484324309783, 3.043509303731718, 3.043509303731718, 1.969940783327208, 1.969940783327208, 13.521596145462427, 13.521596145462427, 9.217829087513062, 9.217829087513062, 2.6580033076856053, 2.6580033076856053, 1.605455810827055, 1.605455810827055, 0.9400621514454348, 0.9400621514454348, -0.26100498512142006, -0.26100498512142006, 0.8632065185122548, 0.8632065185122548, 6.85054936654128, 6.85054936654128, 9.129843214692174, 9.129843214692174, 9.63836892327645, 9.63836892327645, 10.158712498624984, 10.158712498624984, 13.496518329477519, 13.496518329477519, 14.056698922927154, 14.056698922927154, 6.8872424151707285, 6.8872424151707285, 5.285531009078168, 5.285531009078168, 3.4213656717744514, 3.4213656717744514, 15.164779434593193, 15.164779434593193, 12.426256924279128, 12.426256924279128, 11.530739519601438, 11.530739519601438, 3.40837716749874, 3.40837716749874, 0.6046504063153161, 0.6046504063153161, 7.953438377243833, 7.953438377243833, 13.245793898620875, 13.245793898620875, 3.9463170281689655, 3.9463170281689655, 10.351801137379411, 10.351801137379411, 11.169667329192094, 11.169667329192094, 2.625874786392198, 2.625874786392198, 6.106537251055423, 6.106537251055423, 6.7401275199046555, 6.7401275199046555, 8.841501619323967, 8.841501619323967, 11.413778366307055, 11.413778366307055, 13.066015944464962, 13.066015944464962, 3.3768461603391233, 3.3768461603391233, 5.647969979322946, 5.647969979322946, 7.820799773274908, 7.820799773274908, 5.415824007377782, 5.415824007377782, 13.88736867440448, 13.88736867440448, 2.725362693776316, 2.725362693776316, 9.893947754180541, 9.893947754180541, 25.580956773236718, 25.580956773236718, 2.0076900819508094, 2.0076900819508094, 16.438319578235173, 16.438319578235173, 11.54481089322666, 11.54481089322666, 18.497080141181918, 18.497080141181918, 5.660925158177348, 5.660925158177348, 3.422152659054107, 3.422152659054107, 5.635496753847215, 5.635496753847215, 1.2574977340403735, 1.2574977340403735, 8.228934901525264, 8.228934901525264, 6.211854053427037, 6.211854053427037, 25.342767255504235, 25.342767255504235, 5.796911133864066, 5.796911133864066, 9.976423493580834, 9.976423493580834, 6.455517430171692, 6.455517430171692, 12.874536175606679, 12.874536175606679, 12.59405874040648, 12.59405874040648, 7.1497061682649266, 7.1497061682649266, 6.074468664926555, 6.074468664926555, -1.3131564826615616, -1.3131564826615616, 0.6417512816164742, 0.6417512816164742, 12.075008730029275, 12.075008730029275, 15.16975100778327, 15.16975100778327, 0.06889126927621285, 0.06889126927621285, 1.2067202169495783, 1.2067202169495783, 6.070228501625638, 6.070228501625638, 2.632780846692142, 2.632780846692142, 9.441599285955194, 9.441599285955194, 9.808634715649948, 9.808634715649948, 4.091035781385294, 4.091035781385294, 6.206002450267574, 6.206002450267574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3446465780113331, "mean_inference_ms": 2.2739353310057284, "mean_action_processing_ms": 0.09902017441326173, "mean_env_wait_ms": 0.5969122949001947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 124875, "timesteps_this_iter": 0, "agent_timesteps_total": 374625, "timers": {"sample_time_ms": 13516.742, "sample_throughput": 249.69, "load_time_ms": 0.399, "load_throughput": 8458784.583, "learn_time_ms": 2270.7, "learn_throughput": 1486.326, "update_time_ms": 29.116}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 19.602649688720703, "policy_loss": 0.0005679097550455481, "vf_loss": 19.611677169799805, "vf_explained_var": -0.06645265817642212, "kl": 0.007764491355399828, "entropy": 0.9596004664897919, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 8.647886776924134, "policy_loss": -0.009852030873298645, "vf_loss": 8.666429471969604, "vf_explained_var": 0.033991476893424986, "kl": 0.005682126885675515, "entropy": 0.8833121061325073, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124875, "num_agent_steps_sampled": 374625, "num_steps_trained": 124875, "num_agent_steps_trained": 374625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4995, "training_iteration": 37, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-55-56", "timestamp": 1706108156, "time_this_iter_s": 13.20088267326355, "time_total_s": 500.2840576171875, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A0D1EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 500.2840576171875, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 34.21764705882353, "ram_util_percent": 66.4235294117647, "gpu_util_percent0": 0.09823529411764707, "vram_util_percent0": 0.2475873161764706}}
{"episode_reward_max": 21.732085126533192, "episode_reward_min": -13.022513331947772, "episode_reward_mean": -0.16756123834852216, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -29.451096590574835, "policy_agent_": -0.9646596871559168}, "policy_reward_max": {"policy_adversary_": -3.5150215063978028, "policy_agent_": 24.613198328719754}, "policy_reward_mean": {"policy_adversary_": -12.532595500330656, "policy_agent_": 6.182517130991068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.845002018229438, -7.8416158003546155, 7.061998076907699, 4.655977460644904, 2.67455031438112, -10.470814782810365, 1.6573849351484007, -0.1562317885301483, 4.026463909858242, -1.2930000803749264, -2.3269616831660755, -7.43361082861709, 3.9788954410315887, -3.055946823884935, -6.7240207001915735, 0.8061444130908484, 0.6672050693178848, -0.7429191236795991, -0.23235758110700866, 0.8905271300823598, 3.7055353584898247, 2.18102728432977, 3.0757568827590487, -1.8831171410015008, -4.393913160374334, -6.556968312385772, 0.3353999032607197, 5.435284489984591, 1.0023119993859777, 1.7292936182948402, 9.726688278271396, 6.139033465958751, -0.17446224789429066, -3.4078256069598174, 0.6232392096105213, 1.2629509640342005, 1.1644965379680172, -1.9007600444169022, -3.2810163925080396, -3.034231412619077, -4.929362595054124, -12.130121253215208, -4.624839631267993, 0.8758744701996225, 3.6834272556296104, -6.021859011665608, -6.50657283832274, 21.732085126533192, 4.402507103397637, 0.46605845690979975, 5.452697243804056, 8.437691681912918, 7.4544300608976215, -11.698560437489041, 3.2468255163587156, -10.776922170084887, -2.6009014157082637, -10.372272231052126, -0.659527653157125, -10.310958404964454, 1.7416155567683844, -4.181683025152984, -0.04809056390365353, -5.5849951824392665, -0.28499819042291985, 11.669540200457384, 1.2275687718200654, -4.92964927180239, -2.8468968066473215, 4.500972262109443, 7.7703069020511855, 5.516393175202051, -2.491917515125327, -0.32767576222115663, -3.2134166083846374, 2.439302534910019, 1.9643162617728347, -7.509070161257373, -5.355665812858361, -3.7109367385872494, -1.461812809767423, 0.14127728051261434, -0.5814867997691635, 9.844806676195162, 9.060290859343892, -3.1518364967067174, 1.6557949009097954, -4.826802119342213, -4.196855957612089, 3.76030315432551, -1.0212801241075233, -1.838584699314721, 1.9918284216727367, -6.2200984856559804, 2.7301386945842117, 4.015516207679992, -0.10861380820103814, 8.59625749012315, 4.228085186916956, 2.5728408163882346, 1.1804146574829344, 16.13614638900524, 1.286380799217814, 3.917954536409637, -3.2048375927596098, -6.272642227377567, -2.175091678350307, -1.921964108812503, -6.507064258070898, -3.0698105595851226, -1.292000284657493, -2.96267680615848, -4.683014532982446, -5.4173496150802185, 5.142014196915874, -4.222678085158783, -0.24537226044480176, -7.968781511823211, 1.1209458816559918, 9.010958058525986, 3.1702033018546074, 8.295191214897216, 1.4001398767511206, 9.829768571026445, 5.891388284096032, -6.92403114245312, -13.022513331947772, -5.984720453709454, 1.8112936299991862, -1.0640077682525153, 2.8004311248152307, -3.405633703846219, -1.9098052836783508, -3.1954908573086693, 1.135611460922833], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.603034932157243, -18.82695987798194, -15.997489167783154, -12.08133924391723, -12.159132770205188, -8.871959836978688, -12.676421951610454, -11.87653597584812, -8.367746891616532, -24.29058323005637, -4.341332314130293, -8.21876520043136, -12.07436275629706, -8.05577182605454, -16.399604533293758, -9.090129758931734, -5.5442679989679124, -16.134505971011524, -13.289304542620137, -15.154633853679254, -9.56019347579632, -11.63066394156377, -14.120961400210184, -17.083637867016083, -7.764317905387706, -22.338235708869632, -10.586394736502731, -12.050693964459727, -10.4180959973358, -10.28993848421541, -18.910831344415143, -18.761448556973313, -11.147393126051627, -7.464535382109634, -8.293518407199286, -6.538384328135387, -18.498255610457093, -3.5150215063978028, -21.753701646674887, -14.832612394345052, -14.71968889753222, -21.5635236080361, -3.9028667851021797, -10.202080181740683, -10.809191060646286, -8.487600451223, -11.05980779806296, -27.494311530906323, -22.448934506761468, -13.117070660172155, -16.854525015900414, -15.536200816372252, -17.362769032530544, -10.17219719955988, -15.775730000075557, -19.394289270768503, -6.6343742743196294, -8.442952856740291, -10.145353956250728, -10.017035128637353, -13.632008819673574, -7.5237003212438, -4.719213297044186, -13.06028377676082, -9.289108957766821, -29.451096590574835, -12.95669088117592, -14.441964904623847, -11.352056228602061, -12.71689878302265, -17.33953278440372, -14.15369393123179, -7.168368720887611, -8.279099148913597, -7.406607040924342, -17.18534643077832, -8.86255666531851, -10.339208569409054, -8.63777947043998, -13.283821724643527, -6.1796049782999924, -15.319264402279101, -12.760195324091534, -19.347246953826065, -17.50052296738078, -7.048191746970712, -9.968624170691248, -9.118839051465697, -6.677291830345552, -11.941326739594073, -8.4605581322779, -6.977854576895323, -13.930350344337599, -17.297183729262223, -13.927705884177202, -9.110625422203013, -19.722311599269485, -13.309749304621146, -21.55387054110159, -10.099131430978078, -6.717401798248422, -26.04171705132258, -12.447895274312472, -9.318584939956226, -19.05796520466854, -10.766188184488444, -14.198441684423377, -15.991977216974435, -16.73628741459682, -9.563438555490444, -10.824145422717777, -15.915765758584918, -8.653896071260684, -8.575845034554309, -15.748314428826887, -7.30602788904682, -13.800411292218717, -13.366157447696953, -9.175100470833298, -16.339158767283088, -9.62224804430142, -18.02007259236482, -5.698310767516345, -19.638595863525623, -14.840039428841001, -7.482082505842583, -17.897581494971202, -7.337825294067667, -9.215496467461591, -10.98330169743389, -13.88235443511067, -13.940176753401241, -4.618743134770151, -8.33252932250608, -9.043607208484397], "policy_policy_agent__reward": [0.879016456963902, 0.879016456963902, 5.4926720388136605, 5.4926720388136605, 11.529743622345425, 11.529743622345425, 8.368658352281068, 8.368658352281068, 7.4168415422931515, 7.4168415422931515, -0.7994274729158422, -0.7994274729158422, 7.166903443379429, 7.166903443379429, 5.860152093658986, 5.860152093658986, 6.197105400737388, 6.197105400737388, 11.49879157484072, 11.49879157484072, 1.0071853154821084, 1.0071853154821084, 0.39257718590713336, 0.39257718590713336, 8.026629098664321, 8.026629098664321, 2.499912501084802, 2.499912501084802, 4.837791916551089, 4.837791916551089, 4.948137086011291, 4.948137086011291, 3.1057365341428995, 3.1057365341428995, 7.69579342366596, 7.69579342366596, 6.5284734807565625, 6.5284734807565625, 8.022580491880808, 8.022580491880808, 6.632864417143073, 6.632864417143073, 6.905845612946772, 6.905845612946772, 8.598359141484616, 8.598359141484616, 7.600260363007292, 7.600260363007292, 1.685202372506686, 1.685202372506686, 7.890633698241932, 7.890633698241932, 5.4608973198817266, 5.4608973198817266, 8.742989227222159, 8.742989227222159, 5.71020399836089, 5.71020399836089, 6.009616051255124, 6.009616051255124, 14.318759811343265, 14.318759811343265, 12.450241011466028, 12.450241011466028, 5.4864654390786685, 5.4864654390786685, 2.028354887574908, 2.028354887574908, 4.458378808404907, 4.458378808404907, 3.9006676460847944, 3.9006676460847944, 9.831376074212558, 9.831376074212558, 0.8071307309904506, 0.8071307309904506, 9.236342627083426, 9.236342627083426, 5.8991904908629875, 5.8991904908629875, 4.895163151239046, 4.895163151239046, 4.7167011774104415, 4.7167011774104415, -0.36098642308290463, -0.36098642308290463, 5.538977325970154, 5.538977325970154, 7.246309158137952, 7.246309158137952, 1.2328707197786957, 1.2328707197786957, 2.27661747987011, 2.27661747987011, 24.613198328719754, 24.613198328719754, 13.425720805079555, 13.425720805079555, 6.791564558540977, 6.791564558540977, 11.153611129852237, 11.153611129852237, 11.986946249142585, 11.986946249142585, 12.408599546714084, 12.408599546714084, -0.7631816189645761, -0.7631816189645761, 9.511277758217135, 9.511277758217135, 4.308683550341808, 4.308683550341808, 2.0167364293056833, 2.0167364293056833, -0.9646596871559168, -0.9646596871559168, 4.742913151546803, 4.742913151546803, -0.1469616381635509, -0.1469616381635509, 7.68681218822098, 7.68681218822098, 1.6710086480454067, 1.6710086480454067, 2.3355613665702655, 2.3355613665702655, 3.737644297160779, 3.737644297160779, 4.502055383671952, 4.502055383671952, 20.56031839551611, 20.56031839551611, 7.09212982649799, 7.09212982649799, 4.756157816410731, 4.756157816410731, 4.252579710977372, 4.252579710977372, 8.608935522566046, 8.608935522566046, 12.554919843227454, 12.554919843227454, 9.835043553216922, 9.835043553216922, 2.3382256028811432, 2.3382256028811432, 3.97571169334622, 3.97571169334622, 2.096595216269853, 2.096595216269853, 9.812324482844172, 9.812324482844172, 5.413436463545669, 5.413436463545669, 1.4150692040758348, 1.4150692040758348, 1.6410568287908112, 1.6410568287908112, 4.786442493028139, 4.786442493028139, 2.3588960842662843, 2.3588960842662843, 7.730270841395852, 7.730270841395852, 6.089354262161182, 6.089354262161182, 14.596026815010614, 14.596026815010614, 13.280406913362334, 13.280406913362334, 1.9481776251319984, 1.9481776251319984, 5.8122095358005215, 5.8122095358005215, 2.1460184660617423, 2.1460184660617423, 1.2402179363667307, 1.2402179363667307, 7.850814946959791, 7.850814946959791, 3.7196390040851877, 3.7196390040851877, 2.5696349387903026, 2.5696349387903026, 7.961089383005169, 7.961089383005169, 5.53854262180312, 5.53854262180312, 8.328922289380706, 8.328922289380706, 6.563070814941502, 6.563070814941502, 9.806848895534221, 9.806848895534221, 10.953003397372147, 10.953003397372147, 12.89097786400927, 12.89097786400927, 6.335986123683154, 6.335986123683154, 3.948908227865678, 3.948908227865678, 21.088931720163917, 21.088931720163917, 6.867138036765144, 6.867138036765144, 6.61826973818293, 6.61826973818293, 7.926563805954466, 7.926563805954466, 2.2467729785554376, 2.2467729785554376, 6.011675003036534, 6.011675003036534, 7.035006554080961, 7.035006554080961, 5.11461157826296, 5.11461157826296, 3.24681399795266, 3.24681399795266, 4.7660725690301415, 4.7660725690301415, 6.47654447621322, 6.47654447621322, 1.985440769139119, 1.985440769139119, 1.5792477097370434, 1.5792477097370434, 10.44516431287138, 10.44516431287138, 1.5416749019440181, 1.5416749019440181, 6.777519515886955, 6.777519515886955, 2.698687967936869, 2.698687967936869, 5.148023176244645, 5.148023176244645, 12.67505841290454, 12.67505841290454, 6.396225673078016, 6.396225673078016, 13.157631903631017, 13.157631903631017, 3.5492253221337338, 3.5492253221337338, 14.734182217276038, 14.734182217276038, 10.365713856468517, 10.365713856468517, 0.27902568169473285, 0.27902568169473285, 2.4375340815117115, 2.4375340815117115, 0.6765524201791074, 0.6765524201791074, 5.5133950487303895, 5.5133950487303895, 4.959646964590689, 4.959646964590689, 8.341392779962952, 8.341392779962952, 5.267271524777513, 5.267271524777513, 1.3544689255459006, 1.3544689255459006, 2.568519232598704, 2.568519232598704, 5.089609334703614, 5.089609334703614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34388776350040323, "mean_inference_ms": 2.267101997548766, "mean_action_processing_ms": 0.09889110577409567, "mean_env_wait_ms": 0.5952105709047941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 128250, "timesteps_this_iter": 0, "agent_timesteps_total": 384750, "timers": {"sample_time_ms": 13510.751, "sample_throughput": 249.801, "load_time_ms": 0.496, "load_throughput": 6807297.908, "learn_time_ms": 2236.916, "learn_throughput": 1508.774, "update_time_ms": 28.814}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 17.62597370147705, "policy_loss": 0.0038293750840239227, "vf_loss": 17.631476211547852, "vf_explained_var": -0.0753817081451416, "kl": 0.0032141692082891084, "entropy": 0.933122843503952, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.083072090148926, "policy_loss": -0.011659530372708105, "vf_loss": 7.1033097267150875, "vf_explained_var": 0.026680707931518555, "kl": 0.007240369699595436, "entropy": 0.875899788737297, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128250, "num_agent_steps_sampled": 384750, "num_steps_trained": 128250, "num_agent_steps_trained": 384750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5130, "training_iteration": 38, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-56-08", "timestamp": 1706108168, "time_this_iter_s": 12.112542390823364, "time_total_s": 512.3966000080109, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF20D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 512.3966000080109, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.8875, "ram_util_percent": 66.375, "gpu_util_percent0": 0.183125, "vram_util_percent0": 0.227996826171875}}
{"episode_reward_max": 14.10845088944341, "episode_reward_min": -15.420360378785373, "episode_reward_mean": -0.9798583798710642, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.924997171186988, "policy_agent_": -2.900767189253658}, "policy_reward_max": {"policy_adversary_": -5.258713675341317, "policy_agent_": 19.049962648707314}, "policy_reward_mean": {"policy_adversary_": -12.723486011360515, "policy_agent_": 5.871813815744727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4468628307677074, 0.8014981908965693, 5.236719737103891, 11.652298675124865, -1.868841718130627, 6.062728467185361, 5.254160460397212, -0.9061239866850717, -8.893806218026716, -7.967655396269775, -5.724564203843881, 7.903454796601917, -2.241598841767862, -1.1542686654592342, 0.07845413781153604, -2.794466536732705, -3.3901331206326986, 0.7035230245325124, -1.336381232029486, -2.0302322512305904, -10.0243610887597, 0.3364923616790353, -0.7783739131499976, 2.569823160057531, -6.686189910772039, 10.8158335061486, -12.246181022219897, -13.2925238017624, -3.703648385926646, 2.3221324744734377, 1.828752556356625, 0.8174773426511288, -2.782579630390723, 1.687336936671621, -0.826799951739374, -5.461206441444674, -10.772100740377182, -6.812780673183002, 14.10845088944341, -3.0847860349633036, -2.3610938325281055, -4.278739994084881, -11.060248053848643, 0.7962625124332128, 1.5036934721228037, 1.5026854815619908, -2.169828040107695, 5.564837617901653, -15.202209807794414, -7.206199279043336, 0.3412159969126896, -1.6078218482887054, 4.332939019230454, 1.351245321024423, 1.7227530456673612, 1.0034251336880056, -8.224207604036481, 3.2477311840937775, -1.5690426787697818, -0.7990241928926867, -2.020690661564875, -0.22582796767890034, 4.393971626931194, 3.8174443440090253, -0.3058741171384072, -3.486469529707264, -1.9046450665566768, -0.3286473668387597, 2.7058499409127266, 5.875192035923001, -1.4765001938213245, 1.2235160368382156, 1.1315714347657433, 5.738493170162146, -6.824815749723455, 0.3200179938272449, -1.8760883490071478, 3.2026886634869602, 6.99142038435791, -11.731686931324788, 0.3793055337741388, -10.116895684343197, 0.8123137526244221, -3.9870704564150246, -3.3182999767113586, -2.818694830550769, 0.9883822440918442, -11.999741784164005, -6.146080977432402, -0.13192378678061162, 1.0982545297408435, -14.197554041649749, 4.702618366329704, 4.458010950607997, 1.1974344899006595, 0.806054660623094, 0.4814516795762246, 0.2603205020068224, -4.035497527522715, -1.6615907741207847, -12.630689443255756, -6.76728962514509, -7.949741226116612, -5.952257160335041, 0.6766977574393669, 7.897113770475846, -1.2854117225796389, -6.153752018402922, 6.099112720026777, 0.7345362948817737, 7.264072671336827, 5.29076489543305, 0.5878561195905928, -15.420360378785373, 13.974031214026132, 2.8298280840461745, -6.26080932706175, -6.040095109948072, 0.7364761979625071, -0.7914192693054829, 5.207141721994239, 3.826828732097892, 4.060508719602757, -6.035437687457641, 0.8296182863470034, -8.699218908753618, -6.081875490167386, 5.32522766457033, 8.847449576859391, 0.7975349423988525, -2.984191733569053, 3.12741100499403, -0.9817334175463569, 4.249166818230651, -4.438736098027368], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.591438310827785, -8.02180876801288, -10.864896323881615, -19.69590365134336, -9.312543431932125, -14.3448941664429, -16.460533357209805, -5.970514415777366, -27.924997171186988, -10.137426387110372, -13.58363347470211, -12.242710980367795, -10.276959356162132, -10.27165796927252, -7.546608228511726, -7.748143365026642, -16.03699835114137, -14.787648189052257, -7.696316167136472, -13.70678040448242, -9.014641515374256, -18.203171669085883, -11.666732329606875, -9.723565968367614, -17.548187661278803, -17.046450256070703, -12.363855977914065, -17.813526599408245, -17.064543652182405, -8.787472897004196, -9.526482039896964, -7.544562751848172, -21.724260784743493, -7.511191363591281, -9.627849207533728, -13.596337352982145, -15.055383800375282, -17.485202533648113, -21.014205670213208, -16.01944846194552, -8.140469763955076, -18.359734117721818, -5.258713675341317, -11.829291008600949, -13.22731745288776, -11.440066190478973, -15.671953470524423, -14.10754459515668, -13.225433483630308, -9.028762698942282, -9.61857115489734, -7.720947824351402, -25.725116761727996, -15.816578654597444, -13.152317235186354, -11.126183707541887, -17.348585444428984, -8.892135884905976, -18.02354673513842, -6.465178430881249, -8.750837956985603, -12.018566924128196, -10.565446312096215, -14.401418672544256, -11.985204345236369, -16.87503333907001, -9.686940020726503, -11.97624325352984, -16.1297375487823, -14.923666824891693, -8.875705400918896, -7.909412331414861, -7.474548773561846, -19.747124661773395, -10.140782735371973, -19.17634993026307, -15.599500943190124, -6.966941428102792, -15.402730951063177, -16.452921113188054, -11.473196934502443, -7.761783680633826, -8.727394770543908, -8.307354257449648, -9.405397101828903, -10.259001579053516, -10.890251282085806, -13.912130266946452, -15.201393723533558, -6.248297181503043, -13.121186445324852, -14.301415477376295, -14.163280663515264, -11.759990424499787, -14.68125437134295, -15.3704882225454, -8.263942770277433, -13.523717323428551, -19.620874588762945, -13.039030807575148, -7.310143454180119, -9.787588965206309, -15.039421543596756, -18.218946694338438, -7.836093070781469, -15.61035310427768, -9.063129941654196, -15.96950325495309, -12.981840460599727, -14.164153737866934, -15.931008589203975, -11.781334645137987, -8.610502679397522, -11.91804016652524, -24.12589408338848, -12.19916823692427, -12.679112926845043, -9.616198679084436, -8.998356808660917, -13.393191687595133, -18.848666782236833, -15.632282557582478, -11.884113090339556, -14.272299273495136, -8.650548841836443, -6.868340019780784, -15.48917111174336, -13.882658164943766, -16.442948274070787, -7.816909861292552, -10.803926014320288, -12.66743880957619, -8.587421610306063, -12.011618845210174, -9.749856953600599], "policy_policy_agent__reward": [6.07228774003004, 6.07228774003004, 4.411653479454726, 4.411653479454726, 8.050808030492755, 8.050808030492755, 15.674101163234118, 15.674101163234118, 3.7218508569007493, 3.7218508569007493, 10.203811316814132, 10.203811316814132, 10.857346908803509, 10.857346908803509, 2.5321952145461473, 2.5321952145461473, 9.51559547658014, 9.51559547658014, 1.084885495420292, 1.084885495420292, 3.9295346354291127, 3.9295346354291127, 10.073082888484857, 10.073082888484857, 4.017680257197135, 4.017680257197135, 4.558694651906642, 4.558694651906642, 3.81253118316163, 3.81253118316163, 2.47683841414697, 2.47683841414697, 6.323432615254333, 6.323432615254333, 7.745585606792383, 7.745585606792383, 3.1799674675534932, 3.1799674675534932, 5.8382740766259165, 5.8382740766259165, -0.5048597866927211, -0.5048597866927211, 9.269832015382459, 9.269832015382459, 5.44417920822844, 5.44417920822844, 6.146694564212573, 6.146694564212573, 5.4309988752533815, 5.4309988752533815, 13.931141881109653, 13.931141881109653, 0.05883747784708629, 0.05883747784708629, 2.260501398822924, 2.260501398822924, 6.680447633127882, 6.680447633127882, 5.554802685738819, 5.554802685738819, 5.677617298126795, 5.677617298126795, 4.181020047249651, 4.181020047249651, 9.47084057717639, 9.47084057717639, 4.59926415013145, 4.59926415013145, 4.400524627897177, 4.400524627897177, 4.067565455768731, 4.067565455768731, 2.141641529999048, 2.141641529999048, 5.336210930232557, 5.336210930232557, 17.561328279828317, 17.561328279828317, 6.467331213491106, 6.467331213491106, 2.8896879657134846, 2.8896879657134846, 7.0404970618184715, 7.0404970618184715, -2.900767189253658, -2.900767189253658, 6.312776760517082, 6.312776760517082, 7.365505462505279, 7.365505462505279, 6.471375836020482, 6.471375836020482, 6.7510627152083655, 6.7510627152083655, 9.836191106529164, 9.836191106529164, -0.9883881620820529, -0.9883881620820529, 0.9112817099494714, 0.9112817099494714, 4.979893575905014, 4.979893575905014, 3.0565629880313487, 3.0565629880313487, 15.029027890479226, 15.029027890479226, 8.583911987810934, 8.583911987810934, 7.437535140426857, 7.437535140426857, 6.064804420614947, 6.064804420614947, 4.562188920196253, 4.562188920196253, 6.069933534499876, 6.069933534499876, 8.227252028184319, 8.227252028184319, 2.8330771189942805, 2.8330771189942805, 3.3650736477103638, 3.3650736477103638, 5.8963694782246465, 5.8963694782246465, 7.479708969513704, 7.479708969513704, 9.10943150827664, 9.10943150827664, 5.83966511404898, 5.83966511404898, 6.694281904681374, 6.694281904681374, 3.891147477084915, 3.891147477084915, 5.823797943345539, 5.823797943345539, 9.417793744847511, 9.417793744847511, 10.399429430407345, 10.399429430407345, 3.699602603548785, 3.699602603548785, 4.566464184126538, 4.566464184126538, 4.3030601041637935, 4.3030601041637935, 12.742808915967771, 12.742808915967771, 1.6579834928242563, 1.6579834928242563, 9.748183962045157, 9.748183962045157, 6.861706297091487, 6.861706297091487, 5.084815045794877, 5.084815045794877, 11.19707566771054, 11.19707566771054, 2.360617090931633, 2.360617090931633, 5.92625123413829, 5.92625123413829, -1.1775560018546867, -1.1775560018546867, 4.769854261584165, 4.769854261584165, 2.16014190051731, 2.16014190051731, 3.0435485625587706, 3.0435485625587706, 3.7201533742513737, 3.7201533742513737, 5.939316763088826, 5.939316763088826, 0.9561942413912226, 0.9561942413912226, 4.527656373050578, 4.527656373050578, 3.058186697361216, 3.058186697361216, 7.109720487532851, 7.109720487532851, 0.05193071786328185, 0.05193071786328185, 9.432949514922488, 9.432949514922488, 8.109000687553891, 8.109000687553891, 7.939344430621807, 7.939344430621807, 8.088271441584249, 8.088271441584249, 4.372697224926829, 4.372697224926829, 6.8920189127176865, 6.8920189127176865, 7.792688530620117, 7.792688530620117, 5.688720016727184, 5.688720016727184, -2.660272994537815, -2.660272994537815, 1.5101496700306096, 1.5101496700306096, 3.544840158740075, 3.544840158740075, 6.133344767001699, 6.133344767001699, 4.2563954141104166, 4.2563954141104166, 11.75373343737676, 11.75373343737676, 3.888859109537278, 3.888859109537278, 4.907875618275082, 4.907875618275082, 9.54047659031325, 9.54047659031325, 7.449345016374355, 7.449345016374355, 11.5975406302704, 11.5975406302704, 8.536049770285517, 8.536049770285517, 4.599179399494058, 4.599179399494058, -1.7511601061300643, -1.7511601061300643, 19.049962648707314, 19.049962648707314, 7.514498160485225, 7.514498160485225, 3.2091517998916466, 3.2091517998916466, 1.78805178456818, 1.78805178456818, 4.867416503311713, 4.867416503311713, 6.300886209144826, 6.300886209144826, 12.027904252115535, 12.027904252115535, 9.729555644840186, 9.729555644840186, 7.972310904971158, 7.972310904971158, 4.1184307930187485, 4.1184307930187485, 4.740083564091724, 4.740083564091724, -0.9154394444864195, -0.9154394444864195, 4.703647810787985, 4.703647810787985, 9.603942914757047, 9.603942914757047, 12.645198925465088, 12.645198925465088, 4.307222401845701, 4.307222401845701, 3.9098671403756162, 3.9098671403756162, 7.897424907285109, 7.897424907285109, 3.8028440963798538, 3.8028440963798538, 8.130392831720416, 8.130392831720416, 2.6555604277866167, 2.6555604277866167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3439525669915762, "mean_inference_ms": 2.2674762306292777, "mean_action_processing_ms": 0.09901476280933068, "mean_env_wait_ms": 0.5953008178004302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 131625, "timesteps_this_iter": 0, "agent_timesteps_total": 394875, "timers": {"sample_time_ms": 13612.994, "sample_throughput": 247.925, "load_time_ms": 0.396, "load_throughput": 8521415.844, "learn_time_ms": 2211.476, "learn_throughput": 1526.13, "update_time_ms": 27.819}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005000000000000001, "total_loss": 15.987592601776123, "policy_loss": 0.006063037039712072, "vf_loss": 15.990444946289063, "vf_explained_var": -0.05110586881637573, "kl": 0.0033838986461830257, "entropy": 0.891538017988205, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 5.399909329414368, "policy_loss": -0.00922762993723154, "vf_loss": 5.417471790313721, "vf_explained_var": 0.033491691946983336, "kl": 0.006530409330227471, "entropy": 0.8498161196708679, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 131625, "num_agent_steps_sampled": 394875, "num_steps_trained": 131625, "num_agent_steps_trained": 394875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5265, "training_iteration": 39, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-56-21", "timestamp": 1706108181, "time_this_iter_s": 13.443340063095093, "time_total_s": 525.839940071106, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A0D1160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 525.839940071106, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.59411764705882, "ram_util_percent": 66.25294117647059, "gpu_util_percent0": 0.1176470588235294, "vram_util_percent0": 0.23398724724264705}}
{"episode_reward_max": 17.543379555479937, "episode_reward_min": -25.030359421173902, "episode_reward_mean": 0.10632700710753325, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.28752164897864, "policy_agent_": -8.062164784072575}, "policy_reward_max": {"policy_adversary_": -4.762705246719231, "policy_agent_": 25.415450602229292}, "policy_reward_mean": {"policy_adversary_": -13.257910146852394, "policy_agent_": 6.682118576979963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.603726497267012, -0.6875759055400958, -0.6405790859041745, -12.809154037054626, -1.364227024982005, 5.071710875797426, 6.805054579197717, -6.845956699929593, -9.336513289242713, 3.4599816301562156, 0.3245475388525682, -7.630986442826975, 0.11034092465192656, 12.20464104318872, -5.424456046762446, 3.763980343567643, -4.400172162385489, -7.745200819314514, -1.609718018000703, -5.623093659422077, -4.269819672210417, 0.4865378962278768, 13.840735271366954, 0.8710791980232442, -11.785680928090773, 8.684447152596572, 4.005957294905711, -3.6337411679143017, 5.5540785261875, 1.6607658062614894, 2.452346584298665, -4.452459156421848, 4.071464607615576, -13.084143196255882, 10.214170301931931, -0.4205325152218041, 0.7412578013767878, -14.647614599257565, -1.8189655266528502, 3.9583480313605306, -1.0722212677179632, 6.417917985293, -0.5155633169914053, 5.207984402088343, 1.4685995699761571, 3.2664720340994426, 1.7368779067318931, 6.506993348969603, -3.5896735344089588, -0.24911661296240525, 0.3451256461825358, 3.816813109719851, 0.6712828503587914, -0.9248137437190949, -5.147291380424941, -8.275149057582746, 0.44993741977803414, -4.997791527615361, -3.1903778428478544, 14.338726893293106, -1.8243114115636496, -2.7130970347380736, 8.000332628553924, 9.194240136827268, 1.7653581350942882, 9.223599032276963, -2.617569207320335, -1.3204640222430397, -7.0336539446488775, -3.6182508974903342, 2.0012453116330375, -2.3695145342064627, -3.024908541960098, 2.47949921573789, 6.598193178078521, 10.207699000029251, -5.999463949052958, -7.0774878103843974, 0.2542786035417507, 5.310627744194089, 5.311003743593827, 0.24547105426628524, -0.14873398120637282, 1.4218371176846496, 6.938322469884269, -3.7949344969948084, 0.8554885025661256, -7.192177017574541, 5.349298150940466, 2.241412733891514, -2.6604709438271574, -3.2448153100142103, -4.503951258359667, -0.6878344926111315, 9.436653656241916, -25.030359421173902, 2.8009098738231453, -6.61024690265576, 2.9530318505370765, 6.535218156501661, 17.543379555479937, -6.633022882544152, -3.838564298093236, 2.167017373768061, 10.313141072972106, -0.8998122664769923, -3.5505674210447076, -0.6364206844455562, -1.7655160408285406, 3.046129835618998, 8.007088630907493, -4.172386439641734, 1.3332082756666113, -3.0487993315979622, -7.302092574710361, -8.48215745678156, 5.382316554033467, -4.974162920174688, 2.2542033869558584, -2.0417675543493514, 9.79431976344527, 1.382873311545672, 1.5337385929558898, 5.243226507464137, 0.8066456534392787, 3.582821286593017, 2.7923031643919636, 0.294100916712129, -3.8119703754462257, 4.114989906792354, 3.285161099889478, -8.02024911045088, 3.8952915555797625, 0.5230630979966573, -1.1267211831045907], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-17.06890502227889, -15.400817646943489, -8.72398901383103, -12.413112117138132, -8.90595542964794, -14.54418253334508, -11.251684863289139, -11.364340576695307, -15.46066185836578, -17.70296040473082, -16.94122184543181, -15.538445645725199, -6.006546941647498, -21.819076110060806, -7.419267350395359, -10.35239481685515, -10.37679791405856, -9.196810617931789, -12.450661532468754, -8.895912199071962, -13.729817032706645, -11.433134538429474, -28.603163627586575, -10.688815913064708, -8.614355406287576, -15.990752697852452, -21.11881255268677, -21.40828430130329, -14.639787905272875, -11.937523842116232, -7.760021975876069, -16.651433165125358, -15.31963694575822, -14.500912404434326, -16.530072472145246, -14.522307064453699, -9.281270185320054, -22.45978877063895, -6.086385630537091, -14.85274979885891, -9.043291678250874, -14.515116922235189, -8.892792651617787, -14.325658621916228, -7.407785066674248, -9.250038832959415, -11.505147187179153, -11.470295712540551, -9.859593713073323, -8.055716307481823, -6.582414581455685, -16.1162069637227, -13.57719816520757, -6.825445617389265, -13.989448783681352, -13.526946606843557, -13.814516383043086, -12.297940341191739, -16.41911625197829, -28.645442854114027, -12.67232179415194, -10.099588754969485, -13.343357454655855, -20.669879232545558, -11.854360923330963, -18.348665214842658, -8.5300740141891, -9.40892869120416, -17.783040575949865, -7.820056465555357, -9.335428104891378, -8.314570444969352, -19.30306806122705, -8.51366649501448, -19.294868749162735, -18.076647627105974, -11.99278605733968, -18.555512353341225, -5.556803491097664, -11.465338744319189, -16.45628890047794, -11.685260609772065, -12.806183862802985, -11.638555742301932, -17.638192055260106, -9.741586028338315, -10.719706420034427, -6.743106214270863, -25.262992870097236, -12.560916114655933, -6.972068883482962, -12.32849547844433, -17.283913405821625, -6.814442899736563, -17.396676517436656, -8.906029853028732, -13.287638097808738, -9.588847493766265, -17.140418745363707, -13.472734509241763, -33.28752164897864, -7.9399490091451135, -7.37856952045492, -17.447657231687412, -21.324636913779933, -15.375769953862546, -15.364265030615181, -7.156389716943781, -26.717508646654295, -11.092340128161013, -13.704845380761302, -7.814357797723108, -11.235596081558336, -6.1565576592240445, -11.66365278711552, -13.51042572059961, -13.688721203151449, -8.226170067740103, -10.649206034137595, -24.941056603772683, -19.193097590520317, -7.404492505954467, -9.183813938387823, -14.38939678129932, -10.918320920817619, -19.685095188383965, -12.60660907846506, -10.182539024416895, -14.778640074685455, -13.842076336614523, -15.815101925842662, -16.96715327614341, -12.860773541421354, -9.086955394404594, -4.762705246719231], "policy_policy_agent__reward": [5.232589262505938, 5.232589262505938, 7.356620870701696, 7.356620870701696, 4.041704963963427, 4.041704963963427, -0.19802095995824434, -0.19802095995824434, 3.770864202332967, 3.770864202332967, 9.807946704571254, 9.807946704571254, 9.028369721243429, 9.028369721243429, 2.2591919383828567, 2.2591919383828567, 3.0620742845615343, 3.0620742845615343, 10.581471017443508, 10.581471017443508, 8.63288469214219, 8.63288469214219, 3.953729601449112, 3.953729601449112, 3.058443933149712, 3.058443933149712, 17.011858576624764, 17.011858576624764, 0.9974056518164558, 0.9974056518164558, 7.058187580211395, 7.058187580211395, 2.9883128758365367, 2.9883128758365367, 0.7258048993086393, 0.7258048993086393, 5.420471757234026, 5.420471757234026, 1.6364092698249415, 1.6364092698249415, 4.729998680248113, 4.729998680248113, 5.959836217328675, 5.959836217328675, 21.221949449476767, 21.221949449476767, 5.779947555543977, 5.779947555543977, -1.585662760901597, -1.585662760901597, 12.337599925224511, 12.337599925224511, 12.562384923796243, 12.562384923796243, 8.887271566694498, 8.887271566694498, 10.096933215730186, 10.096933215730186, 6.799144824188861, 6.799144824188861, 5.106184280087368, 5.106184280087368, 6.099487004351754, 6.099487004351754, 9.695550776686899, 9.695550776686899, 0.7083846040892218, 0.7083846040892218, 13.37212138703859, 13.37212138703859, 7.0508872746159446, 7.0508872746159446, 5.01126399334842, 5.01126399334842, 3.906087085690691, 3.906087085690691, 2.1337100519421197, 2.1337100519421197, 9.405548915109717, 9.405548915109717, 3.9855352052664554, 3.9855352052664554, 10.466517453764094, 10.466517453764094, 4.188614667313192, 4.188614667313192, 9.766821512002279, 9.766821512002279, 4.4381923183252034, 4.4381923183252034, 6.258255433529428, 6.258255433529428, 6.621012546955525, 6.621012546955525, 8.98864453075508, 8.98864453075508, 3.1349600893321816, 3.1349600893321816, 3.9032998472597087, 3.9032998472597087, 3.46377011381911, 3.46377011381911, 9.966510036721273, 9.966510036721273, 7.12424050778318, 7.12424050778318, 2.9503159368350853, 2.9503159368350853, 4.421078701628205, 4.421078701628205, 2.6258987746304054, 2.6258987746304054, 7.1322269014105615, 7.1322269014105615, 3.6500744067881916, 3.6500744067881916, 6.614369204565218, 6.614369204565218, 21.492084873703572, 21.492084873703572, 5.424005191294148, 5.424005191294148, 3.6932458601157063, 3.6932458601157063, 10.671845041604893, 10.671845041604893, 14.932059684686418, 14.932059684686418, 6.809859529212626, 6.809859529212626, 13.78613212355981, 13.78613212355981, 2.9562524034343816, 2.9562524034343816, 4.04423233448056, 4.04423233448056, 5.374693315650496, 5.374693315650496, 2.100902784032512, 2.100902784032512, 5.668336708262211, 5.668336708262211, 2.9725279553814437, 2.9725279553814437, 8.139079759633475, 8.139079759633475, 5.496582855376187, 5.496582855376187, 12.946530963620628, 12.946530963620628, 14.142173313567612, 14.142173313567612, 2.996661054143361, 2.996661054143361, 5.739012271478413, 5.739012271478413, 2.9055410473197076, 2.9055410473197076, 8.387983244256638, 8.387983244256638, 10.88364632203588, 10.88364632203588, 5.965365832019177, 5.965365832019177, 6.328724940798309, 6.328724940798309, 6.53019642999329, 6.53019642999329, 12.288257262572188, 12.288257262572188, 2.973325765671753, 2.973325765671753, 5.787597461300277, 5.787597461300277, -0.2245354016518391, -0.2245354016518391, 15.30614551051885, 15.30614551051885, 7.401164424273725, 7.401164424273725, 2.1557989698279028, 2.1557989698279028, 4.541840084215058, 4.541840084215058, 6.389981073730978, 6.389981073730978, 3.0633042035627143, 3.0633042035627143, 13.416665086839284, 13.416665086839284, -8.062164784072575, -8.062164784072575, 8.044273985815943, 8.044273985815943, 1.4893002955552537, 1.4893002955552537, 10.046725297950394, 10.046725297950394, 10.003976332871716, 10.003976332871716, 25.415450602229292, 25.415450602229292, 0.6534630633004807, 0.6534630633004807, 1.7700026111808416, 1.7700026111808416, 9.807337302727738, 9.807337302727738, 15.81888899337602, 15.81888899337602, 7.237978843692777, 7.237978843692777, 5.906848804785238, 5.906848804785238, 3.2599845162491112, 3.2599845162491112, 12.475996302912884, 12.475996302912884, 7.069234981890004, 7.069234981890004, 10.8559670058344, 10.8559670058344, 1.820985679040687, 1.820985679040687, 6.284402178612477, 6.284402178612477, 1.553879163813041, 1.553879163813041, 2.180780106202579, 2.180780106202579, 2.51413413190903, 2.51413413190903, 9.53551887859246, 9.53551887859246, 1.626003573782708, 1.626003573782708, 6.4517047105467284, 6.4517047105467284, 11.449644524711669, 11.449644524711669, 14.493708676982791, 14.493708676982791, 4.393682908750071, 4.393682908750071, 5.358776265671855, 5.358776265671855, 9.81631164438173, 9.81631164438173, 5.862483287128452, 5.862483287128452, 11.633958237488491, 11.633958237488491, 7.699456121428513, 7.699456121428513, 5.238319970564511, 5.238319970564511, 5.483334849619616, 5.483334849619616, 8.97853312170344, 8.97853312170344, 9.550131512866072, 9.550131512866072, 4.47345208284627, 4.47345208284627, 8.378032548500558, 8.378032548500558, 4.805009246200626, 4.805009246200626, 1.8179920318073202, 1.8179920318073202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34378074312472495, "mean_inference_ms": 2.2661491972114742, "mean_action_processing_ms": 0.09909537152004536, "mean_env_wait_ms": 0.5950493329362938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 135000, "timesteps_this_iter": 0, "agent_timesteps_total": 405000, "timers": {"sample_time_ms": 13536.621, "sample_throughput": 249.324, "load_time_ms": 0.396, "load_throughput": 8520902.907, "learn_time_ms": 2183.054, "learn_throughput": 1545.999, "update_time_ms": 27.717}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 18.700815773010255, "policy_loss": -0.0032961543707642703, "vf_loss": 18.713013076782225, "vf_explained_var": -0.04734605550765991, "kl": 0.0048228125391725765, "entropy": 0.8900370121002197, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 7.5885669708251955, "policy_loss": -0.003385249199345708, "vf_loss": 7.600496625900268, "vf_explained_var": 0.06657857298851014, "kl": 0.004644872149425573, "entropy": 0.8660545259714126, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 405000, "num_steps_trained": 135000, "num_agent_steps_trained": 405000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5400, "training_iteration": 40, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-56-34", "timestamp": 1706108194, "time_this_iter_s": 13.107658863067627, "time_total_s": 538.9475989341736, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6DD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 538.9475989341736, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.57647058823529, "ram_util_percent": 66.59411764705882, "gpu_util_percent0": 0.04470588235294118, "vram_util_percent0": 0.22307272518382354}}
{"episode_reward_max": 14.339680093542237, "episode_reward_min": -14.999923829156435, "episode_reward_mean": 0.043302293679519904, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.938417685517162, "policy_agent_": -1.05345385298578}, "policy_reward_max": {"policy_adversary_": -3.8870951427090685, "policy_agent_": 18.736278704457472}, "policy_reward_mean": {"policy_adversary_": -12.185649136021233, "policy_agent_": 6.114475714850376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6440147726033478, 5.046737186026374, 0.03739418984964388, 4.45742307503951, 0.32626089541658354, -1.9442753067556202, -4.6707471308381745, 2.5793759955721858, 2.5078102656548746, 7.661378062697372, -8.487425112271046, -3.7500387088429052, 4.03389417251176, 3.0893099837219107, -0.8649249286424462, 0.4251199012929714, -4.27591264996916, 0.7505489262880042, -0.6480906583863537, 5.254030107695606, 7.312361834106897, 1.7465756883875077, 0.6967426535297261, -2.0289810299933664, 3.658471245961441, 0.6217742580830875, 13.306310675645046, 4.355454389674691, 0.43964077288718784, -6.581737237712355, 2.6884406815863837, -9.062451577898429, 0.6820979627424226, -3.435816000695985, 0.30745673117178024, 3.837209021612292, 7.476150846443732, 2.761252846820894, 2.1462018884037577, 3.7249093800119084, -5.972567328963491, 3.180592865860982, 0.4062439425201124, -0.47067756934928484, -6.465726789418979, -4.834056051852619, -4.044326867249431, 1.3881829177442846, 3.1125392831762224, 1.7488042091436626, -9.826025166013128, -0.10030076575215996, -1.639154031628866, -4.1054233203543005, 5.170284468396519, -1.6246016184182062, -4.037340846654617, -14.999923829156435, 5.003610881412641, -2.250946125810138, 0.44333269927968716, 4.236299274024553, -14.23316712174272, 0.4104556908806796, 4.354488652087288, 1.6951328944396424, -5.8063084523297475, 9.352189902266101, 0.5123817009632059, -6.199714378543181, 4.801703507353215, -6.967271276069934, 3.513635090325516, 5.024657411971637, -1.0859340714912946, 2.683130038252077, 0.6444737884213754, -1.8785681145444189, 8.860632308131509, 9.437589171441125, 5.655072037729104, 10.597546140105488, -12.713614379383719, -2.609367820951162, 3.3249770015723983, 14.339680093542237, 0.12160617371103077, 3.3812303506524577, -0.06140930080470042, -2.827613890251362, -8.25799956112931, 11.232228817053675, -5.392306509385726, -7.527233620737578, -3.4523398341196296, -1.2370170439169026, -2.666971391376399, -1.5444642766860097, 3.287877284087653, -0.6283752769323634, 4.715545237628368, 5.249114982177341, -0.1700150732804537, -1.4096307917852229, 3.7143943969104756, -2.6184119935366876, -0.33342522329081853, -0.3608114716212988, 8.559128988225993, -9.588297560208334, -6.556590608242348, -6.851561235694666, -1.3816580175955706, 4.18108130857216, -0.7848162920227659, 2.712515603711702, -2.9585317525828163, 7.776124258678765, -1.6616013280771675, -2.744924674335922, -7.341002509150075, -0.9368053597042253, -10.096397602690553, -0.10647846550537554, -0.43680109390320454, 1.4339289889291078, 0.13586665067258136, 5.021632259380198, -1.2996231031257812, 0.5048388452254287, 2.922046291057817, -7.680929513011614, -9.659616221522597, -3.019567129798038, 8.921338366496153], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.878491583918953, -16.32083315595092, -9.063280960049031, -18.12772146212536, -4.772147453348964, -11.3099595649194, -13.036917763909639, -10.84637748474821, -15.402805401584192, -13.64731191195556, -8.741563243170802, -14.796476631255688, -16.291428171067874, -22.802546012404154, -12.259084549054275, -5.449391026551119, -12.1842947453267, -11.628186951758899, -12.30383496067954, -14.987066867506677, -15.874676322331904, -13.997555459025035, -9.132615118282942, -11.095232464979588, -6.670094932927654, -16.29244197532021, -22.11011937995527, -10.375365710824637, -6.34494104784263, -6.029732506894211, -11.825882725018806, -11.757452091421701, -20.909775317915496, -8.815106780019372, -15.61239023942642, -11.357974908102541, -18.651365396900253, -12.846230309566042, -8.936292659060447, -9.154680542132418, -19.38680224456634, -11.046650743038937, -7.123182606036395, -5.195029079283052, -9.662519540137652, -13.619111760205643, -7.534462668130705, -7.9189808222666125, -14.834479300934662, -10.13186372104782, -16.097714933923065, -10.439312064295668, -9.955590789768916, -13.858881376276356, -13.209384300956325, -5.549953210626139, -9.668086452917043, -15.46022864210827, -13.186333401364482, -11.111848204912333, -10.234899983923352, -8.948809357639336, -15.590636273089327, -8.691507546296409, -15.661552110328172, -8.08565088654778, -10.653314803938944, -15.484384831820906, -16.671402742666913, -14.43653275297598, -14.77618626865199, -12.726926254347232, -15.936637306212837, -20.979069459053566, -8.252102844088473, -10.210315155074014, -9.674114952637373, -5.679418961041529, -23.938417685517162, -18.5025999906732, -15.378570754002194, -20.324631242934903, -15.794532226441019, -7.1326876924505935, -15.621101442445452, -23.132877315372703, -13.909110492220957, -7.8026495443453525, -8.93221429649966, -9.486516503391805, -7.862519379111646, -22.121308859534814, -7.912264468499583, -10.392296929895812, -7.7249213476059095, -10.739341406787473, -4.843148832482034, -6.209213893664313, -19.11685001847366, -11.590366529647818, -12.322998499467039, -18.776745956859916, -8.413252076896327, -14.046763364435293, -13.358395235220177, -11.585932955525534, -7.31092735586293, -8.348235531635671, -14.7819131085615, -17.846888176146038, -4.911882578676377, -4.7446535297231085, -9.37550453242029, -10.202453425704727, -11.61386941044661, -19.17219056545318, -6.923622314110292, -14.177192436180608, -4.951739645992856, -3.8870951427090685, -8.178765857066669, -19.119823659422963, -10.07885239786667, -4.865140871190154, -6.7277421811796065, -18.017396604489747, -18.89134132442951, -16.5080007093649, -12.391484287285762, -10.568550697309364, -7.943339043634598, -9.525568316697402, -14.061490876914363, -10.791683057417005, -18.849532642208167], "policy_policy_agent__reward": [6.6172384056578055, 6.6172384056578055, 10.683785170988648, 10.683785170988648, 4.550337574949337, 4.550337574949337, 11.292572268582433, 11.292572268582433, 2.5492041743827736, 2.5492041743827736, 4.682842129081889, 4.682842129081889, 4.183085316535732, 4.183085316535732, 6.712876740160197, 6.712876740160197, 8.955307833619532, 8.955307833619532, 10.654344987326468, 10.654344987326468, 0.1270690654498734, 0.1270690654498734, 5.52321896120639, 5.52321896120639, 10.162661171789818, 10.162661171789818, 12.945927998063034, 12.945927998063034, 5.697079810205913, 5.697079810205913, 2.9372554639220443, 2.9372554639220443, 3.9541910476787665, 3.9541910476787665, 6.189367939023451, 6.189367939023451, 5.8278721511465905, 5.8278721511465905, 10.120548487601143, 10.120548487601143, 11.593519078219396, 11.593519078219396, 7.872065573706274, 7.872065573706274, 4.914678885906334, 4.914678885906334, 4.533125717493111, 4.533125717493111, 5.164283089444547, 5.164283089444547, 8.45710811670165, 8.45710811670165, 17.70821502780016, 17.70821502780016, 7.365410050249665, 7.365410050249665, 3.392290910364908, 3.392290910364908, -0.2760023654090715, -0.2760023654090715, 7.257161703302594, 7.257161703302594, 1.3475002567616392, 1.3475002567616392, 10.795936640328959, 10.795936640328959, 2.689645389661692, 2.689645389661692, 7.959923485299099, 7.959923485299099, 7.597591964857417, 7.597591964857417, 13.063758121671995, 13.063758121671995, 7.803741578193468, 7.803741578193468, 5.541247273732103, 5.541247273732103, 6.439794961072164, 6.439794961072164, 6.707117457801426, 6.707117457801426, 7.11362180444996, 7.11362180444996, 3.764713274278254, 3.764713274278254, 2.362175754966883, 2.362175754966883, 1.5983963753593342, 1.5983963753593342, 4.39252785417651, 4.39252785417651, 1.7450679004406373, 1.7450679004406373, 4.653581870005449, 4.653581870005449, 8.973509292055448, 8.973509292055448, 5.94033396509574, 5.94033396509574, 3.135844883954973, 3.135844883954973, 5.169505649271756, 5.169505649271756, 4.158218379070023, 4.158218379070023, 4.876729027961027, 4.876729027961027, 9.189834384676422, 9.189834384676422, 1.9626757961039685, 1.9626757961039685, 2.8153728031312126, 2.8153728031312126, 0.2301524064759185, 0.2301524064759185, 9.094972141388563, 9.094972141388563, 4.430451039551102, 4.430451039551102, 5.339116341601519, 5.339116341601519, 6.592554315831943, 6.592554315831943, 0.6787345756732986, 0.6787345756732986, 4.550981618588542, 4.550981618588542, 10.00802038120773, 10.00802038120773, 4.890391890493714, 4.890391890493714, 2.423503175804597, 2.423503175804597, 12.418287367043503, 12.418287367043503, 8.591892221815055, 8.591892221815055, 4.118409187216398, 4.118409187216398, 9.7889448880026, 9.7889448880026, 2.87982748913865, 2.87982748913865, 9.725136198269178, 9.725136198269178, 13.0018634355126, 13.0018634355126, 3.583084386298588, 3.583084386298588, 6.446722596663045, 6.446722596663045, 5.159294370529376, 5.159294370529376, 1.9004254232485556, 1.9004254232485556, 16.399524996824336, 16.399524996824336, 13.970094581057165, 13.970094581057165, 10.51682139586565, 10.51682139586565, 15.461088691520192, 15.461088691520192, 1.5404589235286485, 1.5404589235286485, 2.2616599357497176, 2.2616599357497176, 9.473039222008923, 9.473039222008923, 18.736278704457472, 18.736278704457472, 7.015358332965995, 7.015358332965995, 5.591939947498905, 5.591939947498905, 4.43540249784748, 4.43540249784748, 3.3294513065702214, 3.3294513065702214, -0.19774009100883222, -0.19774009100883222, 16.676768838294244, 16.676768838294244, 1.259978979556929, 1.259978979556929, 1.4325316545791167, 1.4325316545791167, 2.136290756743139, 2.136290756743139, 4.751162181435286, 4.751162181435286, 1.0880887205528176, 1.0880887205528176, 2.332374808489152, 2.332374808489152, 11.202363651280656, 11.202363651280656, 5.4809956263577275, 5.4809956263577275, 8.519271868547703, 8.519271868547703, 12.012930469518624, 12.012930469518624, 4.121618501807935, 4.121618501807935, 6.3185662863250345, 6.3185662863250345, 8.536394816065325, 8.536394816065325, 4.483760480994426, 4.483760480994426, 3.488751066286056, 3.488751066286056, 3.993712030007184, 3.993712030007184, 11.670521048393747, 11.670521048393747, 4.129295307968851, 4.129295307968851, -0.8223540147829844, -0.8223540147829844, -1.05345385298578, -1.05345385298578, 3.996923257412361, 3.996923257412361, 7.1917673671384446, 7.1917673671384446, 5.414526559211919, 5.414526559211919, 10.94235308458244, 10.94235308458244, 1.9825452807637378, 1.9825452807637378, 10.976658347429689, 10.976658347429689, 1.6450691589578448, 1.6450691589578448, 0.5710852341865728, 0.5710852341865728, 0.41888167395829656, 0.41888167395829656, 9.091509149859373, 9.091509149859373, -0.008772602411940306, -0.008772602411940306, 2.379331202842389, 2.379331202842389, 3.145470543638201, 3.145470543638201, 9.725662796709427, 9.725662796709427, 9.513603987551043, 9.513603987551043, 10.764816484372547, 10.764816484372547, 5.545930592079988, 5.545930592079988, 5.536694771267395, 5.536694771267395, 5.432692667346206, 5.432692667346206, 0.9223194018428946, 0.9223194018428946, 2.2009373276958812, 2.2009373276958812, 3.886057963809483, 3.886057963809483, 13.885435504352158, 13.885435504352158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3433035662276494, "mean_inference_ms": 2.2626020137471725, "mean_action_processing_ms": 0.09899898538259785, "mean_env_wait_ms": 0.5941590138536917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 138375, "timesteps_this_iter": 0, "agent_timesteps_total": 415125, "timers": {"sample_time_ms": 13320.52, "sample_throughput": 253.368, "load_time_ms": 0.496, "load_throughput": 6807297.908, "learn_time_ms": 2158.494, "learn_throughput": 1563.59, "update_time_ms": 27.816}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 14.759627532958984, "policy_loss": -0.003993837593588978, "vf_loss": 14.772389698028565, "vf_explained_var": -0.04498159885406494, "kl": 0.0016944705500032131, "entropy": 0.876879072189331, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 5.438996887207031, "policy_loss": -0.007799191027879715, "vf_loss": 5.455310535430908, "vf_explained_var": 0.10031510889530182, "kl": 0.006932512170078886, "entropy": 0.8601211667060852, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 138375, "num_agent_steps_sampled": 415125, "num_steps_trained": 138375, "num_agent_steps_trained": 415125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5535, "training_iteration": 41, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-56-47", "timestamp": 1706108207, "time_this_iter_s": 12.712758302688599, "time_total_s": 551.6603572368622, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF24C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 551.6603572368622, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.60625, "ram_util_percent": 66.69999999999999, "gpu_util_percent0": 0.04625, "vram_util_percent0": 0.2192230224609375}}
{"episode_reward_max": 15.526600222383054, "episode_reward_min": -13.821049459819578, "episode_reward_mean": 0.43356237208498327, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.084551148645858, "policy_agent_": -1.8434968745751734}, "policy_reward_max": {"policy_adversary_": -5.704487054610201, "policy_agent_": 21.30557568551445}, "policy_reward_mean": {"policy_adversary_": -12.387555419156042, "policy_agent_": 6.410558895620512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.082360949050877, -1.8785388526460627, -0.6401370634310765, 6.935601074478561, 1.9376860083109329, 5.018149038573651, 4.932209488477064, 7.2684255297855795, 5.0902875623277195, 5.83107104258278, -0.5917059492547632, -3.4029608499104262, 1.3687300318944167, 4.630619571988101, 1.963468995576428, -4.4751613163579815, -1.8826079655924906, -11.90900086249279, 2.6211793148198432, -5.491330537423631, -3.796777205697075, 6.80018242327849, -4.161532606381268, -3.5743389499802865, -7.306227477751025, 2.360055028464908, 4.98512734286091, 3.562888766276967, -3.4458813079504043, 3.5506494317894752, -4.2025887741278085, 3.5396271356664952, -3.932176815462253, -9.59321461041865, -4.694454491505406, -0.7579329400601759, -2.5031062378361817, 2.772115639673634, 9.720544287684284, 0.6379220262335625, -3.557147731301633, 7.866789598138415, 5.186996213657856, -5.399408004002526, -0.7990010605593276, 0.07542722947693825, -7.1223439620473465, 2.6971260887224915, -3.702086264943431, -0.8519875300199239, -7.292432096040923, 3.612018854498312, 3.031317803050113, 1.034152851090877, 1.9498168128144229, -2.825281685901224, -2.4354593638419075, 7.1028866924306175, 9.544992554706152, 2.579539133750097, 1.0518269016121515, -3.499594331751811, 4.280229302391413, -0.10652705176949094, -2.740392883592093, 1.2244701028689888, -3.951567808984592, 2.3866906617338786, -7.68405248250256, 0.5674385648949796, 9.49962813712326, -1.2702198281126413, -0.958594358615596, -3.498209559883608, 8.77910150279515, 5.605924332939379, -0.05186846514825941, -13.821049459819578, 1.129870491929088, -0.90379605814642, -2.8214334712976337, -4.830983204385885, 12.162157925350842, -2.5197608948199495, 11.439431891176262, 1.235050175084582, 3.566223686794123, -1.733477008792275, 0.3318839171918967, -0.21358716246877799, 14.620472580254038, 15.526600222383054, -1.3417010016005704, 4.102459642656251, 3.050952383655435, 2.6858351787864105, 3.565063306635674, -12.908913317373553, 6.310494757783315, -3.9214835085066966, -0.8828165270481321, 6.492892873142532, -8.123209906803526, -1.7577378648039197, 1.364856352638777, 2.2212367988018986, -1.8598415833060233, -1.1585933168701485, 3.64467668752928, -2.548163329869795, 0.6094933284928187, 2.6791679246038678, -1.0498085539050541, -13.36263528983815, -5.197899617276189, -1.606021289308398, 3.808585212438831, 3.5569183265858255, 6.619350658262257, 2.9224324249243523, -4.790619260436934, -5.52812723076111, 4.294048787799618, 4.605348229050732, -7.244703050634682, 3.5352346081541692, 2.753097594845905, 1.5061338892698748, 1.0883589357176953, 3.905922963307521, 0.2872950512740369, 12.447983736655443, -3.0555058411104357, 1.5862145348428496, -7.477659944452457], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.411020285150075, -16.283869112220664, -8.759966502944225, -11.420857858075184, -7.988069226700055, -11.842600716492237, -10.574989647043992, -13.793184736198256, -19.288984899897834, -15.26105304800189, -17.443207164902585, -6.4640723152582815, -10.46992768668774, -10.43657492678432, -10.3681744644386, -9.963563643241844, -7.8383538118028495, -8.22200711334244, -9.669858194200684, -6.952629348761252, -21.63354203463258, -16.208244215751925, -15.23777053927982, -10.666587794037108, -10.277830256248874, -10.119126681831291, -12.430498181410343, -15.750841225896542, -6.972502768870428, -9.892202046208494, -13.759725912554504, -15.189604571943553, -12.010236611297461, -10.011384018247352, -8.553631323678559, -13.223087574764762, -16.0113037597504, -9.823375167752218, -15.924275369830578, -8.010327835058071, -11.059049771191729, -18.297856791484215, -11.820144709959887, -6.528240119325751, -8.572501253878952, -9.51163796875047, -12.96089117642667, -11.427669680648437, -9.736741548499175, -15.617215686874944, -13.793183591783468, -17.781551215403677, -11.84714096127024, -10.627306401332735, -19.173226526854187, -6.327411008570372, -17.682083849806123, -14.790871304164243, -17.783117983621427, -17.0651199941319, -8.23816558824256, -11.362691769572793, -11.37662450054384, -12.02575528838349, -6.109210257210699, -8.891822252035821, -8.455348260542616, -11.63657537756079, -20.150636963635673, -10.818553015737313, -21.97534150157452, -15.904699712971183, -21.041101175167295, -7.9678605618247085, -14.261129266262923, -16.92444285751027, -7.483547764198314, -12.88464016033715, -15.023105448211906, -17.49806615156813, -12.545041249367209, -7.37733197600739, -19.182697599248833, -19.526010421929804, -16.341698521260053, -8.139546912163135, -9.01497257728753, -8.156394124959553, -6.788333810177749, -9.757951553522007, -20.732332176352, -27.084551148645858, -10.978932959835538, -12.314084907491319, -13.371827570784253, -8.632076398855473, -11.824363866205658, -22.81147312121973, -17.69437150493596, -8.339265236253745, -7.47544859190887, -14.874846382296312, -12.02980249877574, -7.653247132329135, -5.862726776522659, -10.885142845267412, -8.011444164156314, -9.609359699206115, -12.523938297865891, -12.042936385827987, -12.648320276205542, -7.602772622469585, -5.704487054610201, -10.13769882798183, -6.692818375255577, -9.896597718544424, -18.38083281628516, -16.049190057349772, -18.676490900883785, -9.26391372084821, -19.016756355671586, -21.443992974336958, -9.73194523523751, -12.716375302845693, -11.172289321453428, -18.403768050374676, -12.802882729525695, -10.17640595818098, -10.322715704803137, -7.588027005114862, -5.878659115217505, -19.735591092080632, -11.72359913552277, -6.519833621299185, -6.8605251950471375], "policy_policy_agent__reward": [3.1643296680496027, 3.1643296680496027, 7.202665129787299, 7.202665129787299, 4.059914719756573, 4.059914719756573, 9.178229466276868, 9.178229466276868, 4.962877617505493, 4.962877617505493, 8.430374877532943, 8.430374877532943, 7.753599567760528, 7.753599567760528, 10.530805132991915, 10.530805132991915, 12.189636231112775, 12.189636231112775, 10.54606204529233, 10.54606204529233, 8.425750607823913, 8.425750607823913, 1.5305557326739274, 1.5305557326739274, 5.9193288592910775, 5.9193288592910775, 7.533597249386212, 7.533597249386212, 6.165821730007513, 6.165821730007513, 2.744201163441929, 2.744201163441929, 2.9778729231051786, 2.9778729231051786, -1.8434968745751734, -1.8434968745751734, 6.145518754510263, 6.145518754510263, 0.7306494056688093, 0.7306494056688093, 8.918382414467759, 8.918382414467759, 11.504213319515204, 11.504213319515204, 5.538118966449276, 5.538118966449276, 3.546124422028408, 3.546124422028408, 1.4858013892489228, 1.4858013892489228, 6.2395908551481, 6.2395908551481, 8.707812762135628, 8.707812762135628, 9.656864996086751, 9.656864996086751, 1.7633107304600115, 1.7633107304600115, 6.721425738998986, 6.721425738998986, 4.7785685692133475, 4.7785685692133475, 9.364615853805024, 9.364615853805024, 4.039029897917609, 4.039029897917609, 0.20908470391434758, 0.20908470391434758, 1.929588416086577, 1.929588416086577, 6.232577317352293, 6.232577317352293, 6.75409876095711, 6.75409876095711, 6.297745403712928, 6.297745403712928, 12.822409828757431, 12.822409828757431, 4.324124930645817, 4.324124930645817, 3.7509510199450466, 3.7509510199450466, 13.08232319481131, 13.08232319481131, 8.503570461808874, 8.503570461808874, 0.5644160576616114, 0.5644160576616114, 3.8867500966598105, 3.8867500966598105, 4.793532599113704, 4.793532599113704, 2.919273607189666, 2.919273607189666, 7.062397884685467, 7.062397884685467, 3.0173276417778725, 3.0173276417778725, 7.382614078427512, 7.382614078427512, 3.250375747871273, 3.250375747871273, 10.696785034950992, 10.696785034950992, 7.4392293821601765, 7.4392293821601765, 5.830729626211801, 5.830729626211801, 10.561521669834303, 10.561521669834303, 1.7510646613345726, 1.7510646613345726, 7.623312242982107, 7.623312242982107, 10.946878998297427, 10.946878998297427, 13.66405526916379, 13.66405526916379, 9.822329563941, 9.822329563941, 4.6449962449273565, 4.6449962449273565, 3.931548718910489, 3.931548718910489, 7.828426901467628, 7.828426901467628, 5.959614118307001, 5.959614118307001, 1.6844086868093027, 1.6844086868093027, 5.0581461774524055, 5.0581461774524055, 2.2518902257790123, 2.2518902257790123, 7.011633019647336, 7.011633019647336, 6.233292240566559, 6.233292240566559, 5.692995790316149, 5.692995790316149, 15.737484819348884, 15.737484819348884, 7.3172399424292704, 7.3172399424292704, 10.041253408275846, 10.041253408275846, 2.2348255009705515, 2.2348255009705515, 11.520115384529038, 11.520115384529038, 11.265183595224828, 11.265183595224828, 3.715839649525028, 3.715839649525028, -0.4682046497412127, -0.4682046497412127, 8.0764879700705, 8.0764879700705, 8.297135046710851, 8.297135046710851, 4.861803889034788, 4.861803889034788, 1.273174385810754, 1.273174385810754, 15.672427762299842, 15.672427762299842, 8.503124763554927, 8.503124763554927, 13.890565206218158, 13.890565206218158, 4.687298543623859, 4.687298543623859, 6.290598132040824, 6.290598132040824, 3.2114585580836383, 3.2114585580836383, 3.560108863684822, 3.560108863684822, 4.772182195526615, 4.772182195526615, 17.67640237830302, 17.67640237830302, 21.30557568551445, 21.30557568551445, 4.818615979117483, 4.818615979117483, 8.208272275073787, 8.208272275073787, 8.211389977219845, 8.211389977219845, 5.6589557888209425, 5.6589557888209425, 7.694713586420666, 7.694713586420666, 4.95127990192309, 4.95127990192309, 12.002433131359634, 12.002433131359634, 2.2088908638735236, 2.2088908638735236, 3.296316032430369, 3.296316032430369, 10.683869627719417, 10.683869627719417, 1.9532962959861073, 1.9532962959861073, 2.947754633762607, 2.947754633762607, 3.6137915645807173, 3.6137915645807173, 6.553189822034654, 6.553189822034654, 3.0758012904251455, 3.0758012904251455, 4.225383191167983, 4.225383191167983, 8.084307492697585, 8.084307492697585, 4.7473865279790965, 4.7473865279790965, 6.628906802349179, 6.628906802349179, 5.140970273536727, 5.140970273536727, 2.3273392503525727, 2.3273392503525727, -1.6124682309281553, -1.6124682309281553, 0.7474593789896946, 0.7474593789896946, 4.14528821461801, 4.14528821461801, 11.09470901436199, 11.09470901436199, 9.8030541919678, 9.8030541919678, 12.647920779573015, 12.647920779573015, 6.093173072886286, 6.093173072886286, 7.1130685476173285, 7.1130685476173285, 7.957932871787921, 7.957932871787921, 7.012997011518566, 7.012997011518566, 8.66086176594821, 8.66086176594821, 1.9637931354093738, 1.9637931354093738, 10.969501329264425, 10.969501329264425, 7.777990162185802, 7.777990162185802, 5.841269923725427, 5.841269923725427, 5.705537320260419, 5.705537320260419, 5.746974984211192, 5.746974984211192, 3.082977083245771, 3.082977083245771, 16.09178741436804, 16.09178741436804, 4.334046647206166, 4.334046647206166, 4.053024078071017, 4.053024078071017, -0.30856737470266243, -0.30856737470266243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34411869512323373, "mean_inference_ms": 2.267603317208645, "mean_action_processing_ms": 0.09922199231641703, "mean_env_wait_ms": 0.5953666657760835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 141750, "timesteps_this_iter": 0, "agent_timesteps_total": 425250, "timers": {"sample_time_ms": 13331.178, "sample_throughput": 253.166, "load_time_ms": 0.396, "load_throughput": 8523468.208, "learn_time_ms": 2147.281, "learn_throughput": 1571.755, "update_time_ms": 27.922}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 16.573868370056154, "policy_loss": 0.008148600114509463, "vf_loss": 16.574439239501952, "vf_explained_var": -0.09940032958984375, "kl": 0.004368925571811011, "entropy": 0.8719027698040008, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.167553067207336, "policy_loss": -0.015933342344214906, "vf_loss": 6.192225432395935, "vf_explained_var": 0.07337771952152253, "kl": 0.005850145461174716, "entropy": 0.8812020868062973, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 141750, "num_agent_steps_sampled": 425250, "num_steps_trained": 141750, "num_agent_steps_trained": 425250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5670, "training_iteration": 42, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-57-02", "timestamp": 1706108222, "time_this_iter_s": 14.38622784614563, "time_total_s": 566.0465850830078, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08E48160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 566.0465850830078, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 40.28421052631579, "ram_util_percent": 67.15789473684212, "gpu_util_percent0": 0.15578947368421053, "vram_util_percent0": 0.23199784128289475}}
{"episode_reward_max": 16.474155831955756, "episode_reward_min": -18.055769258673955, "episode_reward_mean": 0.5367944976046658, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.95536092818898, "policy_agent_": -3.8758089033211602}, "policy_reward_max": {"policy_adversary_": -3.433616490681553, "policy_agent_": 20.342144318791938}, "policy_reward_mean": {"policy_adversary_": -12.89744587359855, "policy_agent_": 6.717120185601606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.264313820963583, 5.622815521578387, -1.1184330460857295, 0.9799519461683233, 0.5676400222557253, 3.910019070634353, 0.3606987176797825, 1.7599190547576093, 2.720348944839094, 7.727028452413121, -11.870419280773287, -1.1874739301275905, -9.214541772156485, -1.1447915909150108, 0.4898199354591961, -3.0427080398475517, -9.619122412433951, 9.012094930795822, 2.141540179447587, -3.3252236481589863, 3.428386756391219, 0.6086998170241544, -10.78418702231806, 3.0475621749548014, -0.9003686300176503, 7.842063199029907, 5.919040045786928, 10.94832122317093, 4.9400890530118495, 7.7921318041620395, 2.699114882536515, -1.969061995902256, -3.823788575450961, 7.727389354800889, 3.4920749415675583, -1.194008347826217, 0.7775004465356423, -8.328246729229686, 3.5956841104194686, 0.7501874077626619, 6.9840221544705505, 3.8639232287714598, 8.008977510486835, 0.15192223595183785, 7.949285853412262, 7.72716103384226, -2.7284610975888333, 4.535166033690825, -10.850892227089394, 5.080449791832574, 1.6340159648859576, 10.128523668186519, -4.440425333449413, 1.9828032660196537, 2.493889106514562, 11.068030216713037, -8.152701679142016, -3.601998662965295, 4.701746711380768, -0.30044337485903183, -13.211432570935873, -12.129374015143565, -0.29585655039584624, 1.3744753966231364, 9.323782250498027, -2.6556514481724935, 16.474155831955756, -2.670351391495706, -6.614854721320904, 0.25711203594134924, 1.9992650969880414, 8.25954295049772, 1.7208002820316763, -3.4617064284607215, 6.128900194988443, -1.0982376645224345, -9.138346467421707, -2.4444126461679754, 9.509344964857073, -1.0825247188326474, 4.256132781612699, -0.05697713284498085, 1.624568240285015, 5.630631708818322, 3.597107118330835, -4.385595053021404, -4.188121690565762, -0.6557785753050642, -4.97288590820926, -4.152034631164755, 2.6451441789348857, 5.459336952781211, 1.2830554285253195, -9.637313596395138, 0.6035119468931665, 3.1972993142742587, 4.213269704148731, -0.43013344944056325, 0.773531801159937, -2.254762734966551, 0.818480363848656, -5.251060417024841, -5.383669960600959, 4.605302230402925, 3.229356033727597, -0.07665434875847443, 4.904260959699847, 6.591757452501665, -3.2038301529264324, 2.065332894102335, -2.856266404495071, -2.532785418205967, 0.33934353184141824, -1.764598741860059, -3.5979550503066164, 5.862014968776571, -7.692869884935746, 9.190337086750759, -5.809087315688423, -0.4193735334070625, -18.055769258673955, 6.617257093022938, 3.29899060753758, -0.06341178748002119, -7.923314635894908, 0.8761130044322091, -0.2641666170459637, -6.692182581578002, 2.0021302568329014, 4.869724307944032, -4.8787799769851405, 1.839358711849965, 0.5427814020383152, 8.675515799962463, 8.501932219821413], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.9061139351907315, -10.099525735345182, -16.085435533642045, -6.128244561654894, -6.939920435342458, -10.664700269807229, -13.772287476839063, -8.81802827130728, -18.89009540816378, -12.996884275038314, -15.840786602777605, -6.37729976237105, -14.330156790795627, -19.540092699841093, -7.135676329382691, -8.860550927743718, -14.544434548793564, -19.402570807147406, -15.963354617339311, -8.545765067716363, -18.56439258769048, -9.620745843421679, -11.444256796926512, -12.306438755326631, -15.218565278718582, -15.803408333183459, -13.16413434098026, -19.57198970941274, -12.204362207649826, -28.95536092818898, -11.773011714962287, -7.159604496744614, -15.967453257176379, -18.124396867108118, -10.485156050432906, -15.992704817818451, -11.873165447129699, -9.595801961636452, -8.31781747514263, -9.535703837912502, -20.684044913571498, -10.978570759975531, -14.115368044311197, -18.365781389155494, -15.975735805988188, -19.43319249065377, -3.433616490681553, -12.540856586942063, -19.401362899259734, -13.030752344920177, -10.708879966712251, -22.068569005214172, -12.046159609729784, -10.319553884994546, -13.040748242195, -15.65750216882479, -6.445175805222205, -8.169543135217989, -14.248317271159316, -9.852908730286398, -10.89488328370476, -17.278990909909542, -10.322974033283558, -6.59505925103069, -21.153618640564968, -13.493275095302593, -24.210132805628124, -6.344633188222378, -20.89365312454217, -10.1848318722759, -12.255830502256257, -19.872797945244336, -23.743862419021916, -14.74032679885195, -17.65650786710091, -4.58765426649789, -11.71454655121362, -6.904898489493457, -19.184182283522066, -9.962376525672337, -11.53239237319409, -4.357310614568311, -8.997597831760032, -15.566822448018709, -9.915639265562906, -6.16689901429818, -8.323257984574559, -8.496567045982479, -12.251236772390731, -6.2426294857640166, -10.948008564982958, -13.856991834164834, -8.252351569962567, -18.537215757405235, -23.83854046855709, -14.262617636901712, -15.161081557915526, -9.727483480447384, -13.136374711812815, -15.038819522204578, -12.15772680485822, -13.049777759235083, -11.340912026592497, -11.162645648829796, -9.012481573562706, -12.480060922494104, -15.97294099037393, -13.934060732458631, -12.716745565027937, -11.695344324186259, -7.358867137180914, -9.166696771022101, -18.51008016761971, -10.877342085949392, -14.264676309615057, -11.844338441739316, -12.534518359363316, -17.709804820119007, -7.440427779243768, -7.270320100414632, -10.304151452031638, -15.07631373601878, -9.437659117162926, -13.3046963162205, -14.416100842563322, -7.7529863233016165, -14.021080985156338, -14.823810405192502, -9.501288987495588, -14.089827968152358, -11.147263301728884, -12.15098825848941, -15.75565334603546, -13.257164368341362, -20.974531105400462], "policy_policy_agent__reward": [0.32090005711357367, 0.32090005711357367, 7.861170628461784, 7.861170628461784, 7.483501243778155, 7.483501243778155, 3.554098253911609, 3.554098253911609, 3.7537802287990916, 3.7537802287990916, 7.287359670220791, 7.287359670220791, 7.066493097259425, 7.066493097259425, 5.288973663032444, 5.288973663032444, 10.805222176501436, 10.805222176501436, 10.36195636372572, 10.36195636372572, 1.9851836610021596, 1.9851836610021596, 2.5949129161217304, 2.5949129161217304, 2.5578075093195745, 2.5578075093195745, 9.19765055446304, 9.19765055446304, 3.8127481324209436, 3.8127481324209436, 2.908921443948084, 2.908921443948084, 2.462656068179806, 2.462656068179806, 14.207332868971614, 14.207332868971614, 9.052447398393449, 9.052447398393449, 2.6102707097786864, 2.6102707097786864, 10.996389672040847, 10.996389672040847, 5.1147228302229175, 5.1147228302229175, 0.33003488730422414, 0.33003488730422414, 7.677000465140717, 7.677000465140717, 7.159098324350462, 7.159098324350462, 11.822735766106685, 11.822735766106685, 9.541587193383588, 9.541587193383588, 15.26015546629184, 15.26015546629184, 8.572225630330838, 8.572225630330838, 18.37374636617551, 18.37374636617551, 7.236063298749401, 7.236063298749401, 2.595271250421178, 2.595271250421178, 6.071832340862708, 6.071832340862708, 12.925893110954497, 12.925893110954497, 6.988615496000233, 6.988615496000233, 7.399348234996117, 7.399348234996117, 6.3253329468326704, 6.3253329468326704, 0.6337776162033844, 0.6337776162033844, 5.956750792781048, 5.956750792781048, 5.1429456228375825, 5.1429456228375825, 13.834033534021021, 13.834033534021021, 7.421246994373495, 7.421246994373495, 11.062172777399015, 11.062172777399015, 9.258851812553667, 9.258851812553667, 11.962510829700225, 11.962510829700225, 13.580176762248021, 13.580176762248021, 0.3525776965463601, 0.3525776965463601, 8.538011310316442, 8.538011310316442, 4.275235336085171, 4.275235336085171, 9.055601068376378, 9.055601068376378, 6.171447965799105, 6.171447965799105, 16.09854633670035, 16.09854633670035, 3.8028671381401833, 3.8028671381401833, 6.1511785755071, 6.1511785755071, 7.76731867435478, 7.76731867435478, 13.362766192768913, 13.362766192768913, -0.8537629369599051, -0.8537629369599051, 2.2837722361263473, 2.2837722361263473, 9.475031991270043, 9.475031991270043, 4.776232677713684, 4.776232677713684, -1.158274643615557, -1.158274643615557, 2.5748084473829875, 2.5748084473829875, 5.013558741443854, 5.013558741443854, 3.984767323826913, 3.984767323826913, 15.238700445531501, 15.238700445531501, 5.418811823565048, 5.418811823565048, 20.342144318791938, 20.342144318791938, 1.8371408983633373, 1.8371408983633373, 7.139399201610635, 7.139399201610635, 5.2209719541086255, 5.2209719541086255, 7.127547799622149, 7.127547799622149, 14.066170447871029, 14.066170447871029, 12.732331350526799, 12.732331350526799, 5.639310185195613, 5.639310185195613, 11.892704031044673, 11.892704031044673, 1.744708300987728, 1.744708300987728, 1.2881000418959618, 1.2881000418959618, 2.230242921662741, 2.230242921662741, 14.346763624189576, 14.346763624189576, 4.4399259034198435, 4.4399259034198435, 7.894262577403395, 7.894262577403395, 2.1501667408616654, 2.1501667408616654, 5.3110830360225245, 5.3110830360225245, 10.598727078418511, 10.598727078418511, 6.756373191946869, 6.756373191946869, 0.8906519806383877, 0.8906519806383877, 2.0675681470043976, 2.0675681470043976, 3.9203942353387067, 3.9203942353387067, 3.6391754320907346, 3.6391754320907346, 1.0452974272996312, 1.0452974272996312, 6.796576371958924, 6.796576371958924, 9.658164393473019, 9.658164393473019, 4.767703499243944, 4.767703499243944, 4.449951080505049, 4.449951080505049, 12.221026207725126, 12.221026207725126, 8.729958475587983, 8.729958475587983, 9.687175631032126, 9.687175631032126, 4.6486750155034136, 4.6486750155034136, 6.954953256486377, 6.954953256486377, 6.392028393619011, 6.392028393619011, 6.48810358435344, 6.48810358435344, 3.899358671105117, 3.899358671105117, 2.9786210329957683, 2.9786210329957683, 7.883973939616361, 7.883973939616361, 6.12091880364515, 6.12091880364515, 6.201703286867816, 6.201703286867816, 10.43860097503689, 10.43860097503689, 10.262909092480147, 10.262909092480147, 4.7564577060507505, 4.7564577060507505, 6.8803386091443, 6.8803386091443, 2.2513003663429223, 2.2513003663429223, 3.316955676408068, 3.316955676408068, 9.424711849730564, 9.424711849730564, 4.5563716720446665, 4.5563716720446665, 5.333360629654219, 5.333360629654219, 8.853176705257944, 8.853176705257944, 2.4208242372137816, 2.4208242372137816, 13.450070953434881, 13.450070953434881, 0.8156702317776738, 0.8156702317776738, 3.4254732835037847, 3.4254732835037847, -3.8758089033211602, -3.8758089033211602, 10.84678541452086, 10.84678541452086, 6.368324862350252, 6.368324862350252, 6.620642264370241, 6.620642264370241, 3.2463931033342064, 3.2463931033342064, 4.314549663866912, 4.314549663866912, 6.878457184055185, 6.878457184055185, 4.065813911807248, 4.065813911807248, 5.751709622164246, 5.751709622164246, 9.479776138048196, 9.479776138048196, 3.1342416623718736, 3.1342416623718736, 6.995173485169685, 6.995173485169685, 8.149217374036889, 8.149217374036889, 10.966340084151913, 10.966340084151913, 14.738231662610938, 14.738231662610938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34355816789937454, "mean_inference_ms": 2.2622350984921593, "mean_action_processing_ms": 0.09888785854003533, "mean_env_wait_ms": 0.594372205053367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 145125, "timesteps_this_iter": 0, "agent_timesteps_total": 435375, "timers": {"sample_time_ms": 13208.328, "sample_throughput": 255.521, "load_time_ms": 0.396, "load_throughput": 8523468.208, "learn_time_ms": 2138.096, "learn_throughput": 1578.508, "update_time_ms": 27.221}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 16.473378944396973, "policy_loss": -0.007098020659759641, "vf_loss": 16.48920726776123, "vf_explained_var": -0.03888790607452393, "kl": 0.005559892265360222, "entropy": 0.8730483949184418, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.050022745132447, "policy_loss": -8.336175233125686e-06, "vf_loss": 6.0586319208145145, "vf_explained_var": 0.12489495575428008, "kl": 0.005797969952384102, "entropy": 0.867332461476326, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 145125, "num_agent_steps_sampled": 435375, "num_steps_trained": 145125, "num_agent_steps_trained": 435375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5805, "training_iteration": 43, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-57-14", "timestamp": 1706108234, "time_this_iter_s": 12.325085639953613, "time_total_s": 578.3716707229614, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08E48D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 578.3716707229614, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.75333333333333, "ram_util_percent": 67.31333333333333, "gpu_util_percent0": 0.26999999999999996, "vram_util_percent0": 0.230419921875}}
{"episode_reward_max": 14.477490212233993, "episode_reward_min": -15.594318025990532, "episode_reward_mean": 0.6866501066396135, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.966663498030908, "policy_agent_": -2.680750789918716}, "policy_reward_max": {"policy_adversary_": -4.344769725597749, "policy_agent_": 20.222076855132453}, "policy_reward_mean": {"policy_adversary_": -12.025810067149145, "policy_agent_": 6.356230086894381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.650826844690518, 1.059989944039324, 0.5177276886620054, 1.1773159865537526, 3.2594342953431847, 6.343777038708851, 2.4047227117200523, 0.8947832725024552, 3.9451218500534067, 8.720717999365275, -11.588539980179291, 4.438035659351805, 0.703242802560589, 11.07493470938632, -3.917361141235802, 1.4505361288098815, -6.606377342179797, 3.4108361482555596, 3.0033580128872597, 3.4555841370611864, 14.35462190978037, -7.821645130930969, -1.0009566065885709, 4.959819572747618, -2.0528281777502944, 1.1934519075454864, -0.5203169353275423, -0.32560701688523286, -0.692255764879225, 0.8642580740884924, 0.0768558970421756, -1.007046860356147, 9.956737211851946, -9.872848095706349, 4.040625341018314, -4.364141883800681, 3.7968364784764623, 1.2618412929891916, 1.6026866048764066, -0.07788931675195312, -4.448217453710793, 3.2880877894120686, -0.2942323743739621, 5.730086698841449, 4.980468927539241, 4.038929685470353, 0.22854635079646168, 2.2325066040612964, -1.1235819895511474, 4.014033163039243, 0.8990841915358769, 5.656376401635789, 5.859833691258181, 0.0900823034822377, -3.0443387492374065, 1.0524451557115666, 2.492758191550821, 2.7218969161061013, 2.3393596055500048, -3.056081207068853, -4.142899312019362, 3.7036644345396725, -2.34255810491959, -3.415142091510277, -6.26206389439567, -3.4026786869575925, -3.061988790538602, 0.30191797853056246, 4.208133676804776, -8.956003771964925, 0.9473318267683233, -4.560036518127123, 0.2924498770510511, 5.672822013973133, 2.1085299906728268, -3.415313853966434, -7.263622944591481, 10.88133482626929, 0.3872655143065169, 3.9169103476883964, 1.0030695454626835, -9.920972231076707, -3.126365219813542, 3.262296052761295, 1.4893220989170353, 3.7659548071109477, 0.28804006453475606, -4.350956025024423, 2.869221855309066, -8.798967279105431, -3.564960916098898, 2.8073166482679586, -1.1485470353860523, -2.205440732037691, -2.7053597068018522, -0.5731139266774234, -1.8803894520287883, -0.8669091462850865, 12.304179829885951, -6.739779617744842, 1.637508552988546, -3.3692329845091473, 10.55516743724572, 4.0504768472235355, -1.398566541375811, -2.2309076154302168, -1.0343195916328434, 5.037373052276091, -5.1220129297574895, -3.2830921635263, 1.5825941616769947, 8.655559324411103, 4.56112724181869, 14.477490212233993, -13.750795608432892, 5.8092594924584615, 8.00371743547711, 5.626614516581122, -4.729320762529918, -3.3460695198940957, 10.162314333932216, -15.594318025990532, -7.580532562336259, 7.8380627110385, -7.17913556548721, 2.154456571581906, -0.44163055424899866, 3.5479174092356605, 5.9589994670181055, 1.4558070254054976, 13.696473187192327, -0.15080030850360462, -2.8761528408572055, -3.8783235216607435, 8.219108900479533], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.179387184901275, -7.170164220036217, -7.40109276775329, -13.406872914163129, -11.88117990900855, -22.602894012522686, -8.878159292177134, -9.494531175964097, -13.318082937887196, -12.66617067677802, -12.210540459499978, -10.093658000592672, -9.516824480504996, -22.31593169532666, -8.500541950335926, -11.016967169904726, -6.7248413676849745, -14.109337053102367, -11.812411922177493, -16.666520483808984, -21.58382249893967, -11.612013097235105, -6.587244023018987, -10.571295386938223, -8.583727396556231, -12.240289411020445, -13.430801518402477, -10.219995719174538, -6.780060228447385, -10.284503001625719, -8.981236794619232, -7.068178423682739, -14.884914223964262, -9.752504440764962, -15.872687088387497, -8.303219027281513, -15.171045041188973, -9.596194893305306, -10.068132194112895, -8.683992397756985, -17.298645978535983, -9.109048580082082, -12.767624001634193, -15.460517501911495, -15.777434125938992, -13.5223726555912, -21.31432297909602, -11.889834040682446, -8.589196147722786, -10.47263210151469, -9.346898977801933, -14.739952354154683, -14.374454153748266, -9.604691649303527, -8.160095633159358, -11.36162781921397, -8.621564757896941, -11.958171318741403, -6.023578085261583, -18.921208123420097, -13.33675154346351, -9.31463330298466, -21.682695470660175, -9.950593240965539, -15.694713874908832, -4.344769725597749, -7.597215938678158, -10.946892481009236, -11.32971021081743, -11.84552318790013, -9.990734877993123, -8.80453108420643, -14.7777763625168, -13.152691098600446, -8.728597964043054, -12.863680784517936, -9.427483291840234, -16.06123414975125, -11.43309212111176, -10.66304524369523, -7.439446223000208, -4.559470651239279, -5.356880354812249, -11.896788968155445, -8.342481982512242, -12.925473602986706, -10.106402728327945, -9.12738367336279, -15.936511148119765, -9.313685167410702, -12.669520838849467, -8.186606392778499, -16.64024557729427, -5.085929304724915, -12.084655601424155, -12.561099101381837, -12.029497589284837, -12.937931106265706, -18.350030063175048, -12.267808648738628, -10.982432830669794, -12.020840744421948, -18.414352064525705, -11.012405135524451, -8.172871162166231, -6.261703299697441, -8.600074694441325, -15.063067985159236, -23.50965883829223, -6.124440836777996, -13.061108022522983, -12.808070742969562, -13.663619711114544, -25.966663498030908, -14.851099130039739, -11.534893843127387, -18.247102664568768, -11.25734775177391, -14.66312215971388, -5.983073440466587, -16.39816428061465, -15.116146430957865, -10.9984003291569, -17.20297384034148, -11.897143797582771, -9.873147510537418, -10.788038094487426, -18.892750944727478, -17.529555226546275, -8.363713124376691, -22.731739057541407, -6.935353190276807, -6.9661099380435605, -9.550352412353165, -14.722770186514632], "policy_policy_agent__reward": [5.264280170105379, 5.264280170105379, 4.115077082037769, 4.115077082037769, 3.9594102282076475, 3.9594102282076475, 7.292094450358438, 7.292094450358438, 7.570307102175866, 7.570307102175866, 14.473335525615767, 14.473335525615767, 5.641441001948593, 5.641441001948593, 5.194657224233277, 5.194657224233277, 8.6316023939703, 8.6316023939703, 10.693444338071647, 10.693444338071647, 0.3110002396603431, 0.3110002396603431, 7.26584682997224, 7.26584682997224, 5.110033641532795, 5.110033641532795, 16.69543320235649, 16.69543320235649, 2.2915904045500626, 2.2915904045500626, 6.233751649357307, 6.233751649357307, 0.05923201275258817, 0.05923201275258817, 8.760086600678964, 8.760086600678964, 7.407884967532376, 7.407884967532376, 10.061052310435088, 10.061052310435088, 17.96922220436003, 17.96922220436003, 1.8951839831520634, 1.8951839831520634, 2.793143708215209, 2.793143708215209, 7.7655574798429186, 7.7655574798429186, 3.265449609402969, 3.265449609402969, 6.716870659282966, 6.716870659282966, 6.455242291537468, 6.455242291537468, 4.947194351144651, 4.947194351144651, 3.0439022317840796, 3.0439022317840796, 5.574380537857105, 5.574380537857105, 4.529046345830704, 4.529046345830704, 3.030565781663295, 3.030565781663295, 12.420825717908103, 12.420825717908103, -0.06017182747069266, -0.06017182747069266, 9.956656214702905, 9.956656214702905, 1.9695385717404166, 1.9695385717404166, 9.48394075983272, 9.48394075983272, 5.429018093147249, 5.429018093147249, 5.835409399494653, 5.835409399494653, 4.303051540502517, 4.303051540502517, 6.425214262412595, 6.425214262412595, 6.198568184747076, 6.198568184747076, 6.236695813630114, 6.236695813630114, 10.595302100376472, 10.595302100376472, 10.378951526739122, 10.378951526739122, 8.780651170530781, 8.780651170530781, 10.771434664946243, 10.771434664946243, 7.061170322371869, 7.061170322371869, 3.7328070790858185, 3.7328070790858185, 7.2433326322769656, 7.2433326322769656, 5.122991584668906, 5.122991584668906, 10.198164377895232, 10.198164377895232, 10.117143922503226, 10.117143922503226, 4.847386976392884, 4.847386976392884, 2.557878441960976, 2.557878441960976, 6.207036487462768, 6.207036487462768, 5.5571614747238804, 5.5571614747238804, 7.3400341174237544, 7.3400341174237544, 4.181468845405793, 4.181468845405793, 7.93256345817562, 7.93256345817562, 4.596926115722076, 4.596926115722076, 6.509148868762168, 6.509148868762168, 9.670068682870289, 9.670068682870289, 3.267725574727633, 3.267725574727633, 4.71632499025658, 4.71632499025658, 0.4710455193200789, 0.4710455193200789, 2.267613574069779, 2.267613574069779, 5.624405229769897, 5.624405229769897, 7.768921943811103, 7.768921943811103, 1.444759707967604, 1.444759707967604, 5.469033352380722, 5.469033352380722, 2.122247283039653, 2.122247283039653, 7.535113119783924, 7.535113119783924, 9.41275655628679, 9.41275655628679, 5.41856397735794, 5.41856397735794, 4.724183465275754, 4.724183465275754, 1.0819301736243787, 1.0819301736243787, 13.47128448801027, 13.47128448801027, 5.91017881770914, 5.91017881770914, 7.289977795691813, 7.289977795691813, 4.221257884231447, 4.221257884231447, -2.680750789918716, -2.680750789918716, 1.1152575674993543, 1.1152575674993543, 7.579542510458369, 7.579542510458369, 4.91590204071464, 4.91590204071464, 8.345714205048825, 8.345714205048825, 5.19722139643135, 5.19722139643135, 2.388213824169185, 2.388213824169185, 9.402866501714417, 9.402866501714417, 0.25735894415263394, 0.25735894415263394, 4.552279961375285, 4.552279961375285, 5.496961520523227, 5.496961520523227, 7.745849270954107, 7.745849270954107, 1.4402442863436111, 1.4402442863436111, 4.689647947311149, 4.689647947311149, 5.9939925873522055, 5.9939925873522055, 5.074554068628026, 5.074554068628026, 6.0355109799903115, 6.0355109799903115, 15.327104946530502, 15.327104946530502, 2.7640145154968874, 2.7640145154968874, 6.30997069182917, 6.30997069182917, 4.325803879956401, 4.325803879956401, 14.48475975088571, 14.48475975088571, 7.531440991373995, 7.531440991373995, 3.38715231039521, 3.38715231039521, 2.01539784213361, 2.01539784213361, 3.7828775514042423, 3.7828775514042423, 10.050220518717664, 10.050220518717664, 9.193822954267366, 9.193822954267366, 1.4206743366258487, 1.4206743366258487, 7.321851092099989, 7.321851092099989, 10.731815033690326, 10.731815033690326, 9.112373476466614, 9.112373476466614, 20.222076855132453, 20.222076855132453, 0.5501517608034227, 0.5501517608034227, 8.672076667792922, 8.672076667792922, 13.125410050022936, 13.125410050022936, 8.441981134177516, 8.441981134177516, 4.96690069859198, 4.96690069859198, 1.3185019602862458, 1.3185019602862458, 13.280239307273433, 13.280239307273433, -0.23908579751633113, -0.23908579751633113, 1.7089338834103192, 1.7089338834103192, 12.520518275689989, 12.520518275689989, 2.359004116047779, 2.359004116047779, 6.013802041059664, 6.013802041059664, 5.173203770119213, 5.173203770119213, 11.220334176981568, 11.220334176981568, 11.744277346782194, 11.744277346782194, 4.909760074891094, 4.909760074891094, 18.21410612236687, 18.21410612236687, 3.3922764408865995, 3.3922764408865995, 2.044978548593177, 2.044978548593177, 2.8360144453462093, 2.8360144453462093, 11.470939543497085, 11.470939543497085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3430135028110818, "mean_inference_ms": 2.256416117131409, "mean_action_processing_ms": 0.09865301140794329, "mean_env_wait_ms": 0.5929509892602489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 148500, "timesteps_this_iter": 0, "agent_timesteps_total": 445500, "timers": {"sample_time_ms": 13102.277, "sample_throughput": 257.589, "load_time_ms": 0.296, "load_throughput": 11392978.672, "learn_time_ms": 2136.897, "learn_throughput": 1579.393, "update_time_ms": 26.921}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 13.571767807006836, "policy_loss": -0.006904311245307326, "vf_loss": 13.587367630004882, "vf_explained_var": -0.026513302326202394, "kl": 0.0034566749163197573, "entropy": 0.86957888007164, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 4.952005767822266, "policy_loss": 0.008743557869456709, "vf_loss": 4.951912784576416, "vf_explained_var": 0.17277141213417052, "kl": 0.005304601714380947, "entropy": 0.8716832786798477, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148500, "num_agent_steps_sampled": 445500, "num_steps_trained": 148500, "num_agent_steps_trained": 445500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5940, "training_iteration": 44, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-57-26", "timestamp": 1706108246, "time_this_iter_s": 12.185203313827515, "time_total_s": 590.5568740367889, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.5568740367889, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.456249999999997, "ram_util_percent": 67.1375, "gpu_util_percent0": 0.20437500000000003, "vram_util_percent0": 0.230072021484375}}
{"episode_reward_max": 16.480681557686733, "episode_reward_min": -14.472047777580228, "episode_reward_mean": 1.4628259900610614, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.431119766344136, "policy_agent_": -1.4393584727000526}, "policy_reward_max": {"policy_adversary_": -3.937543185700696, "policy_agent_": 21.08626329468912}, "policy_reward_mean": {"policy_adversary_": -13.14598826206925, "policy_agent_": 7.304407126065156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.659730153544472, -10.722511236392712, 1.108061752320959, 1.2646105746777514, 3.307167134525218, 8.56658501298764, 4.914898087887087, 0.11536233488895453, -2.4235317715346465, -7.993401763116086, 10.188013960083051, 0.862569745619159, -1.8753888963468688, 4.930306108971376, 1.3871367112003665, 8.905799469564963, 7.8910609026477765, -2.2090569775632565, 1.7418605284484476, -4.6295203084643335, 8.227112059082678, 1.7438351695915024, -0.601990290036752, -8.70588851574189, 12.201594917634004, 2.241598803214803, -3.1843628244515534, -5.42324701014596, 2.7541161437758097, -11.67328598966998, 1.3839478790746542, 7.800715725672522, -3.831093759848673, 2.0264900369400993, 5.953904863489404, -5.01781806258334, 2.991263087603287, 2.340782515387317, 11.753928274168882, 1.174281158109777, 13.838664214504456, -3.141348349218042, -1.1797473338415352, -0.07087092484920932, 3.767260464342571, 7.136795236011485, 4.154747674213268, -0.9933356266791036, 2.5626032979675033, -1.4265592952640862, 1.9732123208484658, -1.3869999621682703, 10.675774924693874, 2.294304394652814, 4.128886304445776, 9.071980388298414, -0.07410411692175631, -5.151976952464414, -0.1526943536023553, 6.270108526255093, 1.5784234026922992, -11.861389689473326, 7.615750438233561, -2.426338733333514, 1.8543435435268292, -3.1321325457959377, -4.622415477704721, -2.002868483666249, 1.5391779556812617, -5.666308895252666, -0.5254529689949023, 4.236169797029836, 5.53337113631657, -1.2527869174037356, 1.170568422798057, 3.6873727001307985, -4.567568337531491, -7.832599163275189, 6.425000170209656, 7.824046939583607, -14.472047777580228, 5.841988787596611, 4.4478174802422386, 3.355825004475825, 0.00516931417969993, -2.9087514918023603, 2.004154291369113, -0.7639879460158463, 6.703730282077424, -0.6804603963852742, -3.779763791713062, 5.880001918146294, 5.0841783995489225, -9.940481874607746, 4.733087327386674, 1.494206319740493, 1.8889093133661095, 1.8265203824654541, 16.480681557686733, 5.982675292513068, -1.5286816857169654, -2.769220848728525, 3.99074035685414, 3.4096562249300013, -0.710808819664688, 1.9196488599934693, 4.7080572850336715, 3.497612848511506, 12.71550183905686, 2.441960158431055, 16.26449899307977, 7.360163494644161, -4.830993171453503, 2.963644843184158, -5.362302906396285, 2.032570315028999, -2.578847175461764, -4.6878247205011725, 1.4395281011841141, 1.8750924019281445, -5.388730954238746, -1.9029634878141775, 11.556047555695956, 0.600143222452977, -0.48498928225689714, 11.909561920612374, 1.1631617923762652, -2.5831059831590815, -0.5714697631273709, 11.28065970410205, -0.726036672819417, -2.6082111867933757, -1.6125499202416842, 1.2334254396520135, 6.585877964052467], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-10.438407690861668, -12.382733845924495, -6.693439468937176, -11.239199066721001, -14.439830254954883, -15.944851268205106, -11.206799383222126, -7.946352771124501, -7.029107960201856, -7.362760313760939, -21.478637318449643, -16.051579441736926, -12.617675357516699, -11.920494935596432, -6.489454279003225, -14.007122512520725, -16.392798929909244, -13.032966973481361, -16.593002173184882, -15.11308551290888, -12.843559892526978, -11.51393581118225, -9.819485891396171, -11.680341846183975, -23.143671647790786, -20.4896741217429, -11.440259830527465, -9.176684152893472, -11.06427235200137, -17.9652541382533, -7.016420011069115, -15.71810816638852, -10.217717247178719, -9.159339910495463, -16.730721958481208, -13.822073465936233, -12.658659533980325, -12.72607605286426, -23.048497502305736, -8.738728893944113, -25.001665719336096, -10.231848122654325, -7.138685772999751, -12.488700286555565, -10.557738690240393, -20.814922368948423, -10.936961423779868, -9.539139570189624, -13.288914915868551, -20.07002704944423, -11.748572670354468, -8.214721866593118, -26.431119766344136, -10.778116085793087, -17.274764002886872, -15.183477513922986, -3.937543185700696, -11.0800262808869, -9.80486994395975, -12.89133397855083, -7.489064375184874, -14.237949421673147, -19.330981836177642, -17.06790556103699, -11.74421642611598, -15.419404014732471, -6.63535174847475, -7.433959468728425, -5.841752697301123, -8.12967844941344, -8.58353805427806, -11.150405412347677, -19.956275985154075, -15.469889262576006, -9.22403876688134, -19.45613999780268, -14.197438312188975, -20.275822823622857, -11.60052340841005, -19.310938705885164, -14.256771714667119, -16.439317221765815, -12.951180189732046, -15.37171196704397, -10.355083662933332, -9.368092750877453, -15.508967862815796, -11.278491875499123, -17.406948067589667, -10.967903809253633, -5.571093342924931, -12.322596227893127, -10.37723752388079, -7.061764929207646, -12.850216467843037, -9.375143277610892, -9.280214957551108, -14.00963130987693, -23.406382030737774, -20.978414732213658, -16.552129327558944, -12.305859874276164, -11.996048787323765, -15.05796801302261, -9.458660812419241, -7.898001072001011, -9.971119694052948, -10.53737309208012, -24.347007353875014, -11.387344456427748, -25.908027596298478, -15.154486413772467, -5.935847400848031, -21.155124934935092, -25.406777718492418, -8.802053391220044, -14.924673130686939, -15.953956479616762, -11.356162432695369, -7.945486729426923, -13.03554217117407, -5.7365648654552235, -19.7523980221897, -9.624551274096639, -13.006440173295877, -17.79536998477673, -12.026994873828258, -5.616738772197274, -13.415833530326092, -16.78580007085921, -14.421596959493238, -11.022687047736623, -6.561266855474489, -10.886739755647483, -16.506412561490727], "policy_policy_agent__reward": [2.3893387686586007, 2.3893387686586007, 0.8301113047658912, 0.8301113047658912, 3.9007506106290686, 3.9007506106290686, 6.251904820699376, 6.251904820699376, 8.873498694740054, 8.873498694740054, 12.255718140596374, 12.255718140596374, 8.060848735554607, 8.060848735554607, 4.030857553006728, 4.030857553006728, 2.302788094333606, 2.302788094333606, -0.31532072467757266, -0.31532072467757266, 15.833325639266352, 15.833325639266352, 8.457074593678042, 8.457074593678042, 5.371143230584916, 5.371143230584916, 8.425400522283903, 8.425400522283903, 3.9382954951017966, 3.9382954951017966, 11.456460991042846, 11.456460991042846, 12.14192991627851, 12.14192991627851, 5.411954997959051, 5.411954997959051, 9.167431350816669, 9.167431350816669, 5.241782602222269, 5.241782602222269, 10.535335975804829, 10.535335975804829, 6.628885490386875, 6.628885490386875, 4.608747800679709, 4.608747800679709, 1.4872266652210409, 1.4872266652210409, 17.672633282712397, 17.672633282712397, 11.36563646247885, 11.36563646247885, 4.127948503037955, 4.127948503037955, 1.8767185713737553, 1.8767185713737553, 6.909194247888587, 6.909194247888587, 3.145984074291659, 3.145984074291659, 4.200183945071885, 4.200183945071885, 11.759411946030522, 11.759411946030522, 3.193311743665021, 3.193311743665021, 5.592914973717781, 5.592914973717781, 11.342313410985303, 11.342313410985303, 4.402127701676446, 4.402127701676446, 7.824961310791808, 7.824961310791808, 7.533429284125786, 7.533429284125786, 17.401212888237303, 17.401212888237303, 4.956505026026946, 4.956505026026946, 19.420164966920282, 19.420164966920282, 3.545249886718143, 3.545249886718143, 2.9794692195791073, 2.9794692195791073, 6.208914680853178, 6.208914680853178, 7.162499577291483, 7.162499577291483, 13.975858802479951, 13.975858802479951, 7.54585454899657, 7.54585454899657, 4.27290197175526, 4.27290197175526, 7.9257591069180275, 7.9257591069180275, 9.321733877090072, 9.321733877090072, 6.860892495601468, 6.860892495601468, 3.413860952212423, 3.413860952212423, 18.553447345518997, 18.553447345518997, 6.53621024022295, 6.53621024022295, 10.701825153666324, 10.701825153666324, 12.127728951110702, 12.127728951110702, 1.9317195343894709, 1.9317195343894709, 2.964024664211243, 2.964024664211243, 4.826087795178696, 4.826087795178696, 9.580721252402961, 9.580721252402961, 4.533743888938589, 4.533743888938589, 1.1882798660999112, 1.1882798660999112, 13.473366137205602, 13.473366137205602, 7.320783413851738, 7.320783413851738, 6.799279984821404, 6.799279984821404, 6.1436357344682655, 6.1436357344682655, 1.0064681353850142, 1.0064681353850142, 2.7155454925310876, 2.7155454925310876, 3.6904653264911924, 3.6904653264911924, 1.2316847770803871, 1.2316847770803871, 4.0290425426415775, 4.0290425426415775, 7.693287604688756, 7.693287604688756, 12.744823560735325, 12.744823560735325, 7.108551172586133, 7.108551172586133, 5.197303594839697, 5.197303594839697, 11.571756348966739, 11.571756348966739, 4.814934987328743, 4.814934987328743, 6.22161183017383, 6.22161183017383, 9.012761789309854, 9.012761789309854, 13.567492822734387, 13.567492822734387, -0.10763803145655743, -0.10763803145655743, 11.140653004681214, 11.140653004681214, 8.69949883498714, 8.69949883498714, 9.363768485759895, 9.363768485759895, 5.180126488556517, 5.180126488556517, 3.229670629537547, 3.229670629537547, 8.756561077092456, 8.756561077092456, 5.257251964741639, 5.257251964741639, 12.055339174833545, 12.055339174833545, 5.143721706434179, 5.143721706434179, 0.8956647756059344, 0.8956647756059344, 9.101299073019709, 9.101299073019709, 7.730707961714857, 7.730707961714857, -1.4393584727000526, -1.4393584727000526, 8.791651897614857, 8.791651897614857, 5.434674798675692, 5.434674798675692, 5.584562135458608, 5.584562135458608, 7.918075846171196, 7.918075846171196, 19.94353179421225, 19.94353179421225, 13.48054501236336, 13.48054501236336, 7.511723820920987, 7.511723820920987, 4.768319512773819, 4.768319512773819, 7.9933945720889525, 7.9933945720889525, 9.233812118976305, 9.233812118976305, 4.373925996377275, 4.373925996377275, 4.9088249659972405, 4.9088249659972405, 7.339588489543311, 7.339588489543311, 7.017492970295812, 7.017492970295812, 18.531254596465935, 18.531254596465935, 6.9146523074294, 6.9146523074294, 21.08626329468912, 21.08626329468912, 11.257324954208313, 11.257324954208313, 0.5524271146972646, 0.5524271146972646, 12.059384889059626, 12.059384889059626, 10.022237406048063, 10.022237406048063, 5.417311853124521, 5.417311853124521, 6.172912977612586, 6.172912977612586, 5.633065879557794, 5.633065879557794, 6.397845266939741, 6.397845266939741, 4.910289565677533, 4.910289565677533, 3.823405608467663, 3.823405608467663, 1.9168006888205231, 1.9168006888205231, 15.65422278894283, 15.65422278894283, 5.112347248274808, 5.112347248274808, 6.26072544551949, 6.26072544551949, 14.852465952694551, 14.852465952694551, 6.595078333102258, 6.595078333102258, 1.5168163945190956, 1.5168163945190956, 6.422181883599362, 6.422181883599362, 14.033229887480624, 14.033229887480624, 6.847780143336911, 6.847780143336911, 4.207237930471626, 4.207237930471626, 2.4743584676164025, 2.4743584676164025, 6.060082597649745, 6.060082597649745, 11.546145262771597, 11.546145262771597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34255497933614526, "mean_inference_ms": 2.252727611180884, "mean_action_processing_ms": 0.09841474520171506, "mean_env_wait_ms": 0.5921153008038372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 151875, "timesteps_this_iter": 0, "agent_timesteps_total": 455625, "timers": {"sample_time_ms": 13011.638, "sample_throughput": 259.383, "load_time_ms": 0.296, "load_throughput": 11392978.672, "learn_time_ms": 2127.032, "learn_throughput": 1586.718, "update_time_ms": 26.822}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 17.339906311035158, "policy_loss": 0.0017516362793685402, "vf_loss": 17.34666042327881, "vf_explained_var": -0.02968961000442505, "kl": 0.002714915848470001, "entropy": 0.8505805253982544, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 6.632838010787964, "policy_loss": -0.0043015355593524875, "vf_loss": 6.645586466789245, "vf_explained_var": 0.18419839739799498, "kl": 0.004106619169506942, "entropy": 0.8498165667057037, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 151875, "num_agent_steps_sampled": 455625, "num_steps_trained": 151875, "num_agent_steps_trained": 455625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6075, "training_iteration": 45, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-57-39", "timestamp": 1706108259, "time_this_iter_s": 12.542181491851807, "time_total_s": 603.0990555286407, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E046D3A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 603.0990555286407, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.387499999999996, "ram_util_percent": 67.6, "gpu_util_percent0": 0.289375, "vram_util_percent0": 0.2322235107421875}}
{"episode_reward_max": 17.14315577816135, "episode_reward_min": -17.604806319585713, "episode_reward_mean": 0.45426113641963656, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.872339376097248, "policy_agent_": -1.7372861080320001}, "policy_reward_max": {"policy_adversary_": -3.4576442131298157, "policy_agent_": 20.776049449670566}, "policy_reward_mean": {"policy_adversary_": -12.605276819369891, "policy_agent_": 6.529768977894764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2441167377149185, 3.1516580925253153, -1.7142446008279917, 3.508161990463074, 7.876332636859654, 3.224949585471316, 2.586841657999785, 14.562488489722947, 6.405336484946095, -11.185078524222991, 9.469208971136744, 6.695188742913366, -1.369871694531776, -0.6638045034945828, -1.0745573367081886, -8.090785228902693, -0.020316086225985297, -0.957244570331613, -4.246501510916553, 9.307040307621522, 3.0163337065095535, -3.885950589085498, -2.39374891187938, 6.085123537513335, 6.059219984199835, 0.641100569083832, 2.225264531602943, -9.287239785054807, 4.688020649513694, 1.2474913487432466, 2.9235419773774964, 3.3564043187117907, -2.824077542015128, -3.286846570054052, 6.290971378907804, -17.604806319585713, -1.9389804265968356, 1.561213806155029, -2.161095952159082, -5.527547610046398, -11.485643014242958, -8.262903310317311, -2.1182554976774157, -3.904475185252698, 4.085207689198582, 4.066642539833649, 4.179380254294307, -10.145670306497443, 2.2598235554194614, 5.23907959714812, -7.636564180529129, 0.2206012881427208, -2.931672817516306, 4.113750505042508, 5.4393211828678645, -5.569209957512795, 1.8384063218233662, 17.14315577816135, -0.23438681935645353, 5.240068787486605, -2.572955433385326, 4.293412857464015, -1.1588956608612335, 2.2073034517774923, -4.3056351499963466, 0.18054422171601067, 0.31583593820134637, -3.46569219610039, 3.7344345194328685, 2.8652260917545567, -14.603530760006175, 4.787034790676081, -0.6065810182748874, 8.462709824019852, -1.7782832779249294, 5.224269551130374, -12.798155718717084, -3.7826516923925744, 2.3424568499682077, 1.9672688191190948, -5.839912007039876, 1.6016834239988365, -0.4228985528281829, 1.6934803277391457, 9.33885920931225, 2.811355301579012, -0.7162281543547077, 2.088457373065028, -0.1408990922939321, 3.773580280816587, 5.3232369994718685, -2.529202923259671, -10.243681140218035, -5.478850330496466, -8.241116059626783, 8.585700306985972, -2.7612592022779197, 0.9421426327936366, 3.0706108214147703, 1.6141198494462674, -4.665989371086702, 8.60927061254143, -5.2018972789583255, 3.654714693996252, -5.660267257960554, 4.686388651042083, -3.9918873801782095, 1.4421031895437648, 16.143230269660275, 1.603403607929374, 15.936745815867646, 1.957523071301385, 8.758912889433402, -8.759031375174684, 8.141167485286848, -5.714091345532739, 4.24100259003479, 1.6521775330839263, -1.3955962053359594, 6.037245330123614, -2.1444940308753924, -2.2687600498309304, -9.98139897373165, 3.856673305853311, 7.4743282227393575, 2.7482734530284243, -3.769093234885985, 7.690575024337325, -1.0829903202543092, 7.334812750835974, 3.784764010633641, -14.044757314055474, -11.056040168783843, 3.1394274093811236, 2.449778056672791], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.6159148598656365, -16.929029240591884, -5.773630597162918, -10.358851692173912, -13.592490227649522, -10.162097546535827, -10.89935236129848, -22.006981171545085, -14.441703662893058, -11.428561905251144, -19.25436626617685, -13.122643445247174, -4.962493780987396, -8.159087466651922, -5.993778365619158, -10.597638736772687, -10.744776038582456, -4.8247916894872525, -9.980151684321818, -17.70563720608439, -12.088692240973971, -12.184165131340539, -14.980350150157152, -10.67814927540428, -13.12955852817388, -10.106793318796662, -9.08355643809832, -18.75423342274796, -9.431454970276022, -10.08069459038809, -14.283582456153745, -12.267102396044702, -15.460176074466995, -14.528281315640713, -15.607716989763768, -24.666866398177554, -13.855217296326188, -9.984121764768709, -3.4576442131298157, -8.866057166547835, -18.747179915283326, -11.050680724820312, -7.312881069418272, -9.825143241169153, -16.960743871141403, -12.56162751177094, -12.598227641819648, -17.51047159734857, -22.677794358222936, -16.532275702708983, -19.72716650047849, -10.264487676662943, -8.392739022368072, -12.126967061723219, -15.767774293628229, -12.88174383882125, -8.37999534525302, -24.40894312117978, -12.085611985377493, -10.90470804738319, -9.936346950450323, -12.048344417724184, -9.022184393842025, -13.221679136739501, -16.461277144208715, -5.308778512952589, -8.69177829298583, -12.25270463811312, -9.335203406265773, -10.253271696768948, -15.31299119630279, -10.461172306249203, -8.885598692397414, -16.535402254712544, -11.270912798589471, -11.482590534659904, -12.570924407338048, -16.583782845105265, -7.974055497314344, -8.602675863029107, -10.532355191395036, -12.155534501425608, -9.646622988669046, -12.35890348710573, -19.12758629269647, -15.37725913551403, -11.394387257431175, -10.967415918657576, -9.647381763842807, -9.57911258492728, -12.889399569031113, -8.302352990143275, -9.971136615867584, -12.09752315998789, -5.682920955668899, -20.32652847855746, -8.240397547593393, -6.969181543298395, -10.229414546459331, -5.755070055395359, -12.32992258166103, -19.604535814630776, -13.1528178814494, -13.896795917931316, -8.551750810550509, -10.689041007201507, -17.082370850637275, -12.348187315034055, -25.266836437490422, -9.490910688847006, -22.060956456523392, -9.031077834798758, -21.020372151991037, -14.927178055865841, -12.998778716972083, -8.540218583973633, -9.725096317209896, -7.416674647492471, -11.503899784273544, -20.65904743901659, -11.00767882836226, -15.106632457660753, -11.158215101070649, -12.754839372327195, -16.171801727016085, -11.399430240716951, -15.518346261433802, -13.251006792690815, -16.883848117509416, -26.872339376097248, -10.231628872359785, -10.570185097991473, -19.328514808595436, -10.91963291621166, -10.014087173070049], "policy_policy_agent__reward": [1.6858990610753593, 1.6858990610753593, 10.040343666558597, 10.040343666558597, 2.0296929981674627, 2.0296929981674627, 6.933506841318493, 6.933506841318493, 10.734411432254587, 10.734411432254587, 6.693523566003569, 6.693523566003569, 6.7430970096491345, 6.7430970096491345, 18.28473483063402, 18.28473483063402, 10.423520073919574, 10.423520073919574, 0.1217416905140716, 0.1217416905140716, 14.361787618656798, 14.361787618656798, 9.908916094080274, 9.908916094080274, 1.79631104322781, 1.79631104322781, 3.7476414815786683, 3.7476414815786683, 2.459610514455484, 2.459610514455484, 1.253426753934998, 1.253426753934998, 5.362229976178236, 5.362229976178236, 1.9337735595778198, 1.9337735595778198, 2.866825086702632, 2.866825086702632, 13.50633875685296, 13.50633875685296, 7.552512973741764, 7.552512973741764, 4.149107271127521, 4.149107271127521, 6.293300619138884, 6.293300619138884, 8.381636406458803, 8.381636406458803, 9.594389256186862, 9.594389256186862, 5.373946943940246, 5.373946943940246, 5.654410484850631, 5.654410484850631, 4.733496818846579, 4.733496818846579, 7.059737809894858, 7.059737809894858, 5.66409296956567, 5.66409296956567, 8.60356221676562, 8.60356221676562, 7.811753357378247, 7.811753357378247, 6.318049266225935, 6.318049266225935, 5.6207173727933295, 5.6207173727933295, 10.949344184335782, 10.949344184335782, 3.5310300392959144, 3.5310300392959144, 5.9581184348646765, 5.9581184348646765, 5.772667785461866, 5.772667785461866, 0.6482741304853665, 0.6482741304853665, 1.669254778250719, 1.669254778250719, 3.6307684505201836, 3.6307684505201836, 1.3938887072514967, 1.3938887072514967, 2.597312785870428, 2.597312785870428, 2.9603340279582255, 2.9603340279582255, 10.522975780169986, 10.522975780169986, 8.314135025802294, 8.314135025802294, 8.388803948056978, 8.388803948056978, 3.682400645425571, 3.682400645425571, 12.468808956821194, 12.468808956821194, 10.885677649928551, 10.885677649928551, 6.045301159974686, 6.045301159974686, 5.242544482402833, 5.242544482402833, 2.7305331024258845, 2.7305331024258845, 8.120358783382862, 8.120358783382862, 10.603547738248043, 10.603547738248043, 3.65626694065423, 3.65626694065423, 5.109200833538193, 5.109200833538193, 20.776049449670566, 20.776049449670566, 5.925612583010519, 5.925612583010519, 8.0723884174349, 8.0723884174349, 3.6816957585324976, 3.6816957585324976, 8.1708786375941, 8.1708786375941, 3.931644366490397, 3.931644366490397, 7.714491294258501, 7.714491294258501, 6.077820997106186, 6.077820997106186, 2.7446613673343, 2.7446613673343, 4.503807115593592, 4.503807115593592, 4.393506221006366, 4.393506221006366, 6.534818962849322, 6.534818962849322, 6.559248894261754, 6.559248894261754, 0.35473021814830313, 0.35473021814830313, 7.624103548462643, 7.624103548462643, 4.139508837061261, 4.139508837061261, 12.499056039366197, 12.499056039366197, 4.74631476033227, 4.74631476033227, 8.353430042895138, 8.353430042895138, -0.11361565568951763, -0.11361565568951763, 6.400565576356347, 6.400565576356347, 5.158256173641275, 5.158256173641275, 5.284972341074101, 5.284972341074101, 2.346221592177582, 2.346221592177582, 6.878608962712219, 6.878608962712219, 4.611862217920431, 4.611862217920431, 7.026191907422437, 7.026191907422437, 14.233222751004359, 14.233222751004359, 9.094307218546524, 9.094307218546524, 5.339079551538233, 5.339079551538233, 6.527936645861302, 6.527936645861302, 4.753241335774436, 4.753241335774436, 6.676346432871934, 6.676346432871934, 9.106318284251492, 9.106318284251492, 2.886575033441801, 2.886575033441801, -0.13627226217522415, -0.13627226217522415, 3.30933641474571, 3.30933641474571, -1.279097551978948, -1.279097551978948, 14.456114392771715, 14.456114392771715, 2.7395691726577356, 2.7395691726577356, 3.955662088046016, 3.955662088046016, 6.65001268393705, 6.65001268393705, 3.6845949524208144, 3.6845949524208144, 3.831966605287163, 3.831966605287163, 14.106903213586104, 14.106903213586104, 3.9754603012455405, 3.9754603012455405, 8.775755305963784, 8.775755305963784, 1.445741776294977, 1.445741776294977, 7.687714829121795, 7.687714829121795, 6.545241735229531, 6.545241735229531, 6.89514525228891, 6.89514525228891, 20.70503335357535, 20.70503335357535, 5.547157148388187, 5.547157148388187, 18.99885113619552, 18.99885113619552, 5.494300453050071, 5.494300453050071, 14.88964252071222, 14.88964252071222, 3.084073340345577, 3.084073340345577, 10.569973101129467, 10.569973101129467, 1.4130636192204493, 1.4130636192204493, 6.983049453622344, 6.983049453622344, 4.534426090288199, 4.534426090288199, 5.054151789468793, 5.054151789468793, 13.348146384570107, 13.348146384570107, 4.431592398743434, 4.431592398743434, 6.418936203914914, 6.418936203914914, 0.5884080636694997, 0.5884080636694997, 8.30575633909025, 8.30575633909025, 11.823064974877717, 11.823064974877717, 7.073851846872689, 7.073851846872689, 5.874626513273913, 5.874626513273913, 10.470790908514067, 10.470790908514067, 7.900428898627556, 7.900428898627556, 17.103576063466615, 17.103576063466615, 7.008196441496713, 7.008196441496713, -1.7372861080320001, -1.7372861080320001, 4.1362373199057965, 4.1362373199057965, 7.029530162796393, 7.029530162796393, 6.231932614871423, 6.231932614871423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3424714162720875, "mean_inference_ms": 2.2528209376944335, "mean_action_processing_ms": 0.09867477440333587, "mean_env_wait_ms": 0.5917873348416208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 155250, "timesteps_this_iter": 0, "agent_timesteps_total": 465750, "timers": {"sample_time_ms": 13015.665, "sample_throughput": 259.303, "load_time_ms": 0.296, "load_throughput": 11392978.672, "learn_time_ms": 2114.708, "learn_throughput": 1595.965, "update_time_ms": 26.523}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 14.66654462814331, "policy_loss": -0.010464292019605637, "vf_loss": 14.685150718688964, "vf_explained_var": 0.006550514698028564, "kl": 0.002503013627146855, "entropy": 0.8141635417938232, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 4.710243153572082, "policy_loss": -0.005234147608280182, "vf_loss": 4.723873472213745, "vf_explained_var": 0.27093169689178465, "kl": 0.005924494954978923, "entropy": 0.8433176636695862, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 155250, "num_agent_steps_sampled": 465750, "num_steps_trained": 155250, "num_agent_steps_trained": 465750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6210, "training_iteration": 46, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-57-52", "timestamp": 1706108272, "time_this_iter_s": 13.417380094528198, "time_total_s": 616.516435623169, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A012A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 616.516435623169, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.194117647058825, "ram_util_percent": 67.61764705882354, "gpu_util_percent0": 0.05764705882352941, "vram_util_percent0": 0.23457605698529413}}
{"episode_reward_max": 22.011517458552536, "episode_reward_min": -19.01885685431262, "episode_reward_mean": 0.3046644136264304, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.60405285401599, "policy_agent_": -4.4835768370762015}, "policy_reward_max": {"policy_adversary_": -3.4914087294461407, "policy_agent_": 24.111561697954674}, "policy_reward_mean": {"policy_adversary_": -12.76857632592764, "policy_agent_": 6.536620369777034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.405853935817936, 1.0794289295893942, 0.20251471633771917, 3.554767177610425, -8.100831856329137, -0.3368760316887596, 1.3789595527062708, -12.142119380661143, -1.547108090061454, 4.907066584022477, -5.20910002117605, -3.9102306169169947, -5.165664526977702, 0.016221617878105, -2.194935448050194, 3.857561578703346, -0.3202359066236805, 4.725111129516194, -19.01885685431262, -4.999890611560497, 7.946083945817021, 8.606280594671345, -4.461761916367757, 8.776703383662083, -1.5183061858129347, -2.108092726777887, 1.8866916429494998, 6.536463012653503, 4.226619622110913, 2.5071339027443567, 0.39723198227880213, 0.742826463483955, 1.097654989383957, 1.8803367420392005, 1.7446426966843904, 5.298633839977037, -2.226932787355722, -0.5430096163907265, 2.9321547013102514, 1.8309360000547663, 1.814926055704603, 3.036603558445557, 1.298511846353104, 1.6258876281559824, 3.8879638697626584, 5.246266016575104, 4.6400455388355875, -15.061423255180458, 6.8370917847532855, -2.173586778725233, 0.45207600528799363, -3.0174042650301867, 1.116812336723919, -0.3197342226333205, 3.2422677531882855, 1.3338448434273316, 5.350280475845919, -5.498796441317046, 4.203301132306088, -1.0878692785398738, -6.044030180665333, 10.785900338077312, -7.179390681949145, -13.39825871446006, -4.330365450126831, 4.312180078994451, 12.635160341474096, 6.197060357148201, -8.790494833475412, 2.96137011455518, 6.740149221823573, 8.533728114725609, 5.815301118875667, 0.08921869380264125, -0.24864991746028195, 4.949555283347172, -6.019535636622849, -1.4493187846883584, 2.424063497604324, -5.490900922882239, 2.0428856689671773, 1.1547278644234629, -4.258060422153041, -0.5807846133901549, -0.5368658124548344, -1.9568149745726748, 1.9119872956391228, -0.207876761040863, 4.179601565941199, 0.6504404433868555, -0.27302099965507215, 3.2113717384114664, -2.7756344788562832, -3.442980338987933, 1.9854290519505202, 0.12545399390890793, 1.48269608564033, -6.122925656114169, -0.35600764965557175, -9.422081958700717, -2.009148993387085, 1.5429777926921813, 0.10449213561204815, -2.3753156934163866, -5.7567122422224, 0.5498655292066476, -4.166172565709497, 2.306617647299329, -0.07853510161942956, -6.971433602893203, 8.56794390989082, 14.653761268423342, -8.838382923973388, -0.1415075010994561, 8.930060603092475, -6.580538160741445, -8.297687652923976, 2.213439798870836, -2.796650921102419, -6.199077667022965, -11.912450580145538, -1.5904043124603668, -10.295911925826376, -2.7821353488556935, 11.61723648507187, -1.2865802001496405, 7.655867011087501, 2.562223233672875, 2.581420756984561, 14.02050209577597, -0.9417622448121294, 4.847027140565494, 2.5382683190339708, -9.518390557567399, 22.011517458552536], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-20.50361088505196, -11.260612078428249, -5.708438921377226, -10.44798611869825, -10.342563613321609, -12.665290964618984, -5.721205830668504, -10.550600469116569, -8.751806656336452, -10.675078680593009, -12.464854720904924, -11.387515647195045, -18.798968328242747, -7.569433050915176, -15.199055766680956, -9.998086594937398, -14.18759227283696, -11.865815931103407, -10.051703180160219, -7.59973262996501, -15.707631631426695, -15.977341815699448, -7.127532481490523, -13.896045552563608, -9.363421197726977, -14.549008070746195, -6.898313667609273, -18.237291222103256, -10.484605384402522, -12.939930266841145, -9.830986294181598, -12.730221531031528, -8.29152529031367, -15.266228404839735, -12.277223392249457, -13.495844979449314, -22.416117893389377, -14.460834356140602, -18.13595129697323, -9.541410731002566, -9.64053677485129, -19.10356545834415, -19.342957852245206, -13.17013534238821, -10.586204434688394, -14.328185279721772, -10.892451735473866, -7.718583646006008, -14.76475650659025, -15.86198302695646, -8.863250224711452, -12.862263424051676, -14.980051819386102, -14.315495160583488, -10.328291401305908, -10.78713825206055, -19.464084765406717, -8.284708425149905, -17.42634418129856, -15.959524656445712, -13.524963922125114, -16.48940713751091, -5.754126360586097, -13.831302035470326, -13.443516503412093, -11.072760280307332, -20.62264879610495, -11.75527982160186, -12.38296190766872, -16.034774909845982, -16.31203477709923, -19.837759637589052, -19.056038198475285, -14.653517597724436, -10.57665882676437, -14.487560717349522, -4.910344459716055, -9.22399764917004, -11.667248624336063, -11.51573874772751, -8.066914343324015, -14.603737125285633, -11.807329349490963, -6.921032211963807, -11.605111501463082, -12.84466822209619, -6.103458564114196, -9.243802179979228, -11.974767921287466, -9.34765704546788, -3.4914087294461407, -14.62472772765657, -7.274484655309217, -20.64043965204517, -10.332577697105695, -13.071952445780983, -15.184128590829722, -8.40412014116878, -13.116614684451791, -13.732926884997237, -11.329122960697985, -9.755467351897142, -21.18846716076833, -9.396697329766713, -6.461110888657088, -13.082234850737537, -15.364555624722646, -9.39003069077702, -9.403674669203134, -11.477869101086014, -14.040946396594716, -21.876019574440477, -8.90698825268715, -7.58617099230807, -16.10878745021488, -10.184841275017433, -13.41604651947817, -12.81389674298968, -7.8657246563300784, -9.949321607927239, -21.173817210057944, -7.94935208151368, -14.682403181991457, -20.797660341161254, -26.60405285401599, -17.101261381191183, -13.063699600191828, -14.741244095160875, -10.362046324612326, -21.601362105557964, -8.314696696048511, -14.244937046428186, -9.574255981409133, -12.13500431438463, -26.21160593735682], "policy_policy_agent__reward": [14.454732410434948, 14.454732410434948, 6.170020504008822, 6.170020504008822, 2.9554768188574725, 2.9554768188574725, 7.00137664815434, 7.00137664815434, 1.1208658784962342, 1.1208658784962342, 6.164207466465113, 6.164207466465113, 3.550082691687389, 3.550082691687389, -0.79575945577229, -0.79575945577229, 3.602349283137499, 3.602349283137499, 7.791072632307745, 7.791072632307745, 3.627877349864441, 3.627877349864441, 3.7386425151390275, 3.7386425151390275, 6.816651900632522, 6.816651900632522, 3.7928273343966397, 3.7928273343966397, 6.502060159315384, 6.502060159315384, 6.9278240868203715, 6.9278240868203715, 6.9336781831066405, 6.9336781831066405, 8.295463530309801, 8.295463530309801, -4.4835768370762015, -4.4835768370762015, 1.2999210092022562, 1.2999210092022562, 11.82685778862186, 11.82685778862186, 12.291811205185395, 12.291811205185395, 1.332885282561385, 1.332885282561385, 11.336374468112849, 11.336374468112849, 3.92255750595702, 3.92255750595702, 6.220457671984155, 6.220457671984155, 4.392502655279387, 4.392502655279387, 12.386877117378374, 12.386877117378374, 7.355612503256716, 7.355612503256716, 7.723532084792751, 7.723532084792751, 5.114109138230201, 5.114109138230201, 6.7365239972577395, 6.7365239972577395, 4.694590139848813, 4.694590139848813, 8.57328257343947, 8.57328257343947, 7.010933044466923, 7.010933044466923, 9.397239409713174, 9.397239409713174, 10.094592553016826, 10.094592553016826, 6.958912369874937, 6.958912369874937, 10.534052999141739, 10.534052999141739, 5.686173365528665, 5.686173365528665, 5.727731415277945, 5.727731415277945, 11.070084508394856, 11.070084508394856, 10.320734849299154, 10.320734849299154, 7.398011485272097, 7.398011485272097, 7.237084152225526, 7.237084152225526, 9.787225648148437, 9.787225648148437, 7.7662486371547255, 7.7662486371547255, -3.6714198045872264, -3.6714198045872264, 10.800924145671772, 10.800924145671772, 6.844198124115613, 6.844198124115613, 4.657663114999722, 4.657663114999722, 4.922429579510744, 4.922429579510744, 8.048432078055011, 8.048432078055011, 6.997880468975086, 6.997880468975086, 6.785279577247096, 6.785279577247096, 6.06049154774394, 6.06049154774394, 12.407182620626314, 12.407182620626314, 1.3929559919164294, 1.3929559919164294, 10.814822656802324, 10.814822656802324, 7.435827688952918, 7.435827688952918, 3.7404668707298923, 3.7404668707298923, 13.63765373779411, 13.63765373779411, -0.7126321606815224, -0.7126321606815224, 0.21652166050513555, 0.21652166050513555, 4.556575526642631, 4.556575526642631, 7.69247017965089, 7.69247017965089, 16.628904568789526, 16.628904568789526, 8.97617008937503, 8.97617008937503, 1.7962335370966536, 1.7962335370966536, 9.49807251220058, 9.49807251220058, 11.526091999461407, 11.526091999461407, 14.18574387615733, 14.18574387615733, 12.435669658675474, 12.435669658675474, 7.3713681457635385, 7.3713681457635385, 5.164004454652042, 5.164004454652042, 9.718558000348347, 9.718558000348347, -0.5545955884533958, -0.5545955884533958, 3.8873394322408417, 3.8873394322408417, 7.0456560609701935, 7.0456560609701935, 3.0124189124226364, 3.0124189124226364, 5.054900006145598, 5.054900006145598, 7.879232494854547, 7.879232494854547, 3.7746344636689604, 3.7746344636689604, 3.170123799286827, 3.170123799286827, 5.534122844504124, 5.534122844504124, 5.443926623761758, 5.443926623761758, 4.00772292987666, 4.00772292987666, 4.517962709469183, 4.517962709469183, 8.077184743614332, 8.077184743614332, 4.999048744427367, 4.999048744427367, 1.6091938648955342, 1.6091938648955342, 8.918049733034017, 8.918049733034017, 2.249425088226466, 2.249425088226466, 8.598729656528617, 8.598729656528617, 6.159003374528109, 6.159003374528109, 6.598703219844947, 6.598703219844947, 8.333412338235027, 8.333412338235027, 1.1405972425273054, 1.1405972425273054, 6.38030351739811, 6.38030351739811, 2.155422463148258, 2.155422463148258, 4.659986983655449, 4.659986983655449, 5.649222572294661, 5.649222572294661, 10.646479648190187, 10.646479648190187, 3.5106908181751617, 3.5106908181751617, 0.3521993232173456, 0.3521993232173456, 6.816050189972091, 6.816050189972091, 5.599191529506573, 5.599191529506573, 5.8483241690381735, 5.8483241690381735, 4.662569783791852, 4.662569783791852, 2.253217749096408, 2.253217749096408, 11.304445153242767, 11.304445153242767, 18.264890421431907, 18.264890421431907, 0.03430266435688681, 0.03430266435688681, 3.722331745604307, 3.722331745604307, 12.519424026653677, 12.519424026653677, 1.802151557137992, 1.802151557137992, 2.5591794332770976, 2.5591794332770976, 7.513668270930257, 7.513668270930257, 2.534536867613829, 2.534536867613829, 1.8751219704521387, 1.8751219704521387, 4.6306833149562046, 4.6306833149562046, 3.1794738845266552, 3.1794738845266552, 2.193245628082542, 2.193245628082542, 9.007762496152782, 9.007762496152782, 19.110644669543927, 19.110644669543927, 7.907340590520769, 7.907340590520769, 10.359783305639663, 10.359783305639663, 8.651733664416875, 8.651733664416875, 6.471733540798444, 6.471733540798444, 17.810932100666967, 17.810932100666967, 3.6864672256181907, 3.6864672256181907, 9.545982093496843, 9.545982093496843, 6.056262150221552, 6.056262150221552, 1.3083068784086171, 1.3083068784086171, 24.111561697954674, 24.111561697954674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34242750517227877, "mean_inference_ms": 2.2526442022431947, "mean_action_processing_ms": 0.09849652932968532, "mean_env_wait_ms": 0.5918592028594594, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 158625, "timesteps_this_iter": 0, "agent_timesteps_total": 475875, "timers": {"sample_time_ms": 13011.965, "sample_throughput": 259.377, "load_time_ms": 0.296, "load_throughput": 11392978.672, "learn_time_ms": 2109.548, "learn_throughput": 1599.869, "update_time_ms": 26.628}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 15.074257087707519, "policy_loss": -0.012100795935839414, "vf_loss": 15.094586658477784, "vf_explained_var": -0.023115098476409912, "kl": 0.003004576614841559, "entropy": 0.8228445470333099, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 4.642800974845886, "policy_loss": 0.018264656024985015, "vf_loss": 4.632614636421204, "vf_explained_var": 0.26887530982494356, "kl": 0.006838993813094529, "entropy": 0.8121059447526932, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 158625, "num_agent_steps_sampled": 475875, "num_steps_trained": 158625, "num_agent_steps_trained": 475875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6345, "training_iteration": 47, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-58-06", "timestamp": 1706108286, "time_this_iter_s": 13.254795789718628, "time_total_s": 629.7712314128876, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A012790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 629.7712314128876, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.0235294117647, "ram_util_percent": 67.83529411764707, "gpu_util_percent0": 0.1111764705882353, "vram_util_percent0": 0.23246495863970587}}
{"episode_reward_max": 13.362311018566892, "episode_reward_min": -18.708696331066644, "episode_reward_mean": 0.1564319640985241, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.827100097403914, "policy_agent_": -2.5946633090883844}, "policy_reward_max": {"policy_adversary_": -3.8047713688848, "policy_agent_": 17.20167570513883}, "policy_reward_mean": {"policy_adversary_": -12.432471068841748, "policy_agent_": 6.294451516470137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1796147224724722, 1.0601517740716682, -0.05967330835950273, 0.327647433259492, -10.977499993889372, -0.17088939930143576, -4.641189990241065, -0.6038410044886837, 1.6956948522009667, -4.151382925333634, -8.526039876877919, 5.8962819835059985, 1.043879246805682, 0.12708825743995228, -1.6674528547521161, -3.193204944131466, -8.207332899581415, 6.216622825804706, -11.995797979510874, 1.1807136219272898, 0.7430522904941544, -11.175328091748547, -1.7332973076704814, 4.080242480956238, -6.643150551123148, -0.06179486590326033, 2.1687054116961955, 0.29024046598668946, 7.810119845921731, -4.079533950693761, 7.505520508089338, 2.7227291484326286, 4.663120220466732, -1.8866441313846178, 10.05364743331172, 7.495829632583381, -0.5371941549219119, -3.5469247808976077, -8.816328439205412, 2.8096366439297937, 1.5687905364452552, -0.07580546910457975, 7.518655531010125, 1.9891595965394482, 2.5287513045420296, 5.869528824409156, -8.484124668519854, -6.4709948533174915, 0.8362335105549292, -2.7885609740202932, -0.9717656717081945, 0.6009201898579952, 0.3840303417129848, -4.572220790273355, -1.5712832175676312, 2.7417565332056206, -16.150768582431695, 5.022517531872103, -0.0202413245502074, 3.924073885795581, 1.6022545606215628, -0.6361848921255662, -12.048945755826837, -0.42945207551630693, -6.850563794617562, 2.4636728128978724, -2.4134302372234857, 11.623297599858754, 0.6259188194054551, 9.926811791520521, -5.169669021534297, 5.3722552684633715, -2.2472513183924967, -7.805319660425179, -0.824122516485357, 5.490061039538956, 1.3761708495002205, -1.0168221737930376, 1.4060932146294454, 4.565127580842448, -0.5785269449948003, 6.939216874812985, -3.9208875821058937, 9.09083768562704, -3.739225288589543, -3.7379055770199145, 5.220070284268042, 7.592045048211755, -18.708696331066644, -1.6617722842524687, 4.818931552176941, 7.627419585636915, 6.907055348081125, -8.693743922094422, 6.38081932085767, -5.33345617565852, 7.158373322163039, 2.6410314084296793, -5.426119264563577, -0.8770889472033219, 5.186467350203792, -11.801880301716462, 6.241573673844142, -1.0041703083819669, 8.659235217227604, 6.533532782682779, 10.818830512316115, 13.362311018566892, -0.6341663907357622, -1.4151595456449453, -13.04242931492999, 0.3617781930817019, -1.4011035390746307, 3.3625190873001767, 2.008071166090579, -1.6362093652809437, 6.85600842472655, 7.379289592972275, 2.2175830937378054, -3.9559777705139894, 1.332027237406511, 1.2958639024991643, -0.04239532742055707, -6.485778765122297, 0.5780027301652154, 0.7334125519253821, -4.114963745610487, -2.86257615757325, -2.9977712247563977, 8.452070557910858, -3.1915982739689763, 7.587547306267483, -2.594052903239451, -0.7285629978782089, 1.0780168983769465], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.842543492268586, -18.757582056510877, -6.150574751548061, -13.100617792811006, -10.452593192808312, -13.820611381339532, -10.928520023914457, -5.568630679997286, -8.491274162545034, -12.125248612925834, -17.873695349912563, -15.618427652737973, -8.765136653530664, -12.80982924760199, -6.138513529769898, -9.466824797765897, -17.409324008085502, -16.86817909079214, -15.48048591684116, -9.64566241610546, -14.829618558911147, -10.365870911360977, -5.899093904249414, -10.100393590597108, -5.609626144377397, -8.071654870641686, -9.505282051335625, -11.854565252579828, -17.720762866823826, -3.942994203307794, -20.547694793349553, -10.480205181936334, -13.60886385882119, -9.408167752865191, -20.809313673566972, -14.16638448712884, -3.8047713688848, -6.660671083805878, -6.1081926605207855, -17.376482995564324, -8.527722630967165, -7.718511050989192, -13.105622692915304, -16.261813300726168, -18.768291419780493, -15.297833542763039, -8.393309103626667, -11.566053573761803, -12.184889475367669, -8.924779131367483, -9.29381445875291, -9.285200279338122, -11.511682593781158, -7.101402884312095, -11.74136903065926, -13.996300350207346, -10.961441964254915, -16.916086658432857, -5.239740176738144, -13.812166480502471, -10.04325889393571, -9.559759303364844, -18.19005323017454, -13.569622023304351, -8.912683989436367, -15.151500083678059, -6.940896443273778, -17.483244465645555, -6.771010769666703, -14.813406381209141, -9.837143299364305, -19.60258642298326, -28.827100097403914, -11.09460050934578, -15.403595888336602, -16.48924617754055, -9.065529878603785, -11.10956522691344, -9.989119136178742, -13.205582876558246, -8.324951620781897, -14.502900750769562, -6.817710750653141, -18.2354225781641, -5.612230171010639, -8.489477993881087, -11.548800750968779, -19.55165759314286, -25.45733579012715, -9.781211864094274, -11.252020021284025, -12.983757109524243, -15.77546379213649, -13.153789939696447, -22.34799148298872, -21.42701253418512, -17.057909048878162, -10.331370909396604, -6.258302824063436, -15.55742808477487, -11.899981375436068, -16.671214803487448, -19.096620105835573, -13.561438735936896, -17.758962415922213, -14.119799846998985, -22.06146204657287, -21.04104039171077, -5.76712664984957, -8.658471870407896, -12.174401390798444, -11.329443742989563, -5.666078915326273, -15.670233022421053, -10.880657147985831, -7.842290907878553, -20.007890705149645, -12.987565524605342, -9.342008903655179, -9.365610785528865, -15.833114986364436, -10.055390116485846, -15.524383509562256, -15.11052706609817, -11.403678697788752, -10.492005367052538, -10.50308857061923, -4.585798702765587, -11.177029241495733, -15.064421580771038, -13.479568160199095, -11.277300616282727, -14.495301601831569, -6.874009551751445, -9.286510708946308], "policy_policy_agent__reward": [8.511079107370527, 8.511079107370527, 9.908866915291274, 9.908866915291274, 3.0454507215942788, 3.0454507215942788, 6.714132613035249, 6.714132613035249, -0.26245340054053173, -0.26245340054053173, 6.8248609910190465, 6.8248609910190465, 3.1436650168366973, 3.1436650168366973, 2.4823948377543004, 2.4823948377543004, 5.093484507373002, 5.093484507373002, 3.9869328437961, 3.9869328437961, 4.673827736517319, 4.673827736517319, 10.757354818121986, 10.757354818121986, 4.904507950168172, 4.904507950168172, 6.468458752520972, 6.468458752520972, 2.2355303375088904, 2.2355303375088904, 3.1368099268172145, 3.1368099268172145, 4.600995554252044, 4.600995554252044, 11.542400958298424, 11.542400958298424, 1.7423439686651434, 1.7423439686651434, 5.413188019016373, 5.413188019016373, 7.78633542470265, 7.78633542470265, -0.4047285901937833, -0.4047285901937833, 2.082898298289466, 2.082898298289466, 7.090318035776673, 7.090318035776673, -0.516762203372876, -0.516762203372876, 4.004930002369212, 4.004930002369212, 5.83699373151591, 5.83699373151591, 6.072402859283259, 6.072402859283259, 12.765441356372778, 12.765441356372778, -0.06826987369298343, -0.06826987369298343, 14.026607650719441, 14.026607650719441, 6.60146716518448, 6.60146716518448, 9.135992039643961, 9.135992039643961, 3.7607618107402865, 3.7607618107402865, 15.431480553439348, 15.431480553439348, 10.831107059856114, 10.831107059856114, 1.6337886069814433, 1.6337886069814433, 1.556873151454135, 1.556873151454135, -1.3540678893423084, -1.3540678893423084, 10.09305981974706, 10.09305981974706, 5.04825658370621, 5.04825658370621, 3.821352790942306, 3.821352790942306, 10.312139111962718, 10.312139111962718, 9.125486448632806, 9.125486448632806, 10.64852136216126, 10.64852136216126, 10.58368118358609, 10.58368118358609, -0.045407782446591466, -0.045407782446591466, 2.5475293602221565, 2.5475293602221565, 6.510561492961298, 6.510561492961298, 3.068109078673596, 3.068109078673596, 4.161024393522359, 4.161024393522359, 4.943060234598061, 4.943060234598061, 5.947856467747073, 5.947856467747073, 1.26459104701937, 1.26459104701937, 5.085042906545816, 5.085042906545816, 8.369028441706485, 8.369028441706485, -2.5946633090883844, -2.5946633090883844, 10.969302095152488, 10.969302095152488, 2.6097494260939675, 2.6097494260939675, 8.86812018314903, 8.86812018314903, 5.8227567272786365, 5.8227567272786365, 4.46178720561964, 4.46178720561964, 3.0705537371738494, 3.0705537371738494, 6.570084973894022, 6.570084973894022, 1.031060097409404, 1.031060097409404, 8.807586448287969, 8.807586448287969, 2.2637331030251464, 2.2637331030251464, 14.553271032752152, 14.553271032752152, 3.6984647945360796, 3.6984647945360796, 12.370109086364828, 12.370109086364828, 2.333737138915004, 2.333737138915004, 12.487420845723321, 12.487420845723321, 13.289924389505707, 13.289924389505707, 1.644640424460296, 1.644640424460296, 7.289736685925622, 7.289736685925622, 10.98965360853975, 10.98965360853975, 5.220850364052003, 5.220850364052003, 5.046371526560202, 5.046371526560202, 5.697606175404094, 5.697606175404094, 8.885355228700346, 8.885355228700346, 3.8732123378935475, 3.8732123378935475, 10.721058812791274, 10.721058812791274, 1.4484115842736227, 1.4484115842736227, 13.663130131895567, 13.663130131895567, 0.9365024412105475, 0.9365024412105475, 2.3757862084305854, 2.3757862084305854, 8.38443551761841, 8.38443551761841, 13.571851320677304, 13.571851320677304, 3.3743197295302583, 3.3743197295302583, 4.059719789920902, 4.059719789920902, 8.03547578673048, 8.03547578673048, 10.30558834758058, 10.30558834758058, 11.34125957010881, 11.34125957010881, 2.2300230088010125, 2.2300230088010125, 14.364405401923191, 14.364405401923191, 8.046778179263304, 8.046778179263304, 12.1081411855206, 12.1081411855206, 6.4862011589131425, 6.4862011589131425, 0.4160917797499289, 0.4160917797499289, 7.340169568785774, 7.340169568785774, 8.543224362819933, 8.543224362819933, 2.434667250885492, 2.434667250885492, 12.669096889839857, 12.669096889839857, 6.278634213777464, 6.278634213777464, 13.209098816574912, 13.209098816574912, 10.326666314840882, 10.326666314840882, 16.44014627944449, 16.44014627944449, 17.20167570513883, 17.20167570513883, 2.5664801295569024, 2.5664801295569024, 3.6216561623814743, 3.6216561623814743, -0.4340139620657722, -0.4340139620657722, 5.845610968035632, 5.845610968035632, 2.132487688125822, 2.132487688125822, 9.516376054860615, 9.516376054860615, 6.444364157038206, 6.444364157038206, 3.1030407712988044, 3.1030407712988044, 13.4319495649381, 13.4319495649381, 10.183427558788813, 10.183427558788813, 5.779795998696493, 5.779795998696493, 2.704816507507437, 2.704816507507437, 8.582571111885473, 8.582571111885473, 5.675627009492507, 5.675627009492507, 7.740994091070849, 7.740994091070849, 4.31237415048794, 4.31237415048794, 5.990840713976983, 5.990840713976983, 5.612708959488958, 5.612708959488958, 3.19406241250437, 3.19406241250437, 0.8616112725961684, 0.8616112725961684, 4.089629008369667, 4.089629008369667, 11.758246069340947, 11.758246069340947, 5.1439849431150595, 5.1439849431150595, 9.432423961275106, 9.432423961275106, 5.950624349296059, 5.950624349296059, 3.0727232769366184, 3.0727232769366184, 5.182263803661628, 5.182263803661628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3418732509449744, "mean_inference_ms": 2.2495753608715243, "mean_action_processing_ms": 0.09844542699031791, "mean_env_wait_ms": 0.5910094227928078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 162000, "timesteps_this_iter": 0, "agent_timesteps_total": 486000, "timers": {"sample_time_ms": 13044.359, "sample_throughput": 258.733, "load_time_ms": 0.199, "load_throughput": 16922625.224, "learn_time_ms": 2125.205, "learn_throughput": 1588.082, "update_time_ms": 28.423}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 15.431055736541747, "policy_loss": -0.005281189877132419, "vf_loss": 15.444535732269287, "vf_explained_var": -0.03965871334075928, "kl": 0.0066552392907470725, "entropy": 0.81990567445755, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 4.365954530239105, "policy_loss": -0.0005394276231527328, "vf_loss": 4.37468341588974, "vf_explained_var": 0.3053386867046356, "kl": 0.007821734492552013, "entropy": 0.8238320231437684, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 162000, "num_agent_steps_sampled": 486000, "num_steps_trained": 162000, "num_agent_steps_trained": 486000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6480, "training_iteration": 48, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-58-18", "timestamp": 1706108298, "time_this_iter_s": 12.67150068283081, "time_total_s": 642.4427320957184, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E062B08B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 642.4427320957184, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.6625, "ram_util_percent": 67.78125, "gpu_util_percent0": 0.12187500000000001, "vram_util_percent0": 0.23052978515625}}
{"episode_reward_max": 15.194736477101205, "episode_reward_min": -15.731075759779724, "episode_reward_mean": 0.8463479341285278, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.092376669958647, "policy_agent_": -0.1724765205329324}, "policy_reward_max": {"policy_adversary_": -4.877605747882185, "policy_agent_": 19.655884075379884}, "policy_reward_mean": {"policy_adversary_": -12.725952627755587, "policy_agent_": 6.786150280942059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.537490677370982, -7.555617601102723, 6.77758688644286, 8.257021016406261, -1.6011150707493909, -0.050213296830628584, -2.378853872194257, 2.55144714114955, 14.776987247447444, 3.0694880639485667, 2.696226697671493, 6.5764705141365924, 1.587925090668843, 10.371925745925079, 1.809944996552684, 4.846855966613019, -4.019350649536854, 10.859436079072928, -0.803960757987875, 0.3452527275356307, 2.204408646196892, -3.3407880391118954, 0.3124737193942481, -6.11855035767072, 2.840815440501293, 7.2283223654188555, -1.2264803997464102, -13.872831638067527, -3.9192646760690355, -3.320493862269173, -15.731075759779724, -1.1734940607518742, 4.0222195641844225, 4.631781451922553, 11.789443393153936, 5.743401006123762, 3.9820494968990183, -3.20535699766183, 1.685020069549699, 0.8779136908248615, 15.194736477101205, 3.8516448414401108, 2.068905890300717, -3.2883499990565657, -0.8546203305896207, 3.0194763854447677, 1.7681235221474847, -0.5915820873893035, 0.5528429124669922, 4.973090948897175, 3.1440154290268145, -1.7758791102933635, 5.280321033242728, 4.711356379844434, 1.79747814974248, 2.7594627766473665, 2.3850286571478754, -0.7852807077615644, 0.23973398829066078, 2.065609553064108, 5.55213580133443, -0.9804908973567142, 0.34761354893692, 0.8847447355694413, 0.6572819263082559, 0.8523379103952076, -2.300873938624383, 7.189930698096614, -4.643406444145741, -2.025714466316752, -5.42069836425104, -6.776503079997622, 8.6762110402253, -9.517378517547668, -4.294686865507147, 0.3991054732368453, -0.05899492897334191, 5.257137552360324, -2.935828638942797, 0.9750554755728043, -2.7590840532266174, 5.080560414333603, 9.980377008080298, 3.1466427536450263, -5.0888031218893985, 1.7016806189091245, -4.860196018551223, 5.389164271237658, -4.061200661693848, 0.6609271613362513, -6.007938941197644, -2.009182227416799, -1.7689913027268744, 1.774848608105387, 4.846290297918428, -2.9911975836641056, 0.5027311327145585, 3.0297754321416144, -4.161509424279397, 10.444450917179482, -9.095794908071573, -0.022782563831987013, -5.133549936550559, 3.0757603839693273, 12.250894044230213, -3.829616749999027, 2.14322196208449, 0.5623704252200843, 2.611367407809852, -5.556101819242911, -2.8774723664870656, -0.5862965823799834, 1.5757370922897778, -1.1118146085397451, -1.8407522533498266, 2.8895831586844594, 6.042847874442709, -0.013969972739976466, 12.752753538847022, 5.208658290070696, 9.36204822617512, -4.704753368400385, 0.5792843822331402, -0.25695067780099234, -0.4013949885531587, -6.3009977766227845, -2.379930379398457, 6.080528429367386, -0.17271252768318912, 3.2810844820177203, 3.0403488863035832, 8.516393682726669, -4.7895805055243885, -0.01790331049913446, -5.815453175328397], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.192537636305113, -15.495459509740142, -16.635991009732205, -17.2406046762765, -12.73521678881357, -9.160722200823045, -10.651632800350548, -8.292795642557266, -19.972547427908466, -16.675866358810694, -8.26273522596979, -13.691766683084172, -11.402317876522371, -16.135266732885654, -10.825937880324487, -20.985600655391377, -6.344786930437941, -19.037614104143376, -7.620514870022869, -7.271199073915251, -14.207122040827555, -10.085833250658695, -7.894012877878688, -11.309764216867386, -13.088225839937985, -18.543528656196298, -8.737682725336139, -19.59435670728273, -11.319425509751428, -12.268746341370175, -15.90253552254862, -21.598608398976562, -11.80374234223285, -11.973410102922175, -18.65370033091928, -20.166927185725502, -12.031378464175905, -27.092376669958647, -12.879959788829854, -5.932854827425358, -24.117031673658555, -10.90548118991102, -9.328111660965108, -4.920814767148878, -13.943492309300789, -12.997711588402971, -9.095635689123055, -12.090654967681072, -9.790650506430447, -11.26151950332576, -13.84308042944931, -13.751279555723146, -11.523408937759203, -12.775571600207403, -7.82601012220932, -7.502040184018847, -14.329717749652024, -16.32445129916247, -14.275218333518367, -12.238083069394252, -26.555951541495123, -10.012334822563437, -15.5559812342606, -15.66183929264917, -7.872678185870118, -13.012894698673277, -13.956411395153205, -14.71629547887402, -6.339921086073335, -9.376208455293902, -9.191575158491986, -12.236038293587038, -17.44784453622194, -11.12848609884713, -6.123603330673442, -11.168913183805135, -9.912002430901577, -12.205866534714806, -7.755886177438762, -16.5288130569586, -9.15019341710564, -18.905624097332097, -21.875025380052545, -9.260223686758629, -10.940889138991327, -18.073468659702534, -13.62174076512001, -12.841194627061569, -9.06442571674163, -9.877371868690673, -15.903353997837437, -13.283138214944609, -11.15211359489565, -12.370488095043045, -11.641108410285918, -7.496479525281812, -11.220385472734122, -8.360874328366567, -9.10884565195672, -17.195843108457826, -24.797429239632056, -9.61294547836643, -9.033529893360202, -13.895257832463889, -15.306930859271153, -12.72641181177387, -9.427490932101712, -8.384510383769522, -7.390983954196619, -18.86265759959523, -14.466318711830848, -7.9079077034662, -10.991224407798072, -13.820275344178043, -6.045932235381571, -6.792473801117368, -13.357051108833152, -10.672703955053473, -19.27133673125987, -14.929652990068165, -18.865956280489215, -9.49227176132137, -13.809781369348704, -14.417296789320815, -7.237641543596718, -13.872475287832083, -6.075587350300369, -15.424261292455078, -4.877605747882185, -12.11241519026112, -9.958375225279502, -25.528377260875512, -12.042932896382109, -10.113055864707675, -8.824942142648952], "policy_policy_agent__reward": [-0.1724765205329324, -0.1724765205329324, 3.9699209543187104, 3.9699209543187104, 11.706788948087532, 11.706788948087532, 12.748812846341378, 12.748812846341378, 5.567050859032088, 5.567050859032088, 4.555254451996209, 4.555254451996209, 4.136389464078147, 4.136389464078147, 5.422121391853409, 5.422121391853409, 17.374767337677955, 17.374767337677955, 9.872677211379635, 9.872677211379635, 5.4794809618206415, 5.4794809618206415, 10.13411859861038, 10.13411859861038, 6.495121483595607, 6.495121483595607, 13.253596239405365, 13.253596239405365, 6.317941438438585, 6.317941438438585, 12.916228311002202, 12.916228311002202, 1.1627181404505422, 1.1627181404505422, 14.948525091608158, 14.948525091608158, 3.4082770560174955, 3.4082770560174955, 3.808225900725442, 3.808225900725442, 8.205765343512223, 8.205765343512223, 3.3725226057733995, 3.3725226057733995, 4.1032432986364675, 4.1032432986364675, 2.595606929598334, 2.595606929598334, 7.964520640219638, 7.964520640219638, 12.88592551080758, 12.88592551080758, 3.7556011627948633, 3.7556011627948633, 2.8607625346076047, 2.8607625346076047, 3.700080416841196, 3.700080416841196, 4.474126239550504, 4.474126239550504, 0.08572988138444756, 0.08572988138444756, 10.212557169112348, 10.212557169112348, 7.912980953208637, 7.912980953208637, 8.302595777422361, 8.302595777422361, 15.221571862036607, 15.221571862036607, 12.955164095924633, 12.955164095924633, 8.006713980537462, 8.006713980537462, 11.943509836148408, 11.943509836148408, 7.2824899291897776, 7.2824899291897776, 3.4053842591251087, 3.4053842591251087, 19.655884075379884, 19.655884075379884, 7.3785630156755655, 7.3785630156755655, 5.69850877563291, 5.69850877563291, 0.816232384046156, 0.816232384046156, 6.544435989355584, 6.544435989355584, 8.008593986923872, 8.008593986923872, 5.431879605635271, 5.431879605635271, 5.749536440145888, 5.749536440145888, 5.171746709448721, 5.171746709448721, 8.11730522611147, 8.11730522611147, 8.493547929238064, 8.493547929238064, 5.987700222714891, 5.987700222714891, 8.401864985500966, 8.401864985500966, 8.743463990025917, 8.743463990025917, 4.8117441359759, 4.8117441359759, 5.130751480333103, 5.130751480333103, 8.35737320339995, 8.35737320339995, 7.769585295700451, 7.769585295700451, 7.257476160904516, 7.257476160904516, 7.151846311229176, 7.151846311229176, 16.054043671414775, 16.054043671414775, 4.515921962603363, 4.515921962603363, 7.951797391598761, 7.951797391598761, 8.273292014109305, 8.273292014109305, 4.264980056089187, 4.264980056089187, 6.932616304534242, 6.932616304534242, 5.827768728264413, 5.827768728264413, 10.95311308848532, 10.95311308848532, 0.8482573209637984, 0.8482573209637984, 3.6752469944885746, 3.6752469944885746, 1.885438397120473, 1.885438397120473, 2.7297676067947103, 2.7297676067947103, 13.062027788223617, 13.062027788223617, 0.8055537906497289, 0.8055537906497289, 0.9144582325831485, 0.9144582325831485, 5.7840093285209875, 5.7840093285209875, 4.926503750964119, 4.926503750964119, 8.731502043537562, 8.731502043537562, 2.41002876924798, 2.41002876924798, 8.751934266265703, 8.751934266265703, 3.1955546819395133, 3.1955546819395133, 11.993092255832853, 11.993092255832853, 15.92770119406642, 15.92770119406642, 6.203433220201827, 6.203433220201827, 2.926043008550964, 2.926043008550964, 9.887574639305829, 9.887574639305829, 4.380772373284395, 4.380772373284395, 9.115179449149615, 9.115179449149615, 2.501612527523891, 2.501612527523891, 5.269149515013461, 5.269149515013461, 4.947707528319892, 4.947707528319892, 5.636977993763903, 5.636977993763903, 4.691561146084386, 4.691561146084386, 7.072668351574219, 7.072668351574219, 8.243699354102175, 8.243699354102175, 2.252640970808852, 2.252640970808852, 5.861558302724341, 5.861558302724341, 5.695324880254091, 5.695324880254091, 2.473668113838661, 2.473668113838661, 13.820147012818657, 13.820147012818657, 7.85081716578024, 7.85081716578024, 4.795081457267223, 4.795081457267223, 1.9499899784048238, 1.9499899784048238, 8.48550910821661, 8.48550910821661, 13.77891245175068, 13.77891245175068, 4.448397530887422, 4.448397530887422, 5.785356447093102, 5.785356447093102, 4.473440404494804, 4.473440404494804, 5.001175681003235, 5.001175681003235, 6.653277890176158, 6.653277890176158, 5.794423172671892, 5.794423172671892, 3.6608055605431096, 3.6608055605431096, 6.283480750043923, 6.283480750043923, 6.354230367819148, 6.354230367819148, 2.102589991015872, 2.102589991015872, 4.841028479900915, 4.841028479900915, 9.699949491637934, 9.699949491637934, 5.329366991156747, 5.329366991156747, 16.01204513505344, 16.01204513505344, 10.069155640069427, 10.069155640069427, 14.114002253332167, 14.114002253332167, 2.3937591964604925, 2.3937591964604925, 7.194532875790921, 7.194532875790921, 7.0801730557599125, 7.0801730557599125, 3.4181232775217794, 3.4181232775217794, 3.7857387556046493, 3.7857387556046493, 1.8478284854509566, 1.8478284854509566, 10.752394860911233, 10.752394860911233, 2.352446610099499, 2.352446610099499, 7.696749836139421, 7.696749836139421, 6.499362055791542, 6.499362055791542, 17.022385471801098, 17.022385471801098, 3.626676195428861, 3.626676195428861, 5.0475762771042705, 5.0475762771042705, 1.504744483660276, 1.504744483660276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3421717554335151, "mean_inference_ms": 2.2532307463887515, "mean_action_processing_ms": 0.0984473048080838, "mean_env_wait_ms": 0.5919492519202256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 165375, "timesteps_this_iter": 0, "agent_timesteps_total": 496125, "timers": {"sample_time_ms": 13129.629, "sample_throughput": 257.052, "load_time_ms": 0.299, "load_throughput": 11283098.996, "learn_time_ms": 2217.041, "learn_throughput": 1522.3, "update_time_ms": 30.501}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 16.001769256591796, "policy_loss": -0.0031474478938434912, "vf_loss": 16.013261604309083, "vf_explained_var": -0.037909281253814694, "kl": 0.004755013979866507, "entropy": 0.8345367193222046, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 4.631074559688568, "policy_loss": -0.004647603817284107, "vf_loss": 4.6437306761741635, "vf_explained_var": 0.3205807089805603, "kl": 0.007879242614193227, "entropy": 0.8057711631059646, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165375, "num_agent_steps_sampled": 496125, "num_steps_trained": 165375, "num_agent_steps_trained": 496125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6615, "training_iteration": 49, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-58-34", "timestamp": 1706108314, "time_this_iter_s": 15.038865566253662, "time_total_s": 657.481597661972, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0691C9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 657.481597661972, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 45.31, "ram_util_percent": 67.775, "gpu_util_percent0": 0.153, "vram_util_percent0": 0.2349853515625}}
{"episode_reward_max": 15.096257656738485, "episode_reward_min": -17.00468192485168, "episode_reward_mean": 0.23778534040948227, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.293005909849867, "policy_agent_": -3.0824356232244647}, "policy_reward_max": {"policy_adversary_": -3.0232408809739924, "policy_agent_": 17.75569749367442}, "policy_reward_mean": {"policy_adversary_": -12.355458354976431, "policy_agent_": 6.296621847692958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.193854555241508, -8.518051563960837, 5.588080071419209, -8.72401574469161, 5.87753559259715, 2.377646034474097, -0.819120575694139, 15.096257656738485, 8.18225204750061, -9.515056573406694, -10.417150028539371, 2.777226604531053, 0.288373949721513, 4.58015868726927, 2.2473792848352274, 1.7769453995449764, -2.3138598924029994, -7.784221594721871, -3.731080158109382, -1.7937356221749297, 8.823670583450962, -4.3201595869279945, 0.4409901608886653, 5.301723582497894, 2.993648653558534, 6.22319999815964, -0.2572598474309452, 6.356719666805498, 6.609258658271284, 6.7367282625035, 2.2053234614694723, -1.9439115944030108, 14.06092557584291, -5.522806928720478, 2.9718971874155917, -5.1821544411889855, 0.27190116866054936, -5.055344275731888, -2.214698650111335, -4.649172247730209, 4.076740969465418, -1.9174554183946166, 11.575980731991761, -0.4379979423066697, 7.892912666160243, 5.578756531640808, 4.978107577991736, 4.081595116521544, 8.432165827385461, -9.9246567288649, -1.138672367862127, 1.69723364410323, 2.056236186847303, 7.84108099740604, -0.5411608071791849, 11.951062362149813, 2.716951289736749, -7.951278943752448, -10.533685522515587, 0.7022180276907901, 4.5931073075521756, -0.44035655999146517, -1.6707625714452456, -17.00468192485168, 3.64568710794682, 0.2553926300147898, -9.575697917315077, -1.0740645586333202, -3.236174256214498, 8.101206823302888, -6.07293571814491, 10.235597536555197, 7.308679011141277, 8.237188717768623, 1.0621279025309591, 2.9684688373158874, -5.311486003283341, -5.79524935174854, -2.10778968926387, -7.123165789910638, 2.0647320258442385, -3.1494096052892395, 3.8668323298392453, 4.045092888064354, 3.3678386820661794, -1.0585421641564619, 2.296171127761415, -1.4908248906084234, -10.664785222681683, 9.623194259584217, -8.998699817748697, 3.8870359441739772, -4.680315438711662, 9.85020489666836, 3.375375955722091, 8.592703690110168, 5.99589897954908, -3.2860646739032884, -2.359709985021027, -2.4966203256096273, -3.7823919478465378, -5.116686833308689, -9.452382079368245, -1.9501733395461869, -7.078091448300038, -3.151872181420967, -4.15771191048765, 6.132918292435395, 0.549404883337529, 0.9891756470068487, -1.4433857111225978, -10.811612788743128, -2.723965580754742, -13.123206601033438, -2.813982283212791, 1.8868977446160218, 0.5115560210622037, 6.798014169775282, 6.363307981578526, -3.6887498088082085, 3.282905117809971, -6.175299452917727, -0.5075441479834479, 0.5980304932215232, 1.3679093788264594, 4.695892066402296, -10.646195218565625, 4.3382773162173365, 0.22712417230211357, 3.149640010695044, -6.006639657634359, -4.8892761042550985, -4.181524785948129, 5.185932494693232, 7.593495141912394], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.741840796247155, -14.751721794682522, -12.1273094835909, -15.137330004828765, -10.446364530858233, -8.655027985051223, -4.059912491585687, -20.41513733061033, -18.66135628381005, -20.230354484996585, -18.686855574982708, -16.83328117394038, -8.726462034942097, -14.548207929893623, -13.37430264426922, -13.843015829242571, -16.19220077059082, -27.293005909849867, -5.69621051691235, -8.316748118720064, -15.47597215890361, -16.770005554480747, -10.770379944044643, -13.625036693718837, -13.238814023053239, -13.217535133544034, -8.475160696508514, -14.875046322566153, -16.82010866891204, -12.093131253658116, -10.80243031212395, -20.166928740139554, -20.651670882889796, -11.482902101862544, -7.789844218798336, -6.346103756360486, -7.539871137001771, -7.695952130649577, -5.5653931759069595, -16.13307698791829, -11.541004077398012, -11.55105015992247, -21.3950123036601, -8.722819446322777, -15.543871399570552, -14.504777698406128, -15.387329168942948, -12.06961225750778, -17.0381134598962, -10.973019333845812, -9.097911755433076, -7.641015740440315, -8.644274095660789, -15.48380883142282, -7.975079705248727, -20.612017185883616, -7.364098990657817, -8.938458140343506, -22.668515171044906, -7.969303465623596, -16.423120442277906, -5.936828744647522, -12.676468808109155, -10.839810678402738, -10.88507066622767, -13.403864024969447, -15.225481486898426, -4.226942617980848, -6.304514371240608, -16.31439033715912, -8.988902026932248, -13.038543080695229, -17.59640532925294, -19.651051635907148, -9.141523647939612, -13.982013558570246, -3.0232408809739924, -23.017519950137046, -5.750856941591248, -9.484144532784017, -11.78765440789359, -12.179180606591299, -16.157006243260334, -9.587896856768227, -10.841464353965716, -8.343241257303664, -12.302965571646947, -10.714831850207965, -9.742533606323349, -15.587232645892652, -16.35112706540505, -13.976463227165464, -12.448349730039748, -20.220365986691526, -11.351220648167525, -13.657922258533313, -14.826379883677472, -10.296543948818874, -9.327017795083446, -10.563941654103473, -8.483549847366861, -5.026363119206341, -10.4568089739045, -6.874451406257587, -9.822926364714036, -18.019399661685377, -6.8356989104386585, -15.975452002548007, -14.180959507121747, -16.624645043645117, -7.398348402609133, -13.324392369024721, -10.192628464896137, -13.735459105063732, -11.239188336508269, -8.74479926282551, -6.559996963925362, -15.881746998143054, -14.627004102231584, -8.96208361840306, -12.6843366668774, -7.276946354915167, -11.103189623062713, -9.598643058216602, -8.950561922821723, -10.152976456770176, -15.35779224479773, -15.33995729890812, -12.700440214810493, -8.66479744512047, -11.264166605981169, -8.236726319977334, -7.119888078895698, -16.385483630592237, -19.617934209437447], "policy_policy_agent__reward": [7.967847675744333, 7.967847675744333, 3.1168351153608445, 3.1168351153608445, 8.857694777505055, 8.857694777505055, 3.206657130068576, 3.206657130068576, 8.161950061727689, 8.161950061727689, 5.51633700976266, 5.51633700976266, 1.6203959579457732, 1.6203959579457732, 17.75569749367442, 17.75569749367442, 13.421804165655328, 13.421804165655328, 5.357648955794942, 5.357648955794942, 4.1348527732216676, 4.1348527732216676, 9.805253889235718, 9.805253889235718, 4.507417992331805, 4.507417992331805, 9.564183308581446, 9.564183308581446, 7.810840964552223, 7.810840964552223, 7.809980614393774, 7.809980614393774, 6.939170439093913, 6.939170439093913, 9.754392157563998, 9.754392157563998, 0.9825651794014831, 0.9825651794014831, 3.2615062482725676, 3.2615062482725676, 12.149821371177287, 12.149821371177287, 6.224922983776373, 6.224922983776373, 5.605685052466653, 5.605685052466653, 9.463380138108366, 9.463380138108366, 8.116231338305887, 8.116231338305887, 9.720367565851838, 9.720367565851838, 4.108950424538786, 4.108950424538786, 10.615882994685828, 10.615882994685828, 11.714683663591664, 11.714683663591664, 9.414929758080806, 9.414929758080806, 6.5038768867967125, 6.5038768867967125, 9.111508572868269, 9.111508572868269, 17.35629822936635, 17.35629822936635, 2.980047586571034, 2.980047586571034, 5.380870703106964, 5.380870703106964, 0.5819746575857495, 0.5819746575857495, 3.9058861528311604, 3.9058861528311604, 1.3203039274588466, 1.3203039274588466, 1.675347262897813, 1.675347262897813, 5.741952370094039, 5.741952370094039, 7.808872523431715, 7.808872523431715, 4.816797370763927, 4.816797370763927, 16.485496517825926, 16.485496517825926, 4.142410752008054, 4.142410752008054, 11.718392032865397, 11.718392032865397, 10.041767115023475, 10.041767115023475, 10.182718373467344, 10.182718373467344, 8.075603687014661, 8.075603687014661, 12.735139643640835, 12.735139643640835, 0.5241813024904561, 0.5241813024904561, 3.979619693785474, 3.979619693785474, 4.669124692271773, 4.669124692271773, 5.3502551412540456, 5.3502551412540456, 11.662444914414431, 11.662444914414431, 3.7169594490347713, 3.7169594490347713, 16.281539774016707, 16.281539774016707, 5.040525140197282, 5.040525140197282, 0.49358959829553006, 0.49358959829553006, 6.067414824264657, 6.067414824264657, 4.335760746657193, 4.335760746657193, 10.50811387491504, 10.50811387491504, 2.7482360923280273, 2.7482360923280273, 5.502853118331953, 5.502853118331953, -3.0824356232244647, -3.0824356232244647, 7.265378887087244, 7.265378887087244, 6.829628327492115, 6.829628327492115, 2.8248917847916717, 2.8248917847916717, 1.5764390296737636, 1.5764390296737636, 1.5341700575130544, 1.5341700575130544, 12.207798580231003, 12.207798580231003, 1.4579831543936683, 1.4579831543936683, 11.637070308625214, 11.637070308625214, 12.452542170197107, 12.452542170197107, 13.94412017683789, 13.94412017683789, 5.101825775235286, 5.101825775235286, 8.475241197943067, 8.475241197943067, -1.1441225611546744, -1.1441225611546744, 8.611135299194256, 8.611135299194256, 1.8215336261636903, 1.8215336261636903, 1.180489371436687, 1.180489371436687, 6.926193216868914, 6.926193216868914, 4.514885500651031, 4.514885500651031, 10.011919286549793, 10.011919286549793, 6.816494872416289, 6.816494872416289, 7.104651518015949, 7.104651518015949, 3.6423495465736018, 3.6423495465736018, 7.299568349704183, 7.299568349704183, 4.612003479799771, 4.612003479799771, -0.46112580817916893, -0.46112580817916893, 12.605213452738436, 12.605213452738436, 3.6762136238281773, 3.6762136238281773, 8.93174958566972, 8.93174958566972, 3.8840171456640413, 3.8840171456640413, 15.03528544167994, 15.03528544167994, 7.363298301944806, 7.363298301944806, 11.125312974321739, 11.125312974321739, 10.411139431613273, 10.411139431613273, 3.505239637457794, 3.505239637457794, 3.48365390503121, 3.48365390503121, 4.033660664246922, 4.033660664246922, 2.3505789497601612, 2.3505789497601612, -0.045161857051175716, -0.045161857051175716, 0.502213447268129, 0.502213447268129, 2.4621390333556987, 2.4621390333556987, 1.372417458206998, 1.372417458206998, 7.433763740132202, 7.433763740132202, 1.3389934999755058, 1.3389934999755058, 11.054185147491701, 11.054185147491701, 7.365182195229637, 7.365182195229637, 8.806910345325983, 8.806910345325983, 2.9774813457432683, 2.9774813457432683, 1.2563897901407957, 1.2563897901407957, 3.734331442070698, 3.734331442070698, 0.30612625201514554, 0.30612625201514554, 4.212603026647739, 4.212603026647739, 5.315848503720769, 5.315848503720769, 3.535776492493783, 3.535776492493783, 11.339880583959168, 11.339880583959168, 10.495156041905057, 10.495156041905057, 2.636666904797426, 2.636666904797426, 7.983620892343687, 7.983620892343687, 0.5508234509987207, 0.5508234509987207, 5.297822737539632, 5.297822737539632, 5.098336775719063, 5.098336775719063, 5.15923565082409, 5.15923565082409, 7.424434261586238, 7.424434261586238, 2.3557985131160573, 2.3557985131160573, 9.839117307562727, 9.839117307562727, 6.463782193556306, 6.463782193556306, 5.907218727907756, 5.907218727907756, 2.628763474173405, 2.628763474173405, 1.6737251078611164, 1.6737251078611164, 1.469181646473783, 1.469181646473783, 10.785708062642739, 10.785708062642739, 13.605714675674923, 13.605714675674923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429792530861208, "mean_inference_ms": 2.2591567748561765, "mean_action_processing_ms": 0.0987757977217054, "mean_env_wait_ms": 0.5934063518104337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 168750, "timesteps_this_iter": 0, "agent_timesteps_total": 506250, "timers": {"sample_time_ms": 13390.783, "sample_throughput": 252.039, "load_time_ms": 0.199, "load_throughput": 16926672.247, "learn_time_ms": 2223.152, "learn_throughput": 1518.115, "update_time_ms": 30.603}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 14.951593208312989, "policy_loss": 0.003554501855978742, "vf_loss": 14.95657787322998, "vf_explained_var": -0.030063652992248537, "kl": 0.00343187674849878, "entropy": 0.8539163291454315, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 3.6715405583381653, "policy_loss": -0.007717294618487358, "vf_loss": 3.6874723196029664, "vf_explained_var": 0.3888601243495941, "kl": 0.004796196464794736, "entropy": 0.8244448363780975, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168750, "num_agent_steps_sampled": 506250, "num_steps_trained": 168750, "num_agent_steps_trained": 506250, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 9.627224870590918, "episode_reward_min": -4.079187496027625, "episode_reward_mean": 1.8749585213396103, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"policy_adversary_": -17.218141963416247, "policy_agent_": 1.2228469984488546}, "policy_reward_max": {"policy_adversary_": -6.524881492925336, "policy_agent_": 13.21300688375536}, "policy_reward_mean": {"policy_adversary_": -11.006986484191689, "policy_agent_": 6.440972502765651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.627224870590918, -0.2802546031299004, 1.4602395179410264, -2.6801821588416987, -4.079187496027625, 3.560771547168984, 3.651840765759708, -2.044878016845418, 2.00742671182937, 7.526584074950738], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.798788896919806, -8.770856443142609, -7.733008953026269, -10.017082397049835, -6.524881492925336, -13.064205268509724, -13.963764003871528, -8.328438029301374, -7.650697393754161, -17.218141963416247], "policy_policy_agent__reward": [13.21300688375536, 13.21300688375536, 4.245300920006354, 4.245300920006354, 4.596624235483649, 4.596624235483649, 3.6684501191040675, 3.6684501191040675, 1.2228469984488546, 1.2228469984488546, 8.312488407839353, 8.312488407839353, 8.807802384815622, 8.807802384815622, 3.1417800062279766, 3.1417800062279766, 4.829062052791763, 4.829062052791763, 12.372363019183496, 12.372363019183496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22815233207793825, "mean_inference_ms": 2.2570222497461327, "mean_action_processing_ms": 0.09939775048974027, "mean_env_wait_ms": 0.580379212520037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 6750, "training_iteration": 50, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-58-49", "timestamp": 1706108329, "time_this_iter_s": 15.57751178741455, "time_total_s": 673.0591094493866, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6D790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 673.0591094493866, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 45.09473684210526, "ram_util_percent": 68.9736842105263, "gpu_util_percent0": 0.08421052631578947, "vram_util_percent0": 0.23104697779605263}}
{"episode_reward_max": 16.320400720333105, "episode_reward_min": -17.214793442680115, "episode_reward_mean": 0.31485486011762, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.26035452688621, "policy_agent_": -0.7260422002931434}, "policy_reward_max": {"policy_adversary_": -2.9130587351543986, "policy_agent_": 18.842158347769626}, "policy_reward_mean": {"policy_adversary_": -11.85746464393749, "policy_agent_": 6.086159752027556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9178882239814085, -1.012555019235732, -2.211027395694493, 0.35775527780467076, 2.3197668417267883, -3.5016422490498025, -2.9503394167682164, -0.8593556198762864, -0.9405122196442115, 8.746481739461377, -1.3021299775905657, -8.311794597362445, -2.430354474303658, 1.2291341007970624, 7.108457740916768, 4.586031013959551, 13.105551102746341, 0.9139559871243281, 0.6757243678533988, 4.360370321880106, -5.590992114758948, 3.462357916848136, 7.044565460803055, 1.4644194473842245, -4.166814696067355, 2.0084816095277858, 3.515709756698179, 1.645868198120727, 0.833989886546826, -0.7500181117505957, 0.40735094063929406, -6.669354369467326, -3.0194865794500294, -0.20475718062539217, -4.335544288273318, -0.763739264514563, -3.08070616565574, -3.84386067064702, -0.9739956921460485, 0.8065947925382595, 6.046207235857764, -0.145164988869235, 10.72024664166456, 4.154162975637371, -5.889545944030292, 16.320400720333105, -17.214793442680115, -4.007326693971819, -7.889906973379076, 3.0197532371514306, 1.9427771571800543, 3.6985337393247795, -1.1582714695550624, -0.143715240910899, -3.058106583769911, 2.757225466211863, -1.723703915301398, 0.6017553738766608, 1.8757800409288494, 10.900450387030752, -1.9275851068121177, 5.70420298373412, -0.5640943700150431, 0.28106595466604295, -11.504785950661082, 3.7488659640523028, 0.47505502158990354, -2.072254490391337, 12.502231135951646, -11.097280621327503, -0.2823393975522974, 0.07734911774310282, 7.362815744555349, 4.673240147723936, 3.420467598165808, 4.992880988956034, 1.12235493437163, 5.6731510761093205, -6.283883506971328, -6.228602102995428, 11.377191224510527, -0.4016501484556839, -1.3334866276903525, 2.089873410308477, 11.169328657429535, -0.021784422496271244, 3.2500686864110317, -0.7818088758283939, -4.832481350884841, -1.7656413975200445, -0.6954517313642394, -1.960373174483641, -8.4464020141086, 0.6739794068553231, -9.153548934308407, -4.145257824602567, 5.76670639876079, -0.9776021987842131, 4.964202650433776, 6.328505870707206, -4.2296646295214595, 0.780500800046625, 1.9888192424306343, -1.7847401511927399, 1.5161914400200573, -3.9770852431823007, -2.337345546656409, -3.675320004189642, 1.0111564053732256, -4.3119151404761284, 1.822872273273786, -0.9504719015110976, -0.20398929912360186, 7.579669230569501, 4.059475977436479, 3.5172819530827284, 2.82394724631573, -0.07629553273035508, 3.186816794873662, 4.214389843627526, 7.25465257114555, 1.2745448741205996, -7.87909758740555, 5.110082205323887, -5.552801386151864, 2.7042076625617653, -4.050975914756721, 2.683951349474513, 6.8425591192904065, -0.5162902367653984, 0.1777287322964415, -9.319227993297382, -12.681833557984529, -5.362296238551654, 2.126230133086823], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.614955453774024, -13.596108354511603, -8.556654127629505, -11.395547446407516, -16.226934518843173, -10.984407408470314, -7.814029842428705, -5.9382236896581615, -11.014885703035546, -17.187012442108976, -6.77629565584944, -10.806861154821021, -2.9130587351543986, -12.926961710041226, -13.122480589435959, -10.863325546308813, -17.647605617562963, -9.051076961347448, -13.403233623593486, -17.999551824971157, -16.03210568585298, -7.722654995545609, -14.340776208111901, -9.433752142291638, -14.781631268761219, -6.939418179628109, -13.06607842204156, -8.457506645917062, -8.194052365824021, -13.635063887585645, -6.937369949835415, -12.11966419312943, -7.949380493807301, -8.103459807144322, -13.830200434733426, -8.433305248963563, -7.6080770412534955, -18.308351428935623, -7.964244224015905, -11.372360085242942, -11.304185246017122, -14.056289564705704, -22.0678741171982, -11.700622064525925, -11.689947895316262, -21.363915975206137, -21.34620786224241, -9.303869469006768, -17.59527778903132, -8.67996206904192, -8.506796144945357, -11.684914034011587, -8.35393587650114, -16.948313676145688, -10.194491620843866, -12.937945250738421, -4.170569961335892, -9.726975057485637, -11.661921091327311, -17.1928792245113, -5.060048237564129, -11.912327509453425, -16.375926807186488, -8.075752383509645, -15.951223072476717, -10.939310108360143, -11.329890625690767, -6.120405715662088, -18.119050229978875, -25.26035452688621, -9.531528020618746, -9.3247537503795, -12.32622303346266, -10.748295664017611, -12.890670624957979, -14.078959162927644, -8.653374742112012, -12.412946959813949, -11.146915001304063, -8.123242525970083, -19.453126972307142, -5.7890583222349825, -8.850705572152144, -7.917077259912456, -18.091809789956038, -16.625763678896913, -9.509551696847016, -10.998549893409736, -9.02786437011026, -9.765560319719011, -11.069122873457372, -6.741447454361596, -8.569772028734489, -7.254347260985343, -15.630299476178395, -12.285700660326382, -16.69358463635833, -19.708771219841477, -19.40009965146902, -13.70499487183676, -13.735867225618149, -12.143148667337076, -7.4458687844396145, -9.291677850806005, -13.54669405306405, -7.736439114242201, -10.131841992594449, -10.055183016816775, -6.496496852845626, -10.38877412499252, -12.695731936883567, -21.28680380926833, -16.40654226743162, -15.599915645702541, -13.239765140730327, -10.44957312289854, -15.336579587986833, -13.699170580713202, -22.576354410854776, -9.417993737184695, -13.947411051748004, -8.140629379981325, -8.447247030149242, -12.754202507888781, -9.798851521717761, -10.955235979929508, -14.909985430005547, -11.145257855548113, -14.449205400244388, -8.509137232657347, -11.645954929551419, -7.867143592711097, -13.406919887014311, -9.364150115380314, -8.712009278483011], "policy_policy_agent__reward": [2.348533614896308, 2.348533614896308, 6.291776667637935, 6.291776667637935, 3.1728133659675057, 3.1728133659675057, 5.876651362106094, 5.876651362106094, 9.273350680284977, 9.273350680284977, 3.741382579710256, 3.741382579710256, 2.431845212830244, 2.431845212830244, 2.5394340348909377, 2.5394340348909377, 5.037186741695667, 5.037186741695667, 12.966747090785171, 12.966747090785171, 2.737082839129437, 2.737082839129437, 1.2475332787292897, 1.2475332787292897, 0.24135213042536974, 0.24135213042536974, 7.078047905419144, 7.078047905419144, 10.115469165176368, 10.115469165176368, 7.724678280134182, 7.724678280134182, 15.37657836015465, 15.37657836015465, 4.982516474235887, 4.982516474235887, 7.039478995723442, 7.039478995723442, 11.179961073425632, 11.179961073425632, 5.220556785547018, 5.220556785547018, 5.592506456196873, 5.592506456196873, 10.692670834457482, 10.692670834457482, 5.449085794837932, 5.449085794837932, 5.307408286346931, 5.307408286346931, 4.473949894577947, 4.473949894577947, 8.29089408936987, 8.29089408936987, 5.051687422018897, 5.051687422018897, 4.514021126185423, 4.514021126185423, 6.4425228879175265, 6.4425228879175265, 3.672360445237355, 3.672360445237355, 2.7251549118310563, 2.7251549118310563, 2.4649469571786367, 2.4649469571786367, 3.9493513132594624, 3.9493513132594624, 4.7473280732300545, 4.7473280732300545, 3.8347829922245005, 3.8347829922245005, 2.263685437798879, 2.263685437798879, 7.232245379144302, 7.232245379144302, 3.4951242659349284, 3.4951242659349284, 6.089477438890603, 6.089477438890603, 8.675196240937442, 8.675196240937442, 6.955562287918232, 6.955562287918232, 16.39406037943138, 16.39406037943138, 7.927392520081647, 7.927392520081647, 2.9002009756429854, 2.9002009756429854, 18.842158347769626, 18.842158347769626, 2.0657072097811393, 2.0657072097811393, 2.648271387517473, 2.648271387517473, 4.852685407826122, 4.852685407826122, 5.849857653096675, 5.849857653096675, 5.224786651062705, 5.224786651062705, 7.691723886668186, 7.691723886668186, 3.5978322034730366, 3.5978322034730366, 8.402299217617394, 8.402299217617394, 3.5681925185369785, 3.5681925185369785, 7.847585358475144, 7.847585358475144, 1.2234330230172468, 1.2234330230172468, 5.1643652156811495, 5.1643652156811495, 6.768850566128079, 6.768850566128079, 14.046664805771027, 14.046664805771027, 1.5662315653760053, 1.5662315653760053, 8.808265246593772, 8.808265246593772, 7.905916218585726, 7.905916218585726, 4.1784091690878435, 4.1784091690878435, 2.2232185609078154, 2.2232185609078154, 7.344088036206225, 7.344088036206225, 5.902472823640337, 5.902472823640337, 2.0240756126353747, 2.0240756126353747, 15.310640682965264, 15.310640682965264, 7.081536952779353, 7.081536952779353, 4.624594311533225, 4.624594311533225, 4.7010514340613, 4.7010514340613, 9.844519389009005, 9.844519389009005, 7.710767905870776, 7.710767905870776, 8.155569111561892, 8.155569111561892, 9.535920075941839, 9.535920075941839, 4.887864838241821, 4.887864838241821, 9.043049017961634, 9.043049017961634, 2.431515747166366, 2.431515747166366, 0.947320211487328, 0.947320211487328, 15.415159098408832, 15.415159098408832, 2.693704086889649, 2.693704086889649, 3.7586094722308956, 3.7586094722308956, 5.0034753351104655, 5.0034753351104655, 14.63056922369279, 14.63056922369279, 8.301989628200323, 8.301989628200323, 6.379810191629025, 6.379810191629025, 5.108370508790672, 5.108370508790672, 2.0976915096127087, 2.0976915096127087, 3.999959461099483, 3.999959461099483, 5.186835571046567, 5.186835571046567, 2.390537139938978, 2.390537139938978, 0.061685007312947265, 0.061685007312947265, 3.9641633339203333, 3.9641633339203333, 3.2383752709349953, 3.2383752709349953, 4.070221417861907, 4.070221417861907, 11.230145517559563, 11.230145517559563, 9.365584510528631, 9.365584510528631, 12.182151150951402, 12.182151150951402, 10.016750371271982, 10.016750371271982, 4.753101298048346, 4.753101298048346, 6.46182473369185, 6.46182473369185, 4.717344013435126, 4.717344013435126, 3.753468849806632, 3.753468849806632, 7.531442746542055, 7.531442746542055, 1.8796769355299485, 1.8796769355299485, 3.897248222969021, 3.897248222969021, 3.1899315063135663, 3.1899315063135663, 3.7538266291094264, 3.7538266291094264, 3.0384294922581936, 3.0384294922581936, 7.259302105078675, 7.259302105078675, 10.168165953878617, 10.168165953878617, 8.101276484154008, 8.101276484154008, 11.589792438136021, 11.589792438136021, 8.649620559083404, 8.649620559083404, 6.983427537990633, 6.983427537990633, 9.080263417151283, 9.080263417151283, 6.811437523991424, 6.811437523991424, 12.881585602864217, 12.881585602864217, 6.816191790406111, 6.816191790406111, 10.601031811446777, 10.601031811446777, 4.707587127050963, 4.707587127050963, 0.28407472137184786, 0.28407472137184786, 8.932142356606333, 8.932142356606333, 2.1230250677829465, 2.1230250677829465, 6.829721821245636, 6.829721821245636, 5.429504757624409, 5.429504757624409, 6.914604602511313, 6.914604602511313, 10.645882259767397, 10.645882259767397, 3.9964234979459743, 3.9964234979459743, 5.91184183092393, 5.91184183092393, -0.7260422002931434, -0.7260422002931434, 0.36254316451489277, 0.36254316451489277, 2.000926938414331, 2.000926938414331, 5.419119705784916, 5.419119705784916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342147218202782, "mean_inference_ms": 2.255502608869895, "mean_action_processing_ms": 0.09852210305288268, "mean_env_wait_ms": 0.5927038160615274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 172125, "timesteps_this_iter": 0, "agent_timesteps_total": 516375, "timers": {"sample_time_ms": 13451.243, "sample_throughput": 250.906, "load_time_ms": 0.1, "load_throughput": 33857392.968, "learn_time_ms": 2218.257, "learn_throughput": 1521.465, "update_time_ms": 30.448}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 13.955747127532959, "policy_loss": -0.001985033001983538, "vf_loss": 13.966256237030029, "vf_explained_var": -0.03359893560409546, "kl": 0.005926383648210842, "entropy": 0.8524175822734833, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 2.9633515954017637, "policy_loss": -0.02812561911996454, "vf_loss": 2.999223864078522, "vf_explained_var": 0.4641455978155136, "kl": 0.006051427879671456, "entropy": 0.776550966501236, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172125, "num_agent_steps_sampled": 516375, "num_steps_trained": 172125, "num_agent_steps_trained": 516375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6885, "training_iteration": 51, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-59-02", "timestamp": 1706108342, "time_this_iter_s": 12.387982368469238, "time_total_s": 685.4470918178558, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 685.4470918178558, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 28.6, "ram_util_percent": 68.375, "gpu_util_percent0": 0.03937500000000001, "vram_util_percent0": 0.214263916015625}}
{"episode_reward_max": 13.908702644897181, "episode_reward_min": -12.703986069986378, "episode_reward_mean": 0.18747322588961884, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -25.55974010460964, "policy_agent_": -0.9896564794694611}, "policy_reward_max": {"policy_adversary_": -3.9736756821285546, "policy_agent_": 17.091252676781448}, "policy_reward_mean": {"policy_adversary_": -12.117658501964803, "policy_agent_": 6.15256586392721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0996236783788787, -2.57720411676889, -3.5139082567985285, 11.857376705202997, -1.129299864984067, -0.9541728837286216, -4.778061173923892, 1.2402114293592954, -2.0317877589526736, -3.951725042626482, 5.20826583406257, 3.504267307802912, 0.21788774498678992, 1.7820871105686074, -0.8790921806049341, 2.4821350601681784, -1.1645980784934444, -5.66540608229147, 2.5728440707380638, 3.002784342260999, 5.853597403127452, 13.287572207759457, -0.46311049919273195, -5.545671712168459, -2.87691065148352, 4.464591668572088, -4.350108585345635, -12.703986069986378, -1.376822676412917, 4.404858021087035, 7.767140331416247, 1.2578050718021392, -7.834873712829962, -6.76936300303116, -0.46309156113702177, 4.795627821981383, -2.5213915501018667, 5.4299267903659825, 10.21027405619638, -6.745005295887152, 1.0299009587897987, 2.595596645347595, -0.40022498317325494, 13.099589820275503, -3.9564179528631827, 0.5062896582227996, 3.4851094403175438, 5.264336559379668, 13.908702644897181, -3.6600000764171283, 3.933040500539032, 3.615915913286039, -4.735236549688718, 0.09693840017937631, -7.204409264879635, 1.8229597477895894, -8.33237625556775, -6.696583673611131, -6.074778776996312, -6.64206330287361, 1.4286418226155904, 4.623968145770572, -2.150776908054799, 12.514778946587368, 1.4949071184225033, -10.000016454840667, 4.19745944933313, 2.109452587287852, 3.6234452617679374, -0.16966605093444853, 2.1695635937396536, -4.719084946987985, -2.3125268994322026, -6.998863738522042, 2.72284998607444, 4.763783965263872, 2.0052142002047035, 2.1475195318808353, -4.758433633219741, -2.149713845380769, 1.6965269149660125, -6.993135880211391, 0.4819994535637615, 3.9225363977630354, -0.935382166133711, -4.0118332103489625, 3.3644675431437383, -2.1508039805898997, 2.3677092127653254, -0.01137692328032508, -0.5463137368069724, 3.894954909091855, 2.197718594192377, -0.03536891116848889, -4.595786955123735, -3.3020720319807344, 2.434349169278388, -5.920018656854836, -1.2813829293416852, 6.356309407658931, 1.8463885738152772, -7.079645985667589, -0.6280233080074114, 12.222961261889456, -9.901049117377262, 5.177437733317646, 2.7553831687274783, -1.0893245898985804, -10.802796385003758, 3.713509377803113, -1.110119208148647, 2.850221504412948, 3.9931217456795665, 6.778574312845795, 2.0808982311801048, 3.802021428431684, -2.7059087600628686, -2.4099091278607014, -2.8643905131963336, -2.7086499853169057, -0.36012685052659815, -3.5255600442773076, 0.08709222525993404, 1.8185507884667693, 2.8432387309544667, -2.647132271864018, -7.69687617347689, -2.6920365782112228, 7.448240410836021, -3.149388279172405, 2.701375919648747, 2.180232136333474, 0.16379645295780193, 1.9008357116651498, 2.0407692547420786], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.541382927279423, -4.05948811730422, -13.69046534781373, -15.556266889398849, -5.05929701283867, -8.784482291078278, -12.79541789111345, -8.385297526236293, -8.571436451428506, -16.337802015090286, -12.058839506742567, -9.535022222536213, -9.404068715301543, -9.498034679815568, -7.784427700376004, -10.787734559644859, -6.683695205427438, -23.70666518669067, -11.626675318245638, -13.117188907353347, -12.89410133089484, -19.887341911682984, -9.460637823712378, -15.87166968585932, -9.066911441175641, -8.29519247137573, -7.551750724229959, -11.303477012250909, -6.250692052300539, -12.7344596699091, -20.838232116972808, -5.60089204431538, -18.704677299465, -25.55974010460964, -10.32139698310975, -11.940378465826948, -5.851975581971644, -19.67361559091332, -22.578548303298682, -9.89258577225974, -13.70384586218983, -13.255662435210207, -9.008897985071247, -19.451889565160425, -10.641301280151277, -13.423695545293572, -16.533923928752138, -10.122194273797568, -19.448899841277886, -14.697732534693559, -9.474165374059083, -16.634467334031346, -10.25680402919782, -8.361553733650096, -10.846768568363414, -5.7494086992376365, -9.688642021539925, -9.546124243342328, -22.658510234830608, -12.389273473717134, -13.83194421247049, -17.616386330512437, -6.824660801305129, -21.66772640697551, -17.29365479224863, -8.020703495901742, -11.205940661390281, -8.19958908513046, -8.82916781349996, -11.246378730632625, -9.941279066482378, -6.89097513039892, -13.792670577617582, -13.336413089728353, -9.069939096328264, -11.086053753572099, -8.613018458873281, -7.761047757317128, -15.233022419327925, -7.402984799745162, -7.445172924874768, -7.045150260797178, -10.482733004449008, -15.944412219771793, -11.625026735135581, -11.473386088973406, -11.706851464272411, -7.897395215710571, -12.616788314911904, -18.294134661060117, -15.108733965816244, -15.760738854472079, -8.473284472482863, -7.916292034513933, -14.978758976301613, -15.799732544787124, -16.676500087438626, -14.83364347294158, -7.955557766141904, -19.29199396867603, -12.31660440272321, -18.51561052971771, -7.819777703088141, -20.10536136798115, -11.568535446746015, -13.356044223316566, -8.618916469071284, -9.318046163059405, -22.84099214687928, -12.269096830899569, -15.951161484651426, -14.09400925915117, -9.342819333149574, -14.59289411510484, -10.014960296131708, -10.965432127196904, -11.13372653259809, -3.9736756821285546, -19.210910832120934, -7.731346805247312, -8.700163827323642, -15.537170377649742, -16.91570722462201, -13.354185739258293, -7.896530465319439, -18.9811855920553, -5.77201254594867, -12.946310979466597, -14.90075515651616, -4.854967688609571, -7.0395526756904, -12.225807659728801, -11.1667493383165, -11.988115976962481, -7.519191432413664], "policy_policy_agent__reward": [2.8205033028291506, 2.8205033028291506, 0.7411420002676645, 0.7411420002676645, 5.088278545507597, 5.088278545507597, 13.706821797300922, 13.706821797300922, 1.9649985739273008, 1.9649985739273008, 3.9151547036748267, 3.9151547036748267, 4.0086783585947785, 4.0086783585947785, 4.812754477797795, 4.812754477797795, 3.2698243462379155, 3.2698243462379155, 6.193038486231905, 6.193038486231905, 8.633552670402564, 8.633552670402564, 6.519644765169565, 6.519644765169565, 4.810978230144165, 4.810978230144165, 5.64006089519209, 5.64006089519209, 3.452667759885534, 3.452667759885534, 6.634934809906518, 6.634934809906518, 2.759548563466997, 2.759548563466997, 9.020629552199598, 9.020629552199598, 7.0997596944918495, 7.0997596944918495, 8.059986624807173, 8.059986624807173, 9.373849367011141, 9.373849367011141, 16.587457059721213, 16.587457059721213, 4.498763662259823, 4.498763662259823, 5.162998986845429, 5.162998986845429, 3.0950003948460614, 3.0950003948460614, 6.379892069973909, 6.379892069973909, 1.6008210694421585, 1.6008210694421585, -0.7002545288677323, -0.7002545288677323, 2.436934687943811, 2.436934687943811, 8.56965884549807, 8.56965884549807, 14.302686224194527, 14.302686224194527, 3.4293485580587593, 3.4293485580587593, 5.434901793317524, 5.434901793317524, 9.395188550789245, 9.395188550789245, 4.929152710986364, 4.929152710986364, 8.368003143904167, 8.368003143904167, 1.6652920159348887, 1.6652920159348887, 12.551771190639649, 12.551771190639649, 16.39441117974753, 16.39441117974753, 1.5737902381862907, 1.5737902381862907, 7.366873410489815, 7.366873410489815, 7.925629540278903, 7.925629540278903, 4.304336500948996, 4.304336500948996, 16.275739692717963, 16.275739692717963, 3.3424416636440477, 3.3424416636440477, 6.964992601758186, 6.964992601758186, 10.00951668453484, 10.00951668453484, 7.69326541658862, 7.69326541658862, 16.678801243087534, 16.678801243087534, 5.5188662291382125, 5.5188662291382125, 6.703602937299055, 6.703602937299055, 10.125191623658695, 10.125191623658695, 2.76078373975455, 2.76078373975455, 4.229246066914737, 4.229246066914737, 1.8211796517418897, 1.8211796517418897, 3.7861842235136116, 3.7861842235136116, 0.6781328829860909, 0.6781328829860909, 1.4247702848656003, 1.4247702848656003, 8.29186572891715, 8.29186572891715, 2.8736050854217607, 2.8736050854217607, 7.630293017543043, 7.630293017543043, 11.120177238141506, 11.120177238141506, 2.336941946625166, 2.336941946625166, 17.091252676781448, 17.091252676781448, 9.39428095533556, 9.39428095533556, -0.9896564794694611, -0.9896564794694611, 7.701700055361707, 7.701700055361707, 5.154520836209156, 5.154520836209156, 6.226306537633951, 6.226306537633951, 5.538356339849088, 5.538356339849088, 6.055421330111015, 6.055421330111015, 1.0859450917054678, 1.0859450917054678, 5.740071839092687, 5.740071839092687, 3.168774675603154, 3.168774675603154, 5.896394541201352, 5.896394541201352, 7.924918859417982, 7.924918859417982, 5.309116329538994, 5.309116329538994, 4.954283644598982, 4.954283644598982, 5.23729439305409, 5.23729439305409, 2.6266354771821954, 2.6266354771821954, 4.57084991992039, 4.57084991992039, 0.026007190292893334, 0.026007190292893334, 5.482366229006384, 5.482366229006384, 9.933474308767416, 9.933474308767416, 5.344822284500935, 5.344822284500935, 3.7307764393122227, 3.7307764393122227, 7.535659503708074, 7.535659503708074, 2.8732956175603355, 2.8732956175603355, 7.492248763838615, 7.492248763838615, 9.141378868889895, 9.141378868889895, 7.281210114504636, 7.281210114504636, 9.827846881781966, 9.827846881781966, 5.33550153333762, 5.33550153333762, 3.940461561672722, 3.940461561672722, 5.191486010588942, 5.191486010588942, 6.248830256403194, 6.248830256403194, 9.555424628358507, 9.555424628358507, 4.456812408043371, 4.456812408043371, 3.3370874184001083, 3.3370874184001083, 12.824151688167483, 12.824151688167483, 7.081496488269247, 7.081496488269247, 5.717982272025055, 5.717982272025055, 3.595877197540365, 3.595877197540365, 16.164161314935303, 16.164161314935303, 0.8337431646843723, 0.8337431646843723, 9.266740978317108, 9.266740978317108, 5.68714981889938, 5.68714981889938, 4.114360786580411, 4.114360786580411, 6.019097880937762, 6.019097880937762, 7.9913031043513385, 7.9913031043513385, 7.420521138251389, 7.420521138251389, 8.472115381782057, 8.472115381782057, 6.66797053941457, 6.66797053941457, 10.685734213975312, 10.685734213975312, 6.047929263655908, 6.047929263655908, 7.383726777814293, 7.383726777814293, 4.2139088862676095, 4.2139088862676095, 0.7818832771339277, 0.7818832771339277, 8.173260159462302, 8.173260159462302, 2.511348409965203, 2.511348409965203, 4.170018488398521, 4.170018488398521, 6.005805166686217, 6.005805166686217, 8.501399724940974, 8.501399724940974, 7.586368263862532, 7.586368263862532, 5.369884598136951, 5.369884598136951, 8.167026660095644, 8.167026660095644, -0.9624318137641077, -0.9624318137641077, 5.127137200627687, 5.127137200627687, 11.174497783676092, 11.174497783676092, 0.852789704718582, 0.852789704718582, 4.870464297669573, 4.870464297669573, 7.203019898031136, 7.203019898031136, 5.66527289563715, 5.66527289563715, 6.944475844313816, 6.944475844313816, 4.77998034357787, 4.77998034357787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3421202567129721, "mean_inference_ms": 2.2563946864580084, "mean_action_processing_ms": 0.09853448004861944, "mean_env_wait_ms": 0.5928863165262548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 175500, "timesteps_this_iter": 0, "agent_timesteps_total": 526500, "timers": {"sample_time_ms": 13354.839, "sample_throughput": 252.717, "load_time_ms": 0.1, "load_throughput": 33857392.968, "learn_time_ms": 2224.897, "learn_throughput": 1516.924, "update_time_ms": 30.446}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 15.070388412475586, "policy_loss": 0.0009016236905154074, "vf_loss": 15.07812671661377, "vf_explained_var": -0.0020582914352416993, "kl": 0.004797957676046483, "entropy": 0.8640129446983338, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.1058053612709045, "policy_loss": 0.0032547471579164266, "vf_loss": 3.110336220264435, "vf_explained_var": 0.48739632964134216, "kl": 0.006725538868579933, "entropy": 0.7806651145219803, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175500, "num_agent_steps_sampled": 526500, "num_steps_trained": 175500, "num_agent_steps_trained": 526500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7020, "training_iteration": 52, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-59-15", "timestamp": 1706108355, "time_this_iter_s": 13.584005355834961, "time_total_s": 699.0310971736908, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A787DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 699.0310971736908, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 34.99444444444445, "ram_util_percent": 68.61666666666666, "gpu_util_percent0": 0.06333333333333334, "vram_util_percent0": 0.22401258680555555}}
{"episode_reward_max": 23.181224865762328, "episode_reward_min": -19.404900761023008, "episode_reward_mean": 1.133271446325209, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -36.10708021199977, "policy_agent_": -1.3793642036739997}, "policy_reward_max": {"policy_adversary_": -4.094692087972002, "policy_agent_": 29.64415253888105}, "policy_reward_mean": {"policy_adversary_": -12.357816908113127, "policy_agent_": 6.745544177219169}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.450095515652718, 0.975425908418611, 3.5610334047207806, 1.3110313569983103, -12.498474038766695, 10.300194279391066, 0.15774517378177225, -0.5427101490211995, -4.504047384623078, -0.43256347205735224, 7.782887060735278, 0.6912291084369083, 15.710930293060612, 5.224941060870523, 3.9856332678475956, -4.7454157761258005, -3.9903603515770354, 1.7209670511054669, 2.017915381743021, -0.7216574803713244, 7.426983512660008, -3.4270352553768006, 21.67303568130692, 1.6224047859888662, -4.03829681573371, -1.861059757993755, 4.166345866726113, 9.624933165971568, 6.707967925056895, 3.0101661626779572, 4.4078451433335095, 2.597765666692376, -1.0142190529189476, 1.1601956621397134, 6.91202806458039, -3.897117144736899, -8.369026649964947, -9.12969470703094, 1.8050303862428743, -5.9671001141361195, -1.7285589444309324, 3.6411503189907304, -0.20323552383787846, -2.113737169637371, -0.48505739955339333, -0.9936827684590747, 2.540277714839016, -0.9290554683271407, 1.7181610474360993, 8.877149882695631, 6.7261561307933135, -1.094094046157292, -5.312747800022748, -8.545031479170017, -2.1262087560769602, -3.5869577270206907, 1.2281171815056502, 4.758825138948552, -1.8894559256435404, -4.089113656284219, -19.404900761023008, -2.196349318245046, 8.566811796199257, 0.10944090199541673, 7.188591193501046, 3.411798063489275, 3.949531760670702, 4.060718464922816, 5.043472724841434, 2.3555151662644596, -2.8972274204350654, 4.741353951956309, -6.535733498951625, -3.1540020691717254, -2.723445326136848, -2.3846518796381795, -5.61144543700771, 4.235340944920035, 1.1631945772803567, -0.7849724011561797, 2.08003155968165, 1.4863981157998145, 9.273975770651916, -1.5512363379074119, 4.191309421968033, 3.652381347597639, -10.381648503296773, 4.482650783222642, 5.920202513897445, 1.4712414538964502, 1.1965437629296756, 2.40987602542769, 2.709855720967895, 2.638153597999271, -2.6086202817463957, 2.3462103597348754, 5.927845290931429, 3.6842540395117274, -0.7576215764124199, 4.0059692707933126, -6.199125953118919, -7.292740136470298, 2.2248385947491727, -5.4620439707484225, -4.71490916967191, 2.66502897188208, 0.6353569558029349, 2.9467932393209058, 23.181224865762328, -4.549533374940204, 0.45977956153712995, 1.7591264634084238, 3.8933861237329994, -0.7933540229277083, 3.314975497511492, 2.241566782103431, -2.780543507048398, 10.273072317998155, -0.33485130448090394, 1.4698143779988153, 1.2099249888350698, 2.8322338314739746, 7.055397557192251, 6.90364066468138, -1.8216079424502252, 0.9665649327070095, -0.7100797692463858, -7.40585483770384, -9.391954636016107, 2.0811361097157692, 4.727631778777451, 0.18218761960589816, 13.955989034479192, 2.221330723274505, 7.677575629959016], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.499219198162567, -12.367945894976955, -13.189448912079975, -8.618778429340281, -12.391180021852971, -19.479123699399327, -5.982601369884144, -5.892061863567581, -16.631986776696102, -7.12866050250707, -15.46719830452698, -6.40732640637926, -24.377442096955274, -17.623300899552508, -7.4408943319765335, -19.168357971609623, -7.275372625122325, -13.730499015769379, -12.263153183055124, -4.094692087972002, -15.899352860480073, -8.985966687523428, -30.753373515821874, -5.049505981060465, -5.0200200578927445, -9.338179424396902, -11.138075237108824, -20.46989715539199, -14.134834514624174, -8.328063630438269, -16.0613729381238, -10.64491820101341, -6.765292741017881, -6.144925527917454, -14.916855227294118, -13.806995941115442, -9.228130686821569, -9.116239423910407, -12.961261141131983, -9.739587068980617, -8.627772086296703, -8.159024305698997, -8.849483321712514, -6.067560176549887, -10.225200779576717, -5.520407749277398, -8.446240676787516, -5.260534443109223, -11.435834632688502, -16.504832201690558, -16.11437479081817, -21.11337871371942, -8.991037500198289, -7.814402253662892, -18.847897707359976, -7.832606221087349, -11.732629106251816, -15.674908647052137, -10.140897116435033, -6.108582779290071, -16.646172353675013, -7.6720844731378435, -26.041696655774146, -6.04802043734268, -14.590908461398199, -16.683621928064774, -25.967441248094087, -10.200221637013666, -17.387118334254072, -11.676361864295744, -10.122344335162515, -13.418702061028723, -10.189724525938036, -8.496365255197217, -15.279800432131912, -14.065947209907685, -23.94417772724409, -10.904183142518418, -11.76571752850498, -8.621443069002373, -16.526864699600026, -9.806798269137511, -18.73771064002135, -8.381296136975932, -10.100771960552747, -10.48401965366916, -19.959234189566086, -13.01734009270501, -15.531224258438707, -12.230141399503314, -11.571796488598835, -7.649349463753649, -12.643308494745744, -10.399907208867166, -9.150305391308242, -9.93555073122043, -13.4669078839411, -14.666460831346765, -9.304275591980382, -12.703533459989588, -7.044420118508915, -8.664636560945967, -13.9913269131974, -11.781323712914176, -18.210367190447464, -8.31174746136788, -10.292232187044194, -9.926585386164126, -36.10708021199977, -8.10709619418022, -8.38028200577205, -11.428314393579132, -13.086101501439076, -8.55920783970038, -9.426002123989695, -14.75328688007782, -4.402408863033817, -18.966270977404044, -19.74171455721777, -12.654111988704173, -9.94257880976525, -9.200138810779801, -11.839529095615267, -15.726615978710473, -11.663402586698785, -8.74775487355791, -8.60129240551501, -16.679702236241987, -15.531657335675009, -13.406999393053272, -10.434704939820957, -10.906974848261658, -21.447313882121335, -9.126482600794624, -17.22707144265026], "policy_policy_agent__reward": [9.474657356907642, 9.474657356907642, 6.671685901697784, 6.671685901697784, 8.375241158400378, 8.375241158400378, 4.964904893169296, 4.964904893169296, -0.05364700845685938, -0.05364700845685938, 14.889658989395196, 14.889658989395196, 3.0701732718329566, 3.0701732718329566, 2.6746758572731903, 2.6746758572731903, 6.063969696036513, 6.063969696036513, 3.3480485152248587, 3.3480485152248587, 11.625042682631133, 11.625042682631133, 3.5492777574080843, 3.5492777574080843, 20.044186195007946, 20.044186195007946, 11.424120980211518, 11.424120980211518, 5.713263799912066, 5.713263799912066, 7.211471097741908, 7.211471097741908, 1.6425061367726463, 1.6425061367726463, 7.725733033437421, 7.725733033437421, 7.140534282399073, 7.140534282399073, 1.6865173038003385, 1.6865173038003385, 11.663168186570038, 11.663168186570038, 2.779465716073314, 2.779465716073314, 26.2132045985644, 26.2132045985644, 3.335955383524665, 3.335955383524665, 0.4908616210795188, 0.4908616210795188, 3.7385598332015717, 3.7385598332015717, 7.652210551917471, 7.652210551917471, 15.04741516068178, 15.04741516068178, 10.421401219840533, 10.421401219840533, 5.669114896558111, 5.669114896558111, 10.234609040728655, 10.234609040728655, 6.621341933852891, 6.621341933852891, 2.8755368440494666, 2.8755368440494666, 3.6525605950285835, 3.6525605950285835, 10.914441645937254, 10.914441645937254, 4.954939398189272, 4.954939398189272, 0.4295520184283117, 0.4295520184283117, -0.00672764156026634, -0.00672764156026634, 7.383145763687428, 7.383145763687428, 1.8862434774222476, 1.8862434774222476, 3.4496065709328856, 3.4496065709328856, 5.900087312344864, 5.900087312344864, 4.323123898937318, 4.323123898937318, 1.976911503456259, 1.976911503456259, 4.87007169001166, 4.87007169001166, 2.2633624904091625, 2.2633624904091625, 5.493259195813266, 5.493259195813266, 2.1657394873910407, 2.1657394873910407, 6.576997840062299, 6.576997840062299, 12.690991042193097, 12.690991042193097, 11.420265460805746, 11.420265460805746, 10.00964233378107, 10.00964233378107, 1.8391448500877692, 1.8391448500877692, -0.365314612753564, -0.365314612753564, 8.360844475641507, 8.360844475641507, 2.122824247033328, 2.122824247033328, 6.480373143878731, 6.480373143878731, 10.216866893000345, 10.216866893000345, 4.125720595395747, 4.125720595395747, 1.009734561502926, 1.009734561502926, -1.3793642036739997, -1.3793642036739997, 2.737867577446399, 2.737867577446399, 17.30425422598671, 17.30425422598671, 3.078730669669048, 3.078730669669048, 10.889749827449625, 10.889749827449625, 10.047709995777025, 10.047709995777025, 14.958486504382394, 14.958486504382394, 7.130470050968241, 7.130470050968241, 11.215295529547754, 11.215295529547754, 7.015938515280099, 7.015938515280099, 3.612558457363724, 3.612558457363724, 9.080028006492523, 9.080028006492523, 1.826995513493208, 1.826995513493208, 2.6711815930127467, 2.6711815930127467, 6.2781775529975326, 6.2781775529975326, 5.840647665134753, 5.840647665134753, 9.166366145118191, 9.166366145118191, 7.569762043719224, 7.569762043719224, 6.464456052892673, 6.464456052892673, 3.9182353339230978, 3.9182353339230978, 9.303448129640838, 9.303448129640838, 5.6465981924686615, 5.6465981924686615, 14.005843205336628, 14.005843205336628, 3.4150298995342574, 3.4150298995342574, 7.146040691260392, 7.146040691260392, 7.0682005006334, 7.0682005006334, 4.788792843134659, 4.788792843134659, 8.749995437963829, 8.749995437963829, 10.725713386168072, 10.725713386168072, 6.850691426699884, 6.850691426699884, 6.384170125764255, 6.384170125764255, 5.0296127445906675, 5.0296127445906675, 7.676582107856814, 7.676582107856814, 6.519030403433219, 6.519030403433219, 3.2708425547809235, 3.2708425547809235, 6.140880545477654, 6.140880545477654, 9.697376587436267, 9.697376587436267, 9.175357435429245, 9.175357435429245, 4.273327007783982, 4.273327007783982, 8.354751365391449, 8.354751365391449, 0.4226470826949981, 0.4226470826949981, 0.6859482122378325, 0.6859482122378325, 8.108082753973285, 8.108082753973285, 3.1596398710828755, 3.1596398710828755, 6.747729010387774, 6.747729010387774, 5.488388216624981, 5.488388216624981, 5.463794571423567, 5.463794571423567, 6.436689312742515, 6.436689312742515, 29.64415253888105, 29.64415253888105, 1.7787814096200076, 1.7787814096200076, 4.42003078365459, 4.42003078365459, 6.593720428493779, 6.593720428493779, 8.489743812586038, 8.489743812586038, 3.8829269083863367, 3.8829269083863367, 6.370488810750595, 6.370488810750595, 8.497426831090621, 8.497426831090621, 0.8109326779927083, 0.8109326779927083, 14.619671647701102, 14.619671647701102, 9.703431626368435, 9.703431626368435, 7.0619631833514935, 7.0619631833514935, 5.576251899300162, 5.576251899300162, 6.016186321126887, 6.016186321126887, 9.44746332640376, 9.44746332640376, 11.315128321695925, 11.315128321695925, 4.92089732212428, 4.92089732212428, 4.85715990313246, 4.85715990313246, 3.945606318134313, 3.945606318134313, 4.636923699269069, 4.636923699269069, 3.0698513498294506, 3.0698513498294506, 7.744067751384524, 7.744067751384524, 7.581168359299203, 7.581168359299203, 5.544581233933778, 5.544581233933778, 17.70165145830027, 17.70165145830027, 5.6739066620345655, 5.6739066620345655, 12.452323536304634, 12.452323536304634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3423668724546779, "mean_inference_ms": 2.259535654715888, "mean_action_processing_ms": 0.09877883359839497, "mean_env_wait_ms": 0.5938762074647495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 178875, "timesteps_this_iter": 0, "agent_timesteps_total": 536625, "timers": {"sample_time_ms": 13544.71, "sample_throughput": 249.175, "load_time_ms": 0.1, "load_throughput": 33857392.968, "learn_time_ms": 2233.261, "learn_throughput": 1511.243, "update_time_ms": 32.047}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 17.178715896606445, "policy_loss": -0.00941523585934192, "vf_loss": 17.19661693572998, "vf_explained_var": -0.01721080541610718, "kl": 0.011893648464096396, "entropy": 0.8486883699893951, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 4.729753541946411, "policy_loss": -0.003442223370075226, "vf_loss": 4.741052865982056, "vf_explained_var": 0.4556255370378494, "kl": 0.00506707961158886, "entropy": 0.787294802069664, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 178875, "num_agent_steps_sampled": 536625, "num_steps_trained": 178875, "num_agent_steps_trained": 536625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7155, "training_iteration": 53, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-59-30", "timestamp": 1706108370, "time_this_iter_s": 14.263496160507202, "time_total_s": 713.294593334198, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A012EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 713.294593334198, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 38.47222222222222, "ram_util_percent": 67.96111111111112, "gpu_util_percent0": 0.10055555555555556, "vram_util_percent0": 0.23486328125}}
{"episode_reward_max": 13.585029739003234, "episode_reward_min": -23.367605704960376, "episode_reward_mean": 0.8823652303634348, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.709548858869255, "policy_agent_": -2.8580091007933026}, "policy_reward_max": {"policy_adversary_": -4.1170177137513315, "policy_agent_": 19.576693099352344}, "policy_reward_mean": {"policy_adversary_": -12.157518216127752, "policy_agent_": 6.5199417232455925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.3200351179719965, -3.4152904649694458, -8.82367171744441, 4.517812156827323, -1.7418767258699426, 3.8919905750187143, -0.8908861096636735, 3.658136768758401, -11.51567624636017, 3.42066159230323, -5.211841418447739, 0.42820004522761657, 8.19355237537, 5.7561787384666445, 1.732426897366967, -0.8585716797690035, 4.685755602940055, -0.3859292449637144, -3.5438691629549153, -13.10188088528362, 9.240088851037482, 0.5686895410111172, -6.010612218242545, 1.1000704358090607, -0.7526971455804701, -1.07102689537161, -2.047183732269771, -6.93354288694546, 11.128971166018486, 8.127714305081097, 4.671868462927802, -3.1428687606347387, -1.5537166835827634, 7.368863705211404, 0.08695104511531776, -2.07805655840584, 2.1806259958542813, 4.50897344878113, -2.8397812032859693, 4.574725471522054, 8.895724309261533, 5.737627221227396, -1.471879036771665, 12.443837339835436, 5.676668406819351, -0.32363913364258257, 0.10529281799167722, 5.227643209195342, 0.6108124694882231, 1.7276011661760484, 13.01946144523126, -1.3034921348815656, -23.367605704960376, 2.7230009057384468, 7.262014795429373, 9.723892548546848, 13.585029739003234, -0.3075676039267481, -6.142757155666148, 7.942022051737514, -2.573022031437992, 2.454412763625439, -0.1002251883512866, 3.334482938593239, 0.6057261442534272, 0.3665580567058714, 7.591555662501398, 10.074724504672739, -0.3391899763896935, -11.298837482022691, -3.1798852552237222, 0.8013917103154358, 5.800416620387502, 10.573835227658975, 2.3824283277611222, 0.769625265165772, -2.4188148226867963, -0.4126944948435845, 2.3511705667568803, 4.014611681166386, 0.5025923280147577, 6.85516472028014, 6.455248176454772, 0.8074507872996912, 6.931765477461825, 0.7089060466958724, 8.557363623309149, -0.5953785204788788, -3.782128723476209, -3.5812660421506046, -4.25837878573447, -7.059138829071447, -3.9846228500681136, 5.3270972409870625, 4.281519851387904, -0.4787364277549999, -3.659281322691582, -5.340052837137476, -0.24706012409859837, 0.8238320926433012, 2.599601544244957, 3.3455262183447436, 2.7497939815868797, 1.2540259020190077, -1.3836722807808308, 8.933119592439581, 4.097956306290087, -11.658915793822633, -6.14169081703141, 6.660144451191384, 4.135344170919407, 1.8280055610147623, -1.617865094474906, 9.880184890340512, 6.957205873437691, -2.8522401098381613, -6.134036933863811, 1.2716627698383496, -3.893403816584701, 0.06886978443578073, -0.31962895125538604, -8.497562268440994, 1.902294375079995, 0.663891105300168, -2.9656485195301308, -6.113195252417209, -2.604538759358537, -4.02887257656641, -6.201703124203514, 2.9287841924589193, 5.987603705286174, -1.5467612281259853, 3.2533596617009324, -1.4268038542898067, -4.081694921168679], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-12.26351750793657, -10.436788867952197, -13.917397158624333, -10.997526978721568, -6.153493937771921, -16.54313575570387, -9.5983564904607, -10.166834030781676, -5.834209524970861, -8.381197613969718, -7.982672016625655, -11.842937831345282, -13.461028103282217, -16.741227296667976, -12.630243068362862, -7.640406999395878, -12.078354997496573, -10.15787318403309, -4.1170177137513315, -7.385862683697017, -15.96553974339283, -8.90072119555028, -13.76907139158805, -6.240766276404622, -12.028537356303062, -8.661608993558408, -12.499927324105302, -8.513064109087619, -20.86028171871393, -18.27229919369338, -12.916739782373615, -12.448230784619552, -8.767747720776262, -21.148278343256738, -11.182374879375661, -6.510689603984095, -13.58290769488388, -12.938795029612287, -14.255585901082789, -12.629229207603839, -16.012057225584055, -13.195032164030554, -7.180113388190995, -26.709548858869255, -19.45816194404877, -8.871321641717746, -12.903865032782377, -13.746590972702727, -7.419934970930096, -20.357962625787415, -18.67458614002324, -10.284998836523583, -18.15935202682436, -9.958824291147975, -17.12254702549449, -17.894245402589462, -19.85899669296987, -9.752975392823494, -14.04292053999545, -13.766251339740972, -13.027835583331914, -10.19560809743672, -7.131636586178688, -11.374618888267834, -8.869233766381363, -9.80582471931712, -13.928071612928578, -15.517515567592596, -10.854346884874177, -14.688166766654472, -9.484236545545272, -7.5582117680686665, -17.49516327711507, -15.963000818994614, -11.697587388833403, -10.583083142883343, -6.877000971344682, -6.920252981298563, -10.52877892619003, -9.381625636452272, -7.385748776497667, -17.087937673385763, -18.002634716890256, -9.572813946899917, -17.103910537981655, -8.437461238809354, -20.190037301934748, -4.343334008204422, -15.043363632445478, -7.895990505821665, -12.084469687196032, -8.805124712466315, -10.58149227501885, -11.392627593820546, -13.668008262892167, -8.227020837529944, -13.715550685886502, -7.362509247057453, -14.751243384638956, -10.420661606544884, -10.909905181978093, -8.420983759160308, -10.595154826886729, -13.20208352267171, -9.689574829993227, -17.143105949968923, -12.279038193729097, -14.076008430153635, -12.42296993009026, -13.041956437818586, -12.355361053959147, -11.664465745757399, -9.963410286214378, -13.976483578682394, -14.115845704266928, -6.306210866591431, -15.09612780811656, -7.187353439054392, -11.89810415386189, -8.327302650240272, -8.902779012679762, -21.049916399945, -7.064864942918396, -9.667115691269494, -11.25072469891336, -23.11119911731547, -13.838584739421696, -15.288527013876907, -21.827193212291178, -6.586448497393372, -15.306181808344814, -20.82918339040045, -8.939732014767811, -5.531728611284534, -5.652828591322596], "policy_policy_agent__reward": [9.791776312954282, 9.791776312954282, 3.5107492014913757, 3.5107492014913757, 2.5468627205899628, 2.5468627205899628, 7.757669567774445, 7.757669567774445, 2.2058086059509883, 2.2058086059509883, 10.217563165361291, 10.217563165361291, 4.3537351903985115, 4.3537351903985115, 6.912485399770037, 6.912485399770037, -2.8407333606946548, -2.8407333606946548, 5.9009296031364755, 5.9009296031364755, 1.3854152990889563, 1.3854152990889563, 6.135568938286449, 6.135568938286449, 10.827290239326109, 10.827290239326109, 11.248703017567312, 11.248703017567312, 7.181334982864913, 7.181334982864913, 3.3909176598134376, 3.3909176598134376, 8.382055300218314, 8.382055300218314, 4.885971969534689, 4.885971969534689, 0.2865742753982079, 0.2865742753982079, -2.8580091007933026, -2.8580091007933026, 12.602814297215154, 12.602814297215154, 4.734705368280697, 4.734705368280697, 3.879229586672752, 3.879229586672752, 3.670418356106841, 3.670418356106841, 5.637920105361297, 5.637920105361297, 3.7952910490933998, 3.7952910490933998, 5.226371795917762, 5.226371795917762, 0.7897606110710786, 0.7897606110710786, 15.994626442366211, 15.994626442366211, 13.200006749387237, 13.200006749387237, 8.79430412265071, 8.79430412265071, 4.652681011992408, 4.652681011992408, 3.6070155185967483, 3.6070155185967483, 14.258571024234074, 14.258571024234074, 5.634662962245491, 5.634662962245491, 2.216316522789126, 2.216316522789126, 7.88176684536908, 7.88176684536908, 8.723884239196705, 8.723884239196705, 5.707902348898408, 5.707902348898408, 8.601977339562946, 8.601977339562946, 12.453890767422795, 12.453890767422795, 9.466329692628971, 9.466329692628971, 2.854117175709666, 2.854117175709666, 19.576693099352344, 19.576693099352344, 12.567415175434052, 12.567415175434052, 4.273841254037581, 4.273841254037581, 6.504578925387029, 6.504578925387029, 9.487117090949035, 9.487117090949035, 4.01537372020916, 4.01537372020916, 11.042781895981733, 11.042781895981733, 15.847023792627247, 15.847023792627247, 4.49075335082101, 4.49075335082101, -2.6041268390680163, -2.6041268390680163, 6.340912598443208, 6.340912598443208, 12.192280910461932, 12.192280910461932, 13.809068975568158, 13.809068975568158, 16.72201321598655, 16.72201321598655, 4.722703894448372, 4.722703894448372, 3.9500816921646504, 3.9500816921646504, 10.854136695739241, 10.854136695739241, 5.227406775946957, 5.227406775946957, 6.325010430531082, 6.325010430531082, 3.5157056989137, 3.5157056989137, 7.354550913430537, 7.354550913430537, 4.737479955317394, 4.737479955317394, 5.086191388011498, 5.086191388011498, 10.75981363771499, 10.75981363771499, 12.796120036132665, 12.796120036132665, 5.25757845424224, 5.25757845424224, 1.6946646423158895, 1.6946646423158895, 3.152175645160771, 3.152175645160771, 4.179801739192051, 4.179801739192051, 11.647789948751283, 11.647789948751283, 13.268418023326797, 13.268418023326797, 7.040007858297262, 7.040007858297262, 5.676354204024559, 5.676354204024559, 2.229093074328942, 2.229093074328942, 3.2537792432274886, 3.2537792432274886, 6.439974746473455, 6.439974746473455, 6.69811865880933, 6.69811865880933, 3.9441705522562134, 3.9441705522562134, 11.971551196832953, 11.971551196832953, 12.228941446672517, 12.228941446672517, 5.190132367099805, 5.190132367099805, 12.017838007721739, 12.017838007721739, 4.573183642752614, 4.573183642752614, 14.37370046262195, 14.37370046262195, 1.8739777438627723, 1.8739777438627723, 5.63061745448464, 5.63061745448464, 2.157362231835531, 2.157362231835531, 3.913045450730781, 3.913045450730781, 0.8729929416974321, 0.8729929416974321, 3.2984347124753706, 3.2984347124753706, 8.3598624174038, 8.3598624174038, 8.974764057140032, 8.974764057140032, 3.874142204887472, 3.874142204887472, 5.0281346815974635, 5.0281346815974635, 1.011228204959989, 1.011228204959989, 7.252091630270179, 7.252091630270179, 5.6222468495940925, 5.6222468495940925, 6.754753363111521, 6.754753363111521, 5.883254988752526, 5.883254988752526, 6.672474404236806, 6.672474404236806, 7.228054712345361, 7.228054712345361, 4.152951274606198, 4.152951274606198, 13.038112771204256, 13.038112771204256, 8.18849725000959, 8.18849725000959, 1.2085463181655014, 1.2085463181655014, 3.1406395565294254, 3.1406395565294254, 9.85105044450499, 9.85105044450499, 8.245352612439277, 8.245352612439277, 6.746235653386078, 6.746235653386078, 4.172772595869735, 4.172772595869735, 11.928334234511455, 11.928334234511455, 10.53652578885231, 10.53652578885231, 1.7269853783766347, 1.7269853783766347, 4.481045437126375, 4.481045437126375, 4.22950810444637, 4.22950810444637, 4.002350168638595, 4.002350168638595, 4.198086217338027, 4.198086217338027, 4.291575030712189, 4.291575030712189, 6.276177065752001, 6.276177065752001, 4.483579658999196, 4.483579658999196, 5.16550339828483, 5.16550339828483, 4.142538089691614, 4.142538089691614, 8.499001932449127, 8.499001932449127, 5.617022990031581, 5.617022990031581, 5.629827218655248, 5.629827218655248, 7.812745044043833, 7.812745044043833, 4.757616344926147, 4.757616344926147, 10.64689275681549, 10.64689275681549, 9.64121108113723, 9.64121108113723, 6.096545838234368, 6.096545838234368, 2.052462378497363, 2.052462378497363, 0.7855668350769589, 0.7855668350769589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34222033336490515, "mean_inference_ms": 2.2587346175383844, "mean_action_processing_ms": 0.09895873943986878, "mean_env_wait_ms": 0.5936139239201329, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 182250, "timesteps_this_iter": 0, "agent_timesteps_total": 546750, "timers": {"sample_time_ms": 13655.905, "sample_throughput": 247.146, "load_time_ms": 0.199, "load_throughput": 16926672.247, "learn_time_ms": 2226.202, "learn_throughput": 1516.035, "update_time_ms": 32.248}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 13.9182918548584, "policy_loss": -0.002239859456312843, "vf_loss": 13.92900447845459, "vf_explained_var": 0.00919533371925354, "kl": 0.004713374290171946, "entropy": 0.8473023891448974, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 2.973620927333832, "policy_loss": -0.014075075229629874, "vf_loss": 2.99514297246933, "vf_explained_var": 0.5374214798212051, "kl": 0.006812073557667053, "entropy": 0.7468242228031159, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182250, "num_agent_steps_sampled": 546750, "num_steps_trained": 182250, "num_agent_steps_trained": 546750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7290, "training_iteration": 54, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-59-43", "timestamp": 1706108383, "time_this_iter_s": 13.099722146987915, "time_total_s": 726.3943154811859, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 726.3943154811859, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 34.11764705882353, "ram_util_percent": 67.9470588235294, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.23813763786764705}}
{"episode_reward_max": 20.803356947832306, "episode_reward_min": -16.59329836722702, "episode_reward_mean": 0.41733606836687037, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -31.388222700503707, "policy_agent_": -3.5918138684175442}, "policy_reward_max": {"policy_adversary_": -3.8961582398473893, "policy_agent_": 24.36167208559737}, "policy_reward_mean": {"policy_adversary_": -12.652017899789385, "policy_agent_": 6.534676984078128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9733103853755718, -1.49103712250269, 2.5583164898513604, 10.957573123791605, -0.18422012160621165, 1.818265100661885, -1.4626842557693984, 2.232974384846487, -4.958700829038119, 3.999016753428881, 6.246354935296123, -2.0250193822583795, 4.5717145182107775, 3.8797182925972415, -0.7854104672628952, 7.264035114542828, -6.885279725425215, 1.2772153843361918, 0.5516614778377716, -4.161769653340425, -9.35028033432871, -0.19831036138879357, 10.762641048981687, -1.4288194574673145, 3.3754397036036217, -4.526780769105847, 6.874362251387479, -4.988923425564143, -3.1362140227157536, -13.345346015779471, 2.4036756728999062, -5.012404703316976, -8.613830021558746, -0.9496233010639441, 3.1843277145143345, 4.6678300375756105, -3.393943465679907, 0.7624653696341981, 8.140470843876857, 3.351571389645902, 6.221769459010582, 3.3141058918408524, 9.792435405709881, 0.6979509511899269, -3.667496813073937, -11.575809683911915, 1.8767448068013137, -1.033854293157503, -8.132884932145336, 2.4573292726750493, 2.6707464295841157, -2.543902807255823, 1.9324192130213402, 1.373071019107042, 4.416355903301972, 2.939601013820244, 4.984447318548968, -3.434135688233209, -6.639353045596042, 4.678989473815633, -0.7287138640992864, 11.740374212269543, -0.29949552426834564, -3.964757750623577, 5.58082751886764, 8.091188030202643, -0.24579217631350728, -0.620117513358627, -5.260623732880729, 7.123050446969687, 7.7047862981122845, -0.3738231138388237, -8.147023001265863, -12.926032347989198, -15.708507598584317, -3.210209762594866, 1.4987132361879758, 0.10453766027451228, 9.877672227575118, 12.677885435698192, 3.1975225672822294, -2.6249935266334643, -16.59329836722702, 5.754915184153286, 1.2186705368911739, -0.30604055697071675, 1.6630427056571218, 6.031355330584556, 6.628046980369023, -3.9331563131599028, 0.34928633538064235, -0.9963885317181003, -7.521387853386759, -1.974758113292668, -4.568429023499311, 10.669440150334518, -2.3378011672664245, -11.521100716376699, 11.975021493366102, -4.079429471659104, 3.765913189950213, -8.20214766223765, 20.803356947832306, 3.146487550322099, 17.335121470691043, -6.360100095977753, -2.049030549208975, 15.334781649768528, 3.3984639821537987, -1.664227971695515, 4.341264006253617, 0.2849137298252302, -1.54614100923135, 6.431749637751914, 1.7574193718682793, 6.505170825536739, -0.7399591398331546, -2.6445929583563506, 1.6902225781909008, -4.404174452796677, -8.171387341983444, -14.543114252753362, 9.389532345298589, -1.4971887798959944, -8.968056053185059, 3.888235683630567, 0.3534050247156762, 2.3422319816118122, -5.903934825135673, -1.8269873836329842, -3.5057434342727554, 1.023634578738935, 2.9954046803597527, -3.9593762688808543, 2.258515168910728], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.247116436417338, -7.662345496701593, -13.745902734781463, -19.320117145920733, -6.372736447346405, -15.98042827708085, -14.562054754313253, -14.928588122170204, -9.175325483920771, -12.087031586888578, -13.568638423705583, -5.673520338819977, -12.741428405533139, -12.26392840794809, -11.701569263979556, -14.621314005150763, -12.028398524816131, -8.695251428137553, -6.528143398428884, -9.163841405232452, -11.311968915603556, -7.467391106504331, -16.449979008420996, -11.09319378437947, -10.9969692889394, -18.277814230834927, -12.272045968900867, -10.30584676113929, -18.679670024468347, -15.109015421297345, -13.37834852399278, -6.304009991241955, -13.197983487066722, -8.77783791366855, -8.278021856732297, -14.413504980422418, -8.259545910358002, -11.863600507232135, -13.111877572032116, -14.370640560929948, -15.261390092742587, -9.713644311559461, -17.202947926149815, -9.932935435637484, -7.521932165049915, -12.94815662353005, -9.39479243435257, -3.8961582398473893, -12.616359039988216, -12.343396700629189, -8.906326514226574, -15.711870730525689, -13.354848216587522, -11.496018276943847, -13.403821346701829, -18.664125041326297, -9.203148757831057, -8.958553833945889, -9.119819979198379, -13.945119559877291, -5.945479815868681, -18.794067295788622, -9.144971885346425, -9.243427727771506, -17.875827948112594, -16.58318906647361, -16.07861410520597, -10.457930490957446, -7.27822590773642, -14.194376969273947, -12.727061722506402, -7.837120488845748, -15.040482907077347, -27.298140932697297, -16.140025872794407, -12.344329362568807, -17.394389402189454, -11.91463606568937, -19.032783630032714, -21.67212190419723, -6.8390291880841, -19.523168094222743, -9.40967063039194, -14.513555999248986, -10.28891074612159, -11.380544591725169, -11.017900219810596, -15.15939810939476, -21.11790393933121, -12.104330973813946, -5.790329930204627, -11.737370256833021, -20.950311133948254, -7.722264487518311, -6.320532082108638, -18.71711277001672, -6.08998549638843, -14.661355519000518, -29.94459628874267, -9.015232092938225, -9.310167081293605, -6.23156634761804, -26.828922413291707, -9.580835567405005, -31.388222700503707, -11.931000276427822, -8.11576035152076, -20.53060410055134, -7.7478191997776795, -7.510529277249321, -11.026645890613459, -11.249054831063106, -12.839191391541645, -14.510209451330766, -7.57557098078969, -13.977634871822096, -6.45739974293204, -15.933346474557146, -19.973219346119944, -17.37809007967051, -18.096983320495905, -15.006221841765482, -15.47424882070745, -13.232522702270876, -10.433205766150264, -9.606584370895945, -9.801530765803953, -13.645711084425027, -12.900077807291181, -12.750457875913174, -6.921081570041579, -14.803143428393728, -9.689205224342473, -7.765312398638801, -10.917321939263385], "policy_policy_agent__reward": [4.1369030255208825, 4.1369030255208825, 3.0856541870994523, 3.0856541870994523, 8.152109612316412, 8.152109612316412, 15.138845134856165, 15.138845134856165, 3.0942581628700965, 3.0942581628700965, 8.89934668887137, 8.89934668887137, 6.549685249271927, 6.549685249271927, 8.580781253508349, 8.580781253508349, 2.1083123274413245, 2.1083123274413245, 8.043024170158729, 8.043024170158729, 9.907496679500854, 9.907496679500854, 1.8242504782808004, 1.8242504782808004, 8.656571461871957, 8.656571461871957, 8.071823350272664, 8.071823350272664, 5.458079398358329, 5.458079398358329, 10.942674559846804, 10.942674559846804, 2.57155939969546, 2.57155939969546, 4.986233406236875, 4.986233406236875, 3.5399024381333275, 3.5399024381333275, 2.5010358759460147, 2.5010358759460147, 0.9808442906374191, 0.9808442906374191, 3.634540372557768, 3.634540372557768, 13.606310028701342, 13.606310028701342, 4.832187163456073, 4.832187163456073, 7.186204496271511, 7.186204496271511, 6.875516730864541, 6.875516730864541, 9.57320411014417, 9.57320411014417, 2.658461667787572, 2.658461667787572, 7.771728000876294, 7.771728000876294, 0.8818347027589374, 0.8818347027589374, 7.891012098446344, 7.891012098446344, 0.6458026439624877, 0.6458026439624877, 2.2920767327539884, 2.2920767327539884, 3.914107306302302, 3.914107306302302, 5.731174785623314, 5.731174785623314, 9.540667508999013, 9.540667508999013, 2.4328012223390485, 2.4328012223390485, 6.313032938433169, 6.313032938433169, 10.626174207954488, 10.626174207954488, 8.861105975287925, 8.861105975287925, 10.741579775876584, 10.741579775876584, 6.5138751017001555, 6.5138751017001555, 13.497691665929848, 13.497691665929848, 5.3154431934137065, 5.3154431934137065, 1.92721767598799, 1.92721767598799, 0.6861734698090705, 0.6861734698090705, 5.635768620576942, 5.635768620576942, 1.4311519733449434, 1.4311519733449434, 2.2417370539214367, 2.2417370539214367, 7.400362986652117, 7.400362986652117, 5.788536471905346, 5.788536471905346, 6.5839839616349325, 6.5839839616349325, 7.64363371480443, 7.64363371480443, 6.4345446480254465, 6.4345446480254465, 8.9100886250019, 8.9100886250019, 10.80186302757327, 10.80186302757327, 7.0937980381900125, 7.0937980381900125, 2.762209072856339, 2.762209072856339, 1.2402334668011676, 1.2402334668011676, 9.312054516846464, 9.312054516846464, 2.608382975884697, 2.608382975884697, 15.267220754029083, 15.267220754029083, 4.422738180539039, 4.422738180539039, 2.6393349885739634, 2.6393349885739634, 11.728327733490117, 11.728327733490117, 12.337188548338125, 12.337188548338125, 7.916410964446231, 7.916410964446231, 4.918906488799408, 4.918906488799408, 1.008801087427846, 1.008801087427846, 10.65871370812182, 10.65871370812182, 10.215924010309347, 10.215924010309347, 3.7316486875034633, 3.7316486875034633, 3.44672995290574, 3.44672995290574, 7.186054292354048, 7.186054292354048, 0.21575913710504427, 0.21575913710504427, 4.567059799986972, 4.567059799986972, 9.446551319188712, 9.446551319188712, 6.009586862981944, 6.009586862981944, 14.455227928803914, 14.455227928803914, 17.175003669947706, 17.175003669947706, 5.018275877683164, 5.018275877683164, 8.449087283794645, 8.449087283794645, -3.5918138684175442, -3.5918138684175442, 10.134235591701135, 10.134235591701135, 5.753790641506379, 5.753790641506379, 5.537252017377226, 5.537252017377226, 6.34047146273386, 6.34047146273386, 10.595376719989659, 10.595376719989659, 13.872975459850121, 13.872975459850121, 4.085587330327019, 4.085587330327019, 3.0698081327926343, 3.0698081327926343, 5.370490862557462, 5.370490862557462, 6.714461640280746, 6.714461640280746, 2.8737531871128206, 2.8737531871128206, 0.876051529304664, 0.876051529304664, 14.693276460175618, 14.693276460175618, 1.8760921645610023, 1.8760921645610023, 1.5701274013119118, 1.5701274013119118, 20.959808891054383, 20.959808891054383, 2.4679013106395615, 2.4679013106395615, 6.53804013562191, 6.53804013562191, -0.9852906573098009, -0.9852906573098009, 23.816139680562006, 23.816139680562006, 6.363661558863549, 6.363661558863549, 24.36167208559737, 24.36167208559737, 2.7854500902250323, 2.7854500902250323, 3.0333649011558927, 3.0333649011558927, 17.93269287515993, 17.93269287515993, 5.573141590965742, 5.573141590965742, 2.923150652776904, 2.923150652776904, 7.683954948433536, 7.683954948433536, 5.766984280444168, 5.766984280444168, 5.6465251911551455, 5.6465251911551455, 10.470979544541343, 10.470979544541343, 4.6664951763289855, 4.6664951763289855, 10.241402848679417, 10.241402848679417, 2.858720301549443, 2.858720301549443, 6.644376758100397, 6.644376758100397, 10.83172096215542, 10.83172096215542, 6.486957813436918, 6.486957813436918, 4.962797989256236, 4.962797989256236, 0.23155379450606042, 0.23155379450606042, 12.431890583003021, 12.431890583003021, 5.8676669611874415, 5.8676669611874415, 0.7325748564826035, 0.7325748564826035, 6.747410027263258, 6.747410027263258, 5.077467895259815, 5.077467895259815, 7.993971533018423, 7.993971533018423, 3.4980714910777544, 3.4980714910777544, 5.461735246140098, 5.461735246140098, 1.7076690678844109, 1.7076690678844109, 7.9133890035663335, 7.9133890035663335, 6.342304952351112, 6.342304952351112, 1.9029680648789733, 1.9029680648789733, 6.587918554087058, 6.587918554087058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3426126805114401, "mean_inference_ms": 2.2604987841624364, "mean_action_processing_ms": 0.09923429782069741, "mean_env_wait_ms": 0.5939980379417769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 185625, "timesteps_this_iter": 0, "agent_timesteps_total": 556875, "timers": {"sample_time_ms": 13782.589, "sample_throughput": 244.874, "load_time_ms": 0.299, "load_throughput": 11279502.789, "learn_time_ms": 2258.874, "learn_throughput": 1494.107, "update_time_ms": 32.749}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.79816131591797, "policy_loss": 0.004032116383314133, "vf_loss": 16.802454948425293, "vf_explained_var": -0.019588613510131837, "kl": 0.00349599872745181, "entropy": 0.8325489103794098, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.948198163509369, "policy_loss": -0.008753026276826859, "vf_loss": 3.9643898129463198, "vf_explained_var": 0.48562915027141573, "kl": 0.007102551430975807, "entropy": 0.746084240078926, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 185625, "num_agent_steps_sampled": 556875, "num_steps_trained": 185625, "num_agent_steps_trained": 556875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7425, "training_iteration": 55, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_15-59-57", "timestamp": 1706108397, "time_this_iter_s": 14.199321031570435, "time_total_s": 740.5936365127563, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 740.5936365127563, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 38.87777777777777, "ram_util_percent": 67.83333333333333, "gpu_util_percent0": 0.05222222222222222, "vram_util_percent0": 0.23689778645833334}}
{"episode_reward_max": 15.413096105694791, "episode_reward_min": -12.462179682545527, "episode_reward_mean": 1.2884060873860164, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -34.36458648123957, "policy_agent_": -2.1599154687988698}, "policy_reward_max": {"policy_adversary_": -4.328422518656548, "policy_agent_": 21.387924662557076}, "policy_reward_mean": {"policy_adversary_": -13.05216458268977, "policy_agent_": 7.170285335037894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6102660479579567, 4.676438489982018, 5.154331267998903, 4.3948967722859855, -0.08886313743347589, 2.0693201709803586, 2.7976079045359676, 1.9826052493384438, -4.250370524952722, 3.1275563073092103, -0.6588713593479779, 1.081553991217924, -4.613476055771881, 4.126739765037038, 2.530764417455742, 10.835620228730768, 14.076333512410745, -7.667798430879632, -10.086383981171899, 6.751528163933919, 3.7036684065098404, -2.576799765164786, -0.5035542475704797, 4.677332047601597, -5.054267658044832, 5.712731472381221, 2.693707828203417, -3.910255512055862, -8.087644807445926, 2.6571027354246435, 5.994275283915214, 6.307736880832085, -0.8213770192433019, -3.7318313601699575, -4.086352678456654, 5.3858683870761475, -1.5083317311651883, 8.883897910906835, -1.0298040909168316, -2.564651115439435, -0.24000787305086568, 9.218432596572704, 4.4629601853814185, -2.199885674443511, 7.040284656208476, 1.3453920299607525, -12.355891587466513, 0.5801758515266704, 4.882020231819291, -1.0626900627309435, -1.3279634619263592, -4.740373238904615, 9.557070664502204, 1.1709284311717325, 3.2353712256467575, -0.15530610007579682, -5.938171520570847, 7.50448685070126, 1.9643764464767306, 3.354915142868401, 11.590188519008304, -9.321190604105459, 4.869516224184991, -0.7999748914874175, -5.908837429110814, 2.7407898773251222, -0.08029651942919641, -2.8464205316815483, 0.872767920352362, -9.091737957740461, 1.8300282479470322, -5.695772194895041, -9.57578822114848, 8.32356355189673, 6.246225330997536, 11.139894357146659, 12.314261272237342, 10.78837213992058, -12.462179682545527, -5.83336329180027, 1.8866244795050195, -7.618755291769906, -2.1552444510784046, 0.4203038356841423, 0.7180212293901731, 5.582547464760723, -1.6804187669729362, 8.411262843874594, 9.625329759414782, -8.286002515730413, 2.016126935098725, 7.010323714254571, -0.4643597688684762, 4.093482280732351, 4.249570166141194, 4.956818948578766, -9.308693482496631, -6.154903463493108, -2.517488963583609, 1.865915375561924, -8.43417598832438, 0.09082513824333657, 0.594794397662635, 7.7135980794745445, 5.105809894009306, 2.1322140731786585, -11.699286623340795, 11.124225375528765, -0.314450248392778, 5.670958956919989, 4.525598483746094, 6.944706822294739, 0.905030170174826, 7.648993035215568, 3.5178631510110017, -3.596036709984265, 1.4577784921977486, 1.7887204345302297, 6.625869148946394, -6.1603749720904615, 3.782716548310039, 15.413096105694791, 2.105862438741168, 1.8321977913935668, 9.241560500326566, 0.9567618655826593, 6.323458449310078, 0.3991225833678532, 5.976869845760818, -4.776551538789761, -2.288347239740083, 2.1460560893085656, 0.9386271234732648, 0.23978492889102504, -2.036935812057512], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.144209289795963, -13.114023674359771, -12.177537865626446, -11.600669465982794, -11.366706540418335, -9.886307714402921, -15.03265902137377, -12.838691147460716, -11.426526709018885, -13.386661721486835, -12.728711430078617, -8.073002160612642, -6.4129833312351865, -11.125687442180451, -24.899238505879797, -18.47661091747254, -20.960431045234927, -12.415511386062585, -12.406613854644322, -18.910038232861226, -16.412237008138714, -6.02415903697062, -11.513829516713704, -17.877300808640143, -11.025289167226816, -18.00792534730206, -10.13889040372829, -13.693484828261116, -10.8442726568873, -11.377518307185806, -11.537389403774739, -21.198739495937456, -6.097364078677659, -5.725054348310821, -11.823967388666603, -18.734896568062865, -13.6718415736856, -15.111392655347267, -10.802247323956841, -9.867513308712402, -6.5140751878816605, -18.340396943904352, -10.92977468676007, -7.493931798902945, -19.665295512613778, -12.771277215964373, -8.036060649868775, -9.911952061634036, -13.091988940768957, -14.820825038236178, -6.9006380306396995, -15.76387365845112, -16.55569624704165, -9.307322995538962, -9.538650135733926, -10.873749887605754, -8.24916131518326, -17.081755739246415, -10.617230751302234, -10.472248785350047, -19.613181005002055, -13.33620866072169, -9.852515000729865, -10.685968622901195, -23.225679471673807, -13.329155793561181, -8.863905056459705, -15.882838145640815, -12.208211970554704, -11.011669366027313, -7.343506071684189, -10.285543795008419, -17.357735674502496, -24.178218257059196, -13.087187563233417, -14.377939141254952, -20.13713845709892, -15.979804442660278, -14.55425153020033, -11.996782796519124, -6.280438546094801, -7.524603373651063, -8.50293339860286, -10.698299446330003, -8.32020821470139, -13.52599761859242, -12.729982834161547, -34.36458648123957, -17.725672918208744, -6.593441256585224, -12.092495813878687, -12.702225960261623, -10.12289813901289, -12.439295688378326, -15.484397774656193, -20.75666778804009, -15.41932774618193, -7.155139091503333, -17.28593433622046, -15.25169184254538, -10.055625815059113, -9.135054158537478, -9.708610855762931, -16.02701378816124, -17.561162288299332, -7.293252298037662, -14.609574576360206, -19.66283221567681, -9.132995398084741, -13.720081768053156, -13.340408327625777, -14.534291508892293, -7.90361377193208, -16.356705532586894, -15.889724207811392, -20.754791155510325, -8.811101641135144, -10.414776023938211, -13.035935874979714, -4.328422518656548, -11.479362718445236, -22.875645480809396, -9.951249122472905, -14.606628876035533, -13.944949239029286, -8.582428333466583, -10.988856543514972, -10.919239936730241, -24.024512906810003, -9.168488547731428, -7.747060217356913, -9.952805612161278, -10.3746791607259, -12.645613146343178, -15.417005740041265], "policy_policy_agent__reward": [10.377237668876958, 10.377237668876958, 8.895231082170893, 8.895231082170893, 8.665934566812673, 8.665934566812673, 7.9977831191343896, 7.9977831191343896, 5.638921701492429, 5.638921701492429, 5.97781394269164, 5.97781394269164, 8.915133462954868, 8.915133462954868, 7.410648198399579, 7.410648198399579, 3.5880780920330797, 3.5880780920330797, 8.257109014398024, 8.257109014398024, 6.034920035365321, 6.034920035365321, 4.577278075915284, 4.577278075915284, 0.8997536377316561, 0.8997536377316561, 7.626213603608744, 7.626213603608744, 13.715001461667768, 13.715001461667768, 14.656115573101657, 14.656115573101657, 17.51838227882283, 17.51838227882283, 2.373856477591476, 2.373856477591476, 1.1601149367362142, 1.1601149367362142, 12.83078319839757, 12.83078319839757, 10.057952707324278, 10.057952707324278, 1.7236796359029152, 1.7236796359029152, 5.505137634571609, 5.505137634571609, 11.277316428120873, 11.277316428120873, 2.985510754590994, 2.985510754590994, 11.86032840984164, 11.86032840984164, 6.4162991159658525, 6.4162991159658525, 4.89161465810263, 4.89161465810263, 1.3783139247206868, 1.3783139247206868, 7.017310521305226, 7.017310521305226, 8.765832343844975, 8.765832343844975, 13.753238188384769, 13.753238188384769, 2.6379935297171797, 2.6379935297171797, 0.9966114940704338, 0.9966114940704338, 3.8688073551049764, 3.8688073551049764, 12.060382477569508, 12.060382477569508, 6.081754921260205, 6.081754921260205, 11.997645283127051, 11.997645283127051, 4.886221616520004, 4.886221616520004, 3.6514310966364842, 3.6514310966364842, 3.137033657415398, 3.137033657415398, 13.779414770238526, 13.779414770238526, 7.696367436070741, 7.696367436070741, 2.6470230622297173, 2.6470230622297173, 13.352790084411128, 13.352790084411128, 7.058334622962561, 7.058334622962561, -2.1599154687988698, -2.1599154687988698, 5.246063956580353, 5.246063956580353, 8.987004586294125, 8.987004586294125, 6.879067487752615, 6.879067487752615, 2.7863372843566707, 2.7863372843566707, 5.511750209773251, 5.511750209773251, 13.056383455771925, 13.056383455771925, 5.239125713355349, 5.239125713355349, 6.3870106806903415, 6.3870106806903415, 5.359221893764978, 5.359221893764978, 1.155494897306205, 1.155494897306205, 12.293121294973833, 12.293121294973833, 6.29080359888948, 6.29080359888948, 6.913581964109222, 6.913581964109222, 15.601684762005178, 15.601684762005178, 2.0075090283081134, 2.0075090283081134, 7.361015612457429, 7.361015612457429, 4.942996865706888, 4.942996865706888, 8.658421021281494, 8.658421021281494, 8.03497283544315, 8.03497283544315, 4.391804268515253, 4.391804268515253, 6.518208806979631, 6.518208806979631, 6.54048994545353, 6.54048994545353, 0.959965704143422, 0.959965704143422, 4.586767159815609, 4.586767159815609, 2.294885800056689, 2.294885800056689, 3.8909737266770046, 3.8909737266770046, 16.25089090447796, 16.25089090447796, 9.666706447115478, 9.666706447115478, 12.758916749200806, 12.758916749200806, 16.22569986466813, 16.22569986466813, 13.384088291290428, 13.384088291290428, 1.0460359238274013, 1.0460359238274013, 3.08170975235943, 3.08170975235943, 4.08353151279991, 4.08353151279991, -0.04707595905942401, -0.04707595905942401, 3.173844473762227, 3.173844473762227, 5.559301641007073, 5.559301641007073, 4.519114722045783, 4.519114722045783, 9.554272541676571, 9.554272541676571, 5.524782033594308, 5.524782033594308, 21.387924662557076, 21.387924662557076, 13.675501338811761, 13.675501338811761, -0.8462806295725942, -0.8462806295725942, 7.054311374488707, 7.054311374488707, 9.856274837258098, 9.856274837258098, 4.829269185072207, 4.829269185072207, 8.266388984555338, 8.266388984555338, 9.866983970398692, 9.866983970398692, 12.856743368309429, 12.856743368309429, 3.0553171318426493, 3.0553171318426493, 0.500117814005114, 0.500117814005114, 7.384222686318426, 7.384222686318426, 8.558803609053655, 8.558803609053655, 0.810724913367369, 0.810724913367369, 4.612939648390409, 4.612939648390409, 5.1517026267127815, 5.1517026267127815, 11.870305933817887, 11.870305933817887, 11.333486091154318, 11.333486091154318, 4.712733185608158, 4.712733185608158, 1.4551439765097094, 1.4551439765097094, 15.393528795602789, 15.393528795602789, 4.409272574845982, 4.409272574845982, 9.695520362486572, 9.695520362486572, 8.933003405685938, 8.933003405685938, 10.73949916559351, 10.73949916559351, 4.404321971053451, 4.404321971053451, 12.002849283901236, 12.002849283901236, 9.7037936794112, 9.7037936794112, 8.579377222763034, 8.579377222763034, 5.134440066666447, 5.134440066666447, 6.101748229234218, 6.101748229234218, 9.83090251196305, 9.83090251196305, -0.9159762267169568, -0.9159762267169568, 7.631039633377636, 7.631039633377636, 19.144370793252104, 19.144370793252104, 6.028555780607037, 6.028555780607037, 8.219413333714549, 8.219413333714549, 11.593254869677928, 11.593254869677928, 4.769595099524622, 4.769595099524622, 8.656157496412524, 8.656157496412524, 5.659181260049046, 5.659181260049046, 15.000691376285415, 15.000691376285415, 2.1959685044708337, 2.1959685044708337, 2.7293564888084147, 2.7293564888084147, 6.049430850734922, 6.049430850734922, 5.656653142099584, 5.656653142099584, 6.4426990376171, 6.4426990376171, 6.690034963991877, 6.690034963991877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34289949656470065, "mean_inference_ms": 2.2613278920440996, "mean_action_processing_ms": 0.09932235524343182, "mean_env_wait_ms": 0.5941838225507823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 189000, "timesteps_this_iter": 0, "agent_timesteps_total": 567000, "timers": {"sample_time_ms": 13845.479, "sample_throughput": 243.762, "load_time_ms": 0.399, "load_throughput": 8461818.399, "learn_time_ms": 2255.938, "learn_throughput": 1496.052, "update_time_ms": 31.752}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.786773872375488, "policy_loss": -0.006405209260992706, "vf_loss": 16.801603889465333, "vf_explained_var": 0.00930323600769043, "kl": 0.0061194429635138435, "entropy": 0.8424975216388703, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.678585982322693, "policy_loss": -0.014273613318800926, "vf_loss": 3.7001932740211485, "vf_explained_var": 0.5643280684947968, "kl": 0.005444147793206422, "entropy": 0.7350672990083694, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 189000, "num_agent_steps_sampled": 567000, "num_steps_trained": 189000, "num_agent_steps_trained": 567000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7560, "training_iteration": 56, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-00-11", "timestamp": 1706108411, "time_this_iter_s": 13.664785385131836, "time_total_s": 754.2584218978882, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08E48550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 754.2584218978882, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.99411764705883, "ram_util_percent": 67.60588235294118, "gpu_util_percent0": 0.04764705882352942, "vram_util_percent0": 0.23797966452205882}}
{"episode_reward_max": 21.432837557005655, "episode_reward_min": -11.656080054738982, "episode_reward_mean": 1.2471909169996882, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -35.89852106566172, "policy_agent_": -0.8425312138879423}, "policy_reward_max": {"policy_adversary_": -2.941536949950854, "policy_agent_": 28.665679311333683}, "policy_reward_mean": {"policy_adversary_": -12.569796825024259, "policy_agent_": 6.908493871011975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7066827191240086, 1.864451093814369, -9.74844135360599, 3.8690460335616605, 8.12276376403851, 3.7414809586111994, 10.676908264745732, 4.9136457395692545, 2.4269304784696724, -8.715784410621627, -9.274518247281643, -2.2190159584096647, 3.5595530157091866, -0.7327132115608794, -0.3566165080283198, 12.22866675538753, 7.280753026808286, 6.514132349852899, -2.695318093539626, -0.992362960311439, -10.840317794248378, -2.9944964749235967, -1.6476449078404491, 0.7976787548474751, 6.729081869251676, -7.066126709485967, -9.526810375878275, 3.3839429031333657, -2.6373677820915633, 5.079999088772813, -10.573421197295447, 7.725504897588393, 4.058258480091979, 2.21744187246163, 0.7327971688592736, 2.745327648822233, 8.17978346768142, 1.1161762514184888, 13.072205473499512, 4.707829948515168, 0.6719187202266754, 15.3920897689506, 4.476815601055253, 1.2656155507420783, 0.8791693010929802, 21.432837557005655, 5.96255489213179, 1.8834956879588935, 1.1852932597357124, -3.208132984343618, 5.1637806552986785, -9.700720814977199, 6.645160950670968, 4.832645566457139, -0.23655723725621036, -7.034688616266684, 3.138798199076806, 2.6394164473597277, 2.1097799100717634, -1.877852860168114, -1.726917030417385, -1.555446983605897, 3.6486249378384303, 13.967778393455632, 4.482944103958116, 0.9923241649205072, 3.7982029980015284, -2.4529951030072024, -2.0564459952485836, -4.8071280981628535, 2.2675562028372376, 2.3401325626065557, 1.6455654890357387, 1.368435580923068, 3.519584225804126, 2.103625086717491, 11.464250248876116, -4.02283757693431, 2.4364001416391474, 1.4979845173785586, 6.680162116443425, -0.535422757564521, 5.440382955018237, -8.675062884603681, 3.8212185006378685, 0.2241333667535985, -2.589291400979227, -2.5587632338008124, -2.909791286542406, 0.6644226478533808, 3.122839046158197, -4.36923986650175, 6.426152540432876, 4.836948215561006, -3.650209089740798, -4.056552501178773, 5.56775375478456, -3.023602481901351, 1.3995134213734508, 1.7227788381711995, 8.598132999929149, 1.6263302189724367, 1.5316257627648913, 3.6883311324034604, 4.509272397083903, 1.812652430700357, -3.453949567059332, 12.21841550906466, 3.7739279098811083, 8.121275340057185, 2.865046865283829, -0.4967915285245863, 5.968871237295184, 5.188480321816482, -11.656080054738982, -4.331454575930876, -6.358809303857257, -7.757380881088126, 4.05595903788192, 4.688850030769662, -6.0430767371960625, -2.075058675196763, -9.13387200341552, -7.514098533120856, 2.7886326969680475, -1.178688748432585, 6.44870589591578, -3.5771766378818706, -2.420293957668535, 0.24544064042865552, 4.754722953786546, -7.69772758221351, 0.4078698561761938, 11.0526085060387, 2.631932914986364], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.578975631214085, -8.101221418714948, -9.093194016390234, -11.119722575137702, -13.736872283558068, -15.58125356561939, -27.134202344821425, -16.869468672062247, -8.29350779897247, -7.030721982845743, -8.397688209901512, -5.906263483800112, -10.297220842800993, -6.816341401865197, -11.024716255080454, -17.77526237522204, -14.900820885444942, -12.190953690324871, -4.991493166941745, -17.557193856919238, -20.501335115418133, -14.76103127937771, -11.460182716673906, -6.378686994965427, -22.461290644798293, -10.859730782555477, -8.235669119262347, -11.958662333738694, -7.590345593361604, -11.100546444011838, -13.767382493490423, -15.811490596194615, -8.798653922158175, -9.377300125609088, -9.089259124381535, -9.846616882805803, -16.99287572008181, -11.832683288814849, -29.495965021080803, -17.17034595595588, -14.535011873978592, -24.277588991602578, -15.170210545580003, -10.330172818987561, -12.759490150908753, -35.89852106566172, -13.790744162025353, -9.395245194095706, -10.88241817842728, -9.181518849485958, -10.691702084142177, -11.028629591999948, -15.00718617096725, -13.19329552608102, -10.923675543960105, -10.054513844405754, -10.122657023119865, -10.753174510122676, -6.344396317072849, -14.80076948246548, -23.39226497633174, -14.61860423036163, -13.561399165309126, -20.35550509642807, -11.722871634386049, -12.678892917468575, -13.991699257251424, -4.989169851820717, -8.0118699542367, -8.371943128323942, -8.008335957074669, -15.269332548815111, -12.640746346142882, -11.664111526824843, -11.422605865979964, -21.38831632170103, -19.90561050353876, -4.5683791973795, -9.617330413809995, -6.473172405421449, -14.906412235621723, -6.070622397127688, -13.716205747866942, -12.399804207929757, -9.789910657385228, -9.07905208568361, -2.941536949950854, -13.868191722424099, -14.334017092428269, -12.080177451230114, -12.578515470447588, -6.602266802159499, -16.081214942810846, -12.486774410602653, -11.723301368130537, -6.670305117526053, -13.801677907012564, -16.802054857462828, -7.381287821657102, -22.567814068607095, -14.389096643992982, -6.668875287349915, -13.400227031184288, -12.637162946990278, -16.756172278912956, -13.966411574980317, -8.333530590091202, -19.686131676745482, -11.51538251871655, -18.405463357309454, -9.88067445284401, -9.095620021928472, -17.121940853666096, -10.084396178677519, -13.513222320888033, -12.241565230275972, -4.997472726817191, -8.38066910974146, -9.940099977469833, -12.064901637385042, -10.19551304373203, -9.11583891600002, -19.82144469728828, -8.06102256985699, -12.209946679691809, -13.608944838540218, -13.297608844920818, -8.517453120250101, -13.658415562569802, -7.2247651547641425, -15.953565871831229, -17.296449178619042, -17.906317042079355, -18.75912284596309, -7.655771446065554], "policy_policy_agent__reward": [2.9361464560450377, 2.9361464560450377, 4.98283625626466, 4.98283625626466, -0.3276236686078765, -0.3276236686078765, 7.4943843043496825, 7.4943843043496825, 10.92981802379829, 10.92981802379829, 9.661367262115293, 9.661367262115293, 18.905555304783583, 18.905555304783583, 10.891557205815745, 10.891557205815745, 5.360219138721072, 5.360219138721072, -0.8425312138879423, -0.8425312138879423, -0.4384150186900687, -0.4384150186900687, 1.8436237626952243, 1.8436237626952243, 6.928386929255091, 6.928386929255091, 3.0418140951521577, 3.0418140951521577, 5.3340498735260695, 5.3340498735260695, 15.001964565304785, 15.001964565304785, 11.09078695612661, 11.09078695612661, 9.352543020088884, 9.352543020088884, 1.1480875367010597, 1.1480875367010597, 8.2824154483039, 8.2824154483039, 4.8305086605848775, 4.8305086605848775, 5.883267402227056, 5.883267402227056, 4.906268904416729, 4.906268904416729, 3.5881828749064506, 3.5881828749064506, 14.595186257024983, 14.595186257024983, 1.8968020365347575, 1.8968020365347575, -0.6455706283079614, -0.6455706283079614, 7.671302618436029, 7.671302618436029, 2.476488905635022, 2.476488905635022, 8.090272766392324, 8.090272766392324, 1.5969806480974864, 1.5969806480974864, 11.768497746891502, 11.768497746891502, 6.428456201125077, 6.428456201125077, 5.797370999035359, 5.797370999035359, 4.9110281466204055, 4.9110281466204055, 6.295972265814017, 6.295972265814017, 12.58632959388161, 12.58632959388161, 6.474429770116668, 6.474429770116668, 21.284085247290154, 21.284085247290154, 10.939087952235525, 10.939087952235525, 7.603465297102634, 7.603465297102634, 19.834839380276588, 19.834839380276588, 9.823513073317631, 9.823513073317631, 5.79789418486482, 5.79789418486482, 6.819329726000866, 6.819329726000866, 28.665679311333683, 28.665679311333683, 9.876649527078566, 9.876649527078566, 5.6393704410273, 5.6393704410273, 6.033855719081495, 6.033855719081495, 2.98669293257117, 2.98669293257117, 7.92774136972043, 7.92774136972043, 0.6639543885113776, 0.6639543885113776, 10.82617356081911, 10.82617356081911, 9.012970546269077, 9.012970546269077, 5.343559153351947, 5.343559153351947, 1.5099126140695327, 1.5099126140695327, 6.630727611098334, 6.630727611098334, 6.696295478741201, 6.696295478741201, 4.227088113572307, 4.227088113572307, 6.461458311148685, 6.461458311148685, 10.832673972957176, 10.832673972957176, 6.531578623377865, 6.531578623377865, 8.605012051573782, 8.605012051573782, 17.16164174494185, 17.16164174494185, 8.102907869172082, 8.102907869172082, 6.83560854119454, 6.83560854119454, 8.894951127626477, 8.894951127626477, 1.2680873744067567, 1.2680873744067567, 2.9777119794940576, 2.9777119794940576, 1.7824075150805436, 1.7824075150805436, 5.137946079955954, 5.137946079955954, 8.804732555710835, 8.804732555710835, 7.1431559175893105, 7.1431559175893105, 6.516273553873958, 6.516273553873958, 7.4710950458920475, 7.4710950458920475, 11.745970704209263, 11.745970704209263, 15.684930376207438, 15.684930376207438, 0.27277081022259536, 0.27277081022259536, 6.026865277724569, 6.026865277724569, 3.9855784614000034, 3.9855784614000034, 10.793287176032576, 10.793287176032576, 2.7675998197815836, 2.7675998197815836, 9.578294351442592, 9.578294351442592, 1.862370661663036, 1.862370661663036, 6.8055645790115475, 6.8055645790115475, 4.651592726218604, 4.651592726218604, 0.17612277448581404, 0.17612277448581404, 5.654714244311645, 5.654714244311645, 5.712112902942931, 5.712112902942931, 6.372300049541747, 6.372300049541747, 7.850677258302892, 7.850677258302892, 1.1165134678288757, 1.1165134678288757, 11.25368374162186, 11.25368374162186, 8.661861313081829, 8.661861313081829, 4.0365461391948685, 4.0365461391948685, 1.30687630817364, 1.30687630817364, 9.684715830898561, 9.684715830898561, 6.889226187780739, 6.889226187780739, 4.390400621515277, 4.390400621515277, 12.145296453389145, 12.145296453389145, 11.493614821961064, 11.493614821961064, 4.147602753161176, 4.147602753161176, 7.465926396974589, 7.465926396974589, 8.162747039696866, 8.162747039696866, 10.632722337998427, 10.632722337998427, 7.889532002840338, 7.889532002840338, 2.4397905115159344, 2.4397905115159344, 15.952273592905074, 15.952273592905074, 7.64465521429883, 7.64465521429883, 13.263369348683325, 13.263369348683325, 6.372860659063922, 6.372860659063922, 4.299414246701942, 4.299414246701942, 11.545406045480641, 11.545406045480641, 7.636438250246998, 7.636438250246998, 0.928571133074526, 0.928571133074526, 3.9550553271725484, 3.9550553271725484, -0.6806682885200326, -0.6806682885200326, 0.3116441143266641, 0.3116441143266641, 6.998029507675875, 6.998029507675875, 8.37687583407735, 8.37687583407735, 2.0762181532679844, 2.0762181532679844, 3.520390120401629, 3.520390120401629, 5.34378634693638, 5.34378634693638, 0.2734620183680666, 0.2734620183680666, 7.499289688329928, 7.499289688329928, 6.215128045053815, 6.215128045053815, 9.873157370418303, 9.873157370418303, 2.470138241184114, 2.470138241184114, 5.619060802450633, 5.619060802450633, 3.735102897596398, 3.735102897596398, 10.354144412808887, 10.354144412808887, 4.799360798202768, 4.799360798202768, 9.157093449127775, 9.157093449127775, 14.905865676000893, 14.905865676000893, 5.14385218052596, 5.14385218052596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3434036705328161, "mean_inference_ms": 2.264321905003733, "mean_action_processing_ms": 0.09940621639519476, "mean_env_wait_ms": 0.5951892777890739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 192375, "timesteps_this_iter": 0, "agent_timesteps_total": 577125, "timers": {"sample_time_ms": 13938.552, "sample_throughput": 242.134, "load_time_ms": 0.499, "load_throughput": 6769535.651, "learn_time_ms": 2255.909, "learn_throughput": 1496.071, "update_time_ms": 31.749}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.556503677368163, "policy_loss": -0.017442104406654835, "vf_loss": 16.582768440246582, "vf_explained_var": 0.01280844807624817, "kl": 0.0052566179540493255, "entropy": 0.8822504639625549, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.915486252307892, "policy_loss": 0.016880007274448872, "vf_loss": 3.9061583042144776, "vf_explained_var": 0.5525861799716949, "kl": 0.005162670503392672, "entropy": 0.756821158528328, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192375, "num_agent_steps_sampled": 577125, "num_steps_trained": 192375, "num_agent_steps_trained": 577125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7695, "training_iteration": 57, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-00-25", "timestamp": 1706108425, "time_this_iter_s": 14.240399360656738, "time_total_s": 768.4988212585449, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 768.4988212585449, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 38.652631578947364, "ram_util_percent": 66.68947368421051, "gpu_util_percent0": 0.15263157894736842, "vram_util_percent0": 0.23127826891447367}}
{"episode_reward_max": 18.689625523335597, "episode_reward_min": -23.02639637917264, "episode_reward_mean": 1.5499123927403684, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -33.199074893571876, "policy_agent_": -6.735076958910763}, "policy_reward_max": {"policy_adversary_": -4.233002646978346, "policy_agent_": 22.71683027960333}, "policy_reward_mean": {"policy_adversary_": -12.893469093797638, "policy_agent_": 7.221690743269004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4748834909815014, 2.123957964262239, -6.034528297250253, 11.156723630630855, 2.8828545048828174, 5.138761698893807, 8.503287078426629, 9.810885164562423, 10.12122619758118, -5.742871636979394, -1.0805465610277394, -0.18398155973943264, 7.375105622863519, -10.422970332390275, 6.640293493304483, -1.032383659206146, 2.423589304325855, 11.886550021022867, 8.888029724266273, 1.9771407482985741, 12.340649109109123, -5.988229211723677, -1.4727510467755618, -0.17632622553658298, 1.6784356244613128, 0.5888490571376186, 9.369176744235983, 3.7485335541633686, 7.166879366425495, -0.9587739583172421, 2.737941603169011, -11.188909367087975, 3.316241272567742, 3.8977949816926714, 10.524952578145465, 3.858803337703302, -1.549101923720896, 1.2452777422352748, 4.153671176885676, -2.905649803341291, 8.356248241268158, 5.791094848459529, 0.38668031307179185, -14.399644902780985, 8.301299455799322, 6.096613885331873, -7.162823749584918, -0.9093762052859842, 2.1951826729309105, 3.4343631066782403, -6.1378961614755125, -1.7358945978431195, 5.23564770780636, 0.46389272976988283, 1.0092140720512046, -3.933538202783034, -1.4025505163185663, 1.3245225069576485, 5.904631620484607, -2.5254525864333353, -3.1321732538946048, -0.8471062783118626, 2.9127649108807034, 1.086045300941366, -0.553659433933741, -4.932171557264935, 5.044209059296469, 3.4956311924046872, 3.799929482034771, -5.308016018353816, 0.5021515746951251, 0.9114076864601386, 1.67587947884916, -0.9526541257661492, -1.210528202451334, 6.441934494179118, 2.2724487830682496, 0.14407187671408728, -3.3005501353409983, 5.078659656301119, -1.7804177003750352, 12.095780922786597, 4.263603856054409, 2.1989094767842783, 9.761711785445588, 8.003113079555202, -4.725281022523174, 0.9657997580002173, 0.9865897099078673, 16.385281552217236, 0.2667518141163848, -23.02639637917264, 2.216447850970493, 2.289819071490927, -12.656180011575383, -2.8756363406525147, 6.15702589381094, -0.3374247193318986, -4.958414571033233, -0.15234204824873715, 7.128590055313097, 0.4068669621856415, 7.386007022846339, -2.286856352728951, 8.07487105198757, 1.426699362606435, 3.568551839876145, -3.1518150787185566, -1.7727065494133787, 0.8052316512719044, 2.3528731460272456, 2.578838696909448, 4.59964227450779, 3.9270574351229417, 2.009134270255501, 5.212854087098099, -2.027846863249003, -0.5060688002687654, 1.3880395815862552, 3.6479548072443575, 5.428875467493499, 18.689625523335597, 1.0667753602534038, -1.782817970944005, 1.840311344754514, 2.372966770457218, 7.3679229668998545, -5.675973251978431, 0.6739224854562361, -3.899833987703296, -2.9577240817487898, -1.3027054229843904, 4.108435184846033, 0.49782513601173733, -6.750053020637329], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.252389972928196, -8.969415234305703, -8.836753044948477, -16.549704729923008, -12.011277652862576, -9.619580736604966, -20.124587601023407, -16.270836962983918, -14.24197037958333, -12.982744464320902, -10.716279271311734, -7.229980377240331, -18.416337184275697, -12.009032467471584, -14.631885775632963, -16.601093672580415, -7.373974202156481, -20.42553273136641, -20.60714032283214, -17.914247951917215, -17.272695408822404, -11.470837658061434, -8.98601550652388, -17.10735125372534, -6.019452324295483, -5.72143467264681, -17.63155413092998, -12.408523702685843, -22.028721131412315, -14.305270202624111, -9.88166143336808, -13.76166055903931, -12.241541935575178, -9.922825642629324, -14.434443480748715, -8.896405189610425, -18.615536121085338, -9.531921358509784, -9.943891809442281, -8.277608510358803, -23.020200464356936, -13.688976811872042, -10.976440958503861, -28.19832813420025, -19.062952023296383, -17.796996999962904, -10.49972639252853, -11.079216588438118, -10.663048912240885, -11.595065965571791, -4.233002646978346, -10.767205484315166, -9.317576667643081, -24.99052976326116, -7.695176765405126, -9.284436777458119, -15.438292709445589, -15.537172687337765, -13.474027578166524, -13.778806823491612, -11.80326296333219, -5.111242717025431, -12.376971573314757, -10.141526737507649, -6.161230674299956, -9.928710722517662, -15.035125839789476, -8.459048745176604, -8.928855964084077, -4.820182852430291, -12.508042827688914, -14.228822988935853, -15.600697153746548, -5.7530044470216515, -8.389427560591304, -15.472142056587394, -5.7578476250604345, -13.664352117698764, -16.154801684193203, -20.098504470653374, -10.669464088422, -21.706771743901513, -12.586257509213738, -7.190159816274368, -16.26961289537809, -13.246066829493424, -6.979273044698095, -26.048090317250043, -8.925343489903813, -29.048379006989435, -5.790294087604426, -9.556242461351122, -15.67214203288145, -12.665230170351322, -9.049413733131024, -7.100554810059655, -12.657312607384785, -16.78878432592895, -12.923613808793414, -8.236276795437496, -14.965042289523957, -7.90127673377347, -19.572460147508167, -11.472245959180658, -16.701635066358932, -8.713224246744717, -10.925587899281284, -17.24556695888349, -13.29493072365166, -8.62557079595946, -8.946982174929312, -13.249510120176984, -8.786238691197132, -11.246594662296584, -7.9382134825700055, -13.366953086602198, -6.220986596066151, -10.102672704732262, -12.072335040590279, -13.463923793277509, -12.919700392597727, -25.378832383971197, -13.32909054523786, -11.921123703204465, -12.999513983274051, -8.924600973086468, -18.367367215022487, -4.8968073605648055, -9.042059692135455, -8.212888355378125, -20.55191252021519, -9.153874920987699, -14.278353909884684, -33.199074893571876, -10.786792421302732], "policy_policy_agent__reward": [7.3636367319548475, 7.3636367319548475, 5.54668659928397, 5.54668659928397, 1.4011123738491111, 1.4011123738491111, 13.853214180276932, 13.853214180276932, 7.447066078872696, 7.447066078872696, 7.379171217749388, 7.379171217749388, 14.31393733972502, 14.31393733972502, 13.040861063773171, 13.040861063773171, 12.181598288582254, 12.181598288582254, 3.619936413670753, 3.619936413670753, 4.817866355141996, 4.817866355141996, 3.5229994087504486, 3.5229994087504486, 12.895721403569606, 12.895721403569606, 0.7930310675406529, 0.7930310675406529, 10.636089634468721, 10.636089634468721, 7.784355006687135, 7.784355006687135, 4.898781753241168, 4.898781753241168, 16.156041376194636, 16.156041376194636, 14.747585023549206, 14.747585023549206, 9.945694350107896, 9.945694350107896, 14.806672258965763, 14.806672258965763, 2.741304223168881, 2.741304223168881, 3.75663222987416, 3.75663222987416, 8.465512514094382, 8.465512514094382, 3.8489439743783977, 3.8489439743783977, 3.1551418648922143, 3.1551418648922143, 13.500365437582982, 13.500365437582982, 8.078528628424603, 8.078528628424603, 14.597800248918897, 14.597800248918897, 6.673248122153435, 6.673248122153435, 6.309801518268546, 6.309801518268546, 1.2863755959756649, 1.2863755959756649, 7.77889160407146, 7.77889160407146, 6.910310312160997, 6.910310312160997, 12.47969802944709, 12.47969802944709, 6.377604263656863, 6.377604263656863, 8.53321709868222, 8.53321709868222, 5.388599550372531, 5.388599550372531, 7.048781493163977, 7.048781493163977, 2.6859793535087575, 2.6859793535087575, 15.688224352812549, 15.688224352812549, 9.74003583016579, 9.74003583016579, 5.681560635787826, 5.681560635787826, 6.899341615709631, 6.899341615709631, 13.682125739547853, 13.682125739547853, 11.946805442647385, 11.946805442647385, 1.6684513214718075, 1.6684513214718075, 5.084920191576068, 5.084920191576068, 6.429115792585896, 6.429115792585896, 7.514714536125015, 7.514714536125015, -0.9524467572485823, -0.9524467572485823, 4.515655443236025, 4.515655443236025, 7.2766121877247185, 7.2766121877247185, 12.727211246515521, 12.727211246515521, 4.352195418728165, 4.352195418728165, 2.6754492873375417, 2.6754492873375417, 7.017871096563513, 7.017871096563513, 8.43084759714771, 8.43084759714771, 9.689329599325568, 9.689329599325568, 5.6266771185291375, 5.6266771185291375, 4.335544854718791, 4.335544854718791, 2.1320682193567837, 2.1320682193567837, 7.644868242097728, 7.644868242097728, 5.61378601922451, 5.61378601922451, 2.8037856201831084, 2.8037856201831084, 2.4982695826263623, 2.4982695826263623, 10.039667449542971, 10.039667449542971, 5.977339968790647, 5.977339968790647, 6.3643927230594235, 6.3643927230594235, -0.24391658296176227, -0.24391658296176227, 6.5050972011920205, 6.5050972011920205, 7.5701153376979935, 7.5701153376979935, 8.638288316297855, 8.638288316297855, 2.40017516062775, 2.40017516062775, 3.5894496790699852, 3.5894496790699852, 10.957038275383258, 10.957038275383258, 4.015148204064342, 4.015148204064342, 6.904211997206423, 6.904211997206423, 6.4271257744261, 6.4271257744261, 12.588582063477245, 12.588582063477245, 4.444523194023485, 4.444523194023485, 16.90127633334405, 16.90127633334405, 8.424930682634074, 8.424930682634074, 4.694534646529323, 4.694534646529323, 13.015662340411835, 13.015662340411835, 10.624589954524314, 10.624589954524314, 1.1269960110874626, 1.1269960110874626, 13.50694503762513, 13.50694503762513, 4.955966599905839, 4.955966599905839, 22.71683027960333, 22.71683027960333, 3.0285229508604052, 3.0285229508604052, -6.735076958910763, -6.735076958910763, 8.944294941925973, 8.944294941925973, 7.477524620921125, 7.477524620921125, -1.803383139222182, -1.803383139222182, 2.112459234703572, 2.112459234703572, 9.407169250597866, 9.407169250597866, 8.225679803298526, 8.225679803298526, 3.9825996188800907, 3.9825996188800907, 4.04196737359438, 4.04196737359438, 11.046816172418524, 11.046816172418524, 4.154071847979556, 4.154071847979556, 13.479233585177251, 13.479233585177251, 4.592694803225855, 4.592694803225855, 12.388253059173254, 12.388253059173254, 5.069961804675577, 5.069961804675577, 7.247069869578712, 7.247069869578712, 7.046875940082464, 7.046875940082464, 5.761112087119139, 5.761112087119139, 4.715401223615681, 4.715401223615681, 5.649927660478279, 5.649927660478279, 7.914174408543217, 7.914174408543217, 6.692940482852461, 6.692940482852461, 7.586826048709762, 7.586826048709762, 4.9736738764127555, 4.9736738764127555, 9.289903586850144, 9.289903586850144, 2.096569866408574, 2.096569866408574, 4.798301952231748, 4.798301952231748, 6.730187311088269, 6.730187311088269, 8.55593930026093, 8.55593930026093, 9.174287930045612, 9.174287930045612, 22.034228953653397, 22.034228953653397, 7.197932952745631, 7.197932952745631, 5.069152866130232, 5.069152866130232, 7.419912664014279, 7.419912664014279, 5.648783871771845, 5.648783871771845, 12.86764509096117, 12.86764509096117, -0.38958294570681296, -0.38958294570681296, 4.857991088795846, 4.857991088795846, 2.1565271838374143, 2.1565271838374143, 8.797094219233204, 8.797094219233204, 3.9255847490016533, 3.9255847490016533, 9.193394547365362, 9.193394547365362, 16.848450014791805, 16.848450014791805, 2.0183697003327046, 2.0183697003327046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3438325808327504, "mean_inference_ms": 2.2665311359226643, "mean_action_processing_ms": 0.0994544799228505, "mean_env_wait_ms": 0.5955335321851638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 195750, "timesteps_this_iter": 0, "agent_timesteps_total": 587250, "timers": {"sample_time_ms": 14079.249, "sample_throughput": 239.714, "load_time_ms": 0.499, "load_throughput": 6769535.651, "learn_time_ms": 2247.34, "learn_throughput": 1501.775, "update_time_ms": 30.153}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 18.02790946960449, "policy_loss": -0.0076381867751479145, "vf_loss": 18.04386978149414, "vf_explained_var": -0.050766241550445554, "kl": 0.002104457062503866, "entropy": 0.8322030007839203, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.776990520954132, "policy_loss": -0.022752155736088752, "vf_loss": 3.807210457324982, "vf_explained_var": 0.5512994468212128, "kl": 0.005366908252141945, "entropy": 0.7484497427940369, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195750, "num_agent_steps_sampled": 587250, "num_steps_trained": 195750, "num_agent_steps_trained": 587250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7830, "training_iteration": 58, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-00-39", "timestamp": 1706108439, "time_this_iter_s": 13.963989496231079, "time_total_s": 782.462810754776, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6BF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 782.462810754776, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.07647058823529, "ram_util_percent": 66.62352941176471, "gpu_util_percent0": 0.13647058823529412, "vram_util_percent0": 0.23354204963235295}}
{"episode_reward_max": 25.687813587792235, "episode_reward_min": -12.506719801371531, "episode_reward_mean": 1.5719876101131283, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -34.39521297729797, "policy_agent_": -1.9497813540117626}, "policy_reward_max": {"policy_adversary_": -3.995698806398579, "policy_agent_": 30.041513282545104}, "policy_reward_mean": {"policy_adversary_": -12.028824544321747, "policy_agent_": 6.800406077217438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7967381791096485, 1.1821784443343464, -7.660214644109403, 8.082417613367552, -1.0007032537832214, 1.8017802188088134, 4.7717032901566165, 25.687813587792235, -2.6067479568165286, 2.554398189605444, 3.569315452515338, -0.9884346315949657, -0.18126468521620728, 12.377500095621683, -1.0625562177465697, 11.319935780756682, 4.9966191050402164, 0.9493860741607605, -0.45788905545006275, 0.3653437347424681, 0.3472701468781473, 0.9459171499452896, 3.2002312227435272, -2.280866612329067, 0.3329174249645644, 1.6489053735289014, 4.868841518101575, 6.747033558121088, -7.001121081123499, -0.6389432952480769, -3.175987061937522, 2.1049694863480632, -7.895261514422101, 1.4736860023521468, 12.393344860461792, -0.519039046267312, -5.322189685383463, 4.145633227963291, -2.6093875331038476, 1.0726287455932013, -1.3348604620364224, 5.433705254395366, 5.632303271734098, -1.8299459902955473, -6.562410033785608, 5.004495764058297, -5.481256115587528, -5.581687411298071, 4.180258364492988, 3.298375837065382, 4.023774072761412, -2.105666154723167, 1.6236225029448874, 2.4909438993589204, 1.8710168806017953, 3.646640864177981, 3.747437211435885, -0.9551736684416631, -3.337021608246017, -0.6513577473583749, -4.263248088743025, 3.2764138774277822, -0.3761289709588692, 3.8707173660001875, -2.293003593772643, -11.740909974848778, 2.249948237820074, 4.880672902666222, 2.323513411800304, 7.976540454047441, 2.2707847354108446, 10.873985085328137, 6.913624737832514, -3.981670346743229, -1.7962680412658694, 3.908965978611913, 1.8591776467513441, 3.1247988628564247, -8.669985115405273, 23.17745795777405, 5.503994097142165, 4.652844339008811, 0.15215608745061138, 4.731608070751618, -4.866137765307471, 10.348200335251814, 6.109034798770769, -6.085380255359221, -3.093745981859281, 1.267735937240738, -1.048015172582669, 10.211136632733961, 3.1218461489745057, -2.9445994434844787, 14.734668892407473, 0.4333802874957334, 2.346519196303535, 3.477902682209998, -0.15142451076217367, -10.708229873594448, 2.0028195004159235, 6.346334902224299, 7.270109037772568, -1.6788845072658236, 5.074202822796956, -2.104264166710747, 6.563848180220591, 6.1068442102548905, -5.329654702436204, 3.066442335276471, 14.121310726030776, -3.4275532706911487, 6.887571562850226, -1.397813362331524, -3.4905253208682367, 5.124030706140562, 0.5990879347844154, -12.506719801371531, -2.1430979934252155, 2.059026768557732, 9.722180006670671, -0.22438403068591797, -3.144537696753707, -8.792791550448333, 1.3439790275274786, 1.7915028848061811, -0.04241696326508909, 0.4320047275289854, -7.2821087815266115, -2.4468383948561563, 2.1795081011024937, 0.8537662443749467, 11.93381594052077, 4.258470353995923, -0.7349166310619955], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.083272810530913, -6.3744931106803, -5.823772998758161, -17.743648595371706, -11.762167638975587, -9.92976338032524, -13.092691117455248, -34.39521297729797, -13.451637588121166, -7.152653742254572, -12.21988476729812, -6.047968311142647, -10.82077609599883, -19.780187551553006, -4.681886320227251, -22.48723902957668, -9.786781576879163, -12.431010302783129, -8.913464686789736, -7.655618159450927, -9.238863041787333, -8.066153388860425, -13.366975648121965, -16.253724132934472, -15.910454779576849, -6.16817738476447, -11.51265620215773, -10.234118932693143, -9.296699966871232, -13.327835099952644, -8.577477213489834, -6.536471290531732, -3.995698806398579, -5.801159120240981, -16.22456374311262, -6.549689038291027, -8.423545830389727, -15.170500791936274, -21.530784774434302, -9.27603152091876, -7.308085329779311, -14.561889751435318, -12.8375566813548, -11.253396954012125, -7.650060064225413, -14.875931641589084, -15.3665999512554, -4.613929653008318, -8.427156128221364, -14.531467094807185, -13.921297519091858, -7.337626714725029, -12.757868802400447, -11.761056237775493, -7.055612673977735, -12.63351778318806, -8.746227546472921, -8.570943766789798, -6.38138338536616, -9.633064045670984, -15.0590075792554, -9.133645507393684, -12.274792264398146, -13.748827878358005, -7.3489807658610475, -26.075279876823586, -9.577619222519113, -10.310994152779212, -8.39750211310178, -17.152177667625157, -12.095194270263999, -16.835811344961147, -13.98452476831461, -9.681432994312512, -8.851289733727976, -9.724666726294993, -8.34978846236333, -11.62504411861694, -7.764577021707489, -27.56854656663755, -14.913650665050689, -14.824178808056896, -15.204607799662378, -8.085875030310035, -9.658897712263311, -16.64927860073722, -14.706498283514263, -5.662127579308298, -9.409201532951604, -9.362960365308494, -8.191972499755083, -24.525839820493132, -11.708769504354983, -5.07582737015755, -29.00243401810426, -4.516408746983144, -9.045906609151768, -14.863826367420975, -6.13408461308205, -8.106909834929748, -9.081658783531068, -15.702154715667891, -12.477213929012594, -9.836251797849235, -12.481618908851875, -11.148957366933725, -14.157010925107032, -11.158867394452107, -15.165297318550046, -17.93547785653838, -28.751375559494285, -16.94606006391225, -12.759838568244653, -13.696334806615086, -7.318446898737778, -10.647468215870873, -9.6608176250175, -9.17025982040706, -4.44813451880026, -10.804417084888723, -19.890350075825893, -8.647801194789098, -10.348484366025371, -16.835672883472924, -12.533004831054875, -18.575604028990142, -13.721235904668928, -8.70236327595019, -13.532082143544358, -16.374086139297425, -9.034080237609494, -6.119856270514637, -18.003807905878812, -19.186135523402836, -10.509744552935553], "policy_policy_agent__reward": [6.94000549482028, 6.94000549482028, 3.7783357775073236, 3.7783357775073236, -0.918220822675618, -0.918220822675618, 12.913033104369628, 12.913033104369628, 5.380732192596183, 5.380732192596183, 5.865771799567026, 5.865771799567026, 8.932197203805929, 8.932197203805929, 30.041513282545104, 30.041513282545104, 5.422444815652317, 5.422444815652317, 4.853525965930009, 4.853525965930009, 7.89460010990673, 7.89460010990673, 2.5297668397738406, 2.5297668397738406, 5.319755705391309, 5.319755705391309, 16.078843823587338, 16.078843823587338, 1.8096650512403414, 1.8096650512403414, 16.903587405166686, 16.903587405166686, 7.39170034095969, 7.39170034095969, 6.690198188471944, 6.690198188471944, 4.227787815669836, 4.227787815669836, 4.010480947096698, 4.010480947096698, 4.79306659433274, 4.79306659433274, 4.506035269402858, 4.506035269402858, 8.283603435432747, 8.283603435432747, 6.986428760302701, 6.986428760302701, 8.121686102270706, 8.121686102270706, 3.908541379146687, 3.908541379146687, 8.19074886012965, 8.19074886012965, 8.490576245407116, 8.490576245407116, 1.1477894428738689, 1.1477894428738689, 6.344445902352282, 6.344445902352282, 2.700745075776157, 2.700745075776157, 4.320720388439899, 4.320720388439899, -1.9497813540117626, -1.9497813540117626, 3.637422561296563, 3.637422561296563, 14.308954301787205, 14.308954301787205, 3.0153249960118576, 3.0153249960118576, 1.5506780725031333, 1.5506780725031333, 9.65806700994978, 9.65806700994978, 9.460698620665227, 9.460698620665227, 5.17433013325598, 5.17433013325598, 2.9866124338714437, 2.9866124338714437, 9.99779750291534, 9.99779750291534, 9.234929976544445, 9.234929976544445, 4.711725481858288, 4.711725481858288, 0.5438250152199036, 0.5438250152199036, 9.940213702823694, 9.940213702823694, 4.942671917833936, 4.942671917833936, -0.48387887914487665, -0.48387887914487665, 6.303707246357176, 6.303707246357176, 8.914921465936281, 8.914921465936281, 8.972535795926634, 8.972535795926634, 2.615980280000931, 2.615980280000931, 7.190745652672668, 7.190745652672668, 7.1260000685672065, 7.1260000685672065, 4.463314777289767, 4.463314777289767, 8.140079323683022, 8.140079323683022, 6.2468323789544025, 6.2468323789544025, 3.8078850491740663, 3.8078850491740663, 1.5221808885600705, 1.5221808885600705, 4.490853149156305, 4.490853149156305, 5.397879745256189, 5.397879745256189, 6.205029692410735, 6.205029692410735, 5.949331646719636, 5.949331646719636, 8.8097726221791, 8.8097726221791, 2.527988586044203, 2.527988586044203, 7.1671849509874, 7.1671849509874, 5.913783730169593, 5.913783730169593, 7.595833527722719, 7.595833527722719, 5.360507762451042, 5.360507762451042, 12.564359060836296, 12.564359060836296, 7.182989502837423, 7.182989502837423, 13.854898215144644, 13.854898215144644, 10.449074753073566, 10.449074753073566, 2.8498813237846417, 2.8498813237846417, 3.527510846231054, 3.527510846231054, 6.816816352453453, 6.816816352453453, 5.1044830545573365, 5.1044830545573365, 7.374921490736683, 7.374921490736683, -0.4527040468488932, -0.4527040468488932, 25.373002262205798, 25.373002262205798, 10.208822381096429, 10.208822381096429, 9.738511573532849, 9.738511573532849, 7.678381943556495, 7.678381943556495, 6.408741550530829, 6.408741550530829, 2.3963799734779188, 2.3963799734779188, 13.498739467994517, 13.498739467994517, 10.407766541142514, 10.407766541142514, -0.21162633802546266, -0.21162633802546266, 3.1577277755461606, 3.1577277755461606, 5.315348151274619, 5.315348151274619, 3.5719786635862074, 3.5719786635862074, 17.36848822661355, 17.36848822661355, 7.415307826664742, 7.415307826664742, 1.0656139633365351, 1.0656139633365351, 21.86855145525587, 21.86855145525587, 2.4748945172394383, 2.4748945172394383, 5.696212902727652, 5.696212902727652, 9.170864524815489, 9.170864524815489, 2.991330051159938, 2.991330051159938, -1.300660019332352, -1.300660019332352, 5.542239141973497, 5.542239141973497, 11.024244808946099, 11.024244808946099, 9.873661483392581, 9.873661483392581, 4.078683645291707, 4.078683645291707, 8.777910865824413, 8.777910865824413, 4.522346600111488, 4.522346600111488, 10.360429552663813, 10.360429552663813, 8.6328558023535, 8.6328558023535, 4.917821308056923, 4.917821308056923, 10.500960095907427, 10.500960095907427, 21.436343142762535, 21.436343142762535, 6.759253396610549, 6.759253396610549, 9.823705065547442, 9.823705065547442, 6.14926072214178, 6.14926072214178, 1.913960788934772, 1.913960788934772, 7.885749461005719, 7.885749461005719, 5.12995277990096, 5.12995277990096, -1.6682299904822324, -1.6682299904822324, 1.152518262687521, 1.152518262687521, 6.431721926723229, 6.431721926723229, 14.806265041248283, 14.806265041248283, 4.2117085820515925, 4.2117085820515925, 3.6019733346358334, 3.6019733346358334, 4.021440666512295, 4.021440666512295, 6.9384919292911755, 6.9384919292911755, 10.18355345689816, 10.18355345689816, 6.839409470701921, 6.839409470701921, 4.567184001739589, 4.567184001739589, 3.12498668100887, 3.12498668100887, 6.963623872220636, 6.963623872220636, 5.606794169355992, 5.606794169355992, 3.486811257444791, 3.486811257444791, 14.968811923199793, 14.968811923199793, 11.722302938699379, 11.722302938699379, 4.887413960936779, 4.887413960936779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3436487592919951, "mean_inference_ms": 2.2636314384599685, "mean_action_processing_ms": 0.09932238991914455, "mean_env_wait_ms": 0.5947363739751577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 199125, "timesteps_this_iter": 0, "agent_timesteps_total": 597375, "timers": {"sample_time_ms": 13911.958, "sample_throughput": 242.597, "load_time_ms": 0.399, "load_throughput": 8461312.612, "learn_time_ms": 2154.802, "learn_throughput": 1566.269, "update_time_ms": 28.073}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005000000000000001, "total_loss": 16.014929485321044, "policy_loss": -0.005107291461899877, "vf_loss": 16.02871036529541, "vf_explained_var": 0.004394149780273438, "kl": 0.004867680046876699, "entropy": 0.8673970639705658, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.4302398681640627, "policy_loss": -0.020419957488775252, "vf_loss": 3.457981014251709, "vf_explained_var": 0.602726411819458, "kl": 0.005388537030095888, "entropy": 0.7337956041097641, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 199125, "num_agent_steps_sampled": 597375, "num_steps_trained": 199125, "num_agent_steps_trained": 597375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7965, "training_iteration": 59, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-00-52", "timestamp": 1706108452, "time_this_iter_s": 12.544613361358643, "time_total_s": 795.0074241161346, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 795.0074241161346, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 31.15625, "ram_util_percent": 67.06875, "gpu_util_percent0": 0.041249999999999995, "vram_util_percent0": 0.23651123046875}}
{"episode_reward_max": 17.682618418416112, "episode_reward_min": -12.153285439937822, "episode_reward_mean": 1.3099131227701086, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.189856260721406, "policy_agent_": -0.8697793299990292}, "policy_reward_max": {"policy_adversary_": -4.576432470779361, "policy_agent_": 21.932288415312748}, "policy_reward_mean": {"policy_adversary_": -12.426009867505444, "policy_agent_": 6.867961495137775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0953664908337832, 17.682618418416112, 9.670196080257625, -11.329282891749992, 1.0925094245756146, -5.090519682456129, 10.4411734172182, 3.3466287859432753, 2.5755569220887424, -1.1117583094531007, 2.1133682479116, -0.072350726773834, 2.764541297839179, 1.9884071877653895, 10.230019243877932, -1.588947537805174, 7.670245996859092, -0.24638322834138665, -2.6899637311959155, 0.19901083640850203, 0.13311022946567824, -9.595459938449656, 9.070420203853796, -5.959492457169449, -6.427413689514257, -5.026269304808238, 3.3490743354256525, 0.4234682621459368, -0.7533299373695921, 0.19087784966683102, 4.008953629801164, -8.68485531894514, 3.4889165740877184, -0.12107145669516492, 0.7563376049781736, -4.2759950310578585, 1.9658503694177436, 4.640799737968971, 0.2790118747439152, 6.633331941606485, 2.925263503722712, 14.49507431819295, 7.795578276697061, -3.626548606345085, 3.721967364364895, -5.868423187806657, -0.7963473735166962, 1.0807175872275643, 1.749356079632851, 2.725308748725208, -3.6785870704149577, 0.7523066444907891, 1.2326962911052481, 3.2027196243168445, 5.2801043375535555, -4.15589209869275, -5.088932284906682, 0.7109646647590234, 4.000640365813343, 7.216674312391906, 3.593677420334029, -9.983489376028986, -3.9916738500161006, 14.284606042479515, 9.652085463984877, -0.9372918056537997, 3.089805024952021, 3.3002298058500554, 1.5911994105196465, 3.7007835423129296, -1.6917213220613716, 1.8135503703194666, 1.2313831793946552, -2.789969956868308, 3.709690647624271, 1.804747284908844, 1.0676527611880084, -0.5335740619212849, -1.2196669091514973, -2.883858026682038, -4.768623788576872, 7.109502059164843, -6.4073285699607085, -1.2640071533080572, 3.503483839899389, 0.505959181713379, 2.1735909966760634, 2.7045468234482892, -9.22011209139859, 12.16336615967114, 0.8059671480992967, 7.220198883543772, 1.7612906246095945, 15.21479616307561, 6.846805965755702, 2.850315190453558, -1.4600256675387913, 1.9374924265444982, 9.467849937218489, 0.9333028333670554, -0.10476400189938942, 15.461369443931108, -12.153285439937822, 0.637554782052315, 0.4749702297290077, 12.115097156536255, 10.168443111270527, -2.0434767155954425, 0.24650425265288506, 3.479865867364392, 11.205022765311146, -4.354494629384977, -8.21049990742861, 1.8239513372321834, 4.064541358736858, 6.149674975275143, 3.1585781366771184, 4.3507235544856755, 0.27490115941474996, -9.001685328816903, 1.79228642437115, 2.175372762311567, 3.9294742113644787, -4.401864290617161, -3.0641868322850287, 1.653319768032934, -3.3279383598814345, -1.4847192493356185, -1.5760218853145342, -7.972131728775559, 5.4602480927051555, 0.78836643257246, -2.3693127115721735, -10.627290698178275, 7.912530686002128], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-21.067354024703253, -26.18195841220939, -15.609932068538429, -17.20782126936878, -11.700786931969738, -11.060038657080115, -17.17241271166016, -9.549451913359608, -12.291640097531833, -12.930845883394394, -11.534693519633842, -6.927770559720912, -16.47290254629713, -12.842918859608083, -15.973796752660958, -6.8154258655273585, -14.765005222975079, -9.950135180831026, -11.659655042083807, -8.090382183331345, -9.586092526411488, -8.61810812530849, -15.26295953399066, -8.309472596972636, -9.414612774264128, -7.127570513076877, -18.086904712447897, -9.99769040019179, -7.5050153078255315, -8.759499226704921, -7.908350769007761, -10.60832674102657, -11.684492156768258, -24.295403781115365, -10.676691372121324, -10.122766130991957, -12.393642689644999, -18.384865919354144, -5.1278964229524675, -15.657275512710566, -8.721103616083958, -26.189856260721406, -14.281066149790801, -19.17530057274902, -7.850153207920973, -14.130631016167893, -7.114910949183974, -14.17294523110249, -9.824056664214478, -7.4123341960747995, -4.754095930020227, -12.546961208281365, -5.53745242804346, -10.149742647327496, -12.426584713523907, -9.405459765111795, -11.200048354492235, -8.383438002287642, -10.820232947657193, -15.806314844024275, -10.419447445413734, -11.778296993639874, -12.016151636863965, -23.013385464230655, -17.56261345122155, -14.82148121986456, -16.943111122100426, -14.816916118577373, -6.7790787558003975, -19.07920884145777, -10.982259674209983, -16.80743092294867, -9.838906848949131, -8.924009566264003, -8.5767155219862, -8.65940729852091, -13.948009861168554, -13.403389816861273, -11.528112592166725, -5.938038006321477, -7.334738377117456, -14.728596194019245, -12.741350688698338, -8.270609036355543, -16.27096638449066, -11.297828248119407, -9.518812826838182, -13.972239837291921, -9.508713411038194, -18.6213408578438, -14.29279237223441, -14.656419579848992, -10.820581700554524, -19.364311403099094, -17.692078156669066, -9.639402112553144, -14.318741889463128, -7.890160189552116, -15.031447390959634, -11.097234006400214, -13.830245517544238, -20.916693777341738, -15.594113902134177, -9.960989234784403, -7.962377143432141, -19.6423090327444, -21.71380254535291, -7.324293761925263, -11.2450743196135, -23.071860692799216, -18.739385348100246, -24.210276846517107, -11.053870117897382, -9.542031504496942, -13.578582861217617, -12.502488896535466, -9.776940492244835, -12.026483710720102, -7.80217717959716, -7.262126668818843, -14.387421281344794, -10.00910335855466, -9.504400301439729, -12.401801698798717, -10.06164025000436, -9.370291877601657, -4.576432470779361, -5.353268892142575, -7.2039017975962505, -18.54775577973653, -14.064015214019156, -8.755442054409418, -9.426912230850018, -10.386574358642548, -13.566657551630648], "policy_policy_agent__reward": [9.485993766934733, 9.485993766934733, 21.932288415312748, 21.932288415312748, 12.640064074398026, 12.640064074398026, 2.939269188809392, 2.939269188809392, 6.396648178272676, 6.396648178272676, 2.984759487311992, 2.984759487311992, 13.806793064439178, 13.806793064439178, 6.448040349651441, 6.448040349651441, 7.433598509810289, 7.433598509810289, 5.909543786970645, 5.909543786970645, 6.824030883772722, 6.824030883772722, 3.427709916473539, 3.427709916473539, 9.61872192206815, 9.61872192206815, 7.415663023686735, 7.415663023686735, 13.101907998269445, 13.101907998269445, 2.613239163861092, 2.613239163861092, 11.217625609917087, 11.217625609917087, 4.85187597624482, 4.85187597624482, 4.484845655443949, 4.484845655443949, 4.144696509869923, 4.144696509869923, 4.859601377938581, 4.859601377938581, -0.48867590657058213, -0.48867590657058213, 12.166689868922226, 12.166689868922226, 1.174990069901593, 1.174990069901593, 1.4935995423749349, 1.4935995423749349, 1.0506506041343198, 1.0506506041343198, 10.717989523936776, 10.717989523936776, 5.210579331168862, 5.210579331168862, 3.3758426852279713, 3.3758426852279713, 4.475188538185876, 4.475188538185876, 5.958652199404462, 5.958652199404462, 0.9617357110407185, 0.9617357110407185, 7.586704365427986, 7.586704365427986, 12.0871661622101, 12.0871661622101, 5.71651448854975, 5.71651448854975, 2.9233855499670485, 2.9233855499670485, 7.179746529531373, 7.179746529531373, 11.512832828661558, 11.512832828661558, 2.703454148848192, 2.703454148848192, 11.14530372715853, 11.14530372715853, 5.823183559903337, 5.823183559903337, 20.342465289457177, 20.342465289457177, 11.038322213243935, 11.038322213243935, 7.774375983201966, 7.774375983201966, 5.786060286142932, 5.786060286142932, 4.131103914180618, 4.131103914180618, 3.159281787833639, 3.159281787833639, 7.626831409165028, 7.626831409165028, 5.786706371923664, 5.786706371923664, 5.068821472400005, 5.068821472400005, 0.5377544298026345, 0.5377544298026345, 6.649633926386076, 6.649633926386076, 3.3850743595743533, 3.3850743595743533, 6.676231135822171, 6.676231135822171, 8.85334452553873, 8.85334452553873, 2.624783833209523, 2.624783833209523, 3.0555580347927807, 3.0555580347927807, 4.547201333523334, 4.547201333523334, 7.41043665673527, 7.41043665673527, 11.511494578208087, 11.511494578208087, 7.006562432873882, 7.006562432873882, 0.8974038088054399, 0.8974038088054399, 4.012238893423931, 4.012238893423931, 18.64899575335508, 18.64899575335508, 13.607349457603217, 13.607349457603217, 6.9420947071053805, 6.9420947071053805, 10.016458073526222, 10.016458073526222, 9.058572962213717, 9.058572962213717, 4.185139083160022, 4.185139083160022, 11.389996191885349, 11.389996191885349, 4.645269176074306, 4.645269176074306, 9.31049064663407, 9.31049064663407, 5.535145014171894, 5.535145014171894, 3.067019804697845, 3.067019804697845, 6.143203084805235, 6.143203084805235, 5.232077291714874, 5.232077291714874, 7.507831311178281, 7.507831311178281, 6.434907877469994, 6.434907877469994, 5.1542228415076154, 5.1542228415076154, 1.5270899898197197, 1.5270899898197197, 1.283057294270295, 1.283057294270295, 10.919049126592043, 10.919049126592043, 3.1670110593688188, 3.1670110593688188, 3.503300941523742, 3.503300941523742, 9.88722511219503, 9.88722511219503, 5.901893714916394, 5.901893714916394, 5.846201911757123, 5.846201911757123, 8.338393330370108, 8.338393330370108, 0.14430065981981, 0.14430065981981, 15.392353508757473, 15.392353508757473, 7.549379760166855, 7.549379760166855, 10.938309231696381, 10.938309231696381, 6.290936162582059, 6.290936162582059, 17.289553783087353, 17.289553783087353, 12.269442061212379, 12.269442061212379, 6.2448586515033515, 6.2448586515033515, 6.429358110962167, 6.429358110962167, 4.913826308048306, 4.913826308048306, 12.24964866408906, 12.24964866408906, 6.0152684198836335, 6.0152684198836335, 6.862740757822422, 6.862740757822422, 18.189031610636434, 18.189031610636434, 1.7204142310981771, 1.7204142310981771, 5.299272008418359, 5.299272008418359, 4.218673686580574, 4.218673686580574, 15.878703094640324, 15.878703094640324, 15.941122828311716, 15.941122828311716, 2.6404085231649095, 2.6404085231649095, 5.745789286133194, 5.745789286133194, 13.2758632800818, 13.2758632800818, 14.972204056705694, 14.972204056705694, 9.927891108566063, 9.927891108566063, 1.4216851052343873, 1.4216851052343873, 5.682991420864562, 5.682991420864562, 8.821562109977236, 8.821562109977236, 9.326081935905307, 9.326081935905307, 6.467759314460976, 6.467759314460976, 8.188603632602888, 8.188603632602888, 4.038539169505953, 4.038539169505953, -0.8697793299990292, -0.8697793299990292, 8.089853852857969, 8.089853852857969, 6.092238060433112, 6.092238060433112, 6.716937256402103, 6.716937256402103, 3.9999687040907776, 3.9999687040907776, 3.4987267088596647, 3.4987267088596647, 5.511805822817292, 5.511805822817292, 0.6242470554489628, 0.6242470554489628, 1.9342748214034788, 1.9342748214034788, 2.813939956140858, 2.813939956140858, 5.287812025480486, 5.287812025480486, 9.762131653362163, 9.762131653362163, 4.771904243490939, 4.771904243490939, 3.5287997596389222, 3.5287997596389222, -0.12035816976786652, -0.12035816976786652, 10.739594118816388, 10.739594118816388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3436260948054754, "mean_inference_ms": 2.2623755822139486, "mean_action_processing_ms": 0.09908413557255648, "mean_env_wait_ms": 0.5943003500396605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 202500, "timesteps_this_iter": 0, "agent_timesteps_total": 607500, "timers": {"sample_time_ms": 13631.834, "sample_throughput": 247.582, "load_time_ms": 0.501, "load_throughput": 6732510.225, "learn_time_ms": 2161.219, "learn_throughput": 1561.619, "update_time_ms": 27.97}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 15.518140506744384, "policy_loss": 0.0034019785729469732, "vf_loss": 15.52289981842041, "vf_explained_var": 0.012289696931838989, "kl": 0.004574171462031618, "entropy": 0.8160682857036591, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 3.049281358718872, "policy_loss": -0.010908220941200853, "vf_loss": 3.067447030544281, "vf_explained_var": 0.6059737503528595, "kl": 0.00575708868370306, "entropy": 0.7275472223758698, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 202500, "num_agent_steps_sampled": 607500, "num_steps_trained": 202500, "num_agent_steps_trained": 607500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8100, "training_iteration": 60, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-01-05", "timestamp": 1706108465, "time_this_iter_s": 13.04000186920166, "time_total_s": 808.0474259853363, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 808.0474259853363, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.02352941176471, "ram_util_percent": 67.33529411764707, "gpu_util_percent0": 0.04647058823529412, "vram_util_percent0": 0.23914292279411764}}
{"episode_reward_max": 20.4536689261624, "episode_reward_min": -16.305673031178426, "episode_reward_mean": 0.9586104217204842, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.29491157572999, "policy_agent_": -3.074727670957585}, "policy_reward_max": {"policy_adversary_": -4.554385855475052, "policy_agent_": 24.374290250946196}, "policy_reward_mean": {"policy_adversary_": -12.374226147980634, "policy_agent_": 6.666418284850558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.189940382747826, 0.8762787377838044, 1.1006560034399937, -6.502480305476553, -2.087562626704182, 9.558848278881639, 6.962010362053038, -10.878784039303392, 5.044892056920582, 9.683402009626842, 6.434004034146531, 3.0880614742716683, -0.5603526144667687, 2.807498924667741, 3.8589789084248967, 0.842336586882449, -1.386001343847857, -1.089925467138284, 4.579327014737214, -5.787190360930028, -1.7531840909982939, 5.3365829815158285, -8.78436752726094, 10.973834729757582, 1.1535415083492595, 1.0754905993446586, 8.830603658204213, -0.8262806347456053, 6.972921496141562, 1.3798544827755643, -0.23257770599244515, 2.602508234475202, 1.929906826929323, 3.236930656044362, 10.26011359161164, 6.807268579086431, 0.8884769753578864, -12.40599452833632, 0.9173427699230026, 2.0333090273106285, -2.612209453972538, 9.564961282583155, 2.1530087859068097, -2.02562442437443, 8.55473387962957, 0.5400866517423906, -6.858016947846536, 7.845789987189092, 0.3241868136789462, 4.241721012407616, -5.76375300789014, 0.5707753926876603, 1.9325319627096085, -11.38864023668789, 6.235402613442639, 0.7930685624463616, -4.6583071224011015, 7.0359001397639025, 2.205621088082104, 0.4979142923355915, -6.347016326371995, -2.51943381158419, 9.212559875737643, 2.3578177585418874, 2.7082627199204126, -5.0696823289841975, 9.265913253718605, 0.8414189434892716, -1.8749528974264718, 8.529769364474333, -7.388632258437808, -4.878064679910166, 1.2900216515092724, -5.088800769576727, -5.170799303269582, -15.970207233973161, 6.336251885091464, -11.440342943554281, 9.014235717670182, -1.7412535040706996, -0.09140011118617268, -4.485684283773195, -16.305673031178426, 8.54997739655643, -2.0471968562432408, -9.928204207084296, 4.542297463181075, 7.249783562535836, 1.8879703500080853, -8.43778606361062, 6.658643259384487, 5.717616933051437, 5.648740199942808, -0.1781218942779902, -0.5228395748105923, 1.6808391250839745, 1.3609191451888616, -3.886571714232352, 6.3156343046537, -5.7637618530206165, 5.842688444369453, 1.3991812380410962, -3.4764256931962407, 3.477674628174185, 1.5935439817820807, -1.8305065835524572, 7.650720021357236, 4.562615888310656, 3.0287284882060703, -0.45333110947718913, 5.432089286750034, -3.0699984218476217, 3.3180583432081727, 3.2699277599021044, -11.025650300171176, -2.6709552314879126, 6.8195595663209145, 1.5676826101718153, -0.28026788642729683, -8.484261665344087, -6.636947476171784, 6.86858590685385, 20.4536689261624, -5.989745669527448, -1.9320478711989573, 12.499113604853937, 2.6788130834697768, 3.4172185240889, 1.142030021139399, -10.728708732000262, 13.67256955799695, 5.388160947660943, 4.721468248608618, -4.043267958076125, -1.1211957274911848], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.447235485446884, -13.541780344321824, -16.610611811249868, -16.771215565346782, -8.171467394056494, -15.005153249205764, -14.59632471831617, -24.33105531228857, -12.222695469605679, -17.101326840576302, -12.836993897640323, -9.46483829008983, -9.14887162011781, -15.26379484364709, -12.248916729569215, -10.33514256372379, -6.271311254595439, -5.685698365367104, -9.679333483704935, -11.846848224325464, -8.324914247348335, -10.20028874195859, -9.02434033433898, -20.105423145845293, -16.56341964051377, -7.179372922354079, -16.94691369447839, -11.555645401115177, -10.32576771466546, -5.311516205987882, -4.554385855475052, -10.658722494285376, -7.505262497100886, -9.026903699159261, -16.040272340497147, -18.959076982739802, -8.09479495467413, -6.2565391864211435, -8.422114286365954, -8.088411866015358, -10.461252023593286, -19.08557988596458, -11.573533681305825, -9.12387835593104, -13.222894331942967, -12.764497430342647, -13.756014821034878, -26.003338812503916, -9.169453703797817, -12.731049103014247, -4.786442659605039, -10.529488561042275, -9.466771858774665, -7.52875113592762, -9.475259037243324, -10.21357593139361, -7.657073733695836, -13.430351331254583, -12.459252500784462, -9.136079862215599, -16.249233362644677, -22.55307982771948, -13.253706925599268, -12.886538735936277, -13.106367026944586, -13.70915704619266, -16.993893125523435, -9.749519930274491, -9.04041309749683, -17.857018052932123, -10.704089278441137, -5.491561837581269, -7.242639472712335, -17.725302805984644, -15.68208998171282, -17.463865842465907, -13.958677889874952, -14.386993555687464, -15.440282194624546, -7.53707350104417, -8.532288219161028, -5.875788054450967, -17.6769992312878, -22.033214289739995, -10.835800585028075, -19.45262105028892, -10.319479626403421, -14.50465452066792, -10.500696079385024, -17.5040475228945, -14.548973730898616, -13.580708289896489, -12.35040104265066, -17.234176193147952, -9.761489572810566, -5.8727103417689825, -8.002087469077157, -10.486208985279472, -11.25207866317938, -14.36821142126753, -14.356258477416834, -6.360818900733846, -18.653437402982448, -8.584662104469952, -6.50145392160117, -15.84343957755156, -22.457610929137115, -8.687981457584952, -11.481069109375879, -11.369898283218738, -12.182773066795662, -12.27498778237807, -8.879623315662231, -8.625420732439691, -10.005749877341238, -13.050942910507237, -14.112752228190852, -7.721122666618213, -5.93839543140369, -5.59021555851092, -25.561350990235788, -15.275626141631022, -28.29491157572999, -16.461207716233393, -10.721925320673039, -19.06663686208321, -7.3342063163136695, -11.313425133010588, -7.138276323331616, -16.879788137752175, -23.37632169240326, -10.664770069877603, -13.615740505659858, -12.485508210275741, -5.62884243167309], "policy_policy_agent__reward": [8.818587934097351, 8.818587934097351, 7.209029541052813, 7.209029541052813, 8.855633907344929, 8.855633907344929, 5.13436762993511, 5.13436762993511, 3.0419523836761564, 3.0419523836761564, 12.282000764043703, 12.282000764043703, 10.779167540184607, 10.779167540184607, 6.726135636492586, 6.726135636492586, 8.63379376326313, 8.63379376326313, 13.392364425101576, 13.392364425101576, 9.635498965893422, 9.635498965893422, 6.276449882180749, 6.276449882180749, 4.294259502825518, 4.294259502825518, 9.035646884157414, 9.035646884157414, 8.053947818997056, 8.053947818997056, 5.58873957530312, 5.58873957530312, 2.44265495537379, 2.44265495537379, 2.29788644911441, 2.29788644911441, 7.1293302492210735, 7.1293302492210735, 3.02982893169772, 3.02982893169772, 3.285865078175019, 3.285865078175019, 7.768435861737206, 7.768435861737206, 0.11998640353901664, 0.11998640353901664, 15.539628937801439, 15.539628937801439, 8.858480574431514, 8.858480574431514, 4.127431760849371, 4.127431760849371, 12.888758676341299, 12.888758676341299, 5.3646823831847845, 5.3646823831847845, 8.649344605403511, 8.649344605403511, 3.345685344381722, 3.345685344381722, 2.1609040747413024, 2.1609040747413024, 6.630615364380287, 6.630615364380287, 4.7175846620151045, 4.7175846620151045, 6.13191717760181, 6.13191717760181, 13.150192966054396, 13.150192966054396, 12.883172780913116, 12.883172780913116, 4.491635965016008, 4.491635965016008, -3.074727670957585, -3.074727670957585, 4.669728528144477, 4.669728528144477, 5.060860446662994, 5.060860446662994, 3.924521284810374, 3.924521284810374, 14.32527058427387, 14.32527058427387, 6.8632712336063175, 6.8632712336063175, 3.5491269657783056, 3.5491269657783056, 10.888814105786267, 10.888814105786267, 6.652292041042519, 6.652292041042519, 3.4489989365941707, 3.4489989365941707, 16.924564399846506, 16.924564399846506, 4.746820258738382, 4.746820258738382, 8.486385057710933, 8.486385057710933, -0.48865517414254955, -0.48865517414254955, 5.550131976864968, 5.550131976864968, 5.699651910742137, 5.699651910742137, -1.9299445503801334, -1.9299445503801334, 7.85533082534298, 7.85533082534298, 5.503322246919987, 5.503322246919987, 1.4993833056473653, 1.4993833056473653, 10.233125735509246, 10.233125735509246, 7.332436794433283, 7.332436794433283, 4.816997077275598, 4.816997077275598, 4.951108518136339, 4.951108518136339, 10.01682300806764, 10.01682300806764, 11.233133400668455, 11.233133400668455, 7.622178247239082, 7.622178247239082, 7.907314873432497, 7.907314873432497, 4.319737358604232, 4.319737358604232, 13.129903189621022, 13.129903189621022, 5.295469436881882, 5.295469436881882, 3.58273010003518, 3.58273010003518, 13.19339370870323, 13.19339370870323, 1.657728510001664, 1.657728510001664, 0.3067485788355521, 0.3067485788355521, 4.266330562110805, 4.266330562110805, 6.3182510182039575, 6.3182510182039575, 5.255645339221616, 5.255645339221616, 0.7468293042463683, 0.7468293042463683, 10.147464887483205, 10.147464887483205, 1.4733253060665903, 1.4733253060665903, 12.227258956147363, 12.227258956147363, 2.897909998486735, 2.897909998486735, 4.2204440539874275, 4.2204440539874275, 0.6950518853388858, 0.6950518853388858, 0.6856631000546862, 0.6856631000546862, 15.291595843148212, 15.291595843148212, 4.394301864392416, 4.394301864392416, 4.762208421602311, 4.762208421602311, 7.430888544792251, 7.430888544792251, 10.87721904160188, 10.87721904160188, 6.194333214696552, 6.194333214696552, 4.533130729641937, 4.533130729641937, 10.60380849514155, 10.60380849514155, 9.649162611473962, 9.649162611473962, 8.999570621296733, 8.999570621296733, 8.528027149434983, 8.528027149434983, 4.619324998999987, 4.619324998999987, 3.7767747334264787, 3.7767747334264787, 4.681503307133007, 4.681503307133007, 3.299818635523557, 3.299818635523557, 8.78385648391654, 8.78385648391654, 4.302224784123456, 4.302224784123456, 10.09947346089314, 10.09947346089314, 3.8800000693874708, 3.8800000693874708, 7.588505854893102, 7.588505854893102, 6.031168366322069, 6.031168366322069, 4.047498951691626, 4.047498951691626, 7.006466496999548, 7.006466496999548, 15.054165475247178, 15.054165475247178, 6.625298672947805, 6.625298672947805, 7.2548987987909745, 7.2548987987909745, 5.458283586870773, 5.458283586870773, 8.807431176772848, 8.807431176772848, 4.602494680265223, 4.602494680265223, 6.098840829435202, 6.098840829435202, 5.947674246170897, 5.947674246170897, -0.5099502114149699, -0.5099502114149699, 5.189993839509661, 5.189993839509661, 10.466155897255886, 10.466155897255886, 4.644402638395014, 4.644402638395014, 2.8290637724881957, 2.8290637724881957, -1.447023053416587, -1.447023053416587, 9.462201757032002, 9.462201757032002, 11.072106024242439, 11.072106024242439, 24.374290250946196, 24.374290250946196, 5.235731023352969, 5.235731023352969, 4.394938724737042, 4.394938724737042, 15.782875233468575, 15.782875233468575, 5.006509699891723, 5.006509699891723, 7.365321828549742, 7.365321828549742, 4.140153172235508, 4.140153172235508, 3.0755397028759566, 3.0755397028759566, 18.5244456252001, 18.5244456252001, 8.026465508769274, 8.026465508769274, 9.168604377134237, 9.168604377134237, 4.221120126099808, 4.221120126099808, 2.253823352090951, 2.253823352090951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34342935694834054, "mean_inference_ms": 2.2599999310936902, "mean_action_processing_ms": 0.09908895315051816, "mean_env_wait_ms": 0.593782109323574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 205875, "timesteps_this_iter": 0, "agent_timesteps_total": 617625, "timers": {"sample_time_ms": 13589.285, "sample_throughput": 248.357, "load_time_ms": 0.601, "load_throughput": 5615143.197, "learn_time_ms": 2157.049, "learn_throughput": 1564.637, "update_time_ms": 27.928}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005000000000000001, "total_loss": 15.562790012359619, "policy_loss": -0.008184143668040633, "vf_loss": 15.579278755187989, "vf_explained_var": -0.016732823848724366, "kl": 0.004854755844481401, "entropy": 0.8304560661315918, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 2.387310689687729, "policy_loss": 0.001971425861120224, "vf_loss": 2.3925228357315063, "vf_explained_var": 0.6430080235004425, "kl": 0.006458221006010225, "entropy": 0.7203752309083938, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 205875, "num_agent_steps_sampled": 617625, "num_steps_trained": 205875, "num_agent_steps_trained": 617625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8235, "training_iteration": 61, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-01-18", "timestamp": 1706108478, "time_this_iter_s": 12.669383764266968, "time_total_s": 820.7168097496033, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A07C3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 820.7168097496033, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.30625, "ram_util_percent": 67.5625, "gpu_util_percent0": 0.0925, "vram_util_percent0": 0.2425384521484375}}
{"episode_reward_max": 14.356980329099988, "episode_reward_min": -13.253970092346066, "episode_reward_mean": 0.6972594025226415, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.098331499299096, "policy_agent_": -1.2342950953234697}, "policy_reward_max": {"policy_adversary_": -4.115810626851161, "policy_agent_": 21.1961452386}, "policy_reward_mean": {"policy_adversary_": -12.44023229503209, "policy_agent_": 6.568745848777365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.9607901028573238, 1.277001997022345, -2.614182917883687, -1.6607818623260533, 0.26974907718071345, 3.6728892430618005, -1.1884175118499238, 1.326625125105017, -8.88075246554209, -3.599646480939433, 0.5913611897532476, 2.402581237811238, -0.016347671061630667, 0.9030138633064672, 7.985917321024686, 3.3178169374458477, 5.013820232847057, -2.0301966502949895, -2.5144156417698422, 7.951371554290618, 1.494926209179294, -0.5570339799373811, -0.9733020692077708, -7.2502254324889615, 2.3060292056225995, -1.5395080491467388, 14.356980329099988, -0.705454798270525, -2.0385880120565627, 5.237888817404361, -2.345639789061358, 2.160238858033238, 2.0840285361479567, -3.6945047047140207, 12.399288045802807, 4.599932025501399, 3.686557124427837, -13.253970092346066, 3.7237296559475435, -5.884279566175152, -1.194701039918423, -0.8284525789467283, 6.446319398197226, -2.312386935822334, -0.07759677191561769, 3.005546547164106, 3.404446719364465, -3.273890754260935, 8.790411368800116, -1.7660419310747726, 10.107646522146227, 0.16120922727101536, 3.3790250301722193, -3.093086209947411, 0.8387323623831788, 5.248451635833428, -1.9136645148891986, -11.803710364756736, 5.237333031292945, 10.586345249949387, 0.00030142124461796094, 5.679346702792976, -3.187296794253015, 2.295486157566163, -6.545251705303382, -3.3207255707762267, -3.635542038891038, 7.497156279966939, 0.993407752701746, -0.5536833130677881, 0.9677922938769616, 1.2101051102983462, -2.939517344504579, -2.384779609308532, 5.348277835936295, 1.3703157545954974, 3.4975538456841555, -2.160859548844933, -0.9528047233197918, 0.25444237727439123, -1.9756318333586473, -5.002084681937943, -3.050470377163279, 12.87242986472815, -1.2571891255367256, 1.206244778038293, -6.34079149076987, 11.822285428738436, 2.1914230807233346, -0.14758564159397586, 1.9975044794137264, 8.701924574291025, 2.1778156891746976, 1.1922064031331305, -9.156771115716483, 2.3136467757659425, -1.8044772503712108, -2.0987669631061703, -1.5592796763032162, -6.716519167689704, -0.12896289719883336, 10.48373709306803, -2.1260950411810557, -2.5800951751146353, -3.930000280868219, 2.6644926633479376, -0.5038195630909434, -3.505397382389433, -1.7679742737669117, -1.8452494791837446, -1.4244323433693087, 0.5412353367127796, 3.41033805021073, 2.4192695522511882, 0.9295683112535721, -8.308961994026946, 11.517987251749965, -1.2883906817502124, 11.821216674908197, 0.6135415050940508, 2.043005888020538, 0.5518036827499829, 2.680177823781413, -1.7125759985114664, 3.634603747938705, 0.5064245057346828, -0.862505233137074, 4.672360573452405, -12.029462599826479, -7.671234259875245, 3.4503622396335554, 1.198333939292239, 5.825357255670211, 6.836364763578625, 3.2197122721412925], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.0627997106957885, -7.772320248411359, -15.69747645697271, -11.909845261344705, -10.278302482193146, -18.873080896855065, -5.438540916066833, -28.098331499299096, -7.1288072859690494, -10.603398408147514, -9.805696125864259, -8.887395030315105, -9.264520832265946, -6.921407271635963, -12.344549147014263, -10.581597679167349, -9.290670549585892, -17.15152436272025, -10.540979862054876, -16.697936809995156, -10.228297774335937, -14.994335538059723, -12.10577317008939, -19.000189000207367, -12.44489892580878, -15.0761834149846, -28.035310148100024, -9.887102235165806, -8.612535127183646, -12.035988486814096, -6.835188613502775, -8.341405296629633, -9.259831724382707, -5.908043367373476, -21.016703329327783, -11.46541438340136, -11.855014478347023, -15.779087462588661, -8.837427736543392, -17.103343769789813, -20.123599364817743, -17.723310084679905, -10.845121931460142, -8.4250790095954, -7.264214284102948, -10.61948216353267, -12.458338671704647, -9.818437901152276, -19.233353350862288, -12.037535039164027, -19.098536195935274, -9.177503813609727, -12.495905260732753, -5.689302446370163, -6.035889787598144, -17.4604522241781, -10.530225063418833, -9.335120174109797, -11.87873750065659, -16.075295305368567, -9.037264236680379, -13.609833256420155, -8.943761509210328, -10.159298163120722, -10.084753380921823, -18.840955348749635, -9.964851508982989, -19.45361178183308, -7.475679973465084, -19.719888044271766, -10.749472326207913, -7.912270059195898, -10.49249866241606, -6.104387127807855, -15.329384850921961, -11.66001024077758, -18.755909693252505, -15.795266690531372, -7.39629242580779, -11.07181719351268, -19.75512671029189, -13.767832803331567, -16.119878858009837, -20.395542776412782, -10.279773654390327, -10.601325152947162, -7.840983745804097, -15.75521555092634, -9.617758194193824, -14.270640714156704, -12.673253087151863, -14.24491553306126, -9.240355765819348, -5.185239565693094, -21.61706105256182, -7.374264481205068, -9.529248091735418, -9.297080930266782, -8.305391623584073, -7.101122640625617, -22.284991594413636, -17.78724069066046, -14.45227011194145, -15.652439074011077, -7.305301393557366, -16.025664092917154, -10.408009974889985, -20.897536447077908, -15.133160351800468, -7.501139245237583, -11.156678446001363, -6.938808664244496, -23.109185150858522, -9.126055512714903, -6.822056223340058, -7.0265378806469085, -18.366428650488025, -4.115810626851161, -19.383551164879254, -12.710008026311378, -8.76116257085352, -8.23092669370546, -15.642159420847186, -12.572518985689737, -15.901823458913185, -9.357604615459204, -5.301942870072048, -15.319134918907425, -12.48497757046198, -12.539296342772253, -9.093819465646606, -21.375624476002926, -14.830489698950858, -12.488131971286823, -16.302961648402952], "policy_policy_agent__reward": [2.051004803919232, 2.051004803919232, 4.524661122716852, 4.524661122716852, 6.541646769544511, 6.541646769544511, 5.124531699509326, 5.124531699509326, 5.2740257796869345, 5.2740257796869345, 11.272985069958438, 11.272985069958438, 2.125061702108455, 2.125061702108455, 14.712478312202057, 14.712478312202057, -0.8759725897865176, -0.8759725897865176, 3.5018759636040375, 3.5018759636040375, 5.198528657808751, 5.198528657808751, 5.644988134063172, 5.644988134063172, 4.624086580602157, 4.624086580602157, 3.9122105674712153, 3.9122105674712153, 10.165233234019475, 10.165233234019475, 6.949707308306597, 6.949707308306597, 7.152245391216474, 7.152245391216474, 7.560663856212632, 7.560663856212632, 4.013282110142517, 4.013282110142517, 12.324654182142885, 12.324654182142885, 5.8616119917576155, 5.8616119917576155, 7.218650779061173, 7.218650779061173, 5.566235550440812, 5.566235550440812, 5.874981783859204, 5.874981783859204, 7.37546406571569, 7.37546406571569, 6.768337682918931, 6.768337682918931, 21.1961452386, 21.1961452386, 4.590823718447641, 4.590823718447641, 3.2869735575635417, 3.2869735575635417, 8.63693865210923, 8.63693865210923, 2.2447744122207096, 2.2447744122207096, 5.250822077331436, 5.250822077331436, 5.671930130265331, 5.671930130265331, 1.1067693313297295, 1.1067693313297295, 16.70799568756529, 16.70799568756529, 8.032673204451378, 8.032673204451378, 7.770785801387431, 7.770785801387431, 1.2625586851212993, 1.2625586851212993, 6.2805786962454695, 6.2805786962454695, 5.609532101807333, 5.609532101807333, 9.464449162449664, 9.464449162449664, 8.447428752866589, 8.447428752866589, 8.645720664828685, 8.645720664828685, 3.056346036886534, 3.056346036886534, 3.593308756093664, 3.593308756093664, 6.812514355348389, 6.812514355348389, 7.931392695534556, 7.931392695534556, 3.2722735734456685, 3.2722735734456685, 14.011882359831205, 14.011882359831205, 5.135746554044625, 5.135746554044625, 14.603091359040754, 14.603091359040754, 4.669356520440372, 4.669356520440372, 7.937465145452489, 7.937465145452489, 1.298108118211375, 1.298108118211375, 3.4373110749906615, 3.4373110749906615, 11.354451930005755, 11.354451930005755, 4.308280274264815, 4.308280274264815, -1.2342950953234697, -1.2342950953234697, 8.558035265974764, 8.558035265974764, 13.330820277658976, 13.330820277658976, 4.518782828962499, 4.518782828962499, 9.644589979606563, 9.644589979606563, 2.8782323574786544, 2.8782323574786544, 6.227392160343444, 6.227392160343444, 1.7697508378092206, 1.7697508378092206, 7.760114888986702, 7.760114888986702, 3.164654735045974, 3.164654735045974, 13.475384030900008, 13.475384030900008, 4.234543863083414, 4.234543863083414, 9.583102365601992, 9.583102365601992, 5.858632310042437, 5.858632310042437, 4.561187584747124, 4.561187584747124, 3.776490658955739, 3.776490658955739, 1.8598037592496608, 1.8598037592496608, 10.338831343429126, 10.338831343429126, 6.515162997686537, 6.515162997686537, 11.126731769468332, 11.126731769468332, 6.817203570843221, 6.817203570843221, 3.2217438512439993, 3.2217438512439993, 5.663129785393535, 5.663129785393535, 8.889747438466618, 8.889747438466618, 4.38287406069681, 4.38287406069681, 6.534704240423277, 6.534704240423277, 16.633986320570465, 16.633986320570465, 4.511292264426799, 4.511292264426799, 5.9037849654927275, 5.9037849654927275, 0.750096127517113, 0.750096127517113, 13.788750489832388, 13.788750489832388, 5.904590637458579, 5.904590637458579, 7.061527536281364, 7.061527536281364, 7.335378783282795, 7.335378783282795, 11.473420053676143, 11.473420053676143, 5.709085727497025, 5.709085727497025, 3.188722984413113, 3.188722984413113, 6.23014496842267, 6.23014496842267, 4.843955628485505, 4.843955628485505, 3.8623854206821036, 3.8623854206821036, 3.5991569835803077, 3.5991569835803077, 3.373055973640429, 3.373055973640429, 0.1923017364679574, 0.1923017364679574, 11.078014348607404, 11.078014348607404, 14.135488891864242, 14.135488891864242, 6.163087535380196, 6.163087535380196, 6.536171949448217, 6.536171949448217, 1.6876505563445734, 1.6876505563445734, 9.345078378132548, 9.345078378132548, 4.952095205899522, 4.952095205899522, 8.696069532344234, 8.696069532344234, 6.6825930390167825, 6.6825930390167825, 2.8279448830269187, 2.8279448830269187, 4.866123051316027, 4.866123051316027, 3.7400220004786378, 3.7400220004786378, 13.259761600534626, 13.259761600534626, 5.772662532483043, 5.772662532483043, 3.8758122672968147, 3.8758122672968147, -0.6412120566900209, -0.6412120566900209, 14.94220795111899, 14.94220795111899, 1.4137099725504745, 1.4137099725504745, 15.602383919893724, 15.602383919893724, 6.661774765702711, 6.661774765702711, 5.402084229437028, 5.402084229437028, 4.39136518822772, 4.39136518822772, 9.161168622314301, 9.161168622314301, 5.429971493589135, 5.429971493589135, 9.768213603425945, 9.768213603425945, 4.932014560596945, 4.932014560596945, 2.219718818467486, 2.219718818467486, 9.99574774617991, 9.99574774617991, 0.22775748531775186, 0.22775748531775186, 2.4340310414485082, 2.4340310414485082, 6.272090852640081, 6.272090852640081, 11.286979207647583, 11.286979207647583, 10.32792347731053, 10.32792347731053, 9.662248367432726, 9.662248367432726, 9.761336960272123, 9.761336960272123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34343950505500687, "mean_inference_ms": 2.2599668709120535, "mean_action_processing_ms": 0.09901307148369869, "mean_env_wait_ms": 0.5936529728681545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 209250, "timesteps_this_iter": 0, "agent_timesteps_total": 627750, "timers": {"sample_time_ms": 13569.083, "sample_throughput": 248.727, "load_time_ms": 0.601, "load_throughput": 5615143.197, "learn_time_ms": 2151.656, "learn_throughput": 1568.56, "update_time_ms": 27.831}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005000000000000001, "total_loss": 15.360472202301025, "policy_loss": -0.018033628445118667, "vf_loss": 15.38680295944214, "vf_explained_var": 0.0031233906745910646, "kl": 0.0032302757823164273, "entropy": 0.8297030866146088, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 2.177767950296402, "policy_loss": 0.013619882706552743, "vf_loss": 2.1712076902389525, "vf_explained_var": 0.6743332475423813, "kl": 0.004456573987755208, "entropy": 0.7073484987020493, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 209250, "num_agent_steps_sampled": 627750, "num_steps_trained": 209250, "num_agent_steps_trained": 627750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8370, "training_iteration": 62, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-01-31", "timestamp": 1706108491, "time_this_iter_s": 13.312325954437256, "time_total_s": 834.0291357040405, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 834.0291357040405, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.55294117647058, "ram_util_percent": 67.92941176470588, "gpu_util_percent0": 0.10529411764705883, "vram_util_percent0": 0.25208237591911764}}
{"episode_reward_max": 15.797004546297496, "episode_reward_min": -10.194878383130803, "episode_reward_mean": 1.4083717479575715, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.849660807166845, "policy_agent_": -1.5182413904792815}, "policy_reward_max": {"policy_adversary_": -5.015206322985579, "policy_agent_": 19.823332676732168}, "policy_reward_mean": {"policy_adversary_": -12.205305852546362, "policy_agent_": 6.806838800251967}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6910693399086314, 3.456902266734205, -2.8609906499065056, 5.170415433089835, -1.0202146493599231, -1.0947764949556542, 4.217995975293625, 1.39682179849436, -3.093062943108798, -2.7725847662042815, 6.346620855442215, -1.6094167699486732, -2.6967185058819756, -5.495555224269566, -2.011255872511023, 0.10226359260390627, 1.9615899612167664, 14.242436192633997, 0.42582406546090396, -0.33629990768397267, 4.055122085529478, 9.607293504768293, 3.3610857596121986, 3.1806966894365245, -0.4882739437102808, -9.720867498170383, 15.088714099510819, -9.410757282966008, 0.9885092821534784, -1.4470208124853676, 8.740442480710708, -8.392408930956705, 7.266537646252272, -0.17010091814082828, 2.7597509399618825, -1.3644793170749372, -1.865313099705721, -0.809786619703121, 11.175008531854777, -4.164782316632835, 5.398154459404964, 1.8126369428810316, 3.102296345079226, 8.849233012471261, 3.0357633647323734, 7.219550317748254, 3.9363302946231857, 3.691442515380631, -6.78810280294363, 1.2544036771967906, -10.194878383130803, -1.6892323454837155, 4.6834431913294, 1.6956591871955398, 1.4173404496393172, 1.0947618842926246, -0.2293524898968021, -1.4818962338072792, -0.997109732858204, 2.5196648482166193, 4.019325046535437, 0.5117865292150033, 2.4058943282522094, -3.596996007482188, 5.014746190678928, 15.797004546297496, 3.992097153140712, -6.475138008647525, 3.8997016417017583, 0.06639106758213748, 4.4620433812840865, 0.2610337723010233, 2.7919843886281512, -3.20158506578143, 2.088476032920123, -1.1847760851754916, 0.034878501586713934, 0.6523299684088665, 7.521446117638268, -1.9296083982453935, -1.3848863290795186, -0.09318060988945653, 0.2513658999442785, 3.1188929396526714, -9.192640090733008, -4.380814302734375, 5.094420591780406, 5.2418454260294665, 6.092306182772658, 3.23052766249737, -4.087648062088617, 4.696438853879047, -0.027180442185425813, -5.213243481435054, -0.6842904950021299, 7.432734232683416, 3.6274307005690023, 7.0990701309789666, 6.466763131380089, 5.293005080071876, -5.29994380418662, -2.0367680885038464, -7.065635756118261, 2.0121293931730326, -1.6188133412208734, 4.252802383275213, -0.7740927983124362, -0.8359395165730208, 12.908868950972476, -0.4729759329738172, 1.2565464195988365, 1.7303696735820933, 13.010498054133114, 9.27457190336085, 0.04480628891308347, -4.864092759866746, 4.760914355170856, -4.348668310278115, -3.400955190632181, 0.06986028459990759, -0.7312097392580679, 0.023424704510096456, 7.833759368573559, 9.229522181429344, 1.204583814876719, -1.2120187778951914, 4.292626865884482, 4.301739195350848, -0.4759583089406755, 5.003015561032389, -8.456895413769246, 7.604311026099553, -3.207479087642322, 3.997035078546463, 2.0498913778842907], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.854376003343097, -10.998756460399324, -9.880530878455351, -16.036352744076428, -9.589445043948464, -13.957775916026762, -18.22375479483099, -8.14125418078872, -9.52386039070568, -8.673613499124588, -12.398994984347704, -7.441416306460812, -11.667357663569923, -16.761090347692836, -5.398200156018945, -11.55268203942887, -13.279123152192257, -20.13264971691511, -6.534370350930716, -10.107931673514017, -11.097816115449568, -18.244984961791165, -11.962741660242257, -10.89394163114324, -11.14552622553394, -20.35944253957914, -21.440358788426767, -8.817170203998055, -6.040992330669607, -6.189760000280393, -18.01266113237239, -12.33993879500144, -13.03198053211875, -23.77851452306374, -10.609031143285913, -8.537135167220328, -9.77540437532065, -21.911347417715103, -18.89989649545352, -7.746579251433308, -15.312598912242525, -11.219260555783077, -9.309151899129173, -16.66227770464917, -9.945795182688457, -14.13098131553185, -15.319875191344979, -15.362843077712991, -9.03938297076324, -17.0715307698442, -7.1583956021722335, -16.384216917642707, -10.460842542140236, -11.966067204144442, -10.90947654195109, -7.76628245385151, -5.2577259392039215, -8.818632210726108, -5.350859107903266, -8.70074158833113, -12.924416164917268, -5.446833911651069, -8.359599268684995, -9.353428200443942, -8.654241102399371, -23.849660807166845, -15.13743295244344, -11.985290348130007, -13.40037806095114, -5.8411436019105665, -12.049592422918595, -5.031568842526284, -7.609371903211835, -10.172318181450104, -15.176179822957705, -8.188939985138902, -7.410575912107632, -9.81994766158082, -13.673616972656205, -18.29469247610596, -10.443053620891552, -21.40708205913164, -13.938784198818565, -15.130008453475183, -18.077491783802557, -10.043512158373952, -12.006905602182307, -11.220879912104712, -12.267486757204761, -13.129740341227743, -5.293265451670726, -14.509488163082194, -10.556850401704965, -5.1552357197443985, -6.241086780661555, -13.843596939269776, -8.356441216520654, -17.153222759772575, -16.57602348737373, -10.751035167487172, -6.117233915773273, -12.664449983906742, -22.971997286524708, -13.384086689486088, -10.44390408189967, -12.073426267218666, -17.1282938044151, -10.215122770266769, -21.637875715919208, -8.750137739787517, -6.29909377562618, -5.015206322985579, -20.43815149701934, -20.316201833487234, -12.574045592808549, -14.600347653870429, -13.736641731930346, -16.1639801926754, -6.418057304629632, -6.978362397421926, -10.979995835194792, -16.344600871427126, -18.07526466639105, -13.823090262233736, -11.882255614674193, -6.5397582250456665, -10.416531289547423, -14.894384314997628, -11.330106202130146, -13.97848395399684, -12.708258647488192, -16.508275664594322, -13.340707319130773, -13.583989038299045, -5.767854776476025], "policy_policy_agent__reward": [6.5816533317172325, 6.5816533317172325, 7.227829363566767, 7.227829363566767, 3.509770114274423, 3.509770114274423, 10.603384088583136, 10.603384088583136, 4.28461519729427, 4.28461519729427, 6.431499710535552, 6.431499710535552, 11.220875385062309, 11.220875385062309, 4.769037989641539, 4.769037989641539, 3.2153987237984416, 3.2153987237984416, 2.950514366460154, 2.950514366460154, 9.372807919894957, 9.372807919894957, 2.9159997682560697, 2.9159997682560697, 4.485319578843972, 4.485319578843972, 5.632767561711636, 5.632767561711636, 1.6934721417539607, 1.6934721417539607, 5.827472816016391, 5.827472816016391, 7.620356556704512, 7.620356556704512, 17.18754295477455, 17.18754295477455, 3.4800972081958097, 3.4800972081958097, 4.885815882915023, 4.885815882915023, 7.576469100489523, 7.576469100489523, 13.926139233279734, 13.926139233279734, 7.661913709927226, 7.661913709927226, 7.037319160289884, 7.037319160289884, 5.328626140911827, 5.328626140911827, 5.319287520704371, 5.319287520704371, 18.264536443968794, 18.264536443968794, -0.2967935394839771, -0.2967935394839771, 3.5147508064115427, 3.5147508064115427, 2.3713695938975126, 2.3713695938975126, 13.376551806541547, 13.376551806541547, 1.9737649320223676, 1.9737649320223676, 10.149259089185511, 10.149259089185511, 11.804206802461454, 11.804206802461454, 6.684391041623899, 6.684391041623899, 3.586327925072695, 3.586327925072695, 3.955045637807464, 3.955045637807464, 10.550780399005992, 10.550780399005992, 15.03745251365415, 15.03745251365415, 1.7908984674002355, 1.7908984674002355, 10.355376685823744, 10.355376685823744, 6.515948749332054, 6.515948749332054, 6.205724122104202, 6.205724122104202, 12.755755358560213, 12.755755358560213, 6.490779273710413, 6.490779273710413, 10.675265816640058, 10.675265816640058, 9.628102742984085, 9.628102742984085, 9.527142796546805, 9.527142796546805, 1.125640083909803, 1.125640083909803, 9.162967223520493, 9.162967223520493, -1.5182413904792815, -1.5182413904792815, 7.347492286079497, 7.347492286079497, 7.572142866734816, 7.572142866734816, 6.830863195669994, 6.830863195669994, 6.163408495795203, 6.163408495795203, 4.430522169072067, 4.430522169072067, 2.5141867246535603, 2.5141867246535603, 3.6683679884594147, 3.6683679884594147, 2.1768746875225307, 2.1768746875225307, 5.610203218273874, 5.610203218273874, 8.471870605726354, 8.471870605726354, 2.979310220433036, 2.979310220433036, 5.3827467984686015, 5.3827467984686015, 2.8782160964808776, 2.8782160964808776, 6.83449364653915, 6.83449364653915, 19.823332676732168, 19.823332676732168, 9.564765052792074, 9.564765052792074, 2.755076169741241, 2.755076169741241, 8.65003985132645, 8.65003985132645, 2.953767334746353, 2.953767334746353, 8.25581790210134, 8.25581790210134, 2.6463013074136543, 2.6463013074136543, 5.200678145919993, 5.200678145919993, 3.4853665578343342, 3.4853665578343342, 8.632327927938915, 8.632327927938915, 3.5020819499817053, 3.5020819499817053, 3.722727206847172, 3.722727206847172, 5.236138814994845, 5.236138814994845, 10.597531545147238, 10.597531545147238, 8.182542038930283, 8.182542038930283, 4.529083645906015, 4.529083645906015, 10.656950724621094, 10.656950724621094, 7.0950750493814185, 7.0950750493814185, 9.12445069656393, 9.12445069656393, 4.4424258465347775, 4.4424258465347775, 2.831348927819789, 2.831348927819789, 8.550663096981356, 8.550663096981356, 8.23136266906709, 8.23136266906709, 9.179896469988709, 9.179896469988709, 8.180134001862555, 8.180134001862555, 0.6028086947910551, 0.6028086947910551, 9.60296350848062, 9.60296350848062, 5.264834979759771, 5.264834979759771, -0.029003880845327054, -0.029003880845327054, 2.7783981428297126, 2.7783981428297126, 10.6381655859766, 10.6381655859766, 5.991935958544829, 5.991935958544829, 12.126146445375776, 12.126146445375776, 11.521393309376908, 11.521393309376908, 8.022020123779525, 8.022020123779525, 0.4086450557933279, 0.4086450557933279, 5.31384094770145, 5.31384094770145, 7.9531807652032205, 7.9531807652032205, 7.698108041329558, 7.698108041329558, 4.412545370339397, 4.412545370339397, 8.16311432524694, 8.16311432524694, 8.177100503051332, 8.177100503051332, 4.689591626846876, 4.689591626846876, 17.273372333445838, 17.273372333445838, 4.138580903406849, 4.138580903406849, 3.7778200976125076, 3.7778200976125076, 3.372787998283835, 3.372787998283835, 16.72432477557623, 16.72432477557623, 14.795386868424044, 14.795386868424044, 6.309425940860814, 6.309425940860814, 4.86812744700184, 4.86812744700184, 9.248778043550601, 9.248778043550601, 5.907655941198643, 5.907655941198643, 1.508551056998725, 1.508551056998725, 3.5241113410109173, 3.5241113410109173, 5.124393047968363, 5.124393047968363, 8.184012787968612, 8.184012787968612, 12.954512017482301, 12.954512017482301, 11.526306221831542, 11.526306221831542, 6.543419714775459, 6.543419714775459, 2.6638697235752367, 2.6638697235752367, 7.354579077715953, 7.354579077715953, 9.598061755174237, 9.598061755174237, 5.427073946594734, 5.427073946594734, 9.490749757514612, 9.490749757514612, 2.12568161685947, 2.12568161685947, 12.056293345346939, 12.056293345346939, 5.066614115744226, 5.066614115744226, 8.790512058422753, 8.790512058422753, 3.908873077180158, 3.908873077180158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429390364964212, "mean_inference_ms": 2.25725114029915, "mean_action_processing_ms": 0.0989430779349693, "mean_env_wait_ms": 0.5928975327501977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 212625, "timesteps_this_iter": 0, "agent_timesteps_total": 637875, "timers": {"sample_time_ms": 13396.99, "sample_throughput": 251.922, "load_time_ms": 0.701, "load_throughput": 4817019.771, "learn_time_ms": 2141.966, "learn_throughput": 1575.655, "update_time_ms": 26.133}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 13.803664493560792, "policy_loss": 0.004764350550249219, "vf_loss": 13.807112693786621, "vf_explained_var": 0.02451860308647156, "kl": 0.0023837705944245945, "entropy": 0.8212384402751922, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.6197753429412842, "policy_loss": -0.01364985204563709, "vf_loss": 1.6404909193515778, "vf_explained_var": 0.747671690583229, "kl": 0.005328652816538726, "entropy": 0.7074075222015381, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212625, "num_agent_steps_sampled": 637875, "num_steps_trained": 212625, "num_agent_steps_trained": 637875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8505, "training_iteration": 63, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-01-44", "timestamp": 1706108504, "time_this_iter_s": 12.466298341751099, "time_total_s": 846.4954340457916, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 846.4954340457916, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 29.98125, "ram_util_percent": 67.66875, "gpu_util_percent0": 0.1125, "vram_util_percent0": 0.2433013916015625}}
{"episode_reward_max": 15.01043140467842, "episode_reward_min": -13.632555728433355, "episode_reward_mean": 0.2021069942164635, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.643505145212973, "policy_agent_": -1.6544950530544953}, "policy_reward_max": {"policy_adversary_": -3.9828027231245944, "policy_agent_": 19.37105827840624}, "policy_reward_mean": {"policy_adversary_": -11.386702509240802, "policy_agent_": 5.794404751728632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.6025747394050436, -2.5512274160625146, -0.48869271488848043, 1.4089445609699403, 4.115948444906066, 8.442299327592858, -3.7857545032599447, 1.4923838688536613, 5.549982535388167, 5.285128260325798, 6.864518121966475, 1.7208761556290812, 6.4706814982028265, -1.5294174402319172, -0.24326562743439584, 3.1365915182594093, -0.15844186367442936, -1.6665856271245971, 9.939085413342704, 1.278450576530739, -1.1015670690700594, -2.9842362612532853, -2.236579431907112, -6.425729583420339, -1.4286164664994239, -1.9568733867972892, 0.8456953588372477, -11.032864483365305, 0.6417121139496788, 4.583953363184739, -1.6788011153928075, -8.825602432232053, 1.3811581376392201, 3.573820640546832, -5.359760662995954, 7.838430384171841, 5.330305709761568, 5.329124455789666, 3.055676991154398, -1.6253307200923457, 1.796931485643308, -3.230072697431588, -4.015972083033462, -1.972424415362686, 0.3742811178449539, -3.527403552426491, 3.027321368090422, 6.647903209180761, 4.585068189765902, 1.0084152122053842, -1.567516934636301, -7.000381643898595, 0.9551879603638423, 9.426577126178534, 2.3227558375410142, 9.998188540680928, 4.5963781459729445, 0.10122115860664857, -4.543933472894026, 6.4600718203687775, 2.5732855858121555, -5.407867041873586, 2.9835519786831184, 6.543901852337731, 2.5675783033182897, -10.300588173324224, 8.092691377246284, -0.1879093602436941, -4.795798148281142, 2.3561966367083413, 0.2462853744443514, -7.549277992044309, -1.3904490924743684, 2.759438993738939, -2.212833763727404, -0.0851704644448939, -5.556578046875927, -5.332067607694071, 1.3702774552808497, -0.24105881317304553, -1.0206000122838137, 4.517277078727073, -0.38306723486219485, -3.145445379885175, 1.1065471830773106, -12.090179170995352, -0.9080216042680656, 10.970581172128059, 1.4091705828862924, 7.909206513783474, -7.3733868882427664, 2.3627178263880637, -10.018626478367151, -10.950556687389618, 0.5863119295157049, 2.503255512707147, 10.934198877608232, -13.632555728433355, 2.648714150516255, -3.8736770071084465, -9.826775672941148, -2.9439303264210714, 7.772220524513294, -5.419598101165924, -9.77607399771497, -0.6888142325012956, 1.1972446201094573, 3.9345223800712352, -7.696364679803673, -5.684747856744542, 0.9417855138978782, -2.054075845819068, 3.0083609293806024, 3.184477906037559, -9.892575903221003, -0.048899451949582146, 2.324638499919875, 5.588026550135699, 3.2022159230290597, -3.5102204496960083, -7.669254969398673, 9.816765151700292, -1.485686545241963, 4.657621678980043, 4.995587747149771, 15.01043140467842, -3.410845838014837, -1.305805304790212, -1.8629164968883951, -13.562376747307793, 3.7562325855952734, 1.4491516805274698, 1.0446080462144616, 7.083973468179484, 10.124626075151895], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.522058458361853, -14.679824450118248, -5.668425986073278, -11.98533544285549, -10.248673186321234, -21.741408304045333, -10.715199413852881, -6.2844805936728765, -18.982523550194202, -17.507115762545904, -14.16424491498068, -10.756018477376402, -16.022457697256694, -3.9828027231245944, -8.313433468134864, -12.952495675389372, -12.793148863975556, -14.171691811542473, -14.638399551405936, -7.861479939549268, -6.725884119357659, -11.860730465598005, -7.71544652003316, -13.726017843685717, -16.818584436017733, -8.465535332505608, -10.361132710708254, -16.661465241035224, -6.739799479396379, -15.433229144445074, -7.469683819093623, -22.15501688879304, -5.685239373919352, -16.61280749268124, -16.21441790293678, -15.705067818588343, -12.813815446438387, -26.643505145212973, -10.142355171551134, -11.34246987096239, -6.559681430399774, -6.265359101131796, -8.445404191865643, -7.2911568038528225, -7.728783460872455, -8.56555514279052, -16.626261375477775, -14.3097412556472, -10.565176756563623, -6.005261666321699, -5.476211559939929, -5.07166278226958, -4.788159557533258, -14.37420621264581, -9.718082484860535, -16.866295371608757, -9.028150942079039, -9.232567627521227, -10.560113340108629, -10.04216829813365, -14.218364728376784, -13.876838775128189, -9.800897127530869, -12.486792143752591, -8.995139122055804, -9.809155776845715, -16.218543609190636, -5.784440633197825, -11.439555126991705, -13.66457852713969, -8.003427799900175, -10.8776302733781, -4.358270775004913, -8.47517938841398, -13.237841302306576, -15.808902150516307, -7.669334998506355, -13.752307517860412, -11.990054887397898, -8.038488969617877, -5.6295206015773305, -11.493324892809461, -4.2426871046312655, -5.667165525897068, -8.776955157367793, -9.428062228891305, -5.598148402469058, -17.16492040352689, -6.079682446866503, -14.01756932063118, -17.52222571778601, -8.274379437290612, -22.156729943880343, -15.430420821352016, -6.807372521147501, -10.078897105195356, -18.088255776773366, -16.081563923836157, -7.433022565134991, -6.846274569482078, -9.429634017612631, -7.016717283959272, -12.152192752086139, -11.0177676247062, -6.467083891605983, -11.055577974942116, -9.3002690206059, -17.108528425248984, -14.160636832931518, -13.140844690444855, -13.080118387370794, -15.566703755939432, -8.902737942737652, -9.60431008459304, -12.212155912531676, -8.111458833123345, -10.765132710495728, -13.228680848132672, -5.878870432433297, -7.5822291749502435, -15.759630776252253, -18.474871310955017, -12.980674285372809, -9.410685015240206, -8.915452208167157, -23.73168515213407, -9.70391109518849, -15.243396697385412, -5.7371926127028186, -11.9971822415062, -9.13540346516146, -9.58898132416985, -11.878282244190652, -14.517334626949715, -19.222161140661054], "policy_policy_agent__reward": [3.9597418594784033, 3.9597418594784033, 6.0642985170278685, 6.0642985170278685, 2.5898666355924, 2.5898666355924, 6.697140001912713, 6.697140001912713, 7.18231081561365, 7.18231081561365, 15.09185381581909, 15.09185381581909, 3.464722455296468, 3.464722455296468, 3.8884322312632666, 3.8884322312632666, 12.266253042791188, 12.266253042791188, 11.396122011435848, 11.396122011435848, 10.514381518473575, 10.514381518473575, 6.23844731650274, 6.23844731650274, 11.246569597729762, 11.246569597729762, 1.2266926414463386, 1.2266926414463386, 4.035083920350234, 4.035083920350234, 8.044543596824392, 8.044543596824392, 6.317353500150562, 6.317353500150562, 6.252553092208936, 6.252553092208936, 12.288742482374321, 12.288742482374321, 4.569965258040002, 4.569965258040002, 2.812158525143799, 2.812158525143799, 4.438247102172361, 4.438247102172361, 2.739433544063025, 2.739433544063025, 3.6501441301326873, 3.6501441301326873, 7.694983984759158, 7.694983984759158, 3.2543309728541585, 3.2543309728541585, 5.6034140347727535, 5.6034140347727535, 2.8143003788349628, 2.8143003788349628, 3.6907557966730287, 3.6907557966730287, 10.008591253814908, 10.008591253814908, 2.895441351850407, 2.895441351850407, 6.664707228280502, 6.664707228280502, 3.5331987557792863, 3.5331987557792863, 10.093314066614033, 10.093314066614033, 5.427328619970411, 5.427328619970411, 11.771749101380092, 11.771749101380092, 9.072060578099975, 9.072060578099975, 15.986314800501315, 15.986314800501315, 6.599016081352765, 6.599016081352765, 4.8585695754350215, 4.8585695754350215, 4.178306458021542, 4.178306458021542, 1.5176432018501047, 1.5176432018501047, 2.214716054416092, 2.214716054416092, 2.6593661942450675, 2.6593661942450675, 4.051532289358703, 4.051532289358703, 2.5190757951820144, 2.5190757951820144, 9.8267913717841, 9.8267913717841, 10.478822232413979, 10.478822232413979, 7.575122473164764, 7.575122473164764, 3.506838439263541, 3.506838439263541, 1.9543473126518136, 1.9543473126518136, -0.9643594308145077, -0.9643594308145077, 2.8716737589485506, 2.8716737589485506, 11.900391669412175, 11.900391669412175, 6.020419161200775, 6.020419161200775, 13.432241956144841, 13.432241956144841, 6.8122645440259895, 6.8122645440259895, 4.666894393063937, 4.666894393063937, 3.0080899336073017, 3.0080899336073017, 8.251120059251216, 8.251120059251216, 8.39582515709447, 8.39582515709447, 4.234485866627305, 4.234485866627305, 6.392224553106996, 6.392224553106996, 9.515346998045159, 9.515346998045159, 5.781358712687046, 5.781358712687046, -0.24571619823925372, -0.24571619823925372, 12.155617493218463, 12.155617493218463, 2.7982656364770655, 2.7982656364770655, 3.321878489355282, 3.321878489355282, 8.01038758192402, 8.01038758192402, 4.124856587172263, 4.124856587172263, 1.6641761406668927, 1.6641761406668927, 1.4839108412652728, 1.4839108412652728, 5.617309191076462, 5.617309191076462, 5.512503769289585, 5.512503769289585, 7.861865843035706, 7.861865843035706, 1.0563784758152144, 1.0563784758152144, 4.210119955083168, 4.210119955083168, 6.680166171339373, 6.680166171339373, 3.8987150782224163, 3.8987150782224163, 2.304460294646758, 2.304460294646758, 8.005300985768267, 8.005300985768267, 1.929809934884535, 1.929809934884535, 1.260860073005947, 1.260860073005947, 4.941751170222552, 4.941751170222552, -1.33105847105202, -1.33105847105202, 2.345063399100496, 2.345063399100496, 14.067750787827475, 14.067750787827475, 3.744426514876397, 3.744426514876397, 10.963387917207324, 10.963387917207324, 5.074419414771624, 5.074419414771624, 5.318548631839339, 5.318548631839339, 6.069051732756597, 6.069051732756597, 2.2399320669812006, 2.2399320669812006, 3.696842225331603, 3.696842225331603, 6.291076308951252, 6.291076308951252, 14.511227327190804, 14.511227327190804, 1.224504097701392, 1.224504097701392, 5.040868357825622, 5.040868357825622, 1.4862987811868162, 1.4862987811868162, -0.19857082766426004, -0.19857082766426004, 2.036393478769101, 2.036393478769101, 9.962206638299719, 9.962206638299719, 2.7990847617701373, 2.7990847617701373, -1.6544950530544953, -1.6544950530544953, 5.183381871220411, 5.183381871220411, 5.248756820357681, 5.248756820357681, 10.521525402660108, 10.521525402660108, 3.2321360765639233, 3.2321360765639233, 3.7280484168501524, 3.7280484168501524, 7.0109519506343325, 7.0109519506343325, 6.756313955060181, 6.756313955060181, 5.955549436059127, 5.955549436059127, 6.394393995315296, 6.394393995315296, 1.1597900046553407, 1.1597900046553407, 4.0312796905868815, 4.0312796905868815, 6.544885605207801, 6.544885605207801, 9.408353699134185, 9.408353699134185, 4.5405431777311795, 4.5405431777311795, 2.036004362627118, 2.036004362627118, 4.04518790342679, 4.04518790342679, 14.145818231327654, 14.145818231327654, 5.74749387006542, 5.74749387006542, 7.034153347110125, 7.034153347110125, 6.9555199776584615, 6.9555199776584615, 19.37105827840624, 19.37105827840624, 3.1465326285868263, 3.1465326285868263, 6.968795696297597, 6.968795696297597, 1.9371380579072124, 1.9371380579072124, -0.7825972529007941, -0.7825972529007941, 6.445818025378366, 6.445818025378366, 5.519066502348659, 5.519066502348659, 6.461445145202557, 6.461445145202557, 10.800654047564604, 10.800654047564604, 14.673393607906473, 14.673393607906473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342856600987341, "mean_inference_ms": 2.2543685904644506, "mean_action_processing_ms": 0.09888305960925413, "mean_env_wait_ms": 0.5920851313788428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 13316.762, "sample_throughput": 253.44, "load_time_ms": 0.601, "load_throughput": 5616257.092, "learn_time_ms": 2172.341, "learn_throughput": 1553.624, "update_time_ms": 27.927}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005000000000000001, "total_loss": 12.688441944122314, "policy_loss": -0.00473477618288598, "vf_loss": 12.701435375213624, "vf_explained_var": 0.016585516929626464, "kl": 0.004616934952472862, "entropy": 0.8258663237094879, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.731228518486023, "policy_loss": 0.0006884772330522538, "vf_loss": 1.737690818309784, "vf_explained_var": 0.6695933878421784, "kl": 0.0062994773514060826, "entropy": 0.7160638093948364, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 648000, "num_steps_trained": 216000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8640, "training_iteration": 64, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-01-56", "timestamp": 1706108516, "time_this_iter_s": 12.771735906600952, "time_total_s": 859.2671699523926, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A046CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 859.2671699523926, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 33.705882352941174, "ram_util_percent": 68.02352941176471, "gpu_util_percent0": 0.39882352941176474, "vram_util_percent0": 0.24211569393382354}}
{"episode_reward_max": 14.076202636695557, "episode_reward_min": -11.447373648164199, "episode_reward_mean": 0.39780577753537255, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -34.68161137630109, "policy_agent_": -0.9420714523472263}, "policy_reward_max": {"policy_adversary_": -5.013033998337679, "policy_agent_": 18.270689171152824}, "policy_reward_mean": {"policy_adversary_": -11.797126925408332, "policy_agent_": 6.097466351471852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.09687322501493068, -5.782129915668151, -0.7495675484103257, 0.6941769821296186, -2.0650318779281718, -9.184683244609943, 2.2994416731871055, -5.909106949996154, 4.276640074960897, 3.417332388747542, -0.2358860600942716, -4.07608405045482, -4.11155322816619, 11.88739196269344, 1.1452336208351892, 0.9354354285169251, -3.5614314754911067, -7.254471894396898, 2.290419355680856, -2.8120459858565354, -8.297623372582033, -1.8223825092048143, -3.081653578799456, -8.172351769689113, 3.7610111879373265, 4.038994850549457, 5.2993847499298745, 2.5168972468957778, 4.974029109253383, -1.0393310233351758, 3.2817369948954798, 2.6601461840095477, 1.8597669660045613, -0.5129845293967035, -2.317037866621215, -2.9590231597108025, 4.361233578279051, 6.291640305971236, 7.663878501910233, 3.110145583238471, 3.817924471689427, 10.765032799517634, -0.9037731151040834, 11.41280496808124, 2.2999121762489185, 0.4605956094346113, 1.8911052047580497, 7.736812475077958, -8.689304874860165, 5.570318000793563, -3.762815316928619, 1.4386866168775923, -7.968630584439977, -1.5054507628731018, 2.97562205338861, -3.753306741649986, -6.617360720103113, 0.9844660173731354, 10.855053487324911, 2.139966943991325, -1.2550806945148016, 0.4612099119523216, -1.66152240662871, 3.023826947187699, -6.41954726641267, 3.197281806941094, 3.3172972480758354, 5.249977227609104, 1.3675120669127458, 2.215522225555493, -8.589490907565674, -7.239683252738084, -0.8414062959127007, -11.18905647740961, -5.698722681515738, -0.3154128789045826, 4.843428831949028, 5.391729255809611, 4.960293034714787, 4.431492031450084, 9.953155367667474, 5.427686344106543, -9.86863352630209, 1.4198985447384207, -0.8227415428431681, 1.4902212995406146, -0.8666599791459464, 0.3852468301814712, 0.1965893209709393, -0.6398846485784171, -8.850145222513863, 0.31278651721324136, -4.75756345529312, 4.08219647295563, -2.3010131274596386, 2.7382143820724334, 8.088708374107119, -4.108608834991631, 1.7918437075905678, -2.7619234438313174, 4.373775852889894, 0.44344914819284037, 10.160230329478873, 2.03750110592973, 3.8517836225355304, 4.445696883632054, -1.178209477154934, 2.404001732262039, -1.213963138662268, -4.019771537957136, -1.1832726279583503, -0.03944049320077625, 0.41429128244730196, 2.8891767909517205, 14.076202636695557, -0.5450150577745043, 3.5857529015982488, -5.227474766661699, -6.621428136504383, -4.216888820737006, -3.5914087067718006, 2.8447149757817742, 6.618810306194235, 2.5866502157470728, 1.281006850064179, 3.4063166505019913, 2.237367155299711, 4.6116049346004955, -11.447373648164199, -4.879733242766353, -1.2253712114989923, 1.4897577016662182, -2.652437224952841, -2.063121911053231, 2.02023559708672], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.793016241478239, -7.795463517876514, -22.77057169901221, -10.975144501375903, -8.236598910454644, -11.258296966277436, -16.129378124289076, -9.439919523564333, -11.518329623720565, -11.262186732673964, -6.856985385957748, -7.8945258657978234, -10.831556579090083, -19.9006079230174, -6.680281929336329, -6.53619497588348, -16.471965477619285, -8.349828817564232, -13.254706917341187, -5.976044444017357, -17.97471854923133, -6.884328971573048, -6.114764466246899, -6.288208864994652, -18.041257939022106, -8.86004348561566, -11.664419834851058, -11.71163385814873, -10.860657509679557, -21.34451535166574, -12.29558483308331, -11.23330817445349, -34.68161137630109, -10.52229514044881, -9.678281260097362, -6.750746727978121, -11.686768958947994, -16.544027559671015, -12.449930886557926, -8.40359902337495, -11.81776566332367, -18.297705549897195, -14.910314122822376, -22.75693401978976, -7.738299895946126, -5.013033998337679, -10.618527058785808, -18.713079541115025, -17.19630193683776, -19.23414724406638, -11.301829913218052, -9.109836746672224, -19.030759050764704, -15.184579011952078, -15.194737972138553, -12.388056186909088, -21.469943128504543, -9.351364693354789, -14.779833991742278, -12.895846329991896, -7.936115565372573, -21.364216446468085, -7.205489617382046, -9.307380017833566, -9.633560878120882, -7.624711290473807, -9.652083421807943, -11.525761064835645, -9.103956679710143, -7.246725192708654, -11.340033091113416, -11.142389681482857, -6.268147742952971, -10.692640303821724, -12.410098134667988, -12.109374355505864, -11.539971382397257, -17.36294157700767, -9.248531180962315, -11.419068775514384, -15.697779507334978, -10.690145149042381, -14.976297749640953, -10.365012768567144, -8.55496865807563, -5.59647006110054, -10.282868565266408, -14.495959690758708, -9.126937682412642, -18.525202419437804, -9.461602290675412, -6.784682999207998, -9.589414225622086, -8.460665197509785, -5.129223485653968, -10.296292415627187, -17.601800899747282, -9.135184938596145, -8.20189602147077, -6.379345504269425, -8.116981235409781, -11.300055630963682, -22.156615115588693, -15.327636982637303, -16.100026482746593, -12.880865904999153, -10.109077750955496, -9.913209508437726, -7.912611050322104, -8.369222987828575, -7.497823362747557, -7.311935286802293, -9.091802329675392, -12.30718158773548, -20.8095927646343, -5.841768851647287, -9.809176295498819, -6.436054235230947, -19.943252552464894, -9.830695653902934, -5.993570658139926, -15.715829789945404, -11.827267053893399, -9.536677402634464, -10.106761817282052, -18.347009274303172, -21.96588381683897, -10.904869570464356, -11.35396726957244, -11.288417754548782, -5.019599476547863, -15.050777511544663, -9.152059767290393, -11.348156569233632, -9.525552013038626], "policy_policy_agent__reward": [3.848071508231655, 3.848071508231655, 1.006666801104182, 1.006666801104182, 11.010502075300945, 11.010502075300945, 5.834660741752764, 5.834660741752764, 3.0857835162632368, 3.0857835162632368, 1.0368068608337448, 1.0368068608337448, 9.214409898738094, 9.214409898738094, 1.7654062867840865, 1.7654062867840865, 7.89748484934073, 7.89748484934073, 7.339759560710752, 7.339759560710752, 3.310549662931738, 3.310549662931738, 1.9092209076715023, 1.9092209076715023, 3.3600016754619437, 3.3600016754619437, 15.893999942855423, 15.893999942855423, 3.9127577750857583, 3.9127577750857583, 3.7358152022002034, 3.7358152022002034, 6.455267001064089, 6.455267001064089, 0.5476784615836662, 0.5476784615836662, 7.772563136511021, 7.772563136511021, 1.5819992290804101, 1.5819992290804101, 4.838547588324647, 4.838547588324647, 2.5309732311841167, 2.5309732311841167, 1.5165554437237212, 1.5165554437237212, -0.9420714523472263, -0.9420714523472263, 10.901134563479715, 10.901134563479715, 6.449519168082558, 6.449519168082558, 8.481902292390467, 8.481902292390467, 7.114265552522253, 7.114265552522253, 7.917343309466467, 7.917343309466467, 10.152592164165284, 10.152592164165284, 7.788660913989397, 7.788660913989397, 6.94672717923152, 6.94672717923152, 18.270689171152824, 18.270689171152824, 5.004655305526053, 5.004655305526053, 3.680621696738074, 3.680621696738074, 1.8958617841336582, 1.8958617841336582, 8.024001268613526, 8.024001268613526, 11.41783393282113, 11.41783393282113, 10.056904694234074, 10.056904694234074, 5.75687230330671, 5.75687230330671, 7.817845067506548, 7.817845067506548, 14.531369174707415, 14.531369174707415, 7.003270503859146, 7.003270503859146, 17.084869493935496, 17.084869493935496, 5.019106036097521, 5.019106036097521, 2.7368148038861464, 2.7368148038861464, 6.25481613177193, 6.25481613177193, 13.224946008096492, 13.224946008096492, 4.253498530988798, 4.253498530988798, 12.40223262242997, 12.40223262242997, 3.769507298144714, 3.769507298144714, 5.274261681774906, 5.274261681774906, 5.531064233162362, 5.531064233162362, 6.839564124539488, 6.839564124539488, 9.085180012763583, 9.085180012763583, 4.317374722629552, 4.317374722629552, 7.426291204200712, 7.426291204200712, 5.167915355363962, 5.167915355363962, 12.817443739533593, 12.817443739533593, 7.517906636991607, 7.517906636991607, 3.3405174354288873, 3.3405174354288873, 10.912713179210202, 10.912713179210202, 2.7719836053766667, 2.7719836053766667, 6.165603482510631, 6.165603482510631, 1.6070068058541052, 1.6070068058541052, 5.41099654870745, 5.41099654870745, 6.484690334941889, 6.484690334941889, 8.387869146222377, 8.387869146222377, 5.235734373311444, 5.235734373311444, 4.731123709132074, 4.731123709132074, 1.3752710917738664, 1.3752710917738664, 1.951353214372389, 1.951353214372389, 2.713370723520135, 2.713370723520135, -0.24820808679394424, -0.24820808679394424, 3.355687726576122, 3.355687726576122, 5.896980738300643, 5.896980738300643, 8.19170010717314, 8.19170010717314, 11.377335416408636, 11.377335416408636, 7.104412107838551, 7.104412107838551, 7.925280403482235, 7.925280403482235, 12.825467437501226, 12.825467437501226, 8.058915746574462, 8.058915746574462, 2.553832111669433, 2.553832111669433, 5.892455656652781, 5.892455656652781, 3.8661135576162318, 3.8661135576162318, 3.543345680320578, 3.543345680320578, 4.70810429306023, 4.70810429306023, 7.440603260470088, 7.440603260470088, 4.661763501691788, 4.661763501691788, 8.942658885429696, 8.942658885429696, 0.30572853408077494, 0.30572853408077494, 3.5487347582106197, 3.5487347582106197, 2.4159253851644835, 2.4159253851644835, 6.2714308352327075, 6.2714308352327075, 1.414105179097166, 1.414105179097166, 6.5172533988498085, 6.5172533988498085, 12.845254636927198, 12.845254636927198, 2.5132880518022582, 2.5132880518022582, 4.9968698645306695, 4.9968698645306695, 1.8087110302190539, 1.8087110302190539, 6.245378544149839, 6.245378544149839, 5.871752389578261, 5.871752389578261, 16.158422722533782, 16.158422722533782, 8.682569044283515, 8.682569044283515, 9.975905052641068, 9.975905052641068, 8.663281394315604, 8.663281394315604, 4.4654341369002815, 4.4654341369002815, 6.158605620349883, 6.158605620349883, 3.3493239558299184, 3.3493239558299184, 2.1747257249357195, 2.1747257249357195, 3.157275367394603, 3.157275367394603, 3.636247396800758, 3.636247396800758, 4.753046806061344, 4.753046806061344, 7.598179189343602, 7.598179189343602, 17.442897700664926, 17.442897700664926, 2.6483768969363917, 2.6483768969363917, 6.6974645985485335, 6.6974645985485335, 0.6042897342846226, 0.6042897342846226, 6.660912207980257, 6.660912207980257, 2.8069034165829656, 2.8069034165829656, 1.2010809756840626, 1.2010809756840626, 9.280272382863592, 9.280272382863592, 9.223038680043816, 9.223038680043816, 6.061663809190767, 6.061663809190767, 5.693884333673114, 5.693884333673114, 10.876662962402579, 10.876662962402579, 12.101625486069345, 12.101625486069345, 7.758237252532425, 7.758237252532425, -0.04670318929587902, -0.04670318929587902, 3.2043422558912167, 3.2043422558912167, 1.8971141325244352, 1.8971141325244352, 8.270267606605442, 8.270267606605442, 3.2498112711687757, 3.2498112711687757, 4.642517329090202, 4.642517329090202, 5.772893805062672, 5.772893805062672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3431752528959276, "mean_inference_ms": 2.256675314139047, "mean_action_processing_ms": 0.09906442369773281, "mean_env_wait_ms": 0.5926104126693655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 219375, "timesteps_this_iter": 0, "agent_timesteps_total": 658125, "timers": {"sample_time_ms": 13368.341, "sample_throughput": 252.462, "load_time_ms": 0.501, "load_throughput": 6735072.795, "learn_time_ms": 2141.592, "learn_throughput": 1575.931, "update_time_ms": 27.527}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005000000000000001, "total_loss": 14.005416965484619, "policy_loss": -0.003173608591168886, "vf_loss": 14.016619300842285, "vf_explained_var": 0.04882938265800476, "kl": 0.005686387945553118, "entropy": 0.802826875448227, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.8989447951316833, "policy_loss": -0.0012534990906715392, "vf_loss": 1.907133561372757, "vf_explained_var": 0.6912225663661957, "kl": 0.006832690584180212, "entropy": 0.6945962160825729, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 219375, "num_agent_steps_sampled": 658125, "num_steps_trained": 219375, "num_agent_steps_trained": 658125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8775, "training_iteration": 65, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-02-10", "timestamp": 1706108530, "time_this_iter_s": 14.069000482559204, "time_total_s": 873.3361704349518, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08D62CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 873.3361704349518, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 38.81111111111111, "ram_util_percent": 67.43333333333334, "gpu_util_percent0": 0.05055555555555556, "vram_util_percent0": 0.2425265842013889}}
{"episode_reward_max": 18.325040854126648, "episode_reward_min": -10.57887441258185, "episode_reward_mean": 0.9270395016271592, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.649725581445832, "policy_agent_": -0.35462410080503504}, "policy_reward_max": {"policy_adversary_": -3.0850337477752126, "policy_agent_": 23.487383217786242}, "policy_reward_mean": {"policy_adversary_": -11.107865560574353, "policy_agent_": 6.017452531100756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.9983350268423905, 18.325040854126648, -0.6940362874594548, -6.304920448446082, 3.069873086339053, -5.365842633134312, 4.1988279089989184, 10.192729703136216, 4.139465186915549, 1.3890940312208688, 0.30152732326178117, -1.5540657522741013, 1.6575414243498316, -1.0007135628070678, -1.028515251433777, 0.9672874271024163, -1.4432864214980183, 0.06656783364498359, -1.605021995751696, -6.168611792394709, 4.856899874339511, 3.41992878265758, -2.561994393607132, 0.7453439432623906, 4.49936989648921, 1.8542866343574989, 0.8304831638921566, 0.4955431359871545, 7.356410040846105, -0.9125874073669328, -1.0751540539381153, 0.7398321771187233, -1.2167727096905585, 4.20815264446934, -2.40954622069193, -9.010180991230593, 1.1512964851964649, 2.032504215943984, -2.7638804604710745, 1.4100458895191226, -1.3385628627946131, 4.629211104015964, 2.5860789606425736, -1.0763926848782996, -3.202810068669952, -1.651202527239576, 0.9553371810020326, -3.077886256460866, 2.6711461456461016, -3.2111450203117573, -2.3164054558777054, 2.433152763451437, 4.177417288039959, -4.399025338090921, -3.368856848645603, -4.032934772667267, 4.08036710956175, 0.589539382950012, -2.2327586020595747, 5.250802015052311, 1.1324354767168319, -0.8751524796661185, -3.6959439380989205, 0.6693677810602788, -4.787837223732501, 0.49743538089875455, -3.4141484048762196, 0.5422700902687159, 8.571994100025176, 6.555142014969572, 2.6750048278033467, -10.57887441258185, 2.637755912359438, -0.7134392604412242, 3.0418712357035522, 5.272392839357499, -2.9356037329629854, 1.039669567107603, 8.3107442860953, 1.5915055313883386, 8.953492587640822, -1.5988847509026662, 2.949386997123403, 3.4764494987438885, 2.3650080082793297, 4.72404833166591, 1.0038982886597925, 6.658588919266539, 5.872422458947417, 2.4523232779626225, 2.0056420270173554, 0.6540050037495004, 1.0618821378847831, 7.196196978931041, 0.7345761845212506, 6.952791043486497, -1.5284780471133788, -10.491279077323094, 2.0968283770147025, 0.3547204330593236, 2.534988208859448, 7.049968757169205, 0.5946273512782038, -6.271377675793011, 7.389121255161905, -2.2170507037951923, -1.0763380814774244, 6.276229944975729, 4.581747197511445, 1.8547863162362832, -3.6385062124026, -4.8271720108786775, 8.515274305395398, 3.0569957208368908, 1.2351406206726325, -3.518880218311582, -4.941175529044284, -4.746812351211893, 2.164120490748703, 3.9228968458015294, -1.2721260547258333, 6.457416398229465, 6.605534355396369, 6.409271482144797, 0.5166922397281241, -4.9813575940069486, -4.722274120827238, 2.7494898870265176, 2.8927535975027276, -5.2673495112823066, 3.622812203222353, 0.4573225221384567, 8.031979045477572, -5.219676176036684, 2.241394177133218], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.206066769218515, -28.649725581445832, -5.0616178827763205, -9.969786014611293, -16.04925361663376, -14.796793911395222, -9.127073722046331, -16.842889636762184, -15.384303555404642, -17.851127498338805, -4.180489284286755, -13.327290278701275, -8.045301283148017, -10.474090913897575, -10.471911747352982, -9.751605653257892, -11.066304765177176, -6.790942409370354, -5.751869002075705, -12.24653091160822, -11.55235655767648, -9.480554271690748, -9.007378800353054, -6.822551038333673, -14.283528599808447, -12.168031876351776, -8.745646301697036, -20.135258667326863, -12.587169167227911, -5.508006342759568, -5.085751141943247, -7.730099463894248, -8.244920342180176, -14.105198177980247, -7.726147026970985, -14.396055558796666, -7.049823631694539, -7.8849347576832445, -5.983873032711171, -4.3703595407251274, -15.252800177496486, -10.171079688041223, -17.53768095881638, -10.780441220609433, -3.0850337477752126, -19.645678534074797, -11.194573960908196, -7.846561206843845, -9.019819142598582, -9.374499376026412, -8.424048132724328, -7.763212980891425, -9.370864868614328, -7.0854154748971725, -20.28900042680222, -10.969855668699282, -9.542099946916453, -13.226405307908456, -8.272408115665154, -17.75684711019609, -20.17755555899913, -11.422330346866538, -7.526513669208402, -7.325928173845738, -14.82665138526442, -11.162990231076147, -6.4166554055441125, -6.459018953675843, -12.357555934836883, -18.56143834861901, -7.712489591914053, -9.869626210971782, -10.307473399851762, -5.989552524914134, -10.508467274143177, -13.510009053503333, -10.924896255182144, -11.45033773924842, -16.304938603782073, -7.2790167628883395, -15.823621321733306, -6.2697346763173964, -10.498754823984013, -8.680026099436892, -8.79350916327312, -9.97251351724942, -10.175857652984417, -13.74945752243609, -12.285506764230096, -7.841638272558389, -7.357773869215133, -6.519635353422647, -5.1670954989829285, -19.219082378130835, -7.750227800960742, -13.487705091884733, -11.38290057257239, -21.787816419744537, -15.110710858625415, -19.358575398040486, -7.411037837276817, -13.929402137509932, -11.798703281844372, -9.780430701965786, -12.788535025753717, -9.151547771120082, -6.522713385356569, -10.237925599710545, -19.19050308551662, -10.199570771010153, -10.502342031704185, -5.797653583351956, -16.28878839521876, -8.083085042714986, -7.166445150635841, -16.52413523629262, -15.0778013946505, -12.96183085970755, -6.396536032962916, -9.811548758835547, -7.42364383168022, -14.40555610658468, -12.05432575744225, -9.83006221389968, -16.496446787147566, -13.630233733540122, -15.66822713058459, -10.886934162335395, -7.467363387539047, -5.942288011357334, -9.309989385195992, -8.925178894818547, -17.894795243267495, -12.287025400795455, -6.872711286271889], "policy_policy_agent__reward": [5.603865871188059, 5.603865871188059, 23.487383217786242, 23.487383217786242, 2.1837907976584323, 2.1837907976584323, 1.832432783082605, 1.832432783082605, 9.559563351486407, 9.559563351486407, 4.715475639130451, 4.715475639130451, 6.662950815522625, 6.662950815522625, 13.5178096699492, 13.5178096699492, 9.761884371160093, 9.761884371160093, 9.620110764779835, 9.620110764779835, 2.2410083037742687, 2.2410083037742687, 5.886612263213588, 5.886612263213588, 4.851421353748924, 4.851421353748924, 4.7366886755452535, 4.7366886755452535, 4.7216982479596, 4.7216982479596, 5.359446540180152, 5.359446540180152, 4.811509171839579, 4.811509171839579, 3.42875512150767, 3.42875512150767, 2.0734235031620054, 2.0734235031620054, 3.0389595596067545, 3.0389595596067545, 8.204628216007995, 8.204628216007995, 6.450241527174167, 6.450241527174167, 3.2226922033729593, 3.2226922033729593, 3.7839474907980315, 3.7839474907980315, 9.391449248148826, 9.391449248148826, 7.011159255354637, 7.011159255354637, 4.788064732794598, 4.788064732794598, 10.31540090165701, 10.31540090165701, 9.97178960403701, 9.97178960403701, 2.2977094676963183, 2.2977094676963183, 2.005298544002566, 2.005298544002566, 4.234965820506487, 4.234965820506487, 3.5140738162448093, 3.5140738162448093, 9.156675411224798, 9.156675411224798, 2.6583004031395276, 2.6583004031395276, 2.692937283783033, 2.692937283783033, 4.1005600584455015, 4.1005600584455015, 4.958719486813614, 4.958719486813614, 1.6099962861200474, 1.6099962861200474, 2.890202715122124, 2.890202715122124, 6.957118657350936, 6.957118657350936, 7.400145396028592, 7.400145396028592, 10.061879959729477, 10.061879959729477, 4.852024267865565, 4.852024267865565, -0.058888160447369456, -0.058888160447369456, 8.99723800341761, 8.99723800341761, 6.074955570955113, 6.074955570955113, 2.384337475191489, 2.384337475191489, 5.845482644122342, 5.845482644122342, 3.081677177857329, 3.081677177857329, 3.053821338423311, 3.053821338423311, 5.09818287217143, 5.09818287217143, 6.774141078327142, 6.774141078327142, 1.3431950684031273, 1.3431950684031273, 8.460071789078313, 8.460071789078313, 3.46846044801601, 3.46846044801601, 6.8112335282391, 6.8112335282391, 6.907972345429234, 6.907972345429234, 3.01982475680279, 3.01982475680279, 11.5038245626242, 11.5038245626242, 10.65499551785798, 10.65499551785798, 5.27358893360021, 5.27358893360021, 1.9152848655547419, 1.9152848655547419, 3.997647977453007, 3.997647977453007, 5.019407080765961, 5.019407080765961, 5.8302128059874505, 5.8302128059874505, 1.5012535003339462, 1.5012535003339462, 3.50064452197228, 3.50064452197228, 10.464775017431034, 10.464775017431034, 12.55829018179429, 12.55829018179429, 5.1937472098586985, 5.1937472098586985, -0.35462410080503504, -0.35462410080503504, 6.4726146561055975, 6.4726146561055975, 2.6380566322364567, 2.6380566322364567, 6.775169254923364, 6.775169254923364, 9.391200946430418, 9.391200946430418, 3.9946462611095797, 3.9946462611095797, 6.245003653178013, 6.245003653178013, 12.307841444938687, 12.307841444938687, 4.435261147138339, 4.435261147138339, 12.388556954687063, 12.388556954687063, 2.3354249627073664, 2.3354249627073664, 6.724070910553708, 6.724070910553708, 6.078237799090391, 6.078237799090391, 5.579258585776225, 5.579258585776225, 7.348280924457664, 7.348280924457664, 5.589877970822105, 5.589877970822105, 10.204023220851319, 10.204023220851319, 9.07896461158876, 9.07896461158876, 5.146980775260503, 5.146980775260503, 4.681707948116244, 4.681707948116244, 3.5868201785860734, 3.5868201785860734, 3.114488818433855, 3.114488818433855, 13.207639678530944, 13.207639678530944, 4.242401992740997, 4.242401992740997, 10.22024806768562, 10.22024806768562, 4.9272112627295055, 4.9272112627295055, 5.6482686712107215, 5.6482686712107215, 8.603769617820058, 8.603769617820058, 9.856647915549905, 9.856647915549905, 4.97301302306813, 4.97301302306813, 10.489685447339566, 10.489685447339566, 6.196665316561288, 6.196665316561288, 1.754526513086386, 1.754526513086386, 10.08882814045781, 10.08882814045781, 3.4672485336624455, 3.4672485336624455, 2.7231876519395724, 2.7231876519395724, 8.257077772343136, 8.257077772343136, 11.886125141514034, 11.886125141514034, 6.027178543623219, 6.027178543623219, 3.4319179096507924, 3.4319179096507924, 0.4852407862366396, 0.4852407862366396, 12.402031350307078, 12.402031350307078, 5.570040381775937, 5.570040381775937, 4.200792885654236, 4.200792885654236, 6.502627508990517, 6.502627508990517, 5.068312932803107, 5.068312932803107, 4.10750925424783, 4.10750925424783, 4.280328261855809, 4.280328261855809, 6.867222802318537, 6.867222802318537, 3.075758888477194, 3.075758888477194, 10.431486252407074, 10.431486252407074, 9.329930056419308, 9.329930056419308, 8.11966684802224, 8.11966684802224, 8.506569513437842, 8.506569513437842, 4.324438069766589, 4.324438069766589, 5.472976504878677, 5.472976504878677, 6.818212024680955, 6.818212024680955, 5.180058492520887, 5.180058492520887, 0.3374692500375139, 0.3374692500375139, 6.4664007942091715, 6.4664007942091715, 4.691250708478503, 4.691250708478503, 12.963387144372538, 12.963387144372538, 3.5336746123793836, 3.5336746123793836, 4.557052731702555, 4.557052731702555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3430398762060476, "mean_inference_ms": 2.255586663164303, "mean_action_processing_ms": 0.09895620391920916, "mean_env_wait_ms": 0.5925241431403743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 222750, "timesteps_this_iter": 0, "agent_timesteps_total": 668250, "timers": {"sample_time_ms": 13277.65, "sample_throughput": 254.187, "load_time_ms": 0.401, "load_throughput": 8406541.956, "learn_time_ms": 2137.718, "learn_throughput": 1578.787, "update_time_ms": 27.43}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005000000000000001, "total_loss": 11.202918338775635, "policy_loss": -0.004504792229272425, "vf_loss": 11.215423965454102, "vf_explained_var": 0.07693597674369812, "kl": 0.0031381128243121114, "entropy": 0.8000876605510712, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.3538386404514313, "policy_loss": 0.005707360262749717, "vf_loss": 1.355153453350067, "vf_explained_var": 0.7355627477169037, "kl": 0.0071098916569028395, "entropy": 0.7033327877521515, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 222750, "num_agent_steps_sampled": 668250, "num_steps_trained": 222750, "num_agent_steps_trained": 668250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8910, "training_iteration": 66, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-02-24", "timestamp": 1706108544, "time_this_iter_s": 13.037982940673828, "time_total_s": 886.3741533756256, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6FA040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 886.3741533756256, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.48125, "ram_util_percent": 67.38750000000002, "gpu_util_percent0": 0.043750000000000004, "vram_util_percent0": 0.23455810546875}}
{"episode_reward_max": 18.35886391027503, "episode_reward_min": -18.2619931999113, "episode_reward_mean": -0.07281463555737835, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.19949386796989, "policy_agent_": -2.2364981141796476}, "policy_reward_max": {"policy_adversary_": -4.070866100082304, "policy_agent_": 23.022109352197898}, "policy_reward_mean": {"policy_adversary_": -12.173606718973083, "policy_agent_": 6.050396041707853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.901742162770767, 5.787246084698499, 1.9876282637157945, -14.13215109922386, 1.630025393328723, -4.775171514113818, 1.2516500992013295, 4.195028103661612, 1.3603638737897823, -14.438484110800932, 4.610797495634746, 1.6545095062353081, -5.900014517961931, 7.90181743646752, -3.0418552630536047, 0.7770991907063223, 1.7656565770114887, -8.352440425772203, 0.6030550773978707, -3.4065006066571164, 0.7519270210818099, 2.3647132920685676, 3.68565565308343, 3.746548322522509, -8.835737437454648, -0.4525806722642763, 12.388462193448252, -0.3231467984846088, -2.5677760149857733, 2.5518574632477065, 4.529743137768631, -1.0259859854740112, -9.34835304218391, 1.8370929895264696, -4.959164624226772, -6.693889864455885, 8.898623943179693, -3.210640482909534, -2.2669098485976917, 5.8318473288296815, 5.302121584245795, 2.390510769845542, -6.56376527065658, 1.6413677378252443, 3.039897433432646, 2.989974656836367, 1.8668656595185837, -7.581071966746538, -0.23584027121747925, 0.5237413214101688, 0.35439498502164357, -9.763519656117367, -5.955449995310118, 3.1187387746488975, -1.3452121644607358, 4.890167050804739, 0.8489801294624049, 8.184294538928425, -5.770325243462377, 8.427056676808359, -7.3512104374253795, 1.5185061026878675, 4.024781898960395, -8.706394325376072, -5.766457940205256, -1.3726868264842471, 1.350562952891706, 16.01877013694187, 3.2412244403920516, 1.945965766574111, 4.37358454429996, -6.566138784349171, 1.5412006825487143, 0.21548146928461767, -4.976036559878309, -2.1507014735361225, 7.984507490997525, 3.720435612649331, 1.2214403645388183, -0.2983544730872351, -10.938794166742593, 1.6132539299873139, 3.497158093296429, 4.155698683891791, -0.09624233084364009, -8.605247886552972, 7.724658047593611, -3.1119745030411656, -6.7945119914748915, 4.460432587344143, -8.782472157259946, 2.17603411602832, 0.6761652463149612, -0.6067470701154414, 3.7307636759448886, 8.153590304344515, 3.338035046462716, 0.6668675178150956, 16.18609890736583, -1.785236548909306, -5.014078397922158, 0.9032182014575649, 1.0355297440533204, 1.1946158177074724, 2.159802203822906, 3.1517651367584993, 0.3410350574773902, -2.475301492910403, -5.408726629758789, -13.845262620624327, 1.2324488101823932, 3.379654970085783, -18.2619931999113, -5.002845445886005, 5.064244324502064, 3.3662810446206333, -4.978001884915193, 1.162940253618174, -15.17488519801677, -1.005461190719912, -0.6634456221654477, 4.082076303097894, 1.6164734406683152, 2.2607488117229932, 18.35886391027503, -2.4768539897756225, -1.668496493505426, -5.031668972863511, -2.068961468497217, -8.732505433686871, -5.3127519710760405, 3.5784151501318613, -6.281971760475796, 10.662607431008492, 3.7512901658255164], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.963172202051286, -14.999216531401492, -6.7928773258396, -9.65915487086456, -10.200227973197931, -7.436547972548799, -8.189025502146647, -8.236286253802675, -20.58145119904005, -13.560243328685829, -8.897145172623606, -6.374098548088147, -10.18231144076176, -17.3553441100758, -13.52429038769101, -11.34980277248029, -15.164641474468555, -13.02393530644399, -6.983539175888625, -7.777567636685563, -6.4433719613940355, -12.406954780485004, -11.978244803787184, -11.079619862213251, -8.631188905446324, -21.280522456431004, -18.053434388446753, -6.996951547731094, -11.631911075700312, -11.150124648250662, -9.472756006067645, -8.335044299446823, -18.824278359260383, -9.832650126910858, -7.1912526040548, -11.104095394931205, -19.503416194552457, -11.206154499985312, -14.333136269226602, -14.62336242640391, -11.20059779435618, -8.823887907841293, -17.222880286790655, -16.280920987792243, -17.610578807216935, -13.40869323674545, -10.103350511031923, -21.000485234518962, -4.070866100082304, -8.472405097513768, -7.623022966506751, -16.988012511142507, -13.698927551815505, -12.81122154859101, -8.54554426016405, -10.10473534421573, -15.665621203895174, -28.19949386796989, -13.758420995233543, -19.480170392095054, -8.657621493040553, -10.072286792902958, -13.690889734131943, -8.838385546318634, -17.42478516918769, -9.869074330581567, -8.375055670286725, -20.01770619075397, -13.932760496608102, -11.592327655551664, -8.479805880520875, -15.825715191573027, -8.176135027773894, -6.579083213499169, -6.111904755919998, -6.429803478309756, -13.769694636644527, -10.213001874860602, -6.8742386564174165, -13.730365201839687, -15.834152971904146, -14.743301581126735, -14.17248107041986, -12.502334922796909, -11.444832794003919, -10.129528825784176, -16.40073068454439, -12.9256320863266, -11.332509255536738, -11.089724161130793, -5.006627130432389, -6.04151790499577, -12.77496619324336, -7.448492510369983, -6.980534306732894, -18.51911713431667, -13.499030063282095, -4.855275063579614, -23.136378614003675, -7.419416814653522, -11.444746692273164, -16.023652531740247, -10.51723339303638, -8.48485765602255, -17.4503388990846, -9.75510774522997, -8.912929620072132, -8.60911032218678, -6.483470508923864, -13.834123466513416, -11.781342131248387, -11.517819808860388, -22.890245439332876, -9.393904146060564, -12.634167003623414, -10.696717279161193, -7.957852586494408, -14.25833242965265, -12.190570080140574, -13.918222331370048, -4.511187699752489, -11.25575003346445, -12.142362697312478, -11.517142789049545, -27.685354794120773, -7.730750215365443, -9.834813213673394, -11.981892517253467, -14.950429363242009, -15.951600411487188, -15.143272967994486, -8.064353704546383, -13.33811631520104, -22.614997982634286, -16.64372679830346], "policy_policy_agent__reward": [12.432457182411024, 12.432457182411024, 10.393231308050005, 10.393231308050005, 4.390252794777696, 4.390252794777696, -2.2364981141796476, -2.2364981141796476, 5.915126683263328, 5.915126683263328, 1.3306882292174926, 1.3306882292174926, 4.720337800673988, 4.720337800673988, 6.215657178732143, 6.215657178732143, 10.970907536414913, 10.970907536414913, -0.43912039105755185, -0.43912039105755185, 6.753971334129177, 6.753971334129177, 4.014304027161726, 4.014304027161726, 2.1411484613999137, 2.1411484613999137, 12.62858077327166, 12.62858077327166, 5.2412175623187, 5.2412175623187, 6.0634509815933075, 6.0634509815933075, 8.465149025740022, 8.465149025740022, 2.335747440335889, 2.335747440335889, 3.793297126643248, 3.793297126643248, 2.185533515014223, 2.185533515014223, 3.5976494912379238, 3.5976494912379238, 7.385834036276784, 7.385834036276784, 7.831950228435305, 7.831950228435305, 7.41308409236788, 7.41308409236788, -0.10227426600416067, -0.10227426600416067, 10.413970892083366, 10.413970892083366, 15.220948290947506, 15.220948290947506, 3.3369023746232425, 3.3369023746232425, 4.532067530357269, 4.532067530357269, 6.850991055749182, 6.850991055749182, 7.001249571918139, 7.001249571918139, 3.654529156986406, 3.654529156986406, 4.737962658538236, 4.737962658538236, 5.834871558218662, 5.834871558218662, 1.1160439899140122, 1.1160439899140122, 2.20510276523766, 2.20510276523766, 14.201020068866073, 14.201020068866073, 3.9977570085378873, 3.9977570085378873, 6.033113210314454, 6.033113210314454, 10.227604877616795, 10.227604877616795, 8.251359689300989, 8.251359689300989, 5.607199338843417, 5.607199338843417, 5.329557508067039, 5.329557508067039, 8.961144362808746, 8.961144362808746, 10.325238120324794, 10.325238120324794, 8.199333946790908, 8.199333946790908, 5.9851080852752565, 5.9851080852752565, 6.709706633886216, 6.709706633886216, 1.917512914432412, 1.917512914432412, 4.4980732094619675, 4.4980732094619675, 3.988708975764197, 3.988708975764197, 3.6122464275125714, 3.6122464275125714, 3.8717387782526944, 3.8717387782526944, 7.964980161619953, 7.964980161619953, 3.6001660478516575, 3.6001660478516575, 7.497451197510232, 7.497451197510232, 8.257300666678791, 8.257300666678791, 18.191894203449156, 18.191894203449156, 3.994047875885582, 3.994047875885582, 13.953613534451707, 13.953613534451707, 0.6532055278075868, 0.6532055278075868, 5.7953964477954125, 5.7953964477954125, 8.857835816546165, 8.857835816546165, 0.06599561047128377, 0.06599561047128377, 5.829163614491217, 5.829163614491217, 4.24819375204866, 4.24819375204866, 4.862809311589216, 4.862809311589216, 18.01823816384793, 18.01823816384793, 8.586992468500076, 8.586992468500076, 6.769146711062889, 6.769146711062889, 6.426695212410417, 6.426695212410417, 4.629788203611926, 4.629788203611926, 4.858667855161305, 4.858667855161305, 3.397282341391891, 3.397282341391891, 0.5679340980208442, 0.5679340980208442, 2.1395510023868165, 2.1395510023868165, 10.877101063821026, 10.877101063821026, 6.966718743754965, 6.966718743754965, 4.047839510478118, 4.047839510478118, 6.716005364376224, 6.716005364376224, 2.4476794025807744, 2.4476794025807744, 8.178277755557025, 8.178277755557025, 8.834819581858143, 8.834819581858143, 8.329016803344352, 8.329016803344352, 5.67429523158014, 5.67429523158014, 0.7621404696156009, 0.7621404696156009, 12.062694366069001, 12.062694366069001, 4.906828791642718, 4.906828791642718, 2.2689986320309257, 2.2689986320309257, 7.7750783742374665, 7.7750783742374665, -1.8879225134137738, -1.8879225134137738, 4.108776010512044, 4.108776010512044, 6.725565719779161, 6.725565719779161, 3.4208727201272695, 3.4208727201272695, 5.3556489913388905, 5.3556489913388905, 13.33635371933059, 13.33635371933059, 8.418532554872407, 8.418532554872407, 2.7610712906973554, 2.7610712906973554, 19.66123876068475, 19.66123876068475, 2.8170901328721083, 2.8170901328721083, 3.2153341471755046, 3.2153341471755046, 8.463435366598905, 8.463435366598905, 5.776381568544849, 5.776381568544849, 4.839736736865011, 4.839736736865011, 9.805070551453754, 9.805070551453754, 6.453436440994236, 6.453436440994236, 4.626982338774762, 4.626982338774762, 3.0669044146381887, 3.0669044146381887, 0.5373719395825375, 0.5373719395825375, -0.005569577055452857, -0.005569577055452857, 6.506895470715389, 6.506895470715389, 7.448737389473082, 7.448737389473082, 2.314126119710777, 2.314126119710777, 2.19552935008728, 2.19552935008728, 8.849205664062735, 8.849205664062735, 7.031499161890912, 7.031499161890912, 1.4899253507896084, 1.4899253507896084, 7.710636341635413, 7.710636341635413, -1.492157558938103, -1.492157558938103, 6.456380570325068, 6.456380570325068, 1.92387103879352, 1.92387103879352, 7.668913168281171, 7.668913168281171, 6.8794180689904, 6.8794180689904, 6.88894580038627, 6.88894580038627, 23.022109352197898, 23.022109352197898, 2.626948112794912, 2.626948112794912, 4.083158360083983, 4.083158360083983, 3.4751117721949796, 3.4751117721949796, 6.440733947372392, 6.440733947372392, 3.6095474889001573, 3.6095474889001573, 4.915260498459223, 4.915260498459223, 5.821384427339123, 5.821384427339123, 3.528072277362627, 3.528072277362627, 16.638802706821387, 16.638802706821387, 10.197508482064483, 10.197508482064483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342731838855033, "mean_inference_ms": 2.252577432206685, "mean_action_processing_ms": 0.09881560254021285, "mean_env_wait_ms": 0.5919194691092642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 226125, "timesteps_this_iter": 0, "agent_timesteps_total": 678375, "timers": {"sample_time_ms": 13089.525, "sample_throughput": 257.84, "load_time_ms": 0.401, "load_throughput": 8408039.914, "learn_time_ms": 2131.866, "learn_throughput": 1583.12, "update_time_ms": 27.333}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005000000000000001, "total_loss": 14.222945022583009, "policy_loss": -0.00637509988155216, "vf_loss": 14.237216091156006, "vf_explained_var": -0.0018968522548675538, "kl": 0.004077634475765246, "entropy": 0.7895423352718354, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 2.301208198070526, "policy_loss": -0.010712142201373353, "vf_loss": 2.318773329257965, "vf_explained_var": 0.6120165646076202, "kl": 0.008252002383367119, "entropy": 0.6865868717432022, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 226125, "num_agent_steps_sampled": 678375, "num_steps_trained": 226125, "num_agent_steps_trained": 678375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9045, "training_iteration": 67, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-02-36", "timestamp": 1706108556, "time_this_iter_s": 12.345981121063232, "time_total_s": 898.7201344966888, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0691CC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 898.7201344966888, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.518749999999997, "ram_util_percent": 67.41874999999999, "gpu_util_percent0": 0.046875, "vram_util_percent0": 0.231048583984375}}
{"episode_reward_max": 15.88303730564953, "episode_reward_min": -13.74349999302338, "episode_reward_mean": 1.0617928934096705, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.693135654810206, "policy_agent_": -0.595508702054815}, "policy_reward_max": {"policy_adversary_": -4.519832508966954, "policy_agent_": 23.28808648022987}, "policy_reward_mean": {"policy_adversary_": -12.357079540738127, "policy_agent_": 6.7094362170738995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.319585024766013, 0.2874230867727402, 3.8627286957627884, 5.922807435173956, -3.7003241795887023, 0.06938686145201814, -2.959008339774857, 0.6647582168434858, 0.7987117376259034, 10.227663037473269, 15.88303730564953, -13.74349999302338, -3.4709927598058528, 0.5332947719754577, 1.3147213826615411, 0.8072822972170566, 4.761951218134966, -5.045406729043617, -6.979135931176302, 0.3620779904500121, 5.197205112030056, 0.6056356335736639, 3.5106203017237685, -0.3773337603562183, 9.038094745138515, 4.250827419263308, 6.455056387246307, 10.04973127502073, 0.5426189504820178, 4.5854791441405425, 3.8794283823336566, -4.279918950569508, 0.7927910875341933, -2.6807072177699554, 12.670692641806408, -3.7897651640911687, 2.5345209292347923, 1.4946971209226045, 4.4913730811286445, 3.776816707890719, -5.587224156795809, 3.8162574043874535, 4.076033194131895, 3.4267261056037204, -0.06254070246578425, -0.7351489595693441, 3.326160396886211, -12.236022014925027, -5.906223775550678, -3.1794212770993413, 2.237910773402846, 3.8299046447991456, 4.364421014711881, 0.5786736695686594, -5.482602306161851, 6.1406429006071415, -11.743219935134668, -0.7493519979722545, 0.7453463912049237, 9.149563588936688, 8.205402861094242, 3.3678687735842514, -2.952040104058213, 6.168707969979151, -3.4155909070532124, -4.997424380751601, -1.6597796769152349, -0.03137168701251572, 0.1326781195203371, -1.19409091520447, -6.509312596820437, -4.43488309152372, -7.6189248510088845, 5.282407527690021, 1.1991131352209046, 1.8741071540318597, 7.24418085075265, 2.7853115695667294, -2.9843180387927064, 0.306717247580281, 3.009280309138669, 3.0361163670269726, -0.3503345637138373, 0.7464051917772045, 6.008561298271393, 2.397087974848499, 1.7590188246824414, 6.382935360411642, 1.62630723903974, 3.677501354227128, 6.255989807096973, -0.28656344734598677, 2.3270961581231364, -2.9848243144698197, 4.0435370963343535, -0.8770864108281797, -0.9919820978746172, -0.23888386390693384, -3.35819624726674, -4.342653627435625, -6.128004010628375, 5.361067808732197, 8.428020598927379, -4.994975715168109, -2.7835956352097226, 4.644464561783263, -3.1776345960627794, -1.0918479559969532, 6.730723547958944, -2.071649446566512, 5.06780415015088, -1.030098203918474, 8.121458087673771, 0.11307224513171088, 6.890525864110521, -3.5548664030989245, 3.386015305471192, -0.3177055901205983, -3.9418599361456477, -6.149661724218564, 6.1026577308072625, 15.639928300178495, 0.8551104709277104, -0.8045334896461281, 6.2062846323272245, -6.782980135297279, 0.3803861101049744, 2.23781095564703, 3.8593749484602724, -1.6667995101079867, -4.8444158852819434, 1.469187337558069, -0.7160607704285522, 2.2667563838964604, -1.6448007044560469], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.978372896874895, -7.224579987320515, -10.409902434171704, -11.797759811279002, -10.441835516876926, -9.72678174505477, -8.89481924899758, -16.918281513089543, -18.055575401348957, -17.385026425098236, -30.693135654810206, -12.556410478916096, -7.782600876216243, -6.495148661484603, -13.946126979931348, -10.132274172889803, -25.501551157680627, -7.282145932501407, -17.622887320397705, -5.523074324542059, -13.22917951067348, -12.694647679717885, -10.869090504737011, -15.29131388556693, -21.559464611923964, -14.425262403521875, -18.60950920374549, -17.793129585770696, -17.288197314349706, -12.366361304181266, -9.397787957158513, -9.821837865634283, -9.448926028913835, -11.26911494222766, -16.277353862799462, -6.762999540361346, -9.820086865715425, -15.74047289453383, -10.50427583037924, -11.978985341959673, -10.203632146885449, -10.388598181099965, -18.419435829963472, -8.65173938366147, -18.725659602150383, -23.80537988973764, -11.450752151737552, -16.25793769336255, -15.760329416064044, -15.865810680856296, -10.708337645784441, -19.635772016371273, -10.7344471153387, -23.78209599018347, -7.835493716867424, -13.425578152105361, -24.781222081504588, -14.318751461749288, -8.54766476617913, -18.444005336341405, -23.453163137374744, -18.019706424468094, -6.261080553409816, -16.843634426925444, -14.925703305125152, -7.665725524659682, -12.263890601270417, -8.351749552611839, -4.519832508966954, -5.122843260103803, -8.32520832359504, -10.469950305148942, -19.045702473835732, -9.88949138530951, -9.716303210450983, -6.496742493775751, -11.631034924617964, -11.345729685430808, -11.290194763854814, -7.600504565575829, -15.214098877262456, -13.083691544449026, -14.046973777875449, -19.114596301097944, -11.293115127669854, -8.28629023434528, -18.532552899903255, -16.53955552135654, -7.542427106881931, -9.371418438950963, -11.161341758519784, -6.519805608907306, -10.860558855101491, -11.168467379348249, -9.16600176678568, -5.205472355071173, -8.377018394070268, -9.705972510609602, -7.592097248889228, -13.345231600166835, -4.936986606518741, -11.07317782548888, -14.123780510186446, -12.341137819132143, -6.466636268540342, -14.044908614949879, -9.787000077245663, -6.901591977173767, -15.002034582738462, -20.969096573796566, -10.104515764003969, -8.37894213018428, -14.78797976566638, -7.021445926729816, -12.862575885775973, -11.2241092994471, -14.320136787633288, -9.400280355145174, -8.560491112046984, -5.455972346095065, -16.32890605060466, -20.020196728983, -9.156900839853163, -8.263024965993743, -10.376575406820574, -19.604610770806996, -6.124541020827354, -8.578011526059072, -13.963370965628732, -4.81536910299875, -13.66247519945532, -17.362621932575053, -6.8587182684074435, -6.9180961787309805, -6.78570914833229], "policy_policy_agent__reward": [13.648978960820456, 13.648978960820456, 3.7560015370466293, 3.7560015370466293, 7.136315564967244, 7.136315564967244, 8.860283623226481, 8.860283623226481, 3.3707556686441134, 3.3707556686441134, 4.898084303253395, 4.898084303253395, 2.9679054546113597, 2.9679054546113597, 8.791519864966515, 8.791519864966515, 9.427143569487432, 9.427143569487432, 13.806344731285753, 13.806344731285753, 23.28808648022987, 23.28808648022987, -0.5935447570536396, -0.5935447570536396, 2.155804058205196, 2.155804058205196, 3.51422171673003, 3.51422171673003, 7.630424181296443, 7.630424181296443, 5.469778235053432, 5.469778235053432, 15.131751187907795, 15.131751187907795, 1.118369601728896, 1.118369601728896, 5.321875694610697, 5.321875694610697, 2.9425761574960347, 2.9425761574960347, 9.213192311351769, 9.213192311351769, 6.650141656645778, 6.650141656645778, 7.18985540323039, 7.18985540323039, 7.456990062605359, 7.456990062605359, 15.298779678531242, 15.298779678531242, 9.338044911392588, 9.338044911392588, 12.532282795495892, 12.532282795495892, 13.921430430395711, 13.921430430395711, 8.915408132415866, 8.915408132415866, 8.4759202241609, 8.4759202241609, 6.638608169746085, 6.638608169746085, 2.770959457532388, 2.770959457532388, 5.120858558224015, 5.120858558224015, 4.2942038622288505, 4.2942038622288505, 14.474023252302933, 14.474023252302933, 1.4866171881350883, 1.4866171881350883, 6.177303897475105, 6.177303897475105, 8.617585007728218, 8.617585007728218, 7.497824455753943, 7.497824455753943, 7.877901024925196, 7.877901024925196, 2.3082039950448197, 2.3082039950448197, 7.102427792743711, 7.102427792743711, 11.247734512047678, 11.247734512047678, 6.039232744632595, 6.039232744632595, 9.331559449842297, 9.331559449842297, 11.535115465084154, 11.535115465084154, 7.388456274311881, 7.388456274311881, 2.010957839218764, 2.010957839218764, 4.927052820256684, 4.927052820256684, 6.343194701878474, 6.343194701878474, 6.473124209593643, 6.473124209593643, 11.732838330585206, 11.732838330585206, 7.549434065025292, 7.549434065025292, 12.180384829876061, 12.180384829876061, 1.1764457053527853, 1.1764457053527853, 9.783110526356255, 9.783110526356255, 6.5190010731849615, 6.5190010731849615, 6.784699731888521, 6.784699731888521, 4.646505578692025, 4.646505578692025, 13.796784462639048, 13.796784462639048, 15.829282999234497, 15.829282999234497, 10.69378759902617, 10.69378759902617, 1.654520224675802, 1.654520224675802, 11.506171198452295, 11.506171198452295, 5.755056199035969, 5.755056199035969, 1.3341505719540412, 1.3341505719540412, 5.30205546217759, 5.30205546217759, 4.16018893279966, 4.16018893279966, 2.3262553142436455, 2.3262553142436455, 1.9643761724496671, 1.9643761724496671, 0.9079478633873025, 0.9079478633873025, 3.0175336068126084, 3.0175336068126084, 5.713388811413425, 5.713388811413425, 7.5859494564997645, 7.5859494564997645, 5.457708172835942, 5.457708172835942, 4.185424823903807, 4.185424823903807, 9.437607887685305, 9.437607887685305, 7.065520627498771, 7.065520627498771, 4.152938362531052, 4.152938362531052, 3.953610906578055, 3.953610906578055, 9.111689593200563, 9.111689593200563, 8.059903955738, 8.059903955738, 6.848319607080808, 6.848319607080808, 9.930500746437573, 9.930500746437573, 8.650838212970621, 8.650838212970621, 5.34168910459689, 5.34168910459689, 10.14578586229285, 10.14578586229285, 11.461245440884092, 11.461245440884092, 4.5843671729608335, 4.5843671729608335, 6.524459896589044, 6.524459896589044, 8.70866578280838, 8.70866578280838, 3.11662108078066, 3.11662108078066, 6.593827506612312, 6.593827506612312, 4.091821532439214, 4.091821532439214, 6.604769431560018, 6.604769431560018, 2.1641929721214956, 2.1641929721214956, 3.6925181480978235, 3.6925181480978235, 4.733544323351334, 4.733544323351334, 2.116950500811244, 2.116950500811244, 4.501288986365602, 4.501288986365602, -0.595508702054815, -0.595508702054815, 8.217122817110535, 8.217122817110535, 11.27590055455691, 11.27590055455691, 3.6730810519820185, 3.6730810519820185, 1.84152031666531, 1.84152031666531, 9.34468658836657, 9.34468658836657, 3.304682740591441, 3.304682740591441, 2.9048720105884067, 2.9048720105884067, 10.866379065348704, 10.866379065348704, 9.448723563615028, 9.448723563615028, 7.586159957077423, 7.586159957077423, 3.674421963132901, 3.674421963132901, 11.454718926670076, 11.454718926670076, 3.5672590859307634, 3.5672590859307634, 9.876550874943247, 9.876550874943247, 3.834621448174087, 3.834621448174087, 8.85307604655224, 8.85307604655224, 4.541287382512286, 4.541287382512286, 2.309315587950667, 2.309315587950667, -0.34684468906175125, -0.34684468906175125, 11.21578189070596, 11.21578189070596, 17.83006251458075, 17.83006251458075, 5.006005655390437, 5.006005655390437, 3.7292457381738098, 3.7292457381738098, 8.291430019573898, 8.291430019573898, 6.410815317754859, 6.410815317754859, 3.252463565466165, 3.252463565466165, 5.407911240853052, 5.407911240853052, 8.911372957044502, 8.911372957044502, 1.5742847964453819, 1.5742847964453819, 4.409029657086686, 4.409029657086686, 9.415904635066559, 9.415904635066559, 3.0713287489894463, 3.0713287489894463, 4.592426281313721, 4.592426281313721, 2.570454221938121, 2.570454221938121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342213887127728, "mean_inference_ms": 2.248535073809231, "mean_action_processing_ms": 0.09865332061360829, "mean_env_wait_ms": 0.5910588633001331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 229500, "timesteps_this_iter": 0, "agent_timesteps_total": 688500, "timers": {"sample_time_ms": 12888.576, "sample_throughput": 261.86, "load_time_ms": 0.401, "load_throughput": 8408039.914, "learn_time_ms": 2122.139, "learn_throughput": 1590.376, "update_time_ms": 27.636}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 14.757703018188476, "policy_loss": 0.003238871629582718, "vf_loss": 14.762332725524903, "vf_explained_var": 0.06141599416732788, "kl": 0.0061237939308087744, "entropy": 0.7869056046009064, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.8783049583435059, "policy_loss": -0.006143597699701786, "vf_loss": 1.8914375722408294, "vf_explained_var": 0.7067526578903198, "kl": 0.005435317100530445, "entropy": 0.6997427940368652, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 229500, "num_agent_steps_sampled": 688500, "num_steps_trained": 229500, "num_agent_steps_trained": 688500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9180, "training_iteration": 68, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-02-48", "timestamp": 1706108568, "time_this_iter_s": 11.932172775268555, "time_total_s": 910.6523072719574, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08D62CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 910.6523072719574, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 25.6375, "ram_util_percent": 66.90625, "gpu_util_percent0": 0.0725, "vram_util_percent0": 0.2266082763671875}}
{"episode_reward_max": 16.086860168811054, "episode_reward_min": -17.142540983539668, "episode_reward_mean": 1.1213836607868228, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.8322687997444, "policy_agent_": -2.5335775582509625}, "policy_reward_max": {"policy_adversary_": -4.113479614577427, "policy_agent_": 19.222691675706614}, "policy_reward_mean": {"policy_adversary_": -12.27794267751776, "policy_agent_": 6.6996631691522905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.30072833717582437, 9.975291402940032, 1.8281507607832337, -1.0969253086806456, 6.80564572583505, 8.968467261830249, -5.954150182205449, 0.6667927475019755, 2.594488685992777, 4.180632561662996, -3.690004922221567, 1.1026597160823162, -2.518857108556754, 6.740555750817059, -2.250716985207627, -1.186935942790588, 14.309598037502381, -3.079844399543104, 2.137720351243572, 3.8190758609982374, 3.247282729717666, 2.887076965023353, 12.063386015851174, -2.3137371837320324, 6.801386454338924, -5.210977604295199, 2.0879844043919116, -14.998373145786562, 1.572931694108884, -5.471280500176012, 0.15279315416862466, 1.234146703591096, 4.568490913008554, -1.718297732365257, 5.945610466391075, 2.8394645350718486, 3.630214749323997, -6.057538241853462, 7.706002032011506, -0.048529774235559486, -15.090837453989566, -1.647063637984514, -2.700955417927301, 0.8477070196755785, 12.179910520495282, -1.805509027743839, -0.24416470906529275, -3.5148408999561345, -0.3787561221075204, 14.558910814214894, -3.0745849215488112, 5.370296452484772, -8.400513780942847, -17.142540983539668, 5.655478950517377, 3.3463423885912142, 2.118548403955858, -3.806656894455494, 0.007365790027370478, -3.906827697097881, -2.2304113586375554, 8.999073620565445, 2.369508791499061, 1.5922081440143279, 3.5388963778291345, -5.604791383133025, 0.21095820698842774, 6.796934104836267, 0.24030888879025764, -4.623046577315723, 3.2044783489176405, -1.2940340790166853, -2.79632238793293, -4.808513884130887, 6.652841157638136, -0.27531774120866787, 4.56412094579338, -5.16595916958854, 1.5472067776274319, 1.7628637144831572, -14.49422254005262, 2.9816677105906755, 0.1768843215187433, 2.2545774467065476, 0.770043380397772, -0.038304644252871, 7.180997108321529, 2.9349527486400278, -5.600096110210293, 1.0777874382815493, 6.909710476079348, -6.114921067152552, 3.103718883565923, -0.06934062670145755, 1.1410707307737085, -4.839437732638708, -0.7272351991989245, 3.2639072452531908, 15.797432365908788, 9.052621810080717, 3.9356458853902048, 5.367608916781339, 1.3066185226580558, -7.849300320647355, 3.8976664192061965, 0.9381506321344564, 11.953986344711609, 0.26597660604717965, 3.348456506158282, 10.430921993182707, 1.289267293981291, -3.7630194917386124, 2.323167693397695, 2.106699447737958, -3.1683900858117533, 2.1280842280199033, 6.899602147908191, 0.6855814668620638, 3.2246350992429083, -6.0243772886546845, 2.741457522404553, -4.512237814177015, 8.736353412817197, 0.11598399871740794, -5.151274259867378, 3.9355903941132113, 16.086860168811054, -6.29730300945721, 1.3070633128837015, 1.5909410426150872, 5.065985298859731, 0.01703096032029411, 3.184321263116412, -3.35666630422119, 4.2411721794698725], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-9.7769020480305, -18.124291973206393, -12.734573109764646, -13.853844946248152, -15.162846194475414, -16.94821613591143, -4.113479614577427, -5.9422658085065985, -10.475704872850148, -10.922882562715447, -9.903037189622927, -9.075243244760276, -12.155834867913127, -13.640902818126651, -9.344591277028892, -7.877249630628154, -19.82470715310795, -10.436413903136167, -7.6462421673850915, -10.39533654155304, -9.702918773865203, -10.30700858030038, -19.826309120085885, -14.055970272262531, -16.428897975277668, -11.0814946732635, -12.511082913447812, -15.233851620434704, -13.041025022817392, -8.731450073078568, -13.854795031148852, -8.20046544348405, -14.838281196291595, -16.106887486336568, -9.004978959965708, -14.926739603728864, -12.322970313823207, -15.27213216608133, -16.172880186192724, -11.156141388133355, -10.023682337487639, -7.359143297793264, -21.697827511424837, -7.787276795634268, -19.065337936022885, -10.033780984530868, -7.952298300934546, -6.0745668695187405, -7.167760854171143, -19.725222970205326, -14.77055230152134, -14.529027712738314, -16.389382702548595, -15.394762168313141, -13.69760646138553, -11.095052854702315, -8.354763581834135, -13.450100573801056, -9.46149006091069, -15.491927623996762, -9.45080350263903, -15.289684221799154, -11.105150277717993, -10.462782370657274, -11.539513236460813, -10.26677809772209, -14.312918387183892, -12.732335728964317, -8.60867070011181, -6.229321385411742, -9.057710604654307, -11.035603557738467, -6.739653201213437, -14.125788049283484, -15.496236667826308, -7.287562981824995, -18.25831731039577, -22.186433947288513, -9.399355264533938, -17.24144493778144, -10.288286229926399, -13.919644004855755, -6.695806583188573, -16.395927739364737, -9.78554560260907, -8.302222593959339, -14.722978413487695, -8.377831900876991, -8.915026751235514, -8.495726091646102, -13.263773293673465, -7.56375019542358, -11.788264959777072, -7.658952261801803, -6.733544634824452, -11.794372843229624, -19.485238512149778, -17.237983358597663, -19.369724641645067, -21.22092823311348, -9.036872774322973, -10.983029121444313, -7.754105620326374, -10.091341721075095, -12.570082601300216, -12.785844177682357, -15.794520324506447, -12.435788083510328, -8.024834074553358, -20.022351282998347, -7.822857415784888, -15.404870338387987, -11.191138913513734, -6.196204326711325, -4.489326188138752, -9.2612807415544, -15.694978333953026, -13.796370857914464, -11.790902305971054, -14.195482968920858, -13.786824727901521, -12.60387088482213, -23.8322687997444, -9.220701970488976, -13.891377008071217, -10.20808137505794, -22.358523182602177, -6.549629179032537, -15.35339162312082, -12.862262267181153, -10.524961377005882, -16.25133339920599, -13.01884914127614, -11.50628824147196, -12.717712079705853], "policy_policy_agent__reward": [5.038815192603164, 5.038815192603164, 14.049791688073215, 14.049791688073215, 7.281361935273941, 7.281361935273941, 6.378459818783756, 6.378459818783756, 10.984245960155233, 10.984245960155233, 12.958341698870841, 12.958341698870841, -0.9203352838140126, -0.9203352838140126, 3.3045292780042876, 3.3045292780042876, 6.5350967794214645, 6.5350967794214645, 7.551757562189223, 7.551757562189223, 3.10651613370068, 3.10651613370068, 5.088951480421295, 5.088951480421295, 4.818488879678187, 4.818488879678187, 10.190729284471853, 10.190729284471853, 3.546937145910633, 3.546937145910633, 3.345156843918784, 3.345156843918784, 17.067152595305167, 17.067152595305167, 3.6782847517965322, 3.6782847517965322, 4.891981259314332, 4.891981259314332, 7.107206201275643, 7.107206201275643, 6.475100751791436, 6.475100751791436, 6.597042772661866, 6.597042772661866, 15.94484756796853, 15.94484756796853, 5.87111654426525, 5.87111654426525, 11.615142214808296, 11.615142214808296, 2.9352585344841495, 2.9352585344841495, 7.299533658919859, 7.299533658919859, 0.11773923732407283, 0.11773923732407283, 7.306978358463137, 7.306978358463137, 1.6300847864512773, 1.6300847864512773, 7.003794092658738, 7.003794092658738, 4.717306073537573, 4.717306073537573, 9.703386054650073, 9.703386054650073, 7.194294876985657, 7.194294876985657, 7.47529471317839, 7.47529471317839, 8.883102069400357, 8.883102069400357, 7.9765925315735995, 7.9765925315735995, 4.607296962113936, 4.607296962113936, 11.939441109102116, 11.939441109102116, 5.553805806948894, 5.553805806948894, -2.5335775582509625, -2.5335775582509625, 2.8560398299043754, 2.8560398299043754, 9.498436046748765, 9.498436046748765, 4.317491907654924, 4.317491907654924, 15.622624228259086, 15.622624228259086, 4.114135978393517, 4.114135978393517, 3.854066795934627, 3.854066795934627, 1.2798629847813032, 1.2798629847813032, 3.394502366031813, 3.394502366031813, 17.142066892210117, 17.142066892210117, 5.847983689986263, 5.847983689986263, 9.94966208261155, 9.94966208261155, 3.994434460802874, 3.994434460802874, -0.8738894076132617, -0.8738894076132617, 9.676542705951457, 9.676542705951457, 7.220697621646762, 7.220697621646762, 5.236655992894997, 5.236655992894997, 4.821721839672782, 4.821721839672782, 4.734427925469029, 4.734427925469029, 5.79254996344944, 5.79254996344944, 3.610196072000736, 3.610196072000736, 12.144378921182298, 12.144378921182298, 6.737329534608527, 6.737329534608527, 6.027495257335802, 6.027495257335802, 7.539204807144974, 7.539204807144974, 2.330993357294532, 2.330993357294532, 7.26193829708616, 7.26193829708616, 9.764634916900292, 9.764634916900292, 4.424489794451034, 4.424489794451034, 0.8031374040480093, 0.8031374040480093, 6.131094476785971, 6.131094476785971, 4.870784739360896, 4.870784739360896, 1.9716654066402524, 1.9716654066402524, 4.658637082576298, 4.658637082576298, 11.074538912732221, 11.074538912732221, 3.506122620308164, 3.506122620308164, 11.411219128094578, 11.411219128094578, 8.510237388849983, 8.510237388849983, 5.473281021080686, 5.473281021080686, 9.502154326132297, 9.502154326132297, -2.102968155063109, -2.102968155063109, 8.450655857723216, 8.450655857723216, 3.436345452353658, 3.436345452353658, 9.325252593035644, 9.325252593035644, 5.277794491503418, 5.277794491503418, 4.1319589748532355, 4.1319589748532355, 10.951987760904606, 10.951987760904606, 5.6563923247585075, 5.6563923247585075, 1.6574653205126113, 1.6574653205126113, 4.786756764963824, 4.786756764963824, 10.086741884876401, 10.086741884876401, 0.724414564135513, 0.724414564135513, 7.445991921671496, 7.445991921671496, 3.794805817550172, 3.794805817550172, 3.9373076827990787, 3.9373076827990787, 3.4774675552954597, 3.4774675552954597, 9.379001656475426, 9.379001656475426, 10.25094530192543, 10.25094530192543, 17.583578503776923, 17.583578503776923, 15.136775021597094, 15.136775021597094, 6.486259329856589, 6.486259329856589, 8.175319019112829, 8.175319019112829, 4.530362071492216, 4.530362071492216, 1.12102070021387, 1.12102070021387, 8.233874510253207, 8.233874510253207, 6.861997404908407, 6.861997404908407, 13.874253334609026, 13.874253334609026, 6.350882344778754, 6.350882344778754, 5.686645290355819, 5.686645290355819, 15.22663663809053, 15.22663663809053, 4.556062354883089, 4.556062354883089, 5.820925423324686, 5.820925423324686, 6.757153303455714, 6.757153303455714, 4.151451887224641, 4.151451887224641, 0.6604680511634996, 0.6604680511634996, 5.694682484787149, 5.694682484787149, 11.29729024093061, 11.29729024093061, 7.2409761623882645, 7.2409761623882645, 7.507768702606982, 7.507768702606982, 4.0855528401330865, 4.0855528401330865, 8.264141125153039, 8.264141125153039, 4.045816535322562, 4.045816535322562, 16.28431110628079, 16.28431110628079, 4.668342984603191, 4.668342984603191, 4.370051374101921, 4.370051374101921, 7.0718358845855755, 7.0718358845855755, 19.222691675706614, 19.222691675706614, 0.12616308478766064, 0.12616308478766064, 8.330227468002262, 8.330227468002262, 7.22660165489812, 7.22660165489812, 7.795473337932806, 7.795473337932806, 8.134182179763144, 8.134182179763144, 8.101585202196274, 8.101585202196274, 4.074810968625386, 4.074810968625386, 8.479442129587866, 8.479442129587866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34197742380715623, "mean_inference_ms": 2.24655002667312, "mean_action_processing_ms": 0.09858904728306572, "mean_env_wait_ms": 0.5905511075347426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 232875, "timesteps_this_iter": 0, "agent_timesteps_total": 698625, "timers": {"sample_time_ms": 12884.68, "sample_throughput": 261.939, "load_time_ms": 0.501, "load_throughput": 6735713.742, "learn_time_ms": 2127.299, "learn_throughput": 1586.519, "update_time_ms": 27.636}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.334156513214111, "policy_loss": -0.004305834870319813, "vf_loss": 13.346452999114991, "vf_explained_var": 0.023930436372756957, "kl": 0.0067697288881295725, "entropy": 0.7990416884422302, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 2.023270308971405, "policy_loss": -0.00851945923641324, "vf_loss": 2.038526213169098, "vf_explained_var": 0.6873238950967788, "kl": 0.006309471959927248, "entropy": 0.6746360540390015, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232875, "num_agent_steps_sampled": 698625, "num_steps_trained": 232875, "num_agent_steps_trained": 698625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9315, "training_iteration": 69, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-03-01", "timestamp": 1706108581, "time_this_iter_s": 12.661574602127075, "time_total_s": 923.3138818740845, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6FAB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 923.3138818740845, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.15, "ram_util_percent": 67.01875000000001, "gpu_util_percent0": 0.06875, "vram_util_percent0": 0.231842041015625}}
{"episode_reward_max": 13.930574230466835, "episode_reward_min": -13.491769629230275, "episode_reward_mean": 0.32304451840545256, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.44325717329082, "policy_agent_": -0.6417532640935744}, "policy_reward_max": {"policy_adversary_": -4.83307853659395, "policy_agent_": 17.77441772808556}, "policy_reward_mean": {"policy_adversary_": -11.81821082857528, "policy_agent_": 6.070627673490366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.681598451821512, 9.990562940466582, -1.7904538328918693, 0.7300716938719265, 5.96492975376642, 0.7795011215683644, 3.692321005901544, 8.277141675921447, -0.24590438183286875, 0.36013887401940914, 3.8820672701465377, -1.1464762366897974, 1.838080473933931, 0.48998016540051326, -0.767970630836236, -8.45013897258106, 12.511957193587302, 1.2118696403179552, -10.250547297639462, -6.769612843713715, 11.440531123046409, 3.3819903983950828, 3.415851620153199, 3.700023681900782, 2.530257945147542, 2.5665767813691733, -9.694742731308176, 5.5995058346196, -3.5413818566373454, -0.7787602142737577, 1.4027993782837238, -0.9110904510396631, 2.767161815167668, 0.11568279984763086, 0.45957557601447285, -3.4130077146737463, -4.532811591196425, -8.123889262937457, -7.226532082357165, 5.321031901918918, 1.5710835171004192, -4.720980709918756, 7.783587460044184, 13.207381422036917, 8.132381527139302, 0.33120933571897787, -1.347824356659788, 0.9396112329294535, -5.805960203720568, -4.291728920925031, -0.30916437551160625, -8.260958344546014, 1.1721837392384724, -2.2251407643923975, -0.8532200636146312, 0.42548536514398094, 1.9185930447598718, -3.9984384913882707, -9.336496269972493, 2.089759046726116, -11.019956460382204, -1.024819963585851, -7.164942073178131, 2.4957149172492943, -2.5510644598920797, 7.87165643543054, 4.658226615560574, 0.6289536137225331, 3.4335918962703724, -1.2312308541229662, -2.3368401070317475, -1.7529844843640945, 0.11774305327364279, 10.52045128982609, 1.478767360904736, -10.076204013895856, -0.31338732510596934, 2.9054534653041912, 0.29981754070805455, -2.1527394196695346, -6.018316331741304, -0.4751947371577546, 2.0620599608756667, 3.835940714238673, -4.043012007103368, -11.614651094363284, 4.256769532818929, 6.946765446967134, 0.8271715448818238, 3.135545671768604, 4.946570387997502, 3.699818556964205, -0.9196730627550901, -2.105120584772866, 1.9837303468011065, 9.332539461256271, 2.8317619512893533, 8.710407065925338, -0.34811400291342787, -10.609450166689538, -8.530426545320163, -0.7227372742505342, -1.1207187213087295, 3.775828763427133, -13.491769629230275, -0.20860188753949505, 1.2801076464791041, -4.7816003382927335, -1.5607547690293009, -1.7202956744061977, 2.5549034758378775, -6.354321396892194, 13.930574230466835, 0.632512047228455, 2.471415861602076, -0.054618797095038585, -0.4152498509267542, 9.098710979238493, 3.1669679711021703, -0.41491412307563735, 2.209888589284648, -0.22210883282539134, 3.0865997630732247, 1.7429597779699537, -2.1566591706758675, 4.274332651467801, 1.842937310514946, -4.168028746811428, -1.3689862914026056, -0.306632877427791, 10.835916556880417, 4.095791561363952, -1.536960377983257, -4.845897531768723, 5.845034651227526], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.704473211180772, -20.695853177977078, -8.340373640341031, -12.032146959115646, -10.94927326445945, -12.655972385910026, -14.098495243953304, -17.46605483184283, -8.156548355646104, -6.697723689139896, -10.330623874863102, -13.399006557286457, -6.364307902621276, -9.731739681682406, -6.935581665618823, -10.87734046749693, -19.275067643536868, -12.288204167147121, -12.433225699723302, -10.177105001419935, -18.805728464076388, -13.547021289611491, -9.912351856463216, -13.553745924877896, -9.564363424563584, -22.20628109372846, -9.976104312462269, -18.60768753935431, -7.263745727761231, -5.635910277498984, -8.297368047669229, -9.389903083880913, -9.052207599924687, -8.392220315663161, -10.125354057412704, -4.982000731025463, -6.072542811758962, -10.291872438579917, -10.428864212318416, -13.475143199713829, -11.956813365940326, -18.225559020770625, -12.369109726792718, -20.117139723676754, -17.1080613068036, -6.861109399524993, -19.42877713588509, -6.773416098666097, -11.434238949876226, -7.5942122141401, -9.080591329020303, -7.106617551028381, -7.532122334574083, -11.106532271571048, -7.536577859993714, -9.115176269210746, -14.05247692791484, -12.228449161827044, -8.268140787051863, -12.766346287287146, -9.736449932195065, -13.296070728083238, -10.483149886019348, -18.58316927079166, -6.727774294733204, -15.159054068775376, -15.028534302939708, -7.874629206124085, -7.102334033987751, -13.869885051424959, -6.363411602649505, -12.122501820865736, -9.442255393993044, -14.788368551662145, -12.883020943190715, -16.95287372775269, -20.262124636864183, -9.845169757587472, -10.970259691020841, -17.12735338294917, -16.28671060526668, -7.358110194825508, -25.715497119680375, -10.747934380084336, -8.942773668404532, -15.102213016028147, -13.894039215288089, -13.34509740992653, -20.26205226619702, -8.83582202400793, -14.971823155656388, -7.664366750529103, -9.640129138399475, -16.11807122873818, -10.82642813282155, -15.831926706221552, -6.116608749030379, -13.946642596595336, -9.102628526409356, -13.007369617660514, -14.38441348585737, -12.577419031766338, -6.389409148234739, -7.930452474690808, -26.44325717329082, -13.073331422262916, -8.677002833347702, -8.064484100499554, -17.642618836635506, -10.373571296918493, -19.349397745865854, -19.43983685713702, -21.618261225704302, -7.864951270235778, -6.138235358375404, -12.421836540649092, -5.9306806301730814, -13.273566586451182, -19.73167506509213, -5.98950908669753, -6.474608621369056, -6.085720063092519, -10.993193804023498, -7.838480145319628, -13.950581227364092, -9.807952942896184, -17.000736444935267, -10.11309028359174, -8.716416836027932, -7.809499763286229, -17.859992042719398, -8.111145754908659, -8.077612195539293, -4.83307853659395, -13.286806689865664], "policy_policy_agent__reward": [1.0114373796796297, 1.0114373796796297, 15.343208059221828, 15.343208059221828, 3.274959903724581, 3.274959903724581, 6.381109326493785, 6.381109326493785, 8.457101509112935, 8.457101509112935, 6.717736753739197, 6.717736753739197, 8.895408124927423, 8.895408124927423, 12.871598253882139, 12.871598253882139, 3.9553219869066183, 3.9553219869066183, 3.528931281579651, 3.528931281579651, 7.1063455725048215, 7.1063455725048215, 6.126265160298329, 6.126265160298329, 4.101194188277604, 4.101194188277604, 5.110859923541459, 5.110859923541459, 3.0838055173912946, 3.0838055173912946, 1.2136007474579336, 1.2136007474579336, 15.893512418562075, 15.893512418562075, 6.750036903732539, 6.750036903732539, 1.0913392010419183, 1.0913392010419183, 1.7037460788531087, 1.7037460788531087, 15.123129793561404, 15.123129793561404, 8.464505844003286, 8.464505844003286, 6.664101738308208, 6.664101738308208, 8.626884803389336, 8.626884803389336, 6.047310684855562, 6.047310684855562, 12.386428937548818, 12.386428937548818, 0.14068079057704855, 0.14068079057704855, 12.103596686986958, 12.103596686986958, 1.8611819355619428, 1.8611819355619428, 2.428575031612613, 2.428575031612613, 4.850083712976477, 4.850083712976477, 4.239406316420624, 4.239406316420624, 5.909684707546176, 5.909684707546176, 4.253951557755396, 4.253951557755396, 5.292464816713588, 5.292464816713588, 0.784496508175859, 0.784496508175859, 0.7698656102812679, 0.7698656102812679, 1.0839915878212338, 1.0839915878212338, 1.6011660649806285, 1.6011660649806285, 9.39808755081637, 9.39808755081637, 6.763948441520372, 6.763948441520372, 6.752289155425935, 6.752289155425935, 10.07634859341845, 10.07634859341845, 16.66226057285683, 16.66226057285683, 12.620221416971454, 12.620221416971454, 3.5961593676219863, 3.5961593676219863, 9.040476389612651, 9.040476389612651, 3.8565136657977743, 3.8565136657977743, 2.814139373077828, 2.814139373077828, 1.6512416466075337, 1.6512416466075337, 4.385713476754348, 4.385713476754348, -0.5771703967588165, -0.5771703967588165, 4.352153036906278, 4.352153036906278, 4.440695753589326, 4.440695753589326, 3.3416788981895422, 3.3416788981895422, 4.770330817177365, 4.770330817177365, 7.985534986337356, 7.985534986337356, 4.115005335219389, 4.115005335219389, -0.534177741460318, -0.534177741460318, 7.42805266700663, 7.42805266700663, -0.6417532640935744, -0.6417532640935744, 6.1356253822486915, 6.1356253822486915, 1.659103906420611, 1.659103906420611, 10.539442094020481, 10.539442094020481, 2.0883549174205633, 2.0883549174205633, 11.515355252102959, 11.515355252102959, 9.84338045925014, 9.84338045925014, 4.2517914099233085, 4.2517914099233085, 5.267962965129062, 5.267962965129062, 6.319327098650997, 6.319327098650997, 2.013285747808879, 2.013285747808879, 5.18475866825082, 5.18475866825082, 4.779999223633343, 4.779999223633343, 12.65440992074412, 12.65440992074412, 7.180894152047726, 7.180894152047726, 3.438334856928419, 3.438334856928419, 9.974368655879113, 9.974368655879113, 6.375311611445832, 6.375311611445832, 5.635038615864448, 5.635038615864448, 7.487306981639819, 7.487306981639819, 5.1341971367626895, 5.1341971367626895, 3.441457728833876, 3.441457728833876, 13.88877854027802, 13.88877854027802, 7.2919375471615036, 7.2919375471615036, 2.4498808306505824, 2.4498808306505824, 1.7437809608324288, 1.7437809608324288, 9.075404374053507, 9.075404374053507, 10.145931428446833, 10.145931428446833, 10.544611905539425, 10.544611905539425, 5.985683847888269, 5.985683847888269, 9.95919677182694, 9.95919677182694, 5.682092653746652, 5.682092653746652, 4.360228037822193, 4.360228037822193, 7.006475321982656, 7.006475321982656, 6.405079239811332, 6.405079239811332, 12.582233083738911, 12.582233083738911, 4.474185350159867, 4.474185350159867, 11.328524831260337, 11.328524831260337, 4.377257261747966, 4.377257261747966, 1.1989597254854862, 1.1989597254854862, 2.9269934702686045, 2.9269934702686045, 5.927340878757901, 5.927340878757901, 2.6343452134630043, 2.6343452134630043, 5.85314061905897, 5.85314061905897, 6.475743772030269, 6.475743772030269, 6.432364767361713, 6.432364767361713, 4.978555239913403, 4.978555239913403, 1.6414418811034102, 1.6414418811034102, 8.040932033803102, 8.040932033803102, 4.326637811256146, 4.326637811256146, 10.952150610851868, 10.952150610851868, 6.542757730122411, 6.542757730122411, 17.77441772808556, 17.77441772808556, 4.248731658732117, 4.248731658732117, 4.3048256099887405, 4.3048256099887405, 6.183608871777025, 6.183608871777025, 2.757715389623163, 2.757715389623163, 11.18613878284484, 11.18613878284484, 11.449321518097147, 11.449321518097147, 2.787297481810947, 2.787297481810947, 4.342248605326852, 4.342248605326852, 2.931805615133563, 2.931805615133563, 7.039896783548361, 7.039896783548361, 4.7907199616447915, 4.7907199616447915, 5.896961028344109, 5.896961028344109, 7.041142797181991, 7.041142797181991, 9.421836877725104, 9.421836877725104, 2.9725307683901563, 2.9725307683901563, 3.6737152723126605, 3.6737152723126605, 3.751433442929219, 3.751433442929219, 14.347954299799905, 14.347954299799905, 6.103468658136307, 6.103468658136307, 3.270325908778018, 3.270325908778018, -0.00640949758738546, -0.00640949758738546, 9.565920670546593, 9.565920670546593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3421921408912741, "mean_inference_ms": 2.248191577779834, "mean_action_processing_ms": 0.09864637912152527, "mean_env_wait_ms": 0.5907213604793988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 236250, "timesteps_this_iter": 0, "agent_timesteps_total": 708750, "timers": {"sample_time_ms": 12971.285, "sample_throughput": 260.19, "load_time_ms": 0.496, "load_throughput": 6809262.591, "learn_time_ms": 2121.495, "learn_throughput": 1590.859, "update_time_ms": 27.838}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.695123100280762, "policy_loss": 0.0018140652948204661, "vf_loss": 13.70099515914917, "vf_explained_var": 0.027587246894836426, "kl": 0.0029749412412875655, "entropy": 0.7685487747192383, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.6164965808391571, "policy_loss": -0.0057633819058537485, "vf_loss": 1.628976935148239, "vf_explained_var": 0.7155212849378586, "kl": 0.006071907965704037, "entropy": 0.6726478695869446, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236250, "num_agent_steps_sampled": 708750, "num_steps_trained": 236250, "num_agent_steps_trained": 708750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9450, "training_iteration": 70, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-03-14", "timestamp": 1706108594, "time_this_iter_s": 13.800926685333252, "time_total_s": 937.1148085594177, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 937.1148085594177, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.11764705882353, "ram_util_percent": 66.74705882352941, "gpu_util_percent0": 0.04, "vram_util_percent0": 0.2322064568014706}}
{"episode_reward_max": 19.025138554833646, "episode_reward_min": -13.070234004715095, "episode_reward_mean": 1.3657000445898917, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.12897927388468, "policy_agent_": -2.5550754807034015}, "policy_reward_max": {"policy_adversary_": -4.9008328485432004, "policy_agent_": 22.370364700084302}, "policy_reward_mean": {"policy_adversary_": -11.948850652083149, "policy_agent_": 6.65727534833652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.151556355023714, 9.932525312512348, 7.858389666826583, 6.559433963204032, 3.192797804185706, -1.5484523149274372, -2.7914284004791234, -5.373593949747411, 9.21725620467184, -0.29357797931981283, 0.1312456725178096, 3.170413484537975, 0.552554590027441, -4.189888895600656, -4.014857143338872, 3.3178552236384293, 2.7427330231891687, 3.1807586581815053, -3.5061151592070345, 1.2472057467663877, -2.3342849591560393, -3.8038034414823336, -5.615677266455045, 3.2064174223858446, 5.6339985857491, 1.8850919120048366, 5.461228349412547, 1.5919090598467018, 1.0630414749566295, 1.279772307106946, 6.180097315873878, -3.483083333054429, -1.4140018261452223, -6.026015445909826, 2.987868312003849, -2.6168213837743806, 0.46364036813003034, -9.752236347586043, 4.904822177986836, 1.4578767362177847, 1.2670918976843226, -3.993806673972241, 2.4033319020180084, -1.428682313121725, 4.345541898102747, -0.7607788207133745, 0.7329992098716168, -1.3747343441709676, 10.955752650487673, 1.7021133077473873, 0.7878671836735429, 15.838710265266407, 5.759365025924786, -0.12649507350775963, 7.46081598024577, -6.2160705117453645, 6.143822622217394, -5.350052145973867, 2.830444940370155, 5.447530758845816, -0.9158612374248657, 4.5185121965565855, -4.9686720013432355, -8.443871953906052, 2.8278219910163602, 0.8902354196877108, -2.924239718921871, -4.286494770092608, 1.4430331911935974, 6.496876799398417, 1.28736246765498, 1.9182048692489369, 19.025138554833646, -3.8671685324961715, 1.372903709360108, 5.63074648290253, -1.1170177489842108, -1.4747205536889643, -9.158538053476054, -5.08970585608926, -0.14545376353396347, -6.255881352464572, -5.054305713835527, 0.3422887777343694, 2.641383143366026, 2.8078104545451392, 5.612748271532696, 2.4101183117130436, 10.10165205159943, 4.027494174108631, 11.483752517822234, 2.1336789302737715, 5.12091139277385, 2.92664668411612, -1.099118053617438, -4.151421077309742, 2.427818792250103, 8.473058954176414, -0.2909926426574364, 0.9191265272603064, 13.158680349484577, 4.744493830440231, -2.687831763666, 5.289728658831705, -5.718305105614442, -13.070234004715095, 2.787268200982731, -1.4906384877064371, -1.039743179284268, -3.468866426874025, 5.6106873599205995, -0.6121976081078446, -4.453022462094343, 10.218749466437677, -4.956656575980477, -1.6402022940059555, 8.035533109230563, -2.023667707346733, 7.030503352262407, 1.0216202054256582, 4.51195583313196, 2.1783524468809796, 4.208804582132952, 9.291385255338382, 1.7058437556001989, 4.086926911800284, 0.717128020898356, 11.634389109103239, -3.007090701816777, 3.6984115494750385, -12.6187412201193, 0.019072774066981713, -1.0031865539715328, 9.554080820581598, 4.0289932436048685], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.2512190699331285, -14.610528911573033, -15.927946573572342, -15.08101511531217, -10.747096464836035, -6.404415637482168, -5.9797106827604365, -15.230508819765559, -17.80222565326257, -14.530474168058477, -8.323461197860022, -8.679952965889754, -7.74835168321347, -15.670258380835882, -7.133725645601305, -17.590652141856282, -9.587710122970412, -7.811163387488235, -9.966534973979636, -11.455237360499277, -6.563314474785178, -12.72536115762824, -7.0953700508405335, -9.444579298645225, -18.357761473298897, -21.15077886578912, -18.393677705857336, -30.12897927388468, -14.496504150061478, -4.9008328485432004, -11.153717466725189, -7.987083748014985, -14.440868252773763, -11.015923326461067, -9.166526455256058, -18.73464715539338, -7.898701949603434, -23.421138897190293, -11.691593867747235, -6.6143044444575025, -11.515477068448098, -10.96087630585782, -9.624184295631192, -5.87708144799254, -12.518650098416112, -6.943872251581166, -13.927533939883077, -9.683848859066293, -19.550531864618726, -5.6936073763779405, -8.82331696562592, -23.828219510051856, -9.550381595577107, -5.23955759575955, -13.514419138131462, -7.180399844281915, -11.744876590766943, -11.38984713392932, -9.80961936559775, -14.583774928016048, -5.424298088904441, -8.941404152996313, -9.39510156080888, -15.966416303821342, -10.849415156741697, -7.374428575935615, -8.212873554758565, -18.66018404349804, -10.753125227192761, -12.049519637032235, -17.657620119182933, -19.47045896660349, -25.71559084533496, -4.972551573941842, -6.163617332126159, -9.754037217688486, -13.120788845049375, -8.877050216647703, -14.553557781850362, -13.450208363925958, -16.80313293053093, -10.296247184901496, -5.729901857686635, -9.048236069812791, -14.930863567259413, -10.550561086255037, -11.671574244673659, -7.739100152524594, -15.360991413059537, -9.899807035925795, -21.349545160049114, -12.259421663435113, -16.15578008793697, -13.094216981333776, -6.544648142573826, -14.82546867650951, -9.026812923995923, -10.987898359489359, -10.127154528265482, -5.513007402376692, -20.474315072187927, -17.932545807836576, -7.068967960038805, -15.349499123461129, -7.603856032025459, -8.092268608429523, -9.1459864294655, -5.660036473063252, -10.970545567222366, -8.280045613430465, -13.413864640651944, -10.050045602933197, -16.58330632967624, -16.13730786341876, -23.401648932916622, -9.179596367587502, -11.162000094600462, -11.870942172178664, -16.420973645274298, -13.141011016817362, -12.90820633403953, -9.288122333538492, -10.982626021724629, -15.584687901725028, -9.927206673619764, -10.77295877321226, -7.755218695522972, -16.653188978550588, -18.817455586009267, -10.76080284961414, -7.5085902587124975, -9.84716925702922, -5.327439502434475, -18.619394589729275, -8.252459894592068], "policy_policy_agent__reward": [5.7013877124784225, 5.7013877124784225, 12.271527112042689, 12.271527112042689, 11.89316812019946, 11.89316812019946, 10.820224539258103, 10.820224539258103, 6.96994713451087, 6.96994713451087, 2.4279816612773653, 2.4279816612773653, 1.5941411411406554, 1.5941411411406554, 4.92845743500907, 4.92845743500907, 13.509740928967204, 13.509740928967204, 7.118448094369331, 7.118448094369331, 4.227353435188916, 4.227353435188916, 5.925183225213866, 5.925183225213866, 4.150453136620455, 4.150453136620455, 5.740184742617611, 5.740184742617611, 1.5594342511312156, 1.5594342511312156, 10.454253682747355, 10.454253682747355, 6.165221573079791, 6.165221573079791, 5.4959610228348685, 5.4959610228348685, 3.230209907386302, 3.230209907386302, 6.351221553632833, 6.351221553632833, 2.114514757814569, 2.114514757814569, 4.460778858072954, 4.460778858072954, 0.739846392192743, 0.739846392192743, 6.325498360515536, 6.325498360515536, 11.995880029524, 11.995880029524, 11.517935388896982, 11.517935388896982, 11.927453027634938, 11.927453027634938, 15.86044416686569, 15.86044416686569, 7.779772812509052, 7.779772812509052, 3.0903025778250734, 3.0903025778250734, 8.666907391299533, 8.666907391299533, 2.2520002074802763, 2.2520002074802763, 6.51343321331427, 6.51343321331427, 2.4949539402756193, 2.4949539402756193, 6.0771973836299535, 6.0771973836299535, 8.058912885809496, 8.058912885809496, 4.181171158866733, 4.181171158866733, 6.834451274802125, 6.834451274802125, 8.298208022867035, 8.298208022867035, 4.036090590337644, 4.036090590337644, 6.391284483066211, 6.391284483066211, 3.483534815942792, 3.483534815942792, 6.013758098824598, 6.013758098824598, 2.2241995674354085, 2.2241995674354085, 8.432095998259431, 8.432095998259431, 3.091546715433896, 3.091546715433896, 7.330266574877349, 7.330266574877349, 4.154557257447663, 4.154557257447663, 15.253142257553202, 15.253142257553202, 3.6978603420626626, 3.6978603420626626, 4.805592074649732, 4.805592074649732, 19.833464887659137, 19.833464887659137, 7.654873310750946, 7.654873310750946, 2.5565312611258952, 2.5565312611258952, 10.487617559188614, 10.487617559188614, 0.4821646662682765, 0.4821646662682765, 8.94434960649217, 8.94434960649217, 3.01989749397773, 3.01989749397773, 6.320032152983954, 6.320032152983954, 10.015652843430935, 10.015652843430935, 2.2542184257397873, 2.2542184257397873, 6.729958174776449, 6.729958174776449, 2.2132147797328248, 2.2132147797328248, 3.761272174957644, 3.761272174957644, 6.838618573879028, 6.838618573879028, 4.132331997811664, 4.132331997811664, 2.644316917918347, 2.644316917918347, 7.186844636702722, 7.186844636702722, 6.098079209193179, 6.098079209193179, 9.273198218215327, 9.273198218215327, 9.472491293418951, 9.472491293418951, 10.69433191792621, 10.69433191792621, 22.370364700084302, 22.370364700084302, 0.5526915207228353, 0.5526915207228353, 3.7682605207431346, 3.7682605207431346, 7.69239185029551, 7.69239185029551, 6.001885548032582, 6.001885548032582, 3.7011648314793684, 3.7011648314793684, 2.6975098641871504, 2.6975098641871504, 4.1802512539183505, 4.1802512539183505, 8.328839583498482, 8.328839583498482, 2.0201829162184612, 2.0201829162184612, 0.33779807192555433, 0.33779807192555433, 4.695262423773583, 4.695262423773583, 8.786123355312714, 8.786123355312714, 6.67918577040009, 6.67918577040009, 8.642161258103181, 8.642161258103181, 5.074609232118818, 5.074609232118818, 12.731321732329482, 12.731321732329482, 6.9636506050172144, 6.9636506050172144, 16.416648838935675, 16.416648838935675, 7.196550296854445, 7.196550296854445, 10.638345740355412, 10.638345740355412, 8.01043183272495, 8.01043183272495, 2.7227650444781935, 2.7227650444781935, 5.337023799599884, 5.337023799599884, 5.727315858123013, 5.727315858123013, 9.730478656832886, 9.730478656832886, 4.918080942804022, 4.918080942804022, 3.2160669648184985, 3.2160669648184985, 16.81649771083625, 16.81649771083625, 11.3385198191384, 11.3385198191384, 2.1905680981864024, 2.1905680981864024, 10.319613891146414, 10.319613891146414, 0.9427754632055083, 0.9427754632055083, -2.488982698142784, -2.488982698142784, 5.966627315224113, 5.966627315224113, 2.084698992678408, 2.084698992678408, 4.9654011939690506, 4.9654011939690506, 2.4055895932782203, 2.4055895932782203, 9.512276000286274, 9.512276000286274, 4.718923997412675, 4.718923997412675, 6.065141933790947, 6.065141933790947, 13.17802866492822, 13.17802866492822, 9.222496178468072, 9.222496178468072, 3.7696970367907734, 3.7696970367907734, 9.598766601915516, 9.598766601915516, 4.923637232415962, 4.923637232415962, 11.725738498768353, 11.725738498768353, 7.081315611121511, 7.081315611121511, 8.710081083585743, 8.710081083585743, 5.7332373902097356, 5.7332373902097356, 7.5957153019287915, 7.5957153019287915, 12.438036578531705, 12.438036578531705, 5.816525214609983, 5.816525214609983, 7.4299428425062715, 7.4299428425062715, 4.236173358210665, 4.236173358210665, 14.143789043826919, 14.143789043826919, 7.905182442096247, 7.905182442096247, 7.2296071995445885, 7.2296071995445885, -2.5550754807034015, -2.5550754807034015, 4.9331210155481005, 4.9331210155481005, 2.1621264742314716, 2.1621264742314716, 14.086737705155441, 14.086737705155441, 6.1407265690984705, 6.1407265690984705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34219649639218946, "mean_inference_ms": 2.249069406365859, "mean_action_processing_ms": 0.0986095667392789, "mean_env_wait_ms": 0.5910455406021055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 239625, "timesteps_this_iter": 0, "agent_timesteps_total": 718875, "timers": {"sample_time_ms": 13050.621, "sample_throughput": 258.608, "load_time_ms": 0.396, "load_throughput": 8525008.13, "learn_time_ms": 2124.999, "learn_throughput": 1588.236, "update_time_ms": 27.836}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.64432134628296, "policy_loss": -0.005662836879491806, "vf_loss": 13.657632637023926, "vf_explained_var": 0.07257775664329529, "kl": 0.009627059961489038, "entropy": 0.7648304641246796, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005000000000000001, "total_loss": 1.8657133460044861, "policy_loss": -0.004067022074013949, "vf_loss": 1.8766795814037323, "vf_explained_var": 0.7220863312482834, "kl": 0.0047502169894369, "entropy": 0.6906650960445404, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 239625, "num_agent_steps_sampled": 718875, "num_steps_trained": 239625, "num_agent_steps_trained": 718875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9585, "training_iteration": 71, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-03-28", "timestamp": 1706108608, "time_this_iter_s": 13.558773517608643, "time_total_s": 950.6735820770264, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0691CC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 950.6735820770264, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.74444444444444, "ram_util_percent": 67.10000000000001, "gpu_util_percent0": 0.05111111111111112, "vram_util_percent0": 0.2351616753472222}}
{"episode_reward_max": 10.852884638864058, "episode_reward_min": -15.919017838963956, "episode_reward_mean": -0.4537023306278985, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.353358560581082, "policy_agent_": -1.8835727531224384}, "policy_reward_max": {"policy_adversary_": -4.876820046965789, "policy_agent_": 15.913279944431956}, "policy_reward_mean": {"policy_adversary_": -11.668164123334344, "policy_agent_": 5.607230896353223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.121093723805855, -1.6857540533543882, -3.421813592328733, -0.47666662918878355, 4.315864479869409, 2.1066527264226873, 0.08861356035531422, -5.253635149006689, 1.8628281628792127, -0.5004566036003357, -2.3913888285853093, -2.486623046293163, 4.8179475130063105, 7.159274114946595, -6.751142273332293, 3.863581541964584, -0.8080400439695014, 4.2164250568913655, -2.694060513275687, -0.30883040509951765, 4.341933701859309, -3.4173406095298917, 5.066026974772953, 3.5970153168832164, -1.8978770591634664, -8.65467466167435, -4.1136777699004305, -2.931355797883351, -0.04741691853819947, 4.432489405370276, -4.856674683698085, -1.0286373185362148, -2.7429884213069107, -0.5209088698301376, -2.473196524956302, -3.741603457317381, -11.584328941511535, 7.779107400231943, -3.361496141322847, -6.185510445545778, 0.32387659540958713, -5.34371136298831, -0.3637569652272582, 4.61202821557736, -6.074779585713785, 4.8068208656378255, 1.2736588666601487, 3.309497044861408, 4.709849553996575, 2.117167138207343, -0.023509996842238395, -8.493053060082891, -0.2452512836333395, -2.798588052657325, -1.9044931674293997, -11.159133649256223, 0.0698090889644919, 9.20497297193213, -2.3209482565713038, -0.0656920237948923, 7.6351571842164265, -1.381226658229425, 4.307870317007748, 3.807172342989067, -13.588522769801871, 4.901817927732186, -2.2164983521288537, 3.489881427830204, 2.266992431790037, -4.4829824448150175, -2.4080495483041853, -8.891594758945644, 7.08475842016141, 2.1045971623864808, 7.7207837943091056, 1.5934976593937185, 2.010450648053683, 6.071850310042003, -7.389777702554625, 2.2112806706457007, 6.852418542304751, -2.2244558494869278, -0.10538286323449764, -5.173931299572936, 2.474881229325324, -15.919017838963956, -2.9632734459803527, -2.4747276501060824, 0.7015811575657337, 1.023049956924294, 6.95344173875954, -6.835865181821167, -5.018360680954359, 0.6469434111839032, 0.8961428423915034, 2.4089775347722306, 10.852884638864058, -2.2375332353105635, 1.268887324204016, 3.6130948117818584, -0.08101862820370986, -1.2135949908629227, -9.343674951496798, 0.012629383642961206, -2.7517072185615388, 1.2479162425035368, -1.5393561939136884, 3.4111742354445114, 7.01764619587178, 4.584549623016606, 8.609866801009034, -3.1523331013885674, 4.078612823500887, -7.13681462328362, -12.033387436054426, -11.356875931064216, -10.927484638596551, 7.498768669147748, -1.5587786886248873, 4.533338666178514, -7.835411629548323, 2.5724749744857593, 0.464618650005019, 2.6489239659502353, 5.980701934476498, 3.7053328683435507, 0.9862179910570857, 2.353176546182516, 4.556089843767049, 2.2695089872834355, -11.001575476176356, -4.799562171117903, -10.023270040271202, -0.5096376229001529, 1.0705766910593735], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-6.136484686410478, -12.17635875201806, -18.500069052435308, -11.917127698197529, -12.681023192028524, -9.39334072367216, -8.457349872302089, -15.4695918082241, -9.394517112040573, -10.06078138519764, -8.62940782795141, -6.09543164963595, -25.649453341608957, -13.995752677360453, -11.84850451427088, -8.932390928640176, -13.385604082720391, -13.195268471379647, -6.740122660467509, -4.876820046965789, -15.050505673972053, -8.102199908427329, -13.052879663730236, -12.189288081739083, -11.066046106435644, -16.977700950498622, -17.301481729074375, -12.107776665885822, -9.413026011705764, -12.973551128480182, -14.563007464543622, -5.067873510673385, -9.646820878143945, -9.531270973891555, -8.722235997333899, -6.397185176282829, -21.76414339374778, -11.954197431990098, -5.139795824616564, -8.809199900396044, -6.5615283413822905, -5.2667107590629945, -13.795509065509453, -20.340294603830095, -9.624379669564991, -19.098546848829514, -8.914305204525684, -14.733585551622827, -15.078568155454716, -9.777865825427948, -9.12474843847999, -4.887943967844825, -6.691141860034425, -18.705575120403633, -7.513509407844502, -14.224035978412122, -10.767361067199321, -16.960949755282282, -16.6402801426725, -7.72371892207639, -11.170813103224958, -7.907434914857436, -13.383951417801052, -16.26409248403322, -13.602014583382955, -9.883544852461574, -6.796428960791087, -9.430669305996409, -6.392416662067476, -7.214454222261037, -9.10964997662987, -9.294822733495508, -10.81691924884008, -9.969259476750855, -22.768941022732864, -5.915992474688317, -8.539348207232015, -12.506769774062148, -14.955019071186252, -16.872119937079876, -15.771395279114998, -20.694240510103842, -7.52251544808162, -18.60605213084754, -12.428445529960849, -14.090471044505316, -6.003372210849268, -9.42336721369453, -9.519401546416368, -8.486194593548175, -12.229541530071298, -13.669420012077056, -14.133065095303138, -9.87638534329095, -8.317616998496954, -11.245138420364505, -19.55411713438769, -7.663142810642731, -13.232657044621895, -12.841366428706024, -7.806018965119339, -17.426957554251764, -5.576529445251922, -9.229445713179722, -8.463471276125677, -9.876896363166487, -10.507733698702545, -11.13804689391055, -24.80891369299213, -15.665672987906117, -15.459954252161722, -6.377820153693418, -10.15121861888501, -7.231223802876858, -24.493359743705774, -13.76012007493642, -10.774157917254676, -13.776595020233996, -5.494628487700733, -15.005640648537767, -6.917121638551733, -7.569329229916407, -9.618039764275494, -11.350467540489127, -19.243756512054965, -6.99593743811679, -7.234841410206513, -10.450100916194142, -15.571802753709553, -10.441745689943712, -10.537316789771682, -15.55851835056305, -27.353358560581082, -5.894904548906963, -5.541795801045855], "policy_policy_agent__reward": [1.007695481302312, 1.007695481302312, 5.245302349331834, 5.245302349331834, 7.539127730053292, 7.539127730053292, 5.7202305345043705, 5.7202305345043705, 8.498443835948967, 8.498443835948967, 5.749996725047423, 5.749996725047423, 4.272981716328701, 4.272981716328701, 5.107978329608704, 5.107978329608704, 5.628672637459894, 5.628672637459894, 4.780162390798653, 4.780162390798653, 3.119009499683049, 3.119009499683049, 1.804404301671394, 1.804404301671394, 15.233700427307637, 15.233700427307637, 10.577513396153526, 10.577513396153526, 2.5486811204692903, 2.5486811204692903, 6.3979862353023815, 6.3979862353023815, 6.288782019375444, 6.288782019375444, 8.705846764135508, 8.705846764135508, 2.023031073595911, 2.023031073595911, 2.283994820933135, 2.283994820933135, 9.69621968791568, 9.69621968791568, 2.342429649448719, 2.342429649448719, 9.05945331925159, 9.05945331925159, 7.893151699311151, 7.893151699311151, 4.584084523636088, 4.584084523636088, 4.1615131444121385, 4.1615131444121385, 6.593901979586974, 6.593901979586974, 4.5882104340012395, 4.5882104340012395, 4.682804546583783, 4.682804546583783, 8.703020266925229, 8.703020266925229, 4.8531663904227695, 4.8531663904227695, 2.0196180960685854, 2.0196180960685854, 3.4519162284185185, 3.4519162284185185, 4.505181052030711, 4.505181052030711, 3.1245197361887973, 3.1245197361887973, 1.3277908594827226, 1.3277908594827226, 5.089907226118118, 5.089907226118118, 9.866652416111021, 9.866652416111021, 0.8891498416468588, 0.8891498416468588, 1.3118447274251341, 1.3118447274251341, 3.4427024683959386, 3.4427024683959386, -0.03850030196265711, -0.03850030196265711, 6.715876050141095, 6.715876050141095, 12.476161409703733, 12.476161409703733, 1.7748000419256036, 1.7748000419256036, 11.952683857233673, 11.952683857233673, 5.093982035592917, 5.093982035592917, 9.021541298242118, 9.021541298242118, 9.894208854725647, 9.894208854725647, 5.947516481817644, 5.947516481817644, 4.550619220818876, 4.550619220818876, -1.8025545461190369, -1.8025545461190369, 3.222945288200543, 3.222945288200543, 7.953493533873154, 7.953493533873154, 2.8045081202075517, 2.8045081202075517, 1.5324511645779508, 1.5324511645779508, 5.418585078081906, 5.418585078081906, 13.082961363607208, 13.082961363607208, 7.159665943050599, 7.159665943050599, 3.8290134491407484, 3.8290134491407484, 9.402985143720697, 9.402985143720697, 3.263104128314006, 3.263104128314006, 8.8459108674044, 8.8459108674044, 10.035632413511143, 10.035632413511143, 0.006745906790541073, 0.006745906790541073, 7.392681390096877, 7.392681390096877, 2.2899653043311177, 2.2899653043311177, 6.460275366913306, 6.460275366913306, 4.329704546928756, 4.329704546928756, 1.365735888723011, 1.365735888723011, 3.3508002141628404, 3.3508002141628404, 0.20161398727493132, 0.20161398727493132, 8.950838834500741, 8.950838834500741, 6.036928319568667, 6.036928319568667, 15.244862408520987, 15.244862408520987, 3.7547450670410183, 3.7547450670410183, 5.27489942764285, 5.27489942764285, 9.289310042052078, 9.289310042052078, 3.782620684315812, 3.782620684315812, 9.54170030386279, 9.54170030386279, 11.311906910709867, 11.311906910709867, 9.234892330308458, 9.234892330308458, 3.7085662924235607, 3.7085662924235607, 6.7160604156373, 6.7160604156373, 7.451663379643086, 7.451663379643086, -0.9142733972293182, -0.9142733972293182, 1.5200493824344576, 1.5200493824344576, 3.4743197817942235, 3.4743197817942235, 5.110491351991051, 5.110491351991051, 4.754622275236235, 4.754622275236235, 9.591491634415416, 9.591491634415416, 3.4167774151279477, 3.4167774151279477, 4.55735220717439, 4.55735220717439, 5.261664377237428, 5.261664377237428, 4.606879920444229, 4.606879920444229, 6.8270579775683675, 6.8270579775683675, 15.203500886625871, 15.203500886625871, 2.7128047876660824, 2.7128047876660824, 7.250772184412956, 7.250772184412956, 8.22723062024394, 8.22723062024394, 3.8625001684578155, 3.8625001684578155, 8.106681281694419, 8.106681281694419, -1.8835727531224384, -1.8835727531224384, 4.6210375484113415, 4.6210375484113415, 2.855882028782068, 2.855882028782068, 5.562406302835013, 5.562406302835013, 4.484188752394429, 4.484188752394429, 7.274610564677533, 7.274610564677533, 15.913279944431956, 15.913279944431956, 10.125111305461365, 10.125111305461365, 12.034910526585376, 12.034910526585376, 1.612743526152425, 1.612743526152425, 7.114915721192946, 7.114915721192946, 0.047204589796618, 0.047204589796618, 6.2299861538256796, 6.2299861538256796, 1.2016220719360997, 1.2016220719360997, -0.07666336067093305, -0.07666336067093305, 10.63768184469087, 10.63768184469087, 1.9679248995379222, 1.9679248995379222, 9.769489657358141, 9.769489657358141, -0.45914499549829546, -0.45914499549829546, 5.070902102201085, 5.070902102201085, 5.041329207140257, 5.041329207140257, 6.999695753219681, 6.999695753219681, 12.612229223265725, 12.612229223265725, 5.350635153230171, 5.350635153230171, 4.110529700631799, 4.110529700631799, 6.40163873118833, 6.40163873118833, 10.063946298738296, 10.063946298738296, 6.355627338613573, 6.355627338613573, -0.23212934320233997, -0.23212934320233997, 5.379478089722573, 5.379478089722573, 8.665044260154932, 8.665044260154932, 2.6926334630034052, 2.6926334630034052, 3.306186246052614, 3.306186246052614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.341646113308431, "mean_inference_ms": 2.245218365128317, "mean_action_processing_ms": 0.09845914790818608, "mean_env_wait_ms": 0.5899988538336128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 243000, "timesteps_this_iter": 0, "agent_timesteps_total": 729000, "timers": {"sample_time_ms": 12911.647, "sample_throughput": 261.392, "load_time_ms": 0.498, "load_throughput": 6770830.822, "learn_time_ms": 2114.255, "learn_throughput": 1596.307, "update_time_ms": 27.733}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.083084774017333, "policy_loss": -0.007934948755428195, "vf_loss": 13.098294353485107, "vf_explained_var": 0.0351310670375824, "kl": 0.00330785573479738, "entropy": 0.727454936504364, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.3881231367588043, "policy_loss": -0.008869837340898811, "vf_loss": 1.4035663783550263, "vf_explained_var": 0.7311757683753968, "kl": 0.0064085978679071925, "entropy": 0.6578382581472397, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 243000, "num_agent_steps_sampled": 729000, "num_steps_trained": 243000, "num_agent_steps_trained": 729000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9720, "training_iteration": 72, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-03-40", "timestamp": 1706108620, "time_this_iter_s": 11.829861640930176, "time_total_s": 962.5034437179565, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 962.5034437179565, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.200000000000003, "ram_util_percent": 66.89333333333333, "gpu_util_percent0": 0.06666666666666667, "vram_util_percent0": 0.228271484375}}
{"episode_reward_max": 11.85859659372873, "episode_reward_min": -11.768886320851063, "episode_reward_mean": 0.25136247082536184, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.246494811929445, "policy_agent_": -1.758273906629841}, "policy_reward_max": {"policy_adversary_": -4.013930119017681, "policy_agent_": 16.743168572559995}, "policy_reward_mean": {"policy_adversary_": -12.289440795880296, "policy_agent_": 6.27040163335283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.342775543863338, 3.4192163197672754, 1.4581092208029534, 2.1284124637870483, 3.7648699732019977, 1.0098763327967664, -2.960947784986718, -0.18290050352857112, 8.115395779132522, 8.340169876350922, 8.230956206896654, 4.47931985596506, -1.980149267538596, -0.5808896763782084, 0.987977933026353, -0.5920010119521284, -4.381444239549736, -6.944099728587778, 3.95119768125374, 5.951771211794914, -1.5037774989506911, 2.7262133127090395, -11.768886320851063, -2.0669803595267497, 0.3766164711678817, 4.617965578184857, 3.539412022891681, -5.021312272866517, 9.603963731923978, 0.8463621631367505, 0.3457273901829793, -1.6926929969353814, 4.406072012951956, -1.0150400420150252, 1.478383102872419, 3.469938605823125, 5.104769882524917, -10.061484130408374, 5.893895106976677, -2.9023862683309725, 4.71842464486132, -5.874689939997681, -1.411872904070202, -3.0607437178553147, 2.203208266981334, -1.7833343525325334, -9.907669929149227, 5.146761583699906, -11.520372193118206, -5.369032095885312, 0.6680661122411009, -0.04847753143695949, -7.250401149828503, 1.9722438074154018, -3.7375064848581125, 2.1099320867315514, 2.24508507298606, 7.0582644790703775, -3.5762693882036998, -10.454066741082224, 4.562441634829908, 2.291798057391226, -9.737567744913258, 1.9994061441403619, -1.8031030326580293, 1.7936188010787335, 11.85859659372873, -9.082142702769605, 5.20262767245108, 3.80139011031242, -5.134430479499269, -3.3105307526479986, 7.028048591257843, -5.046007938391899, -6.553951755159166, 3.128253734969764, 6.1384168406451485, 8.258271678577502, 5.772101311197509, 5.464427459745397, 0.13440160474622231, 0.5076583738911498, 11.034577099077962, 1.1811854690629509, 3.7008323231664155, -5.71341154092195, 2.653745014448625, 4.42038758349271, -8.456428348071437, -0.30321715282095374, 10.432465171472398, -1.9686624468764475, 2.872352899179637, 0.3667493023303921, -4.903764186316061, 4.4992887702715745, -1.9237783806079076, 1.2310944295437505, -4.206933616104411, 5.287317011275461, 2.314924993392671, 0.9331532542987389, -0.4899296589924951, 0.732277740102256, -3.7071458327338895, 1.0703693126472775, 3.7348193309284237, -0.8748358521251143, -0.2628210303427725, 0.28472787363354013, -4.861068194975658, 7.841520483736179, 1.642169373733692, -5.06262256996704, 1.2550896743677447, 2.0494348721175237, -1.8361951378886343, 0.1236259272212486, 4.75421372409614, 1.4697155873533423, -6.459135219577528, -3.08832697328761, -2.9228722804371285, -2.0896664743953317, -6.440161288017582, -3.84600166496891, -1.9562093075946194, -4.881299129420105, -2.8091717180965823, -0.21736285090918042, 6.823401440107451, -1.9313905487700773, 2.1600719566986966, 3.3751830018839932, -0.7484470727429966], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.385998314566635, -15.292841214483964, -15.050141780682358, -21.800784662214706, -10.611510503281007, -11.618344464521538, -12.299114896817747, -10.066750573210282, -11.714647923062142, -16.24405384451721, -17.564201384903928, -14.359442799496739, -9.846815655583566, -12.196482258845853, -10.6249083256641, -4.106849164827475, -8.85564374496357, -8.5783852230005, -10.853591953274549, -12.70241693619619, -6.547546816773071, -11.474787563619216, -9.903270169523465, -8.022029965428104, -18.28190484355048, -10.952153204413703, -9.391350986665962, -13.767769927217687, -19.74705741569125, -10.124591836485624, -12.574522469863084, -9.506783416308304, -11.25154043684354, -16.335803269087705, -8.690248733265904, -9.947110701378202, -13.512026594009805, -11.362312174573145, -12.66758088656067, -8.92155994355873, -16.250684869547314, -12.826853041263565, -9.008274553919355, -5.708198344943256, -11.986899745623186, -8.796947585650235, -14.803935641587115, -13.521502129043617, -21.400920375384676, -4.489986378831008, -9.75787307525314, -17.897207745288174, -16.401748818073973, -10.377878240278205, -16.80174547233538, -10.858899698599076, -14.665807380759837, -12.484649908661748, -17.475014494618712, -6.937518927822543, -16.370699770773488, -11.248317632416676, -13.893348558298795, -8.950441284895144, -6.3048280346396215, -11.812709681249464, -21.627740551391266, -18.004491341989482, -14.964032033220537, -13.008554754704567, -10.429397379355844, -6.730607586602761, -11.961658092757514, -11.782075304761143, -10.902075421854589, -10.431761897515928, -18.74879495032103, -19.45201626423652, -19.576406546565615, -10.824073141578292, -10.849691986841755, -7.598387988188032, -15.970529086316494, -17.62473023369907, -10.031478802649335, -18.97573326822055, -9.16704382551905, -12.739620068605424, -14.256049073631331, -4.946460010530596, -18.012458818918198, -7.065267712111736, -7.069567667670164, -10.18102745945943, -7.509682937276561, -13.570342523464147, -10.554294186194186, -9.816672322633035, -10.945640543031223, -18.88598411906833, -15.964831318126846, -16.665672412580275, -4.013930119017681, -9.462928359464694, -12.600816165573983, -23.246494811929445, -10.061537607835447, -5.9053254699980915, -6.868914306069382, -17.97772123602476, -13.787002671367977, -22.87688436818344, -6.705685276401521, -14.385124103893812, -11.937035652971314, -7.96154544956502, -8.66640543069448, -11.187033917005783, -11.765481034348483, -7.959834618054099, -9.112697592597595, -7.019768191023803, -15.109327672360948, -7.930709553706451, -15.795700191140321, -9.13495727188404, -13.983172460703875, -21.49775531284275, -18.170800357898287, -14.234820036298379, -12.407700040978499, -11.583225354280348, -10.391296814186532, -9.441257148027749, -6.258998847231281], "policy_policy_agent__reward": [6.021611385351648, 6.021611385351648, 9.35602876712562, 9.35602876712562, 8.254125500742656, 8.254125500742656, 11.964598563000875, 11.964598563000875, 7.188190238241501, 7.188190238241501, 6.314110398659153, 6.314110398659153, 4.6690835559155115, 4.6690835559155115, 4.941925034840852, 4.941925034840852, 9.91502185109733, 9.91502185109733, 12.292111860434067, 12.292111860434067, 12.897578795900293, 12.897578795900293, 9.4193813277309, 9.4193813277309, 3.9333331940224854, 3.9333331940224854, 5.8077962912338235, 5.8077962912338235, 5.806443129345226, 5.806443129345226, 1.757424076437673, 1.757424076437673, 2.23709975270692, 2.23709975270692, 0.8171427472063599, 0.8171427472063599, 7.402394817264144, 7.402394817264144, 9.327094073995552, 9.327094073995552, 2.5218846589111896, 2.5218846589111896, 7.10050043816413, 7.10050043816413, -0.9328080756637971, -0.9328080756637971, 2.977524802950677, 2.977524802950677, 9.329260657359178, 9.329260657359178, 7.785059391299276, 7.785059391299276, 6.4653815047788195, 6.4653815047788195, 4.373228827175587, 4.373228827175587, 14.675510573807617, 14.675510573807617, 5.485476999811187, 5.485476999811187, 6.460124930023035, 6.460124930023035, 3.9070452096864607, 3.9070452096864607, 7.828806224897748, 7.828806224897748, 7.660381613536338, 7.660381613536338, 5.0843159180691595, 5.0843159180691595, 6.708524653600664, 6.708524653600664, 9.308398238267364, 9.308398238267364, 0.6504140220823852, 0.6504140220823852, 9.28073799676868, 9.28073799676868, 3.0095868376138792, 3.0095868376138792, 10.484554757204316, 10.484554757204316, 3.476081550632946, 3.476081550632946, 3.7982008249245767, 3.7982008249245767, 1.3237273135439718, 1.3237273135439718, 7.095054006302263, 7.095054006302263, 3.5068066165588516, 3.5068066165588516, 2.448132856218945, 2.448132856218945, 9.33413185637176, 9.33413185637176, 4.94027409113323, 4.94027409113323, -0.43952285852715, -0.43952285852715, 5.212969593747121, 5.212969593747121, 8.92436510692561, 8.92436510692561, 4.575673834122739, 4.575673834122739, 6.175061023846806, 6.175061023846806, 6.532119493738634, 6.532119493738634, 6.484415892665314, 6.484415892665314, 8.455446226872947, 8.455446226872947, 9.77145719386606, 9.77145719386606, 6.949372553207508, 6.949372553207508, -1.758273906629841, -1.758273906629841, 10.4665707028017, 10.4665707028017, 6.7700578449039535, 6.7700578449039535, 2.0778904066927675, 2.0778904066927675, 5.474923714517753, 5.474923714517753, 2.250862500990796, 2.250862500990796, 6.803164241164101, 6.803164241164101, 16.743168572559995, 16.743168572559995, 4.461174319609943, 4.461174319609943, 10.08332985283581, 10.08332985283581, 8.40497243250849, 8.40497243250849, 2.6474834499282887, 2.6474834499282887, 1.7100384169773808, 1.7100384169773808, 9.49485334200768, 9.49485334200768, 3.368033683184621, 3.368033683184621, 2.1740618333477104, 2.1740618333477104, 6.780007816242847, 6.780007816242847, 12.443605895483085, 12.443605895483085, 13.855143971407015, 13.855143971407015, 12.674253928881562, 12.674253928881562, 8.144250300661842, 8.144250300661842, 5.492046795793989, 5.492046795793989, 4.05302318103959, 4.05302318103959, 13.50255309269723, 13.50255309269723, 9.402957851381013, 9.402957851381013, 6.866155562907876, 6.866155562907876, 6.6311608636493, 6.6311608636493, 5.910394419983841, 5.910394419983841, 8.580003826049067, 8.580003826049067, 2.8998103627799487, 2.8998103627799487, 2.3216214288548214, 2.3216214288548214, 14.2224619951953, 14.2224619951953, 2.548302632617643, 2.548302632617643, 4.9709602834249, 4.9709602834249, 5.2738883808949115, 5.2738883808949115, 1.3029593754802513, 1.3029593754802513, 9.034815646867859, 9.034815646867859, 4.3152579027931415, 4.3152579027931415, 5.523883376088394, 5.523883376088394, 3.369353463463404, 3.369353463463404, 12.086650565171897, 12.086650565171897, 9.139878155759758, 9.139878155759758, 8.799412833439503, 8.799412833439503, 1.7620002300125932, 1.7620002300125932, 5.0976030497834754, 5.0976030497834754, 4.446835166420046, 4.446835166420046, 12.15843206228836, 12.15843206228836, 6.898178469381936, 6.898178469381936, 2.5152448089364885, 2.5152448089364885, 3.3030466378633037, 3.3030466378633037, 9.131224554829146, 9.131224554829146, 4.462967238196158, 4.462967238196158, 15.359202425959804, 15.359202425959804, 4.173927325067607, 4.173927325067607, 4.661250766963387, 4.661250766963387, 6.596062663669529, 6.596062663669529, 5.005490160841271, 5.005490160841271, 3.415105146402924, 3.415105146402924, 5.655329922113516, 5.655329922113516, 8.25984737922231, 8.25984737922231, 4.714775102703722, 4.714775102703722, 1.3267811865100327, 1.3267811865100327, 1.9657206088680979, 1.9657206088680979, 6.09322769596191, 6.09322769596191, 2.920521539655558, 2.920521539655558, 4.677769451561368, 4.677769451561368, 2.6444778034575642, 2.6444778034575642, 6.013481576554629, 6.013481576554629, 8.30822809171132, 8.30822809171132, 7.680814319900856, 7.680814319900856, 7.0087285926946015, 7.0087285926946015, 9.615550740542973, 9.615550740542973, 4.825917402755136, 4.825917402755136, 6.275684385442613, 6.275684385442613, 6.408220074955871, 6.408220074955871, 2.755275887244143, 2.755275887244143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3409003257689535, "mean_inference_ms": 2.2416240033394903, "mean_action_processing_ms": 0.0983076545664053, "mean_env_wait_ms": 0.589242064106719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 246375, "timesteps_this_iter": 0, "agent_timesteps_total": 739125, "timers": {"sample_time_ms": 12849.013, "sample_throughput": 262.666, "load_time_ms": 0.399, "load_throughput": 8461312.612, "learn_time_ms": 2116.288, "learn_throughput": 1594.773, "update_time_ms": 27.836}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.099351596832275, "policy_loss": 0.0027397581638069824, "vf_loss": 13.103611373901368, "vf_explained_var": 0.07358388900756836, "kl": 0.0017208484525253142, "entropy": 0.6999745070934296, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.4786510288715362, "policy_loss": 0.0034284689878404605, "vf_loss": 1.4816769659519196, "vf_explained_var": 0.7353905826807022, "kl": 0.006135130087256427, "entropy": 0.6459175765514373, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 246375, "num_agent_steps_sampled": 739125, "num_steps_trained": 246375, "num_agent_steps_trained": 739125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9855, "training_iteration": 73, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-03-52", "timestamp": 1706108632, "time_this_iter_s": 11.983145475387573, "time_total_s": 974.4865891933441, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 974.4865891933441, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.500000000000004, "ram_util_percent": 66.80000000000001, "gpu_util_percent0": 0.10666666666666667, "vram_util_percent0": 0.22652994791666667}}
{"episode_reward_max": 14.979572145943164, "episode_reward_min": -14.654581343986912, "episode_reward_mean": 0.49313240644678835, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.88441937116655, "policy_agent_": -2.2070744835834613}, "policy_reward_max": {"policy_adversary_": -4.067691670544622, "policy_agent_": 19.431995758554848}, "policy_reward_mean": {"policy_adversary_": -11.9917775949798, "policy_agent_": 6.242455000713293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.768135348513632, -1.0216865326802278, 3.3127784069695343, 5.033618600477511, 3.492587395703437, 3.1987107737903613, -2.92300962541516, 0.41793663366233474, -3.013362665387302, -3.3706730440124018, 1.7375859751942349, 1.3280508440438523, 2.3178372038806727, 0.6211468572226244, 4.053637874673537, -4.0822149632350015, -7.003519968377794, -11.538803086993273, 3.2117480302535037, 7.551441265444442, -2.144585131815186, 1.2613439911084958, 3.1151494057432227, 0.4681629940952373, 2.0910009175948616, -0.8859990415168062, -2.4199925827636255, 2.9245621838318265, -3.245906537558049, 6.8377447852585, 2.0543606899835933, 0.6609871030074238, -4.303095290979753, -5.837047445669181, -6.094376151825395, -0.07366809178325939, 5.066195887480972, -1.4858285286676354, -4.7492321083523565, 2.6784866473574462, -0.7154540338871312, -1.507649141756479, 1.9463675218392762, -1.7447219583994016, -1.6742025972065617, 1.6450427879589995, 2.705886691235193, -5.343218253364743, -9.174402747060054, 0.23112159793769013, 9.49602828298675, -0.25999290218405463, -3.5747288789318965, 1.4704435594295584, 0.4563940431396654, 3.5978948959948642, -2.857851910152392, -1.0307293732123846, 1.4073405064656646, 1.7460884529346161, 0.16326235380023715, 14.979572145943164, 0.6766359434314732, -6.727246864028958, 11.550555548588298, 3.0280426092452393, 2.039154703687588, -7.073001025418754, 7.274343906009785, -1.2775217649436705, 1.3027976947299686, -6.516994790455811, -3.5394629800159083, 0.043003762093877726, 1.1103728282322984, 0.9403808476932947, 1.5380372584863173, -9.352597954050573, 1.8971086392941088, -3.272423334515861, 0.026087894643491594, -10.24678159774043, -2.6022057051814613, 1.8795530222207173, 7.263867511713636, -1.0304577656859888, 2.184674753761169, 3.5150508851907776, -0.8795031730177478, 10.33430989654251, -0.5091477006034547, 0.9685036784489989, 7.960496444517034, 3.1390546971496085, 0.5517630550052491, 14.83558449985664, 9.317893424488675, 6.794960695118421, -0.22888037031639227, 13.636056762052933, -1.3471903325427483, -1.9408058404336812, 8.321099430921896, -6.153981457198215, -14.654581343986912, -3.846771010923897, -4.020229978055975, 2.0607094248008613, -6.14328311759654, -0.10008400029048087, 5.529781981376692, -13.093891827758206, 1.9505715012894695, 4.23197540840756, 8.947370474692967, 6.949547173390157, 1.2468827478431213, 1.0791213463703895, 2.4932437792680227, -1.7845865527674643, 6.063693036143491, -9.249032926915907, -11.501632038785889, 2.111479241589215, 3.2138271639155, -7.3549865558111955, 8.890289483171241, 2.481654128112716, 6.049641920255883, 5.686256697542317, 4.699751351659241, 1.1571798293039484, -7.335614582325035, 1.0207552708279244, 2.926219743856703], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-4.464156363919866, -5.04786921003358, -9.811705019145455, -12.643730441460198, -12.18150403666621, -8.298859405773953, -15.492333724800918, -7.056080968499895, -13.037044013673711, -12.272746489201902, -15.810242684086376, -8.17269978873844, -6.362605786979515, -11.912960968364901, -9.439457775823929, -5.9086597017076015, -5.783053938543195, -11.432010275508267, -9.363949478839166, -17.126776353989104, -5.738111538113796, -15.4831793665899, -20.48242758735464, -7.690910691794087, -8.116289764924067, -11.461707327734976, -16.910830749685864, -13.674340582624593, -9.419163685032615, -13.006208557060003, -11.524902099063125, -7.524016086579246, -11.451047837389012, -13.881146815838168, -16.538101136575857, -14.084099150914707, -16.288273110857045, -15.828733051538185, -15.003181965822089, -10.261917944412577, -17.690725100544952, -13.860037832842426, -14.250355397368173, -5.061946141520037, -6.39254393671115, -6.986299386808893, -11.007457280552778, -15.150943593144405, -15.26297650981822, -13.342446448432476, -16.720758102485366, -10.654355946971075, -17.831809176222222, -5.151271107500578, -5.7026734902658704, -13.47273822926572, -7.635284699999515, -13.338029703376, -11.93067639245218, -15.268576705775757, -5.2740287634410965, -23.88441937116655, -10.162329225090604, -9.137032266706814, -16.96157405257236, -9.691733408471245, -7.008998130469424, -15.222907206850971, -13.43247531647762, -6.972515833019673, -14.628754321363974, -7.487155201248296, -7.530873548577044, -6.662235007997015, -8.953230336853718, -16.320555822822797, -18.22564669198634, -16.61439595452773, -9.735383125551378, -5.370605958244087, -13.196115146748914, -5.8326326305735, -9.837737316027532, -7.9138847438266415, -19.105239709911153, -6.712086146554702, -8.822333284645953, -15.389306545592525, -7.924664312039957, -17.06763600146523, -6.660888338361337, -13.714865525470179, -16.867019383042486, -12.644402884219824, -4.966696184801403, -22.604321665701892, -16.048222323361585, -15.180079174287213, -10.317304670567776, -19.332525244929066, -13.885557494326088, -8.552378661400082, -15.88134444948294, -19.185879356532556, -15.685122490411471, -4.181830353877483, -5.794819562385817, -13.978015759236799, -7.518984629415519, -14.381469657201876, -19.00610337961368, -20.756650739474104, -11.172234285030468, -20.341669092655295, -21.478119352400803, -14.04311398483033, -12.352898075854574, -15.49541556162184, -8.57682880677039, -11.979096578408166, -14.132881712725103, -14.571274837031059, -12.908670193384317, -18.310776236168795, -9.491436500863472, -7.45649188384279, -18.443322470650294, -12.217272590027768, -13.085195317814026, -11.749819729738325, -10.190675929385504, -4.067691670544622, -8.544889508377167, -8.18954931512657, -9.168743722376746], "policy_policy_agent__reward": [0.34801050770311726, 0.34801050770311726, 2.0130913386766767, 2.0130913386766767, 6.562241713057496, 6.562241713057496, 8.838674520968855, 8.838674520968855, 7.837045716184822, 7.837045716184822, 5.748785089782156, 5.748785089782156, 6.284662049692881, 6.284662049692881, 3.737008801081115, 3.737008801081115, 5.011840674143206, 5.011840674143206, 4.451036722594754, 4.451036722594754, 8.773914329640306, 8.773914329640306, 4.750375316391147, 4.750375316391147, 4.340221495430094, 4.340221495430094, 6.267053912793762, 6.267053912793762, 6.746547825248734, 6.746547825248734, 0.9132223692363, 0.9132223692363, -0.6102330149172981, -0.6102330149172981, -0.05339640574250226, -0.05339640574250226, 6.287848754546336, 6.287848754546336, 12.339108809716773, 12.339108809716773, 1.7967632031493044, 1.7967632031493044, 8.372261678849197, 8.372261678849197, 11.798788496548932, 11.798788496548932, 4.079536842944661, 4.079536842944661, 5.1036453412594645, 5.1036453412594645, 5.287854143109085, 5.287854143109085, 7.2454190834611225, 7.2454190834611225, 8.29945138322821, 8.29945138322821, 3.0866285737372827, 3.0866285737372827, 9.921976671159248, 9.921976671159248, 6.789631394523356, 6.789631394523356, 4.092501594793335, 4.092501594793335, 3.5739762732046305, 3.5739762732046305, 4.022049685084493, 4.022049685084493, 5.221862492375229, 5.221862492375229, 7.005215529565724, 7.005215529565724, 10.677234499169009, 10.677234499169009, 7.171452261435274, 7.171452261435274, 5.126974928734862, 5.126974928734862, 6.470202295885011, 6.470202295885011, 8.48763553332891, 8.48763553332891, 6.176194345542977, 6.176194345542977, 8.098361459603725, 8.098361459603725, 1.658612091560317, 1.658612091560317, 2.359170669752295, 2.359170669752295, 4.315671087383946, 4.315671087383946, 6.8566719858939855, 6.8566719858939855, 4.903862669889831, 4.903862669889831, 3.0442868813790813, 3.0442868813790813, 6.786784023185083, 6.786784023185083, 13.108393192736058, 13.108393192736058, 5.197181522393509, 5.197181522393509, 7.128540148645163, 7.128540148645163, 3.310857333465069, 3.310857333465069, 3.0795337667027685, 3.0795337667027685, 8.535316562630292, 8.535316562630292, 2.388716394923563, 2.388716394923563, 6.153650165081807, 6.153650165081807, 6.6690084494589215, 6.6690084494589215, 8.507332579355184, 8.507332579355184, 2.718645558620667, 2.718645558620667, 19.431995758554848, 19.431995758554848, 5.41948258426104, 5.41948258426104, 1.2048927013389283, 1.2048927013389283, 14.256064800580328, 14.256064800580328, 6.359888008858243, 6.359888008858243, 4.524076417078508, 4.524076417078508, 4.074953090716107, 4.074953090716107, 10.3534096112437, 10.3534096112437, 2.847497034038001, 2.847497034038001, 7.965776008046971, 7.965776008046971, 0.4850802053962423, 0.4850802053962423, 1.9957052842805694, 1.9957052842805694, 3.3526193850454455, 3.3526193850454455, 5.031801582543009, 5.031801582543009, 8.630468335258046, 8.630468335258046, 9.88184197523633, 9.88184197523633, 3.6308990002385793, 3.6308990002385793, 5.816245882422743, 5.816245882422743, 1.0490913118641128, 1.0490913118641128, 6.611101520696203, 6.611101520696203, -2.2070744835834613, -2.2070744835834613, 3.6177658054230353, 3.6177658054230353, 4.896718883023679, 4.896718883023679, 13.184553610812396, 13.184553610812396, 2.8408141904343562, 2.8408141904343562, 5.50350401920356, 5.50350401920356, 9.452178715391652, 9.452178715391652, 3.5225805695111037, 3.5225805695111037, 13.700972949003871, 13.700972949003871, 3.075870318878941, 3.075870318878941, 7.341684601959588, 7.341684601959588, 12.41375791377976, 12.41375791377976, 7.891728790684717, 7.891728790684717, 2.759229619903326, 2.759229619903326, 18.71995308277927, 18.71995308277927, 12.68305787392513, 12.68305787392513, 10.987519934702817, 10.987519934702817, 5.044212150125693, 5.044212150125693, 16.484291003491, 16.484291003491, 6.269183580891668, 6.269183580891668, 3.3057864104832, 3.3057864104832, 12.101221940202414, 12.101221940202414, 6.515948949667171, 6.515948949667171, 0.5152705732122764, 0.5152705732122764, 0.16752967147679443, 0.16752967147679443, 0.8872947921649202, 0.8872947921649202, 8.019362592018831, 8.019362592018831, 0.6878507559094893, 0.6878507559094893, 7.140692828455697, 7.140692828455697, 12.267942680495183, 12.267942680495183, 3.8313794558579524, 3.8313794558579524, 6.561402893159969, 6.561402893159969, 12.286822250531428, 12.286822250531428, 15.212744913546874, 15.212744913546874, 10.496330579110245, 10.496330579110245, 6.7998904118488435, 6.7998904118488435, 8.287268453996118, 8.287268453996118, 5.535036293019205, 5.535036293019205, 5.097255012820349, 5.097255012820349, 10.098287374434298, 10.098287374434298, 2.6611209550575787, 2.6611209550575787, 0.7035190772992113, 0.7035190772992113, 10.211127738879009, 10.211127738879009, 6.352631832389483, 6.352631832389483, 0.05075266401579212, 0.05075266401579212, 13.666805976910767, 13.666805976910767, 7.349463359070244, 7.349463359070244, 9.567418619034955, 9.567418619034955, 8.718038213640321, 8.718038213640321, 7.445213640522373, 7.445213640522373, 2.612435749924285, 2.612435749924285, 0.6046374630260641, 0.6046374630260641, 4.6051522929772455, 4.6051522929772455, 6.047481733116721, 6.047481733116721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34039337148703, "mean_inference_ms": 2.238357980989243, "mean_action_processing_ms": 0.09822359474901239, "mean_env_wait_ms": 0.5883702504066823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 249750, "timesteps_this_iter": 0, "agent_timesteps_total": 749250, "timers": {"sample_time_ms": 12808.103, "sample_throughput": 263.505, "load_time_ms": 0.399, "load_throughput": 8461312.612, "learn_time_ms": 2080.656, "learn_throughput": 1622.084, "update_time_ms": 26.044}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 13.439105606079101, "policy_loss": 0.010124222328886389, "vf_loss": 13.435925197601318, "vf_explained_var": 0.07773476243019103, "kl": 0.005070180098064725, "entropy": 0.6943597435951233, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.603549027442932, "policy_loss": -0.00950714610517025, "vf_loss": 1.6195796370506286, "vf_explained_var": 0.7396957367658615, "kl": 0.00647504091164085, "entropy": 0.6528580904006958, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 249750, "num_agent_steps_sampled": 749250, "num_steps_trained": 249750, "num_agent_steps_trained": 749250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9990, "training_iteration": 74, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-04-04", "timestamp": 1706108644, "time_this_iter_s": 11.966282606124878, "time_total_s": 986.452871799469, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6FAAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 986.452871799469, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 25.05625, "ram_util_percent": 66.69999999999999, "gpu_util_percent0": 0.078125, "vram_util_percent0": 0.22021484375}}
{"episode_reward_max": 11.303897680397933, "episode_reward_min": -25.863220992340327, "episode_reward_mean": -0.0933125562711166, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.11383785081492, "policy_agent_": -3.37389489519857}, "policy_reward_max": {"policy_adversary_": -3.3597533647190945, "policy_agent_": 14.596878301585901}, "policy_reward_mean": {"policy_adversary_": -11.19448576917452, "policy_agent_": 5.550586606451703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1276740670279124, -1.6545181652413619, 4.865968588606824, -3.106951107264198, -0.12309887157414257, 7.4975447579238335, 0.9616787776218004, -1.7577227539898166, -1.1227355865898905, 0.47884355018616065, 3.877142627548598, 4.030422952637348, 2.0183774427447405, -1.6724916095525344, -2.8876111932771673, 2.854219000805216, -13.26111682268281, 2.3077648098422956, 1.0928013525199376, -0.19396329148447533, -1.4079877959189089, -0.25060779730215865, -0.19757435798165265, 4.723510458525602, -0.7093824984898522, -1.946040617898344, 1.1588849069399074, -0.666922500076777, -18.322565950611562, 3.4515877660944474, 4.6072984930278515, 1.238168430415652, 1.9836303653023433, -9.210621896133395, 11.079661020804325, -0.906727522575476, 4.755801119370307, 0.6197148745990763, -4.952877811881671, -17.068368445160484, -0.6129360142039286, -0.39069452962158846, 1.717148481868776, 1.1530580175253382, 6.415947289913008, -1.6050207606931255, 1.753118282759172, 0.22504953318448467, -12.12188120942601, 4.454594735134515, 2.3661033333630206, 5.173735378286239, 1.5988481701099833, 3.901842128184274, -2.6682166016405455, 6.2170220295970475, 5.0507882386762, -3.937842784441842, 2.911887578612994, 1.3572966023411375, 0.631501095957248, -25.863220992340327, 0.09350810185216867, 4.328081155969755, -6.416124695056653, 1.80485474193696, -4.811427560227442, 2.644092648292216, 1.5485566492886351, 3.6460757964416644, 7.84087185862192, -2.1472814288853073, 1.0784633096452205, 10.081167520099696, 8.832354063151158, -2.9251875896761046, -1.8023108374270986, -0.13337716338217676, -0.9186817224299597, 7.457424546828627, -0.2213061997695471, 8.585728231770517, -9.097460390195799, 1.9766180786618883, -20.75917294192482, 2.17048943607105, 9.93845958870785, 2.0392523515434857, 3.7616791073096, 1.9455885395610035, 7.154427509105943, -1.3632869070387283, -3.497681177227302, -0.6454582472831736, -13.931452946102736, 2.2940285607443696, -10.613682873066454, -6.147846496804146, 0.38649458356204436, 0.11079179589910895, -8.27709780575715, -1.0800461823856626, 3.9239872712744917, -0.19649809284117115, -2.1897269780499533, 5.413740728301671, -3.7869908192470025, 1.3893590804473908, 0.31870825464958413, -1.227121687118351, 5.791259803791822, -0.39957120958116754, -5.828977856974883, 1.2842949439597775, 0.03585223292292938, 4.485371058102635, 5.017930126193891, 11.303897680397933, -11.175033874868511, -1.3267776569728624, 0.013949199417287256, -3.7920662690300437, 6.307675308812299, -4.582948554764988, -2.4104653410976655, 7.480724644883271, 1.5415630728987046, 1.2596390540258837, -5.033729953726203, -1.6334914832610168, 1.2897405806625604, 0.9380100964445471, 2.2859315009953503, -2.410379115149129, -0.39876448847219637], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-15.554635541928947, -10.955610385658577, -11.350800581793793, -5.318213220273004, -10.180680132164007, -13.978999650268767, -13.451275542403112, -13.330879730436369, -6.786700013409345, -6.7473217799236265, -11.974504626467192, -10.247690546653219, -8.416284320745122, -6.317670812659612, -18.93939727726389, -13.074156358526627, -6.513327032285677, -16.464228782325666, -5.914201735220357, -7.605448179899376, -6.339890745709811, -11.203762123378425, -11.93018543316704, -16.654715239185354, -7.687651812088753, -9.186552873589804, -6.843074466081414, -10.965684957206486, -16.294587697992494, -11.44649784764571, -12.583720541650044, -10.35446512793183, -7.40686642056341, -10.730246259347483, -17.30216590313829, -6.21779416044952, -8.503528086574335, -6.840149517812303, -9.939716452735663, -12.379052282834563, -14.430659096352615, -8.217576227780034, -14.193182421476267, -8.707335794457682, -13.88076409926845, -4.0748631023013395, -5.903108451583664, -15.625822621474235, -6.823126086798153, -16.40726055183777, -8.094794090045063, -20.123188355436582, -9.229916903187153, -13.882661453961035, -14.686101906588286, -17.986921968342987, -10.89809916682635, -11.80947520112683, -13.444210061331471, -8.528677834278634, -12.085766566011651, -26.11383785081492, -6.173120729450474, -8.7109965997488, -14.933466287714042, -9.505624544393346, -10.879058701751434, -15.911828261834636, -15.267129893125103, -12.00671392720849, -14.24794204189932, -14.120129655446982, -5.912371197670229, -17.892243738706515, -15.759160329562512, -13.889141528290974, -5.40897811019477, -13.917695819674735, -5.4625799178923335, -12.186051177979854, -6.9004277102405425, -20.471105160204914, -8.459005232147682, -10.374366245345515, -23.023492987443685, -11.087402047168604, -19.195732303955673, -9.322667765585454, -15.901225993478846, -10.668731553318336, -11.726733209091305, -9.765482981942744, -12.181045455983506, -8.1323908428511, -15.157205021384799, -15.614556514293866, -12.474539483314285, -13.330844396895769, -9.572140295344008, -7.980012436829695, -6.428597841341399, -7.670052379419046, -7.547530752447454, -3.3597533647190945, -11.014014596515976, -12.731282158592423, -7.226783110115215, -8.740817256387071, -9.638628369002422, -4.123769596620231, -11.472799461537528, -6.89473127330744, -10.733427798156509, -13.239285110433986, -6.349095696853315, -8.033076494391736, -9.315512586935068, -17.889858922773875, -11.59518115947628, -6.116309870750316, -5.033616968748892, -7.1690787810614, -13.21707012010216, -11.64444384372202, -10.163987737643351, -16.898038707112153, -10.165536393236257, -15.689488321681736, -23.668960197528698, -10.026180811575744, -10.336486677510225, -8.018761058737342, -13.476861172519126, -7.833040879767138, -5.190495257802627], "policy_policy_agent__reward": [7.213480737450515, 7.213480737450515, 4.650546110208606, 4.650546110208606, 8.108384585200309, 8.108384585200309, 1.1056310565044023, 1.1056310565044023, 5.028790630294932, 5.028790630294932, 10.7382722040963, 10.7382722040963, 7.206477160012455, 7.206477160012455, 5.786578488223276, 5.786578488223276, 2.8319822134097277, 2.8319822134097277, 3.613082665054894, 3.613082665054894, 7.925823627007896, 7.925823627007896, 7.139056749645282, 7.139056749645282, 5.217330881744929, 5.217330881744929, 2.322589601553539, 2.322589601553539, 8.025893041993363, 8.025893041993363, 7.964187679665922, 7.964187679665922, -3.37389489519857, -3.37389489519857, 9.385996796083978, 9.385996796083978, 3.5035015438701462, 3.5035015438701462, 3.7057424442074494, 3.7057424442074494, 2.465951474895451, 2.465951474895451, 5.476577163038134, 5.476577163038134, 5.866305537592693, 5.866305537592693, 10.689112848855476, 10.689112848855476, 3.4891346567994512, 3.4891346567994512, 3.620256127845731, 3.620256127845731, 4.00097968651066, 4.00097968651066, 5.149381228564854, 5.149381228564854, -1.01398912630954, -1.01398912630954, 7.449042806870076, 7.449042806870076, 8.595509517338948, 8.595509517338948, 5.7963167791737416, 5.7963167791737416, 4.695248392932877, 4.695248392932877, 0.7598121816070447, 0.7598121816070447, 14.19091346197131, 14.19091346197131, 2.6555333189370223, 2.6555333189370223, 6.629664602972322, 6.629664602972322, 3.7299321962056897, 3.7299321962056897, 2.4934193204269963, 2.4934193204269963, -2.3446580811629625, -2.3446580811629625, 6.908861541074344, 6.908861541074344, 3.9134408490792225, 3.9134408490792225, 7.955165451672521, 7.955165451672521, 4.930196905991512, 4.930196905991512, 10.148355694590729, 10.148355694590729, 1.2349211708041068, 1.2349211708041068, 3.82811336717142, 3.82811336717142, 7.92543607732936, 7.92543607732936, -2.649377561313927, -2.649377561313927, 10.430927643486143, 10.430927643486143, 5.2304487117040415, 5.2304487117040415, 12.64846186686141, 12.64846186686141, 5.414382536648569, 5.414382536648569, 8.892251791072654, 8.892251791072654, 6.00894265247387, 6.00894265247387, 12.101971998970013, 12.101971998970013, 7.974443702751276, 7.974443702751276, 3.935816208342495, 3.935816208342495, 8.178048819972235, 8.178048819972235, 4.942987218309885, 4.942987218309885, 6.358633830984448, 6.358633830984448, 0.12530842923727858, 0.12530842923727858, 3.13331441565132, 3.13331441565132, 6.519538877859278, 6.519538877859278, 4.258670796328693, 4.258670796328693, 5.655239643165156, 5.655239643165156, 3.033815570761998, 3.033815570761998, 9.277960455063425, 9.277960455063425, 8.407843271206866, 8.407843271206866, 7.826394861825081, 7.826394861825081, 11.044406950260617, 11.044406950260617, 5.9864241132808385, 5.9864241132808385, 3.495417253657725, 3.495417253657725, 13.986705629403104, 13.986705629403104, 12.295757196356833, 12.295757196356833, 5.481976969307433, 5.481976969307433, 1.8033336363838368, 1.8033336363838368, 6.8921593281462785, 6.8921593281462785, 2.271949097731186, 2.271949097731186, 9.821737862404241, 9.821737862404241, 3.3395607552354973, 3.3395607552354973, 14.528416695987717, 14.528416695987717, -0.31922757902406085, -0.31922757902406085, 6.1754921620036995, 6.1754921620036995, 1.1321600227594324, 1.1321600227594324, 6.628945741619826, 6.628945741619826, 14.567095946331762, 14.567095946331762, 5.68096005856447, 5.68096005856447, 9.831452550394221, 9.831452550394221, 6.30716004643967, 6.30716004643967, 9.440580359098627, 9.440580359098627, 4.201098037452006, 4.201098037452006, 4.3416821393781, 4.3416821393781, 3.7434662977839652, 3.7434662977839652, 0.6128760376410352, 0.6128760376410352, 8.954292537519118, 8.954292537519118, 0.930428305123917, 0.930428305123917, 3.591498950045816, 3.591498950045816, 4.979317439453026, 4.979317439453026, 4.045402116364402, 4.045402116364402, -0.924249982207871, -0.924249982207871, 3.295003098516692, 3.295003098516692, 5.735759011860973, 5.735759011860973, 1.5816276359389618, 1.5816276359389618, 4.41214380923301, 4.41214380923301, 9.072511443447048, 9.072511443447048, 1.7198961454341068, 1.7198961454341068, 5.065088168417231, 5.065088168417231, 4.978668311826002, 4.978668311826002, 1.4483239547509397, 1.4483239547509397, 8.632029632664674, 8.632029632664674, 3.247580031863137, 3.247580031863137, 2.4522249705908132, 2.4522249705908132, 7.261790027196882, 7.261790027196882, 3.192473964888122, 3.192473964888122, 6.259223776247184, 6.259223776247184, 7.16672135656448, 7.16672135656448, 14.596878301585901, 14.596878301585901, 0.21007364230388478, 0.21007364230388478, 2.3947661068887274, 2.3947661068887274, 2.5237830840830893, 2.5237830840830893, 1.6885062560156774, 1.6885062560156774, 9.762372714457225, 9.762372714457225, 3.5307476444785157, 3.5307476444785157, 3.8767611982728427, 3.8767611982728427, 12.18938167599771, 12.18938167599771, 5.8535497330674815, 5.8535497330674815, 8.474563687853813, 8.474563687853813, 9.317615121901246, 9.317615121901246, 4.196344664157363, 4.196344664157363, 5.813113629086395, 5.813113629086395, 4.478385577590943, 4.478385577590943, 7.8813963367572395, 7.8813963367572395, 2.7113308823090043, 2.7113308823090043, 2.395865384665215, 2.395865384665215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33989246367383463, "mean_inference_ms": 2.235337884050859, "mean_action_processing_ms": 0.09813751544042325, "mean_env_wait_ms": 0.5873998198325779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 253125, "timesteps_this_iter": 0, "agent_timesteps_total": 759375, "timers": {"sample_time_ms": 12570.141, "sample_throughput": 268.493, "load_time_ms": 0.498, "load_throughput": 6773422.652, "learn_time_ms": 2068.794, "learn_throughput": 1631.386, "update_time_ms": 26.047}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 11.965985107421876, "policy_loss": -0.002586588769918308, "vf_loss": 11.975758266448974, "vf_explained_var": 0.0617559552192688, "kl": 0.0031420459954147216, "entropy": 0.7186610221862793, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.213895720243454, "policy_loss": -0.0025604467839002608, "vf_loss": 1.223168247938156, "vf_explained_var": 0.7481889963150025, "kl": 0.005306690721297502, "entropy": 0.6716180711984634, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 253125, "num_agent_steps_sampled": 759375, "num_steps_trained": 253125, "num_agent_steps_trained": 759375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10125, "training_iteration": 75, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-04-16", "timestamp": 1706108656, "time_this_iter_s": 11.968549013137817, "time_total_s": 998.4214208126068, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6D4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 998.4214208126068, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 25.053333333333335, "ram_util_percent": 66.34666666666665, "gpu_util_percent0": 0.09266666666666669, "vram_util_percent0": 0.21474609375}}
{"episode_reward_max": 19.355414405657527, "episode_reward_min": -13.693015633835545, "episode_reward_mean": 0.9943020331851553, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -30.674901769548313, "policy_agent_": -0.8032384395740552}, "policy_reward_max": {"policy_adversary_": -4.362750919985917, "policy_agent_": 24.371906927575125}, "policy_reward_mean": {"policy_adversary_": -11.660499065598314, "policy_agent_": 6.327400549391735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9437796102312865, 18.06891208560193, 3.299648833772595, 3.5044211181295486, 1.6943552902584185, -0.11412097393095792, 1.9055844833679512, -2.002933373384824, -4.312511721482776, -3.9783417740758655, -0.35832471876462973, 4.786595903859649, -0.18674046390666232, -3.9303164224285805, -9.918292417431934, -1.5662475975503765, -2.8023577842776404, 6.516087621296403, 2.7035201614342244, -0.7580885722644932, -13.693015633835545, -0.1811262474309549, 3.5462054925148134, -2.5696511215620617, -2.198000336255917, 1.3052160600266982, -5.525125596099457, -3.082898150624629, 1.5666671385566142, -6.574305208821627, 14.803365293192886, -5.715178548837304, -2.8223446741740545, 0.6161037364641806, 14.669699965428032, -1.0693165515850387, -3.7655993912068544, 4.932967423218586, 1.0886300079771896, 1.2686545096742337, -2.2654789976376564, 5.306983532331198, 3.2434201587818916, 6.592082203603521, 2.494807988154939, -0.9096456175235459, -3.384257523649707, 0.6492049514236621, 4.617970899345184, -1.0701208450986714, 8.094473709094649, 1.6732364041941756, -3.8033855215091323, 4.852340961387733, 1.0692154345608473, -2.458341501776481, -4.4769332653087375, -2.5157673076816414, -0.8577525849643604, 4.723079367529046, -9.838417207214421, 2.8307765790457964, -2.60567544068761, 10.742399937196225, -0.5228523810914567, -1.1058340718915953, 3.2484135291386864, 1.5040468380828877, -4.91449907635689, 2.0348280788980158, 5.3347410608108685, 6.854527633733367, 2.193486814877613, 9.554760399622888, 3.1431609349449654, -3.6225615856224156, -1.6307739636365108, -0.05158508997205502, 1.7564045762999625, 10.749856980413922, -1.9722437632504253, 0.7291551015365052, 0.9548533912409662, 5.453362446475285, -9.240590235369451, 2.2065566881367116, -3.526816211383651, 1.7988616854354922, 3.705186441527174, -2.3693741456770665, -2.410930821708265, 4.411358932612103, -5.9271424312899335, 4.5688218579874755, 2.530697218984169, 7.5543373626570025, -0.9862719839743241, 0.428357497365622, -3.0038320475405715, 2.1652085343053753, -2.549883011541806, 1.949647961392086, 9.941722428850449, -1.1267199360558178, 3.1907653089197865, 7.657287758907921, -9.337531738737166, 0.20354767575528687, 12.322270938720543, 19.355414405657527, 12.17274422727162, 8.061879596584511, 2.0025209727775666, -8.694797764081088, 2.01460766197664, -4.93229645827059, 2.2880665755778655, -7.168995625973828, -9.710241654577974, 2.6394186790505274, -4.465785572383369, 4.1629038984249185, 5.540022833040286, -3.2774690379928066, 2.852895646150978, -5.072519782273174, 0.3399814806141218, 1.69300131999469, -1.574710633556166, 6.096322024778811, -4.6444293759877775, 9.980374945800643, 9.362667206991881, 0.1800009659317469, -1.6173794067353022], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.032798815362989, -30.674901769548313, -12.321196604331327, -17.5050034786037, -10.73340672243138, -8.904597432705964, -9.343511415522858, -13.637823543168214, -8.33020328971984, -7.481581080220023, -8.226239772562634, -10.675161105954453, -13.356815472768734, -5.867144988554185, -12.918505419583072, -6.559406920257704, -11.756276181919688, -12.715196867805199, -17.420020330893042, -13.813340011262266, -20.16633900367868, -8.820298406985914, -8.96380395433072, -9.046656946669131, -8.102197266612851, -13.392598639836589, -8.83713629293374, -6.21088655078931, -10.515692896493844, -13.485335407837889, -23.55745893698967, -8.293504423723052, -7.851130927450471, -8.054529145918934, -22.34197681131597, -14.442113106977608, -5.788536562815409, -13.947320827009879, -7.402360214681577, -11.060347203129348, -10.46577186537743, -12.758825616504845, -19.140233231369127, -14.477915727780882, -10.54961479202039, -9.476936520056721, -12.318690257294659, -12.09037120171118, -13.632253383128589, -7.50730094411566, -13.616949138377104, -8.148652997578527, -8.150236058702774, -12.602878645895185, -10.904295733235328, -6.246471082910601, -15.4056536285726, -8.085245321460485, -5.439007894349296, -13.062628270317235, -9.68329127764422, -12.202311088563917, -8.55739108992032, -20.143222470614475, -8.000864601505803, -13.575307321580707, -8.008389189827463, -7.826871170226497, -11.946952873994299, -19.045990054299846, -16.632505917750255, -22.939096019903495, -17.86791076661808, -20.750642234507257, -6.830709957191727, -9.493060176818853, -14.149492568354393, -13.345394920596279, -7.643083054484199, -18.54638363494351, -6.067483034910173, -10.84018778039194, -4.532381716899532, -15.490162593679837, -12.84568363147336, -5.55426995345258, -9.689711747862644, -7.041163514996438, -9.377787512335933, -9.081347646685815, -15.350991235127172, -8.258996866251993, -4.362750919985917, -10.648863279841757, -8.99952307535885, -11.527897823477948, -10.196921207947781, -9.58390008166229, -4.7960912695076825, -12.801747188628937, -8.02288955754974, -13.626287702351352, -16.847552152942058, -13.303111304432063, -9.756111683726576, -21.90281727775537, -11.152450961593809, -8.95726619336007, -21.900169284493835, -27.550979161904547, -20.003611774586762, -13.605416656249137, -10.474872580797987, -7.088320884932976, -11.144310462882927, -13.95631466328974, -10.937020652688835, -9.050114914282817, -12.797364812233948, -9.689636209375308, -10.724802201721896, -10.442053239377298, -11.02498178560838, -9.048392334858756, -10.159496751390629, -7.990003230386502, -7.5021722852983475, -11.584051842669789, -6.67375300429087, -10.489208686709715, -11.661708488103237, -15.313981719600735, -13.486863727985162, -6.807041269064503, -11.622224867337575], "policy_policy_agent__reward": [3.9882892127971385, 3.9882892127971385, 24.371906927575125, 24.371906927575125, 7.810422719051959, 7.810422719051959, 10.504712298366625, 10.504712298366625, 6.213881006344899, 6.213881006344899, 4.3952382293875045, 4.3952382293875045, 5.624547949445405, 5.624547949445405, 5.817445084891694, 5.817445084891694, 2.008845784118532, 2.008845784118532, 1.7516196530720796, 1.7516196530720796, 3.9339575268990012, 3.9339575268990012, 7.730878504907054, 7.730878504907054, 6.5850375044310345, 6.5850375044310345, 0.9684142830628012, 0.9684142830628012, 1.50010650107557, 1.50010650107557, 2.496579661353663, 2.496579661353663, 4.4769591988210236, 4.4769591988210236, 9.615642244550802, 9.615642244550802, 10.061770246163633, 10.061770246163633, 6.527625719498888, 6.527625719498888, 3.236661684921565, 3.236661684921565, 4.319586079777479, 4.319586079777479, 6.255004723422767, 6.255004723422767, 3.238502912553534, 3.238502912553534, 2.9520984651784667, 2.9520984651784667, 7.348907349931646, 7.348907349931646, 1.6560053484171438, 1.6560053484171438, 1.5639942000823397, 1.5639942000823397, 6.0411800175252255, 6.0411800175252255, 3.455515099508128, 3.455515099508128, 19.180412115091276, 19.180412115091276, 1.2891629374428741, 1.2891629374428741, 2.5143931266382085, 2.5143931266382085, 4.335316441191558, 4.335316441191558, 18.505838388371995, 18.505838388371995, 6.686398277696286, 6.686398277696286, 1.0114685858042753, 1.0114685858042753, 9.440144125114232, 9.440144125114232, 4.245495111329383, 4.245495111329383, 6.164500856401792, 6.164500856401792, 4.100146433869887, 4.100146433869887, 9.03290457441802, 9.03290457441802, 11.19182669507551, 11.19182669507551, 10.534998965692202, 10.534998965692202, 6.522211390087665, 6.522211390087665, 4.283645451266586, 4.283645451266586, 4.467216366822473, 4.467216366822473, 6.36978807656742, 6.36978807656742, 9.125112141236887, 9.125112141236887, 3.2185900495084945, 3.2185900495084945, 10.855711423735874, 10.855711423735874, 4.910944700886348, 4.910944700886348, 2.1734252685968207, 2.1734252685968207, 8.727609803641457, 8.727609803641457, 5.986755583898084, 5.986755583898084, 1.8940647905670596, 1.8940647905670596, 5.464360181631931, 5.464360181631931, 2.7847390068894233, 2.7847390068894233, 2.2906276546924675, 2.2906276546924675, 8.892853818923145, 8.892853818923145, -0.07756296478510308, -0.07756296478510308, 7.5165438338048585, 7.5165438338048585, 2.9758578246163543, 2.9758578246163543, 15.442811203905348, 15.442811203905348, 3.7390061102071726, 3.7390061102071726, 6.234736624844556, 6.234736624844556, 5.628401359483074, 5.628401359483074, 4.665459004154692, 4.665459004154692, 3.516226898818708, 3.516226898818708, 10.540409066598931, 10.540409066598931, 10.983623489280564, 10.983623489280564, 14.896811826818434, 14.896811826818434, 10.03069879074785, 10.03069879074785, 15.152701317065072, 15.152701317065072, 4.986935446068347, 4.986935446068347, 2.9352492955982172, 2.9352492955982172, 6.2593593023589404, 6.2593593023589404, 6.646904915312112, 6.646904915312112, 4.699743815392082, 4.699743815392082, 14.648120307678717, 14.648120307678717, 2.0476196358298733, 2.0476196358298733, 5.784671440964224, 5.784671440964224, 2.7436175540702483, 2.7436175540702483, 10.47176252007756, 10.47176252007756, 1.8025466980519544, 1.8025466980519544, 3.8804133207946463, 3.8804133207946463, 3.081447768239495, 3.081447768239495, 4.420012600215965, 4.420012600215965, 6.541486976931555, 6.541486976931555, 3.3559867505043735, 3.3559867505043735, 6.4700302067094535, 6.4700302067094535, 6.335177899432049, 6.335177899432049, -0.782195755652008, -0.782195755652008, 7.608842568914616, 7.608842568914616, 5.7651101471715105, 5.7651101471715105, 9.541117593067476, 9.541117593067476, 4.605324611986731, 4.605324611986731, 5.006128789513957, 5.006128789513957, 0.8961296109835558, 0.8961296109835558, 7.483477861467158, 7.483477861467158, 2.7365032730039673, 2.7365032730039673, 7.787967831871721, 7.787967831871721, 13.394637290896254, 13.394637290896254, 6.088195684188124, 6.088195684188124, 6.4734384963231815, 6.4734384963231815, 14.780052518331644, 14.780052518331644, 0.9074596114283238, 0.9074596114283238, 4.580406934557678, 4.580406934557678, 17.111220111607196, 17.111220111607196, 23.45319678378104, 23.45319678378104, 16.088178000929187, 16.088178000929187, 10.833648126416824, 10.833648126416824, 6.238696776787772, 6.238696776787772, -0.8032384395740552, -0.8032384395740552, 6.579459062429785, 6.579459062429785, 4.512009102509572, 4.512009102509572, 6.612543614133353, 6.612543614133353, 0.940559644154497, 0.940559644154497, 1.543561578827983, 1.543561578827983, 6.1645274442129185, 6.1645274442129185, 3.129508314669263, 3.129508314669263, 7.3024785689011065, 7.3024785689011065, 8.282502309324336, 8.282502309324336, 2.8854616484329734, 2.8854616484329734, 6.506196198770804, 6.506196198770804, 1.4587417240566631, 1.4587417240566631, 3.921076882956235, 3.921076882956235, 6.638526581332238, 6.638526581332238, 2.549521185367352, 2.549521185367352, 8.292765355744267, 8.292765355744267, 3.508639556057728, 3.508639556057728, 12.647178332700689, 12.647178332700689, 11.424765467488522, 11.424765467488522, 3.4935211174981244, 3.4935211174981244, 5.002422730301136, 5.002422730301136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33997013653190805, "mean_inference_ms": 2.237449796667631, "mean_action_processing_ms": 0.09818266588667046, "mean_env_wait_ms": 0.5879328165178164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 256500, "timesteps_this_iter": 0, "agent_timesteps_total": 769500, "timers": {"sample_time_ms": 12650.117, "sample_throughput": 266.796, "load_time_ms": 0.498, "load_throughput": 6773422.652, "learn_time_ms": 2066.177, "learn_throughput": 1633.452, "update_time_ms": 26.241}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 12.589607524871827, "policy_loss": 0.0015103377809282392, "vf_loss": 12.595213603973388, "vf_explained_var": 0.08624290823936462, "kl": 0.005123973420082595, "entropy": 0.7116593241691589, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.8183139562606812, "policy_loss": 0.0008005810239410493, "vf_loss": 1.824273270368576, "vf_explained_var": 0.7286059945821762, "kl": 0.005863365438185464, "entropy": 0.6764512687921524, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256500, "num_agent_steps_sampled": 769500, "num_steps_trained": 256500, "num_agent_steps_trained": 769500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10260, "training_iteration": 76, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-04-30", "timestamp": 1706108670, "time_this_iter_s": 13.93705129623413, "time_total_s": 1012.3584721088409, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A082D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1012.3584721088409, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 36.616666666666674, "ram_util_percent": 66.51111111111112, "gpu_util_percent0": 0.10500000000000001, "vram_util_percent0": 0.2302788628472222}}
{"episode_reward_max": 21.757724272704415, "episode_reward_min": -14.629812279135956, "episode_reward_mean": 1.35237035489976, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.2215123715429, "policy_agent_": -1.8396326995545809}, "policy_reward_max": {"policy_adversary_": -4.055178363452187, "policy_agent_": 24.48961832212366}, "policy_reward_mean": {"policy_adversary_": -12.461651491306752, "policy_agent_": 6.907010923103258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.8278127847128096, 0.3267528901465976, 8.026334856718403, 4.208087144812149, 1.5707839462914845, 0.38879480892092005, -0.820377450800958, -8.788502929647281, -6.782616568751996, 2.934389725517608, 3.9809135820146913, 2.9557060695855513, 6.838438941536133, 0.23941005858385922, 21.757724272704415, -2.5996509242154153, -0.7963614166467001, 0.9443630638537952, 3.0270626196214887, -1.4954787011174775, -11.843060589512787, -3.228250759719083, 6.8079326635634265, 5.72490269661233, -3.062093224511128, 15.503709011205972, -4.735722938837077, 1.2382529028799956, -14.629812279135956, 10.744751342594977, -0.29475077016913775, -4.680038063160692, 3.7431300191715366, 4.2095952300329555, -0.08983436469309636, -2.2463159197495153, -3.5783879505575626, 0.1702467938809418, -0.42276228890978373, 2.481449171854611, 0.13826412333541205, 7.276044661836662, -4.190006544803716, 4.8756070488417915, 10.00238421549519, 1.7980286758156603, 1.4933097690660486, 0.6564158818226326, -0.1665386075591172, 0.033389306896873, -3.9544148282126845, -2.7062821405840958, -6.459598364867697, 3.665037461528107, 2.408206775376229, 1.494847075599945, 9.143177835010805, 7.751639880657502, -3.9467692835721357, -3.7114361768249635, 1.884358871015333, 11.299606967789211, -5.21936059547138, 13.920373668135037, 3.0886172055655745, 6.956883497445314, -5.810167236522414, 1.6667638630661457, 4.806512709013507, 13.870292714765494, 7.507931129102392, -1.7121141336629435, -0.30681913999362437, 8.761386355472592, -0.9562398137052904, -0.03362863228448412, 1.6137385166053746, -2.949342173966754, 2.277141730540078, 10.418521236515998, 3.1871224210386475, -2.6388847880303503, -9.799640502286186, 1.0426777947695638, 2.0650758851231, 0.5845435959984655, 2.8087465032120793, 2.203091776331092, 2.730128507004913, 0.8094552325532579, -3.392821276702234, 10.329761220189447, 8.870373558523372, 0.8284308344350997, 4.57740726993843, -5.754232467753962, -7.732293535972664, -1.611686738970624, 3.964894218740689, 1.0738489794966413, 0.4745053674781727, 1.6321616703133175, -1.0506775628399636, -4.126561812810283, -0.27725498549663585, 1.9958225580609685, 1.2104026582772158, 0.5906337943061314, -0.24651610491863704, 1.9940449904070054, 2.973263665720899, -0.054163023822453304, -1.950211440170925, 4.060091562859054, 2.240690717867907, 1.0708795156011544, 2.9357103265485827, 5.498650001005498, 0.8673694860289067, 4.478296351950086, 4.009149069413634, 6.245430200549675, -1.1801173344452995, 3.8598460981795997, -2.9006716004072937, 6.973418000548654, -10.596402389882993, 1.6647740370782786, 3.479892107146958, -2.067446545607006, 0.4909615252773626, -7.072020865327178, 3.5199030142287646, 2.9342966410746723, 3.1591843380960594], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-18.41305120549957, -5.6230713634572025, -15.681298840027385, -23.44659200605442, -17.072372702878873, -13.837550574987734, -11.008728599871942, -5.109237530538123, -19.129392723268005, -10.754307375688935, -11.383710719185117, -18.268606360352575, -14.258222521536982, -10.80286370041816, -27.2215123715429, -11.058987298810194, -12.222238038108415, -12.405005151804943, -15.260222439967816, -9.731922062044204, -10.19004996251664, -10.969555378149789, -13.17969891248651, -14.597996795494923, -8.507830455297253, -18.742726279546076, -15.35406316546016, -5.582020001059592, -20.57951702001889, -16.28051480312039, -11.002327564594992, -10.710233914164007, -16.621255268600887, -16.069209684350007, -13.10286732117101, -11.532807086599615, -8.382621377747045, -9.513169141677334, -6.445728273245295, -8.870002488365849, -8.046717100087902, -15.422226158680138, -4.055178363452187, -14.662085467154931, -14.621800752516611, -17.712628732225937, -9.591142952574241, -7.513204307108554, -5.211146661839628, -13.370023851899038, -8.80128869754645, -7.17002086538656, -17.33809554910094, -8.853418864949857, -6.865427641454168, -9.722745132698567, -14.2715734183011, -12.104983770605658, -8.253232714828771, -9.114913778687816, -14.467086991092682, -17.382375289070463, -11.581420792413727, -25.196439431578874, -9.490842304147707, -13.698754271233906, -14.268156113586736, -6.792621083146692, -10.845517989244042, -22.6009607350737, -15.659794938491338, -4.6052686154271, -8.128778092893631, -16.820672865922294, -7.33682648808724, -12.847511454046053, -11.932360251019393, -5.973886402365914, -6.744107156490063, -24.530815219547836, -14.755755901348367, -5.961792672893957, -12.238480180487661, -15.172752449843063, -9.576477232358865, -6.5592049669112, -12.325306417264175, -10.824453999045737, -11.936485824571367, -11.980385907597077, -25.368328240648637, -18.90085543707522, -17.56509793716925, -5.534313900904343, -8.13104985106972, -8.52572613388755, -16.00261628042489, -10.178208970633388, -11.5341879960598, -16.340348954577802, -6.268735049880097, -9.274927662597058, -11.172321915358367, -12.93829028694939, -6.686673377812744, -25.751228492575756, -7.846258366193156, -7.564720885295548, -6.04175660282455, -14.097347131747938, -12.214821705225505, -13.469073301350257, -7.167080763778683, -9.911739401797114, -11.099100315192361, -15.389618074665739, -16.079521951106262, -10.559930379925088, -14.150364210070933, -11.598679579592858, -15.553394412750658, -14.619105679010714, -7.908111867186865, -11.149234874018395, -12.347880535191138, -11.664562691424536, -13.614616874237818, -15.582902251782224, -14.226142116750937, -15.049532040800893, -15.579316005322664, -9.889730083171273, -17.610840173299003, -13.03805397583771, -13.266369291227209], "policy_policy_agent__reward": [7.79261921039338, 7.79261921039338, 2.9749121268019003, 2.9749121268019003, 11.853816848372896, 11.853816848372896, 13.827339575433285, 13.827339575433285, 9.321578324585177, 9.321578324585177, 7.113172691954329, 7.113172691954329, 5.094175574535493, 5.094175574535493, -1.8396326995545809, -1.8396326995545809, 6.173388077258003, 6.173388077258003, 6.8443485506032715, 6.8443485506032715, 7.682312150599906, 7.682312150599906, 10.612156214969062, 10.612156214969062, 10.548330731536556, 10.548330731536556, 5.52113687950101, 5.52113687950101, 24.48961832212366, 24.48961832212366, 4.229668187297389, 4.229668187297389, 5.712938310730857, 5.712938310730857, 6.6746841078293695, 6.6746841078293695, 9.143642529794649, 9.143642529794649, 4.118221680463362, 4.118221680463362, -0.8265053134980769, -0.8265053134980769, 3.870652309215354, 3.870652309215354, 9.99381578802497, 9.99381578802497, 10.161449746053629, 10.161449746053629, 2.7228686153930615, 2.7228686153930615, 17.12321764537603, 17.12321764537603, 5.309170113311541, 5.309170113311541, 3.4101364519697928, 3.4101364519697928, 2.974852370441471, 2.974852370441471, 13.512633072857685, 13.512633072857685, 5.353788397212925, 5.353788397212925, 3.015097925501658, 3.015097925501658, 10.182192643886212, 10.182192643886212, 10.13940245719148, 10.13940245719148, 6.506516478238958, 6.506516478238958, 4.643245583425047, 4.643245583425047, 2.4021167135947414, 2.4021167135947414, 4.841707967779139, 4.841707967779139, 3.011482992167755, 3.011482992167755, 5.6757258301102285, 5.6757258301102285, 4.092490611711657, 4.092490611711657, 11.349135410258398, 11.349135410258398, -0.06741409067576609, -0.06741409067576609, 9.768846257998366, 9.768846257998366, 12.312092484005902, 12.312092484005902, 9.7553287040208, 9.7553287040208, 5.542226360820145, 5.542226360820145, 4.084810094465594, 4.084810094465594, 2.522304027140254, 2.522304027140254, 6.701706579397957, 6.701706579397957, 2.423436934666883, 2.423436934666883, 2.2318693624012313, 2.2318693624012313, 5.439248592116621, 5.439248592116621, 6.2592281632389835, 6.2592281632389835, 4.6368172084151995, 4.6368172084151995, 5.608796104149257, 5.608796104149257, 11.707375626655955, 11.707375626655955, 9.928311825631582, 9.928311825631582, 2.153231715628316, 2.153231715628316, 2.701738800931429, 2.701738800931429, 8.175722931054006, 8.175722931054006, 14.340991128429838, 14.340991128429838, 3.1810300984711715, 3.1810300984711715, 19.558406549856958, 19.558406549856958, 6.289729754856642, 6.289729754856642, 10.327818884339612, 10.327818884339612, 4.22899443853216, 4.22899443853216, 4.22969247310642, 4.22969247310642, 7.826015349128776, 7.826015349128776, 18.2356267249196, 18.2356267249196, 11.583863033796867, 11.583863033796867, 1.4465772408820783, 1.4465772408820783, 3.910979476450002, 3.910979476450002, 12.791029610697445, 12.791029610697445, 3.1902933371909743, 3.1902933371909743, 6.40694141088078, 6.40694141088078, 6.773049383812384, 6.773049383812384, 1.5122721141995807, 1.5122721141995807, 4.510624443515069, 4.510624443515069, 17.47466822803192, 17.47466822803192, 8.971439161193508, 8.971439161193508, 1.661453942431803, 1.661453942431803, 1.2194198391007376, 1.2194198391007376, 8.107715122306313, 8.107715122306313, 5.8207765587409845, 5.8207765587409845, 3.571874281454833, 3.571874281454833, 7.567026460238125, 7.567026460238125, 6.513772887688416, 6.513772887688416, 7.333307165788139, 7.333307165788139, 6.394920570075167, 6.394920570075167, 10.987753481973202, 10.987753481973202, 14.615308328632327, 14.615308328632327, 13.217735747846307, 13.217735747846307, 3.1813723676697223, 3.1813723676697223, 6.354228560504076, 6.354228560504076, 1.3857468330667957, 1.3857468330667957, 4.135161372226113, 4.135161372226113, 4.283261115831382, 4.283261115831382, 7.749541107400242, 7.749541107400242, 8.707098967037219, 8.707098967037219, 3.3716202086791354, 3.3716202086791354, 5.453544666455187, 5.453544666455187, 5.060822176259202, 5.060822176259202, 4.405864237069553, 4.405864237069553, 3.204709196158054, 3.204709196158054, 13.873525525318358, 13.873525525318358, 4.528330512235187, 4.528330512235187, 4.077677339800841, 4.077677339800841, 2.897620248952957, 2.897620248952957, 8.045696061077471, 8.045696061077471, 7.594042685473203, 7.594042685473203, 6.707455138763903, 6.707455138763903, 2.6084346618038796, 2.6084346618038796, 6.985915482328084, 6.985915482328084, 6.669895516530132, 6.669895516530132, 8.230248795133448, 8.230248795133448, 9.507616138827421, 9.507616138827421, 8.029290190465293, 8.029290190465293, 7.50886684804992, 7.50886684804992, 8.038487965771473, 8.038487965771473, 9.78127174108215, 9.78127174108215, 10.432267939780196, 10.432267939780196, 3.363997266370785, 3.363997266370785, 7.504540486098997, 7.504540486098997, 4.723604467391921, 4.723604467391921, 9.318990345986597, 9.318990345986597, 1.5091072421774119, 1.5091072421774119, 8.62383814443025, 8.62383814443025, 8.85301711194895, 8.85301711194895, 6.491042747596942, 6.491042747596942, 8.035138765300017, 8.035138765300017, 1.4088546089220473, 1.4088546089220473, 10.565371593763881, 10.565371593763881, 7.986175308456193, 7.986175308456193, 8.212776814661636, 8.212776814661636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33952489558807614, "mean_inference_ms": 2.2350936227635145, "mean_action_processing_ms": 0.09814186359376223, "mean_env_wait_ms": 0.58739136820937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 259875, "timesteps_this_iter": 0, "agent_timesteps_total": 779625, "timers": {"sample_time_ms": 12642.929, "sample_throughput": 266.948, "load_time_ms": 0.399, "load_throughput": 8466373.206, "learn_time_ms": 2066.642, "learn_throughput": 1633.084, "update_time_ms": 26.438}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 13.553067874908447, "policy_loss": -0.0037359191803261636, "vf_loss": 13.563920879364014, "vf_explained_var": 0.09103968143463134, "kl": 0.0035735933301176415, "entropy": 0.7117216885089874, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.588788056373596, "policy_loss": -0.003586582373827696, "vf_loss": 1.5989078104496002, "vf_explained_var": 0.7663297176361084, "kl": 0.005704442837421936, "entropy": 0.6537622660398483, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 259875, "num_agent_steps_sampled": 779625, "num_steps_trained": 259875, "num_agent_steps_trained": 779625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10395, "training_iteration": 77, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-04-42", "timestamp": 1706108682, "time_this_iter_s": 12.310296297073364, "time_total_s": 1024.6687684059143, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A082040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1024.6687684059143, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 27.7875, "ram_util_percent": 67.0375, "gpu_util_percent0": 0.230625, "vram_util_percent0": 0.22711181640625}}
{"episode_reward_max": 14.624025856268325, "episode_reward_min": -17.343367081583427, "episode_reward_mean": 0.17605957815212123, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.490123130150263, "policy_agent_": -1.832755193324355}, "policy_reward_max": {"policy_adversary_": -3.605275989986379, "policy_agent_": 18.57181288022145}, "policy_reward_mean": {"policy_adversary_": -11.378598535823084, "policy_agent_": 5.777329056987605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9625002713876891, 0.23650721054643736, 14.624025856268325, 0.6929901394215054, 1.7475997689618101, -3.423115874521844, -6.488870740488844, -3.773530602005926, -0.4106952708179694, -0.8826618626100791, 0.2502816623722523, -7.006455415962304, 5.697311592799956, 7.545609467131603, 0.6622240836395509, 2.4056294725093803, -10.053453327007592, 3.702630112466108, -1.8975560126275792, -3.851913777430716, 1.0887376452693278, -11.585025045578758, 1.7656868860797013, -4.567329845004137, 1.4641790717080034, -0.10779832986185839, 4.91170636261879, 0.4583229068425797, 0.20637460186013282, -9.141352763118679, 4.3639240124339365, 1.1260539113531502, -11.553959151332371, -3.5905703898726866, 2.2349940021313595, 3.1706293254319253, -0.40483919450591777, 0.7798874263522464, -3.7574285249297805, -0.9650420006727085, -0.8425572838206422, -0.4364383533411582, -4.598663016498982, -0.2784715185257911, -0.9850034226027031, 1.6529705341474068, -4.922723477318912, 6.70339588628019, 2.0749183966357654, -2.042023181973771, 1.7848239915221131, 5.0988508487799615, 7.6388947259087345, 2.867765061245666, 5.424159720157823, 0.21198218926290713, -4.059920590368551, -1.8800949839952152, 2.267250631550324, -0.18391264364225202, -4.98326564032241, -6.359196341911196, 4.4222265122550946, -1.6448200328050702, -0.9774769357142742, -6.377106085822675, 0.5571671636726357, 5.257870900238486, -6.116329866314202, 1.1130828595934341, 9.980937817179138, -6.075726424232438, -3.171841303100186, 2.633658078877588, 5.780643290623436, -8.943321160974836, -7.364572617739122, 5.057660605896007, 1.98880462395209, -4.7289121701593855, -0.6415133240961608, 1.31699320923091, 5.451870152590182, -2.7010513781056527, 0.9514622289027009, 3.3116726906585354, -3.0181210059316315, 5.401033345522119, -0.759832389324163, 8.398295478114207, 2.168268518844843, 3.317753011816874, 0.1954097431155284, 0.8628775028761395, 4.9369981143490405, 1.5221083045029655, -2.0746143603734315, 9.461784076304692, -2.312420534541085, 3.949348457342948, -3.1589031719172533, 1.9395627448943316, 0.6472613553510786, -3.049616276664678, -3.760357921050864, 1.4379771808312596, -0.6197038697797734, 5.710392675091586, 7.521498094055484, 4.087233413549125, 2.131594297703311, -1.6054070953480752, 0.9486832481854317, -10.245513463844045, -0.7487228580895546, 3.90114607618928, 5.410575909819979, -8.814813884252377, 1.4286149049260037, 5.7431195904109105, -0.21319143611214586, 0.34546751600262604, 0.6056893212082342, 3.482555108897644, 2.49131622060609, 11.127529930868613, 0.2934315267838374, -0.06017487875421246, 2.6044946678786793, 1.1814047731559638, -2.384170679686219, 1.8065080789673726, -17.343367081583427, 0.0165569512660472, 1.9151563341208713], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.587512089487399, -3.605275989986379, -22.519599904174587, -7.1501078855845375, -11.153814628581829, -16.559040055228987, -17.160618024668064, -6.444299046419588, -8.205411430220709, -10.552479321347377, -6.969729505231296, -12.807087888986615, -10.152038007067587, -19.189642774730363, -4.8578070144391345, -14.255602252921754, -15.405460887231538, -9.987298337644756, -6.865479407088188, -13.716359797885763, -10.463794753836197, -7.919514658930044, -6.038953704387046, -9.296763105414277, -6.6345365279361985, -16.050859568503547, -11.97533677586369, -14.36350637507136, -11.393132613392478, -8.05241447648976, -17.569963648885526, -8.436257636373842, -10.940092499267909, -12.544132270821024, -7.504927182591156, -8.049862869595882, -18.692103152678904, -5.8660475833529215, -11.38003350663162, -6.232869120516751, -9.688499298517739, -10.346737441289434, -7.915124385626951, -5.755411273137435, -7.059942181280347, -13.576587451046178, -12.851468413429657, -11.398439243109868, -18.201075184861015, -13.837402610716085, -11.54438124577877, -15.652695432037358, -18.38648778976585, -11.624295795669573, -16.067562776126426, -10.406132951225723, -17.606916690583205, -6.307602019113835, -6.065474393678841, -19.39409245595106, -16.012785868930813, -11.063708002595982, -11.234455850319767, -5.67677651571715, -17.500120368971807, -8.072536291681617, -9.059882137511968, -18.04721204485307, -8.94338691383849, -12.983536893331362, -15.962788042531693, -14.42105214420158, -6.038001228557066, -6.371875744446125, -13.459265044629156, -7.4371201481566365, -13.800927649324427, -15.655707651863043, -18.100840515051594, -19.290968767352002, -8.99942806488797, -12.18096436193344, -10.037541580113153, -8.031563198505843, -9.480812953630855, -13.787340750479807, -15.194729394995885, -12.974642522847391, -14.398954040502366, -13.811017249529009, -10.76111347722642, -8.126743515165167, -6.510508830321664, -7.3170340467110115, -12.115639247647678, -7.3642617079093995, -5.226199317772531, -19.36889371397208, -8.204145107758979, -7.966845991549421, -8.698955472569953, -10.130052764667546, -8.176055749937987, -8.863448596037406, -8.09600362286634, -10.729411540463055, -6.978521863790822, -13.351754301291395, -17.718106154860973, -8.756213401162988, -10.642589837231807, -9.516043420821076, -5.796406956689404, -23.490123130150263, -13.535065878268885, -14.580495962968078, -17.048968880222997, -12.825159821210981, -10.80340740024664, -18.586490589938986, -8.22337198423519, -9.062021201105656, -7.200224249944832, -8.48214394838367, -15.594211706584773, -17.067884042727144, -5.16617526249613, -11.620455621417824, -9.104416365549943, -7.142751933398161, -4.872873931713688, -5.770293086280403, -21.331636736297735, -15.748650223081395, -12.172994487765147], "policy_policy_agent__reward": [2.8125059090498543, 2.8125059090498543, 1.9208916002664085, 1.9208916002664085, 18.57181288022145, 18.57181288022145, 3.92154901250302, 3.92154901250302, 6.45070719877182, 6.45070719877182, 6.567962090353572, 6.567962090353572, 5.335873642089615, 5.335873642089615, 1.3353842222068297, 1.3353842222068297, 3.8973580797013714, 3.8973580797013714, 4.8349087293686495, 4.8349087293686495, 3.6100055838017737, 3.6100055838017737, 2.9003162365121566, 2.9003162365121566, 7.924674799933769, 7.924674799933769, 13.367626120930986, 13.367626120930986, 2.7600155490393425, 2.7600155490393425, 8.330615862715566, 8.330615862715566, 2.676003780111969, 2.676003780111969, 6.844964225055431, 6.844964225055431, 2.4839616972303045, 2.4839616972303045, 4.932223010227526, 4.932223010227526, 5.776266199552764, 5.776266199552764, -1.832755193324355, -1.832755193324355, 3.9023202952333733, 3.9023202952333733, 2.364716630205069, 2.364716630205069, 4.049357799822101, 4.049357799822101, 7.971530619320847, 7.971530619320847, 8.443521569241238, 8.443521569241238, 7.410914640956972, 7.410914640956972, 5.7997536076263065, 5.7997536076263065, -0.5444691433144582, -0.5444691433144582, 10.966943830659726, 10.966943830659726, 4.781155773863498, 4.781155773863498, -0.3069333260322296, -0.3069333260322296, 4.476780940474167, 4.476780940474167, 4.8699605923612586, 4.8699605923612586, 5.610246097513903, 5.610246097513903, 9.143631979086493, 9.143631979086493, 3.3229675048525835, 3.3229675048525835, 3.8113024908509203, 3.8113024908509203, 2.6339135599220205, 2.6339135599220205, 4.422971007348549, 4.422971007348549, 4.955149543974137, 4.955149543974137, 1.6582306845639865, 1.6582306845639865, 2.738469877305822, 2.738469877305822, 3.0374693793388228, 3.0374693793388228, 7.614778992596794, 7.614778992596794, 3.9643724680553727, 3.9643724680553727, 9.050917564695027, 9.050917564695027, 10.137996790748392, 10.137996790748392, 5.8976897143711575, 5.8976897143711575, 6.664602618650442, 6.664602618650442, 10.375773140408661, 10.375773140408661, 13.01269125783729, 13.01269125783729, 7.246030428457622, 7.246030428457622, 10.745861248142127, 10.745861248142127, 5.309057570244315, 5.309057570244315, 6.773498050107325, 6.773498050107325, 2.2137535175593093, 2.2137535175593093, 4.166362512614581, 4.166362512614581, 9.605089906154403, 9.605089906154403, 5.514760114304204, 5.514760114304204, 2.352255830342393, 2.352255830342393, 7.828341181287427, 7.828341181287427, 2.01597824145604, 2.01597824145604, 8.261321716628775, 8.261321716628775, 0.8477151029294713, 0.8477151029294713, 4.808524650592302, 4.808524650592302, 11.652541472545781, 11.652541472545781, 1.4135285237621438, 1.4135285237621438, 7.048309876462401, 7.048309876462401, 12.971862929855416, 12.971862929855416, 4.172662859984571, 4.172662859984571, 1.4330799627284412, 1.4330799627284412, 4.502766911661856, 4.502766911661856, 9.619954167626295, 9.619954167626295, -0.7531005064091018, -0.7531005064091018, 3.2181775157926538, 3.2181775157926538, 10.356684128879529, 10.356684128879529, 10.044822569501843, 10.044822569501843, 7.281028298596308, 7.281028298596308, 4.1789573703959055, 4.1789573703959055, 6.748978785582172, 6.748978785582172, 7.744705866351666, 7.744705866351666, 2.6652559102000946, 2.6652559102000946, 5.216137591266778, 5.216137591266778, 8.549506720569173, 8.549506720569173, 6.088304194532129, 6.088304194532129, 9.187837934184756, 9.187837934184756, 6.819560825589102, 6.819560825589102, 11.104656363821606, 11.104656363821606, 6.464690998035633, 6.464690998035633, 5.7222482634910214, 5.7222482634910214, 3.3529592867185967, 3.3529592867185967, 4.089955774793576, 4.089955774793576, 8.526318680998358, 8.526318680998358, 4.443185006206182, 4.443185006206182, 1.5757924786995505, 1.5757924786995505, 14.415338895138389, 14.415338895138389, 2.945862286608947, 2.945862286608947, 5.958097224446183, 5.958097224446183, 2.770026150326351, 2.770026150326351, 6.034807754780939, 6.034807754780939, 4.411658552644531, 4.411658552644531, 2.9069161596863666, 2.9069161596863666, 2.167822850907736, 2.167822850907736, 6.083694360647156, 6.083694360647156, 3.179408997005525, 3.179408997005525, 9.53107348819149, 9.53107348819149, 12.61980212445823, 12.61980212445823, 6.421723407356055, 6.421723407356055, 6.3870920674675595, 6.3870920674675595, 3.9553181627365013, 3.9553181627365013, 3.372545102437419, 3.372545102437419, 6.622304833153104, 6.622304833153104, 6.393171510089667, 6.393171510089667, 9.240821019578679, 9.240821019578679, 11.22977239502149, 11.22977239502149, 2.0051729684793003, 2.0051729684793003, 6.1160111525863226, 6.1160111525863226, 12.16480509017495, 12.16480509017495, 4.005090274061522, 4.005090274061522, 4.703744358554143, 4.703744358554143, 3.9029567855765332, 3.9029567855765332, 5.982349528640656, 5.982349528640656, 9.042763963595434, 9.042763963595434, 14.097706986797878, 14.097706986797878, 2.7298033946399842, 2.7298033946399842, 5.780140371331807, 5.780140371331807, 5.854455516714311, 5.854455516714311, 4.162078353277061, 4.162078353277061, 1.2443516260137344, 1.2443516260137344, 3.7884005826238885, 3.7884005826238885, 1.9941348273571529, 1.9941348273571529, 7.882603587173722, 7.882603587173722, 7.044075410943007, 7.044075410943007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3390029190551683, "mean_inference_ms": 2.2316367841579177, "mean_action_processing_ms": 0.09806214871260437, "mean_env_wait_ms": 0.5864071251635028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 263250, "timesteps_this_iter": 0, "agent_timesteps_total": 789750, "timers": {"sample_time_ms": 12635.813, "sample_throughput": 267.098, "load_time_ms": 0.498, "load_throughput": 6772774.508, "learn_time_ms": 2069.929, "learn_throughput": 1630.491, "update_time_ms": 26.046}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005000000000000001, "total_loss": 11.373236846923827, "policy_loss": -0.0035562102842959576, "vf_loss": 11.384045124053955, "vf_explained_var": 0.11927434802055359, "kl": 0.004443985159496363, "entropy": 0.725212162733078, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.290035355091095, "policy_loss": -0.008314794860780239, "vf_loss": 1.3048175156116486, "vf_explained_var": 0.7504945814609527, "kl": 0.005369740183351751, "entropy": 0.6471577197313308, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 263250, "num_agent_steps_sampled": 789750, "num_steps_trained": 263250, "num_agent_steps_trained": 789750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10530, "training_iteration": 78, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-04-54", "timestamp": 1706108694, "time_this_iter_s": 11.819538831710815, "time_total_s": 1036.4883072376251, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0696B430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1036.4883072376251, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 25.98, "ram_util_percent": 66.84666666666665, "gpu_util_percent0": 0.09400000000000003, "vram_util_percent0": 0.22223307291666666}}
{"episode_reward_max": 20.199064589075615, "episode_reward_min": -14.411003749526234, "episode_reward_mean": 0.30644586786317846, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.058386565011293, "policy_agent_": -2.29835855761019}, "policy_reward_max": {"policy_adversary_": -4.42140021534532, "policy_agent_": 22.58355448108744}, "policy_reward_mean": {"policy_adversary_": -11.548434226130109, "policy_agent_": 5.927440046996644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.034414559157986, 0.5415071122515402, 8.214981129781789, 1.5735995467897255, -1.8171187797632347, 8.47834602202108, 0.1257145509624948, 4.040708993938849, -0.13507648594636956, -2.0745862526981544, -2.242708836702687, 2.9967561289836695, -4.281477215269319, 3.022328114547213, -3.75135728238591, 1.2847986051803113, -1.8270195321721556, 2.291520889944819, -1.6319356992370682, 1.1327493049824837, -2.7606279130877978, 2.643881929128813, 1.0104855705198477, 1.031150295821788, -1.5249925579563786, -2.5875685243479505, -1.8974051932922225, -4.099487255809912, 2.3087270037126544, 6.280473827253777, 2.788842646841544, -2.67287021115035, 4.195081622962246, -0.5702760410592072, -14.411003749526234, 1.6510458863984643, -4.3817068421022904, -4.3587475066388555, -3.0010167162194468, 1.247359565885576, -14.022607407066745, -1.628246897090407, -2.00518452319356, 6.101198048212306, -10.155090807213812, 0.5792193981723301, -3.7297366753821137, 2.9106208594503857, 3.4371144296378553, -10.948287285117573, 1.2719550208979116, 3.335272514107796, -11.299717222131282, 0.1507714228771146, -1.7897933181847439, -4.721339532466665, 6.077815934286478, 1.7196565686320853, 1.7793046767180085, 0.08556793004593324, 7.878469385978929, 11.635719899558172, -6.83682814384742, 0.7632629647254524, -1.9744073546470122, 0.9043498767615769, 0.7783166849978557, 3.145283337830312, 4.122437255358657, -7.776235488948187, -1.17074685287603, 4.721147176489028, 3.1111167515526352, -7.640720455773421, 4.654833312330262, -1.7027620748583114, -3.870411206051994, 8.961617337284281, -0.7534507176757403, 0.31205686495117585, 0.8733534671341754, -9.16664561863914, 1.1342277524996516, 3.3551889583665413, -4.008012545091365, -2.0267522853886772, -7.628286524444695, 2.692246238554099, 4.8359963611991805, -2.849403791601693, 10.95739918478472, 0.5399790801368776, -2.7688142667955717, 3.7937758836081987, -0.3531276581402185, -0.5866723450262459, 9.034447000241787, 7.443457692470989, 3.0717220350587096, 1.7944141866431291, -2.1948599339113817, 5.498205945742831, -1.1858316446248418, -1.3205704598567376, -1.5550401050621931, 1.6620858229923, 5.14811963619789, -1.4708740080990732, -1.4622655603815489, 7.431038902421452, 9.773495430285083, 1.0637463899775377, 1.2048939505640592, -4.681461215683853, 20.199064589075615, -4.929745200148863, 4.914748259333496, 7.424942220273024, 2.1843021505789983, -1.0412850584608913, -2.4842111541850462, 8.59695310829021, 4.64332010490832, -0.34447474726678307, 7.492875165716841, -5.234191732064333, 0.12648257136251562, -7.8071653055931405, -2.594575800111225, 2.266809654437329, 0.4702529268310631, -11.78805607521956, -2.675999381692759, -6.494701591175731, 6.116639100475404], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-5.405277812632083, -10.078198086472046, -25.65594266100116, -8.731571114134187, -15.801491902168294, -16.494818617562167, -6.342160673719004, -11.499088012044044, -6.430561717984388, -11.640503387144346, -10.882123232156337, -11.48176607231185, -7.983661444112867, -11.753562293849608, -5.257074484064015, -11.283364905096798, -9.440314050947705, -7.2770109343986356, -10.690722201118787, -15.997481102193747, -12.319830291166166, -9.579293359198816, -9.172413910669146, -9.06336135173538, -14.022971328726848, -11.32584389209583, -7.128609455641522, -18.08638649835806, -8.175541168271875, -15.870946836494783, -8.595211908963538, -4.42140021534532, -12.578931201353724, -6.483046552064356, -15.136919848120286, -13.877148366279126, -6.566739778572, -7.388008570817576, -6.590693454461228, -10.193631595695646, -14.331325294519672, -7.703002424677402, -10.707268676960412, -17.99506803796344, -12.45846120411295, -5.564276210761191, -9.075314162444446, -14.030631155528516, -12.049916782728827, -6.934715833349838, -21.51514367514797, -15.01520726446291, -6.703000106910907, -10.236651762823142, -7.958387390818983, -8.555168504572467, -11.552011487233196, -12.019489592125318, -10.998718703630443, -9.382171149422264, -16.247399949197728, -16.72640014471379, -20.878910502639773, -6.360396171876568, -15.908338108239327, -9.53069714069747, -5.671335156362162, -14.774503924466236, -16.6842025759944, -15.347739619000981, -5.769108410068705, -16.149126638425773, -10.519214856626753, -12.792684378308602, -10.924511315579778, -12.097550018544101, -12.172707872606466, -17.473063503117366, -6.2695395754764425, -6.33447549337586, -6.108205278947226, -13.064371547865033, -11.908867852984239, -9.18278453863903, -9.920733286487902, -16.571713265361268, -6.567144571343399, -11.037106236320016, -9.868278677757823, -13.729069259638093, -22.02627672276148, -8.287791755041972, -7.926661011976819, -16.452140558679734, -8.121891926299181, -5.053230889806419, -15.428549430935261, -15.137785230770605, -10.35221378111933, -7.784748828288134, -8.948698313012542, -10.66944214405364, -6.072893318895998, -14.014483849447759, -9.265828067770661, -11.984531956356335, -15.243894498704442, -15.173721517059255, -10.033825330516281, -13.588195712154839, -24.51764729064123, -11.116650840560801, -7.644474811874775, -9.59564071639504, -24.96804437309927, -7.315796306730004, -13.094277535824792, -18.905272579266995, -13.136435462281769, -12.915214539609437, -6.754408649868157, -14.004714956173222, -11.563763913038024, -8.117646281024683, -26.058386565011293, -6.049933955204938, -6.996887610318491, -16.416040313502563, -10.9843336307335, -9.90010804042608, -7.63812935714023, -14.221050492630619, -8.644165971713127, -12.437713218974134, -16.395344691870918], "policy_policy_agent__reward": [3.219846185895035, 3.219846185895035, 5.309852599361792, 5.309852599361792, 16.93546189539147, 16.93546189539147, 5.152585330461954, 5.152585330461954, 6.99218656120253, 6.99218656120253, 12.486582319791625, 12.486582319791625, 3.2339376123407493, 3.2339376123407493, 7.769898502991449, 7.769898502991449, 3.147742616019009, 3.147742616019009, 4.782958567223096, 4.782958567223096, 4.319707197726826, 4.319707197726826, 7.239261100647755, 7.239261100647755, 1.8510921144217742, 1.8510921144217742, 7.387945204198414, 7.387945204198414, 0.7528586008390523, 0.7528586008390523, 6.284081755138556, 6.284081755138556, 3.806647259387774, 3.806647259387774, 4.784265912171726, 4.784265912171726, 4.52939325094086, 4.52939325094086, 8.565115203588116, 8.565115203588116, 4.779601189039184, 4.779601189039184, 6.111587644163816, 6.111587644163816, 5.091449740594496, 5.091449740594496, 5.047255823778584, 5.047255823778584, 6.248989385385235, 6.248989385385235, 4.369137683873939, 4.369137683873939, 2.615602131174648, 2.615602131174648, 6.993449621274075, 6.993449621274075, 5.242134085992265, 5.242134085992265, 11.075710331874282, 11.075710331874282, 5.6920272779025405, 5.6920272779025405, 0.8742650020974834, 0.8742650020974834, 8.387006412157987, 8.387006412157987, 2.9563852555025756, 2.9563852555025756, 0.3629580492970259, 0.3629580492970259, 7.764097126338796, 7.764097126338796, 1.0925164682348536, 1.0925164682348536, 1.514630532089361, 1.514630532089361, 1.7948383691208898, 1.7948383691208898, 5.720495580790612, 5.720495580790612, 0.1543589437264603, 0.1543589437264603, 3.037377763793497, 3.037377763793497, 4.351042076883425, 4.351042076883425, 12.04813304308787, 12.04813304308787, 1.1516851984495664, 1.1516851984495664, 3.0717478044667614, 3.0717478044667614, 2.6727887435311635, 2.6727887435311635, 8.47062600748945, 8.47062600748945, 7.743515606183342, 7.743515606183342, -2.0067857258838684, -2.0067857258838684, 11.393549348022944, 11.393549348022944, 9.175239889285352, 9.175239889285352, -2.29835855761019, -2.29835855761019, 5.193711592850125, 5.193711592850125, 3.0842970363171207, 3.0842970363171207, 1.9169144860529033, 1.9169144860529033, 8.814913710759837, 8.814913710759837, 6.869573080378702, 6.869573080378702, 6.389011690174225, 6.389011690174225, 4.733869539734099, 4.733869539734099, 12.062934667588326, 12.062934667588326, 14.181060022135979, 14.181060022135979, 7.021041179396179, 7.021041179396179, 3.56182956830101, 3.56182956830101, 6.966965376796154, 6.966965376796154, 5.217523508729525, 5.217523508729525, 3.2248259206800096, 3.2248259206800096, 8.959893631148269, 8.959893631148269, 10.40331991567653, 10.40331991567653, 3.785752065026398, 3.785752065026398, 2.299180778596338, 2.299180778596338, 10.435136907457402, 10.435136907457402, 6.815165804089696, 6.815165804089696, 2.5759819612675887, 2.5759819612675887, 7.7896723139550215, 7.7896723139550215, 5.197393971842892, 5.197393971842892, 4.151148333277237, 4.151148333277237, 13.217340420200824, 13.217340420200824, 2.7580444289003516, 2.7580444289003516, 3.3232661791635176, 3.3232661791635176, 3.490779373040701, 3.490779373040701, 1.9488629646129452, 1.9488629646129452, 6.521547802741948, 6.521547802741948, 6.268986748502785, 6.268986748502785, 2.956360370698268, 2.956360370698268, 7.272480489986295, 7.272480489986295, -0.5305709765506463, -0.5305709765506463, 6.864676237437053, 6.864676237437053, 7.352137519478502, 7.352137519478502, 5.439832734018197, 5.439832734018197, 16.49183795377311, 16.49183795377311, 4.413885417589425, 4.413885417589425, 2.578923372590622, 2.578923372590622, 10.122958221143962, 10.122958221143962, 3.8843821340794795, 3.8843821340794795, 2.233279272390087, 2.233279272390087, 12.231498215588525, 12.231498215588525, 11.290621461620795, 11.290621461620795, 6.7119679080890196, 6.7119679080890196, 4.789581507465631, 4.789581507465631, 3.3769191895505792, 3.3769191895505792, 8.083824044898236, 8.083824044898236, 2.4435308371355795, 2.4435308371355795, 6.346956694795511, 6.346956694795511, 3.8553939813542333, 3.8553939813542333, 6.823308889674317, 6.823308889674317, 10.196007067451168, 10.196007067451168, 6.85142375448009, 6.85142375448009, 4.285779885067369, 4.285779885067369, 10.509617307288144, 10.509617307288144, 17.145571360463165, 17.145571360463165, 6.09019861526917, 6.09019861526917, 4.424684381219418, 4.424684381219418, 2.457089750355591, 2.457089750355591, 22.58355448108744, 22.58355448108744, 1.19302555329057, 1.19302555329057, 9.004512897579144, 9.004512897579144, 13.165107399770005, 13.165107399770005, 7.660368806430382, 7.660368806430382, 5.936964740574271, 5.936964740574271, 2.135098747841554, 2.135098747841554, 11.300834032231714, 11.300834032231714, 8.103542008973168, 8.103542008973168, 3.886585766878951, 3.886585766878951, 16.775630865364064, 16.775630865364064, 0.40787111157030176, 0.40787111157030176, 3.5616850908405033, 3.5616850908405033, 4.304437503954711, 4.304437503954711, 4.194878915311137, 4.194878915311137, 6.0834588474317055, 6.0834588474317055, 4.0541911419856484, 4.0541911419856484, 1.216497208705532, 1.216497208705532, 2.9840832950101834, 2.9840832950101834, 2.9715058138992023, 2.9715058138992023, 11.255991896173159, 11.255991896173159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3388309456941793, "mean_inference_ms": 2.229647404928461, "mean_action_processing_ms": 0.0980173603389981, "mean_env_wait_ms": 0.5860504693493618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 266625, "timesteps_this_iter": 0, "agent_timesteps_total": 799875, "timers": {"sample_time_ms": 12627.928, "sample_throughput": 267.265, "load_time_ms": 0.399, "load_throughput": 8465866.874, "learn_time_ms": 2065.636, "learn_throughput": 1633.88, "update_time_ms": 26.148}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005000000000000001, "total_loss": 12.011445617675781, "policy_loss": -0.009254571935161948, "vf_loss": 12.027968215942384, "vf_explained_var": 0.09052533507347107, "kl": 0.0019407432463908968, "entropy": 0.7267501950263977, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.4657480239868164, "policy_loss": 0.005681010335683823, "vf_loss": 1.4666899263858795, "vf_explained_var": 0.7527995854616165, "kl": 0.005069670444225405, "entropy": 0.6626903653144837, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 266625, "num_agent_steps_sampled": 799875, "num_steps_trained": 266625, "num_agent_steps_trained": 799875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10665, "training_iteration": 79, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-05-07", "timestamp": 1706108707, "time_this_iter_s": 12.50836181640625, "time_total_s": 1048.9966690540314, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1048.9966690540314, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.5625, "ram_util_percent": 67.07499999999999, "gpu_util_percent0": 0.345, "vram_util_percent0": 0.22467041015625}}
{"episode_reward_max": 12.863021140572442, "episode_reward_min": -14.328472494853285, "episode_reward_mean": 0.7168248612874113, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -21.206466388461916, "policy_agent_": -2.097631676494891}, "policy_reward_max": {"policy_adversary_": -4.4731545448039265, "policy_agent_": 17.03474376451718}, "policy_reward_mean": {"policy_adversary_": -11.266693206313388, "policy_agent_": 5.991759033800399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.189900813748366, -4.193630044516504, -9.832058641610235, 3.4751205528109077, -0.5534298853036492, -2.967957268970774, -8.26576137882667, -1.7998074875065906, -3.8834703353824502, 3.566561974848579, -0.01694083631549175, 1.9458275230378748, -5.108858550600479, 2.578104599953708, 0.06291060536484452, 3.1931548242850583, -5.718705795057582, -3.2644334639519483, 6.06911716663795, 5.912088192981656, 0.6342337204331434, 2.136332752903508, 1.8983049731151938, 9.867852710254516, 3.9887900714629976, 1.3459243991856678, 0.363188479549841, 0.9029167180392598, -0.029878515508523162, -6.910902792683837, -2.1162318198900887, 2.8570135079328516, -0.7617348991952897, -2.9218022361675757, -0.14139907849926692, 2.3760655019476853, 12.086341538594445, 1.3108403270572542, -1.1233687118188231, -0.6964855580849256, 2.0495563723623587, 5.750103823586965, 0.5178310935835453, -8.55984629844423, 2.9883233177744764, -2.123507910675652, 4.353551613031515, -2.4498747827410194, -6.391692600777269, 5.159799225517954, -2.4847321121975194, 7.286140889986684, -3.2784741076477726, -1.1942227422871443, 3.262898087649947, 2.842147049221465, 3.372126098761501, 0.3316117080569289, -0.6896066461250341, -6.804487873208108, 5.938814654519488, -9.988975071611517, -2.317963919654627, 4.971145891223089, 2.848146859703219, 0.4467024049406902, 1.6345515160383595, 3.7154519361708265, 1.7673734879578773, -1.6574755218659694, 3.1970051344784083, 8.359286395269883, 9.215562588029174, -0.13863741457891998, 2.997396728623222, 9.018121569393838, -2.727106323484166, 4.607847347561033, -1.2238339523039428, 10.7803144441679, 1.4075390616375125, -2.8159257044425248, 7.131093951727525, -2.6967185679694903, -8.08456197415013, -2.148077833218852, 6.768606308394974, -1.4406138482891855, -1.122410409098768, 6.414547502631451, 4.991474300374687, 0.4320812363390689, -14.328472494853285, -0.6771700654050568, 0.006197231930691882, -1.3876313320430107, 1.9233962165626162, 3.876194934057468, 5.794221435526235, -0.29969310035248853, 1.0881801433839973, -0.5471817969378667, -0.4639192130882477, 5.368698437269122, -2.0751325715244535, 7.100413748112958, -5.910796313155339, 2.1476887257150676, -1.6774095807164828, -1.2006767655989539, -6.454424352738493, -4.647133911616308, -4.001094486575023, -0.04575517964510124, 0.275657517698215, 8.851418584417413, 0.5934604571787212, 3.954815897639005, 12.863021140572442, -3.336474076346865, 2.5545085386570237, -0.5680909491840853, 0.05689822292014324, 3.152514371764397, 0.3434179096886005, 1.7525383294819639, 1.225562357708225, -2.104503594449727, -5.00507730231461, -0.35467252389141324, -0.5673039674200901, -0.941033897295023, 1.2878286067643887, 10.982734127966827, -0.5065038242614052], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.877427765638576, -4.4731545448039265, -9.821862218393605, -10.950574007587802, -12.668875980325689, -16.529934705519395, -13.247969655906846, -9.588695511811986, -7.85586247391009, -9.18618077469366, -5.838621644656883, -5.149686608158275, -8.91295459647261, -9.404984636960297, -11.856440814428602, -10.791108006436787, -6.752001635690471, -16.730315940615743, -12.23421003894121, -15.82244326129457, -13.351394235117501, -9.849863514235746, -12.814340230950155, -16.473221987981994, -13.126253925738201, -9.872127761628793, -8.977282925108964, -8.994604664354096, -9.267099819070305, -11.791722474490635, -18.80573843406771, -10.082022246574393, -5.283174777423691, -5.434895216838777, -14.083125087771522, -12.119635383133849, -19.896075572929472, -11.96155133401284, -12.318361447748755, -8.206345946989881, -7.303683492979781, -12.628475219630046, -12.756580639199711, -17.276742347799345, -12.099515310413121, -7.325970304141025, -12.300255715273437, -11.087406205892838, -18.734569685453614, -16.896561097576154, -7.3522724236787464, -17.43598753188385, -6.449617877809991, -14.048077295905026, -11.48910758808393, -15.543226275852371, -13.188201327924148, -6.278733197593591, -11.685359615040218, -10.91862219303066, -12.077566784254195, -13.86155322763076, -19.775699829612325, -11.532048804410774, -10.995979663451651, -7.18686110076365, -5.752161048627553, -15.78601006795991, -8.080090505345519, -15.327457613715087, -10.670709861673124, -15.33441323051052, -17.305969800648498, -7.362473318415374, -9.010181404163957, -16.127788012560202, -7.829111065419737, -11.17605141105891, -8.762267476917623, -15.96478979266295, -4.491213193407756, -6.903302683822899, -18.49261039476421, -12.871967316880156, -11.029524212074172, -13.687561147653895, -11.65335090458057, -5.672544136251312, -11.055725397416955, -12.65718401196907, -18.586332915509825, -6.2902289066540185, -10.133209141863508, -10.383305160473022, -14.548231827248983, -12.153329834125985, -11.744333257698033, -17.37771668074279, -10.136381052898475, -7.670153228404173, -9.31031734998432, -7.502868548954983, -9.138399028016948, -10.840305863809276, -17.70528125078619, -12.791010100512608, -8.737158221728286, -6.086670720654215, -8.898478784982938, -8.259105345016273, -12.750346559376753, -7.274165178498857, -10.183189514728836, -5.303892317393707, -9.828867514174656, -16.014474450303247, -13.813446788690818, -12.691948939283051, -21.206466388461916, -8.060504808600628, -8.923425696284731, -8.3397680916301, -7.553299534177985, -9.861277205935208, -12.128380847502028, -7.478251573383546, -12.98249929833208, -4.581313823495616, -6.542964838458383, -6.410910533368891, -5.7198566334114185, -10.812679032437368, -6.9612621386496105, -18.304338294734837, -20.347961058728934], "policy_policy_agent__reward": [12.53366428969347, 12.53366428969347, 0.13976225014371269, 0.13976225014371269, -0.005098211608313363, -0.005098211608313363, 7.2128472801993535, 7.2128472801993535, 6.057723047511019, 6.057723047511019, 6.780988718274314, 6.780988718274314, 2.491104138540089, 2.491104138540089, 3.894444012152697, 3.894444012152697, 1.9861960692638196, 1.9861960692638196, 6.376371374771123, 6.376371374771123, 2.9108404041706946, 2.9108404041706946, 3.547757065598074, 3.547757065598074, 1.9020480229360648, 1.9020480229360648, 5.991544618457004, 5.991544618457004, 5.959675709896722, 5.959675709896722, 6.992131415360922, 6.992131415360922, 0.5166479203164415, 0.5166479203164415, 6.732941238331892, 6.732941238331892, 9.151663602789581, 9.151663602789581, 10.867265727138113, 10.867265727138113, 6.992813977775318, 6.992813977775318, 5.993098133569629, 5.993098133569629, 7.356322602032674, 7.356322602032674, 13.170537349118257, 13.170537349118257, 8.5575219986006, 8.5575219986006, 5.609026080407231, 5.609026080407231, 4.670235702329402, 4.670235702329402, 4.9487606911966795, 4.9487606911966795, 4.618610651780892, 4.618610651780892, 2.4404098409033965, 2.4404098409033965, 8.344753307088808, 8.344753307088808, 6.469517877253623, 6.469517877253623, 2.2607199391142005, 2.2607199391142005, 1.2565464903355998, 1.2565464903355998, 6.970863004636128, 6.970863004636128, 7.247850442540767, 7.247850442540767, 15.991208555761956, 15.991208555761956, 6.636195830535046, 6.636195830535046, 5.597496367964965, 5.597496367964965, 3.754930194452478, 3.754930194452478, 4.676619932671069, 4.676619932671069, 9.189289521608506, 9.189289521608506, 6.6372058663916285, 6.6372058663916285, 4.358448024677559, 4.358448024677559, 7.543919314093801, 7.543919314093801, 2.601231196732686, 2.601231196732686, 8.32690366415248, 8.32690366415248, 4.318765711575908, 4.318765711575908, 6.171438542338177, 6.171438542338177, 11.02818016154705, 11.02818016154705, 2.433770155740615, 2.433770155740615, 12.361064210935266, 12.361064210935266, 1.5855718850811078, 1.5855718850811078, 6.426927276808937, 6.426927276808937, 7.37600283786694, 7.37600283786694, 9.192686662536918, 9.192686662536918, 8.280163713342825, 8.280163713342825, 3.305172452825259, 3.305172452825259, 5.497876484457591, 5.497876484457591, 2.0570671599112766, 2.0570671599112766, 9.008190719386842, 9.008190719386842, 1.9362890780096185, 1.9362890780096185, 8.728867954978849, 8.728867954978849, 8.251597347816931, 8.251597347816931, 6.922063261577434, 6.922063261577434, 3.81678175285217, 3.81678175285217, 3.6933562823329558, 3.6933562823329558, 9.750731002065367, 9.750731002065367, 4.923731996651698, 4.923731996651698, 6.834991045924559, 6.834991045924559, 6.933857498075764, 6.933857498075764, 11.8468498128902, 11.8468498128902, 13.260766194338837, 13.260766194338837, 3.611917951918227, 3.611917951918227, 6.003789066393587, 6.003789066393587, 12.572954790977022, 12.572954790977022, 2.5510023709677876, 2.5510023709677876, 7.891949379309971, 7.891949379309971, 3.769216762306841, 3.769216762306841, 13.372552118415424, 13.372552118415424, 2.9493761275226342, 2.9493761275226342, 2.043688489690187, 2.043688489690187, 12.811852173245867, 12.811852173245867, 5.087624374455332, 5.087624374455332, 1.4724811189620242, 1.4724811189620242, 5.769741657217523, 5.769741657217523, 9.210978606487775, 9.210978606487775, 2.1159651439810623, 2.1159651439810623, 4.966657494159094, 4.966657494159094, 9.535865757300257, 9.535865757300257, 11.788903607942256, 11.788903607942256, 3.361155071496543, 3.361155071496543, -2.097631676494891, -2.097631676494891, 4.853067547533982, 4.853067547533982, 7.27721452958984, 7.27721452958984, 5.3828492510414865, 5.3828492510414865, 6.833864737130323, 6.833864737130323, 10.626955807400128, 10.626955807400128, 7.965301244212358, 7.965301244212358, 3.685230064025842, 3.685230064025842, 5.199248746684157, 5.199248746684157, 3.4778433760085594, 3.4778433760085594, 4.337239907464351, 4.337239907464351, 8.104502150539199, 8.104502150539199, 7.815074339630872, 7.815074339630872, 9.945711924312784, 9.945711924312784, 1.4131809542864748, 1.4131809542864748, 4.117179723184641, 4.117179723184641, 3.610534602133227, 3.610534602133227, 3.5292142897086594, 3.5292142897086594, 3.147961103319131, 3.147961103319131, 1.3135156334412752, 1.3135156334412752, 3.091047514076907, 3.091047514076907, 2.629068568874304, 2.629068568874304, 5.052262515936436, 5.052262515936436, 12.432946517360332, 12.432946517360332, 7.20345362293477, 7.20345362293477, 8.323382418461028, 8.323382418461028, 17.03474376451718, 17.03474376451718, 2.3620153661268826, 2.3620153661268826, 5.738967117470878, 5.738967117470878, 3.885838571223007, 3.885838571223007, 3.805098878549064, 3.805098878549064, 6.506895788849802, 6.506895788849802, 6.235899378595314, 6.235899378595314, 4.615394951432755, 4.615394951432755, 7.104030828020152, 7.104030828020152, 1.2384051145229449, 1.2384051145229449, 0.7689437680718874, 0.7689437680718874, 3.0281190047387394, 3.0281190047387394, 2.5762763329956644, 2.5762763329956644, 4.93582256757117, 4.93582256757117, 4.124545372706999, 4.124545372706999, 14.643536211350828, 14.643536211350828, 9.920728617233767, 9.920728617233767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.338386991570428, "mean_inference_ms": 2.2267574175394103, "mean_action_processing_ms": 0.09778113708290392, "mean_env_wait_ms": 0.5852030094694995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 270000, "timesteps_this_iter": 0, "agent_timesteps_total": 810000, "timers": {"sample_time_ms": 12444.848, "sample_throughput": 271.197, "load_time_ms": 0.399, "load_throughput": 8462830.155, "learn_time_ms": 2056.688, "learn_throughput": 1640.987, "update_time_ms": 25.945}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 10.003806686401367, "policy_loss": 0.0010686936817364766, "vf_loss": 10.009558200836182, "vf_explained_var": 0.15099276304244996, "kl": 0.005899542986739314, "entropy": 0.6820681989192963, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.2922356188297273, "policy_loss": -0.025108010694384574, "vf_loss": 1.3238694071769714, "vf_explained_var": 0.7442136645317078, "kl": 0.006518602105232453, "entropy": 0.6530872553586959, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 270000, "num_agent_steps_sampled": 810000, "num_steps_trained": 270000, "num_agent_steps_trained": 810000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10800, "training_iteration": 80, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-05-19", "timestamp": 1706108719, "time_this_iter_s": 11.923900365829468, "time_total_s": 1060.9205694198608, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FA4310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1060.9205694198608, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.533333333333335, "ram_util_percent": 66.64000000000001, "gpu_util_percent0": 0.13200000000000003, "vram_util_percent0": 0.217578125}}
{"episode_reward_max": 13.332677676141337, "episode_reward_min": -12.929224135026836, "episode_reward_mean": 1.057828117645598, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -28.309844482129392, "policy_agent_": -3.27049655564624}, "policy_reward_max": {"policy_adversary_": -3.4000725806766736, "policy_agent_": 16.388868791844764}, "policy_reward_mean": {"policy_adversary_": -12.099887824219143, "policy_agent_": 6.57885797093237}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.031768288649553, 0.9033399268344613, 13.332677676141337, 11.091153003235492, 7.773903871809079, 6.4021924944468305, 5.316518234624315, -2.18332468186184, 1.151221691188648, 1.0969583057182342, -4.335230348869074, 1.262233706453096, -0.1946195525597398, 0.23511734976395726, 4.320677816987714, 0.8445999887298047, 6.799044541379784, 7.539415679255285, 2.062415763898268, -2.516958764342738, -1.1385816227800556, -0.24253415478518203, -6.801451724453813, -1.140761208610517, 1.5998518090433023, 0.8014800386575507, 0.47799250041150154, 0.35815724412525773, 1.2279652933492975, 3.5971867001648663, 4.8400148913677565, -4.504293221082962, 5.098945937575657, -4.0206105297014245, 4.297319088028233, 0.4150524346641556, 4.211431019803543, 2.2068560116414595, -0.8551163023213573, 5.633851578502856, 6.645614732336906, 3.949617918099273, -7.0807603317751395, 5.335569614490941, 2.0312114787273043, 2.820464390536124, 7.283526066879369, 2.2057585305084833, 1.120579015140562, 1.6614985725569416, 3.6385530277380367, 5.146566421258891, -0.9382248127091246, -7.062496159767267, 7.689356242958317, 2.5767439552030726, 1.4052873242220967, -1.4476906903784048, 3.514433597482922, 1.967375392194689, -0.1992119866152975, -3.359458155718802, 6.130995491249752, 7.975154314208058, -1.2989932897501366, -2.475285603767092, -4.079002393210508, 0.2689809541742373, 4.186203046787683, 3.129527319620981, -2.0281732252715194, 3.861098270037062, 2.6261434593945, -0.19586729975336215, -7.155724958780751, 2.7081540891803746, -6.401467655452777, -3.7772336611489408, 2.6152411754386455, -2.6523998279786944, -3.2429102005273553, 1.9930780957332335, -2.4485806303980553, 6.670278404794413, 5.105438803007145, -9.887226035984217, -1.3519554336653266, 2.5054733055991116, -1.6878228411212897, -3.9841632882049525, 0.09278309824035685, 3.218995139631408, 4.758534926391204, -0.18794884668118073, -12.929224135026836, -2.411802299325871, 4.672582988284778, 5.691328966826129, -0.7313181819833938, 2.2337372073474473, -3.8168472748404607, -2.794958095812344, 3.9247993346086174, 0.369397222720942, 2.0310173617126828, 3.0587122111427134, 0.9394371094079386, -7.092523573014591, 9.585718354852455, -9.895117695051841, 0.06763080912343922, 7.1036030689938086, 9.265178017530465, -11.72029286477435, -3.2616872150052676, 5.269260809801753, -3.743595592842955, 4.631389586087173, -4.933231273440489, 2.7154513680036736, 10.62212836050495, -4.305460310428236, 0.4891587706785284, 2.5059553792797593, -1.6466014270016256, 8.894997401474486, -3.254698925633126, 3.208421978713202, 1.0800287098985084, 0.2849181748939784, -10.737711226229013, 1.8945910156695733, 2.90280138823416, 2.2211060165068828, 4.527014740023538], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-11.864378946890653, -13.842804461548043, -19.445059907548195, -18.26183274081224, -14.606243190154375, -13.030004093754055, -14.492206149022133, -6.28069525934056, -16.540692111432115, -6.91938772786489, -20.439620971692886, -12.741016847579303, -9.382459517424435, -7.758163669440314, -10.258737748726798, -13.333487577024647, -10.769312948317426, -13.956263263601977, -7.113890188021541, -9.328426162898044, -7.520621804812694, -18.27377920971121, -10.955807072277866, -9.74623305631061, -6.498962093724502, -7.396498165281993, -11.117029323419347, -8.838968592279945, -6.98946733567867, -11.413192718831676, -12.154966745278257, -15.813654675764111, -19.305826480362175, -19.00729634351469, -9.335307590004179, -19.678601872646915, -9.999054239946002, -17.509699763287358, -7.864057372492275, -13.087187161283213, -11.68488988809184, -12.06461729607906, -14.20449645299315, -17.140792590042924, -9.07036841266245, -7.432353906194552, -13.210257982453689, -10.05837360316725, -8.89734682767255, -8.490188473651752, -13.645769063388695, -19.701316192982787, -7.133615723091213, -12.888581874041028, -13.498042573482406, -14.915969653761254, -16.473859504971525, -9.09177946250283, -10.133326740968105, -10.274630582140759, -18.67167768053455, -8.986980557271275, -18.694631398504878, -13.604553911327663, -7.292199518608768, -13.287223238596379, -4.2764461310772495, -10.483378290168918, -9.80393665321473, -12.475693896958093, -7.95146820123266, -15.360528827207148, -13.631310073426976, -16.881039826687786, -13.605541703618062, -9.537456488645788, -14.584587150490764, -4.783029270992566, -8.105794841799474, -12.139398261432708, -9.081884769041116, -11.129962016895867, -3.4000725806766736, -14.87847676258776, -15.605133599081297, -12.779364687323213, -11.436287207575626, -8.931276491215417, -14.70808833589981, -7.273081844953916, -4.565507852988201, -13.75951727111995, -14.945056130812526, -7.852841552490253, -28.309844482129392, -20.145351918213613, -12.126981157328682, -14.53427627307282, -8.06607716443896, -8.278490723231975, -6.02468355517418, -7.334146972280698, -18.42377837358933, -7.632412397307744, -11.590433226711482, -21.046840580499534, -6.547689729179042, -13.654187584523141, -22.891209159990982, -17.6079766426515, -21.02078793889976, -14.132331361472533, -16.673624628613137, -11.675975657728847, -7.831579572591958, -11.871922960188302, -14.699705709520837, -15.226347061687937, -11.195351620855543, -11.534373216745449, -18.952408344489882, -12.006819586986403, -9.602833432876423, -5.528062678769611, -13.216144515388875, -13.193579279424402, -7.075189544260574, -10.550099151214248, -10.08240807657703, -11.613533908922916, -4.19671811493653, -8.789890344799183, -11.081595070367742, -9.34772906238098, -10.786566560761942], "policy_policy_agent__reward": [8.448073617770103, 8.448073617770103, 7.373072194191254, 7.373072194191254, 16.388868791844764, 16.388868791844764, 14.676492872023868, 14.676492872023868, 11.190073530981726, 11.190073530981726, 9.716098294100444, 9.716098294100444, 9.904362191823221, 9.904362191823221, 2.0486852887393603, 2.0486852887393603, 8.845956901310382, 8.845956901310382, 4.008173016791561, 4.008173016791561, 8.0521953114119, 8.0521953114119, 7.001625277016199, 7.001625277016199, 4.593919982432348, 4.593919982432348, 3.9966405096021367, 3.9966405096021367, 7.289707782857255, 7.289707782857255, 7.089043782877226, 7.089043782877226, 8.784178744848605, 8.784178744848605, 10.747839471428628, 10.747839471428628, 4.588152975959904, 4.588152975959904, 3.405733699277652, 3.405733699277652, 3.191020091016319, 3.191020091016319, 9.015622527463016, 9.015622527463016, 2.0771776739120256, 2.0771776739120256, 4.302735923850047, 4.302735923850047, 4.049406951383903, 4.049406951383903, 4.0989891019697735, 4.0989891019697735, 5.797510911915421, 5.797510911915421, 4.598562918202601, 4.598562918202601, 4.108716314513982, 4.108716314513982, 7.50518970949827, 7.50518970949827, 8.497490818323007, 8.497490818323007, 5.654680727340578, 5.654680727340578, 12.202386208968912, 12.202386208968912, 7.493342906906629, 7.493342906906629, 6.816313339016207, 6.816313339016207, 10.046827153655537, 10.046827153655537, 7.105242629874774, 7.105242629874774, 9.858277887464405, 9.858277887464405, 3.504470535085458, 3.504470535085458, 9.360519369893034, 9.360519369893034, 9.165252310214374, 9.165252310214374, 8.007117607089164, 8.007117607089164, 3.5618680606090014, 3.5618680606090014, 11.238181102266934, 11.238181102266934, 5.550789945694876, 5.550789945694876, 5.126409148365339, 5.126409148365339, 10.246892024666533, 10.246892024666533, 6.132066066837864, 6.132066066837864, 5.008962921406558, 5.008962921406558, 5.0758435231043455, 5.0758435231043455, 8.642161045563366, 8.642161045563366, 12.42394130712084, 12.42394130712084, 3.0976954551910443, 3.0976954551910443, 2.913042857136882, 2.913042857136882, 10.59369940822036, 10.59369940822036, 8.746356804482163, 8.746356804482163, 8.939573414596811, 8.939573414596811, 3.822044386062213, 3.822044386062213, 6.823880169225515, 6.823880169225515, 6.121002987167722, 6.121002987167722, 9.236232846959627, 9.236232846959627, 2.8137612007762387, 2.8137612007762387, 12.412813444877317, 12.412813444877317, 10.789854112767859, 10.789854112767859, 2.9966031144293153, 2.9966031144293153, 5.405968817414645, 5.405968817414645, 0.09872186893337058, 0.09872186893337058, 5.376179622171579, 5.376179622171579, 6.995069850001207, 6.995069850001207, 7.8026106082895375, 7.8026106082895375, 2.9616474879805694, 2.9616474879805694, 9.610813548622106, 9.610813548622106, 8.128726766410738, 8.128726766410738, 8.342586263467211, 8.342586263467211, 3.224908372418658, 3.224908372418658, 6.122805288913083, 6.122805288913083, 4.091559747518992, 4.091559747518992, 0.5028978049218119, 0.5028978049218119, 5.360518008619058, 5.360518008619058, 4.743499216727007, 4.743499216727007, 2.91948728425688, 2.91948728425688, 6.561520056314548, 6.561520056314548, 0.47574597513931016, 0.47574597513931016, 10.77437758369109, 10.77437758369109, 10.35528620104422, 10.35528620104422, 1.4460693256695019, 1.4460693256695019, 5.042165886955149, 5.042165886955149, 5.718374898407266, 5.718374898407266, 6.510132747389263, 6.510132747389263, 1.6444592783744798, 1.6444592783744798, 2.3291454756142786, 2.3291454756142786, 8.489256205375682, 8.489256205375682, 9.851795528601865, 9.851795528601865, 3.832446352904537, 3.832446352904537, 7.690310173551272, 7.690310173551272, 8.866774809443871, 8.866774809443871, 8.399782072806731, 8.399782072806731, 10.112802619949479, 10.112802619949479, 3.667379491227784, 3.667379491227784, 5.256113965289711, 5.256113965289711, 1.1039181401668612, 1.1039181401668612, 2.2695944382341766, 2.2695944382341766, 11.174288854098977, 11.174288854098977, 4.000904810014343, 4.000904810014343, 6.810725294212084, 6.810725294212084, 12.052776395821127, 12.052776395821127, 3.74356341929349, 3.74356341929349, 3.280832005754277, 3.280832005754277, 16.238463757421712, 16.238463757421712, 3.856429473799828, 3.856429473799828, 10.5442093740116, 10.5442093740116, 10.617967215233172, 10.617967215233172, 12.9694013230718, 12.9694013230718, -0.022158603522752646, -0.022158603522752646, 2.284946178793343, 2.284946178793343, 8.570591884995029, 8.570591884995029, 5.478055058338941, 5.478055058338941, 9.928868323887553, 9.928868323887553, 3.1310601737075245, 3.1310601737075245, 7.1249122923745585, 7.1249122923745585, 14.787268352497415, 14.787268352497415, 3.8506796382790833, 3.8506796382790833, 5.045996101777477, 5.045996101777477, 4.017009029024687, 4.017009029024687, 5.784771544193624, 5.784771544193624, 11.044288340449446, 11.044288340449446, 1.9102453093137235, 1.9102453093137235, 6.879260564963725, 6.879260564963725, 5.58121839323777, 5.58121839323777, 5.9492260419084495, 5.9492260419084495, -3.27049655564624, -3.27049655564624, 5.3422406802343785, 5.3422406802343785, 6.992198229300951, 6.992198229300951, 5.784417539443927, 5.784417539443927, 7.6567906503927405, 7.6567906503927405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3379192378248661, "mean_inference_ms": 2.223983383909881, "mean_action_processing_ms": 0.09775591950802662, "mean_env_wait_ms": 0.5844512042081678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 273375, "timesteps_this_iter": 0, "agent_timesteps_total": 820125, "timers": {"sample_time_ms": 12287.836, "sample_throughput": 274.662, "load_time_ms": 0.501, "load_throughput": 6731869.888, "learn_time_ms": 2048.568, "learn_throughput": 1647.493, "update_time_ms": 26.045}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 12.44909210205078, "policy_loss": 0.004554217425175011, "vf_loss": 12.45130205154419, "vf_explained_var": 0.14709526300430298, "kl": 0.004733202023024674, "entropy": 0.676414430141449, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.2400174140930176, "policy_loss": -0.013492703065276146, "vf_loss": 1.2601525843143464, "vf_explained_var": 0.7873206198215484, "kl": 0.006162145150298897, "entropy": 0.6647263437509536, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 273375, "num_agent_steps_sampled": 820125, "num_steps_trained": 273375, "num_agent_steps_trained": 820125, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10935, "training_iteration": 81, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-05-31", "timestamp": 1706108731, "time_this_iter_s": 11.980819463729858, "time_total_s": 1072.9013888835907, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E08D62280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1072.9013888835907, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.513333333333335, "ram_util_percent": 66.62000000000002, "gpu_util_percent0": 0.09200000000000001, "vram_util_percent0": 0.219091796875}}
{"episode_reward_max": 17.313096745942488, "episode_reward_min": -14.845689884518722, "episode_reward_mean": 0.6594620916949648, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.87000191424821, "policy_agent_": -0.13320451206219003}, "policy_reward_max": {"policy_adversary_": -3.43798801510149, "policy_agent_": 20.890441776350333}, "policy_reward_mean": {"policy_adversary_": -11.693524244794618, "policy_agent_": 6.176493168244791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.9338818258159796, -0.6905392748348975, 3.647442080255018, -0.8388710590577859, 6.284251381962684, 3.807261221029555, -0.11567410957014795, 1.7786568943288967, 4.771709351348063, -6.344429810982896, -7.552464466286109, 7.808363181223214, -8.905521805694796, -1.2382883409746333, 9.784520518557557, 0.17334259432018584, 2.427687805513032, -2.587969697785928, -7.939533847534848, 7.663099535299809, -2.19744805234782, -0.47640212192162046, 1.8484849486964918, -1.2722846011171338, 4.924382112105809, 8.867966761327452, -5.102956287896488, 0.18204153910193793, 6.76950375129729, 2.949314444500212, -3.0342987604336287, 1.9405278613715975, 1.709516125777176, 0.7908571198496142, -1.4434455974869471, 3.8056763889064906, 3.355434703284604, -0.27572758832377087, -3.185895653373619, 3.275527222351813, -1.4452905833665857, -5.312177806103018, -2.2821687450161856, -0.6344448571690364, 0.2843764872266477, 4.038699785869302, -5.9118750504030455, -1.7166296841842241, 2.6090472699566107, -2.1558669734585454, -1.3332764365028758, -0.7569493489514668, 2.2554579418782033, -2.6368049615444704, 1.8896406317979433, -4.327021314548307, 7.964170366238451, -1.0933449356410672, 1.913208865998713, 3.4470677845804447, -10.857534586469317, 7.146873498880364, -4.120512089646875, 1.476885314393582, 1.453720053664121, 1.5222448750612378, -1.2271818554125529, 13.838688759983594, 10.844709598787611, 3.706694584839963, 9.064086024833852, -4.463070620554892, 1.8974222917591752, -5.939424773210172, 12.266050378210883, 0.38803163505271276, 1.171350488094837, 6.7204321309744754, -14.845689884518722, 0.8898758935458665, 0.37846056324250343, 0.3904515065487904, -7.409895786341812, 12.137482702326016, -4.39092893372853, 8.800455104665643, 5.754827232594062, 2.102557416676981, 3.266807314261174, -1.0837867765161255, -2.8665929587010033, -0.8514529446002397, -0.43404721516480627, 1.9787419076315589, 0.07749137875988893, -3.517052549117678, 1.7755030323056884, 12.968830725500089, 1.190594707406254, -3.6521579999754445, 1.634697725778743, 1.6314855903362597, -4.062378476761876, -2.6975295518551308, -6.2690708177514285, 2.2055388672067817, 8.100389583293472, -3.2063930390750133, 5.009556484351623, 3.3087759395406606, -4.039534512387725, 4.309896667390833, 0.06383924176394434, 1.255350102519253, 2.9626248315783896, 3.1702894873601206, 1.2956308645853543, 5.951032283030869, -3.8813258553279644, 0.05135750885261414, 4.257508644404306, -4.5406455987337715, -6.275259604493311, -0.24196281618835425, 0.40798102575311074, -6.714895988292781, 1.0836454265220656, 6.051128549047451, 17.313096745942488, -8.416865441213947, -3.3308904952835396, -5.105670249619423, -5.339756974930504, 0.5277285197291157, -2.217685511922121], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-8.990515136794862, -11.773771419718221, -9.801402996012028, -8.059066907350639, -12.622316099026955, -8.311365995101163, -13.67505105120938, -14.662150151166559, -18.7035970656571, -7.700207871287798, -19.609840480949824, -20.357545966668813, -15.35933737893519, -6.675702852981393, -13.392960639930328, -9.425906577080605, -11.376657785421717, -7.909198894636265, -12.190955393319488, -17.033277280754678, -10.768883929588831, -7.312916788055428, -6.807436842377026, -6.732012157868038, -13.956069239692237, -14.66871945532173, -10.050021756073296, -12.743081394843758, -11.350370993230655, -26.87000191424821, -9.433165561422479, -13.404377525847014, -13.886426198708781, -9.3248255957063, -6.646676637104565, -17.132795378916924, -11.236594271256136, -6.301687151497535, -13.834497666544035, -10.71380288023372, -9.248771313255576, -17.529971699540415, -7.9282678781498985, -13.06454011612895, -5.341059829720361, -12.175635521615973, -7.959782468364242, -10.928225398843697, -8.990199989759017, -14.87503866515713, -5.723400918608731, -7.714342680362907, -8.347187556198568, -9.40923147411572, -14.408408040963934, -8.057582039278875, -18.002399695263342, -20.97945074184779, -13.365552161802821, -9.280066220978116, -14.885712850017601, -15.601500845951579, -6.5212117252069275, -5.4203117150847975, -8.973645915154245, -10.023805769125799, -14.073600180488304, -19.658246789530125, -19.924279901993547, -17.604051231985903, -14.108638260857992, -8.130121975450066, -11.451613390936975, -6.002512075025647, -16.60557586745947, -6.58808256193596, -6.9715953436823, -11.459215021376417, -17.16433339673743, -8.645712747517274, -7.419565635464427, -7.789842894402741, -17.063660781094267, -19.68641227037648, -11.8228048004364, -14.388540587065036, -13.14156140196387, -9.643042145293109, -17.882655101867147, -5.711641540947191, -5.3153862585836995, -5.067043382065411, -9.14853855376022, -7.982846673270148, -6.780835416920208, -12.000154202280111, -8.119705749547704, -19.480809294089244, -6.086986063042948, -9.750861243720427, -10.350419184888802, -11.873655904592539, -9.243442700083975, -18.032895640165307, -9.731683913972477, -15.07534449355125, -21.951177749066105, -3.43798801510149, -14.351644224658523, -9.798965474786241, -5.813333714309551, -11.632630578439077, -4.9488094984327695, -8.514551003725911, -16.363936210683345, -12.938792017814322, -11.625930226754539, -16.505101446422163, -13.138397165401893, -8.053186533799808, -12.294268041804642, -5.745532684231369, -6.008850580368934, -10.875574170872564, -9.622743219852259, -15.48107955658585, -5.347962436116247, -22.35435611183993, -24.46778680675819, -10.682670305522274, -26.18746148150878, -14.109219576673874, -6.8415506007244336, -10.233126808269802, -6.7607377152893555], "policy_policy_agent__reward": [3.028316655489441, 3.028316655489441, 5.541616072441662, 5.541616072441662, 6.724422538133523, 6.724422538133523, 3.610097924146426, 3.610097924146426, 9.453283740494818, 9.453283740494818, 6.059313608065358, 6.059313608065358, 6.779688470819614, 6.779688470819614, 8.220403522747727, 8.220403522747727, 11.737653208502582, 11.737653208502582, 0.6778890301524519, 0.6778890301524519, 6.028688007331857, 6.028688007331857, 14.082954573946013, 14.082954573946013, 3.226907786620201, 3.226907786620201, 2.71870725600338, 2.71870725600338, 11.588740579243945, 11.588740579243945, 4.799624585700394, 4.799624585700394, 6.902172795467375, 6.902172795467375, 2.6606145984251683, 2.6606145984251683, 2.125710772892321, 2.125710772892321, 12.348188408027243, 12.348188408027243, 4.285717938620507, 4.285717938620507, 3.418257333066905, 3.418257333066905, 4.327960895536759, 4.327960895536759, 2.7298637783754525, 2.7298637783754525, 9.440225675899022, 9.440225675899022, 11.76834310832459, 11.76834310832459, 2.473532734088407, 2.473532734088407, 6.462561466972849, 6.462561466972849, 9.059937372263976, 9.059937372263976, 14.909658179374214, 14.909658179374214, 3.199433400494426, 3.199433400494426, 7.672452693609307, 7.672452693609307, 7.797971162242975, 7.797971162242975, 5.057841357777956, 5.057841357777956, 2.6016155198088105, 2.6016155198088105, 10.469235883911708, 10.469235883911708, 7.29601448727037, 7.29601448727037, 3.0129797815868824, 3.0129797815868824, 5.324301006585207, 5.324301006585207, 6.994665051292767, 6.994665051292767, 3.9017403649444957, 3.9017403649444957, 6.1088969467187, 6.1088969467187, 2.8230495665668576, 2.8230495665668576, 6.215047629479954, 6.215047629479954, 2.812718158473505, 2.812718158473505, 8.10716765374264, 8.10716765374264, 1.0239537089805972, 1.0239537089805972, 4.605797857329736, 4.605797857329736, 5.799623629857813, 5.799623629857813, 6.359585845849291, 6.359585845849291, 2.1950622410529275, 2.1950622410529275, 3.478696665705721, 3.478696665705721, 5.301322749038385, 5.301322749038385, 3.3862132562856235, 3.3862132562856235, 8.149024336380938, 8.149024336380938, 1.8652803623652836, 1.8652803623652836, 12.9832850307509, 12.9832850307509, 9.943052903103363, 9.943052903103363, 7.63938051390077, 7.63938051390077, 6.363567002779279, 6.363567002779279, 2.0140891317741443, 2.0140891317741443, 11.374187172415974, 11.374187172415974, 1.2003498177800265, 1.2003498177800265, 3.4485985147391895, 3.4485985147391895, 5.213682984409184, 5.213682984409184, 5.773025322093518, 5.773025322093518, 6.4232091625378755, 6.4232091625378755, 16.748467774756858, 16.748467774756858, 15.384494750390585, 15.384494750390585, 10.655372908412934, 10.655372908412934, 11.58636214284592, 11.58636214284592, 1.8335256774475877, 1.8335256774475877, 6.674517841348077, 6.674517841348077, 0.03154365090773966, 0.03154365090773966, 14.435813122835176, 14.435813122835176, 3.4880570984943353, 3.4880570984943353, 4.0714729158885685, 4.0714729158885685, 9.089823576175446, 9.089823576175446, 1.159321756109357, 1.159321756109357, 4.7677943205315705, 4.7677943205315705, 3.899013099353466, 3.899013099353466, 4.090147200475766, 4.090147200475766, 4.826882497376232, 4.826882497376232, 15.91194748635125, 15.91194748635125, 3.715937933353934, 3.715937933353934, 11.59449784586534, 11.59449784586534, 9.448194317278965, 9.448194317278965, 5.872799780985046, 5.872799780985046, 10.574731208064158, 10.574731208064158, 2.313927382215533, 2.313927382215533, 1.2243966499413474, 1.2243966499413474, 2.1077952187325852, 2.1077952187325852, 4.357245669297708, 4.357245669297708, 4.980794290450855, 4.980794290450855, 3.429163397840047, 3.429163397840047, 4.241550826581215, 4.241550826581215, 4.947604390926696, 4.947604390926696, 16.224820009794666, 16.224820009794666, 3.638790385224601, 3.638790385224601, 3.0493516218724923, 3.0493516218724923, 5.99255845533377, 5.99255845533377, 6.752570747464399, 6.752570747464399, 2.59053211166105, 2.59053211166105, 7.6676830441550905, 7.6676830441550905, 1.7313065481105236, 1.7313065481105236, 8.640441680379016, 8.640441680379016, 15.025783666179786, 15.025783666179786, 0.11579748801323826, 0.11579748801323826, 9.680600354505067, 9.680600354505067, 6.553870707163448, 6.553870707163448, 0.8868996009609122, 0.8868996009609122, 7.971263622914955, 7.971263622914955, 2.5063243700983566, 2.5063243700983566, 4.884950553122582, 4.884950553122582, 9.663280521130869, 9.663280521130869, 8.05454075258722, 8.05454075258722, 6.46078054566995, 6.46078054566995, 11.228066864726511, 11.228066864726511, 4.628535655036964, 4.628535655036964, 4.0522720213262104, 4.0522720213262104, 8.275888343104475, 8.275888343104475, 0.6024435427487973, 0.6024435427487973, -0.13320451206219003, -0.13320451206219003, 5.316805677342105, 5.316805677342105, 5.015362122802685, 5.015362122802685, 4.3830917841465356, 4.3830917841465356, 3.215803931319154, 3.215803931319154, 14.2027423304437, 14.2027423304437, 20.890441776350333, 20.890441776350333, 1.1329024321541639, 1.1329024321541639, 11.42828549311262, 11.42828549311262, 4.501774663527226, 4.501774663527226, 0.7508968128969656, 0.7508968128969656, 5.380427663999459, 5.380427663999459, 2.2715261016836163, 2.2715261016836163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3373882161214531, "mean_inference_ms": 2.220552329841626, "mean_action_processing_ms": 0.09768138724493423, "mean_env_wait_ms": 0.5835562807546759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 276750, "timesteps_this_iter": 0, "agent_timesteps_total": 830250, "timers": {"sample_time_ms": 12271.561, "sample_throughput": 275.026, "load_time_ms": 0.399, "load_throughput": 8463336.123, "learn_time_ms": 2049.223, "learn_throughput": 1646.966, "update_time_ms": 25.945}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005000000000000001, "total_loss": 12.140148162841797, "policy_loss": -0.013335466850548983, "vf_loss": 12.1604474067688, "vf_explained_var": 0.11787474751472474, "kl": 0.0040793425986583864, "entropy": 0.6964182496070862, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.453545296192169, "policy_loss": -0.013564333226531744, "vf_loss": 1.473612779378891, "vf_explained_var": 0.7619735360145569, "kl": 0.004657511527082836, "entropy": 0.6506825268268586, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276750, "num_agent_steps_sampled": 830250, "num_steps_trained": 276750, "num_agent_steps_trained": 830250, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11070, "training_iteration": 82, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-05-43", "timestamp": 1706108743, "time_this_iter_s": 11.7073392868042, "time_total_s": 1084.608728170395, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1084.608728170395, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.326666666666664, "ram_util_percent": 66.57333333333334, "gpu_util_percent0": 0.09400000000000003, "vram_util_percent0": 0.21673177083333334}}
{"episode_reward_max": 13.10605962258622, "episode_reward_min": -15.72241645911655, "episode_reward_mean": 0.9016451931862992, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.21947084780837, "policy_agent_": -4.248016729213478}, "policy_reward_max": {"policy_adversary_": -3.770882600676316, "policy_agent_": 16.53623021065959}, "policy_reward_mean": {"policy_adversary_": -11.180967638695057, "policy_agent_": 6.041306415940678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.703565459694325, 5.765915775281796, 0.35279433202771115, 2.8174084035800138, 10.851105792962343, -15.706658431501168, 3.033258397878823, -1.0200362868479724, -1.2798548572556394, -0.4339749287563772, -2.865766317059946, 1.7683050991812808, 13.073305457996755, 3.7507373726007187, 2.741844217172517, 5.087177073460244, 2.455633157931881, 0.5752047079414473, 1.6847796059433349, -5.382146558743418, 1.7654595066435976, -5.604842601152012, -2.426740051913956, -15.72241645911655, 6.674997601430164, 4.988818941627524, 3.2759939520109365, -0.8864575395659635, -7.113023593518114, -5.936410027475348, 0.4767756329855648, 4.39195699877934, -3.072648292638618, -1.7116322677108025, -1.8913773899935664, 0.3616322890640679, 2.3020739065148192, -7.626202021808807, -0.5764273073892083, 0.2424976885336202, 1.0765411719250269, 2.7874498424711067, 4.061779535981986, 4.609944785085549, -2.1616558125828993, -13.657432498997704, 4.007150619362909, -1.0594536561015917, 3.580071624792243, 7.880990057532261, -5.42064873660512, -2.408675076571181, 6.574719317406435, -0.6115141215158173, 2.306501913707822, 5.501723154299837, -4.894432106371461, -0.4882118116529367, 1.4048365952018886, 0.06583177223508357, -0.7244861488683687, -1.031472735367813, 0.8480774465832256, 0.5891132994101893, 0.49118647365258306, -1.5171193467385615, -3.668940134529253, -4.578612485565431, 6.912880231144743, 4.130893774563174, 4.0711197761095415, 13.10605962258622, 0.33050512387917985, 4.31928812840986, 0.20890957834302196, 2.3669694901683727, 2.6476575707511674, -2.8626170899229995, 5.994281677199021, 3.5375610941637756, 10.858500378051502, 8.901836785460542, -8.28420950688396, -5.600266030876289, 0.04253745754262003, 0.41115070247088636, 3.1558173535088425, 4.573120259925987, 0.2689457586164555, -1.2676962242553513, 10.165134366015819, -5.940873276365969, 0.40443780225128434, 0.9488614882647948, 4.457924444679192, 2.9392022156028057, 1.447421019439535, 4.09367496761798, -0.4655280180067598, 4.285887102575987, 1.9997494209562854, 7.611176829761544, -6.087849535072729, 1.0387650312856864, -2.48776334357708, -0.6790255893407493, 4.217542610677687, -0.24315709038001856, 8.15277154785223, 3.8522512091828363, 4.54427246766606, 6.403209034659548, 4.922767657615399, 0.9651407280365392, 6.126588982042291, -5.324248025037883, -6.747446216636324, -4.671972256036491, -3.222642776230773, 4.396195964350167, 2.076011474600299, 7.762791050816458, 1.8172591982958335, 4.163674140289399, 2.0672635534508346, 3.1637880628747292, 1.662472475271267, 1.4293676776162372, 7.067642565378467, -1.8775871643275304, -2.6722329127439073, -1.4205181096693886, -3.1918888547762565, -0.4228218910569965, 0.13040668173903186], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.203821016684964, -13.956882503432228, -8.96056925455655, -9.194083640334567, -16.121062863224463, -7.210624973074218, -9.781082696392119, -3.770882600676316, -10.757506275483744, -17.578311388385476, -8.469599269660783, -10.960975473651215, -17.901715097238835, -10.42666712478926, -8.963803133053238, -8.089414520490633, -10.70729290621576, -10.642541314315181, -10.975735192880776, -5.223189330399462, -8.383373800817669, -9.072156763037766, -5.005792352610234, -27.21947084780837, -11.639275802160038, -8.33710813541237, -9.247414296221452, -4.8359953422512145, -9.751884235222013, -14.381374325647863, -6.649636325803998, -13.44571610272466, -11.658631533058166, -6.565973795418333, -12.596164652044724, -6.348186784383339, -13.662497496692291, -12.951928524626767, -14.708707328181388, -11.734765252194688, -10.727446175662937, -8.989931702311635, -15.858964270013393, -12.452091634527285, -14.869958084393915, -15.275769909253581, -11.989406936634897, -12.122136323548826, -9.218388570477579, -13.239608202062172, -6.541322347237299, -11.803982127273212, -18.84874215169309, -9.931826794306458, -9.258259140540666, -12.296437101450152, -15.23325676254675, -11.271235564540673, -8.887649531453421, -9.956185975934112, -5.293852714063939, -9.37657530359539, -10.848734511233179, -9.19927975820503, -9.913784723148009, -12.213007029624475, -17.669345308279798, -14.611702092075623, -13.331849685301036, -8.028816242684476, -12.641098140490913, -19.966400798732966, -10.920217386903179, -12.598463219407671, -4.798984560391828, -10.787072493873099, -10.525303423485179, -10.893856657557672, -14.43073153639879, -10.22986532689975, -16.917039713626146, -13.506769643518927, -12.15962528000988, -12.365509737528729, -5.760683930997851, -10.320478267910882, -10.719848184761169, -11.330395370753894, -7.6346375428358275, -5.667859795463194, -20.50472254485273, -7.675291756768622, -6.653930767925329, -8.505971598750278, -11.4685732953241, -7.533862565696204, -17.080790335702297, -10.706365428597678, -15.35590668505188, -9.781151465853387, -13.844154421931645, -16.745951266525903, -8.456235643985469, -14.605802588333802, -9.352384115384632, -6.922029976930421, -17.52418099253495, -13.603116576634811, -15.910463358634114, -8.536999832773015, -10.740650857048841, -12.580809951300472, -12.297504028611673, -7.6061430870753926, -9.908898494626236, -20.243107317767173, -7.686910851751117, -8.887929587593845, -12.964014650194153, -8.052549905790865, -9.048050303060004, -16.372930232874236, -8.157449265983276, -10.416463668944113, -12.059496009076462, -8.903565982890159, -5.670360280190372, -11.685750510418252, -13.387604857928865, -9.50552357131191, -4.322127220919519, -10.028939101978832, -8.797917351680697, -12.054817198868623, -11.757029760878702], "policy_policy_agent__reward": [3.250127778495321, 3.250127778495321, 9.861399139357017, 9.861399139357017, 4.656681793292129, 4.656681793292129, 6.0057460219572905, 6.0057460219572905, 13.486084328093405, 13.486084328093405, -4.248016729213478, -4.248016729213478, 6.407170547135472, 6.407170547135472, 1.3754231569141724, 1.3754231569141724, 4.738825709114051, 4.738825709114051, 8.572168229814547, 8.572168229814547, 2.8019164763004194, 2.8019164763004194, 6.364640286416245, 6.364640286416245, 15.487510277617794, 15.487510277617794, 7.0887022486949895, 7.0887022486949895, 5.852823675112878, 5.852823675112878, 6.588295796975439, 6.588295796975439, 6.58146303207382, 6.58146303207382, 5.608873011128314, 5.608873011128314, 6.330257399412056, 6.330257399412056, -0.07947861417197832, -0.07947861417197832, 5.0744166537306326, 5.0744166537306326, 1.7336570809428775, 1.7336570809428775, 1.28952615034814, 1.28952615034814, 5.748527194345912, 5.748527194345912, 9.157136701795098, 9.157136701795098, 6.662963538519947, 6.662963538519947, 6.261704124116193, 6.261704124116193, 1.9747689013426253, 1.9747689013426253, 1.3194303208519491, 1.3194303208519491, 4.2224821490862565, 4.2224821490862565, 3.5632059793947835, 3.5632059793947835, 8.918836550752003, 8.918836550752003, 4.292991620209773, 4.292991620209773, 2.427170763853763, 2.427170763853763, 5.352393631025575, 5.352393631025575, 3.3549095367237047, 3.3549095367237047, 7.982285701603555, 7.982285701603555, 2.662863251408975, 2.662863251408975, 7.066140010396089, 7.066140010396089, 5.988631470364153, 5.988631470364153, 5.9019936737939815, 5.9019936737939815, 5.888690772391372, 5.888690772391372, 9.96037190299769, 9.96037190299769, 8.531018209806419, 8.531018209806419, 6.354151135905508, 6.354151135905508, 0.8091687051279403, 0.8091687051279403, 7.9982787779989035, 7.9982787779989035, 5.531341333723618, 5.531341333723618, 6.39923009763491, 6.39923009763491, 10.56029912979722, 10.56029912979722, 0.56033680531609, 0.56033680531609, 4.697653525351016, 4.697653525351016, 12.711730734549755, 12.711730734549755, 4.660156336395321, 4.660156336395321, 5.782380527124244, 5.782380527124244, 8.899080127874996, 8.899080127874996, 5.169412328087643, 5.169412328087643, 5.391511876443865, 5.391511876443865, 5.146243063327656, 5.146243063327656, 5.011008874084597, 5.011008874084597, 2.2846832825977854, 2.2846832825977854, 4.172551284113788, 4.172551284113788, 5.848405978908201, 5.848405978908201, 4.894196528807609, 4.894196528807609, 5.202485598400296, 5.202485598400296, 5.347943841442956, 5.347943841442956, 7.000202586875271, 7.000202586875271, 5.016544803255096, 5.016544803255096, 10.12236495822289, 10.12236495822289, 6.0798550086238246, 6.0798550086238246, 8.356108958300222, 8.356108958300222, 16.53623021065959, 16.53623021065959, 5.625361255391177, 5.625361255391177, 8.458875673908764, 8.458875673908764, 2.503947069367424, 2.503947069367424, 6.577020992020735, 6.577020992020735, 6.586480497118173, 6.586480497118173, 4.015619783817335, 4.015619783817335, 10.21250660679891, 10.21250660679891, 6.88371321053176, 6.88371321053176, 13.887770045838824, 13.887770045838824, 11.204303214489736, 11.204303214489736, 1.9377078865629622, 1.9377078865629622, 3.3826218533262162, 3.3826218533262162, 2.901610694270235, 2.901610694270235, 5.365814485190883, 5.365814485190883, 6.937832769135006, 6.937832769135006, 7.951757815339945, 7.951757815339945, 3.95179165072614, 3.95179165072614, 2.200081785603922, 2.200081785603922, 15.334928455434275, 15.334928455434275, 0.8672092402013274, 0.8672092402013274, 3.529184285088307, 3.529184285088307, 4.7274165435075375, 4.7274165435075375, 7.963248870001649, 7.963248870001649, 5.236532390649503, 5.236532390649503, 9.264105677570916, 9.264105677570916, 7.400020198107831, 7.400020198107831, 7.445189333522556, 7.445189333522556, 7.033519284214686, 7.033519284214686, 7.921951921443966, 7.921951921443966, 12.178564048143729, 12.178564048143729, 1.1841930544563708, 1.1841930544563708, 7.822283809809743, 7.822283809809743, 3.4323103859037754, 3.4323103859037754, 3.121502193794836, 3.121502193794836, 10.870861801606319, 10.870861801606319, 6.679979743127398, 6.679979743127398, 12.031617453243175, 12.031617453243175, 6.194625520977926, 6.194625520977926, 7.642461662357449, 7.642461662357449, 9.492009492980008, 9.492009492980008, 8.610135843113536, 8.610135843113536, 4.285641907555965, 4.285641907555965, 8.017743738334262, 8.017743738334262, 7.459429646364647, 7.459429646364647, 0.46973231755739575, 0.46973231755739575, 2.1079786657786785, 2.1079786657786785, 4.87068593698169, 4.87068593698169, 6.224372935070518, 6.224372935070518, 5.5620308888301535, 5.5620308888301535, 12.067860641845343, 12.067860641845343, 4.987354232139555, 4.987354232139555, 7.290068904616757, 7.290068904616757, 7.063379781263647, 7.063379781263647, 6.033677022882442, 6.033677022882442, 3.666416377730819, 3.666416377730819, 6.557559094017246, 6.557559094017246, 10.227623711653667, 10.227623711653667, 3.81396820349219, 3.81396820349219, 0.8249471540878064, 0.8249471540878064, 4.304210496154724, 4.304210496154724, 2.8030142484522194, 2.8030142484522194, 5.8159976539058125, 5.8159976539058125, 5.943718221308869, 5.943718221308869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3370763716495849, "mean_inference_ms": 2.2173276283205716, "mean_action_processing_ms": 0.09742052051733986, "mean_env_wait_ms": 0.5827630653967713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 280125, "timesteps_this_iter": 0, "agent_timesteps_total": 840375, "timers": {"sample_time_ms": 12261.607, "sample_throughput": 275.249, "load_time_ms": 0.499, "load_throughput": 6770183.175, "learn_time_ms": 2040.261, "learn_throughput": 1654.2, "update_time_ms": 26.042}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005000000000000001, "total_loss": 9.448458862304687, "policy_loss": 0.006329969828948378, "vf_loss": 9.449072933197021, "vf_explained_var": 0.17436178922653198, "kl": 0.004112236126652169, "entropy": 0.694416743516922, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005000000000000001, "total_loss": 1.299435305595398, "policy_loss": -0.013171720708487555, "vf_loss": 1.3193921327590943, "vf_explained_var": 0.7253529250621795, "kl": 0.0035711289407575507, "entropy": 0.6786526918411255, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280125, "num_agent_steps_sampled": 840375, "num_steps_trained": 280125, "num_agent_steps_trained": 840375, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11205, "training_iteration": 83, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-05-55", "timestamp": 1706108755, "time_this_iter_s": 11.779258728027344, "time_total_s": 1096.3879868984222, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A6D1A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1096.3879868984222, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 24.48125, "ram_util_percent": 66.57499999999999, "gpu_util_percent0": 0.135625, "vram_util_percent0": 0.213653564453125}}
{"episode_reward_max": 10.137019302760915, "episode_reward_min": -17.854778339578036, "episode_reward_mean": 0.4652114670880846, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.979387203793483, "policy_agent_": -0.5747296909385615}, "policy_reward_max": {"policy_adversary_": -4.617367103733732, "policy_agent_": 15.068466490183685}, "policy_reward_mean": {"policy_adversary_": -11.968098942228144, "policy_agent_": 6.216655204658114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8083420181487877, -4.138503819608157, -4.345846800056433, 1.9976435004042452, -0.11192688560937042, -1.3897217476229364, -7.154915370427393, 7.228262328534553, -7.21000605763113, 2.018978024518514, 1.5171185863364034, -3.332884862135332, 3.0743809705004703, -0.4707736570529888, -0.9057724747672309, 2.8245587906995735, 3.3074400229973335, -4.659295413351026, -0.5087815671507196, 2.422409731205843, 1.358244584195244, -15.193348762966933, 9.447994090638126, -2.717258531455606, -3.85258974110044, -0.7121363241151102, -13.231292000794504, 7.9832121978410235, 3.280626445859401, 8.079010163956921, -5.189514854241573, -1.9326678932820807, 1.6835143676295248, -3.9939722891087737, 7.7800676279935495, 0.1077891982017195, -10.442758834873104, -9.629201496796345, 3.9084761644141204, 2.2362287821010245, 1.641853290275177, -8.847362446911907, -0.6775673273962427, 2.1942190678517197, 1.2729297868280938, -7.175232702873074, -2.000832540567254, 3.3816117456941983, 1.9885083667056764, 1.09641070741137, -2.98599017268332, 1.6061539827989517, -1.873789642485045, -1.41868974972134, 7.2463106636762005, 9.38205261342057, 2.3267740260613854, 0.7421127805617912, -3.3238944352102635, 3.2560642353217117, 9.51856361607225, 4.331431039684523, 5.4214087008165475, 10.137019302760915, -2.7937405468906564, 2.1922949741525404, -2.215581546645725, 4.925810968851515, -0.3562797858237266, 4.167977569716784, 7.4643122194941185, -4.534660842332016, 2.854735704260948, 1.9925813529814955, -5.8985619560097, -2.2484811525596693, 1.0946174763876764, -8.671635715420528, 6.406465711355782, 5.266062116759749, 3.340175577572121, 1.0933190228926963, 6.099055917507925, 4.914858969755872, -2.186311991824164, -4.866613246599511, 0.9702909767530775, 1.4658585998411302, -1.3853433799241825, -2.8858514620746463, -6.054237027034272, -7.220570923958463, -17.854778339578036, 3.3964265361004387, 2.021722103433983, 0.3936597366711282, -6.411577215219699, -8.30818216057742, 1.516091891919693, 0.32362526193906804, 3.0261405561952395, -1.9817173102536467, 6.557735477931334, 3.758614153967874, -9.263683746525894, 0.7323005584251707, -3.2757939803486216, -5.19684191065217, 3.640552296740173, 3.3502237858206594, 5.351987509559181, 1.0777170697417786, 7.954820722643007, 7.356722098135376, 0.4290188612431296, 7.754581764124116, 3.9144681130717274, 7.050865550599409, 4.656765752033925, 0.8256969067896724, 3.05094245212637, -0.10430774492148731, -0.5999568460247187, -5.885880788844623, 6.019020733743071, 6.298941294493679, 5.1124545332099665, 3.7504521632107917, -0.40640767246773346, 3.695270577786995, 6.580094477258561, 3.643914190717295, 1.2166058816492036, 0.13057878123279876, 0.00960731478024568], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-16.906847723020043, -14.70084266699261, -5.844766505484608, -6.815096129643956, -15.533246819515238, -14.478876095464907, -13.600745516421577, -18.59910016347765, -6.060546675754005, -5.698814052993812, -7.575431521310017, -8.30989194785578, -9.959284628457933, -5.241202671755231, -9.849431223950281, -18.195773395816815, -10.852575523807348, -14.402989242322057, -9.774875578577454, -8.13316416650597, -8.912983717593232, -16.383352941705056, -14.921822380706269, -5.777802252081485, -7.2421244018255395, -5.264724229670064, -17.60977883716576, -11.639880927357313, -12.259118404185088, -14.741227598310854, -12.831217704315334, -10.397557320569378, -8.011633409206546, -11.433470477613211, -15.887530220727456, -7.345886910091836, -12.055226272675664, -16.530338454600184, -8.791729147430233, -12.321717462755469, -9.436643233627033, -19.40884410010453, -11.428557880202641, -9.251819491036025, -12.844618357451976, -14.218093186555341, -6.767397554138419, -10.278691049611341, -9.208072848607845, -13.025171640533783, -15.082480980237724, -11.108757747234641, -10.849830983258578, -8.999262553651969, -11.934633776423757, -17.386808031868057, -14.934011646731843, -9.038255133337167, -13.918377805976515, -14.109589574234692, -20.61836936429511, -8.35743901856625, -12.931588916670112, -16.21496335521019, -8.951850831985585, -12.717067758932464, -9.382685099316793, -17.26316596418247, -8.476375251263873, -8.607856848661855, -13.122529076528377, -6.182318589389027, -8.446774008430195, -14.14815901097208, -15.50031812254809, -9.626455605013309, -8.562162746388612, -10.626993932903371, -14.298634526365428, -19.509967042744037, -9.89792118944114, -8.962128351833002, -23.979387203793483, -11.170602051792615, -4.617367103733732, -11.791591617387013, -13.387472182532118, -8.522527428594367, -19.590669249113713, -10.295530108411405, -14.73232377270863, -8.0932154011547, -18.497724440132792, -12.320355386931963, -13.091956274723964, -13.230746880032068, -8.878373766634459, -13.546357973636832, -12.263847513666605, -4.8354745948170175, -12.196613230024125, -11.721005004954964, -18.958898765677368, -8.386773105863076, -15.38503249762237, -9.997873836668369, -18.871241452253667, -12.092462486142903, -8.09157671706339, -11.062412072692702, -17.655085023425656, -17.736967840560343, -18.898654652532734, -14.662046291777099, -16.879582615552163, -11.444491542696893, -11.145507942569287, -15.601571898023334, -13.841805779663703, -6.058818457803212, -11.806119562828894, -9.663220801827274, -6.358376321637815, -12.864307326052485, -16.066094576027883, -13.584201448548432, -12.28536476440149, -12.621742094446287, -10.196710184281393, -11.64546173289306, -11.319611012661843, -14.208835120227606, -6.471040882243769, -10.59819249815887, -5.941867205019119], "policy_policy_agent__reward": [7.549252852435626, 7.549252852435626, 5.2811694236922255, 5.2811694236922255, 0.7494598527140884, 0.7494598527140884, 4.406369815024102, 4.406369815024102, 7.710659966952932, 7.710659966952932, 6.544577173920984, 6.544577173920984, 3.2229150729970875, 3.2229150729970875, 12.913681246006098, 12.913681246006098, -0.5747296909385615, -0.5747296909385615, 3.8588960387561633, 3.8588960387561633, 4.546275053823211, 4.546275053823211, 2.488503542860224, 2.488503542860224, 6.516832799479202, 6.516832799479202, 2.385214507351121, 2.385214507351121, 4.4718293745915245, 4.4718293745915245, 10.510166093258198, 10.510166093258198, 7.080007773402341, 7.080007773402341, 4.871846914485516, 4.871846914485516, 4.633047005713367, 4.633047005713367, 5.277786948855907, 5.277786948855907, 5.135614150894238, 5.135614150894238, 0.5950020893690657, 0.5950020893690657, 12.1849082356722, 12.1849082356722, 1.5302718603129386, 1.5302718603129386, 1.6947673303625486, 1.6947673303625486, 2.2762939527774764, 2.2762939527774764, 2.1892434181856326, 2.1892434181856326, 9.811546562599167, 9.811546562599167, 7.769872425022244, 7.769872425022244, 11.410118881133888, 11.410118881133888, 3.8208514250368815, 3.8208514250368815, 4.232444713643648, 4.232444713643648, 4.847573888418035, 4.847573888418035, 3.7197490942522196, 3.7197490942522196, 11.8337989243605, 11.8337989243605, 3.726838054146778, 3.726838054146778, 0.8062337189012772, 0.8062337189012772, 3.450568478901917, 3.450568478901917, 6.3501026559221785, 6.3501026559221785, 7.278973122428245, 7.278973122428245, 5.539248261951106, 5.539248261951106, 5.280740826596311, 5.280740826596311, 5.375495276403201, 5.375495276403201, 5.723019279443872, 5.723019279443872, 7.058774072140034, 7.058774072140034, 3.521430241841133, 3.521430241841133, 2.383282506785581, 2.383282506785581, 6.830151397652771, 6.830151397652771, 5.598290607656763, 5.598290607656763, 7.060791173972577, 7.060791173972577, 6.0482454037772015, 6.0482454037772015, 6.357455865016795, 6.357455865016795, 4.488020670386766, 4.488020670386766, 3.7902864019653166, 3.7902864019653166, 9.59047222004998, 9.59047222004998, 13.384430322644315, 13.384430322644315, 8.630392836396615, 8.630392836396615, 4.890183956949481, 4.890183956949481, 5.297241685383126, 5.297241685383126, 8.6828269047782, 8.6828269047782, 15.068466490183685, 15.068466490183685, 6.344435029125387, 6.344435029125387, 9.176498808743334, 9.176498808743334, 13.175991328985557, 13.175991328985557, 3.0790551425474626, 3.0790551425474626, 7.454681366542503, 7.454681366542503, 3.583551776335534, 3.583551776335534, 11.094488466516994, 11.094488466516994, 4.060047732720073, 4.060047732720073, 6.38791720918932, 6.38791720918932, 10.29342064801125, 10.29342064801125, 0.8238288735285062, 0.8238288735285062, 5.650754856345573, 5.650754856345573, 8.070370181976788, 8.070370181976788, 4.800878083269193, 4.800878083269193, 3.6889872262268226, 3.6889872262268226, 4.828390111388144, 4.828390111388144, 0.9776791087414235, 0.9776791087414235, 10.352550118860604, 10.352550118860604, 12.38801457975189, 12.38801457975189, 6.619048383506632, 6.619048383506632, 5.0277236873628475, 5.0277236873628475, 15.0392215606507, 15.0392215606507, 8.042730510774245, 8.042730510774245, 1.2155275559547853, 1.2155275559547853, 3.4624891853937503, 3.4624891853937503, 7.1788815796425975, 7.1788815796425975, 4.994193014217748, 4.994193014217748, 9.102662934594766, 9.102662934594766, 3.704839323168379, 3.704839323168379, 4.339043372837178, 4.339043372837178, 0.4363222385981179, 0.4363222385981179, 0.32147305027737993, 0.32147305027737993, 7.858390961516199, 7.858390961516199, 7.556839189078976, 7.556839189078976, 6.812203308351598, 6.812203308351598, 1.2333982757073796, 1.2333982757073796, 2.619087906529708, 2.619087906529708, 6.8899697027931515, 6.8899697027931515, 2.5795499283780425, 2.5795499283780425, 7.61137689310968, 7.61137689310968, 4.86964384735066, 4.86964384735066, 12.758317121804348, 12.758317121804348, 6.072693629915474, 6.072693629915474, 3.0606743755482375, 3.0606743755482375, 5.365087197546768, 5.365087197546768, 7.797723735952522, 7.797723735952522, 3.4478102877453685, 3.4478102877453685, 5.86606450690178, 5.86606450690178, 7.206317929256681, 7.206317929256681, 11.503536266492423, 11.503536266492423, 9.407342455151065, 9.407342455151065, 13.42673768758787, 13.42673768758787, 11.009384194956237, 11.009384194956237, 8.654300738397646, 8.654300738397646, 9.5995366534105, 9.5995366534105, 7.529988027820511, 7.529988027820511, 11.32621872431137, 11.32621872431137, 9.249285765848812, 9.249285765848812, 3.442257682296442, 3.442257682296442, 7.428531007477632, 7.428531007477632, 4.779456528452894, 4.779456528452894, 2.879209737806549, 2.879209737806549, 3.48921326860393, 3.48921326860393, 11.04255765488548, 11.04255765488548, 9.941571371521057, 9.941571371521057, 8.698909648805728, 8.698909648805728, 8.186097128828536, 8.186097128828536, 4.89515125590683, 4.89515125590683, 7.670366155340025, 7.670366155340025, 8.9498527449602, 8.9498527449602, 8.926374655472445, 8.926374655472445, 3.8438233819464855, 3.8438233819464855, 5.364385639695832, 5.364385639695832, 2.9757372598996836, 2.9757372598996836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33754437573285934, "mean_inference_ms": 2.2212945501963697, "mean_action_processing_ms": 0.09752573077803621, "mean_env_wait_ms": 0.5836797339389057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 283500, "timesteps_this_iter": 0, "agent_timesteps_total": 850500, "timers": {"sample_time_ms": 12516.977, "sample_throughput": 269.634, "load_time_ms": 0.499, "load_throughput": 6770183.175, "learn_time_ms": 2119.01, "learn_throughput": 1592.725, "update_time_ms": 26.837}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0005000000000000001, "total_loss": 10.964946365356445, "policy_loss": 0.006059694010764361, "vf_loss": 10.965598011016846, "vf_explained_var": 0.16862610578536988, "kl": 0.004880580480342733, "entropy": 0.6711255967617035, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0005000000000000001, "total_loss": 1.291398173570633, "policy_loss": 0.001880293805152178, "vf_loss": 1.2958539009094239, "vf_explained_var": 0.7461656779050827, "kl": 0.004728406953846293, "entropy": 0.6336883813142776, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 283500, "num_agent_steps_sampled": 850500, "num_steps_trained": 283500, "num_agent_steps_trained": 850500, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11340, "training_iteration": 84, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-06-10", "timestamp": 1706108770, "time_this_iter_s": 15.404833555221558, "time_total_s": 1111.7928204536438, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1111.7928204536438, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 50.3, "ram_util_percent": 65.36842105263159, "gpu_util_percent0": 0.18421052631578946, "vram_util_percent0": 0.21892989309210525}}
{"episode_reward_max": 15.056997040659201, "episode_reward_min": -12.027076624293619, "episode_reward_mean": 0.27578520480619256, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -23.705560304939258, "policy_agent_": 0.1802977876396583}, "policy_reward_max": {"policy_adversary_": -4.355429563654532, "policy_agent_": 19.38127867279923}, "policy_reward_mean": {"policy_adversary_": -11.64715504626703, "policy_agent_": 5.961470125536611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.8661314870647766, -1.8628670607678557, 3.2816903184266835, -1.4274027408637027, 3.8967655423512157, 3.1632537275186268, 0.6916059711314265, 10.923945194685317, 0.30189413218669203, -1.2378951166194447, -3.0934459076639813, 0.3983894885063463, 1.4316266273460387, -10.558110862506906, 1.647102829736917, -9.47796005709552, -1.12240415211842, 1.9183627684475342, 2.2335557469602456, 0.03126597709107701, -2.3398881511879774, 3.4917185420034205, 1.9786489819563684, -0.6191409550397688, -5.37579728556695, 3.2337919829787105, 2.6519929954551573, -1.9310666501991554, 4.67573045400342, 1.9337645453808148, -2.7188830436397016, 5.515436033884286, -6.302665171765932, -7.658498157982218, -0.7083485632147992, -4.146995826881547, 8.162977194332543, 5.4878850720632935, -7.787071905433487, 5.935741605593918, 4.2196577212463495, 10.859410039751847, -0.43983573877896687, 3.2690633132257076, -7.123996019638422, 1.009618935122326, -7.87596108504208, -8.722827275370225, -1.3045531327573472, -6.008594884647243, 3.4332451379322895, 1.7257753135978195, -0.35822312065034523, -4.826854203765627, -4.24800333099307, 1.5486819850009304, -0.8316289826977699, 10.941421324606306, -12.027076624293619, 1.8912208051369777, -2.26542538706199, -2.494766654166206, -2.2818930719389576, -6.3582858828955775, -5.536446314532163, -3.449689504443074, 1.7523444256851275, 4.321893173056038, 7.930536852765292, 2.6634934676073727, 0.6149592223568976, -1.808439686135514, -1.7748850661802646, 2.1974241536956254, 3.944791985279462, 1.565441485110622, 3.375053215261174, -1.6863622456447092, -3.8103624938272844, -9.345286831942612, -3.9402360397916123, -1.488447029711922, 6.554889502118586, -0.753316755804953, -3.5044023446893418, 7.2092986098259395, 4.105673659438239, -2.4734931298329634, -3.043180670493761, 1.3249912500039538, 3.0856005686438532, 7.260403886542442, -2.156208552677115, 3.4588094781399903, -7.974905910964174, 6.901330491114262, 15.056997040659201, -3.035931569459464, 0.05895394572280003, 2.7144412027256815, -0.281691867051316, 2.999792112527852, 4.007019747460633, 5.629145575831646, 4.393878433201917, -0.4201871385210212, -0.8688135250781931, -0.02311518821218775, 1.4545439630905794, 5.130622998953627, -4.155144711494189, 6.660566503088857, 9.730495573498029, -8.352320394592995, 1.2368737764365878, -6.43625876691518, -2.609636251246985, 3.0887177371578662, -9.122348009578655, -0.18143486532228495, -4.239589904327402, 1.5281258759559853, 1.4096885767132392, 3.7535257849587893, 0.8716401362790962, 3.7749460584340815, 1.878759165957565, 2.2328954185853678, 2.3224005798269043, -3.9767562015879117, -5.895897170248421, 9.259032145876596, 6.605904935052961, 0.11028144404010398, -0.08313518688818776], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.279200515785693, -8.815892854871683, -13.679403472337567, -11.110228393403432, -11.326559047715204, -11.418683037407728, -15.123658505891663, -18.26676619515097, -6.380889074928907, -9.061149299079718, -10.032360706833213, -7.630898440456624, -8.136126793402235, -16.177662136400524, -10.028496765867843, -22.1207859895348, -12.375028509397394, -13.453936751840653, -8.422929081454106, -9.472974923679892, -4.833917095871629, -12.225727141682162, -12.779471207905736, -5.575236895009569, -14.121208940188161, -11.848163058630801, -7.104044045571383, -7.975469355226324, -14.749435398843485, -10.65728468263792, -11.929408781156226, -18.924978461993188, -15.991456863246418, -8.852204964973222, -7.2890428117635695, -13.030843711779276, -11.920556436634728, -13.18307783811043, -9.806943314438733, -18.022114066550245, -10.471121654335622, -17.631218098581833, -14.936656719770742, -7.368068055738377, -9.366681982466694, -11.390564271324793, -9.890570837705136, -13.463420000501653, -10.86527254555415, -13.688207247984808, -10.958515952757022, -10.259368655355928, -13.636620568872015, -10.136282925934776, -10.729188650898953, -8.744723009546123, -12.115792841424536, -16.67024451949758, -19.711177092196255, -8.126214933296383, -10.345329395402526, -13.686014731671648, -17.88599254789625, -14.285872351931166, -10.713992183423747, -6.814228824167518, -11.461891606544285, -11.45230012738812, -14.722930029372462, -7.661189923302101, -18.87793232202872, -7.127180400905835, -5.648313879653564, -6.943748384112336, -12.228628817991831, -9.393584914939101, -12.451599540560023, -7.793947721539626, -7.712203134329425, -21.13380117119365, -5.1713142805950625, -9.967038412893087, -14.472702386286555, -6.8263067093559595, -4.355429563654532, -17.812323789059658, -10.258157037524223, -21.678625840874076, -12.694780586658768, -10.309877279489998, -8.12964454948675, -22.912872619213807, -7.828032384395398, -10.046830800794748, -12.385177531780336, -18.336178648653245, -23.705560304939258, -12.366802006120338, -7.15487412724415, -6.06289618427279, -4.686486644133412, -11.317327862925112, -14.749890531584096, -11.098102883776457, -14.383377089025522, -11.673928982449047, -18.716142832186428, -5.265236050649983, -6.668314288818991, -17.307641179921855, -11.49124004242993, -12.755418020768891, -18.07459562222129, -11.068169502942862, -7.423782507413529, -9.539022887616857, -11.946651835014368, -10.026811104445631, -11.244479346064168, -13.47971060378025, -5.501788426660855, -12.732327381144472, -13.461118445077101, -12.456931911353768, -5.651927114379666, -9.111057120829365, -9.557333572480918, -7.2471061247194, -15.397505073106462, -15.3424550394292, -6.2564927455277335, -14.163968757993734, -13.430720881720992, -7.084437629308839, -7.944198021104917], "policy_policy_agent__reward": [9.206534514360458, 9.206534514360458, 3.4765128970519132, 3.4765128970519132, 8.480546895382126, 8.480546895382126, 4.841412826269865, 4.841412826269865, 7.611662295033211, 7.611662295033211, 7.290968382463175, 7.290968382463175, 7.907632238511544, 7.907632238511544, 14.595355694918142, 14.595355694918142, 3.341391603557801, 3.341391603557801, 3.9116270912301356, 3.9116270912301356, 3.4694573995846145, 3.4694573995846145, 4.014643964481485, 4.014643964481485, 4.783876710374136, 4.783876710374136, 2.809775636946811, 2.809775636946811, 5.837799797802377, 5.837799797802377, 6.321412966219637, 6.321412966219637, 5.626312178639487, 5.626312178639487, 7.6861497601440965, 7.6861497601440965, 5.328242414207176, 5.328242414207176, 4.752120450385485, 4.752120450385485, 1.2470144723418257, 1.2470144723418257, 7.85872284184279, 7.85872284184279, 7.379060094931056, 7.379060094931056, 2.4780479699849, 2.4780479699849, 4.372705827310604, 4.372705827310604, 7.540977520804755, 7.540977520804755, 4.878018520513271, 4.878018520513271, 3.0222013525135845, 3.0222013525135845, 9.712582926423453, 9.712582926423453, 6.295524614009366, 6.295524614009366, 4.605262868758262, 4.605262868758262, 12.22020724793874, 12.22020724793874, 4.844395845740241, 4.844395845740241, 0.5968534034955021, 0.5968534034955021, 3.2903471242743856, 3.2903471242743856, 4.441923942448863, 4.441923942448863, 10.041766815483635, 10.041766815483635, 9.335481455086864, 9.335481455086864, 1.009935704502619, 1.009935704502619, 11.97892783607208, 11.97892783607208, 7.345389687790987, 7.345389687790987, 14.245314069166838, 14.245314069166838, 7.248410490495888, 7.248410490495888, 5.31856568448204, 5.31856568448204, 1.121342981414136, 1.121342981414136, 6.2000916032235605, 6.2000916032235605, 1.00730487633153, 1.00730487633153, 2.370296362565712, 2.370296362565712, 4.780359706398401, 4.780359706398401, 3.8398061816687843, 3.8398061816687843, 7.1958805453446555, 7.1958805453446555, 5.992571984476874, 5.992571984476874, 6.639198724110836, 6.639198724110836, 2.654714361084573, 2.654714361084573, 3.240592659952942, 3.240592659952942, 5.146702497273525, 5.146702497273525, 5.642081929363386, 5.642081929363386, 13.805832922051943, 13.805832922051943, 3.842050233951319, 3.842050233951319, 5.008717869216678, 5.008717869216678, 4.039952004170267, 4.039952004170267, 5.595624038752722, 5.595624038752722, 7.802049737978647, 7.802049737978647, 3.9637932345177926, 3.9637932345177926, 2.5887729344457897, 2.5887729344457897, 1.682269659862221, 1.682269659862221, 6.607118016114708, 6.607118016114708, 7.887096650222079, 7.887096650222079, 11.326733441068876, 11.326733441068876, 5.162341695454736, 5.162341695454736, 9.746445772192805, 9.746445772192805, 2.659370357385161, 2.659370357385161, 1.9367144067366484, 1.9367144067366484, 4.5705862689039805, 4.5705862689039805, 8.086710401635647, 8.086710401635647, 5.4795132000248605, 5.4795132000248605, 7.913326377910598, 7.913326377910598, 3.0537927379474583, 3.0537927379474583, 1.9509203202510703, 1.9509203202510703, 5.894257169625516, 5.894257169625516, 0.6155391204017252, 0.6155391204017252, 4.239295691590583, 4.239295691590583, 10.51379594420257, 10.51379594420257, 3.036494976775503, 3.036494976775503, 0.42551360948259453, 0.42551360948259453, 12.510811199442797, 12.510811199442797, 7.181915348481232, 7.181915348481232, 9.602566355520555, 9.602566355520555, 4.825799958082505, 4.825799958082505, 5.817434264746977, 5.817434264746977, 5.6076225590653, 5.6076225590653, 15.086638252878128, 15.086638252878128, 2.8359119158591404, 2.8359119158591404, 6.752820139467366, 6.752820139467366, 2.205135810408086, 2.205135810408086, 12.618754569883754, 12.618754569883754, 19.38127867279923, 19.38127867279923, 4.665435218330437, 4.665435218330437, 3.606914036483475, 3.606914036483475, 4.388668693499233, 4.388668693499233, 2.2023973885410486, 2.2023973885410486, 7.1585599877264805, 7.1585599877264805, 9.378455139522366, 9.378455139522366, 8.363624229804053, 8.363624229804053, 9.388627761113717, 9.388627761113717, 5.626870921964013, 5.626870921964013, 8.923664653554116, 8.923664653554116, 2.6210604312188983, 2.6210604312188983, 4.061429125954784, 4.061429125954784, 11.21913208943774, 11.21913208943774, 3.6680476654678724, 3.6680476654678724, 9.707992261928874, 9.707992261928874, 13.902545597859655, 13.902545597859655, 1.3579245541749343, 1.3579245541749343, 4.330328141925058, 4.330328141925058, 1.5513820603508408, 1.5513820603508408, 4.668507791883693, 4.668507791883693, 6.557764420801748, 6.557764420801748, 1.061065668242755, 1.061065668242755, 6.649137869228983, 6.649137869228983, 0.6310992611667262, 0.6310992611667262, 7.130226628550229, 7.130226628550229, 7.4354035108951715, 7.4354035108951715, 8.10522884815628, 8.10522884815628, 3.2617836253293815, 3.2617836253293815, 6.443001589631724, 6.443001589631724, 5.718046369219241, 5.718046369219241, 4.740000771652385, 4.740000771652385, 8.859952826466682, 8.859952826466682, 5.682849418920643, 5.682849418920643, 0.1802977876396583, 0.1802977876396583, 11.711500451935164, 11.711500451935164, 10.018312908386978, 10.018312908386978, 3.597359536674471, 3.597359536674471, 3.9305314171083636, 3.9305314171083636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3377396442316368, "mean_inference_ms": 2.2220684855370667, "mean_action_processing_ms": 0.09748666302192212, "mean_env_wait_ms": 0.583917508802322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 286875, "timesteps_this_iter": 0, "agent_timesteps_total": 860625, "timers": {"sample_time_ms": 12739.129, "sample_throughput": 264.932, "load_time_ms": 0.399, "load_throughput": 8456258.065, "learn_time_ms": 2127.979, "learn_throughput": 1586.012, "update_time_ms": 27.23}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 10.402505683898926, "policy_loss": -0.0004247434932040051, "vf_loss": 10.409641075134278, "vf_explained_var": 0.18798286318778992, "kl": 0.005460742156504628, "entropy": 0.671027022600174, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.2679086327552795, "policy_loss": 0.005608009360730648, "vf_loss": 1.2684349417686462, "vf_explained_var": 0.7452738612890244, "kl": 0.004414941931697125, "entropy": 0.613474252820015, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 286875, "num_agent_steps_sampled": 860625, "num_steps_trained": 286875, "num_agent_steps_trained": 860625, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11475, "training_iteration": 85, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-06-24", "timestamp": 1706108784, "time_this_iter_s": 13.487613201141357, "time_total_s": 1125.2804336547852, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09F6B040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1125.2804336547852, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 37.81666666666666, "ram_util_percent": 66.92222222222223, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.20399305555555555}}
{"episode_reward_max": 17.452016008095992, "episode_reward_min": -16.13321906457246, "episode_reward_mean": 1.021646376644495, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.366097605838416, "policy_agent_": -4.564370502438416}, "policy_reward_max": {"policy_adversary_": -4.712021279197305, "policy_agent_": 20.9090568069672}, "policy_reward_mean": {"policy_adversary_": -11.788743062839764, "policy_agent_": 6.40519471974213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.1325217244002579, -1.0874420410956867, 7.555541882922561, 5.83580550113103, -0.8037341038191999, -2.6974707928601322, 3.3691004054094074, 2.2453809932432245, 4.398392884891216, -12.773735288189012, -0.8847755601551619, 0.9814820682711539, 3.629592755946008, 4.976313737728402, 0.9798544742227312, -6.654554993011843, 2.575037851423109, 3.912065599212969, -0.08085680005572661, 6.604127752919662, -3.883992805632994, 7.378880457420499, 2.8917622851752816, 0.4528372937437044, 2.506915591599478, 8.52500967416846, 1.202816461101116, 1.8640014704865877, -5.840550716978267, 2.5276398958671695, 3.6989513135075187, 4.411330427172912, 0.3084429179666962, 0.45821532418666533, -1.2405441439768181, 0.9498126550556055, -1.2016372536621527, 2.4393009323767845, -5.154041086200066, 0.4131309272633332, -2.8044498337712898, 0.8010493931662239, -3.2372540403582972, 2.430407659748427, -3.079808667879696, 5.106701088515137, -9.068167052733646, -5.581206158862532, 2.3469791372962328, -4.984064137347595, 12.33071422604183, -3.190997314264155, -6.190316151739112, 3.9173245535733234, 3.3520058219740383, 3.183168374599299, 1.0278164023460619, 2.375015736434921, 0.19914839289824587, 3.148905639318432, 3.186206754918361, -11.331882079732267, 0.6904359813398363, 4.2241141346674125, 1.9589467848831343, 3.0780485474240384, 3.894405124381815, 0.9951454462313958, -7.712351639972386, -3.2220890998130907, 5.002229142807077, -1.3157914922508298, -0.1023633354777238, -1.5861103705165802, 0.5338984181023496, 4.513101193271576, -3.767364704165795, -6.200648535028244, -3.362498076858594, -1.5209556261984138, 0.5294913405575318, -11.619051312162279, 3.5614009791993255, 5.948478389240534, -6.179549949798423, 4.175982419862182, -7.16979885516329, 13.362224065269796, 4.2092232309313635, 2.5660047031515996, -7.759532818807871, 0.8406870411151763, 16.56366041079536, 0.01954955587266005, -3.0874638759825404, 5.047104732564522, 0.38551858310162046, 3.378753234134397, -1.6690703527928819, 2.8249839136406893, -0.18493558007394734, -1.9422100834350007, -1.9098984892813249, 5.455935924591587, -6.684560253144738, -16.13321906457246, 7.979626281943827, 17.452016008095992, 11.333897499879606, 15.653894045909064, 4.4462219276806705, -2.7423865462338997, -0.5733497206343519, -2.611998859467584, 3.326835777647218, 11.482467064158586, -3.8880697644411555, 0.4018970485484885, 4.575977577264918, 4.304424913847728, 3.66620397674568, 4.771419583656272, 2.6387406823584136, 5.4029940397436045, 1.9121205800701602, 0.7329269230609678, -5.569385408175321, 7.206379448297076, -3.3592168257356154, -5.330137371588149, 5.169659958567054, 3.8169461924823134, 2.0392568523618264, 0.3985239952619315, 4.061331215543], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-14.168000910868505, -6.889672568894456, -13.726262205995129, -12.077850731975737, -8.898126235305261, -8.09967262247173, -9.941373808617659, -23.528775058112362, -15.527004271763206, -16.057667488714443, -7.2343319644490345, -9.421132188163615, -12.08378560169785, -16.53676964566361, -8.324694955461212, -7.715548296630298, -9.114119144008189, -12.027746318101691, -19.063374620410347, -11.508506548903645, -11.327024180552737, -15.511541155407812, -10.897966608826355, -9.608773513599248, -10.94693501846856, -16.243997794445146, -6.3291942148928015, -7.143447561270746, -8.982962732319615, -12.344400614785764, -16.22884014552805, -10.327228760879375, -5.744801904384732, -4.712021279197305, -11.646983270706752, -9.215335046231884, -5.660985898925967, -10.19117064846826, -7.329486192545896, -8.807448600142248, -10.12306758099037, -9.181056342669237, -6.719435425745429, -12.583266757827504, -17.407511347512525, -9.788146888693833, -9.138721910671272, -6.887977426711411, -6.457364780088906, -10.971879911850424, -17.123289458918947, -18.30035671524982, -19.116811223020004, -11.38351421179825, -9.053993529075951, -8.084565748686154, -5.601552346790824, -18.57541878611271, -5.01795228739603, -14.317042110742669, -12.161475438847251, -19.498643154034674, -9.98348488321243, -9.191638310522817, -12.867562338651007, -9.915826283591043, -19.153792064826863, -7.868283081080396, -12.23379415770798, -11.964759737741357, -11.958918175597676, -4.918739970371373, -17.891070464378682, -8.990874832629274, -13.76019830001079, -7.640909483157504, -7.734076235025046, -7.952209285919945, -5.32573798968133, -6.6572374319507315, -7.757399187548287, -10.579590309964015, -7.870215745796113, -17.06409637047749, -13.968856609967794, -10.178588278159953, -8.980628875233894, -20.465842637643174, -14.13083789223251, -7.3847308570822126, -13.500373990367017, -8.704045258526927, -23.38694843521569, -15.170667839595364, -12.09694913294654, -20.830705093648245, -13.338063041649027, -7.941241908953288, -8.671950897022382, -11.30925451418975, -16.9789283754127, -10.535854149778507, -18.943933951947326, -9.13481271662507, -8.661658500092116, -7.0044780596956295, -12.93173746283404, -24.366097605838416, -20.62035096539369, -21.504338835492145, -10.055143870345063, -9.11226234515272, -11.238835684084558, -12.393405978499691, -13.259967367887747, -15.92542187529914, -12.764318632957941, -7.3982108692078485, -9.218429141977701, -19.033117751195345, -14.348943474585887, -9.49943591838947, -22.907565968703942, -11.237573568056026, -6.574740394836626, -20.280356013665997, -12.575457337295044, -13.031906564513877, -6.71885041617357, -9.374863892582564, -10.042458031642653, -15.257314882358159, -13.977040762231105, -5.973177131745555, -10.621221373372748], "policy_policy_agent__reward": [7.017739593234121, 7.017739593234121, 2.9011152638993853, 2.9011152638993853, 10.640902044458846, 10.640902044458846, 8.956828116553384, 8.956828116553384, 4.04719606574303, 4.04719606574303, 2.701100914805799, 2.701100914805799, 6.655237107013534, 6.655237107013534, 12.887078025677798, 12.887078025677798, 9.962698578327212, 9.962698578327212, 1.641966100262716, 1.641966100262716, 3.174778202146936, 3.174778202146936, 5.201307128217384, 5.201307128217384, 7.856689178821928, 7.856689178821928, 10.756541691696004, 10.756541691696004, 4.652274714841971, 4.652274714841971, 0.5304966518092276, 0.5304966518092276, 5.844578497715647, 5.844578497715647, 7.96990595865733, 7.96990595865733, 9.491258910177317, 9.491258910177317, 9.056317150911655, 9.056317150911655, 3.7215156874598723, 3.7215156874598723, 11.445210806414158, 11.445210806414158, 6.8948644470008205, 6.8948644470008205, 5.030805403671475, 5.030805403671475, 6.726925305034021, 6.726925305034021, 12.38450373430681, 12.38450373430681, 3.766005337996958, 3.766005337996958, 4.503724515878667, 4.503724515878667, 1.5712060076706738, 1.5712060076706738, 7.436020255326464, 7.436020255326464, 9.96389572951778, 9.96389572951778, 7.369279594026143, 7.369279594026143, 3.0266224111757145, 3.0266224111757145, 2.585118301691985, 2.585118301691985, 5.203219563364969, 5.203219563364969, 5.0825738506437474, 5.0825738506437474, 2.2296743226319067, 2.2296743226319067, 6.315235790422522, 6.315235790422522, 1.087722553172916, 1.087722553172916, 4.610289763702791, 4.610289763702791, 3.659308873609542, 3.659308873609542, 4.991052867917727, 4.991052867917727, 1.7410906926935654, 1.7410906926935654, 7.506837208787965, 7.506837208787965, 7.163851339816413, 7.163851339816413, 7.447423988604484, 7.447423988604484, 0.035277428968812585, 0.035277428968812585, 0.6533856339244396, 0.6533856339244396, 4.402171958692568, 4.402171958692568, 2.9939078872514138, 2.9939078872514138, 14.727001842480389, 14.727001842480389, 7.55467970049283, 7.55467970049283, 6.463247535640447, 6.463247535640447, 7.650419382685785, 7.650419382685785, 6.202999675524992, 6.202999675524992, 5.633867061642727, 5.633867061642727, 3.3146843745684427, 3.3146843745684427, 10.475217261273817, 10.475217261273817, 2.608550340147138, 2.608550340147138, 8.732973875030552, 8.732973875030552, 7.67384109688281, 7.67384109688281, 4.083380537151202, 4.083380537151202, 5.3369604322761335, 5.3369604322761335, 6.707876222595115, 6.707876222595115, 7.413254561767072, 7.413254561767072, 6.4969374155075394, 6.4969374155075394, 11.524098594604341, 11.524098594604341, 4.431714263655897, 4.431714263655897, 2.260721258867796, 2.260721258867796, 4.371335318964131, 4.371335318964131, 8.480573659202381, 8.480573659202381, 1.8014742390602712, 1.8014742390602712, 8.894353564450476, 8.894353564450476, 3.702382231056346, 3.702382231056346, 7.147048359056571, 7.147048359056571, 6.077005338214541, 6.077005338214541, 1.9833557654296268, 1.9833557654296268, 0.8757803754458505, 0.8757803754458505, 0.9816199564113673, 0.9816199564113673, 2.568140902876159, 2.568140902876159, 4.143445264052911, 4.143445264052911, -0.5197305010991294, -0.5197305010991294, 5.71580836249772, 5.71580836249772, 11.506287379859009, 11.506287379859009, 3.8946533300846857, 3.8946533300846857, 7.177285349011069, 7.177285349011069, 0.9054150100353009, 0.9054150100353009, 16.914033351456485, 16.914033351456485, 9.170030561581939, 9.170030561581939, 4.975367780116906, 4.975367780116906, 2.870420585779571, 2.870420585779571, 4.772366149821052, 4.772366149821052, 19.975304423005525, 19.975304423005525, 7.595108697734011, 7.595108697734011, 4.504742628482002, 4.504742628482002, 12.938904913106382, 12.938904913106382, 6.8617908123753235, 6.8617908123753235, 5.659997571543845, 5.659997571543845, 3.501440272114751, 3.501440272114751, 7.06711921391522, 7.06711921391522, 8.396996397669376, 8.396996397669376, 4.296822033171754, 4.296822033171754, 8.517017731332999, 8.517017731332999, 7.295374320608327, 7.295374320608327, 0.9885491234736898, 0.9885491234736898, -4.564370502438416, -4.564370502438416, 10.455681872388936, 10.455681872388936, 20.9090568069672, 20.9090568069672, 15.977124232636653, 15.977124232636653, 18.579116440700602, 18.579116440700602, 7.250682899012866, 7.250682899012866, 3.1849378994594106, 3.1849378994594106, 5.332742981725105, 5.332742981725105, 4.890703559516053, 4.890703559516053, 8.293401572767484, 8.293401572767484, 13.703944469728862, 13.703944469728862, 4.438124434258395, 4.438124434258395, 3.900053958878168, 3.900053958878168, 6.897203359621312, 6.897203359621312, 11.668771332521532, 11.668771332521532, 9.007573725665782, 9.007573725665782, 7.135427751022868, 7.135427751022868, 12.773153325531176, 12.773153325531176, 8.320283803899814, 8.320283803899814, 4.243430487453393, 4.243430487453393, 10.506641468363487, 10.506641468363487, 3.5030359645598637, 3.5030359645598637, 10.119143006405471, 10.119143006405471, 1.6798167952189778, 1.6798167952189778, 2.0223632604972064, 2.0223632604972064, 7.606058995104855, 7.606058995104855, 9.537130537420236, 9.537130537420236, 8.008148807296466, 8.008148807296466, 3.1858505635037426, 3.1858505635037426, 7.341276294457876, 7.341276294457876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3375345114272076, "mean_inference_ms": 2.220087916752336, "mean_action_processing_ms": 0.09758003448190572, "mean_env_wait_ms": 0.5835404745858292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 290250, "timesteps_this_iter": 0, "agent_timesteps_total": 870750, "timers": {"sample_time_ms": 12604.616, "sample_throughput": 267.759, "load_time_ms": 0.399, "load_throughput": 8456258.065, "learn_time_ms": 2179.47, "learn_throughput": 1548.541, "update_time_ms": 26.933}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 11.550612545013427, "policy_loss": 0.00024020634009502828, "vf_loss": 11.557013416290284, "vf_explained_var": 0.15516353249549866, "kl": 0.003518188035213132, "entropy": 0.6641108632087708, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.459799700975418, "policy_loss": -0.00642617791891098, "vf_loss": 1.4725526005029679, "vf_explained_var": 0.7636659264564514, "kl": 0.006266530583448971, "entropy": 0.6327042877674103, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 290250, "num_agent_steps_sampled": 870750, "num_steps_trained": 290250, "num_agent_steps_trained": 870750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11610, "training_iteration": 86, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-06-37", "timestamp": 1706108797, "time_this_iter_s": 12.951234340667725, "time_total_s": 1138.2316679954529, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E09FF2160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1138.2316679954529, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.39375, "ram_util_percent": 66.60625, "gpu_util_percent0": 0.056875, "vram_util_percent0": 0.2028350830078125}}
{"episode_reward_max": 13.276972297112026, "episode_reward_min": -12.651513413098382, "episode_reward_mean": 0.1588659739896235, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -26.974678702241643, "policy_agent_": -2.756081352932546}, "policy_reward_max": {"policy_adversary_": -4.964333377786974, "policy_agent_": 16.25463371581975}, "policy_reward_mean": {"policy_adversary_": -11.937027722073449, "policy_agent_": 6.047946848031535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.001710055427624, 3.682303070411483, -0.957206187764015, -1.5259761299135133, 2.7711743823419206, -6.374553038743109, 0.6373606645387279, 2.778448737266225, -8.642897310526179, -0.6348407597285455, 1.6578308139723275, -7.054297742094878, 0.7944567531739462, 5.6727176853399195, 2.842754822145919, -0.35955123941112144, 0.17179931292067863, 6.803575563050252, -2.1063651509250976, -3.6819040285250173, 0.22671637160895666, 0.579808755019148, -1.0482461306566426, 3.0379481382800924, 1.7986541323497343, 1.3557286856872897, -3.0784787986254103, 3.1346121580329873, 0.026429782752492192, -1.9375421857902442, 1.2399948097290223, 0.46187935211155784, -1.7946183318178504, -0.1703280763866562, 4.0719177809101605, 2.8946209020749185, 5.5402139128452195, 1.9109121122318955, 0.25082508831791, 0.0803094864208842, -0.8032285275769635, 2.64495372767741, -0.7175363933661715, -2.4987235118248194, 3.829093868957929, 2.771352022657729, 1.5962506736927664, -9.622879594846747, 4.034591101863687, -5.6875280555299, -2.436038391826926, 1.409595674111439, 4.880249318020687, 0.026942620184084498, 0.26407304578268626, 2.0080875612225886, -5.736958355167521, 3.2407980214096637, -7.1385695443524675, 1.0473828594427754, 2.285155372555751, 2.501686136785486, 2.233784225000691, 3.379861070368912, -1.9428054278213578, 11.72649672384015, 2.16741303437362, 0.6551173458116464, 4.348973720626404, 3.6408872385280393, 10.744764063346828, 5.264647768917316, 5.6452595957267855, -2.341995911385063, 1.6517594764252623, 5.68476152235384, 1.9120691442518651, 9.49487370602395, -0.9072283042722009, 10.097048448952929, -3.829828890327967, -4.818610801145814, -3.9740703463630163, -3.359546132677938, -8.973926799561433, 7.113363900240374, -3.7157946964538424, 0.7638354653090202, 7.481060473627785, -6.255612975193525, -10.701581658152001, -0.32141109216968694, -6.98650807347186, -1.6742962043051515, -9.50584874575981, 2.9512690720978014, 2.252612478067318, -3.3466495003332843, -1.6390783622326448, 0.03539647423839154, -2.1391706534706096, -0.49311481009962344, 1.8425284275067502, 6.297188497461453, -5.779268797103943, -10.04098948231936, 2.5983299141832443, -11.858486746740583, -2.5294515546835385, 1.8147332453281886, 2.9463138899794514, 2.4126600592415746, 0.7148854863406328, 2.402189559788065, -1.7855723383938595, 0.7434777357669242, -10.591227446744664, -9.995480880446644, -5.144883150761638, 0.5426731323232001, 7.678276573612351, 5.641708526076273, -0.30101604774213125, 2.0732244586802464, 13.276972297112026, 1.254117787497429, -2.9481399275570954, -12.651513413098382, 0.6967529947703841, 6.767846359980218, -1.1909121627378148, 9.720011084456248, -9.255885426700544, 0.09429647037284422, 4.730144063148832], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-13.078626697496045, -9.837611783154394, -5.519589670685634, -13.221049435478609, -9.331611645156364, -13.342516628676977, -7.479198063454047, -6.684609806957579, -7.299381324523083, -12.419888066794147, -8.111626965252444, -14.635165304255635, -8.151258557557144, -12.682553442660318, -6.773851927110715, -9.203371191654917, -7.758251005007219, -12.566167924655149, -11.772615276489704, -6.576179005712954, -9.683158472875201, -6.623460017871462, -5.707198358590155, -8.814995866893378, -13.318032435635397, -10.756789401657143, -16.0832499048048, -11.30128379943792, -16.006884565702318, -9.057656419172693, -9.818157456325153, -6.221560015627595, -6.60612998466165, -8.952983174416866, -15.872711917859952, -11.488827817536892, -20.23210950531654, -11.071982830261584, -20.333024404578218, -11.070886993485635, -7.159683643539864, -17.30677774092867, -16.06634575648325, -7.38281122111507, -22.380343195409857, -10.028227944341824, -12.456510822866125, -11.390301130951894, -12.64536599216943, -7.78190235265879, -5.571147844820705, -12.733920738987809, -9.363554399529331, -9.527962308457463, -11.254270220261201, -10.601559009179423, -5.882897394700741, -11.661878882750063, -13.191156424366602, -21.429290569546485, -8.106539255216116, -9.681381028476617, -10.99911879782769, -10.626356820359733, -5.488013449945993, -20.16626556726451, -14.727309906505743, -13.89576269099573, -11.687516901679837, -9.044680388842462, -17.942055141371224, -23.159106438209683, -13.119964177807557, -5.522980973176741, -9.1197563006405, -13.293612319057239, -17.814535032602926, -17.29071451559229, -6.726596040709123, -21.598760612255617, -11.113798602910066, -15.604303255106249, -8.265618236084755, -9.349724949961292, -20.355757406368408, -10.972441113058121, -14.818426541148703, -11.083299446223599, -18.788861967538836, -8.799087442584355, -10.670948250901148, -9.62649596154029, -26.974678702241643, -4.964333377786974, -7.147081174172326, -10.137725036403603, -5.674060802514332, -7.550279615997087, -8.51457907871755, -5.4240817736507525, -23.170170020580137, -17.625556196101535, -7.22010681241444, -10.323328145249205, -14.480314470622837, -17.920137974025014, -11.181842942897223, -8.95023345119931, -16.925190907616344, -8.519127058186493, -9.588016783127458, -7.770352587948053, -10.901036678255547, -17.728010587460815, -13.809568201568847, -17.685831832067166, -18.183088164790963, -13.647764022815732, -12.536228830715787, -15.2848145605899, -12.481434353623564, -13.890041644809749, -12.108404325142457, -16.500071705474664, -19.232295134527472, -8.768872436806976, -21.65421571786452, -7.139350707233292, -7.535777723779654, -12.715048439906967, -15.36489342797131, -17.594585557906004, -7.8763018621852705, -5.289701837082823, -12.768303625412425], "policy_policy_agent__reward": [4.538458321034213, 4.538458321034213, 6.759957426782937, 6.759957426782937, 2.2811917414608085, 2.2811917414608085, 5.84753665278255, 5.84753665278255, 6.051393013749144, 6.051393013749144, 3.4839817949669336, 3.4839817949669336, 4.0582793639963874, 4.0582793639963874, 4.731529272111902, 4.731529272111902, -0.6717579930015459, -0.6717579930015459, 5.892523653532802, 5.892523653532802, 4.884728889612387, 4.884728889612387, 3.7904337810803774, 3.7904337810803774, 4.472857655365549, 4.472857655365549, 9.177635564000116, 9.177635564000116, 4.808303374628316, 4.808303374628316, 4.421909976121899, 4.421909976121899, 3.96502515896395, 3.96502515896395, 9.684871743852698, 9.684871743852698, 4.833125062782303, 4.833125062782303, 1.447137488593967, 1.447137488593967, 4.954937422242081, 4.954937422242081, 3.6016343864453053, 3.6016343864453053, 2.329476113966758, 2.329476113966758, 5.926472002586735, 5.926472002586735, 7.558343283992564, 7.558343283992564, 6.056259043672216, 6.056259043672216, 6.502385553089695, 6.502385553089695, 7.217947978735453, 7.217947978735453, 8.016657174227404, 8.016657174227404, 3.5600571166912247, 3.5600571166912247, 5.529076133027086, 5.529076133027086, 3.341719683869576, 3.341719683869576, 2.4057558264219012, 2.4057558264219012, 4.391327549015107, 4.391327549015107, 9.972314849385056, 9.972314849385056, 7.191724359805905, 7.191724359805905, 12.886161709080875, 12.886161709080875, 6.491447471246741, 6.491447471246741, 10.291924746448062, 10.291924746448062, 5.575598239953259, 5.575598239953259, 3.1782275579814514, 3.1782275579814514, 9.975865734303039, 9.975865734303039, 7.6744046815585385, 7.6744046815585385, 2.4420438546451253, 2.4420438546451253, 13.104718532183895, 13.104718532183895, 6.399789983499778, 6.399789983499778, 7.026380748279447, 7.026380748279447, 0.8837107680525763, 0.8837107680525763, 8.339978547016559, 8.339978547016559, 1.0471871485644448, 1.0471871485644448, 1.5675547264968888, 1.5675547264968888, 7.071758206549624, 7.071758206549624, 7.121901858775007, 7.121901858775007, 4.777452464320775, 4.777452464320775, 5.759171633021942, 5.759171633021942, 6.304823285201006, 6.304823285201006, 0.07296951976660752, 0.07296951976660752, 7.451338452079861, 7.451338452079861, 3.0262934400070685, 3.0262934400070685, 11.238336714494631, 11.238336714494631, 5.195847313885932, 5.195847313885932, 6.091533582631051, 6.091533582631051, 6.616451511414193, 6.616451511414193, 7.003108945364323, 7.003108945364323, 1.7726040110623185, 1.7726040110623185, 15.94638114555233, 15.94638114555233, 8.447361470439683, 8.447361470439683, 7.275440018403691, 7.275440018403691, 8.01824531115312, 8.01824531115312, 6.342783813685251, 6.342783813685251, 14.343409602359028, 14.343409602359028, 14.211877103563504, 14.211877103563504, 9.382611886767172, 9.382611886767172, 1.59049253089584, 1.59049253089584, 5.385757888532882, 5.385757888532882, 9.489186920705537, 9.489186920705537, 9.863302088427396, 9.863302088427396, 13.39279411080812, 13.39279411080812, 2.9096838682184623, 2.9096838682184623, 15.847904530604271, 15.847904530604271, 3.6419848562910486, 3.6419848562910486, 5.392846226980216, 5.392846226980216, 2.1457739448608706, 2.1457739448608706, 2.9950894086416793, 2.9950894086416793, 5.690915303403494, 5.690915303403494, 9.042902506649245, 9.042902506649245, 5.551315922347433, 5.551315922347433, 5.923567455766311, 5.923567455766311, 13.134961220583305, 13.134961220583305, 1.2717372336954138, 1.2717372336954138, -0.015316703625428918, -0.015316703625428918, 4.6525424346853015, 4.6525424346853015, 9.994085314384893, 9.994085314384893, 1.6450185867409117, 1.6450185867409117, -1.1793837857937388, -1.1793837857937388, 6.544497054250703, 6.544497054250703, 3.9633366402908248, 3.9633366402908248, 2.1018150578319013, 2.1018150578319013, 3.437750358242453, 3.437750358242453, 2.7297391239445723, 2.7297391239445723, 10.515499683554763, 10.515499683554763, 8.56622069300096, 8.56622069300096, 4.531317619960595, 4.531317619960595, 8.310258321355331, 8.310258321355331, 4.350522836759447, 4.350522836759447, 3.93957424585283, 3.93957424585283, 6.890086428540232, 6.890086428540232, -1.4541266477706414, -1.4541266477706414, 7.197869676466398, 7.197869676466398, 5.166930151757341, 5.166930151757341, 6.267165336553455, 6.267165336553455, 5.091506323594814, 5.091506323594814, 5.80796108229809, 5.80796108229809, 10.065100073624437, 10.065100073624437, 6.011997931587493, 6.011997931587493, 9.214654783917048, 9.214654783917048, 3.795930359023146, 3.795930359023146, 1.826141571184544, 1.826141571184544, 3.695672839977074, 3.695672839977074, 7.9137438464565495, 7.9137438464565495, 10.079855463617953, 10.079855463617953, 9.765875085443014, 9.765875085443014, 5.903694138700163, 5.903694138700163, 9.286648082077456, 9.286648082077456, 16.25463371581975, 16.25463371581975, 5.0114951121522004, 5.0114951121522004, 9.353037895153713, 9.353037895153713, -2.756081352932546, -2.756081352932546, 4.11626535927502, 4.11626535927502, 9.741447399943594, 9.741447399943594, 7.086990632616749, 7.086990632616749, 13.657298321181125, 13.657298321181125, -0.689791782257636, -0.689791782257636, 2.691999153727833, 2.691999153727833, 8.74922384428063, 8.74922384428063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33747382408790677, "mean_inference_ms": 2.2194361900576376, "mean_action_processing_ms": 0.09757237275340805, "mean_env_wait_ms": 0.583373729807377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 293625, "timesteps_this_iter": 0, "agent_timesteps_total": 880875, "timers": {"sample_time_ms": 12708.819, "sample_throughput": 265.564, "load_time_ms": 0.399, "load_throughput": 8456258.065, "learn_time_ms": 2172.49, "learn_throughput": 1553.517, "update_time_ms": 26.634}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005000000000000001, "total_loss": 11.684856033325195, "policy_loss": -0.0033032971041393466, "vf_loss": 11.695249366760255, "vf_explained_var": 0.19987487196922302, "kl": 0.005098608803168414, "entropy": 0.7090288281440735, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.4002755463123322, "policy_loss": 0.023510933481156827, "vf_loss": 1.3830327719449997, "vf_explained_var": 0.753828176856041, "kl": 0.0053320724207370105, "entropy": 0.6268423050642014, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 293625, "num_agent_steps_sampled": 880875, "num_steps_trained": 293625, "num_agent_steps_trained": 880875, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11745, "training_iteration": 87, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-06-49", "timestamp": 1706108809, "time_this_iter_s": 12.768839120864868, "time_total_s": 1151.0005071163177, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A745CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1151.0005071163177, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.89375, "ram_util_percent": 64.6625, "gpu_util_percent0": 0.046875, "vram_util_percent0": 0.21160888671875}}
{"episode_reward_max": 16.82793577960727, "episode_reward_min": -12.971076067803178, "episode_reward_mean": 1.1871978450938068, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -27.34337652452763, "policy_agent_": -2.1317208732581743}, "policy_reward_max": {"policy_adversary_": -3.481049976962278, "policy_agent_": 20.82210355072024}, "policy_reward_mean": {"policy_adversary_": -11.575689654463272, "policy_agent_": 6.38144374977854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.839136933797104, 0.5281275336664695, 10.365430403384323, 12.128371222412738, 3.309124121184836, 2.817487158935914, 0.3916397414589335, 8.884812038071654, -12.971076067803178, -1.59179237364873, 1.551742639536999, -1.201016638885967, 1.579431837138192, 0.4239595748326819, 4.242967470160746, -6.6099626331195696, -11.942452559880788, 16.82793577960727, -8.984663660912162, 0.7376589042987711, -5.5723055947384506, 0.6115655028795628, 3.5879003841998136, -1.2745559753994542, 7.810001245284661, 4.558816851175987, 4.283290548092202, -3.337144584407414, 7.787769293080003, -4.982456183309815, 1.373268209458906, -7.681003434342517, -5.959800892977526, 4.250049041670386, 2.5666459760194624, -4.686461264768098, -1.3161455599195868, 3.9494417351571767, 5.80154702117393, 6.73920534012045, -11.200821330319924, 1.4529655762025309, -12.263705634648485, 1.4839686945435275, 16.071219325303503, 5.61397716637445, 4.542968087836069, 2.230666581138446, -8.901005581545645, 2.0797790307587865, 11.735742429683546, -2.607134771343131, 5.097219930238914, 1.2021592121617093, 7.748294574953523, 7.472950741491945, 0.25970392082903954, 0.32561738263954065, 3.5299719971431283, 3.350772652626358, 3.0030381583264916, -1.3857779570205273, 0.6629843475783647, -4.5719267500515866, 0.25565757800410316, 2.1532266516366576, 2.0002967120875894, 0.6535790426961935, -1.5738934633728308, 2.5085808241733356, -0.16309239252558075, 0.06867316184689523, 5.32663121356516, -12.510097505919681, -8.483719673603604, 2.408847620846925, 2.468207337201405, 0.0037072078339561165, -4.966641116947029, 4.599059849940655, 2.7352851668128486, -0.6868490282198931, 7.105749134885509, -7.072653507326763, 6.786174090878617, -1.8539093406747338, 5.576869892008512, 2.77977644670021, 2.8449658530773516, 4.111263067843359, -0.9250721421536903, 5.359625891857574, -1.2149542493987064, 1.3314202625328264, -2.887236653081155, -2.097944385286462, -5.094087562204874, -2.270959535727808, 1.6612060744462305, 4.531805709483829, -0.8351145522800243, -4.076529629894225, 8.561212534384005, 6.212210246088732, 5.225997700476563, 2.943798623465755, -1.978430053813593, 1.6565243426075358, 0.7203885318407306, -11.306072969949534, 0.1885996488429941, -1.325162395105673, 4.008430799038732, 12.763874282803892, -1.3006283219506565, -1.3261528889622836, -0.262548080874557, 5.484917317094083, -0.3870270023207335, 12.138408318020232, 3.6259310799547246, -3.6297938759730295, -2.2945015483112274, 1.1592821903305854, 0.6954276263695536, 5.232855328408437, 1.3519322535941884, -1.968708745035506, 7.951167935464198, -4.400281739581693, 11.459883297439987, 4.428101449689712, 0.18757224665226346, -5.544226688960877, -0.32924327339278286], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-19.86270108512095, -8.797519715304924, -14.76284219064437, -27.34337652452763, -8.100839458742852, -11.508312763466229, -7.61768085646332, -18.49039971675293, -16.585501495137557, -6.946013518301157, -8.569715693100056, -18.420837008231395, -5.664376219354378, -9.677118231369288, -15.289581258318272, -8.125610519612515, -19.447559061496452, -24.816271321833224, -13.454581995163585, -13.137347630373853, -7.712942196134707, -7.6347800636588925, -11.148311432112845, -3.481049976962278, -13.266384592891674, -15.244207828024209, -14.558281746402322, -9.192409855104255, -17.640241573350195, -15.298360471622718, -7.279958135539129, -7.173640377532021, -18.90089176914839, -14.254027017072774, -9.665244362811835, -11.130277029718277, -8.733158463140011, -8.77647993282201, -11.649521300381377, -14.92241282260508, -13.083789982320397, -13.326995533716682, -8.880433867721502, -9.534709289062098, -23.399053357464418, -15.240619095702595, -12.58315360521548, -13.00605819041453, -17.59817985450877, -9.844888124246697, -21.968989038850307, -12.099064074356368, -9.536239098660042, -7.096981440670392, -13.74489478706547, -12.603964927107357, -5.9902317779257315, -8.09819511947542, -11.894824573495718, -9.328068534483613, -10.42055123264203, -10.04136037852087, -6.806187338270462, -5.761086759251479, -13.615514908878215, -10.305697282266884, -6.939274819350497, -6.84356171106669, -6.573529170519721, -19.357954253807442, -14.81857246027442, -8.385867473906547, -11.075903632881788, -8.246655759403328, -16.381573845657073, -6.9277090997034465, -8.762264783524333, -7.923998317885246, -18.473080594473753, -12.401375271440795, -7.638171770585589, -4.7679549849889264, -12.619980545938136, -6.4820412922437765, -15.801526351393798, -6.0554231427240754, -15.58244531211961, -8.544547447954777, -13.039585381246356, -11.265530427175008, -4.633628147369223, -11.252824881624885, -4.129644425421994, -7.636104653288864, -7.230607529168316, -10.434239919554068, -12.866449924701612, -8.104995032217087, -9.118892800950661, -11.583443672768306, -13.878691944175776, -8.65459343208459, -12.37203128568174, -14.923501827977626, -14.795970105471003, -13.478124469919365, -9.534568001774534, -10.373544403103022, -10.032810177449596, -13.565624713770575, -12.576985556308948, -10.873033611693952, -10.164080762746515, -18.161482953365685, -7.8862670129864245, -15.240777691732493, -9.851119184001174, -12.62559285063994, -5.46067727274553, -18.502680114270802, -11.655368180039194, -12.132997542757662, -8.735447107021617, -8.869675930802842, -13.787963820185716, -11.382915696782742, -20.98457999114368, -8.865698279907935, -14.49278644632499, -12.256102889347238, -15.441194451803765, -11.827591065649564, -4.869480687223814, -6.792900438205918, -5.681385233472081], "policy_policy_agent__reward": [16.85091900945903, 16.85091900945903, 4.662823624485697, 4.662823624485697, 12.564136297014349, 12.564136297014349, 19.73587387347019, 19.73587387347019, 5.704981789963842, 5.704981789963842, 7.162899961201072, 7.162899961201072, 4.004660298961126, 4.004660298961126, 13.687605877412283, 13.687605877412283, 1.80721271366719, 1.80721271366719, 2.6771105723262134, 2.6771105723262134, 5.060729166318525, 5.060729166318525, 8.609910184672712, 8.609910184672712, 3.6219040282462847, 3.6219040282462847, 5.050538903100985, 5.050538903100985, 9.766274364239509, 9.766274364239509, 0.7578239432464748, 0.7578239432464748, 3.7525532508078356, 3.7525532508078356, 20.82210355072024, 20.82210355072024, 2.234959167125712, 2.234959167125712, 6.937503267336315, 6.937503267336315, 1.0703183006981247, 1.0703183006981247, 4.123172783269228, 4.123172783269228, 7.368105908156328, 7.368105908156328, 1.1032470007814117, 1.1032470007814117, 10.53819291908816, 10.53819291908816, 9.901512339600098, 9.901512339600098, 9.42078614724726, 9.42078614724726, 2.9276326353484197, 2.9276326353484197, 12.714005433215101, 12.714005433215101, 5.15795214415645, 5.15795214415645, 4.326613172499018, 4.326613172499018, -0.2536815284052484, -0.2536815284052484, 6.4705454380854315, 6.4705454380854315, 9.252038029371578, 9.252038029371578, 6.115945169415649, 6.115945169415649, 3.2219078824750884, 3.2219078824750884, 3.708506451610212, 3.708506451610212, 6.362960833989592, 6.362960833989592, 8.725534160777654, 8.725534160777654, 10.830809081362768, 10.830809081362768, 0.9414843260002348, 0.9414843260002348, 7.389980554959604, 7.389980554959604, -1.691635883463487, -1.691635883463487, 5.509338991802813, 5.509338991802813, 19.735136341383964, 19.735136341383964, 10.427298131038517, 10.427298131038517, 8.563060846525774, 8.563060846525774, 7.618362385776484, 7.618362385776484, 4.348587136481565, 4.348587136481565, 5.9623335775027435, 5.9623335775027435, 16.852365734266918, 16.852365734266918, 4.74596465150662, 4.74596465150662, 7.316729514449477, 7.316729514449477, 4.14957032641605, 4.14957032641605, 10.746594681009498, 10.746594681009498, 10.03845783429966, 10.03845783429966, 3.1249678493773856, 3.1249678493773856, 4.2119062510574805, 4.2119062510574805, 7.712398285319422, 7.712398285319422, 6.339420593554985, 6.339420593554985, 6.711794695484262, 6.711794695484262, 4.32779121075017, 4.32779121075017, 3.7345858429244125, 3.7345858429244125, 0.5945800045999463, 0.5945800045999463, 6.9355862434411595, 6.9355862434411595, 6.229461966951773, 6.229461966951773, 4.469785765719043, 4.469785765719043, 3.748570376881442, 3.748570376881442, 2.499817853573446, 2.499817853573446, 10.933267538990389, 10.933267538990389, 7.327740033874418, 7.327740033874418, 4.227270317876721, 4.227270317876721, 8.201267423223477, 8.201267423223477, -2.1317208732581743, -2.1317208732581743, 3.9489270860267354, 3.9489270860267354, 4.668278360275186, 4.668278360275186, 5.61523606036287, 5.61523606036287, 3.9638527628596005, 3.9638527628596005, 6.7532197387633595, 6.7532197387633595, 8.500217560690729, 8.500217560690729, 5.186728468699218, 5.186728468699218, 2.0405529783845164, 2.0405529783845164, 9.862864840411822, 9.862864840411822, -0.295306107541492, -0.295306107541492, 11.293850221136209, 11.293850221136209, 2.100756901024671, 2.100756901024671, 10.579657602064062, 10.579657602064062, 5.662161947327493, 5.662161947327493, 7.942275617161853, 7.942275617161853, 7.688396747509184, 7.688396747509184, 1.854278002607767, 1.854278002607767, 8.30622538674123, 8.30622538674123, 1.4573450880116436, 1.4573450880116436, 4.483762457910847, 4.483762457910847, 2.17168543804358, 2.17168543804358, 4.168147767133804, 4.168147767133804, 3.8861811812483684, 3.8861811812483684, 2.9170177482446396, 2.9170177482446396, 5.390049437698445, 5.390049437698445, 8.057624691126067, 8.057624691126067, 6.521788695947874, 6.521788695947874, 2.289031901095182, 2.289031901095182, 10.466621910032874, 10.466621910032874, 10.567856037033176, 10.567856037033176, 10.010983902973782, 10.010983902973782, 8.210961546692559, 8.210961546692559, 3.7780689739804703, 3.7780689739804703, 6.015034372855281, 6.015034372855281, 5.376599354645163, 5.376599354645163, 1.1297758719105246, 1.1297758719105246, 6.38279260257597, 6.38279260257597, 4.773935608294138, 4.773935608294138, 7.086255780892619, 7.086255780892619, 15.462678618084794, 15.462678618084794, 3.292819345517883, 3.292819345517883, 6.957312401385107, 6.957312401385107, 4.794285551563309, 4.794285551563309, 9.05525508386701, 9.05525508386701, 2.536825135212398, 2.536825135212398, 15.32054421614552, 15.32054421614552, 7.640649629996961, 7.640649629996961, 4.251601833392316, 4.251601833392316, 3.220472779355196, 3.220472779355196, 5.014479060566713, 5.014479060566713, 7.241695723277633, 7.241695723277633, 8.307885512595591, 8.307885512595591, 11.168256122368932, 11.168256122368932, 3.4484947674362156, 3.4484947674362156, 11.22197719089459, 11.22197719089459, 3.927910574882771, 3.927910574882771, 13.450538874621877, 13.450538874621877, 8.127846257669638, 8.127846257669638, 2.5285264669380387, 2.5285264669380387, 0.6243368746225186, 0.6243368746225186, 2.6760709800396487, 2.6760709800396487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3369416330633308, "mean_inference_ms": 2.2155422434507837, "mean_action_processing_ms": 0.09743475750324443, "mean_env_wait_ms": 0.5823561886665204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 297000, "timesteps_this_iter": 0, "agent_timesteps_total": 891000, "timers": {"sample_time_ms": 12655.229, "sample_throughput": 266.688, "load_time_ms": 0.399, "load_throughput": 8458279.159, "learn_time_ms": 2169.522, "learn_throughput": 1555.642, "update_time_ms": 26.525}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005000000000000001, "total_loss": 10.148885345458984, "policy_loss": 0.002884086186531931, "vf_loss": 10.152888774871826, "vf_explained_var": 0.23185845613479614, "kl": 0.003171939981183826, "entropy": 0.6887289345264435, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.6352847874164582, "policy_loss": 0.007537806662730873, "vf_loss": 1.6340800404548645, "vf_explained_var": 0.7381491810083389, "kl": 0.004991546385559859, "entropy": 0.6333379566669464, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 297000, "num_agent_steps_sampled": 891000, "num_steps_trained": 297000, "num_agent_steps_trained": 891000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11880, "training_iteration": 88, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-07-01", "timestamp": 1706108821, "time_this_iter_s": 11.380244016647339, "time_total_s": 1162.380751132965, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E06B2FA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1162.380751132965, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 24.673333333333336, "ram_util_percent": 63.46666666666667, "gpu_util_percent0": 0.04733333333333333, "vram_util_percent0": 0.2109375}}
{"episode_reward_max": 9.516554408233826, "episode_reward_min": -19.444396294604992, "episode_reward_mean": -0.7955295164859807, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {"policy_adversary_": -24.822994315129698, "policy_agent_": -2.560476492049171}, "policy_reward_max": {"policy_adversary_": -4.37159068296191, "policy_agent_": 15.837812429533264}, "policy_reward_mean": {"policy_adversary_": -10.936584869576008, "policy_agent_": 5.070527676545013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8915992998480178, 6.704874727651125, -4.205880569733511, 4.494252397221239, 6.129187892969535, -1.323475198269804, -4.480012108008375, -4.385370993550307, -3.1621830627854326, 1.3379336685966812, 2.2784177545903646, 4.03458621318987, 9.516554408233826, -1.5585731401947682, -0.5453585300324277, -1.8314779445550806, -1.1756359499072815, 3.308492007116679, -3.911087898547123, -0.3572191947347899, 6.554612421345321, -2.426000858705286, 4.24800093729124, -0.343295280629889, 5.29387372323259, -4.950442805583723, -1.3608714913558932, 2.6305607244933458, 1.3703947114407584, -12.404573666380037, -0.12061212494066857, -1.6218573893257322, 2.1552836109898603, 4.153118606666964, 2.402506107576923, -3.7999271864001956, -2.1041586652138884, -6.980133175721904, 1.729010554058228, -0.07030374001567852, 1.0012061951604632, 2.8354977366481413, -0.06040746495185312, 5.847225595915577, 4.460290226759599, -1.4533058286268643, -13.806404724471827, -9.657633960231564, -4.524205244417234, 0.8542235533914309, -0.06456882209043247, 2.8364203281107607, 0.18998221148207164, -17.43472764802971, 5.6044111343412695, -0.8011636140556571, 6.8526305439368365, -0.6188456418376624, 5.801584060009672, 4.4819900378899025, 2.140571474120021, -2.938397614464241, -6.318727182605882, -1.7082804024180844, 0.9482537741682442, 2.4326747296047273, -6.359174831447364, 0.3571358070729975, 0.3283172923269995, -0.41105504771554224, -7.8341589989910405, 2.2821990590906767, 0.7927751702223813, -4.446812692099327, -1.3715382761203496, 0.6730287453375292, 0.9463984170395698, -4.810101558940297, -2.16274032916655, -7.826811336806519, -9.716052720876515, -3.736840398379694, -4.936033233761132, -19.444396294604992, 2.282540475169405, -1.1899477015648336, 0.8680597704028936, -1.0666567413602586, -5.0428349865212665, -9.265760414872435, 2.2043052701051757, 3.5120969595405045, 3.975921851211909, -0.32287762172766066, -3.1195567124427317, -1.0542920977848858, -3.235068750247203, 1.9083107273389164, -2.7504515685191344, -3.0625301880928983, 6.030463694286125, 6.373433217797432, 3.7484507419796724, -2.443779984817416, -5.720178960546049, 8.614084973088785, 0.9132778577388883, 1.0349847884641237, -8.409449028928039, -0.9791426520906845, -2.6083334468183073, -3.6228718573633585, -1.3255563383954065, -3.2115605819665114, -5.02202009187628, -5.44092731771684, 5.420185831492934, 1.1279464036071138, -0.7215211318232526, -5.664026940648237, 2.4658763999044586, -3.548975441606118, 4.591630195461462, 4.036958791090007, -1.9496815844573363, 7.750081519410258, -13.530610745517865, 0.6099292446049911, -0.06731426584457217, -1.3328789846273863, -2.420965846060237, 0.8572800594438239, 0.10217647583886524, -1.6757678490192975, 1.4250174419280863], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_policy_adversary__reward": [-7.46962642052332, -13.9621596382473, -7.631795861327825, -11.895637890569185, -16.024676246286585, -6.692391799283316, -8.34150265481768, -11.943188156392067, -9.441978570495039, -11.211488973587603, -13.524594141522671, -14.315414294858204, -18.71036774727086, -7.742190143461585, -4.623429392167808, -6.222049898776864, -11.791312518790955, -11.778775358798455, -11.336327392820055, -10.794241678563276, -20.63086851874099, -16.817411355674388, -10.069098722825114, -7.216944316133204, -15.056369564428568, -6.031178876382563, -8.409249867682197, -7.925075450039394, -12.015174644325272, -14.801131584435863, -6.274207064153045, -6.407980098618745, -8.192712627307948, -10.947692228216075, -14.3085992374165, -10.835007887152774, -17.244380717726063, -14.259704742057064, -10.359876781245795, -8.27513467099144, -6.240760077084365, -11.069634093781744, -9.341626115884194, -12.806841534361704, -12.185223422767107, -7.205468465303638, -17.78906210790054, -4.7956458440312, -10.951735108180216, -6.715611433363347, -7.044572852967431, -12.333715895458871, -4.945715480694969, -12.313774663931373, -10.366441322637005, -4.39784813764339, -24.822994315129698, -6.628930791283098, -11.742690705964202, -12.554598587513379, -8.129023438311238, -10.329253839124815, -10.657595225878167, -6.796114584303271, -10.217310735166839, -9.549027746940483, -12.714584316482362, -6.693530934681031, -19.243788008665536, -5.894367129638235, -19.53993821224531, -17.233076807992298, -8.419043315095324, -14.618732786243012, -6.523369219402786, -4.37159068296191, -8.005241105516008, -10.452197483258859, -7.004568869839801, -6.092878853975699, -14.286649922947001, -10.918410259275651, -8.541255652284276, -24.370245733135917, -8.88661097297392, -7.206986223037138, -6.449473834274538, -10.375882425586822, -12.406129662177005, -19.783322433157178, -20.293312204101014, -13.714357275785154, -17.126043526859583, -8.698240147367724, -10.192434301827502, -8.426165134995351, -7.245870744602095, -7.67662004317045, -5.307564836454716, -16.767594565631075, -16.251743609784803, -13.505144067844705, -11.327038829340673, -7.023966630682185, -14.549948724698027, -19.96896420161448, -8.830557922659494, -10.139556462468905, -9.576344562090632, -12.58727310916584, -11.810100045825381, -12.58374964654747, -9.38839631331814, -11.500015982691675, -11.239820226769119, -13.121149005174091, -14.919651256957803, -6.920408347214771, -10.377159567155326, -13.850555951870382, -9.89141869809557, -5.27264597633914, -13.499572379298654, -10.458870416615376, -5.470261668547981, -14.965367727926072, -14.756410517714635, -10.568823939178204, -5.598943391077131, -14.694085340163081, -8.586189256787932, -10.02943754572306, -10.130543319257551, -6.879764258232336, -7.222836608568123], "policy_policy_agent__reward": [2.7890135603376507, 2.7890135603376507, 10.333517182949212, 10.333517182949212, 1.7129576457971571, 1.7129576457971571, 8.194945143895216, 8.194945143895216, 11.076932069628057, 11.076932069628057, 2.6844583005067553, 2.6844583005067553, 1.930745273404653, 1.930745273404653, 3.7789085814208803, 3.7789085814208803, 3.1398977538548016, 3.1398977538548016, 6.274711321092143, 6.274711321092143, 7.901505948056516, 7.901505948056516, 9.175000254024038, 9.175000254024038, 14.113461077752342, 14.113461077752342, 3.091808501633408, 3.091808501633408, 2.0390354310676906, 2.0390354310676906, 2.195285977110892, 2.195285977110892, 5.307838284441836, 5.307838284441836, 7.543633682957568, 7.543633682957568, 3.7126197471364693, 3.7126197471364693, 5.218511241914243, 5.218511241914243, 13.592740470043157, 13.592740470043157, 7.195705248484552, 7.195705248484552, 7.158549830058176, 7.158549830058176, 3.4368245177516563, 3.4368245177516563, 10.175121643830579, 10.175121643830579, 0.5403680353994205, 0.5403680353994205, 3.5241891881631524, 3.5241891881631524, 5.277818087266369, 5.277818087266369, 6.692784677883015, 6.692784677883015, 1.1982789590279106, 1.1982789590279106, 3.076797469606188, 3.076797469606188, 2.393061354646507, 2.393061354646507, 5.173998119148907, 5.173998119148907, 7.550405417441522, 7.550405417441522, 8.355552672496708, 8.355552672496708, 3.517540350376288, 3.517540350376288, 7.570111026256088, 7.570111026256088, 3.6397857831675777, 3.6397857831675777, 6.0444436676520095, 6.0444436676520095, 4.102415465487881, 4.102415465487881, 3.6209831361224136, 3.6209831361224136, 6.952565915214945, 6.952565915214945, 4.64060932546617, 4.64060932546617, 9.327033565138642, 9.327033565138642, 8.322756824763355, 8.322756824763355, 2.8760813183383864, 2.8760813183383864, 1.991328691714356, 1.991328691714356, -2.430994058100177, -2.430994058100177, 3.2137649318814905, 3.2137649318814905, 3.7849174933773906, 3.7849174933773906, 3.4900020154385003, 3.4900020154385003, 7.585068111784817, 7.585068111784817, 2.5678488460885207, 2.5678488460885207, -2.560476492049171, -2.560476492049171, 7.985426228489138, 7.985426228489138, 1.7983422617938665, 1.7983422617938665, 15.837812429533264, 15.837812429533264, 3.005042574722718, 3.005042574722718, 8.772137382986937, 8.772137382986937, 8.518294312701642, 8.518294312701642, 5.134797456215632, 5.134797456215632, 3.695428112330286, 3.695428112330286, 2.169434021636144, 2.169434021636144, 2.543917090942592, 2.543917090942592, 5.582782254667541, 5.582782254667541, 5.990851238272605, 5.990851238272605, 3.1777047425175007, 3.1777047425175007, 3.525333370877016, 3.525333370877016, 9.78605265049627, 9.78605265049627, 2.741656040961346, 2.741656040961346, 5.852889606627136, 5.852889606627136, 9.757637933541488, 9.757637933541488, 4.605909242658853, 4.605909242658853, 5.085960047071844, 5.085960047071844, 2.575915471641219, 2.575915471641219, 2.5223097141497197, 2.5223097141497197, 4.475819761277788, 4.475819761277788, 2.821047962159281, 2.821047962159281, 2.4209142703366267, 2.4209142703366267, -0.8669662414154111, -0.8669662414154111, 2.2852986010352416, 2.2852986010352416, 3.5907849304479798, 3.5907849304479798, 1.8026112092615696, 1.8026112092615696, 2.462924719265459, 2.462924719265459, 5.584575724071662, 5.584575724071662, 3.0085192607361515, 3.0085192607361515, 3.658766802338716, 3.658766802338716, 4.65461284211328, 4.65461284211328, 3.6816473378278696, 3.6816473378278696, 5.25878100914237, 5.25878100914237, 11.248808737103094, 11.248808737103094, 8.613227117662829, 8.613227117662829, 10.550982689035742, 10.550982689035742, 4.187681262820031, 4.187681262820031, 3.536438794692383, 3.536438794692383, 3.685936518605233, 3.685936518605233, 2.0054009971774467, 2.0054009971774467, 4.792465385254683, 4.792465385254683, 1.2785566339677912, 1.2785566339677912, 6.85253218876909, 6.85253218876909, 11.141103652035467, 11.141103652035467, 9.939288642821065, 9.939288642821065, 7.5377447856601725, 7.5377447856601725, 2.290093322932385, 2.290093322932385, 4.414884882075989, 4.414884882075989, 14.291524587351637, 14.291524587351637, 4.871917890199191, 4.871917890199191, 5.5872706254665125, 5.5872706254665125, 0.5834477665812929, 0.5834477665812929, 5.80406522853758, 5.80406522853758, 4.600883299503537, 4.600883299503537, 4.480438894592053, 4.480438894592053, 4.031419987461366, 4.031419987461366, 4.14422770036258, 4.14422770036258, 3.1089000674464176, 3.1089000674464176, 3.840110843728626, 3.840110843728626, 10.169918544225368, 10.169918544225368, 4.024177375410943, 4.024177375410943, 4.827819217666037, 4.827819217666037, 4.093264505611073, 4.093264505611073, 6.178647549000011, 6.178647549000011, 0.86183526736651, 0.86183526736651, 9.045601287380057, 9.045601287380057, 7.247914603852692, 7.247914603852692, 1.7602900420453227, 1.7602900420453227, 11.357724623668163, 11.357724623668163, 0.6128998860983844, 0.6128998860983844, 5.5893765918915985, 5.5893765918915985, 2.7658145626162804, 2.7658145626162804, 6.680603177767848, 6.680603177767848, 3.0826117053638478, 3.0826117053638478, 5.443358802583443, 5.443358802583443, 5.116359897548209, 5.116359897548209, 2.6019982046065193, 2.6019982046065193, 4.3239270252481035, 4.3239270252481035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33639657528519545, "mean_inference_ms": 2.2117398053017165, "mean_action_processing_ms": 0.09723025378777576, "mean_env_wait_ms": 0.5813507684455381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 300375, "timesteps_this_iter": 0, "agent_timesteps_total": 901125, "timers": {"sample_time_ms": 12544.981, "sample_throughput": 269.032, "load_time_ms": 0.399, "load_throughput": 8458279.159, "learn_time_ms": 2157.205, "learn_throughput": 1564.525, "update_time_ms": 27.12}, "info": {"learner": {"policy_adversary_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005000000000000001, "total_loss": 9.415897941589355, "policy_loss": -0.0035823776735924183, "vf_loss": 9.42653865814209, "vf_explained_var": 0.23566153049468994, "kl": 0.0036460108758472167, "entropy": 0.7058463096618652, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}, "policy_agent_": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1.1818763852119445, "policy_loss": 0.020759164029732345, "vf_loss": 1.1674238324165345, "vf_explained_var": 0.7393215090036392, "kl": 0.006042373124740791, "entropy": 0.6306753426790237, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300375, "num_agent_steps_sampled": 901125, "num_steps_trained": 300375, "num_agent_steps_trained": 901125, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 12015, "training_iteration": 89, "trial_id": "81809_00000", "experiment_id": "8d7c1ecd8827428ea9a524656a6e1c8f", "date": "2024-01-24_16-07-12", "timestamp": 1706108832, "time_this_iter_s": 11.322940111160278, "time_total_s": 1173.7036912441254, "pid": 9000, "hostname": "DESKTOP-L4Q8HQN", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 355, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_adversary"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["adversary_0", "agent_0", "agent_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_adversary", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"policy_adversary_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}], "policy_agent_": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", "Dict(obs:Box([-100. -100. -100. -100. -100. -100. -100. -100. -100. -100.], [100. 100. 100. 100. 100. 100. 100. 100. 100. 100.], (10,), float32))", "Discrete(5)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000022E0A745670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1173.7036912441254, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.746666666666663, "ram_util_percent": 63.220000000000006, "gpu_util_percent0": 0.25266666666666665, "vram_util_percent0": 0.21080729166666667}}
