{"episode_reward_max": -8.599522203207044, "episode_reward_min": -355.77119946479803, "episode_reward_mean": -298.2745698108328, "episode_len_mean": 77.27731092436974, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {"shared_policy": -131.02047721544903}, "policy_reward_max": {"shared_policy": -2.715416183074325}, "policy_reward_mean": {"shared_policy": -99.42485660361093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.12347022071486, -335.61470828950405, -308.68504959344864, -34.78988096863034, -309.08409079909325, -277.2277816236019, -324.03062346577644, -315.72739099711185, -301.0454806089402, -319.684020370245, -308.9184941351414, -303.8332355320454, -300.90083542466164, -304.831693649292, -298.8598071783781, -304.642508096993, -285.8796368688345, -282.34326277673244, -312.0937588363886, -307.37744760513306, -294.8785643875599, -324.27800349891186, -312.05981063842773, -294.4161004991038, -328.829683855176, -322.38028767704964, -317.31143325567245, -298.14225470647216, -316.8959826827049, -322.3634605705738, -298.6971586048603, -321.4131893515587, -337.42646682262426, -320.6184658706188, -314.3768536821008, -317.24675863981247, -326.89846831187606, -317.0384932756424, -310.1988801136613, -304.08587454259396, -286.71844267845154, -317.49098614929244, -54.73172165453436, -309.80141341686254, -327.2634828090668, -47.99001559615135, -300.0152600854635, -319.20969845727086, -313.2827659994364, -300.71893686056137, -311.58781492710114, -299.1117788553238, -285.5312155485153, -319.53805172443396, -330.7749572992325, -295.99592941999435, -322.41340769827366, -306.2495508491993, -315.21585063636303, -317.0336962938309, -303.79801793396473, -296.83022651076317, -303.7198702991009, -278.4164280369878, -303.37404745072126, -309.0936760082841, -323.31699538230896, -303.63529583811766, -347.31464326381683, -8.599522203207044, -304.4773561581969, -311.2581517547369, -305.79747000336647, -315.82186967134476, -312.5856178551913, -283.19185853004456, -312.2508981432766, -309.3584155291319, -314.4256395995617, -304.15923823416233, -322.3271215558052, -305.58623314090073, -292.2278060019016, -322.68636697530746, -287.12873713672167, -304.30038446187973, -316.8107763826847, -304.4645738899708, -306.3511047363281, -289.23574341088533, -313.28703558444977, -289.71487399190664, -50.0072785690427, -298.4377470910549, -314.6405572593212, -320.3739729523659, -332.1583528518677, -300.9203933477402, -321.8684898763895, -316.68907104432583, -305.82892221957445, -306.417770370841, -324.4702680706978, -288.03249025344854, -316.72391164302826, -336.2766542136669, -310.32087174057966, -292.89943447709084, -330.0904189944267, -307.64200073666876, -301.6595204807818, -335.90458619594574, -309.1444371007383, -283.75433453917503, -355.77119946479803, -297.8541174903512, -326.6585802435875, -286.32212832570076, -285.3359572738409], "episode_lengths": [57, 67, 62, 300, 63, 75, 64, 65, 82, 62, 72, 76, 73, 68, 60, 102, 81, 99, 57, 57, 66, 44, 66, 60, 72, 66, 57, 69, 45, 63, 89, 65, 96, 64, 63, 80, 53, 116, 60, 55, 66, 91, 300, 50, 77, 300, 50, 44, 52, 78, 68, 59, 80, 72, 104, 57, 61, 55, 72, 59, 53, 69, 60, 69, 62, 52, 68, 70, 73, 300, 71, 91, 52, 81, 62, 68, 54, 50, 62, 60, 63, 57, 166, 57, 73, 65, 59, 86, 65, 71, 70, 61, 300, 62, 92, 66, 58, 80, 71, 41, 89, 50, 41, 63, 73, 67, 67, 80, 65, 46, 53, 53, 72, 68, 75, 56, 61, 66, 75], "policy_shared_policy_reward": [-101.28274655838808, -100.97053886329135, -114.8701847990354, -117.46036539475124, -105.92416914800803, -112.2301737467448, -110.28338766098022, -98.60441601276398, -99.79724591970444, -11.209758025904506, -11.787098189195007, -11.79302475353083, -112.14961669842403, -98.6953198115031, -98.23915428916614, -87.80651874343555, -100.15425823132198, -89.2670046488444, -114.27036698659262, -104.08767264087996, -105.6725838383039, -109.54853304227194, -103.75066034992537, -102.42819760491452, -96.78677492340407, -107.01468997200331, -97.24401571353278, -101.79637842377028, -113.21365036567053, -104.6739915808042, -109.8452443877856, -99.22727460662524, -99.84597514073054, -98.24206378062567, -96.92499618728957, -108.66617556413016, -97.11376523971558, -107.63510486483574, -96.15196532011032, -95.40371046463649, -99.31611226002376, -110.11187092463176, -96.47648319602013, -94.92726780474186, -107.45605617761612, -97.9262988989552, -108.32261491318545, -98.39359428485236, -102.57969397306442, -90.85988487303257, -92.4400580227375, -91.09587037563324, -102.05097132921219, -89.19642107188702, -98.90275069574515, -110.16893805066745, -103.022070089976, -110.47889316082001, -97.09031575918198, -99.80823868513107, -94.74189020196597, -105.52124522129695, -94.61542896429698, -116.53522580862045, -104.40317958593369, -103.33959810435772, -100.74360237518947, -100.44839308659236, -110.86781517664592, -106.72939364115398, -93.74528849454752, -93.94141836340229, -117.16221078236899, -106.03360666831335, -105.63386640449366, -103.04659829537074, -116.38925210634868, -102.94443727533023, -102.21502751111984, -102.3607750236988, -112.7356307208538, -99.2867056032022, -101.4388190706571, -97.41673003261289, -102.22254576285681, -112.91376175483069, -101.75967516501746, -102.04364336530368, -102.71254680554073, -117.60727039972942, -96.02992566426596, -107.07811625798544, -95.58911668260893, -114.4492264688015, -104.5383814573288, -102.42558142542839, -109.82269432147345, -108.73511697848639, -118.8686555226644, -112.95873593290648, -102.31236930688223, -105.34736063083014, -99.74532531450193, -113.65116951862971, -100.98035884896915, -110.53305407365164, -100.4240976770719, -106.28960688908896, -119.25037745634715, -103.2623917820553, -104.38569907347362, -100.61316384871802, -100.77778174479803, -115.64754768212637, -102.33040142059326, -97.66179344803095, -110.20668524503708, -108.92759151260059, -97.15474917987983, -98.00353385011356, -102.98885462681453, -91.36436356107394, -92.36522449056308, -99.71842847345397, -115.10784339904785, -102.66471427679062, -18.03059648722411, -18.656080439686782, -18.04504472762347, -99.22953312595686, -111.74055000146231, -98.83133028944334, -115.43676604827246, -104.98580803473791, -106.84090872605643, -15.47179326415062, -15.678110420703888, -16.840111911296844, -95.55194587508838, -95.44285439948241, -109.02045981089275, -100.79437794163823, -115.37974685430527, -103.03557366132736, -99.92920099198818, -101.3765980899334, -111.9769669175148, -107.47915852069855, -97.172772616148, -96.06700572371483, -99.03259002168974, -113.66772242387137, -98.88750248154005, -95.62304550409317, -95.3199320435524, -108.16880130767822, -92.34354213873546, -91.54410854975383, -101.64356486002605, -102.57808156808218, -102.5409252246221, -114.41904493172964, -112.41780889034271, -114.41705924272537, -103.9400891661644, -106.82249770561855, -94.22285870711009, -94.95057300726573, -103.56317075093588, -116.2672367890676, -102.58300015827021, -97.9157024025917, -109.78754335641861, -98.54630509018898, -101.22612971067429, -113.54724961519241, -100.44247131049633, -112.70031158129375, -101.42482701937358, -102.90855769316356, -95.22694785892963, -110.93043398857117, -97.64063608646393, -106.20779619614284, -95.04879743854205, -95.57363287607829, -98.24495241045952, -108.83163511753082, -96.64328277111053, -88.19101035346588, -89.42656319340071, -100.79885449012122, -96.46630300333103, -109.53443797429404, -97.37330647309622, -98.34312022477388, -99.45793506503105, -111.29262071847916, -114.73346408208212, -103.68760283788046, -104.8959284623464, -97.0851591428121, -109.99868603547415, -96.55145065983137, -111.54801468054454, -124.30628816286723, -111.46034042040507, -2.715416183074325, -2.977479552229255, -2.9066264679034646, -95.71608037004869, -99.90400318304698, -108.85727260510127, -111.34097218513489, -99.1099788993597, -100.80720067024231, -97.33616573611896, -111.80345384279887, -96.65785042444865, -100.36268815398216, -114.68280375003815, -100.77637776732445, -112.4738236864408, -100.47268595298132, -99.63910821576914, -91.18382781744003, -101.3983365893364, -90.60969412326813, -101.7316423257192, -99.12338642341396, -111.39586939414343, -98.39648651580016, -112.168996433417, -98.79293257991473, -99.92370250821114, -112.66898441314697, -101.83295267820358, -97.5124429812034, -108.9356453617414, -97.71114989121756, -104.28188097476959, -103.79883062839508, -114.24640995264053, -99.03595542907715, -110.06983643770218, -96.4804412741214, -93.37622066338858, -92.97758971651396, -105.87399562199911, -103.77045425772667, -103.80306395888329, -115.11284875869751, -92.80739330252013, -91.00479588409266, -103.31654795010886, -97.91086641947429, -109.13289306561153, -97.25662497679393, -101.53365314503512, -114.02869321902594, -101.24843001862368, -98.29151234030724, -108.1782797574997, -97.99478179216385, -97.41451647877693, -110.02178829908371, -98.91479995846748, -103.65061767896017, -91.76699605335793, -93.81812967856726, -100.3282439907392, -112.02146889766058, -100.93732269605002, -93.58836258451144, -92.18971273551385, -103.93679867188136, -16.03449195126693, -15.963544281820461, -18.009242335955307, -95.32419583201408, -95.72170531749725, -107.39184594154358, -101.17815497517586, -112.20691043138504, -101.25549185276031, -113.415707051754, -102.94840723276138, -104.0098586678505, -107.43667755524318, -117.461578587691, -107.26009670893352, -106.73758671681087, -96.53470710913341, -97.64809952179591, -103.52358826994896, -115.31039261817932, -103.03450898826122, -101.6542293826739, -113.98639790217082, -101.04844375948112, -97.31039530783892, -109.42570853233337, -99.09281837940216, -97.92755608260632, -110.20242941379547, -98.28778487443924, -104.39765424529712, -103.85217637817065, -116.22043744723003, -91.92642786105475, -92.0661715467771, -104.03989084561667, -101.62369788686435, -114.107454876105, -100.99275888005893, -108.77051693201065, -108.22191086411476, -119.2842264175415, -110.94847156604132, -99.68586220343909, -99.68653797109923, -93.91459819674492, -93.62940263748169, -105.35543364286423, -105.70821352799734, -118.15436758597693, -106.22783788045248, -99.03245334823927, -111.38636936744055, -97.22317802098891, -96.1530201099813, -109.07710129022598, -96.42939908057451, -110.60989097754161, -106.96904913584392, -118.32564608256023, -106.70884495973587, -94.7267773412168, -107.70881479978561, -90.00691228111586, -102.1356318195661, -91.6117904384931, -111.76380346218745, -112.98691878716151, -131.02047721544903, -95.91020569205284, -107.22078651189804, -94.72312528640032, -104.53222471475601, -117.5617687702179, -104.56458675861359, -92.13315427303314, -91.01116314530373, -103.17781090736389, -90.90009948114555, -92.30903206268947, -102.1268257300059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19357208249008867, "mean_inference_ms": 0.7183083599908024, "mean_action_processing_ms": 0.0981910224241519, "mean_env_wait_ms": 0.8072033073275859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 9594, "timesteps_this_iter": 0, "agent_timesteps_total": 28782, "timers": {"sample_time_ms": 17553.338, "sample_throughput": 546.563, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3135.057, "learn_throughput": 3060.231, "update_time_ms": 8.505}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 4495.950744628906, "policy_loss": -0.0035580427505479406, "vf_loss": 4496.010314941406, "vf_explained_var": 0.00021294504404067993, "kl": 0.004235148779116635, "entropy": 5.702523171901703, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9594, "num_agent_steps_sampled": 28782, "num_steps_trained": 9594, "num_agent_steps_trained": 28782}, "done": false, "episodes_total": 119, "training_iteration": 1, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-43-37", "timestamp": 1706190217, "time_this_iter_s": 20.681602716445923, "time_total_s": 20.681602716445923, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03552160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20.681602716445923, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.316666666666668, "ram_util_percent": 47.97666666666667}}
{"episode_reward_max": 5.111939348280416, "episode_reward_min": -621.6731807589531, "episode_reward_mean": -302.25211888248094, "episode_len_mean": 75.92561983471074, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {"shared_policy": -218.28034599622092}, "policy_reward_max": {"shared_policy": 2.2447648023565563}, "policy_reward_mean": {"shared_policy": -100.75070629416031}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-285.581821590662, -293.69678658246994, -293.7783218920231, -322.20072907209396, -301.62065747380257, -294.4215037114918, -330.4195073544979, -317.5110862404108, -301.7932826578617, -310.3951364085078, -271.5587181299925, -332.8493351340294, -314.51808872818947, -313.09779320284724, -331.90816885232925, -306.55574998259544, -321.5795167684555, -327.9078175127506, 5.111939348280416, -319.16858506202703, -311.72107791900635, -324.92731841653585, -294.267560236156, -329.1340432614088, -59.9605592340231, -318.7909843623638, -42.0483593605459, -301.73832063376904, -332.9474702179432, -300.9114837348462, -295.74423138797283, -291.76359547674656, -293.3895787447691, -311.2517166733742, -331.9663291275502, -310.651395380497, -296.4871708974242, -297.55978974699974, -313.7118267863989, -288.39281833171844, -621.6731807589531, -316.0158580392599, -329.199501901865, -302.82912028580904, -293.19930651783943, -300.51095051690936, -281.41979652270675, -321.90023769438267, -304.498388312757, -321.85222816467285, -312.42618602514267, -320.20457234978676, -298.4051032960415, -324.4574301168323, -311.9648346453905, -274.71319046616554, -331.56518125534063, -298.209211319685, -52.36283401399851, -308.5151640996337, -314.7929028868675, -311.62980131804943, -321.6896396577358, -303.7637863457203, -304.05161118041724, -314.4090559631586, -308.4290079474449, -319.06148324906826, -302.6100488603115, -322.8756857216358, -325.2248267233372, -341.24700409173965, -310.87581557035446, -295.191035091877, -315.3892511874438, -300.70863784849644, -319.41025386614274, -296.7883593291044, -359.089038386941, -324.9939861893654, -332.2385338842869, -316.28659051656723, -300.2299842275679, -296.74184037745005, -306.43779745697975, -313.28951624035835, -308.13527062535286, -324.9971305131912, -316.92809411883354, -306.9075794070959, -313.15688598155975, -305.4045941531658, -294.1997263431549, -299.1286075860262, -329.3137728124857, -310.1254979595542, -296.18454129621387, -316.79943481273955, -285.6163266468793, -305.5332456808537, -329.3042419999838, -315.44355634599924, -309.035323837772, -308.35156297683716, -69.75008662045, -327.04458713531494, -278.6692605018616, -333.2245788574219, -316.182461977005, -337.9555596411228, -303.2458597123623, -303.275407448411, -318.62896198034286, -313.5843705534935, -299.6297116577625, -288.1577600464225, -311.8643206655979, -307.39669930934906, -311.35062113404274, -322.89406287670135, -318.89261420443654], "episode_lengths": [69, 69, 67, 63, 89, 64, 64, 73, 57, 59, 97, 65, 51, 58, 56, 78, 51, 68, 300, 53, 52, 73, 70, 71, 300, 61, 300, 60, 62, 56, 90, 59, 80, 62, 63, 83, 73, 75, 61, 89, 59, 56, 63, 56, 58, 54, 81, 67, 61, 59, 76, 60, 65, 81, 45, 77, 53, 52, 300, 54, 53, 75, 71, 64, 48, 46, 45, 66, 73, 65, 39, 64, 85, 61, 67, 74, 39, 92, 99, 92, 93, 65, 65, 89, 52, 76, 41, 72, 62, 74, 83, 74, 66, 82, 61, 68, 76, 52, 89, 53, 58, 48, 65, 68, 300, 47, 65, 66, 88, 84, 85, 63, 54, 47, 58, 62, 113, 64, 59, 59, 55], "policy_shared_policy_reward": [-91.91213208436966, -89.75422236323357, -103.91546714305878, -93.6632726987203, -107.60271592934927, -92.43079795440039, -93.59748137493929, -106.28470142682394, -93.89613909025988, -104.73113342126211, -114.94069619973502, -102.52889945109686, -103.94269899527232, -99.26209048430125, -98.415867994229, -101.1822772026062, -97.49404713511467, -95.74517937377095, -105.42213053504626, -106.45107672611873, -118.54630009333293, -116.57089312871298, -100.73453848560652, -100.20565462609133, -109.03264190753302, -96.21493797500929, -96.54570277531943, -99.79610576232275, -99.18309326221546, -111.41593738396963, -98.44165080785751, -87.0491615831852, -86.06790573894978, -106.73786840836208, -107.57287792364757, -118.53858880201976, -101.75855016708374, -97.8267597258091, -114.93277883529663, -99.6080212990443, -98.98730327809851, -114.50246862570445, -116.7155213356018, -106.26540821790695, -108.9272392988205, -109.53164271513621, -99.00436557332675, -98.01974169413249, -103.19265671571097, -115.28178640206656, -103.10507365067801, -117.96331355969112, -104.80165640513103, -105.1428475479285, 1.7641300459702762, 2.2447648023565563, 1.1030444999535831, -113.8041077454885, -102.57358490427336, -102.79089241226515, -99.32498134175937, -113.57014469305675, -98.82595188419025, -102.43041026840608, -115.44389478365581, -107.05301336447398, -93.90845374266307, -103.62626281629007, -96.73284367720287, -102.73246078193188, -106.5051040649414, -119.89647841453552, -19.164001320799194, -20.89070280392965, -19.905855109294258, -102.02390027046204, -102.43123349547386, -114.33585059642792, -14.084565681715816, -13.66590025400123, -14.297893424828857, -97.18628753225009, -108.75926617781322, -95.79276692370574, -107.89421413342158, -119.9157524506251, -105.13750363389651, -98.03510828812918, -95.39150594671568, -107.48486950000128, -94.87527945637703, -94.8364338427782, -106.0325180888176, -93.34961058696112, -93.01379272838435, -105.40019216140112, -93.67055514951548, -94.24323545893034, -105.4757881363233, -99.72440686821938, -99.76655539870262, -111.76075440645218, -107.35448690255484, -119.05236365397772, -105.55947857101759, -99.44559372464816, -99.81088257829349, -111.39491907755534, -93.84990326811871, -107.41170581181845, -95.22556181748709, -95.16299457351367, -96.05786339441936, -106.33893177906673, -100.19931956628959, -113.80167535940807, -99.71083186070125, -93.20603367686272, -102.9785033762455, -92.20828127861023, -218.28034599622092, -201.3979468246301, -201.9948879381021, -100.32674649854502, -101.56858908136687, -114.12052245934805, -105.0968539317449, -104.47036873300871, -119.63227923711142, -96.78174934536219, -109.11890316009521, -96.92846778035164, -94.74949983755748, -93.34653599063556, -105.10327068964641, -96.02655076111357, -96.58222163716952, -107.90217811862628, -102.00547550121944, -89.1531530978779, -90.26116792360942, -104.51250418027243, -114.88708808024725, -102.50064543386301, -96.42552576710781, -109.0925809343656, -98.98028161128363, -102.91572932402293, -102.86753658453624, -116.06896225611369, -98.62438652912776, -111.81913916269939, -101.98266033331554, -102.9430584013462, -113.78198796510696, -103.47952598333359, -107.54466595252356, -95.52234629293284, -95.33809105058512, -103.18737579633793, -104.36877282460532, -116.90128149588904, -99.29048643012842, -113.06422181924185, -99.61012639602026, -87.57050391534965, -99.27360747257869, -87.86907907823722, -117.68841125567755, -106.51343323787054, -107.36333676179251, -95.78389722108841, -94.82043388485909, -107.60488021373749, -16.58325680345297, -16.994098618626595, -18.785478591918945, -110.20359715819359, -99.92724543809891, -98.3843215033412, -101.31243078907332, -113.20756538709006, -100.27290671070418, -110.65235634644827, -99.32274055977663, -101.65470441182455, -103.34840520222983, -115.75503929456076, -102.58619516094527, -98.8678620060285, -107.75316872199377, -97.14275561769804, -97.27211139599483, -110.19503615299861, -96.58446363142382, -100.55475270748138, -114.48921597003937, -99.36508728563786, -100.47438446680705, -109.80847690502803, -98.14614657560985, -100.80965130031109, -102.72798186540604, -115.52385008335114, -108.27195854981741, -97.06784697373709, -97.27024333675703, -115.50836171706518, -102.25190233190855, -105.11542167266211, -116.64731321732204, -103.5204617480437, -105.05705175797145, -110.12310667832693, -121.03773548205695, -110.0861619313558, -99.15099341670673, -99.52475834886233, -112.20006380478542, -106.56069928407669, -94.34729659557343, -94.28303921222687, -101.02922593553862, -114.51325734456381, -99.84676790734133, -96.07142553230128, -96.33315749963126, -108.30405481656393, -101.35667312505515, -102.67497356732687, -115.37860717376074, -94.41003259519736, -95.09711239735286, -107.28121433655421, -114.66899348298709, -129.94360891977948, -114.47643598417442, -104.57313880324364, -115.43812051415443, -104.98272687196732, -106.50237349669139, -119.12510840098064, -106.61105198661487, -111.76830236117046, -101.86445091168086, -102.65383724371593, -95.5939819055299, -108.3030473391215, -96.33295498291652, -106.37190582354864, -94.63166544338068, -95.73826911052069, -97.7435405254364, -98.37655273079872, -110.31770420074463, -99.83398823936781, -111.71404584248862, -101.74148215850195, -111.96458756923676, -97.61359825730324, -98.55708479881287, -104.77524117628734, -104.50960741440456, -115.71228192249934, -101.01790530482928, -113.21404842535655, -102.69614038864772, -110.03131370743117, -98.79787314434847, -98.0783925553163, -111.45496086279552, -100.72416679064433, -100.97775832811992, -100.98269951343536, -99.35838994383812, -105.06350469589233, -94.3286975423495, -92.76504240433376, -107.10598639647166, -95.25334529578686, -107.39531487226486, -96.47994741797447, -118.59847539663315, -105.66081920266151, -105.05447821319103, -98.92766133199136, -99.94191188613574, -111.25592474142711, -95.2423763871193, -106.72595238685608, -94.2162125222385, -102.64175816377005, -99.77630983976027, -114.3813668092092, -93.72727805376053, -102.1377363204956, -89.75131227262318, -109.24328625202179, -96.72231095843017, -99.56764847040176, -107.95741724967957, -116.71309071779251, -104.63373403251171, -113.82381002108256, -100.81147121886413, -100.80827510605256, -112.55550328890483, -98.01033095705013, -98.46948959181707, -99.87076274553935, -97.58436671892802, -110.8964335123698, -23.776252478361137, -23.43730992078782, -22.536524221301086, -103.42092275619507, -118.05613219738007, -105.56753218173981, -87.60866470138232, -88.84160138169925, -102.21899441878001, -106.36812510093054, -119.19373097022375, -107.66272278626761, -113.11094005902609, -101.16295893987021, -101.90856297810873, -117.40147441625595, -106.24644622206688, -114.30763900279999, -96.82809297243755, -97.35503662625949, -109.06273011366527, -97.82320975263914, -108.68358208735785, -96.76861560841402, -101.80904426177344, -115.32775499423346, -101.492162724336, -112.61451888084412, -100.74609297513962, -100.22375869750977, -95.01810744404793, -96.43015176057816, -108.18145245313644, -91.389798146983, -93.15599199136099, -103.61196990807852, -112.44939184188843, -100.3502627313137, -99.06466609239578, -109.07646352052689, -99.22853523492813, -99.09170055389404, -100.0784161190192, -110.80185214678447, -100.47035286823909, -102.4310896396637, -104.81784200668335, -115.64513123035431, -102.21508699655533, -115.65307575464249, -101.02445145323873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1917463221845243, "mean_inference_ms": 0.715950121381869, "mean_action_processing_ms": 0.10214146315745022, "mean_env_wait_ms": 0.8010467193739261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 19188, "timesteps_this_iter": 0, "agent_timesteps_total": 57564, "timers": {"sample_time_ms": 19058.021, "sample_throughput": 503.41, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3132.097, "learn_throughput": 3063.124, "update_time_ms": 9.014}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 4553.018798828125, "policy_loss": -0.0021595978490305257, "vf_loss": 4553.077941894531, "vf_explained_var": 0.0021501705050468445, "kl": 0.003930412371119381, "entropy": 5.733120679855347, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19188, "num_agent_steps_sampled": 57564, "num_steps_trained": 19188, "num_agent_steps_trained": 57564, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 2, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-43-58", "timestamp": 1706190238, "time_this_iter_s": 20.51777458190918, "time_total_s": 41.1993772983551, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 41.1993772983551, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 7.434482758620691, "ram_util_percent": 48.85517241379311}}
{"episode_reward_max": -6.25011433660984, "episode_reward_min": -618.4002900719643, "episode_reward_mean": -300.0966016073347, "episode_len_mean": 80.38655462184875, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {"shared_policy": -213.52201175689697}, "policy_reward_max": {"shared_policy": -1.8663282468914986}, "policy_reward_mean": {"shared_policy": -100.03220053577824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.52662499248983, -301.869068980217, -303.861874230206, -313.2152652740479, -304.67383337952197, -6.25011433660984, -312.9156881570816, -321.3243598341942, -310.4076900482178, -26.196528419852285, -307.1336378753185, -305.80723735690117, -302.80773880914785, -304.1172105669975, -319.80087742209435, -314.4795269668102, -324.47678700089455, -306.41179266572, -337.52432966232305, -332.64975649118423, -336.95055133104324, -303.1491925418377, -311.9915228486061, -322.5481480509043, -316.3722984790802, -309.5537189692259, -305.5211549028754, -322.78521360456944, -281.9479521512985, -310.73558390140533, -310.2880822084844, -331.66745585203176, -315.22713290154934, -319.05049300193787, -335.97691780328756, -322.9698141440749, -330.7021904587746, -291.187614351511, -299.2855541408062, -288.17447274178267, -308.48191253095865, -330.4574652388692, -335.12319427728653, -293.4153653755784, -314.86178931593895, -300.006741149351, -324.85980989038944, -286.7786339893937, -325.9037023149431, -618.4002900719643, -296.2779623568058, -308.3490284830332, -35.3760340884328, -315.63790729641914, -324.61170753091574, -315.9020151048899, -318.74856290221214, -301.5210973918438, -308.37470304965973, -319.73787099123, -326.96701607108116, -325.1955585926771, -318.3999575152993, -325.5049996525049, -289.1155876740814, -333.2836785614491, -311.3210965888575, -317.16059656627476, -287.00527709722525, -297.63941091299057, -30.50540909171106, -308.7706513553858, -285.78494834154844, -311.77388971298933, -318.2113044410944, -314.3640067130327, -320.48698019981384, -308.17756482958794, -294.5351225733757, -296.61528813838964, -300.8420745432377, -289.6200720220804, -320.66132113337517, -330.29019162058836, -306.2178871333599, -337.15135648846626, -309.12709975242615, -290.5143963396549, -306.39506697654724, -318.7228356599808, -323.55403500795364, -300.2586069777608, -320.1501013934612, -306.3788844458759, -31.125320576131372, -301.8299238979817, -298.2311434149742, -310.90560983866453, -310.6751939356327, -316.4027164429426, -325.58474604412913, -292.8162520080805, -315.5975802540779, -313.0379497259855, -322.32201075553894, -312.5640336126089, -295.362860634923, -313.4458099007607, -320.43409180641174, -293.7883668243885, -304.2911615371704, -315.4687524139881, -321.48081445693975, -303.2190412580967, -299.32014332711697, -313.8596969991923, -317.7469760775566, -320.61609691381454, -315.30622428655624], "episode_lengths": [300, 77, 77, 80, 73, 300, 63, 87, 58, 300, 56, 81, 58, 56, 115, 72, 69, 62, 73, 71, 89, 55, 65, 48, 61, 93, 60, 56, 73, 102, 51, 63, 93, 60, 57, 52, 63, 75, 60, 68, 68, 74, 64, 67, 76, 71, 117, 61, 77, 63, 73, 59, 300, 71, 49, 50, 79, 49, 61, 65, 65, 79, 57, 48, 73, 62, 46, 68, 123, 55, 300, 75, 87, 80, 75, 53, 96, 53, 84, 62, 51, 58, 65, 73, 60, 87, 85, 62, 59, 68, 54, 86, 58, 54, 300, 57, 66, 88, 46, 60, 84, 62, 65, 51, 51, 50, 69, 82, 65, 55, 120, 59, 83, 60, 54, 86, 74, 64, 88], "policy_shared_policy_reward": [-13.591479013363525, -13.392741332451507, -13.542404646674797, -97.6918452779452, -107.71212337414424, -96.46510032812755, -108.92474681138992, -98.36776480078697, -96.56936261802912, -100.4644258817037, -100.94516923030218, -111.80567016204199, -97.33149810321629, -97.65907173603773, -109.68326354026794, -1.8663282468914986, -2.034992553293705, -2.348793536424637, -99.85648999611537, -112.61299143234889, -100.44620672861735, -102.2068755030632, -103.02369785308838, -116.0937864780426, -111.2589320341746, -98.44696847597758, -100.7017895380656, -8.406424363454192, -8.656308417518943, -9.13379563887915, -97.59497098128001, -98.54258752862613, -110.9960793654124, -108.61224364240965, -98.61150067051253, -98.58349304397902, -97.45858949422836, -109.58009165525436, -95.76905765966512, -100.24515153964362, -101.39923336108527, -102.47282566626868, -115.4419497648875, -102.43781710664432, -101.92111055056255, -101.55176776647568, -101.04525539278984, -111.88250380754471, -103.25734689831734, -104.78561967611313, -116.43382042646408, -109.56748263041179, -98.9661030570666, -97.87820697824161, -118.91256002585094, -109.13128672043483, -109.48048291603725, -118.98273938894272, -106.38329082727432, -107.2837262749672, -106.09776508808136, -108.25857383012772, -122.59421241283417, -109.34831005334854, -96.9515751004219, -96.84930738806725, -112.79180842638016, -99.66988104581833, -99.52983337640762, -102.29872212310633, -104.11256768306097, -116.136858244737, -101.79165314634642, -112.30597745378813, -102.27466787894568, -110.25697286923727, -98.42484939595064, -100.871896704038, -97.44927980502447, -111.31982125838599, -96.75205383946499, -102.87855109075706, -103.82878972093265, -116.07787279287975, -89.31825084487598, -101.76590291659038, -90.86379838983218, -110.87678084770839, -99.33721999327342, -100.52158306042354, -110.9306929310163, -100.81684835751852, -98.54054091994962, -106.23645468552908, -106.48073627551398, -118.95026489098868, -100.42116389175257, -101.11904971798262, -113.68691929181418, -101.59590127070746, -102.33313115437826, -115.12146057685217, -121.3758366505305, -106.44384733835857, -108.15723381439845, -101.46786038329205, -116.16878070433935, -105.33317305644354, -105.9674656589826, -118.32299383481345, -106.41173096497855, -104.26516483227412, -94.17434106270473, -92.74810845653217, -95.28616065780322, -96.46905432144801, -107.53033916155498, -92.14432665208976, -91.60863672445218, -104.42150936524074, -99.72393613060316, -98.21652337660393, -110.54145302375159, -105.53548321127892, -104.21291086822748, -120.7090711593628, -107.92061317960422, -118.52408517400424, -108.67849592367808, -96.65344476948182, -99.58903853098552, -97.17288207511108, -112.25548559427261, -101.03631177544594, -101.5699919462204, -95.5167699214071, -95.81421346217394, -108.67575776576996, -102.67050927380721, -105.26863692204158, -116.92066369454066, -91.13199823349714, -91.33670543134212, -104.30993032455444, -115.81431136528651, -103.03370914484064, -107.05568180481593, -202.65728962421417, -202.22098869085312, -213.52201175689697, -95.56423997879028, -106.71771919727325, -93.99600318074226, -111.79662005106609, -97.57458233336608, -98.97782609860103, -11.940338874856636, -11.72036659220855, -11.715328621367618, -103.93358143170676, -100.13896243770918, -111.56536342700323, -116.9888604482015, -103.01749784996113, -104.60534923275313, -101.79522620638213, -113.83053692181906, -100.27625197668871, -102.58826473355293, -113.25770223140717, -102.90259593725204, -108.08002376556396, -96.81053841114044, -96.63053521513939, -98.38844015200934, -110.17507388194403, -99.81118901570639, -113.38136196136475, -103.10772389173508, -103.24878513813019, -105.53034183382988, -116.83468532562256, -104.60198891162872, -103.85334260761738, -105.19141539931297, -116.15080058574677, -112.52006021142006, -100.65654606372118, -105.22335124015808, -102.51705061892669, -114.76180468002956, -108.22614435354869, -91.47973243643841, -105.31640895207724, -92.3194462855657, -118.43935583035152, -108.48805044094722, -106.35627229015033, -97.8523622052744, -112.98526215553284, -100.48347222805023, -102.2320640484492, -114.63385943571727, -100.2946730821083, -105.05792125066122, -91.39618514974913, -90.55117069681486, -94.91220150391261, -107.32486758629481, -95.40234182278316, -10.18152403334777, -10.364172856012985, -9.959712202350303, -112.40711989005408, -97.82435180743536, -98.53917965789637, -102.86065818866095, -92.16370614369711, -90.76058400919041, -98.63726743062338, -106.58932336171469, -106.54729892065129, -100.3728729635477, -102.89264047145844, -114.94579100608826, -100.30172667404017, -113.80465372403464, -100.25762631495795, -102.61824547251067, -102.32121198376021, -115.547522743543, -101.29315572977066, -97.86543878912926, -109.01897031068802, -104.9741100470225, -94.29904303948085, -95.26196948687236, -107.02582385142645, -94.67928949495158, -94.91017479201159, -96.00738741954169, -96.30166642864546, -108.53302069505057, -91.8405880779028, -104.65661644935608, -93.12286749482155, -115.06073574225108, -103.16563601295154, -102.43494937817256, -105.58281188209853, -116.85686131318411, -107.8505184253057, -97.06703365842502, -97.18059078852336, -111.97026268641154, -109.0011195341746, -108.29166466991107, -119.8585722843806, -102.28043991327286, -100.8688171505928, -105.97784268856049, -92.31404500206312, -92.02573837836584, -106.17461295922598, -98.1472238401572, -97.53288591901462, -110.71495721737544, -108.42106358210246, -105.71217195192973, -104.58960012594859, -104.94537001848221, -115.8763370513916, -102.73232793807983, -96.47506151596706, -95.91854460785787, -107.86500085393588, -102.24297758936882, -114.35581457614899, -103.55130922794342, -99.05544370412827, -96.430534850806, -110.89290589094162, -10.431643789013236, -10.585245405634254, -10.108431381483882, -96.10733645160994, -108.77260597546896, -96.94998147090277, -95.46486533681552, -107.15998850266139, -95.60628957549731, -99.1055191680789, -111.46983951330185, -100.33025115728378, -98.90708887577057, -99.97786322236061, -111.79024183750153, -100.29222655793032, -113.05297698577246, -103.05751289923987, -104.84595290819804, -104.2596596988539, -116.47913343707721, -91.64152067402999, -94.11867980162303, -107.05605153242747, -112.93336228529613, -101.87726751963298, -100.78695044914882, -99.55200754106045, -100.14944851398468, -113.3364936709404, -102.98486105600993, -115.91093174616496, -103.42621795336406, -101.36827939748764, -98.28774230182171, -112.90801191329956, -105.67105889320374, -95.4808446764946, -94.21095706522465, -111.2765534122785, -101.35048284133276, -100.81877364714941, -112.29823330044746, -102.17009374499321, -105.96576476097107, -93.68658743302028, -94.24983567992847, -105.85194371143977, -108.38201222817104, -98.04675860206287, -97.86239070693652, -99.47618127862613, -112.89781258503596, -103.09475855032603, -114.10131045182547, -102.16835655768713, -105.21114744742712, -96.66651560366154, -109.62972319126129, -96.92280246317387, -96.60734288891157, -107.57015534241995, -95.14264509578547, -101.18707232673964, -100.14961481591067, -112.52300985654196, -101.97074117263159, -102.60497959454855, -113.1712553103765, -115.67837389310202, -102.68743055065474, -102.25029247005781, -102.4408688346545, -112.47796855370204, -100.38738689819972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19041450277908084, "mean_inference_ms": 0.7126260683277937, "mean_action_processing_ms": 0.1023729199337363, "mean_env_wait_ms": 0.8003628065014904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 28782, "timesteps_this_iter": 0, "agent_timesteps_total": 86346, "timers": {"sample_time_ms": 19513.403, "sample_throughput": 491.662, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3103.171, "learn_throughput": 3091.677, "update_time_ms": 8.848}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 4404.47900390625, "policy_loss": -0.0024795550566293345, "vf_loss": 4404.538391113281, "vf_explained_var": 0.003742888569831848, "kl": 0.004773867391123118, "entropy": 5.712223052978516, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28782, "num_agent_steps_sampled": 86346, "num_steps_trained": 28782, "num_agent_steps_trained": 86346, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 359, "training_iteration": 3, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-44-18", "timestamp": 1706190258, "time_this_iter_s": 20.309192657470703, "time_total_s": 61.508569955825806, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A101F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 61.508569955825806, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.737931034482758, "ram_util_percent": 48.87931034482759}}
{"episode_reward_max": 21.429949656128883, "episode_reward_min": -343.7352349162102, "episode_reward_mean": -289.40210628679426, "episode_len_mean": 89.01801801801801, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {"shared_policy": -125.11589622497559}, "policy_reward_max": {"shared_policy": 7.304390840232372}, "policy_reward_mean": {"shared_policy": -96.46736876226475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.5520493686199, -293.49842458218336, -315.2263938486576, -288.2364683449269, -322.67681220173836, -322.4678582698107, -318.56765780597925, -326.6327386200428, -323.5450967848301, -299.14087738096714, -293.1838036775589, -314.95398972928524, -308.4782368801534, -314.97462993860245, -343.7352349162102, -342.6886465847492, -325.55413725972176, -321.5427106767893, -320.46443325281143, -315.1003626585007, -313.70639967918396, -313.2429941818118, -329.9346300363541, -316.2370837330818, -320.5668400526047, -333.2037100493908, -317.3849542005919, -331.1329144537449, -319.80119855701923, -293.8966244757176, -301.68387031555176, -306.1672548353672, -319.46983786066994, -326.7589633464813, -327.67834627628326, -321.5625973790884, -324.5150893628597, -333.9658791720868, -333.65895517170435, -315.04819606244564, -322.43131100572646, -339.32278901338583, -311.6972119659186, -295.33861101418734, -293.12204644083977, -295.9982372969389, -293.5999908298254, -319.79112631082535, 2.4770304709672786, -329.2103041112423, -291.60707461833954, -325.4853751063347, -304.4478867352009, -323.0761756449938, -303.38871666789055, -320.1936683692038, -285.9278698414564, -280.863218665123, -309.5043608248234, -315.57346414774656, -324.21899999678135, -323.99940767884254, -307.3969723582268, -312.6537903472781, -302.19507521390915, -327.76907677948475, -32.04385064914824, -312.5993351340294, -299.17528837919235, -309.5125971585512, -302.567989051342, -330.6571208536625, -321.29149102792144, -300.8048019781709, -40.677847139537334, -18.333249494433403, -305.5268867611885, -315.76257909834385, -295.446665301919, -14.65287216007711, -285.3151149749756, -326.4962570592761, -324.11077107908204, -310.3815212389454, -315.1394985318184, 21.429949656128883, -319.42031917348504, -315.77333265542984, -327.7863430082798, -263.10856284201145, -321.22467471659184, -321.69693848490715, -320.0230693221092, -323.7387621104717, -17.05775586515665, -300.31712141633034, -317.48976219817996, -305.5736290290952, -329.41660565137863, -315.17303411103785, -335.8381500393152, -314.0984053313732, -4.575639188289671, -311.29202730953693, -307.2531898319721, -278.38909977674484, 18.42093899846077, -341.83487736433744, -314.282224059105, -310.97224299609667, -324.48055043816566], "episode_lengths": [98, 64, 73, 71, 61, 64, 58, 53, 75, 66, 59, 66, 103, 69, 69, 92, 67, 83, 58, 60, 40, 72, 57, 61, 50, 79, 42, 56, 56, 77, 60, 75, 55, 82, 66, 47, 54, 81, 65, 58, 59, 96, 111, 70, 74, 72, 87, 71, 300, 49, 65, 74, 76, 86, 90, 63, 73, 75, 82, 100, 60, 56, 69, 100, 78, 63, 300, 93, 42, 67, 57, 65, 38, 82, 300, 300, 72, 70, 69, 300, 90, 73, 46, 61, 67, 300, 65, 44, 40, 82, 70, 62, 66, 65, 300, 73, 45, 76, 69, 48, 65, 65, 300, 64, 81, 141, 300, 156, 104, 80, 87], "policy_shared_policy_reward": [-94.78958103060722, -105.5933700799942, -95.1690982580185, -100.75516200065613, -96.88903620839119, -95.85422637313604, -111.97214128573737, -102.28754850228628, -100.96670406063399, -103.40291651089987, -92.97859998544058, -91.85495184858641, -103.67909782131514, -103.37750740845999, -115.62020697196326, -115.61054120461147, -101.97357731560867, -104.88373974959056, -101.10138941556215, -102.42850676178932, -115.03776162862778, -105.84037564198177, -104.41700763503711, -116.37535534302394, -103.62244485815367, -115.73633714516959, -104.18631478150687, -109.18387190500896, -94.3649996171395, -95.5920058588187, -93.848217467467, -104.62902132670085, -94.70656488339107, -99.79730990032355, -113.08122430245082, -102.07545552651088, -114.52463126182556, -97.5590626001358, -96.39454301819205, -112.94820380210876, -101.16189596056938, -100.8645301759243, -109.08603703975677, -109.53330165147781, -125.11589622497559, -109.20433709025383, -124.1052463054657, -109.3790631890297, -104.24636523922285, -116.23057331641516, -105.07719870408377, -117.43849305311839, -100.55348968009154, -103.55072794357936, -102.49836717049281, -103.14304564396541, -114.82302043835323, -112.0025882323583, -100.0317704876264, -103.06600393851599, -100.17517249782881, -112.21487518151602, -101.31635199983916, -99.07270537316799, -98.33396924287081, -115.83631956577301, -118.61022182305655, -104.98411782582602, -106.34029038747153, -102.66638747851054, -113.68382326761882, -99.88687298695247, -101.92570866147678, -102.27842242519061, -116.3627089659373, -119.0307944615682, -108.15131839116415, -106.02159719665846, -114.70915166536967, -100.22801845908786, -102.44778407613437, -106.50898591677348, -119.84150842825572, -104.7824201087157, -115.07182268301646, -102.02839290599029, -102.7009829680125, -95.30635501941046, -104.75208338101706, -93.83818607529005, -96.8507684469223, -107.51694184541702, -97.31616002321243, -97.8211170732975, -98.68662077188492, -109.65951699018478, -100.90767400106415, -116.65215253829956, -101.91001132130623, -105.08550659815471, -117.90603444973628, -103.76742229859035, -116.97211929162344, -104.08142991860709, -106.62479706605276, -100.87264202535152, -117.61071145534515, -103.07924389839172, -103.98271549741428, -104.403637389342, -116.12873647610347, -119.92322512467703, -107.43642189105353, -106.60623215635619, -104.75185898443064, -105.6101038058599, -123.29699238141379, -101.54713366429012, -98.9809870372216, -114.52007536093394, -102.00135827499132, -117.10880748430888, -103.32114524642627, -108.82972160975139, -110.43391714493434, -120.05915025870006, -100.5357304563125, -110.63663776715597, -100.52484374245009, -96.80843536059062, -96.40408627937238, -102.12608937422435, -94.9401624997457, -105.24963786204657, -92.93224607904753, -93.9364884843429, -106.89141430457434, -95.17033450802168, -103.86188425123692, -94.91748049855232, -94.82062608003616, -101.2697274684906, -115.97646903991699, -102.54492980241776, 0.7552314599355014, 0.9454350968201908, 0.7763639142115863, -105.12495212753615, -105.84386356671652, -118.24148841698965, -96.10568196574847, -96.53570980827014, -98.96568284432094, -103.842542330424, -116.77748636404674, -104.86534641186397, -99.30781292915344, -95.9906864464283, -109.14938735961914, -116.75057792663574, -103.77790728211403, -102.54769043624401, -108.76780200004578, -96.99334043264389, -97.62757423520088, -102.88203422228496, -115.83495978514354, -101.47667436177532, -105.28117307027182, -90.80194898446402, -89.8447477867206, -97.2444879213969, -92.24519915382068, -91.37353158990543, -98.64924708008766, -111.06668049097061, -99.7884332537651, -100.53323434044918, -112.93836822112402, -102.10186158617338, -102.88198126852512, -117.11185073852539, -104.22516798973083, -104.54602607091269, -116.02318503459296, -103.43019657333693, -109.04099500179291, -98.92203694581985, -99.43394041061401, -99.53851034492254, -100.9907994568348, -112.12448054552078, -96.49906915426254, -107.69211855530739, -98.00388750433922, -103.61388964951038, -106.58693468570709, -117.56825244426727, -10.533225494126484, -11.061824555198356, -10.4488005998234, -99.11848549048106, -102.17770014206569, -111.30314950148265, -98.4545548260212, -97.13458135724068, -103.58615219593048, -110.61462901035945, -100.36303974191348, -98.5349284062783, -110.84455911318462, -95.99929098288219, -95.72413895527522, -118.57624353965124, -106.44604416688284, -105.63483314712843, -115.61483150720596, -103.71042197942734, -101.96623754128814, -95.73766495535772, -95.50759516159694, -109.55954186121623, -13.13815251737833, -13.346495375037193, -14.193199247121811, -5.885448589920998, -5.9733299016952515, -6.474471002817154, -97.07701281706493, -97.74081275860469, -110.7090611855189, -102.77644809087118, -99.51407823463282, -113.47205277283987, -94.06172127028307, -94.97393124302229, -106.41101278861365, -3.7161782632271496, -4.40433318416278, -6.532360712687179, -91.16675395766894, -102.83370528618495, -91.3146557311217, -105.88923287391663, -103.33337330073118, -117.2736508846283, -105.68990808725357, -101.13759668590501, -117.28326630592346, -99.04329363908619, -111.46933081746101, -99.86889678239822, -112.74565958976746, -101.04263746738434, -101.3512014746666, 6.958746075630188, 7.166812740266323, 7.304390840232372, -103.4830652276675, -115.10906384388606, -100.8281901019315, -113.06712257862091, -100.4536645412445, -102.25254553556442, -103.66821613907814, -117.70502519607544, -106.41310167312622, -84.55976593494415, -96.59539866447449, -81.95339824259281, -105.73936613400778, -114.5500520070394, -100.93525657554468, -102.97524786988895, -116.22032336393993, -102.50136725107829, -99.93819801012675, -110.01300496856372, -110.07186634341876, -117.48274270693462, -102.8439671198527, -103.41205228368442, -5.957567125558853, -5.855740413069725, -5.244448326528072, -96.84811759988467, -96.47014219562213, -106.99886162082355, -115.04880082607269, -101.34562008827925, -101.09534128382802, -97.49404687434435, -109.3039645254612, -98.77561762928963, -105.72748416662216, -106.45367556810379, -117.23544591665268, -115.67099825541179, -99.07195346492033, -100.43008239070575, -107.27223638196787, -107.88854535420737, -120.67736830314001, -99.09613666931789, -99.44884462157886, -115.55342404047649, -1.5012024988730843, -1.6737518360217507, -1.4006848533948357, -100.86626092592876, -98.35915553073089, -112.0666108528773, -102.25136081377666, -97.4200130502383, -107.58181596795718, -88.81180304288864, -100.76331126689911, -88.81398546695709, 5.9899695217609406, 6.100200638175011, 6.330768838524818, -107.5923490052422, -109.22810777028403, -125.01442058881125, -100.3472864230474, -101.03360797961554, -112.90132965644202, -108.60034807523093, -95.01234269638857, -107.35955222447714, -116.24298930168152, -104.47869390249252, -103.75886723399162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19071316908665975, "mean_inference_ms": 0.7141912109267667, "mean_action_processing_ms": 0.10243327065457322, "mean_env_wait_ms": 0.7997516287285559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 38376, "timesteps_this_iter": 0, "agent_timesteps_total": 115128, "timers": {"sample_time_ms": 19775.245, "sample_throughput": 485.152, "load_time_ms": 0.248, "load_throughput": 38711065.489, "learn_time_ms": 3087.463, "learn_throughput": 3107.406, "update_time_ms": 8.767}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 3798.2734375, "policy_loss": -0.0018473183249660963, "vf_loss": 3798.3328552246094, "vf_explained_var": 0.007581792771816254, "kl": 0.0054428497423949125, "entropy": 5.769846200942993, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38376, "num_agent_steps_sampled": 115128, "num_steps_trained": 38376, "num_agent_steps_trained": 115128, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 470, "training_iteration": 4, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-44-39", "timestamp": 1706190279, "time_this_iter_s": 20.527613162994385, "time_total_s": 82.03618311882019, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 82.03618311882019, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 8.051724137931034, "ram_util_percent": 49.034482758620676}}
{"episode_reward_max": 33.3362520635128, "episode_reward_min": -345.8379479646683, "episode_reward_mean": -278.4388368376391, "episode_len_mean": 101.17, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {"shared_policy": -124.03312114874522}, "policy_reward_max": {"shared_policy": 11.25553983449936}, "policy_reward_mean": {"shared_policy": -92.81294561254637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.97224299609667, -324.48055043816566, -298.760751657188, -300.2455594614148, -320.85508112609386, -299.6730642542243, -312.88765105605125, 10.493166252970681, -301.1051979959011, -34.503979705274105, -320.20439195632935, -288.0297797322273, -319.1600549267605, -318.6994516402483, -294.90856996178627, -314.08785722590983, 33.3362520635128, -318.9232126176357, -294.3736721742898, -341.8291127681732, -319.6787391901016, -314.39670607447624, -4.8922028467059135, -325.28148578852415, -310.1664039492607, -314.4118600189686, 1.3794627450406551, -302.58938479423523, -309.42352989315987, -322.27067179232836, -312.18193732202053, -19.80187533795835, -324.663779810071, -306.70914144814014, -341.90536083281046, -315.8662806786597, -302.7796786725521, -299.2862701714039, -335.58175015449524, -312.34784098155797, -311.5280690193176, -328.36465944349766, -294.69580958690494, -77.89166018366822, -303.8881259188056, -286.6044108271599, -337.9208435788751, -323.45657762885094, -289.76328878104687, -318.0673745274544, -314.0924901366234, -300.5437696054578, -313.34182962775236, -45.53023923933506, -303.2303239405155, -315.946577321738, -319.0963114798069, -311.47619062662125, -337.6450300812721, -301.2135148346424, -318.4489998817444, -3.7091241627931737, -345.35927061736584, -324.4032860104926, -291.41556191444397, -312.3711628690362, -313.98040789365774, -324.88105045259, -310.62836127728224, -329.7897814512253, -299.43964344263077, -310.79384292662144, -331.92449790239334, -316.3664641827345, -53.43651882559062, -301.47298373281956, -306.48280565440655, -25.75524097681047, -301.4837784767151, -334.5041733980179, -295.63329285383224, -308.50728691369295, -345.8379479646683, -333.7261488735676, -317.2675873711705, -305.324893347919, -318.0983477681875, -319.63932275772095, -319.3516849577427, -297.6100826971233, -314.4520928263664, -340.1716929972172, -269.87617959082127, 3.481829226016984, -306.704253597185, -322.47115367650986, -324.7176419198513, -301.2881689965725, -332.32977855205536, -320.68770249933004], "episode_lengths": [80, 87, 64, 115, 60, 117, 59, 300, 54, 300, 55, 76, 72, 51, 67, 41, 300, 121, 87, 86, 80, 49, 300, 75, 67, 92, 300, 85, 79, 58, 48, 300, 78, 80, 112, 45, 77, 50, 72, 73, 76, 56, 86, 300, 66, 98, 115, 66, 78, 66, 70, 102, 71, 300, 51, 53, 70, 57, 58, 110, 54, 300, 82, 56, 75, 76, 109, 64, 76, 92, 67, 78, 61, 59, 300, 78, 56, 300, 81, 103, 79, 65, 96, 82, 67, 97, 48, 64, 48, 68, 47, 72, 86, 300, 51, 102, 69, 100, 73, 75], "policy_shared_policy_reward": [-108.60034807523093, -95.01234269638857, -107.35955222447714, -116.24298930168152, -104.47869390249252, -103.75886723399162, -95.14374842991433, -95.07029110689959, -108.54671212037405, -95.80371854950985, -108.50572856267294, -95.93611234923205, -102.08846923212211, -108.43027834097545, -110.33633355299632, -95.57010992616415, -95.76983290910721, -108.33312141895294, -99.38188901543617, -112.30601048469543, -101.19975155591965, 3.812516291936234, 3.644008224209145, 3.0366417368253025, -108.90581127007803, -95.9755229552587, -96.2238637705644, -11.673448950052261, -11.312711991369724, -11.51781876385212, -102.53666516145071, -115.51559861501059, -102.15212817986807, -91.9958975215753, -92.14834504326186, -103.8855371673902, -115.64589858055115, -100.46475053299218, -103.04940581321716, -115.2664647102356, -102.13589137792587, -101.29709555208683, -94.28041191895804, -105.98066719373068, -94.64749084909758, -100.56912347177665, -113.49299065272014, -100.02574310141306, 11.25553983449936, 11.253237381577492, 10.827474847435951, -102.16105834643047, -101.51109100381534, -115.25106326738994, -105.69939428567886, -93.20940508134663, -95.46487280726433, -109.21504139900208, -122.9509037733078, -109.66316759586334, -102.74096594254176, -114.50361088911693, -102.43416235844295, -100.22644355893135, -100.2634459733963, -113.90681654214859, -1.397734485566616, -1.6798748224973679, -1.8145935386419296, -116.18431679407756, -105.28432480494182, -103.81284418950479, -99.23314596215884, -111.56572322050731, -99.36753476659457, -99.2649416824182, -102.47600140174231, -112.6709169348081, 0.8088340498507023, 0.4016960486769676, 0.16893264651298523, -98.21344540516536, -96.51581124464671, -107.86012814442317, -99.56771163145702, -99.0932573179404, -110.76256094376247, -116.18411378065746, -102.28276078651349, -103.80379722515742, -101.03732933600745, -112.0206724603971, -99.12393552561602, -6.301630134383842, -6.7468177477518765, -6.7534274558226315, -115.23953219254813, -103.50188193221888, -105.92236568530402, -97.04131390154362, -110.6172536611557, -99.05057388544083, -109.0631520797809, -122.57183827956518, -110.27037047346434, -115.17576811710994, -100.42056778321664, -100.26994477833311, -96.9960586130619, -97.33582520484924, -108.44779485464096, -96.37599593400955, -96.08301958441734, -106.82725465297699, -107.69499854246776, -107.96769485870998, -119.91905675331752, -100.44268080592155, -113.19913530349731, -98.7060248721391, -111.28617970148723, -100.38305384914081, -99.8588354686896, -104.32376237213612, -106.05132126808167, -117.98957580327988, -94.47854454815388, -106.3672422170639, -93.85002282168716, -24.879426211118705, -26.04423940181733, -26.967994570732124, -96.16839552174012, -97.48396513859431, -110.23576525847118, -105.194828748703, -91.4027444422245, -90.00683763623238, -106.14989187320074, -114.65147047986588, -117.11948122580847, -102.59870925545692, -103.83524352312088, -117.02262485027313, -92.33149488270283, -104.72872179746628, -92.70307210087776, -113.84663244088492, -101.57599647839865, -102.64474560817084, -100.94766688346863, -113.32368057966232, -99.82114267349243, -96.05488166461389, -108.07326350609462, -96.41562443474929, -100.28021027644476, -112.40170081456503, -100.65991853674254, -14.599906966090202, -14.5436672270298, -16.386665046215057, -97.1215961376826, -95.9502416352431, -110.15848616758983, -100.1184519690772, -114.86195047696432, -100.96617487569651, -102.00189888477325, -101.97209671139717, -115.12231588363647, -112.1139268875122, -98.8541801571846, -100.50808358192444, -105.9870352546374, -115.07491521040599, -116.58307961622874, -99.43761091430983, -98.64524867137274, -103.13065524895987, -116.83599603176117, -101.97386991977692, -99.6391339302063, -1.1255637506643978, -1.335560450951263, -1.2479999611775128, -110.32967807352543, -123.1129457950592, -111.9166467487812, -118.07677110036215, -104.42064930995306, -101.9058656001774, -91.89393839240074, -105.6342408657074, -93.88738265633583, -101.70331331094107, -112.29990752538046, -98.3679420327147, -112.31960024436316, -101.07279639442763, -100.58801125486693, -117.30118670066199, -104.1077388127645, -103.47212493916354, -110.47215210398039, -100.8533759613832, -99.30283321191868, -104.93328179915747, -117.85429473718008, -107.00220491488776, -95.28639628489813, -95.58340414365134, -108.56984301408133, -112.64430697758993, -99.00542352100214, -99.14411242802939, -108.82913136482239, -117.98385882377625, -105.11150771379471, -101.7685311237971, -113.4547602335612, -101.1431728253762, -17.749108557899795, -17.9223411132892, -17.765069154401623, -95.59440042823553, -95.76535742729902, -110.113225877285, -96.10799383620422, -113.20426229635875, -97.1705495218436, -9.195096413294479, -7.58905626336734, -8.97108830014865, -97.54601621627808, -108.7621887922287, -95.17557346820831, -120.65134306748709, -107.15288822849593, -106.6999421020349, -96.4809278845787, -94.21938878297806, -104.93297618627548, -113.086598555247, -97.16361321757238, -98.2570751408736, -124.03312114874522, -110.72863338390987, -111.0761934320132, -120.43789927164714, -106.92675952116649, -106.36149008075397, -104.29734746615092, -98.6509299154083, -114.31930998961131, -99.12516889969508, -96.32442066321771, -109.87530378500621, -100.36130591730277, -114.38182703653972, -103.35521481434505, -114.89887843529384, -101.99694404999416, -102.74350027243297, -114.95043975114822, -101.69334006309509, -102.70790514349937, -107.35755948225658, -95.2741341466705, -94.97838906819622, -113.51826614141464, -100.27584931254387, -100.65797737240791, -110.43350086609523, -108.41588974992435, -121.32230238119762, -90.79361740748088, -88.51892691353957, -90.56363526980083, 0.9156140138705524, 0.9120298375685962, 1.6541853745778354, -111.56282889842987, -97.27860747091472, -97.86281722784042, -104.65313839912415, -102.39633309841156, -115.42168217897415, -118.0827283859253, -102.91648119688034, -103.71843233704567, -96.9784046113491, -107.74760687351227, -96.56215751171112, -106.11793613433838, -118.39782005548477, -107.81402236223221, -102.40125547349453, -101.69763765484095, -116.58880937099457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1886671181524102, "mean_inference_ms": 0.7196511106728346, "mean_action_processing_ms": 0.10220357428300045, "mean_env_wait_ms": 0.8057481867314849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 47970, "timesteps_this_iter": 0, "agent_timesteps_total": 143910, "timers": {"sample_time_ms": 20002.596, "sample_throughput": 479.638, "load_time_ms": 0.397, "load_throughput": 24156653.005, "learn_time_ms": 3096.837, "learn_throughput": 3098.0, "update_time_ms": 8.626}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 3163.662322998047, "policy_loss": -0.002387430469596552, "vf_loss": 3163.7230529785156, "vf_explained_var": 0.008849218487739563, "kl": 0.004599892190527498, "entropy": 5.827187180519104, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 47970, "num_agent_steps_sampled": 143910, "num_steps_trained": 47970, "num_agent_steps_trained": 143910, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 568, "training_iteration": 5, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-45-00", "timestamp": 1706190300, "time_this_iter_s": 20.97650980949402, "time_total_s": 103.01269292831421, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03540040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 103.01269292831421, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.15, "ram_util_percent": 49.169999999999995}}
{"episode_reward_max": 23.006848126649842, "episode_reward_min": -605.9890979230404, "episode_reward_mean": -277.17739529875803, "episode_len_mean": 102.15, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"shared_policy": -211.56349762280783}, "policy_reward_max": {"shared_policy": 7.874246646960572}, "policy_reward_mean": {"shared_policy": -92.39246509958602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.4520928263664, -340.1716929972172, -269.87617959082127, 3.481829226016984, -306.704253597185, -322.47115367650986, -324.7176419198513, -301.2881689965725, -332.32977855205536, -320.68770249933004, -299.83101315796375, -311.1141112544574, -263.26193960756063, -294.95919811725616, -19.922884047031417, -268.2963333725929, 1.437803842127309, -336.641570687294, -302.93630994856363, 5.09906273335217, -315.09725611191243, -70.26355142891411, -309.952647306025, -322.82007846981287, -299.645428866148, -323.61693373322487, -323.8806504011154, -329.7365853190422, -312.88370445370674, -327.3034231066704, -321.34392005205154, -319.04013915359974, -348.35753232240677, -2.75901404581964, -311.024045586586, -332.95790833234787, -316.6784851849079, -292.75187996029854, -301.90967443585396, -299.10428434610367, -345.27311126142746, -319.3845680952072, -10.579423684626818, -306.31375473737717, -320.51805859804153, -302.61704021692276, -331.58988270163536, -325.17481680214405, -305.470311909914, -307.3888333514333, -301.35219760239124, -12.652463858947186, -306.2898076176644, -7.939910206943779, -301.3587073953822, -332.5865493118763, -344.2724746763706, -317.1456523835659, 6.708223439753056, -281.47910379618406, -314.9959640793968, -315.9602564089001, 4.9480746090412, -314.00332921743393, -605.9890979230404, -298.2654356583953, -308.4937264919281, 23.006848126649842, -320.00922021269804, -316.7876047492027, -334.41049164533615, -339.61208447813993, -329.6877834498883, -288.41189820319414, -331.0849297493696, -290.90470397192985, -327.3838594034314, -0.25894883275034886, -303.84377255663276, -313.2012673988939, -329.8737744092941, -302.7418796122074, -306.06916727125645, -321.2279083132744, -318.5123023912311, -316.5044769495726, -316.4394136816263, -321.6027022153139, -294.56313397735363, -297.8919275403023, -336.9200247526169, -317.3650434911251, -322.0180861353874, -320.2773815598339, -330.50341796875, -323.30945748090744, -319.91879546642303, -297.9690900063142, -328.7672190517187, -296.4659594744444], "episode_lengths": [47, 72, 86, 300, 51, 102, 69, 100, 73, 75, 55, 68, 101, 74, 300, 172, 300, 68, 71, 300, 63, 300, 51, 47, 68, 60, 65, 57, 125, 79, 59, 44, 81, 300, 140, 68, 103, 96, 79, 96, 72, 51, 300, 71, 41, 66, 78, 74, 57, 74, 161, 300, 57, 300, 65, 82, 84, 61, 300, 87, 48, 54, 300, 64, 58, 74, 67, 300, 40, 66, 72, 94, 59, 102, 54, 66, 90, 300, 49, 72, 62, 85, 73, 56, 72, 69, 53, 44, 110, 66, 58, 61, 47, 79, 65, 52, 57, 94, 57, 80], "policy_shared_policy_reward": [-113.51826614141464, -100.27584931254387, -100.65797737240791, -110.43350086609523, -108.41588974992435, -121.32230238119762, -90.79361740748088, -88.51892691353957, -90.56363526980083, 0.9156140138705524, 0.9120298375685962, 1.6541853745778354, -111.56282889842987, -97.27860747091472, -97.86281722784042, -104.65313839912415, -102.39633309841156, -115.42168217897415, -118.0827283859253, -102.91648119688034, -103.71843233704567, -96.9784046113491, -107.74760687351227, -96.56215751171112, -106.11793613433838, -118.39782005548477, -107.81402236223221, -102.40125547349453, -101.69763765484095, -116.58880937099457, -95.33005865911643, -108.05426905552547, -96.44668544332187, -98.46129137262082, -112.96248211463293, -99.69033776720366, -82.95872428268194, -96.32646870613098, -83.97674661874771, -94.15894270936649, -94.67028797666232, -106.12996743122737, -6.44784001509349, -6.567016149560615, -6.908027882377311, -85.82940719028315, -95.9949903835853, -86.4719357987245, 0.4218525191148075, 0.31986383100350224, 0.6960874920089992, -120.47550809383392, -108.39110445976257, -107.77495813369751, -111.824782093366, -95.2571210016807, -95.8544068535169, 1.5540577967961582, 1.685089965661362, 1.8599149708946499, -99.45031615595023, -116.76544467608134, -98.88149527988087, -22.51724067827066, -24.321453084548317, -23.4248576660951, -99.83020023504893, -112.85379068056743, -97.26865639040868, -104.26164860526721, -116.30752364794414, -102.25090621660154, -95.10615619023642, -96.12048374613127, -108.41878892978033, -102.56246504187584, -114.57045477628708, -106.48401391506195, -115.50469021002452, -104.57564185063045, -103.80031834046046, -106.02062712113063, -104.9225542942683, -118.7934039036433, -98.91355633735657, -99.7757913172245, -114.19435679912567, -104.14229133725166, -117.40742707252502, -105.75370469689369, -114.30133247375488, -103.58506971597672, -103.45751786231995, -101.27330650389194, -101.81972277164459, -115.9471098780632, -123.48915070295334, -112.14136391878128, -112.72701770067215, -0.7275007739663124, -0.1822741311043501, -1.8492391407489777, -100.50801126162212, -100.30118374029796, -110.21485058466594, -106.53406286239624, -107.26913088560104, -119.15471458435059, -113.89605494340262, -102.60643663009009, -100.17599361141524, -93.51767469445865, -105.64574335018794, -93.58846191565196, -97.13473832607269, -95.30113539099693, -109.47380071878433, -94.36454256375632, -109.93999322255453, -94.79974855979285, -108.27878436197838, -109.045799245437, -127.94852765401205, -114.40037252505621, -102.35075982411703, -102.633435746034, -3.482420712709427, -2.9974095411598682, -4.099593430757523, -97.35762361685435, -98.46936915318172, -110.48676196734111, -102.06044874588649, -102.80585102240245, -115.65175882975261, -95.08180516958237, -109.21194183826447, -98.32329320907593, -118.71020025014877, -107.08376741409302, -105.79591503739357, -117.22965653737387, -103.34502313037714, -104.60013713439307, -109.42306353648505, -96.99570863445601, -99.05153973897299, -109.98403181632361, -99.4992253681024, -97.9055761670073, -95.00171226759753, -95.78324620922407, -110.56723912556967, -4.216362794240325, -3.6027822153021987, -4.833318849404662, -113.24066432317099, -96.5512775083383, -96.49786578615507, -3.253687312205642, -2.5080322374900277, -2.178190657248109, -106.1717896014452, -100.16971325874329, -95.01720453519374, -105.69279450178146, -105.92138561606407, -120.97236919403076, -110.08475438753764, -123.45115021864574, -110.73657007018726, -100.93645813067755, -114.67023106416067, -101.5389631887277, 2.5331419929862022, 2.417325958609581, 1.7577554881572723, -90.63918077945709, -101.07059472799301, -89.76932828873396, -101.78302015860876, -99.85374032387821, -113.35920359690985, -113.12750830252966, -98.86560437207422, -103.96714373429617, 1.8565839578707966, 1.5198642810185703, 1.571626370151833, -98.92056949933371, -113.46171685059866, -101.62104286750159, -197.06264554460844, -211.56349762280783, -197.36295475562414, -94.62942055116098, -107.50679860512416, -96.12921650211017, -98.71433077255885, -110.97462592522304, -98.80476979414622, 7.874246646960572, 7.338262905677155, 7.794338574012116, -102.48037985463938, -102.37931958337626, -115.14952077468237, -104.11551487445831, -100.7221410870552, -111.94994878768921, -105.18925738334656, -120.91827523708344, -108.30295902490616, -121.88834468523662, -108.889576147, -108.83416364590327, -105.64896981914839, -117.43218954404196, -106.6066240866979, -91.98859235892694, -104.38332329193751, -92.0399825523297, -104.63651037712893, -118.38275506099066, -108.06566431125006, -94.3421565067644, -96.68720159928004, -99.87534586588542, -105.21806649367015, -103.8542221064369, -118.31157080332439, 0.08696869264045404, 0.028756412367016537, -0.37467393775781943, -95.37959996486704, -97.43241174022357, -111.03176085154216, -99.95496742924055, -113.87708612283072, -99.36921384682259, -107.93575219313304, -103.90880457560222, -118.02921764055888, -98.58322995901108, -107.82645690441132, -96.33219274878502, -112.62337374687195, -95.95082621276379, -97.49496731162071, -102.36412113904953, -103.29008764028549, -115.57369953393936, -100.90981465329727, -101.26555845638117, -116.33692928155264, -116.82187052567801, -99.5590775658687, -100.12352885802588, -100.49875243008137, -114.75195980072021, -101.18870145082474, -103.45515643556914, -115.31152268250784, -102.83602309723696, -106.40620728333792, -94.68912531932196, -93.46780137469372, -96.95135291417441, -94.9355038603147, -106.0050707658132, -119.90197658538818, -109.23431813716888, -107.78373003005981, -113.48515695333481, -101.59940904378891, -102.28047749400139, -115.16127898295721, -103.06989594300589, -103.78691120942435, -114.68849962949753, -100.4224654044956, -105.16641652584076, -101.13951895634334, -114.93384484450023, -114.43005416790645, -114.2297361890475, -104.46132139364879, -104.61839989821117, -103.6119923790296, -115.21484740575156, -101.0919556816419, -108.71907832225165, -95.44518651564917, -93.80482516841343, -105.80652344226837, -104.46968446671963, -118.49101114273071, -109.12147760391235, -93.59543591737747, -93.74904595315456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18527762258667274, "mean_inference_ms": 0.7143367709524762, "mean_action_processing_ms": 0.10117110401999828, "mean_env_wait_ms": 0.801883724432538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 57564, "timesteps_this_iter": 0, "agent_timesteps_total": 172692, "timers": {"sample_time_ms": 20021.311, "sample_throughput": 479.189, "load_time_ms": 0.582, "load_throughput": 16482858.783, "learn_time_ms": 3084.419, "learn_throughput": 3110.472, "update_time_ms": 8.612}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 2840.881805419922, "policy_loss": -0.0013497733377700882, "vf_loss": 2840.941925048828, "vf_explained_var": 0.00827789306640625, "kl": 0.004754725057865665, "entropy": 5.883890807628632, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57564, "num_agent_steps_sampled": 172692, "num_steps_trained": 57564, "num_agent_steps_trained": 172692, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 658, "training_iteration": 6, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-45-20", "timestamp": 1706190320, "time_this_iter_s": 19.97171378135681, "time_total_s": 122.98440670967102, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 122.98440670967102, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.121428571428572, "ram_util_percent": 49.074999999999996}}
{"episode_reward_max": 9.606845706701279, "episode_reward_min": -604.3260325659066, "episode_reward_mean": -275.0010835396999, "episode_len_mean": 106.21, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {"shared_policy": -210.9466245174408}, "policy_reward_max": {"shared_policy": 3.345825657248497}, "policy_reward_mean": {"shared_policy": -91.66702784656664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.8737744092941, -302.7418796122074, -306.06916727125645, -321.2279083132744, -318.5123023912311, -316.5044769495726, -316.4394136816263, -321.6027022153139, -294.56313397735363, -297.8919275403023, -336.9200247526169, -317.3650434911251, -322.0180861353874, -320.2773815598339, -330.50341796875, -323.30945748090744, -319.91879546642303, -297.9690900063142, -328.7672190517187, -296.4659594744444, -321.5001019835472, -314.2374327778817, -317.0084896311164, -315.7028441429138, -327.2683548629284, -284.31618651747704, -311.6738929376006, -312.1093229688704, 9.606845706701279, -331.14585492014885, -322.35813239216805, -313.2308511734009, -290.3524340689182, -326.3947289288044, -5.038194045424461, -258.18528413772583, -320.3277362585068, -28.81476996839048, -337.96783539652824, -329.24391176924115, -306.53256449103355, -337.18266788125044, -327.3865299075842, -334.5226440131664, -319.17484694719315, -305.20189099013805, -5.318809390068054, -322.8217865228653, -357.01405653357506, -303.54842150211334, -330.2925700545311, -337.79037064313894, -316.6326182857156, -326.84868797508534, -335.5178173780442, -327.2658287063241, -301.34111808240414, -285.7953760661185, -317.77916660904884, -315.27199671417475, -326.0808652937412, -310.00943025946617, -37.06115359440449, 3.965731419622884, -328.4226274192333, -335.87104618549347, -11.941178269684315, -313.09932857751846, -325.8540460765362, -323.1147097200155, -326.5539448261261, -604.3260325659066, -11.30203735083343, -310.54047256708145, -274.37451004236937, -328.54678443074226, -343.34921085834503, -299.7957381531596, -318.9501195549965, 3.8770986236631586, -291.89604003727436, -9.801921449601664, -333.2219407558441, -309.95982241258025, -336.39044213294983, -308.27385576814413, -7.079621538519859, -326.33329693973064, -333.632012963295, 2.8152693882584288, -320.1964540183544, -313.4797261655331, -323.5386426001788, -8.823909014463439, -308.0806013569236, -331.01220640540123, -327.36072900146246, 2.936841748654828, -318.65820833295584, -87.32018489390614], "episode_lengths": [62, 85, 73, 56, 72, 69, 53, 44, 110, 66, 58, 61, 47, 79, 65, 52, 57, 94, 57, 80, 100, 53, 73, 99, 44, 71, 40, 55, 300, 64, 61, 70, 131, 63, 300, 121, 63, 300, 97, 63, 72, 71, 73, 52, 75, 96, 300, 64, 90, 88, 71, 66, 40, 90, 78, 66, 70, 109, 58, 61, 64, 80, 300, 300, 57, 163, 300, 97, 50, 54, 89, 66, 300, 79, 100, 60, 117, 59, 62, 300, 97, 300, 71, 44, 69, 61, 300, 71, 55, 300, 78, 54, 59, 300, 56, 69, 75, 300, 67, 300], "policy_shared_policy_reward": [-107.93575219313304, -103.90880457560222, -118.02921764055888, -98.58322995901108, -107.82645690441132, -96.33219274878502, -112.62337374687195, -95.95082621276379, -97.49496731162071, -102.36412113904953, -103.29008764028549, -115.57369953393936, -100.90981465329727, -101.26555845638117, -116.33692928155264, -116.82187052567801, -99.5590775658687, -100.12352885802588, -100.49875243008137, -114.75195980072021, -101.18870145082474, -103.45515643556914, -115.31152268250784, -102.83602309723696, -106.40620728333792, -94.68912531932196, -93.46780137469372, -96.95135291417441, -94.9355038603147, -106.0050707658132, -119.90197658538818, -109.23431813716888, -107.78373003005981, -113.48515695333481, -101.59940904378891, -102.28047749400139, -115.16127898295721, -103.06989594300589, -103.78691120942435, -114.68849962949753, -100.4224654044956, -105.16641652584076, -101.13951895634334, -114.93384484450023, -114.43005416790645, -114.2297361890475, -104.46132139364879, -104.61839989821117, -103.6119923790296, -115.21484740575156, -101.0919556816419, -108.71907832225165, -95.44518651564917, -93.80482516841343, -105.80652344226837, -104.46968446671963, -118.49101114273071, -109.12147760391235, -93.59543591737747, -93.74904595315456, -115.58787971735, -103.67161378264427, -102.24060848355293, -113.03212632735571, -100.76983039577803, -100.43547605474791, -114.64549740155539, -100.24195314695439, -102.12103908260664, -113.65777548154196, -101.04048203428587, -101.00458662708601, -117.72038394212723, -104.5413319170475, -105.00663900375366, -93.33514141043028, -94.04033245642981, -96.94071265061697, -99.35532552997272, -113.33777842919032, -98.98078897843759, -98.68437896544735, -113.34310398499171, -100.08184001843135, 2.970938816666603, 3.2900812327861786, 3.345825657248497, -118.70495931307475, -106.28747643033664, -106.15341917673747, -103.72126825650534, -115.87647088368735, -102.76039325197539, -107.3964452346166, -107.92380626996359, -97.91059966882071, -105.09339421987534, -92.88899227976799, -92.3700475692749, -106.37805066506068, -103.41586328546207, -116.60081497828166, -1.6409482136368752, -1.8708183318376541, -1.526427499949932, -83.01823149124782, -93.94171426693599, -81.22533837954204, -102.30469508965811, -101.89797147115073, -116.12506969769797, -9.539503375689193, -9.607966090242073, -9.667300502459213, -108.17235833406448, -108.10397645831108, -121.69150060415268, -104.47844646995267, -118.66395445664725, -106.1015108426412, -111.4603926340739, -97.70978570977847, -97.3623861471812, -108.130077679952, -108.43089084823927, -120.62169935305914, -106.80510240793228, -116.40773671865463, -104.17369078099728, -106.44464409351349, -106.77064618468285, -121.30735373497009, -100.5983564555645, -99.70628413558006, -118.87020635604858, -110.66607147455215, -97.22046010196209, -97.31535941362381, -2.013524577021599, -1.6275884509086609, -1.6776963621377945, -104.30659645795822, -115.9617611169815, -102.55342894792557, -122.23058470090231, -110.19188575943312, -124.59158607323965, -110.84303108851115, -97.04852430025737, -95.65686611334483, -107.30265182256699, -117.49176037311554, -105.49815785884857, -120.21361203988394, -109.43592401345572, -108.14083458979925, -100.3665456349651, -102.17448232571284, -114.09159032503764, -104.47552961111069, -102.1665429159766, -120.20661544799805, -106.92232735951742, -107.96921678384146, -120.62627323468527, -103.03260207424562, -103.71538322667281, -120.51784340540569, -96.98782293001811, -109.16646508375804, -95.186830068628, -90.11843237653375, -104.467569231987, -91.20937445759773, -100.81554678082466, -100.37714612483978, -116.5864737033844, -116.71301567554474, -99.34179378300905, -99.21718725562096, -104.60343918204308, -117.2996456027031, -104.17778050899506, -114.32110043366751, -97.13879333933195, -98.54953648646674, -11.86957457413277, -11.651709036280721, -13.539869983990997, 0.7764352758725437, 1.492905010779694, 1.6963911329706463, -120.17422580718994, -103.75266724824905, -104.49573436379433, -107.58528078595798, -120.08892844120662, -108.19683695832889, -3.619041807949543, -4.125658378005028, -4.196478083729744, -107.24559783935547, -103.9841365814209, -101.8695941567421, -104.77775351206462, -117.96669737497966, -103.10959518949191, -101.40056302646796, -116.59533886114757, -105.11880783240001, -118.17964430650076, -104.41810738046965, -103.95619313915572, -199.0770515203476, -210.9466245174408, -194.30235652811825, -3.595509069661304, -3.7443267057339398, -3.9622015754381863, -114.14601564407349, -98.07786226272583, -98.31659466028214, -98.82258788744609, -91.1198689142863, -84.43205324063699, -105.20413708686829, -104.90676906704903, -118.43587827682495, -107.80384469032288, -123.1637351512909, -112.38163101673126, -108.65900532404582, -96.35640100638072, -94.78033182273309, -101.75718628366789, -101.74478315313658, -115.44815011819205, 1.1210322032372062, 1.0479418585697715, 1.708124561856181, -104.94941591223082, -93.72063330312571, -93.22599082191786, -3.309054652849838, -3.2711676682035176, -3.221699128548309, -108.41445020834605, -106.66688374678294, -118.14060680071513, -112.67555447419485, -98.63478141029677, -98.64948652808866, -108.49007493257523, -108.06287860870361, -119.83748859167099, -98.39188028872013, -111.81630384922028, -98.06567163020372, -2.1670558378100395, -2.9199275076389313, -1.9926381930708885, -116.11964855591457, -104.22439810136954, -105.98925028244655, -106.53577200571696, -119.7095369497935, -107.38670400778453, 0.8178137640158241, 0.9200305143992011, 1.0774251098434036, -104.65993422269821, -101.47115352749825, -114.06536626815796, -115.02064009507498, -99.70569868882498, -98.75338738163313, -102.47770575185618, -103.71122082074484, -117.34971602757773, -2.7466524640719143, -2.885716358820602, -3.1915401915709225, -113.65445097287497, -98.72571249802908, -95.70043788601956, -104.85828519860904, -118.59930471579234, -107.55461649099986, -117.99410901467006, -103.40702522049348, -105.95959476629893, 1.1296364342172893, 1.1103775401910099, 0.696827774246529, -116.7817314863205, -99.87299924343824, -102.0034776031971, -28.491571793953582, -30.717146794001266, -28.111466305951282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18314013692846934, "mean_inference_ms": 0.7138037097263735, "mean_action_processing_ms": 0.100741344251458, "mean_env_wait_ms": 0.8004134666177326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 67158, "timesteps_this_iter": 0, "agent_timesteps_total": 201474, "timers": {"sample_time_ms": 20043.365, "sample_throughput": 478.662, "load_time_ms": 0.642, "load_throughput": 14948050.734, "learn_time_ms": 3087.526, "learn_throughput": 3107.343, "update_time_ms": 9.169}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 2380.515655517578, "policy_loss": -0.001934796075912626, "vf_loss": 2380.5760192871094, "vf_explained_var": 0.006475493311882019, "kl": 0.003938620022382865, "entropy": 5.845157325267792, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67158, "num_agent_steps_sampled": 201474, "num_steps_trained": 67158, "num_agent_steps_trained": 201474, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 738, "training_iteration": 7, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-45-40", "timestamp": 1706190340, "time_this_iter_s": 20.232887983322144, "time_total_s": 143.21729469299316, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B0BAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 143.21729469299316, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 8.648275862068965, "ram_util_percent": 49.1}}
{"episode_reward_max": 12.723270371556254, "episode_reward_min": -608.9395994339138, "episode_reward_mean": -251.4336673957389, "episode_len_mean": 127.1, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {"shared_policy": -212.98248624801636}, "policy_reward_max": {"shared_policy": 6.33176976442337}, "policy_reward_mean": {"shared_policy": -83.81122246524629}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-343.34921085834503, -299.7957381531596, -318.9501195549965, 3.8770986236631586, -291.89604003727436, -9.801921449601664, -333.2219407558441, -309.95982241258025, -336.39044213294983, -308.27385576814413, -7.079621538519859, -326.33329693973064, -333.632012963295, 2.8152693882584288, -320.1964540183544, -313.4797261655331, -323.5386426001788, -8.823909014463439, -308.0806013569236, -331.01220640540123, -327.36072900146246, 2.936841748654828, -318.65820833295584, -87.32018489390614, -23.86195370554927, -292.46636013686657, -24.473175849765553, -313.8697452843189, -301.5318880826235, -330.4351199865341, -290.25826409459114, -344.7312553972006, -309.8446922749281, -338.4575245380402, -282.5623652487994, -32.97067278623581, -331.3245230913162, -46.436216261237874, -348.7555700093508, -312.57378623634577, -332.4365954697132, -322.44918335974216, -305.2971768081188, -304.53300587832933, -321.7927162721753, -320.700577378273, -320.12031051516533, -30.77770614624025, -314.33032689243555, 2.279664017260046, -303.2754801660776, -320.23391780257225, -333.09221086651087, -320.67120376974344, -322.27119033038616, -304.95389737933874, -324.8871923685074, -50.1211569644511, -330.97745794057846, -303.98131643235683, -322.96451113559306, -316.65948879718786, -314.204428434372, -295.0349828004837, -300.7258065342903, 11.015606194734573, -346.89589649438864, -7.910892032086878, -29.383384361863165, -335.8377867937088, -322.4839201271534, -307.3224629163742, -314.2469367682934, -304.5386099964381, -328.4027006030083, -309.344342276454, -308.288366317749, -321.23085033893585, -318.49649918824434, 12.723270371556254, -345.10982798039913, -2.4855142123997354, -608.9395994339138, -333.1497322022915, -330.65957944095135, -334.69863452017313, -328.49619440734386, -324.79090467095375, -296.02806686237454, -50.31583176553252, -106.72563216090197, -314.4991428190842, -311.24534052610403, -30.922704100608826, -331.3104811310768, -320.65617793798447, -334.74621998518705, -46.62301202677193, -29.558195166289835, -325.47141257300973], "episode_lengths": [117, 59, 62, 300, 97, 300, 71, 44, 69, 61, 300, 71, 55, 300, 78, 54, 59, 300, 56, 69, 75, 300, 67, 300, 300, 68, 300, 78, 73, 157, 67, 90, 65, 86, 93, 300, 63, 300, 108, 78, 50, 62, 64, 62, 66, 71, 82, 300, 93, 300, 68, 67, 65, 44, 45, 51, 39, 300, 57, 86, 46, 44, 56, 66, 60, 300, 77, 300, 300, 57, 55, 80, 92, 70, 94, 78, 90, 39, 60, 300, 128, 300, 85, 48, 68, 106, 88, 102, 98, 300, 300, 61, 70, 300, 127, 67, 82, 300, 300, 54], "policy_shared_policy_reward": [-107.80384469032288, -123.1637351512909, -112.38163101673126, -108.65900532404582, -96.35640100638072, -94.78033182273309, -101.75718628366789, -101.74478315313658, -115.44815011819205, 1.1210322032372062, 1.0479418585697715, 1.708124561856181, -104.94941591223082, -93.72063330312571, -93.22599082191786, -3.309054652849838, -3.2711676682035176, -3.221699128548309, -108.41445020834605, -106.66688374678294, -118.14060680071513, -112.67555447419485, -98.63478141029677, -98.64948652808866, -108.49007493257523, -108.06287860870361, -119.83748859167099, -98.39188028872013, -111.81630384922028, -98.06567163020372, -2.1670558378100395, -2.9199275076389313, -1.9926381930708885, -116.11964855591457, -104.22439810136954, -105.98925028244655, -106.53577200571696, -119.7095369497935, -107.38670400778453, 0.8178137640158241, 0.9200305143992011, 1.0774251098434036, -104.65993422269821, -101.47115352749825, -114.06536626815796, -115.02064009507498, -99.70569868882498, -98.75338738163313, -102.47770575185618, -103.71122082074484, -117.34971602757773, -2.7466524640719143, -2.885716358820602, -3.1915401915709225, -113.65445097287497, -98.72571249802908, -95.70043788601956, -104.85828519860904, -118.59930471579234, -107.55461649099986, -117.99410901467006, -103.40702522049348, -105.95959476629893, 1.1296364342172893, 1.1103775401910099, 0.696827774246529, -116.7817314863205, -99.87299924343824, -102.0034776031971, -28.491571793953582, -30.717146794001266, -28.111466305951282, -7.714412366350501, -7.844636743267387, -8.30290459593138, -93.67509239415328, -105.29644877711932, -93.49481896559398, -7.759200053910419, -8.910682479540512, -7.8032933163146225, -101.02081820368767, -110.98118960857391, -101.86773747205734, -111.02397096157074, -94.73218937218189, -95.77572774887085, -104.79479202628136, -106.40623846650124, -119.23408949375153, -97.81243393818538, -95.89928234616916, -96.54654781023662, -111.0718147456646, -123.83943349123001, -109.82000716030598, -98.67868895332019, -98.70721864203612, -112.45878467957179, -109.06095496813457, -108.11952433983485, -121.27704523007075, -105.11087961991629, -89.01314907272658, -88.43833655615649, -10.747110724449158, -10.912686467170715, -11.310875594615936, -106.34360293547313, -106.44956062237422, -118.53135953346889, -15.254319722453758, -15.20005563522379, -15.981840903560325, -112.33875086903572, -124.80039483308792, -111.61642430722713, -98.73891569922368, -101.90879646937053, -111.92607406775157, -106.2491335173448, -119.43579407533011, -106.75166787703833, -103.36551620562872, -116.41862734158835, -102.66503981252512, -95.8029560148716, -112.83926093578339, -96.65495985746384, -111.02156241734824, -96.11954194804034, -97.39190151294073, -102.52782485137384, -103.17089843253295, -116.09399298826854, -102.42092108726501, -114.8188499212265, -103.4608063697815, -102.95310359199843, -102.05598052342734, -115.11122639973959, -9.972925240794822, -10.0457253108422, -10.759055594603225, -100.47279648979506, -99.35729381193718, -114.50023659070334, 0.778489435712487, 0.8087813730041091, 0.6923932085434501, -97.73794893423717, -109.27979771296184, -96.25773351887862, -103.11618262529373, -101.02836528420448, -116.08936989307404, -107.88099157810211, -105.53463719040155, -119.6765820980072, -100.88558906068405, -116.4321251710256, -103.35348953803381, -102.31375452379386, -103.78601644436519, -116.17141936222713, -98.33355182409286, -96.23604407161474, -110.38430148363113, -115.54170652230582, -103.49753870566687, -105.84794714053473, -16.077760656674712, -15.802844756593316, -18.240551551183074, -106.13326252500217, -118.91226784388225, -105.93192757169406, -95.13528770705065, -96.75775988896689, -112.08826883633932, -102.10717844900987, -117.90950985749564, -102.94782282908758, -102.75356902678809, -100.37489636739096, -113.53102340300879, -101.2645290096601, -98.67151119311652, -114.26838823159537, -93.0742557644844, -92.54809576272964, -109.41263127326965, -95.7518652677536, -95.69288915395737, -109.28105211257935, -0.5615506172180176, 5.245387047529221, 6.33176976442337, -125.47190924485525, -111.37256224950156, -110.0514250000318, -2.303034712870925, -3.0952720840772088, -2.5125852351387437, -9.448779945572227, -9.778514703114837, -10.156089713176101, -106.75484448671341, -121.38038575649261, -107.70255655050278, -103.44826846321425, -103.7456925113996, -115.28995915253958, -109.82765301068625, -97.61711402734122, -99.87769587834677, -100.56242670615515, -100.40227543314299, -113.28223462899527, -110.11329897244772, -97.03426763912043, -97.3910433848699, -118.0233698685964, -104.94662593801817, -105.43270479639372, -112.76050666968028, -97.13257702688377, -99.45125857988994, -101.71639655033748, -104.05499551693599, -102.51697425047557, -103.85899279514949, -115.49912724892299, -101.87273029486339, -101.0051892871658, -101.86346469322841, -115.62784520785014, 4.547352696458489, 3.8576836685339515, 4.318234006563813, -111.53180165092151, -122.25972143809001, -111.31830489138763, -0.9852638791004864, -0.5061143028239456, -0.9941360304753033, -196.27855024673045, -212.98248624801636, -199.67856293916702, -107.17058936754863, -107.21953536073367, -118.7596074740092, -107.2559461593628, -104.61555479466915, -118.7880784869194, -106.38603580494723, -106.04076092441878, -122.2718377908071, -105.35530696312587, -104.89868285755317, -118.24220458666484, -116.25313967466354, -103.43182489275932, -105.10594010353088, -96.47962523251772, -96.07849917933345, -103.46994245052338, -16.641207640369743, -16.637808461984008, -17.03681566317877, -36.2836510638396, -35.48639885584514, -34.9555822412173, -99.47665551273774, -115.48632756868999, -99.53615973765652, -98.1064198811849, -99.62521388133368, -113.51370676358542, -9.590543031692505, -10.533364981412888, -10.798796087503433, -107.09658255179724, -106.44172062476477, -117.77217795451483, -102.50258071223895, -102.50027639667194, -115.65332082907359, -106.03611065198979, -119.78547217448553, -108.92463715871176, -15.004632930581778, -15.63912117977938, -15.979257916410774, -9.953457896908134, -9.850530808170646, -9.754206461211055, -102.09332423781356, -117.3557890256246, -106.0222993095716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18150133408404934, "mean_inference_ms": 0.7137065109456102, "mean_action_processing_ms": 0.09997276524239625, "mean_env_wait_ms": 0.8051479059001596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 76752, "timesteps_this_iter": 0, "agent_timesteps_total": 230256, "timers": {"sample_time_ms": 20076.535, "sample_throughput": 477.871, "load_time_ms": 0.562, "load_throughput": 17083486.553, "learn_time_ms": 3087.832, "learn_throughput": 3107.034, "update_time_ms": 9.466}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 2007.7548522949219, "policy_loss": -0.0017986593206813506, "vf_loss": 2007.8160552978516, "vf_explained_var": 0.005188502371311188, "kl": 0.0053544722650270965, "entropy": 5.945800960063934, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76752, "num_agent_steps_sampled": 230256, "num_steps_trained": 76752, "num_agent_steps_trained": 230256, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 814, "training_iteration": 8, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-46-00", "timestamp": 1706190360, "time_this_iter_s": 20.261014461517334, "time_total_s": 163.4783091545105, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA020640D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 163.4783091545105, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 7.292857142857144, "ram_util_percent": 49.267857142857146}}
{"episode_reward_max": 19.05118460208176, "episode_reward_min": -619.0747062265873, "episode_reward_mean": -255.02588776769116, "episode_len_mean": 127.91, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {"shared_policy": -215.0382622877757}, "policy_reward_max": {"shared_policy": 6.41820391764243}, "policy_reward_mean": {"shared_policy": -85.00862925589705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.10982798039913, -2.4855142123997354, -608.9395994339138, -333.1497322022915, -330.65957944095135, -334.69863452017313, -328.49619440734386, -324.79090467095375, -296.02806686237454, -50.31583176553252, -106.72563216090197, -314.4991428190842, -311.24534052610403, -30.922704100608826, -331.3104811310768, -320.65617793798447, -334.74621998518705, -46.62301202677193, -29.558195166289835, -325.47141257300973, -313.7959844172001, -290.9881471693516, -308.81030666828156, -34.82611994445324, -323.5987451374531, -317.32303543388844, -46.064708590507536, -305.9596539437771, -300.64256098121405, -303.5478735268116, -339.3366569876671, -327.5855371952057, -316.9629842042923, -301.8197153955698, -5.199718400836019, -314.50853864476085, -296.12341925501823, -323.1488575786353, -325.5080197453499, -292.9457953572273, -321.33225781749934, 7.784879479557262, -322.6335439532995, -325.1173041239381, -312.96419313549995, -322.16603723168373, -310.97761329263454, -297.373742736876, -324.38195008039474, -1.4718066453934, 19.05118460208176, -318.7071933746338, -75.00821449607633, -299.46770164370537, -331.6470807641745, -342.97617250680923, -319.4721890091896, -306.7359673976898, -286.3394525460899, -306.30399979278445, -5.709645822644248, -51.15037885308266, -308.2706589996815, -92.3961216658354, -29.085034035146236, -316.38897110521793, 18.470237657427788, -20.03615825623274, -302.8373425602913, -619.0747062265873, -324.86425995081663, -345.39919462800026, -314.0476222783327, -324.29283425211906, -294.6798515021801, -355.54056736826897, -317.5939777493477, -335.9146742671728, -45.75686221942307, -36.88586096651855, -314.66123731434345, -317.782383531332, -309.15904146432877, -312.4580555707216, -333.3793503344059, -276.367963090539, -322.41193218901753, -304.62067645043135, -330.00173383951187, -299.5738844424486, -324.4214348345995, -301.8760166466236, -13.2679437324405, -39.10219318419696, -310.2646569311619, -323.1546605825425, -318.0544364154339, -307.1991394460202, -74.24686136841785, -355.76175138354307], "episode_lengths": [128, 300, 85, 48, 68, 106, 88, 102, 98, 300, 300, 61, 70, 300, 127, 67, 82, 300, 300, 54, 55, 117, 64, 300, 72, 54, 300, 67, 76, 87, 151, 42, 80, 64, 300, 38, 70, 45, 54, 63, 70, 300, 44, 74, 63, 147, 42, 75, 47, 300, 300, 60, 300, 70, 67, 80, 74, 82, 76, 62, 300, 300, 72, 300, 300, 42, 300, 300, 47, 86, 63, 86, 78, 51, 84, 140, 52, 106, 300, 300, 53, 60, 73, 48, 50, 84, 67, 62, 71, 68, 68, 78, 300, 300, 88, 87, 41, 86, 300, 84], "policy_shared_policy_reward": [-111.53180165092151, -122.25972143809001, -111.31830489138763, -0.9852638791004864, -0.5061143028239456, -0.9941360304753033, -196.27855024673045, -212.98248624801636, -199.67856293916702, -107.17058936754863, -107.21953536073367, -118.7596074740092, -107.2559461593628, -104.61555479466915, -118.7880784869194, -106.38603580494723, -106.04076092441878, -122.2718377908071, -105.35530696312587, -104.89868285755317, -118.24220458666484, -116.25313967466354, -103.43182489275932, -105.10594010353088, -96.47962523251772, -96.07849917933345, -103.46994245052338, -16.641207640369743, -16.637808461984008, -17.03681566317877, -36.2836510638396, -35.48639885584514, -34.9555822412173, -99.47665551273774, -115.48632756868999, -99.53615973765652, -98.1064198811849, -99.62521388133368, -113.51370676358542, -9.590543031692505, -10.533364981412888, -10.798796087503433, -107.09658255179724, -106.44172062476477, -117.77217795451483, -102.50258071223895, -102.50027639667194, -115.65332082907359, -106.03611065198979, -119.78547217448553, -108.92463715871176, -15.004632930581778, -15.63912117977938, -15.979257916410774, -9.953457896908134, -9.850530808170646, -9.754206461211055, -102.09332423781356, -117.3557890256246, -106.0222993095716, -100.84649832050006, -112.53403679529826, -100.41544930140178, -107.74921290079753, -91.72739378611247, -91.51154048244159, -98.78422996401787, -111.62452584505081, -98.40155085921288, -11.634980499744415, -11.102542415261269, -12.088597029447556, -102.95150894920032, -103.59071795145671, -117.05651823679607, -101.07015954454741, -99.59739590187868, -116.65547998746237, -16.025895198186248, -14.912080784638732, -15.126732607682555, -110.4495217204094, -97.64376911520958, -97.86636310815811, -96.30516782402992, -94.91648983210325, -109.42090332508087, -110.11848346392314, -96.57264457146327, -96.8567454914252, -122.43063918749492, -109.19979340831439, -107.70622439185779, -104.92551139990489, -117.46574900547664, -105.19427678982417, -100.66306591033936, -101.12782537937164, -115.1720929145813, -111.46999025344849, -95.91211447119713, -94.43761067092419, -1.5436824907859261, -1.531214167674392, -2.124821742375701, -100.11588412895799, -100.05438534170389, -114.33826917409897, -94.48717792828879, -108.48036785920462, -93.15587346752486, -116.32755597432455, -104.12008543809256, -102.70121616621813, -105.29446695248286, -104.51188240448634, -115.70167038838069, -100.1104215780894, -95.66207150618236, -97.17330227295558, -100.58308660021673, -115.61798624197642, -105.1311849753062, 2.389282916982964, 2.546458204587296, 2.8491383579870018, -102.95814619958401, -115.75865352153778, -103.91674423217773, -102.3190794462959, -103.956723878781, -118.84150079886119, -99.05732300877571, -112.5628490447998, -101.34402108192444, -106.78520360589027, -106.01898217201233, -109.36185145378113, -98.8573488717278, -99.40784161289534, -112.71242280801138, -94.78133768339953, -94.59926624347767, -107.99313880999884, -104.0013836423556, -114.54112486044566, -105.83944157759349, -0.11588539679846122, 0.04162777463594125, -1.39754902323088, 6.41820391764243, 6.323383209606007, 6.309597474833325, -115.59773830572765, -101.52969604233901, -101.57975902656715, -24.824527728060886, -25.03225062290828, -25.151436145106956, -109.36471557617188, -95.83226388692856, -94.27072218060493, -119.1496750911077, -106.26877511044344, -106.22863056262335, -122.19917702674866, -109.93584561347961, -110.84114986658096, -102.02137184143066, -103.35750770568848, -114.09330946207047, -98.93792420625687, -110.31792104244232, -97.48012214899063, -93.31323007742564, -103.026608924071, -89.99961354459326, -110.2982539733251, -97.5129295748969, -98.49281624456248, -1.7166313963631836, -1.8252748313049523, -2.167739594976112, -17.013309240341187, -16.822720780968666, -17.314348831772804, -113.26922754446666, -97.57065708438556, -97.43077437082927, -30.98737137019635, -30.563782244920738, -30.844968050718315, -9.595653109252453, -9.6482462733984, -9.841134652495384, -101.91911711295447, -100.27170917888483, -114.19814481337866, 5.9730707705020905, 6.2572426199913025, 6.239924266934395, -7.642920970916748, -6.157230906188488, -6.236006379127502, -95.74003071089587, -110.8309186299642, -96.26639321943125, -201.69920442501706, -202.3372395137946, -215.0382622877757, -104.37614268064499, -117.55880212783813, -102.92931514233351, -123.51926877101263, -110.50861357649168, -111.37131228049597, -115.91151221593222, -99.66414763530096, -98.47196242709956, -103.62936019897461, -116.42429232597351, -104.23918172717094, -94.54614325364432, -92.92348354061446, -107.21022470792136, -114.27604358394942, -127.04101379712424, -114.22350998719534, -101.36693010727565, -114.69392995039622, -101.53311769167583, -107.11671862006187, -106.49411822855473, -122.30383741855621, -15.327154385546848, -15.203469755748912, -15.22623807812731, -12.002019902070373, -11.492732680713146, -13.39110838373503, -114.62495394547781, -100.23373730977377, -99.8025460590919, -104.8363083501657, -108.7744240363439, -104.17165114482245, -111.33402669429779, -98.71441924571991, -99.11059552431107, -113.03038156032562, -98.69796259701252, -100.72971141338348, -106.92918907602629, -107.49933387835821, -118.95082738002142, -91.10422702630362, -95.981445034345, -89.28229102989039, -116.61041949192683, -102.56515084082882, -103.2363618562619, -99.14145320653915, -109.62376356124878, -95.85545968264341, -117.61809605360031, -105.11297810077667, -107.27065968513489, -107.64968128999075, -95.69957027335963, -96.22463287909827, -106.79281425476074, -115.50510656833649, -102.12351401150227, -95.75033695002398, -95.1829487135013, -110.94273098309836, -3.744093795617431, -3.9160544996460374, -5.607795437177032, -12.966081360975906, -12.973824749390289, -13.162287073830768, -100.00564160943031, -100.00771167874336, -110.2513036429882, -115.2226297458013, -103.98572846253714, -103.94630237420401, -101.20824624101321, -115.5447078148524, -101.30148235956828, -97.21693341930708, -110.23968150218329, -99.74252452452978, -25.148004725575454, -24.663074448704727, -24.43578219413758, -113.76410151521365, -114.95098809401195, -127.04666177431743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17960702770000203, "mean_inference_ms": 0.7126156845058509, "mean_action_processing_ms": 0.09954517892364415, "mean_env_wait_ms": 0.805469230690644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 86346, "timesteps_this_iter": 0, "agent_timesteps_total": 259038, "timers": {"sample_time_ms": 20098.724, "sample_throughput": 477.344, "load_time_ms": 0.61, "load_throughput": 15740671.644, "learn_time_ms": 3088.466, "learn_throughput": 3106.396, "update_time_ms": 9.466}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 2014.4239654541016, "policy_loss": -0.0021024117255215025, "vf_loss": 2014.4849853515625, "vf_explained_var": 0.00410645455121994, "kl": 0.004158603544057459, "entropy": 5.8926631808280945, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 86346, "num_agent_steps_sampled": 259038, "num_steps_trained": 86346, "num_agent_steps_trained": 259038, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 894, "training_iteration": 9, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-46-21", "timestamp": 1706190381, "time_this_iter_s": 20.246272087097168, "time_total_s": 183.72458124160767, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03566820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 183.72458124160767, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.127586206896552, "ram_util_percent": 49.220689655172414}}
{"episode_reward_max": -13.2679437324405, "episode_reward_min": -390.51126401126396, "episode_reward_mean": -262.56558848930524, "episode_len_mean": 124.34, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {"shared_policy": -138.9407356182734}, "policy_reward_max": {"shared_policy": -3.744093795617431}, "policy_reward_mean": {"shared_policy": -87.52186282976841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.9146742671728, -45.75686221942307, -36.88586096651855, -314.66123731434345, -317.782383531332, -309.15904146432877, -312.4580555707216, -333.3793503344059, -276.367963090539, -322.41193218901753, -304.62067645043135, -330.00173383951187, -299.5738844424486, -324.4214348345995, -301.8760166466236, -13.2679437324405, -39.10219318419696, -310.2646569311619, -323.1546605825425, -318.0544364154339, -307.1991394460202, -74.24686136841785, -355.76175138354307, -335.9130207300186, -299.7675386015326, -306.46618273854256, -390.51126401126396, -278.8152940571308, -325.78534111380577, -303.1752620190382, -308.2140352129936, -338.0332852602005, -316.3354212641716, -277.7214841842652, -320.38173627853394, -291.6551948413253, -351.36514562368393, -335.00553891062737, -56.301870614290245, -308.68835151195526, -293.620577044785, -294.49232076108456, -364.8701665997505, -297.70827904343605, -305.48993891477585, -293.507376819849, -305.08943670988083, -313.8238222748041, -342.9988631606102, -318.0724236667156, -337.75707924366, -335.9238191023469, -313.58926981687546, -324.7905047237873, -322.93344027921563, -340.71862229704857, -48.1829667761922, -25.685490302741556, -337.89126697182655, -327.46194380521774, -327.0704905539751, -24.80747113376856, -332.18891793489456, -305.6516238451004, -295.5079053044319, -17.087341211736216, -330.8096214532852, -328.4331017658115, -44.87552297115327, -306.33966714143753, -335.83696287870407, -22.305287413299112, -315.5885522812605, -313.1916810274124, -316.2636922299862, -30.918265402317076, -313.46087977290154, -44.51445721834898, -351.8848423361778, -46.63707355409862, -321.498232036829, -315.26381988823414, -307.9551835209131, -19.78857584297657, -311.70376950502396, -318.3883753530681, -22.577263418585062, -312.73503535985947, -44.98642738908532, -326.949479162693, -318.43105692230165, -342.1652248501778, -336.8422533273697, -303.44108241796494, -16.866308279335527, -325.6186450570822, -327.67090716958046, -339.6006249785423, -320.7520146965981, -24.88488683104518], "episode_lengths": [106, 300, 300, 53, 60, 73, 48, 50, 84, 67, 62, 71, 68, 68, 78, 300, 300, 88, 87, 41, 86, 300, 84, 67, 74, 52, 222, 123, 55, 64, 97, 64, 60, 79, 62, 115, 123, 171, 300, 92, 58, 90, 235, 89, 84, 75, 87, 52, 69, 53, 53, 113, 94, 55, 46, 91, 300, 300, 70, 93, 63, 300, 55, 81, 108, 300, 66, 45, 300, 132, 58, 300, 72, 68, 60, 300, 51, 300, 79, 300, 76, 79, 75, 300, 80, 92, 300, 67, 300, 50, 43, 80, 70, 114, 300, 57, 173, 82, 57, 300], "policy_shared_policy_reward": [-107.11671862006187, -106.49411822855473, -122.30383741855621, -15.327154385546848, -15.203469755748912, -15.22623807812731, -12.002019902070373, -11.492732680713146, -13.39110838373503, -114.62495394547781, -100.23373730977377, -99.8025460590919, -104.8363083501657, -108.7744240363439, -104.17165114482245, -111.33402669429779, -98.71441924571991, -99.11059552431107, -113.03038156032562, -98.69796259701252, -100.72971141338348, -106.92918907602629, -107.49933387835821, -118.95082738002142, -91.10422702630362, -95.981445034345, -89.28229102989039, -116.61041949192683, -102.56515084082882, -103.2363618562619, -99.14145320653915, -109.62376356124878, -95.85545968264341, -117.61809605360031, -105.11297810077667, -107.27065968513489, -107.64968128999075, -95.69957027335963, -96.22463287909827, -106.79281425476074, -115.50510656833649, -102.12351401150227, -95.75033695002398, -95.1829487135013, -110.94273098309836, -3.744093795617431, -3.9160544996460374, -5.607795437177032, -12.966081360975906, -12.973824749390289, -13.162287073830768, -100.00564160943031, -100.00771167874336, -110.2513036429882, -115.2226297458013, -103.98572846253714, -103.94630237420401, -101.20824624101321, -115.5447078148524, -101.30148235956828, -97.21693341930708, -110.23968150218329, -99.74252452452978, -25.148004725575454, -24.663074448704727, -24.43578219413758, -113.76410151521365, -114.95098809401195, -127.04666177431743, -118.8487216035525, -104.15237269798915, -112.91192642847697, -111.22962188720703, -94.02970457263291, -94.50821214169264, -97.14260189731917, -110.16109569867453, -99.16248514254889, -125.52134105066457, -126.04918734232584, -138.9407356182734, -88.14808314045271, -101.89920445283255, -88.76800646384558, -104.02865370114645, -104.34306447704634, -117.413622935613, -97.01949108143648, -97.67605032523474, -108.479720612367, -110.37778542439143, -99.93910686175029, -97.89714292685191, -121.1266923348109, -108.23349479834239, -108.67309812704723, -99.7804446220398, -100.35873454809189, -116.19624209403992, -88.58907397588095, -89.50199361642203, -99.63041659196219, -114.82166910171509, -102.82374092936516, -102.73632624745369, -91.01360152413449, -91.93364634116492, -108.70794697602591, -112.75274208188057, -125.4887825846672, -113.12362095713615, -112.2617869079113, -111.44170925021172, -111.30204275250435, -18.180991699298225, -19.591204514106117, -18.529674400885902, -114.5648984114329, -97.71431783835094, -96.40913526217143, -107.73213227589926, -93.54610939820608, -92.3423353706797, -96.2166395932436, -96.64972165226936, -101.6259595155716, -118.16456903020541, -118.27596757809322, -128.42962999145192, -95.5560592810313, -106.75313810507457, -95.3990816573302, -111.28667604923248, -96.89077933132648, -97.31248353421688, -107.06552497545879, -93.62943611542384, -92.8124157289664, -110.12111125389735, -97.75190649429958, -97.21641896168391, -112.08139739433925, -100.01982002953689, -101.722604850928, -121.6311518351237, -109.8292605082194, -111.5384508172671, -101.60731127858162, -114.20782572031021, -102.25728666782379, -107.59028551975887, -108.28035054604213, -121.886443177859, -104.71012152979772, -106.83009837071101, -124.38359920183818, -111.83440287907919, -100.7289340098699, -101.02593292792639, -116.35487814744315, -104.42669605215391, -104.00893052419028, -116.72160096963248, -102.00320294623575, -104.20863636334738, -121.32080453634262, -110.62913435697556, -108.76868340373039, -15.607573772470161, -15.712134661773845, -16.863258341948196, -8.545563658078521, -8.359919813772052, -8.780006830890983, -108.26765975356102, -120.51539754867554, -109.10820966959, -105.01044433315596, -104.44877397020659, -118.00272550185522, -103.17763159175715, -104.91754295428595, -118.97531600793204, -8.389717906713486, -8.296218782663345, -8.121534444391727, -107.27962094545364, -107.6311753988266, -117.27812159061432, -110.04878032207489, -97.53873321413994, -98.06411030888557, -95.16431007782619, -94.24617830912273, -106.09741691748302, -6.401510039965316, -5.191413822273418, -5.494417349497482, -104.91787928342819, -119.85157835483551, -106.04016381502151, -106.04551937182745, -119.00090511639914, -103.38667727758488, -15.594519565502807, -14.758342506984874, -14.522660898665592, -111.62560164928436, -97.85152420401573, -96.86254128813744, -120.29927605390549, -109.46252578496933, -106.07516103982925, -7.311762904127448, -7.0199951504667695, -7.973529358704894, -100.55822908878326, -100.20760171115398, -114.82272148132324, -99.16430626312892, -100.15212927261989, -113.87524549166362, -114.12029912074408, -100.3371231754621, -101.80626993378004, -9.633245532711356, -11.007035513718932, -10.277984355886787, -100.33689091602962, -99.52833230296771, -113.59565655390422, -14.89303769171238, -14.844409465789795, -14.777010060846806, -112.79570215940475, -113.38394546508789, -125.70519471168518, -15.192527989546463, -15.416027861336872, -16.028517703215286, -115.11481324831645, -103.15123880902927, -103.23217997948329, -99.58888909717402, -101.53737260897955, -114.1375581820806, -99.25763946771622, -97.7181403785944, -110.97940367460251, -6.68343186378479, -6.881872862577438, -6.223271116614342, -101.97199600934982, -99.40165105462074, -110.33012244105339, -100.9546567661067, -101.58805925150713, -115.84565933545431, -7.531435459852219, -7.564520247280598, -7.481307711452246, -108.17759342988333, -101.44276954730353, -103.11467238267264, -14.167022493978351, -14.997609679897636, -15.821795215209335, -104.58329961697261, -117.17906312147777, -105.18711642424266, -101.80365390082201, -100.90649483663341, -115.72090818484625, -121.87076171239218, -109.86475249131522, -110.4297106464704, -107.83946359157562, -120.08839958906174, -108.91439014673233, -96.7698430120945, -96.73776260018349, -109.93347680568695, -5.730344322820514, -5.491648991902679, -5.6443149646123345, -104.64482680956523, -117.46308074394862, -103.51073750356834, -105.43661085764568, -116.08305064837138, -106.15124566356342, -122.25112068653107, -108.75869411230087, -108.59081017971039, -102.79089387257895, -116.12665530045828, -101.83446552356085, -7.96391957004866, -8.845212911566108, -8.075754349430412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1786551781479535, "mean_inference_ms": 0.7096348088199737, "mean_action_processing_ms": 0.09950005357849828, "mean_env_wait_ms": 0.8034164579643922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 95940, "timesteps_this_iter": 0, "agent_timesteps_total": 287820, "timers": {"sample_time_ms": 20109.372, "sample_throughput": 477.091, "load_time_ms": 0.549, "load_throughput": 17489635.16, "learn_time_ms": 3086.226, "learn_throughput": 3108.652, "update_time_ms": 9.336}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 2031.5023803710938, "policy_loss": -0.001200140083366552, "vf_loss": 2031.5634155273438, "vf_explained_var": 0.0035946518182754517, "kl": 0.004247336040863807, "entropy": 5.995414674282074, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 95940, "num_agent_steps_sampled": 287820, "num_steps_trained": 95940, "num_agent_steps_trained": 287820, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 971, "training_iteration": 10, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-46-41", "timestamp": 1706190401, "time_this_iter_s": 20.145966053009033, "time_total_s": 203.8705472946167, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0045F550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 203.8705472946167, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 6.558620689655172, "ram_util_percent": 49.275862068965516}}
{"episode_reward_max": 24.02491892874238, "episode_reward_min": -607.2386002540588, "episode_reward_mean": -247.4729275289201, "episode_len_mean": 131.72, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {"shared_policy": -210.26049097379052}, "policy_reward_max": {"shared_policy": 8.199445540706307}, "policy_reward_mean": {"shared_policy": -82.49097584297337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.2636922299862, -30.918265402317076, -313.46087977290154, -44.51445721834898, -351.8848423361778, -46.63707355409862, -321.498232036829, -315.26381988823414, -307.9551835209131, -19.78857584297657, -311.70376950502396, -318.3883753530681, -22.577263418585062, -312.73503535985947, -44.98642738908532, -326.949479162693, -318.43105692230165, -342.1652248501778, -336.8422533273697, -303.44108241796494, -16.866308279335527, -325.6186450570822, -327.67090716958046, -339.6006249785423, -320.7520146965981, -24.88488683104518, -327.29111011326313, -300.1101061105728, -300.1706764698029, -334.66748601198196, -320.054908901453, -309.605326756835, -318.9489868581295, -307.2988529279828, -319.3184815943241, 24.02491892874238, -305.4608708603773, -37.717068001627936, -332.825759768486, -331.8939644098282, -321.2032532989979, -32.34970449656251, -2.7662065029144287, -301.926391273737, -607.2386002540588, -42.511943116784124, -331.5333454310894, -21.93441627919674, -311.7806344926357, -318.0502197742462, -327.0268818438053, -313.5355156958103, -17.494362816214576, -334.56210085749626, -296.8199981749058, -332.8282715678215, -304.12196499109274, -338.9027823507786, -290.10921201109886, -337.66066414117813, -32.61915408074857, 13.083674110472174, -335.01819306612015, -318.816535115242, -311.14925026893616, -304.1107378453016, -338.8925533890724, -322.39529606699944, -297.3965653181076, -309.6572162806988, -316.84262587130075, -354.40344974398613, -321.39754751324654, -289.3259509950876, -36.00440816581251, -306.9579047858715, -306.36455517262226, -318.71912682801485, -309.72206629067665, -310.7016457915306, -51.2356628738344, -305.86158253252506, -321.9942927658558, -12.160832859575777, -301.77467092871666, -5.276518248021617, -299.4445599913597, -299.57587617635727, -344.58187568187714, 10.37282358855009, -29.51227272301915, -320.15142542123795, -86.37756566703325, -295.187149040401, -300.56796722114086, -317.24363470077515, -313.21274611353874, -319.91042566299444, -313.0189334973693, -25.67295014858246], "episode_lengths": [60, 300, 51, 300, 79, 300, 76, 79, 75, 300, 80, 92, 300, 67, 300, 50, 43, 80, 70, 114, 300, 57, 173, 82, 57, 300, 99, 124, 68, 61, 56, 55, 66, 52, 59, 300, 83, 300, 58, 69, 89, 300, 300, 82, 57, 300, 74, 300, 76, 46, 54, 71, 300, 73, 83, 72, 54, 99, 104, 97, 300, 300, 87, 46, 68, 65, 97, 38, 75, 68, 53, 129, 82, 123, 300, 62, 48, 51, 64, 63, 300, 130, 71, 300, 57, 300, 80, 74, 125, 300, 300, 78, 300, 90, 122, 63, 79, 57, 61, 300], "policy_shared_policy_reward": [-114.12029912074408, -100.3371231754621, -101.80626993378004, -9.633245532711356, -11.007035513718932, -10.277984355886787, -100.33689091602962, -99.52833230296771, -113.59565655390422, -14.89303769171238, -14.844409465789795, -14.777010060846806, -112.79570215940475, -113.38394546508789, -125.70519471168518, -15.192527989546463, -15.416027861336872, -16.028517703215286, -115.11481324831645, -103.15123880902927, -103.23217997948329, -99.58888909717402, -101.53737260897955, -114.1375581820806, -99.25763946771622, -97.7181403785944, -110.97940367460251, -6.68343186378479, -6.881872862577438, -6.223271116614342, -101.97199600934982, -99.40165105462074, -110.33012244105339, -100.9546567661067, -101.58805925150713, -115.84565933545431, -7.531435459852219, -7.564520247280598, -7.481307711452246, -108.17759342988333, -101.44276954730353, -103.11467238267264, -14.167022493978351, -14.997609679897636, -15.821795215209335, -104.58329961697261, -117.17906312147777, -105.18711642424266, -101.80365390082201, -100.90649483663341, -115.72090818484625, -121.87076171239218, -109.86475249131522, -110.4297106464704, -107.83946359157562, -120.08839958906174, -108.91439014673233, -96.7698430120945, -96.73776260018349, -109.93347680568695, -5.730344322820514, -5.491648991902679, -5.6443149646123345, -104.64482680956523, -117.46308074394862, -103.51073750356834, -105.43661085764568, -116.08305064837138, -106.15124566356342, -122.25112068653107, -108.75869411230087, -108.59081017971039, -102.79089387257895, -116.12665530045828, -101.83446552356085, -7.96391957004866, -8.845212911566108, -8.075754349430412, -104.29211207727592, -104.67758745948474, -118.32141057650249, -106.94311835368475, -96.63279854257902, -96.53418921430907, -95.73799105485281, -95.99006446202597, -108.4426209529241, -108.05943232774734, -107.68718820810318, -118.92086547613144, -101.78904063502948, -115.33156088987987, -102.93430737654369, -99.20471862951915, -98.22673001388709, -112.17387811342876, -101.90621665120125, -102.58557116985321, -114.45719903707504, -98.26765696704388, -97.97127588838339, -111.05992007255554, -102.70220684011778, -102.2520196636518, -114.36425509055456, 7.978600944081933, 8.199445540706307, 7.84687244395414, -97.36350009590387, -96.83194740698673, -111.26542335748672, -12.596431682507202, -12.605321789781257, -12.515314529339477, -107.41554353634517, -119.08880327145259, -106.32141296068828, -106.49466743071875, -119.4136263926824, -105.98567058642706, -103.0676214993, -103.25809186697006, -114.87753993272781, -11.915536781152099, -10.430044343074172, -10.004123372336238, -0.8677760809659958, -0.8765983134508133, -1.0218321084976196, -94.80189134677252, -96.24652688701948, -110.87797303994498, -210.26049097379052, -198.98076792558038, -197.99734135468805, -13.52416364600262, -13.73801274349293, -15.249766727288574, -107.53363688786825, -117.77436961730322, -106.22533892591795, -7.384095907211304, -7.042178928852081, -7.508141443133354, -112.11120579640071, -99.33477778236072, -100.33465091387431, -101.18406536181769, -102.37701179583868, -114.48914261658987, -105.1119875808557, -117.88418873151144, -104.0307055314382, -99.32135314742725, -100.03951982657115, -114.17464272181194, -5.513305912415191, -6.243979285160705, -5.737077618638679, -108.23488452037176, -107.052977313598, -119.27423902352652, -95.50213932991028, -94.95095327496529, -106.36690557003021, -119.17377398411433, -106.2160535256068, -107.43844405810039, -97.4905364116033, -98.03829326232275, -108.59313531716666, -107.69378925363223, -121.04598204294841, -110.16301105419795, -91.35878748695056, -104.69777397314708, -94.05265055100124, -107.39682231346767, -107.83402804533641, -122.42981378237407, -10.753446097175285, -10.811273554960891, -11.054434428612396, 4.313824618856103, 4.582370924452931, 4.18747856716314, -119.39229029417038, -107.0765568614006, -108.54934591054916, -101.80762850244841, -114.92499180634817, -102.08391480644545, -100.02062449852626, -110.84079871575038, -100.28782705465953, -108.86269903182983, -100.73237752914429, -94.5156612843275, -108.59980909029643, -121.38411221901576, -108.90863207976024, -101.78578514854114, -116.37140039602916, -104.23811052242915, -107.8579732577006, -95.40371147791545, -94.13488058249156, -98.92279304067294, -110.67785851160686, -100.05656472841899, -101.41821736594042, -113.41443034013113, -102.00997816522917, -114.19939180215201, -126.72006865342459, -113.48398928840956, -114.23273919026057, -102.6777471403281, -104.48706118265788, -88.92185785869758, -99.26904142896335, -101.13505170742671, -11.938081699113056, -12.075498009721443, -11.990828456978008, -108.42848587036133, -99.23010784387589, -99.29931107163429, -112.81119545300803, -96.32532173146805, -97.22803798814616, -101.09875888377428, -115.15357267856598, -102.46679526567459, -98.93965497364601, -99.10781111319861, -111.674600203832, -98.74097839991252, -100.41274921099345, -111.54791818062465, -16.99860415359339, -16.658723623802274, -17.578335096438735, -97.96424833436808, -98.26864620049795, -109.62868799765906, -103.07997332016627, -102.70144225160281, -116.21287719408672, -3.608432752390712, -3.5869117130835946, -4.96548839410147, -95.87686384717624, -108.68971238533656, -97.20809469620387, -2.123983765641853, -1.782262067000076, -1.370272415379688, -95.3177455663681, -95.42637354135513, -108.70044088363647, -95.9922067920367, -106.31110266844432, -97.27256671587627, -110.21175400416057, -111.48886011044185, -122.88126156727473, 3.195446953177452, 3.634822964668274, 3.5425536707043648, -9.620166738828033, -9.42368691911301, -10.468419065078109, -102.00789614518484, -114.85395415623984, -103.28957511981329, -27.56094941000144, -28.81547586123149, -30.001140395800277, -93.29273906598489, -106.51171729962032, -95.38269267479579, -109.34281120697658, -95.81350180010001, -95.41165421406428, -100.69252548615138, -102.01032994190852, -114.54077927271526, -113.851509253184, -99.93135363856952, -99.42988322178523, -103.14779533942541, -102.45282663901648, -114.30980368455252, -97.73081080367169, -113.39104433854422, -101.89707835515341, -8.617786169052124, -8.193705379962921, -8.861458599567413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17848724114554937, "mean_inference_ms": 0.7108035421577636, "mean_action_processing_ms": 0.09948214842621876, "mean_env_wait_ms": 0.8065682983533755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 105534, "timesteps_this_iter": 0, "agent_timesteps_total": 316602, "timers": {"sample_time_ms": 20397.233, "sample_throughput": 470.358, "load_time_ms": 0.549, "load_throughput": 17489635.16, "learn_time_ms": 3077.96, "learn_throughput": 3117.0, "update_time_ms": 9.362}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 1865.326904296875, "policy_loss": -0.0017142421841027655, "vf_loss": 1865.3882751464844, "vf_explained_var": 0.0043421462178230286, "kl": 0.003788196812822236, "entropy": 5.965469777584076, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105534, "num_agent_steps_sampled": 316602, "num_steps_trained": 105534, "num_agent_steps_trained": 316602, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1045, "training_iteration": 11, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-47-01", "timestamp": 1706190421, "time_this_iter_s": 20.3922016620636, "time_total_s": 224.2627489566803, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 224.2627489566803, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 8.403571428571428, "ram_util_percent": 49.328571428571436}}
{"episode_reward_max": 33.835407823324175, "episode_reward_min": -354.40344974398613, "episode_reward_mean": -225.48865482231136, "episode_len_mean": 146.62, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {"shared_policy": -126.72006865342459}, "policy_reward_max": {"shared_policy": 11.51316166917482}, "policy_reward_mean": {"shared_policy": -75.16288494077045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-337.66066414117813, -32.61915408074857, 13.083674110472174, -335.01819306612015, -318.816535115242, -311.14925026893616, -304.1107378453016, -338.8925533890724, -322.39529606699944, -297.3965653181076, -309.6572162806988, -316.84262587130075, -354.40344974398613, -321.39754751324654, -289.3259509950876, -36.00440816581251, -306.9579047858715, -306.36455517262226, -318.71912682801485, -309.72206629067665, -310.7016457915306, -51.2356628738344, -305.86158253252506, -321.9942927658558, -12.160832859575777, -301.77467092871666, -5.276518248021617, -299.4445599913597, -299.57587617635727, -344.58187568187714, 10.37282358855009, -29.51227272301915, -320.15142542123795, -86.37756566703325, -295.187149040401, -300.56796722114086, -317.24363470077515, -313.21274611353874, -319.91042566299444, -313.0189334973693, -25.67295014858246, -29.166304521262674, -310.06942600011826, -288.65821298956877, -331.0623737573624, -271.8871489614248, -18.16451621055603, -324.1591415405274, -3.9158121161162995, -264.8308127261698, -59.476934686303146, 33.835407823324175, -347.71475556492805, -311.2118938565254, -319.6064444184303, -71.23670834302911, -300.33843120187527, -60.98748280853035, -334.0806525051594, -53.0523163303733, 6.465471226721974, -7.302447199821472, -300.2087212651968, -318.9445263147354, -298.4079796075821, -23.90096236020328, -291.5058519542217, -306.2820837199688, -301.38463109731674, -48.483229875564604, -290.77487203478813, -55.26265989243985, -301.53890588879585, -331.86853581666946, -2.9780170284211636, -343.92367324233055, -9.73691663891077, -332.2378309816122, -291.61620338261133, -325.1499734967947, -297.30124148726463, -301.9854929447174, -324.2442451566458, -279.07984264194965, -272.0072212815285, -319.4114557802677, -68.80947177857163, -299.50633895397186, -345.5923462747597, -304.10032147169113, -273.9515581279993, -314.03557692468166, -298.47111128270626, -297.420092433691, -7.624250911176205, -36.421132057905226, -54.65464223921302, -288.24048528075224, -314.5217607319355, 6.79950810223815], "episode_lengths": [97, 300, 300, 87, 46, 68, 65, 97, 38, 75, 68, 53, 129, 82, 123, 300, 62, 48, 51, 64, 63, 300, 130, 71, 300, 57, 300, 80, 74, 125, 300, 300, 78, 300, 90, 122, 63, 79, 57, 61, 300, 300, 47, 91, 58, 90, 300, 53, 300, 124, 300, 300, 87, 110, 77, 300, 93, 300, 89, 300, 300, 300, 201, 83, 60, 300, 78, 67, 84, 300, 134, 300, 53, 44, 300, 102, 300, 59, 84, 72, 94, 44, 141, 97, 84, 68, 300, 77, 108, 96, 67, 99, 53, 59, 300, 300, 300, 71, 61, 300], "policy_shared_policy_reward": [-107.39682231346767, -107.83402804533641, -122.42981378237407, -10.753446097175285, -10.811273554960891, -11.054434428612396, 4.313824618856103, 4.582370924452931, 4.18747856716314, -119.39229029417038, -107.0765568614006, -108.54934591054916, -101.80762850244841, -114.92499180634817, -102.08391480644545, -100.02062449852626, -110.84079871575038, -100.28782705465953, -108.86269903182983, -100.73237752914429, -94.5156612843275, -108.59980909029643, -121.38411221901576, -108.90863207976024, -101.78578514854114, -116.37140039602916, -104.23811052242915, -107.8579732577006, -95.40371147791545, -94.13488058249156, -98.92279304067294, -110.67785851160686, -100.05656472841899, -101.41821736594042, -113.41443034013113, -102.00997816522917, -114.19939180215201, -126.72006865342459, -113.48398928840956, -114.23273919026057, -102.6777471403281, -104.48706118265788, -88.92185785869758, -99.26904142896335, -101.13505170742671, -11.938081699113056, -12.075498009721443, -11.990828456978008, -108.42848587036133, -99.23010784387589, -99.29931107163429, -112.81119545300803, -96.32532173146805, -97.22803798814616, -101.09875888377428, -115.15357267856598, -102.46679526567459, -98.93965497364601, -99.10781111319861, -111.674600203832, -98.74097839991252, -100.41274921099345, -111.54791818062465, -16.99860415359339, -16.658723623802274, -17.578335096438735, -97.96424833436808, -98.26864620049795, -109.62868799765906, -103.07997332016627, -102.70144225160281, -116.21287719408672, -3.608432752390712, -3.5869117130835946, -4.96548839410147, -95.87686384717624, -108.68971238533656, -97.20809469620387, -2.123983765641853, -1.782262067000076, -1.370272415379688, -95.3177455663681, -95.42637354135513, -108.70044088363647, -95.9922067920367, -106.31110266844432, -97.27256671587627, -110.21175400416057, -111.48886011044185, -122.88126156727473, 3.195446953177452, 3.634822964668274, 3.5425536707043648, -9.620166738828033, -9.42368691911301, -10.468419065078109, -102.00789614518484, -114.85395415623984, -103.28957511981329, -27.56094941000144, -28.81547586123149, -30.001140395800277, -93.29273906598489, -106.51171729962032, -95.38269267479579, -109.34281120697658, -95.81350180010001, -95.41165421406428, -100.69252548615138, -102.01032994190852, -114.54077927271526, -113.851509253184, -99.93135363856952, -99.42988322178523, -103.14779533942541, -102.45282663901648, -114.30980368455252, -97.73081080367169, -113.39104433854422, -101.89707835515341, -8.617786169052124, -8.193705379962921, -8.861458599567413, -9.531352487703174, -9.821719234188407, -9.813232799371093, -105.3835149606069, -102.92065491278967, -101.76525612672171, -93.20632933576903, -92.09127946694693, -103.36060418685278, -118.92684586842856, -105.94374098380408, -106.19178690512976, -87.16932141780853, -98.72758650779724, -85.99024103581905, -5.469970792531967, -5.742717921733856, -6.951827496290207, -103.81520064671835, -116.26072736581168, -104.08321352799734, -1.8184640208880154, -0.602943799148008, -1.4944042960802761, -85.39233390490215, -95.84183696905772, -83.59664185220997, -19.72406097253164, -19.639820312460266, -20.11305340131124, 11.51316166917482, 11.186743612090737, 11.135502542058617, -109.79671668012938, -124.75947495301565, -113.15856393178305, -99.11330386996269, -112.30129271745682, -99.79729726910591, -102.18708024422328, -101.93952516714732, -115.47983900705974, -24.40464641650518, -24.061048289140068, -22.77101363738378, -109.33775075276694, -96.78262718518576, -94.21805326392254, -19.33209481090308, -21.253231823444374, -20.4021561741829, -106.56881642341614, -120.24540823698044, -107.2664278447628, -17.584584313134357, -17.659999425212547, -17.807732592026397, 2.5256841468314235, 1.9450941334168022, 1.994692946473748, -2.3319449573755264, -2.46055106818676, -2.509951174259186, -95.96012166142464, -107.9834953546524, -96.26510424911976, -102.57633874813716, -113.64827046791713, -102.71991709868114, -96.88556124766669, -95.6859447558721, -105.83647360404333, -8.136221642295524, -7.968125293652221, -7.796615424255535, -98.74669553836188, -97.14216740926108, -95.6169890065988, -98.62942150235176, -98.43680506944656, -109.21585714817047, -108.5815018415451, -96.40539288520813, -96.3977363705635, -16.071082924803108, -16.57069688042006, -15.841450070341438, -104.66381456454596, -93.1620332201322, -92.94902425011, -17.80798431237539, -18.316481744249664, -19.138193835814796, -96.31106548508009, -108.91729362805685, -96.31054677565893, -106.68925631046295, -119.34688198566437, -105.83239752054214, -1.4627071768045425, -0.9356798902153969, -0.5796299614012241, -110.72876842816672, -110.085259248813, -123.10964556535086, -2.1493385955691338, -2.741858944296837, -4.8457190990448, -104.46612291038036, -119.00905251502991, -108.76265555620193, -104.64013381799063, -91.42108074327311, -95.55498882134756, -115.88662378986677, -104.00020912786326, -105.2631405790647, -95.6049652993679, -106.90474158525467, -94.79153460264206, -100.3644777139028, -98.87150832017264, -102.749506910642, -109.25608349839847, -107.72988537202279, -107.25827628622453, -89.65227117141089, -100.93527366717657, -88.49229780336222, -88.78640959660213, -92.84867386023204, -90.37213782469432, -102.08168534437816, -102.67250342170398, -114.65726701418559, -21.998189282914005, -23.57047044237455, -23.240812053283058, -95.89052124818167, -107.84504904349646, -95.77076866229376, -111.23996015389761, -109.56639008115357, -124.78599603970846, -97.11079809069633, -108.95630526542664, -98.03321811556816, -91.78176299730937, -92.78751597801845, -89.3822791526715, -101.58359814683597, -100.32764565447967, -112.12433312336604, -107.45190997918448, -93.5478369643291, -97.47136433919272, -97.33583934108417, -100.22269509236018, -99.86155800024669, -2.4185438454151154, -2.7772286534309387, -2.4284784123301506, -12.00701213379702, -11.780495261152595, -12.633624662955611, -18.696419139703124, -17.621511285503715, -18.33671181400618, -104.16013338168463, -91.43206097682318, -92.6482909222444, -113.1841938495636, -100.02121838927269, -101.31634849309921, 2.6473360980550353, 2.141701663533837, 2.0104703406492774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17781708196758467, "mean_inference_ms": 0.7116535420650485, "mean_action_processing_ms": 0.09955646645879736, "mean_env_wait_ms": 0.8089312003514658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 115128, "timesteps_this_iter": 0, "agent_timesteps_total": 345384, "timers": {"sample_time_ms": 20413.791, "sample_throughput": 469.976, "load_time_ms": 0.549, "load_throughput": 17489635.16, "learn_time_ms": 3071.081, "learn_throughput": 3123.981, "update_time_ms": 9.36}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 1163.1990356445312, "policy_loss": -0.0015002792418045696, "vf_loss": 1163.2604675292969, "vf_explained_var": 0.00330556184053421, "kl": 0.005385222550105066, "entropy": 5.994483470916748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115128, "num_agent_steps_sampled": 345384, "num_steps_trained": 115128, "num_agent_steps_trained": 345384, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1104, "training_iteration": 12, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-47-22", "timestamp": 1706190442, "time_this_iter_s": 20.706512212753296, "time_total_s": 244.9692611694336, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B28040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 244.9692611694336, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.76, "ram_util_percent": 49.45666666666666}}
{"episode_reward_max": 40.24884147942063, "episode_reward_min": -347.71475556492805, "episode_reward_mean": -183.81200549384113, "episode_len_mean": 179.69, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {"shared_policy": -124.78599603970846}, "policy_reward_max": {"shared_policy": 13.834619070092828}, "policy_reward_mean": {"shared_policy": -61.27066849794704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.8308127261698, -59.476934686303146, 33.835407823324175, -347.71475556492805, -311.2118938565254, -319.6064444184303, -71.23670834302911, -300.33843120187527, -60.98748280853035, -334.0806525051594, -53.0523163303733, 6.465471226721974, -7.302447199821472, -300.2087212651968, -318.9445263147354, -298.4079796075821, -23.90096236020328, -291.5058519542217, -306.2820837199688, -301.38463109731674, -48.483229875564604, -290.77487203478813, -55.26265989243985, -301.53890588879585, -331.86853581666946, -2.9780170284211636, -343.92367324233055, -9.73691663891077, -332.2378309816122, -291.61620338261133, -325.1499734967947, -297.30124148726463, -301.9854929447174, -324.2442451566458, -279.07984264194965, -272.0072212815285, -319.4114557802677, -68.80947177857163, -299.50633895397186, -345.5923462747597, -304.10032147169113, -273.9515581279993, -314.03557692468166, -298.47111128270626, -297.420092433691, -7.624250911176205, -36.421132057905226, -54.65464223921302, -288.24048528075224, -314.5217607319355, 6.79950810223815, 40.24884147942063, -48.50011724233627, -6.798643924295931, -3.827806338667884, -297.01306952536106, -295.17416729032993, -47.73758542537692, -343.4356213361025, -320.1544765532017, -289.7532756328583, -82.2265410199762, -10.995248839259148, -28.989241436123876, -313.4563520550728, -60.595096543431296, -40.7880094125867, -11.953915616497426, -318.7349429652095, -50.109927564859404, -318.64515256881714, -317.06109005212784, -52.907501347362995, -321.49443097785115, -14.219795644283323, -302.1610037982464, -38.08293327689172, -41.47351527214052, -16.574332892894773, -23.501823335886016, -304.80038100481033, -17.47997640073301, -325.5344241559506, -301.30911971628666, -309.52368945255876, -25.224160827696352, -303.45165222138166, -40.207632251083865, -304.97076076082885, -333.0168566405773, -29.945463165640845, -36.75863377004863, -49.179760597646265, -29.643914677202716, -31.321648381650462, -18.308651745319366, -35.707991290837555, -309.01733380556107, -313.40839794278145, -331.9506693184376], "episode_lengths": [124, 300, 300, 87, 110, 77, 300, 93, 300, 89, 300, 300, 300, 201, 83, 60, 300, 78, 67, 84, 300, 134, 300, 53, 44, 300, 102, 300, 59, 84, 72, 94, 44, 141, 97, 84, 68, 300, 77, 108, 96, 67, 99, 53, 59, 300, 300, 300, 71, 61, 300, 300, 300, 300, 300, 72, 125, 300, 86, 108, 92, 300, 300, 300, 53, 300, 300, 300, 46, 300, 84, 72, 300, 53, 300, 37, 300, 300, 300, 300, 63, 300, 70, 111, 67, 300, 53, 300, 68, 57, 300, 300, 300, 300, 300, 300, 300, 83, 79, 70], "policy_shared_policy_reward": [-85.39233390490215, -95.84183696905772, -83.59664185220997, -19.72406097253164, -19.639820312460266, -20.11305340131124, 11.51316166917482, 11.186743612090737, 11.135502542058617, -109.79671668012938, -124.75947495301565, -113.15856393178305, -99.11330386996269, -112.30129271745682, -99.79729726910591, -102.18708024422328, -101.93952516714732, -115.47983900705974, -24.40464641650518, -24.061048289140068, -22.77101363738378, -109.33775075276694, -96.78262718518576, -94.21805326392254, -19.33209481090308, -21.253231823444374, -20.4021561741829, -106.56881642341614, -120.24540823698044, -107.2664278447628, -17.584584313134357, -17.659999425212547, -17.807732592026397, 2.5256841468314235, 1.9450941334168022, 1.994692946473748, -2.3319449573755264, -2.46055106818676, -2.509951174259186, -95.96012166142464, -107.9834953546524, -96.26510424911976, -102.57633874813716, -113.64827046791713, -102.71991709868114, -96.88556124766669, -95.6859447558721, -105.83647360404333, -8.136221642295524, -7.968125293652221, -7.796615424255535, -98.74669553836188, -97.14216740926108, -95.6169890065988, -98.62942150235176, -98.43680506944656, -109.21585714817047, -108.5815018415451, -96.40539288520813, -96.3977363705635, -16.071082924803108, -16.57069688042006, -15.841450070341438, -104.66381456454596, -93.1620332201322, -92.94902425011, -17.80798431237539, -18.316481744249664, -19.138193835814796, -96.31106548508009, -108.91729362805685, -96.31054677565893, -106.68925631046295, -119.34688198566437, -105.83239752054214, -1.4627071768045425, -0.9356798902153969, -0.5796299614012241, -110.72876842816672, -110.085259248813, -123.10964556535086, -2.1493385955691338, -2.741858944296837, -4.8457190990448, -104.46612291038036, -119.00905251502991, -108.76265555620193, -104.64013381799063, -91.42108074327311, -95.55498882134756, -115.88662378986677, -104.00020912786326, -105.2631405790647, -95.6049652993679, -106.90474158525467, -94.79153460264206, -100.3644777139028, -98.87150832017264, -102.749506910642, -109.25608349839847, -107.72988537202279, -107.25827628622453, -89.65227117141089, -100.93527366717657, -88.49229780336222, -88.78640959660213, -92.84867386023204, -90.37213782469432, -102.08168534437816, -102.67250342170398, -114.65726701418559, -21.998189282914005, -23.57047044237455, -23.240812053283058, -95.89052124818167, -107.84504904349646, -95.77076866229376, -111.23996015389761, -109.56639008115357, -124.78599603970846, -97.11079809069633, -108.95630526542664, -98.03321811556816, -91.78176299730937, -92.78751597801845, -89.3822791526715, -101.58359814683597, -100.32764565447967, -112.12433312336604, -107.45190997918448, -93.5478369643291, -97.47136433919272, -97.33583934108417, -100.22269509236018, -99.86155800024669, -2.4185438454151154, -2.7772286534309387, -2.4284784123301506, -12.00701213379702, -11.780495261152595, -12.633624662955611, -18.696419139703124, -17.621511285503715, -18.33671181400618, -104.16013338168463, -91.43206097682318, -92.6482909222444, -113.1841938495636, -100.02121838927269, -101.31634849309921, 2.6473360980550353, 2.141701663533837, 2.0104703406492774, 13.119788388411195, 13.294434020916611, 13.834619070092828, -16.364151149988174, -15.949364811182022, -16.186601281166077, -1.8493092333277161, -2.254095961650222, -2.6952387293179925, -1.435230473677322, -1.2657097975413052, -1.1268660674492565, -102.15118757883708, -97.31992884973685, -97.54195309678714, -107.53388138612112, -94.22233240803084, -93.417953496178, -16.013007154067367, -15.755453397830337, -15.969124873479217, -110.43413378298283, -110.86731493473053, -122.13417261838913, -102.88818923632304, -101.84159291783969, -115.42469439903896, -92.46479619542758, -92.59378958741824, -104.69468985001247, -28.045452664295837, -27.348396236697837, -26.83269211898248, -4.074762433767319, -3.663028299808502, -3.2574581056833267, -9.530519252022117, -9.705449124177306, -9.753273059924453, -100.02154881755511, -100.7720875243346, -112.66271571318309, -20.15306066970031, -20.320798868934318, -20.12123700479667, -12.986299688617393, -13.031447860101864, -14.770261863867447, -3.9927150209744866, -2.9354002879311736, -5.025800307591766, -101.16235813498497, -116.26820778846741, -101.3043770417571, -16.431725020209953, -16.479225749770805, -17.198976794878647, -102.20309594273567, -103.16148155927658, -113.28057506680489, -114.2147353887558, -102.20185136795044, -100.6445032954216, -17.239735685288906, -18.07720720767975, -17.59055845439434, -101.00861841316025, -103.18762145439784, -117.29819111029308, -4.4978528444965775, -4.658371952672809, -5.063570847113937, -100.03880426287651, -101.66651725769043, -100.45568227767944, -12.126130263010666, -12.429132709900543, -13.527670303980514, -14.15817839900653, -14.262682626644775, -13.052654246489212, -5.685237457354873, -5.450172049303859, -5.438923386236041, -7.733251581589386, -7.977692166964218, -7.790879587332412, -101.18045417467754, -103.73381970326106, -99.88610712687175, -6.725547681252166, -5.282638589541122, -5.47179012993972, -110.86436330278715, -112.24962784846625, -102.42043300469717, -110.39489960670471, -96.22531345486641, -94.68890665471554, -112.06214896837871, -99.42759341994922, -98.03394706423084, -8.276875247557967, -7.807503757377475, -9.13978182276091, -104.86435031890869, -99.675067871809, -98.91223403066397, -13.150063390533134, -13.76999729375045, -13.287571566800281, -97.04928957422575, -94.84691511405012, -113.07455607255301, -107.10603675246239, -119.99805158376694, -105.91276830434799, -9.519191781679794, -9.166102136174842, -11.260169247786209, -11.988889808456108, -11.821512552599117, -12.948231408993408, -16.525904898842185, -16.267786090572685, -16.386069608231395, -10.05953585604827, -9.925552884737655, -9.65882593641679, -10.322408075133964, -10.546163427333042, -10.453076879183456, -5.75181782245636, -5.032181739807129, -7.524652183055878, -11.86617096265158, -12.38400657971701, -11.457813748468965, -113.68317488829295, -97.43726093570392, -97.89689798156421, -99.018311470747, -99.17656224966049, -115.21352422237396, -119.59431485335033, -107.40915195147197, -104.9472025136153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1765603908633889, "mean_inference_ms": 0.712027035514271, "mean_action_processing_ms": 0.09963561828121259, "mean_env_wait_ms": 0.8099978102409047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 124722, "timesteps_this_iter": 0, "agent_timesteps_total": 374166, "timers": {"sample_time_ms": 20410.97, "sample_throughput": 470.041, "load_time_ms": 0.549, "load_throughput": 17489635.16, "learn_time_ms": 3076.868, "learn_throughput": 3118.106, "update_time_ms": 9.46}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 669.738883972168, "policy_loss": -0.0025411588862128687, "vf_loss": 669.7996215820312, "vf_explained_var": 0.003373183310031891, "kl": 0.007521504427133436, "entropy": 5.8165934681892395, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124722, "num_agent_steps_sampled": 374166, "num_steps_trained": 124722, "num_agent_steps_trained": 374166, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1153, "training_iteration": 13, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-47-42", "timestamp": 1706190462, "time_this_iter_s": 20.41200280189514, "time_total_s": 265.38126397132874, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.38126397132874, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 8.96896551724138, "ram_util_percent": 49.58275862068965}}
{"episode_reward_max": 40.24884147942063, "episode_reward_min": -345.5923462747597, "episode_reward_mean": -133.6416511288984, "episode_len_mean": 215.61, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -124.78599603970846}, "policy_reward_max": {"shared_policy": 13.834619070092828}, "policy_reward_mean": {"shared_policy": -44.54721704296614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.07984264194965, -272.0072212815285, -319.4114557802677, -68.80947177857163, -299.50633895397186, -345.5923462747597, -304.10032147169113, -273.9515581279993, -314.03557692468166, -298.47111128270626, -297.420092433691, -7.624250911176205, -36.421132057905226, -54.65464223921302, -288.24048528075224, -314.5217607319355, 6.79950810223815, 40.24884147942063, -48.50011724233627, -6.798643924295931, -3.827806338667884, -297.01306952536106, -295.17416729032993, -47.73758542537692, -343.4356213361025, -320.1544765532017, -289.7532756328583, -82.2265410199762, -10.995248839259148, -28.989241436123876, -313.4563520550728, -60.595096543431296, -40.7880094125867, -11.953915616497426, -318.7349429652095, -50.109927564859404, -318.64515256881714, -317.06109005212784, -52.907501347362995, -321.49443097785115, -14.219795644283323, -302.1610037982464, -38.08293327689172, -41.47351527214052, -16.574332892894773, -23.501823335886016, -304.80038100481033, -17.47997640073301, -325.5344241559506, -301.30911971628666, -309.52368945255876, -25.224160827696352, -303.45165222138166, -40.207632251083865, -304.97076076082885, -333.0168566405773, -29.945463165640845, -36.75863377004863, -49.179760597646265, -29.643914677202716, -31.321648381650462, -18.308651745319366, -35.707991290837555, -309.01733380556107, -313.40839794278145, -331.9506693184376, -58.68610195070507, 20.468033477663994, -7.942975461483016, -30.479076255112886, 0.06942639872431755, -12.66288373619318, -24.58379523456098, -12.306763360276847, -326.9010783061385, -42.78342890739444, -26.65935391932726, -8.923958167433739, 7.942933723330498, -34.37534853070976, -4.439041152596474, 1.5426064729690268, -69.60769598931066, -24.558761917054667, -0.24421410635116558, -51.51049753651023, -28.900773949921145, -0.7639507725834846, -7.364674620330362, -1.3568349033594416, -298.4533032923937, -30.558589614927783, -41.686769269406824, -323.81054373085504, -23.539944030344486, -37.668688826262965, -22.228055775165558, -58.959599331021316, -283.399078104645, -304.90633760392666], "episode_lengths": [97, 84, 68, 300, 77, 108, 96, 67, 99, 53, 59, 300, 300, 300, 71, 61, 300, 300, 300, 300, 300, 72, 125, 300, 86, 108, 92, 300, 300, 300, 53, 300, 300, 300, 46, 300, 84, 72, 300, 53, 300, 37, 300, 300, 300, 300, 63, 300, 70, 111, 67, 300, 53, 300, 68, 57, 300, 300, 300, 300, 300, 300, 300, 83, 79, 70, 300, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 95, 300, 300, 82, 300, 300, 300, 300, 102, 74], "policy_shared_policy_reward": [-89.65227117141089, -100.93527366717657, -88.49229780336222, -88.78640959660213, -92.84867386023204, -90.37213782469432, -102.08168534437816, -102.67250342170398, -114.65726701418559, -21.998189282914005, -23.57047044237455, -23.240812053283058, -95.89052124818167, -107.84504904349646, -95.77076866229376, -111.23996015389761, -109.56639008115357, -124.78599603970846, -97.11079809069633, -108.95630526542664, -98.03321811556816, -91.78176299730937, -92.78751597801845, -89.3822791526715, -101.58359814683597, -100.32764565447967, -112.12433312336604, -107.45190997918448, -93.5478369643291, -97.47136433919272, -97.33583934108417, -100.22269509236018, -99.86155800024669, -2.4185438454151154, -2.7772286534309387, -2.4284784123301506, -12.00701213379702, -11.780495261152595, -12.633624662955611, -18.696419139703124, -17.621511285503715, -18.33671181400618, -104.16013338168463, -91.43206097682318, -92.6482909222444, -113.1841938495636, -100.02121838927269, -101.31634849309921, 2.6473360980550353, 2.141701663533837, 2.0104703406492774, 13.119788388411195, 13.294434020916611, 13.834619070092828, -16.364151149988174, -15.949364811182022, -16.186601281166077, -1.8493092333277161, -2.254095961650222, -2.6952387293179925, -1.435230473677322, -1.2657097975413052, -1.1268660674492565, -102.15118757883708, -97.31992884973685, -97.54195309678714, -107.53388138612112, -94.22233240803084, -93.417953496178, -16.013007154067367, -15.755453397830337, -15.969124873479217, -110.43413378298283, -110.86731493473053, -122.13417261838913, -102.88818923632304, -101.84159291783969, -115.42469439903896, -92.46479619542758, -92.59378958741824, -104.69468985001247, -28.045452664295837, -27.348396236697837, -26.83269211898248, -4.074762433767319, -3.663028299808502, -3.2574581056833267, -9.530519252022117, -9.705449124177306, -9.753273059924453, -100.02154881755511, -100.7720875243346, -112.66271571318309, -20.15306066970031, -20.320798868934318, -20.12123700479667, -12.986299688617393, -13.031447860101864, -14.770261863867447, -3.9927150209744866, -2.9354002879311736, -5.025800307591766, -101.16235813498497, -116.26820778846741, -101.3043770417571, -16.431725020209953, -16.479225749770805, -17.198976794878647, -102.20309594273567, -103.16148155927658, -113.28057506680489, -114.2147353887558, -102.20185136795044, -100.6445032954216, -17.239735685288906, -18.07720720767975, -17.59055845439434, -101.00861841316025, -103.18762145439784, -117.29819111029308, -4.4978528444965775, -4.658371952672809, -5.063570847113937, -100.03880426287651, -101.66651725769043, -100.45568227767944, -12.126130263010666, -12.429132709900543, -13.527670303980514, -14.15817839900653, -14.262682626644775, -13.052654246489212, -5.685237457354873, -5.450172049303859, -5.438923386236041, -7.733251581589386, -7.977692166964218, -7.790879587332412, -101.18045417467754, -103.73381970326106, -99.88610712687175, -6.725547681252166, -5.282638589541122, -5.47179012993972, -110.86436330278715, -112.24962784846625, -102.42043300469717, -110.39489960670471, -96.22531345486641, -94.68890665471554, -112.06214896837871, -99.42759341994922, -98.03394706423084, -8.276875247557967, -7.807503757377475, -9.13978182276091, -104.86435031890869, -99.675067871809, -98.91223403066397, -13.150063390533134, -13.76999729375045, -13.287571566800281, -97.04928957422575, -94.84691511405012, -113.07455607255301, -107.10603675246239, -119.99805158376694, -105.91276830434799, -9.519191781679794, -9.166102136174842, -11.260169247786209, -11.988889808456108, -11.821512552599117, -12.948231408993408, -16.525904898842185, -16.267786090572685, -16.386069608231395, -10.05953585604827, -9.925552884737655, -9.65882593641679, -10.322408075133964, -10.546163427333042, -10.453076879183456, -5.75181782245636, -5.032181739807129, -7.524652183055878, -11.86617096265158, -12.38400657971701, -11.457813748468965, -113.68317488829295, -97.43726093570392, -97.89689798156421, -99.018311470747, -99.17656224966049, -115.21352422237396, -119.59431485335033, -107.40915195147197, -104.9472025136153, -20.99012917280198, -18.630452811717994, -19.0655199661851, 6.803549528121948, 7.274990826845169, 6.3894931226968765, -2.64106708268325, -2.8225589046875683, -2.4793494741121975, -10.070770107209682, -10.049940910190344, -10.35836523771286, -0.26508769392967224, -0.028407149016857147, 0.36292124167084694, -4.300309978425503, -4.225371666252613, -4.137202091515064, -7.479884977142021, -7.956430594126388, -9.147479663292572, -3.2109852128972705, -4.779011448224395, -4.316766699155181, -103.71474765489499, -103.87336414555709, -119.31296650568645, -12.883228768905013, -13.714344908793777, -16.185855229695647, -9.978034019470215, -8.120642311871052, -8.560677587985992, -2.9136761277914047, -2.7664707601070404, -3.2438112795352936, 2.738668143749237, 2.824505388736725, 2.379760190844536, -11.041633235911533, -11.721748794118568, -11.611966500679657, -1.0330982953310013, -2.3506051003932953, -1.0553377568721771, 0.5190632144609992, 0.49280349413552926, 0.5307397643724983, -23.314529513319336, -23.033106481035553, -23.26005999495586, -7.684111687044307, -8.136495331923172, -8.738154898087188, -0.09924740840992285, 0.03868036592999147, -0.1836470638712342, -18.210845589637756, -16.937747225165367, -16.361904721707106, -9.12824520717065, -9.473273659745857, -10.299255083004638, 0.01744651049375534, -0.12445802986621857, -0.6569392532110214, -2.156693575282901, -2.430552219351142, -2.777428825696319, -0.24233879645666434, -0.40053049226602866, -0.7139656146367486, -96.39735041062038, -95.33564692238967, -106.72030595938365, -11.282302896181747, -9.647314707438156, -9.62897201130788, -13.61154913653931, -14.06666669746241, -14.008553435405105, -111.59058936436972, -105.17475560804209, -107.0451987584432, -8.12236838042736, -7.412419505417347, -8.005156144499779, -12.328810172776386, -12.46135350565116, -12.878525147835418, -7.252759248018265, -7.52471736073494, -7.4505791664123535, -19.515780349572502, -19.31888467570146, -20.124934305747352, -88.31734757994613, -89.57772107919058, -105.50400944550833, -96.92425620059173, -110.12011770407359, -97.86196369926135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1755555718577507, "mean_inference_ms": 0.7119412464205598, "mean_action_processing_ms": 0.0996229329708214, "mean_env_wait_ms": 0.8100548548023164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 134316, "timesteps_this_iter": 0, "agent_timesteps_total": 402948, "timers": {"sample_time_ms": 20438.883, "sample_throughput": 469.399, "load_time_ms": 0.449, "load_throughput": 21347561.048, "learn_time_ms": 3080.626, "learn_throughput": 3114.302, "update_time_ms": 9.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 256.9686470031738, "policy_loss": -0.0019037613175318935, "vf_loss": 257.0284423828125, "vf_explained_var": 0.004100032150745392, "kl": 0.005830964397320702, "entropy": 5.789496839046478, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 134316, "num_agent_steps_sampled": 402948, "num_steps_trained": 134316, "num_agent_steps_trained": 402948, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1187, "training_iteration": 14, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-48-03", "timestamp": 1706190483, "time_this_iter_s": 20.780646800994873, "time_total_s": 286.1619107723236, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B3D3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 286.1619107723236, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 8.144827586206896, "ram_util_percent": 49.54137931034482}}
{"episode_reward_max": 24.634611755609512, "episode_reward_min": -378.33716310560703, "episode_reward_mean": -100.69654529338703, "episode_len_mean": 242.31, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {"shared_policy": -136.3871995608012}, "policy_reward_max": {"shared_policy": 8.2583387196064}, "policy_reward_mean": {"shared_policy": -33.56551509779568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.06109005212784, -52.907501347362995, -321.49443097785115, -14.219795644283323, -302.1610037982464, -38.08293327689172, -41.47351527214052, -16.574332892894773, -23.501823335886016, -304.80038100481033, -17.47997640073301, -325.5344241559506, -301.30911971628666, -309.52368945255876, -25.224160827696352, -303.45165222138166, -40.207632251083865, -304.97076076082885, -333.0168566405773, -29.945463165640845, -36.75863377004863, -49.179760597646265, -29.643914677202716, -31.321648381650462, -18.308651745319366, -35.707991290837555, -309.01733380556107, -313.40839794278145, -331.9506693184376, -58.68610195070507, 20.468033477663994, -7.942975461483016, -30.479076255112886, 0.06942639872431755, -12.66288373619318, -24.58379523456098, -12.306763360276847, -326.9010783061385, -42.78342890739444, -26.65935391932726, -8.923958167433739, 7.942933723330498, -34.37534853070976, -4.439041152596474, 1.5426064729690268, -69.60769598931066, -24.558761917054667, -0.24421410635116558, -51.51049753651023, -28.900773949921145, -0.7639507725834846, -7.364674620330362, -1.3568349033594416, -298.4533032923937, -30.558589614927783, -41.686769269406824, -323.81054373085504, -23.539944030344486, -37.668688826262965, -22.228055775165558, -58.959599331021316, -283.399078104645, -304.90633760392666, -10.01234671473506, -10.429207868874073, -7.054645530879512, -4.5456124022603035, -310.26073586940765, 3.853113643825054, -21.73651263862851, -7.758582562208176, -311.8792290687561, -323.4444051384926, -265.1552453190088, 5.645081095397458, -33.08256589621307, 24.634611755609512, -24.758946679532556, -322.308514803648, -316.7315541803837, 4.50014446675776, 4.42523586936295, 1.2154018580913402, -378.33716310560703, -39.187206193804755, -2.449613645672798, -20.23571584373714, 4.911087542772279, -18.503512501716642, -12.941578716039658, -54.24925269186497, -342.7549599111081, -46.731662586331396, -37.105153284966946, -331.7521550357342, 0.31421995162963867, 17.400461025536032, -1.8707415461540222, -65.91563680768013, -66.88476699590694], "episode_lengths": [72, 300, 53, 300, 37, 300, 300, 300, 300, 63, 300, 70, 111, 67, 300, 53, 300, 68, 57, 300, 300, 300, 300, 300, 300, 300, 83, 79, 70, 300, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 95, 300, 300, 82, 300, 300, 300, 300, 102, 74, 300, 300, 300, 300, 48, 300, 300, 300, 91, 73, 114, 300, 300, 300, 300, 224, 73, 300, 300, 300, 205, 300, 300, 300, 300, 300, 300, 300, 61, 300, 300, 87, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-114.2147353887558, -102.20185136795044, -100.6445032954216, -17.239735685288906, -18.07720720767975, -17.59055845439434, -101.00861841316025, -103.18762145439784, -117.29819111029308, -4.4978528444965775, -4.658371952672809, -5.063570847113937, -100.03880426287651, -101.66651725769043, -100.45568227767944, -12.126130263010666, -12.429132709900543, -13.527670303980514, -14.15817839900653, -14.262682626644775, -13.052654246489212, -5.685237457354873, -5.450172049303859, -5.438923386236041, -7.733251581589386, -7.977692166964218, -7.790879587332412, -101.18045417467754, -103.73381970326106, -99.88610712687175, -6.725547681252166, -5.282638589541122, -5.47179012993972, -110.86436330278715, -112.24962784846625, -102.42043300469717, -110.39489960670471, -96.22531345486641, -94.68890665471554, -112.06214896837871, -99.42759341994922, -98.03394706423084, -8.276875247557967, -7.807503757377475, -9.13978182276091, -104.86435031890869, -99.675067871809, -98.91223403066397, -13.150063390533134, -13.76999729375045, -13.287571566800281, -97.04928957422575, -94.84691511405012, -113.07455607255301, -107.10603675246239, -119.99805158376694, -105.91276830434799, -9.519191781679794, -9.166102136174842, -11.260169247786209, -11.988889808456108, -11.821512552599117, -12.948231408993408, -16.525904898842185, -16.267786090572685, -16.386069608231395, -10.05953585604827, -9.925552884737655, -9.65882593641679, -10.322408075133964, -10.546163427333042, -10.453076879183456, -5.75181782245636, -5.032181739807129, -7.524652183055878, -11.86617096265158, -12.38400657971701, -11.457813748468965, -113.68317488829295, -97.43726093570392, -97.89689798156421, -99.018311470747, -99.17656224966049, -115.21352422237396, -119.59431485335033, -107.40915195147197, -104.9472025136153, -20.99012917280198, -18.630452811717994, -19.0655199661851, 6.803549528121948, 7.274990826845169, 6.3894931226968765, -2.64106708268325, -2.8225589046875683, -2.4793494741121975, -10.070770107209682, -10.049940910190344, -10.35836523771286, -0.26508769392967224, -0.028407149016857147, 0.36292124167084694, -4.300309978425503, -4.225371666252613, -4.137202091515064, -7.479884977142021, -7.956430594126388, -9.147479663292572, -3.2109852128972705, -4.779011448224395, -4.316766699155181, -103.71474765489499, -103.87336414555709, -119.31296650568645, -12.883228768905013, -13.714344908793777, -16.185855229695647, -9.978034019470215, -8.120642311871052, -8.560677587985992, -2.9136761277914047, -2.7664707601070404, -3.2438112795352936, 2.738668143749237, 2.824505388736725, 2.379760190844536, -11.041633235911533, -11.721748794118568, -11.611966500679657, -1.0330982953310013, -2.3506051003932953, -1.0553377568721771, 0.5190632144609992, 0.49280349413552926, 0.5307397643724983, -23.314529513319336, -23.033106481035553, -23.26005999495586, -7.684111687044307, -8.136495331923172, -8.738154898087188, -0.09924740840992285, 0.03868036592999147, -0.1836470638712342, -18.210845589637756, -16.937747225165367, -16.361904721707106, -9.12824520717065, -9.473273659745857, -10.299255083004638, 0.01744651049375534, -0.12445802986621857, -0.6569392532110214, -2.156693575282901, -2.430552219351142, -2.777428825696319, -0.24233879645666434, -0.40053049226602866, -0.7139656146367486, -96.39735041062038, -95.33564692238967, -106.72030595938365, -11.282302896181747, -9.647314707438156, -9.62897201130788, -13.61154913653931, -14.06666669746241, -14.008553435405105, -111.59058936436972, -105.17475560804209, -107.0451987584432, -8.12236838042736, -7.412419505417347, -8.005156144499779, -12.328810172776386, -12.46135350565116, -12.878525147835418, -7.252759248018265, -7.52471736073494, -7.4505791664123535, -19.515780349572502, -19.31888467570146, -20.124934305747352, -88.31734757994613, -89.57772107919058, -105.50400944550833, -96.92425620059173, -110.12011770407359, -97.86196369926135, -3.3605734830101426, -3.304088359077781, -3.347684872647136, -3.3874286338686943, -3.753439486026764, -3.288339748978615, -2.503021384278938, -2.2724809373418537, -2.27914320925872, -1.4161680489778519, -2.046503707766533, -1.0829406455159187, -105.78999344507854, -102.68757615486781, -101.78316626946132, 1.3696419298648834, 1.406775064766407, 1.0766966491937637, -7.215997007985919, -7.196424220999091, -7.324091409643501, -2.7728878557682037, -2.217114105820656, -2.768580600619316, -101.80834625164668, -102.42007587353389, -107.65080694357555, -103.91380700469017, -103.25702580809593, -116.27357232570648, -84.4441467622916, -97.36676828066508, -83.34433027605216, 1.8138623399039062, 1.8702634585400375, 1.9609552969535144, -10.889115261534855, -10.798475558559105, -11.39497507611911, 8.148658126592636, 8.2583387196064, 8.227614909410477, -8.204715726276248, -8.36132134248814, -8.192909610768169, -107.77442865570387, -107.22082078953585, -107.3132653584083, -105.90583197275798, -106.21011219422023, -104.61561001340549, 1.5979180013139995, 1.3687968899806293, 1.5334295754631313, 1.4978662580251694, 1.1432994604110718, 1.7840701509267092, 0.4051051189502033, 0.6160003592570575, 0.19429637988407933, -120.64633297423522, -136.3871995608012, -121.30363057057063, -13.0726072366039, -13.096773679057762, -13.017825278143093, -0.5541956871747971, -0.9042860269546509, -0.9911319315433502, -6.748810882369682, -6.85040968159835, -6.6364952797691075, 1.7155380596717151, 1.591079687078789, 1.6044697960217746, -6.0917975207169945, -6.493363400300353, -5.918351580699294, -4.400536224246025, -4.28726739436388, -4.253775097429752, -17.650744423270226, -18.123564898967743, -18.474943369627, -111.31571670373282, -121.67468716700873, -109.7645560403665, -15.44872006525597, -15.572749060889095, -15.710193460186332, -12.37168425321579, -12.612196445465088, -12.121272586286068, -105.36781476934752, -107.11421908934912, -119.27012117703757, 0.18773098289966583, 0.07865925133228302, 0.04782971739768982, 5.877439963320882, 5.969090337554604, 5.553930724660546, -0.34001216292381287, -0.9195324778556824, -0.611196905374527, -21.07975937922796, -20.695379902919136, -24.140497525533043, -22.443910424908005, -22.278558572133385, -22.162297998865448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17507827969645015, "mean_inference_ms": 0.7135487060186619, "mean_action_processing_ms": 0.09981984308881771, "mean_env_wait_ms": 0.8129736727780087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 143910, "timesteps_this_iter": 0, "agent_timesteps_total": 431730, "timers": {"sample_time_ms": 20429.517, "sample_throughput": 469.615, "load_time_ms": 0.45, "load_throughput": 21332848.739, "learn_time_ms": 3074.772, "learn_throughput": 3120.232, "update_time_ms": 9.623}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 374.93077850341797, "policy_loss": -0.0018854289584144257, "vf_loss": 374.9910774230957, "vf_explained_var": 0.004015408456325531, "kl": 0.006759471052648326, "entropy": 5.8424970507621765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 143910, "num_agent_steps_sampled": 431730, "num_steps_trained": 143910, "num_agent_steps_trained": 431730, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1224, "training_iteration": 15, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-48-24", "timestamp": 1706190504, "time_this_iter_s": 20.786219358444214, "time_total_s": 306.9481301307678, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205C280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 306.9481301307678, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 7.033333333333333, "ram_util_percent": 49.70666666666667}}
{"episode_reward_max": 24.634611755609512, "episode_reward_min": -378.33716310560703, "episode_reward_mean": -80.01281974615064, "episode_len_mean": 258.0, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {"shared_policy": -136.3871995608012}, "policy_reward_max": {"shared_policy": 8.2583387196064}, "policy_reward_mean": {"shared_policy": -26.670939915383553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.78342890739444, -26.65935391932726, -8.923958167433739, 7.942933723330498, -34.37534853070976, -4.439041152596474, 1.5426064729690268, -69.60769598931066, -24.558761917054667, -0.24421410635116558, -51.51049753651023, -28.900773949921145, -0.7639507725834846, -7.364674620330362, -1.3568349033594416, -298.4533032923937, -30.558589614927783, -41.686769269406824, -323.81054373085504, -23.539944030344486, -37.668688826262965, -22.228055775165558, -58.959599331021316, -283.399078104645, -304.90633760392666, -10.01234671473506, -10.429207868874073, -7.054645530879512, -4.5456124022603035, -310.26073586940765, 3.853113643825054, -21.73651263862851, -7.758582562208176, -311.8792290687561, -323.4444051384926, -265.1552453190088, 5.645081095397458, -33.08256589621307, 24.634611755609512, -24.758946679532556, -322.308514803648, -316.7315541803837, 4.50014446675776, 4.42523586936295, 1.2154018580913402, -378.33716310560703, -39.187206193804755, -2.449613645672798, -20.23571584373714, 4.911087542772279, -18.503512501716642, -12.941578716039658, -54.24925269186497, -342.7549599111081, -46.731662586331396, -37.105153284966946, -331.7521550357342, 0.31421995162963867, 17.400461025536032, -1.8707415461540222, -65.91563680768013, -66.88476699590694, -0.1817530170083188, -25.877989247441292, -44.83897768706085, -26.015052214264898, -19.05281227827075, 4.82466497039421, 1.741734758019419, -301.0441970527172, 9.36558761447668, -5.485927492380156, 4.295465613715322, -318.832880705595, -28.269361339509487, -3.8172345161438272, -5.6960601285100125, 1.395847275853157, -20.72572866454722, -10.351728208363085, -52.906867407262354, -28.21262469887735, -287.5482297465205, -31.03169530630113, -306.9131021015346, -5.450464896857767, -45.23317491263154, -34.50068773329258, -338.70723390579224, -4.615168258547783, -45.52306340634823, -23.621566381305456, -334.1981769800186, 10.89251378178595, -37.83823040127757, -10.868613816797733, -284.46164809912443, -10.88536527007821, -302.43875708058476, -0.26164548844101887], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 95, 300, 300, 82, 300, 300, 300, 300, 102, 74, 300, 300, 300, 300, 48, 300, 300, 300, 91, 73, 114, 300, 300, 300, 300, 224, 73, 300, 300, 300, 205, 300, 300, 300, 300, 300, 300, 300, 61, 300, 300, 87, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 74, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 89, 300, 300, 300, 171, 300, 300, 300, 53, 300, 300, 300, 123, 300, 110, 300], "policy_shared_policy_reward": [-12.883228768905013, -13.714344908793777, -16.185855229695647, -9.978034019470215, -8.120642311871052, -8.560677587985992, -2.9136761277914047, -2.7664707601070404, -3.2438112795352936, 2.738668143749237, 2.824505388736725, 2.379760190844536, -11.041633235911533, -11.721748794118568, -11.611966500679657, -1.0330982953310013, -2.3506051003932953, -1.0553377568721771, 0.5190632144609992, 0.49280349413552926, 0.5307397643724983, -23.314529513319336, -23.033106481035553, -23.26005999495586, -7.684111687044307, -8.136495331923172, -8.738154898087188, -0.09924740840992285, 0.03868036592999147, -0.1836470638712342, -18.210845589637756, -16.937747225165367, -16.361904721707106, -9.12824520717065, -9.473273659745857, -10.299255083004638, 0.01744651049375534, -0.12445802986621857, -0.6569392532110214, -2.156693575282901, -2.430552219351142, -2.777428825696319, -0.24233879645666434, -0.40053049226602866, -0.7139656146367486, -96.39735041062038, -95.33564692238967, -106.72030595938365, -11.282302896181747, -9.647314707438156, -9.62897201130788, -13.61154913653931, -14.06666669746241, -14.008553435405105, -111.59058936436972, -105.17475560804209, -107.0451987584432, -8.12236838042736, -7.412419505417347, -8.005156144499779, -12.328810172776386, -12.46135350565116, -12.878525147835418, -7.252759248018265, -7.52471736073494, -7.4505791664123535, -19.515780349572502, -19.31888467570146, -20.124934305747352, -88.31734757994613, -89.57772107919058, -105.50400944550833, -96.92425620059173, -110.12011770407359, -97.86196369926135, -3.3605734830101426, -3.304088359077781, -3.347684872647136, -3.3874286338686943, -3.753439486026764, -3.288339748978615, -2.503021384278938, -2.2724809373418537, -2.27914320925872, -1.4161680489778519, -2.046503707766533, -1.0829406455159187, -105.78999344507854, -102.68757615486781, -101.78316626946132, 1.3696419298648834, 1.406775064766407, 1.0766966491937637, -7.215997007985919, -7.196424220999091, -7.324091409643501, -2.7728878557682037, -2.217114105820656, -2.768580600619316, -101.80834625164668, -102.42007587353389, -107.65080694357555, -103.91380700469017, -103.25702580809593, -116.27357232570648, -84.4441467622916, -97.36676828066508, -83.34433027605216, 1.8138623399039062, 1.8702634585400375, 1.9609552969535144, -10.889115261534855, -10.798475558559105, -11.39497507611911, 8.148658126592636, 8.2583387196064, 8.227614909410477, -8.204715726276248, -8.36132134248814, -8.192909610768169, -107.77442865570387, -107.22082078953585, -107.3132653584083, -105.90583197275798, -106.21011219422023, -104.61561001340549, 1.5979180013139995, 1.3687968899806293, 1.5334295754631313, 1.4978662580251694, 1.1432994604110718, 1.7840701509267092, 0.4051051189502033, 0.6160003592570575, 0.19429637988407933, -120.64633297423522, -136.3871995608012, -121.30363057057063, -13.0726072366039, -13.096773679057762, -13.017825278143093, -0.5541956871747971, -0.9042860269546509, -0.9911319315433502, -6.748810882369682, -6.85040968159835, -6.6364952797691075, 1.7155380596717151, 1.591079687078789, 1.6044697960217746, -6.0917975207169945, -6.493363400300353, -5.918351580699294, -4.400536224246025, -4.28726739436388, -4.253775097429752, -17.650744423270226, -18.123564898967743, -18.474943369627, -111.31571670373282, -121.67468716700873, -109.7645560403665, -15.44872006525597, -15.572749060889095, -15.710193460186332, -12.37168425321579, -12.612196445465088, -12.121272586286068, -105.36781476934752, -107.11421908934912, -119.27012117703757, 0.18773098289966583, 0.07865925133228302, 0.04782971739768982, 5.877439963320882, 5.969090337554604, 5.553930724660546, -0.34001216292381287, -0.9195324778556824, -0.611196905374527, -21.07975937922796, -20.695379902919136, -24.140497525533043, -22.443910424908005, -22.278558572133385, -22.162297998865448, -0.0201721290747372, 0.1488087897499355, -0.3103896776835171, -8.356991365551949, -8.661234632134438, -8.859763249754906, -14.24371548245351, -15.696895013252899, -14.898367191354438, -8.911425699790328, -8.335757335027068, -8.767869179447501, -6.161962365110725, -6.314387386043876, -6.576462527116149, 1.593339135249451, 1.1784249444802555, 2.052900890664503, 0.5172633926073615, 0.7626057962576454, 0.461865569154412, -104.78628182411194, -98.55509193241596, -97.70282329618931, 3.1885464265942574, 3.1464150696992874, 3.030626118183136, -2.0251241425673214, -1.7855629051725117, -1.6752404446403233, 1.231174732247979, 1.9429423265779917, 1.1213485548893516, -102.99923236171405, -112.9568416873614, -102.87680665651958, -9.552285946905613, -9.016598775982857, -9.700476616621017, -1.330381480356067, -1.366459762056678, -1.1203932737310822, -1.6960435832540242, -1.7752849409977642, -2.224731604258224, 0.508282370865345, 0.586211197078228, 0.30135370790958405, -6.458030088494226, -6.725801328818008, -7.541897247234985, -2.4794502456983025, -1.8943167005976136, -5.9779612620671685, -17.07322567452988, -17.689558600385993, -18.14408313234648, -9.397615226606533, -9.227031836907074, -9.587977635363742, -91.50811035682759, -103.42362978061041, -92.61648960908255, -10.349210302035019, -10.48773291210334, -10.194752092162773, -105.36018742248416, -105.99859781563282, -95.55431686341763, -1.5981335689624245, -1.7994860683878358, -2.0528452595075066, -14.940968384345382, -14.710288984080165, -15.581917544205993, -11.227891623973846, -11.479238077998161, -11.793558031320572, -109.10542212923369, -109.44428794582686, -120.15752383073172, -1.2936939373612404, -1.2860616371035576, -2.035412684082985, -14.77347831428051, -14.71907365322113, -16.030511438846588, -7.561896484345198, -8.07245372235775, -7.9872161746025085, -108.01062135895094, -119.12569536765417, -107.06186025341353, 3.5155195047457966, 3.7414992650349888, 3.6354950120051654, -12.527752955754607, -12.615908821423858, -12.694568624099105, -3.5879956260323524, -3.655558794736862, -3.6250593960285187, -91.2755108277003, -102.79262159268062, -90.39351567874353, -3.5091778015097077, -3.9119815578063424, -3.4642059107621606, -96.18367143472037, -94.6070719746252, -111.64801367123923, 0.1531129504243438, 0.056094134847313626, -0.4708525737126763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17399676973377104, "mean_inference_ms": 0.7142216844768811, "mean_action_processing_ms": 0.09999450920651665, "mean_env_wait_ms": 0.8148939746935357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 153504, "timesteps_this_iter": 0, "agent_timesteps_total": 460512, "timers": {"sample_time_ms": 20469.181, "sample_throughput": 468.705, "load_time_ms": 0.299, "load_throughput": 32079203.265, "learn_time_ms": 3076.239, "learn_throughput": 3118.743, "update_time_ms": 9.72}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 355.5981140136719, "policy_loss": -0.0019804339414392635, "vf_loss": 355.6597709655762, "vf_explained_var": 0.005252756178379059, "kl": 0.007352461794655357, "entropy": 5.966814339160919, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 153504, "num_agent_steps_sampled": 460512, "num_steps_trained": 153504, "num_agent_steps_trained": 460512, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1262, "training_iteration": 16, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-48-44", "timestamp": 1706190524, "time_this_iter_s": 20.442450523376465, "time_total_s": 327.3905806541443, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017CB430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 327.3905806541443, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.603448275862068, "ram_util_percent": 49.78620689655173}}
{"episode_reward_max": 24.634611755609512, "episode_reward_min": -378.33716310560703, "episode_reward_mean": -75.58806854976807, "episode_len_mean": 261.89, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {"shared_policy": -136.3871995608012}, "policy_reward_max": {"shared_policy": 8.2583387196064}, "policy_reward_mean": {"shared_policy": -25.196022849922695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.08256589621307, 24.634611755609512, -24.758946679532556, -322.308514803648, -316.7315541803837, 4.50014446675776, 4.42523586936295, 1.2154018580913402, -378.33716310560703, -39.187206193804755, -2.449613645672798, -20.23571584373714, 4.911087542772279, -18.503512501716642, -12.941578716039658, -54.24925269186497, -342.7549599111081, -46.731662586331396, -37.105153284966946, -331.7521550357342, 0.31421995162963867, 17.400461025536032, -1.8707415461540222, -65.91563680768013, -66.88476699590694, -0.1817530170083188, -25.877989247441292, -44.83897768706085, -26.015052214264898, -19.05281227827075, 4.82466497039421, 1.741734758019419, -301.0441970527172, 9.36558761447668, -5.485927492380156, 4.295465613715322, -318.832880705595, -28.269361339509487, -3.8172345161438272, -5.6960601285100125, 1.395847275853157, -20.72572866454722, -10.351728208363085, -52.906867407262354, -28.21262469887735, -287.5482297465205, -31.03169530630113, -306.9131021015346, -5.450464896857767, -45.23317491263154, -34.50068773329258, -338.70723390579224, -4.615168258547783, -45.52306340634823, -23.621566381305456, -334.1981769800186, 10.89251378178595, -37.83823040127757, -10.868613816797733, -284.46164809912443, -10.88536527007821, -302.43875708058476, -0.26164548844101887, -5.46027831826359, 7.702247284352765, -289.85134309530264, -24.66468834877014, -1.3246096409857273, -47.88328098133208, -17.564437784254565, -305.72464945167303, -10.27584297209981, -25.447931505739703, -14.481540217995672, -60.557738311588786, -26.071706175804167, -80.092186242342, 0.45080166310071945, -12.377642206847696, -330.58231799677014, 5.766625776886926, -62.66950278729201, -313.7867498099804, -7.0670066550374315, -15.849050402641325, -25.249320372939124, -22.72696290165186, -27.104344569146647, -60.60675805062056, -305.6237577646971, -13.78291186690332, -4.787011288106456, -22.168388187885313, -23.163530338555603, -6.805297300219536, 5.125567384064169, -9.82931219786407, -47.981021761894226, -324.85764583945274, -10.143589355051517], "episode_lengths": [300, 300, 300, 224, 73, 300, 300, 300, 205, 300, 300, 300, 300, 300, 300, 300, 61, 300, 300, 87, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 74, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 89, 300, 300, 300, 171, 300, 300, 300, 53, 300, 300, 300, 123, 300, 110, 300, 300, 300, 88, 300, 300, 300, 300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 105, 300, 300, 69, 300, 300, 300, 300, 300, 300, 85, 300, 300, 300, 300, 300, 300, 300, 300, 44, 300], "policy_shared_policy_reward": [-10.889115261534855, -10.798475558559105, -11.39497507611911, 8.148658126592636, 8.2583387196064, 8.227614909410477, -8.204715726276248, -8.36132134248814, -8.192909610768169, -107.77442865570387, -107.22082078953585, -107.3132653584083, -105.90583197275798, -106.21011219422023, -104.61561001340549, 1.5979180013139995, 1.3687968899806293, 1.5334295754631313, 1.4978662580251694, 1.1432994604110718, 1.7840701509267092, 0.4051051189502033, 0.6160003592570575, 0.19429637988407933, -120.64633297423522, -136.3871995608012, -121.30363057057063, -13.0726072366039, -13.096773679057762, -13.017825278143093, -0.5541956871747971, -0.9042860269546509, -0.9911319315433502, -6.748810882369682, -6.85040968159835, -6.6364952797691075, 1.7155380596717151, 1.591079687078789, 1.6044697960217746, -6.0917975207169945, -6.493363400300353, -5.918351580699294, -4.400536224246025, -4.28726739436388, -4.253775097429752, -17.650744423270226, -18.123564898967743, -18.474943369627, -111.31571670373282, -121.67468716700873, -109.7645560403665, -15.44872006525597, -15.572749060889095, -15.710193460186332, -12.37168425321579, -12.612196445465088, -12.121272586286068, -105.36781476934752, -107.11421908934912, -119.27012117703757, 0.18773098289966583, 0.07865925133228302, 0.04782971739768982, 5.877439963320882, 5.969090337554604, 5.553930724660546, -0.34001216292381287, -0.9195324778556824, -0.611196905374527, -21.07975937922796, -20.695379902919136, -24.140497525533043, -22.443910424908005, -22.278558572133385, -22.162297998865448, -0.0201721290747372, 0.1488087897499355, -0.3103896776835171, -8.356991365551949, -8.661234632134438, -8.859763249754906, -14.24371548245351, -15.696895013252899, -14.898367191354438, -8.911425699790328, -8.335757335027068, -8.767869179447501, -6.161962365110725, -6.314387386043876, -6.576462527116149, 1.593339135249451, 1.1784249444802555, 2.052900890664503, 0.5172633926073615, 0.7626057962576454, 0.461865569154412, -104.78628182411194, -98.55509193241596, -97.70282329618931, 3.1885464265942574, 3.1464150696992874, 3.030626118183136, -2.0251241425673214, -1.7855629051725117, -1.6752404446403233, 1.231174732247979, 1.9429423265779917, 1.1213485548893516, -102.99923236171405, -112.9568416873614, -102.87680665651958, -9.552285946905613, -9.016598775982857, -9.700476616621017, -1.330381480356067, -1.366459762056678, -1.1203932737310822, -1.6960435832540242, -1.7752849409977642, -2.224731604258224, 0.508282370865345, 0.586211197078228, 0.30135370790958405, -6.458030088494226, -6.725801328818008, -7.541897247234985, -2.4794502456983025, -1.8943167005976136, -5.9779612620671685, -17.07322567452988, -17.689558600385993, -18.14408313234648, -9.397615226606533, -9.227031836907074, -9.587977635363742, -91.50811035682759, -103.42362978061041, -92.61648960908255, -10.349210302035019, -10.48773291210334, -10.194752092162773, -105.36018742248416, -105.99859781563282, -95.55431686341763, -1.5981335689624245, -1.7994860683878358, -2.0528452595075066, -14.940968384345382, -14.710288984080165, -15.581917544205993, -11.227891623973846, -11.479238077998161, -11.793558031320572, -109.10542212923369, -109.44428794582686, -120.15752383073172, -1.2936939373612404, -1.2860616371035576, -2.035412684082985, -14.77347831428051, -14.71907365322113, -16.030511438846588, -7.561896484345198, -8.07245372235775, -7.9872161746025085, -108.01062135895094, -119.12569536765417, -107.06186025341353, 3.5155195047457966, 3.7414992650349888, 3.6354950120051654, -12.527752955754607, -12.615908821423858, -12.694568624099105, -3.5879956260323524, -3.655558794736862, -3.6250593960285187, -91.2755108277003, -102.79262159268062, -90.39351567874353, -3.5091778015097077, -3.9119815578063424, -3.4642059107621606, -96.18367143472037, -94.6070719746252, -111.64801367123923, 0.1531129504243438, 0.056094134847313626, -0.4708525737126763, -2.3346253037452698, -1.6971091479063034, -1.4285438666120172, 2.347659160693482, 2.5388111074765476, 2.815777016182736, -92.0601608430346, -105.73574008544287, -92.05544216682515, -7.801240675151348, -8.05383763462305, -8.809610038995743, -0.6270006895065308, -0.16292810812592506, -0.5346808433532715, -16.070716852943107, -15.801269939790174, -16.011294188598796, -5.8830369959274975, -6.1074889401594845, -5.573911848167583, -97.77515721321106, -96.35297932475805, -111.59651291370392, -3.220927496751159, -3.8048540105422433, -3.2500614648064072, -8.350869687894985, -8.303479711214706, -8.793582106630012, -4.876556386550277, -4.498715316255897, -5.106268515189498, -20.371526613831527, -19.993455581367023, -20.192756116390235, -9.082079102595657, -8.60805453856787, -8.38157253464064, -26.51776251196862, -26.70132432878018, -26.873099401593215, 0.7440340146422386, -0.19007541239261627, -0.1031569391489029, -3.7160360192259247, -4.155434270699828, -4.506171916921943, -109.68244208892187, -107.94659883653125, -112.95327707131705, 2.1075054382284435, 1.9878853981693538, 1.6712349404891285, -20.2486705010136, -20.832474490006767, -21.588357796271644, -101.00877363483112, -99.54455916086833, -113.23341701428096, -2.329186615844577, -2.250666958590358, -2.4871530806024964, -5.245111127694457, -5.270174135764449, -5.333765139182418, -8.571281219522163, -8.354750844339534, -8.323288309077427, -7.398121692240238, -7.575754560530186, -7.753086648881435, -8.68114994714658, -8.964972774187729, -9.45822184781234, -19.759784606595836, -20.053550903995834, -20.793422540028892, -105.47199249267578, -99.47194896638393, -100.67981630563736, -4.540853428343937, -4.514910730222866, -4.727147708336517, -2.116677771011993, -1.3805417443315235, -1.289791772762939, -7.290568937857955, -7.44702245046696, -7.430796799560397, -7.579824761797994, -7.884762105842441, -7.698943470915168, -2.4472842663526535, -1.9497154206037521, -2.40829761326313, 1.8121853570143287, 2.000011029342801, 1.3133709977070396, -3.1578307623664585, -3.40483356515567, -3.2666478703419415, -15.782092481851578, -15.888865113258362, -16.310064166784286, -104.69853219389915, -104.51955330371857, -115.63956034183502, -3.5768393725156784, -3.1411065086722374, -3.4256434738636017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17308928696753198, "mean_inference_ms": 0.7145486417559178, "mean_action_processing_ms": 0.09981371472486808, "mean_env_wait_ms": 0.8168309577661421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 163098, "timesteps_this_iter": 0, "agent_timesteps_total": 489294, "timers": {"sample_time_ms": 20509.158, "sample_throughput": 467.791, "load_time_ms": 0.199, "load_throughput": 48203345.204, "learn_time_ms": 3085.214, "learn_throughput": 3109.671, "update_time_ms": 9.42}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 274.51329040527344, "policy_loss": -0.0011064324436061979, "vf_loss": 274.575252532959, "vf_explained_var": 0.012125551700592041, "kl": 0.006954892010983393, "entropy": 6.086699485778809, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 163098, "num_agent_steps_sampled": 489294, "num_steps_trained": 163098, "num_agent_steps_trained": 489294, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1299, "training_iteration": 17, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-49-05", "timestamp": 1706190545, "time_this_iter_s": 20.703323364257812, "time_total_s": 348.0939040184021, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A229D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 348.0939040184021, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 49.83103448275862}}
{"episode_reward_max": 27.769626799970837, "episode_reward_min": -338.70723390579224, "episode_reward_mean": -67.75501950593666, "episode_len_mean": 265.66, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -120.15752383073172}, "policy_reward_max": {"shared_policy": 9.845425738642604}, "policy_reward_mean": {"shared_policy": -22.58500650197889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.36558761447668, -5.485927492380156, 4.295465613715322, -318.832880705595, -28.269361339509487, -3.8172345161438272, -5.6960601285100125, 1.395847275853157, -20.72572866454722, -10.351728208363085, -52.906867407262354, -28.21262469887735, -287.5482297465205, -31.03169530630113, -306.9131021015346, -5.450464896857767, -45.23317491263154, -34.50068773329258, -338.70723390579224, -4.615168258547783, -45.52306340634823, -23.621566381305456, -334.1981769800186, 10.89251378178595, -37.83823040127757, -10.868613816797733, -284.46164809912443, -10.88536527007821, -302.43875708058476, -0.26164548844101887, -5.46027831826359, 7.702247284352765, -289.85134309530264, -24.66468834877014, -1.3246096409857273, -47.88328098133208, -17.564437784254565, -305.72464945167303, -10.27584297209981, -25.447931505739703, -14.481540217995672, -60.557738311588786, -26.071706175804167, -80.092186242342, 0.45080166310071945, -12.377642206847696, -330.58231799677014, 5.766625776886926, -62.66950278729201, -313.7867498099804, -7.0670066550374315, -15.849050402641325, -25.249320372939124, -22.72696290165186, -27.104344569146647, -60.60675805062056, -305.6237577646971, -13.78291186690332, -4.787011288106456, -22.168388187885313, -23.163530338555603, -6.805297300219536, 5.125567384064169, -9.82931219786407, -47.981021761894226, -324.85764583945274, -10.143589355051517, -11.007114455103903, 7.2773496508598186, -28.099895037710695, 9.223487973213167, -10.42571903020145, -25.985245145857363, -0.20745279267430305, -68.49983349442482, -306.95554552972317, -41.794901780784144, -67.9806401059032, 27.769626799970837, -17.062918476760387, -298.1622418165207, -315.9479980915785, 4.723439790308461, -11.684661954641356, -42.368548072874574, -22.384060986340046, -21.86851692199707, -57.670417487621314, -17.68620605766776, -9.77391475439073, 6.557368583977208, 7.537986591458306, -0.24589883908629417, 0.3162142112851001, -47.72081074863672, -312.795096129179, 24.334032908081994, 5.0732703283429, 10.792423404753208, -52.81657787412407], "episode_lengths": [300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 300, 300, 85, 300, 89, 300, 300, 300, 171, 300, 300, 300, 53, 300, 300, 300, 123, 300, 110, 300, 300, 300, 88, 300, 300, 300, 300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 105, 300, 300, 69, 300, 300, 300, 300, 300, 300, 85, 300, 300, 300, 300, 300, 300, 300, 300, 44, 300, 300, 300, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 69, 285, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 79, 300, 300, 300, 300], "policy_shared_policy_reward": [3.1885464265942574, 3.1464150696992874, 3.030626118183136, -2.0251241425673214, -1.7855629051725117, -1.6752404446403233, 1.231174732247979, 1.9429423265779917, 1.1213485548893516, -102.99923236171405, -112.9568416873614, -102.87680665651958, -9.552285946905613, -9.016598775982857, -9.700476616621017, -1.330381480356067, -1.366459762056678, -1.1203932737310822, -1.6960435832540242, -1.7752849409977642, -2.224731604258224, 0.508282370865345, 0.586211197078228, 0.30135370790958405, -6.458030088494226, -6.725801328818008, -7.541897247234985, -2.4794502456983025, -1.8943167005976136, -5.9779612620671685, -17.07322567452988, -17.689558600385993, -18.14408313234648, -9.397615226606533, -9.227031836907074, -9.587977635363742, -91.50811035682759, -103.42362978061041, -92.61648960908255, -10.349210302035019, -10.48773291210334, -10.194752092162773, -105.36018742248416, -105.99859781563282, -95.55431686341763, -1.5981335689624245, -1.7994860683878358, -2.0528452595075066, -14.940968384345382, -14.710288984080165, -15.581917544205993, -11.227891623973846, -11.479238077998161, -11.793558031320572, -109.10542212923369, -109.44428794582686, -120.15752383073172, -1.2936939373612404, -1.2860616371035576, -2.035412684082985, -14.77347831428051, -14.71907365322113, -16.030511438846588, -7.561896484345198, -8.07245372235775, -7.9872161746025085, -108.01062135895094, -119.12569536765417, -107.06186025341353, 3.5155195047457966, 3.7414992650349888, 3.6354950120051654, -12.527752955754607, -12.615908821423858, -12.694568624099105, -3.5879956260323524, -3.655558794736862, -3.6250593960285187, -91.2755108277003, -102.79262159268062, -90.39351567874353, -3.5091778015097077, -3.9119815578063424, -3.4642059107621606, -96.18367143472037, -94.6070719746252, -111.64801367123923, 0.1531129504243438, 0.056094134847313626, -0.4708525737126763, -2.3346253037452698, -1.6971091479063034, -1.4285438666120172, 2.347659160693482, 2.5388111074765476, 2.815777016182736, -92.0601608430346, -105.73574008544287, -92.05544216682515, -7.801240675151348, -8.05383763462305, -8.809610038995743, -0.6270006895065308, -0.16292810812592506, -0.5346808433532715, -16.070716852943107, -15.801269939790174, -16.011294188598796, -5.8830369959274975, -6.1074889401594845, -5.573911848167583, -97.77515721321106, -96.35297932475805, -111.59651291370392, -3.220927496751159, -3.8048540105422433, -3.2500614648064072, -8.350869687894985, -8.303479711214706, -8.793582106630012, -4.876556386550277, -4.498715316255897, -5.106268515189498, -20.371526613831527, -19.993455581367023, -20.192756116390235, -9.082079102595657, -8.60805453856787, -8.38157253464064, -26.51776251196862, -26.70132432878018, -26.873099401593215, 0.7440340146422386, -0.19007541239261627, -0.1031569391489029, -3.7160360192259247, -4.155434270699828, -4.506171916921943, -109.68244208892187, -107.94659883653125, -112.95327707131705, 2.1075054382284435, 1.9878853981693538, 1.6712349404891285, -20.2486705010136, -20.832474490006767, -21.588357796271644, -101.00877363483112, -99.54455916086833, -113.23341701428096, -2.329186615844577, -2.250666958590358, -2.4871530806024964, -5.245111127694457, -5.270174135764449, -5.333765139182418, -8.571281219522163, -8.354750844339534, -8.323288309077427, -7.398121692240238, -7.575754560530186, -7.753086648881435, -8.68114994714658, -8.964972774187729, -9.45822184781234, -19.759784606595836, -20.053550903995834, -20.793422540028892, -105.47199249267578, -99.47194896638393, -100.67981630563736, -4.540853428343937, -4.514910730222866, -4.727147708336517, -2.116677771011993, -1.3805417443315235, -1.289791772762939, -7.290568937857955, -7.44702245046696, -7.430796799560397, -7.579824761797994, -7.884762105842441, -7.698943470915168, -2.4472842663526535, -1.9497154206037521, -2.40829761326313, 1.8121853570143287, 2.000011029342801, 1.3133709977070396, -3.1578307623664585, -3.40483356515567, -3.2666478703419415, -15.782092481851578, -15.888865113258362, -16.310064166784286, -104.69853219389915, -104.51955330371857, -115.63956034183502, -3.5768393725156784, -3.1411065086722374, -3.4256434738636017, -3.85951813062033, -3.5354641800125535, -3.612132144471019, 2.3211820324261936, 2.5282417883475574, 2.4279258300860675, -9.116839875777572, -9.4321510915955, -9.550904070337623, 3.0730317036310737, 2.98294114569822, 3.1675151238838737, -3.57268948356311, -3.3474034840862004, -3.505626062552139, -9.271772851546615, -8.58703022201857, -8.126442072292178, -0.05654916167259216, -0.37617623805999756, 0.22527260705828667, -21.902010689179107, -22.60079885522525, -23.997023950020477, -112.2762637535731, -98.04791055123012, -96.63137122491996, -14.015899347762272, -13.9842238376538, -13.794778595368072, -22.292293988168247, -22.717018246650703, -22.97132787108422, 8.666194240252167, 9.845425738642604, 9.258006821076066, -5.760154888033867, -5.69371634721756, -5.609047241508961, -102.07543460528056, -97.90025455753009, -98.18655265371005, -105.24804477890333, -105.09450999399027, -105.6054433186849, 1.6954856788118633, 1.714758505423859, 1.313195606072739, -3.9103624473015515, -3.856073829034969, -3.918225678304836, -14.119453792770713, -14.115802710254997, -14.133291569848865, -7.306680366396904, -7.137818805873394, -7.939561814069748, -7.467945009469986, -7.191400021314621, -7.209171891212463, -18.709962536891304, -19.203087707360588, -19.757367243369423, -6.130886783202499, -5.641131659348815, -5.914187615116447, -3.101670386890575, -3.2656508112947193, -3.4065935562054364, 2.054000889261559, 2.229459603627518, 2.2739080910881313, 2.3255552326639446, 2.5004232650001796, 2.712008093794182, -0.35509781539440155, -0.018208041787147522, 0.1274070180952549, 0.19451836248238408, -0.023842732111617693, 0.1455385809143337, -15.836613357067108, -15.490071542561054, -16.39412584900856, -97.56121628483137, -98.52202840646109, -116.71185143788657, 8.242647623022393, 7.999334757526711, 8.09205052753289, 1.6778437097867283, 1.5592172046502384, 1.8362094139059337, 3.588966451585293, 3.7469023317098618, 3.4565546214580536, -17.51159672439099, -17.391683019697673, -17.913298130035407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17227437656312944, "mean_inference_ms": 0.7145052882043664, "mean_action_processing_ms": 0.09972350093041132, "mean_env_wait_ms": 0.8179520167058904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 172692, "timesteps_this_iter": 0, "agent_timesteps_total": 518076, "timers": {"sample_time_ms": 20542.627, "sample_throughput": 467.029, "load_time_ms": 0.199, "load_throughput": 48203345.204, "learn_time_ms": 3095.397, "learn_throughput": 3099.441, "update_time_ms": 9.017}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 208.6623592376709, "policy_loss": -0.001536136941219457, "vf_loss": 208.72461128234863, "vf_explained_var": 0.01237882673740387, "kl": 0.007721323292573834, "entropy": 6.073182046413422, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172692, "num_agent_steps_sampled": 518076, "num_steps_trained": 172692, "num_agent_steps_trained": 518076, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1332, "training_iteration": 18, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-49-26", "timestamp": 1706190566, "time_this_iter_s": 20.610023975372314, "time_total_s": 368.7039279937744, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017CB0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 368.7039279937744, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 9.113793103448277, "ram_util_percent": 49.82758620689656}}
{"episode_reward_max": 27.769626799970837, "episode_reward_min": -334.93186150491243, "episode_reward_mean": -57.54584114328027, "episode_len_mean": 273.08, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -119.12421075503032}, "policy_reward_max": {"shared_policy": 9.845425738642604}, "policy_reward_mean": {"shared_policy": -19.181947047760094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.564437784254565, -305.72464945167303, -10.27584297209981, -25.447931505739703, -14.481540217995672, -60.557738311588786, -26.071706175804167, -80.092186242342, 0.45080166310071945, -12.377642206847696, -330.58231799677014, 5.766625776886926, -62.66950278729201, -313.7867498099804, -7.0670066550374315, -15.849050402641325, -25.249320372939124, -22.72696290165186, -27.104344569146647, -60.60675805062056, -305.6237577646971, -13.78291186690332, -4.787011288106456, -22.168388187885313, -23.163530338555603, -6.805297300219536, 5.125567384064169, -9.82931219786407, -47.981021761894226, -324.85764583945274, -10.143589355051517, -11.007114455103903, 7.2773496508598186, -28.099895037710695, 9.223487973213167, -10.42571903020145, -25.985245145857363, -0.20745279267430305, -68.49983349442482, -306.95554552972317, -41.794901780784144, -67.9806401059032, 27.769626799970837, -17.062918476760387, -298.1622418165207, -315.9479980915785, 4.723439790308461, -11.684661954641356, -42.368548072874574, -22.384060986340046, -21.86851692199707, -57.670417487621314, -17.68620605766776, -9.77391475439073, 6.557368583977208, 7.537986591458306, -0.24589883908629417, 0.3162142112851001, -47.72081074863672, -312.795096129179, 24.334032908081994, 5.0732703283429, 10.792423404753208, -52.81657787412407, -32.252076778560905, -60.06723587214941, -38.09220403432846, 15.182855710387216, -22.97324816882613, -14.22834038734436, -333.8301661014557, -27.476193513721242, -25.538219474256053, -29.11766944825652, -41.854359030723586, 1.234285049140425, -8.039160378277302, -0.2099973000586033, -286.4795353859663, -5.28538229316473, -3.2788280919194506, 1.1838032677769377, 2.7323076054453566, -19.028819769620924, 3.2122648805379868, -31.32346662506461, 6.949953198432894, -15.588041298091412, -0.5268087461590909, -34.359304737299695, -44.22492566704753, -322.18728944659233, -55.003252979367986, 3.9986954629421234, -334.93186150491243, -11.17853763699533, -21.19380334764722, -53.844209570437684, -21.729839853942394, -33.661327227950125], "episode_lengths": [300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 105, 300, 300, 69, 300, 300, 300, 300, 300, 300, 85, 300, 300, 300, 300, 300, 300, 300, 300, 44, 300, 300, 300, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 69, 285, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 79, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 115, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-5.8830369959274975, -6.1074889401594845, -5.573911848167583, -97.77515721321106, -96.35297932475805, -111.59651291370392, -3.220927496751159, -3.8048540105422433, -3.2500614648064072, -8.350869687894985, -8.303479711214706, -8.793582106630012, -4.876556386550277, -4.498715316255897, -5.106268515189498, -20.371526613831527, -19.993455581367023, -20.192756116390235, -9.082079102595657, -8.60805453856787, -8.38157253464064, -26.51776251196862, -26.70132432878018, -26.873099401593215, 0.7440340146422386, -0.19007541239261627, -0.1031569391489029, -3.7160360192259247, -4.155434270699828, -4.506171916921943, -109.68244208892187, -107.94659883653125, -112.95327707131705, 2.1075054382284435, 1.9878853981693538, 1.6712349404891285, -20.2486705010136, -20.832474490006767, -21.588357796271644, -101.00877363483112, -99.54455916086833, -113.23341701428096, -2.329186615844577, -2.250666958590358, -2.4871530806024964, -5.245111127694457, -5.270174135764449, -5.333765139182418, -8.571281219522163, -8.354750844339534, -8.323288309077427, -7.398121692240238, -7.575754560530186, -7.753086648881435, -8.68114994714658, -8.964972774187729, -9.45822184781234, -19.759784606595836, -20.053550903995834, -20.793422540028892, -105.47199249267578, -99.47194896638393, -100.67981630563736, -4.540853428343937, -4.514910730222866, -4.727147708336517, -2.116677771011993, -1.3805417443315235, -1.289791772762939, -7.290568937857955, -7.44702245046696, -7.430796799560397, -7.579824761797994, -7.884762105842441, -7.698943470915168, -2.4472842663526535, -1.9497154206037521, -2.40829761326313, 1.8121853570143287, 2.000011029342801, 1.3133709977070396, -3.1578307623664585, -3.40483356515567, -3.2666478703419415, -15.782092481851578, -15.888865113258362, -16.310064166784286, -104.69853219389915, -104.51955330371857, -115.63956034183502, -3.5768393725156784, -3.1411065086722374, -3.4256434738636017, -3.85951813062033, -3.5354641800125535, -3.612132144471019, 2.3211820324261936, 2.5282417883475574, 2.4279258300860675, -9.116839875777572, -9.4321510915955, -9.550904070337623, 3.0730317036310737, 2.98294114569822, 3.1675151238838737, -3.57268948356311, -3.3474034840862004, -3.505626062552139, -9.271772851546615, -8.58703022201857, -8.126442072292178, -0.05654916167259216, -0.37617623805999756, 0.22527260705828667, -21.902010689179107, -22.60079885522525, -23.997023950020477, -112.2762637535731, -98.04791055123012, -96.63137122491996, -14.015899347762272, -13.9842238376538, -13.794778595368072, -22.292293988168247, -22.717018246650703, -22.97132787108422, 8.666194240252167, 9.845425738642604, 9.258006821076066, -5.760154888033867, -5.69371634721756, -5.609047241508961, -102.07543460528056, -97.90025455753009, -98.18655265371005, -105.24804477890333, -105.09450999399027, -105.6054433186849, 1.6954856788118633, 1.714758505423859, 1.313195606072739, -3.9103624473015515, -3.856073829034969, -3.918225678304836, -14.119453792770713, -14.115802710254997, -14.133291569848865, -7.306680366396904, -7.137818805873394, -7.939561814069748, -7.467945009469986, -7.191400021314621, -7.209171891212463, -18.709962536891304, -19.203087707360588, -19.757367243369423, -6.130886783202499, -5.641131659348815, -5.914187615116447, -3.101670386890575, -3.2656508112947193, -3.4065935562054364, 2.054000889261559, 2.229459603627518, 2.2739080910881313, 2.3255552326639446, 2.5004232650001796, 2.712008093794182, -0.35509781539440155, -0.018208041787147522, 0.1274070180952549, 0.19451836248238408, -0.023842732111617693, 0.1455385809143337, -15.836613357067108, -15.490071542561054, -16.39412584900856, -97.56121628483137, -98.52202840646109, -116.71185143788657, 8.242647623022393, 7.999334757526711, 8.09205052753289, 1.6778437097867283, 1.5592172046502384, 1.8362094139059337, 3.588966451585293, 3.7469023317098618, 3.4565546214580536, -17.51159672439099, -17.391683019697673, -17.913298130035407, -10.758541737993568, -10.478405737628549, -11.015129302938789, -19.923156316081688, -20.2475602204601, -19.896519335607692, -12.550171203911304, -12.927924171090126, -12.61410865932703, 5.087147263189152, 5.212877971430615, 4.882830475767449, -7.62317340572676, -7.752535377939552, -7.59753938515982, -4.79202926158905, -4.410379976034164, -5.025931149721146, -107.20295933882396, -107.50299600760142, -119.12421075503032, -9.102471123139068, -8.72556433702509, -9.648158053557083, -8.603345404068634, -8.608782092730209, -8.32609197745721, -9.510446918507427, -9.62834118058285, -9.978881349166244, -12.987157444159195, -14.192085901896164, -14.675115684668228, 0.19668812553086923, 0.7790055001775329, 0.2585914234320228, -2.2978353649377823, -2.4381258115172386, -3.303199201822281, -0.12707386910915375, 0.2392377071082592, -0.32216113805770874, -91.3934585650762, -105.03858717282614, -90.04748964806399, -1.6536824852228165, -1.940987303853035, -1.6907125040888786, -1.0495852728684838, -0.9188771670063431, -1.3103656520446236, 0.30173438290754007, 0.3188086176911895, 0.5632602671782081, 1.1724710936347549, 0.7570524613062446, 0.8027840505043571, -6.022789319356292, -6.240045790870994, -6.765984659393638, 1.0753473490476608, 0.8032568395137787, 1.3336606919765472, -9.981078166514635, -10.148185469210148, -11.194202989339828, 2.50975030908981, 2.016349355379731, 2.423853533963353, -4.9585661962628365, -5.21668615937233, -5.412788942456245, -0.39158395926158107, -0.12254513303439296, -0.012679653863116869, -11.584520923594638, -11.585123377541706, -11.18966043616335, -14.633018707235664, -14.81426749130091, -14.777639468510955, -105.94457810123762, -106.13810141881308, -110.10460992654166, -18.052241752545044, -19.183973620335266, -17.767037606487676, 1.1603659391403198, 1.485866792500019, 1.3524627313017845, -108.19342373808226, -118.7409932812055, -107.99744448562464, -3.7745680759350506, -3.678739304343864, -3.725230256716415, -7.109245230754226, -7.096374278267234, -6.988183838625758, -17.727409655849144, -17.449521197626993, -18.667278716961548, -7.067380882799625, -6.804870143532753, -7.857588827610016, -11.411183183391898, -11.123811607559531, -11.126332436998695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1714729407315988, "mean_inference_ms": 0.7148298449678024, "mean_action_processing_ms": 0.09987493447518374, "mean_env_wait_ms": 0.8196886571588664, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 182286, "timesteps_this_iter": 0, "agent_timesteps_total": 546858, "timers": {"sample_time_ms": 20605.798, "sample_throughput": 465.597, "load_time_ms": 0.1, "load_throughput": 96176272.887, "learn_time_ms": 3099.893, "learn_throughput": 3094.946, "update_time_ms": 9.029}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 186.78204536437988, "policy_loss": -0.0015429024859305862, "vf_loss": 186.84494400024414, "vf_explained_var": 0.038091182708740234, "kl": 0.004244909185220397, "entropy": 6.135448753833771, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182286, "num_agent_steps_sampled": 546858, "num_steps_trained": 182286, "num_agent_steps_trained": 546858, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1368, "training_iteration": 19, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-49-47", "timestamp": 1706190587, "time_this_iter_s": 20.828189373016357, "time_total_s": 389.53211736679077, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 389.53211736679077, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.876666666666667, "ram_util_percent": 49.98333333333333}}
{"episode_reward_max": 27.769626799970837, "episode_reward_min": -334.93186150491243, "episode_reward_mean": -54.35999947660952, "episode_len_mean": 275.31, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -119.12421075503032}, "policy_reward_max": {"shared_policy": 9.845425738642604}, "policy_reward_mean": {"shared_policy": -18.119999825536514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.42571903020145, -25.985245145857363, -0.20745279267430305, -68.49983349442482, -306.95554552972317, -41.794901780784144, -67.9806401059032, 27.769626799970837, -17.062918476760387, -298.1622418165207, -315.9479980915785, 4.723439790308461, -11.684661954641356, -42.368548072874574, -22.384060986340046, -21.86851692199707, -57.670417487621314, -17.68620605766776, -9.77391475439073, 6.557368583977208, 7.537986591458306, -0.24589883908629417, 0.3162142112851001, -47.72081074863672, -312.795096129179, 24.334032908081994, 5.0732703283429, 10.792423404753208, -52.81657787412407, -32.252076778560905, -60.06723587214941, -38.09220403432846, 15.182855710387216, -22.97324816882613, -14.22834038734436, -333.8301661014557, -27.476193513721242, -25.538219474256053, -29.11766944825652, -41.854359030723586, 1.234285049140425, -8.039160378277302, -0.2099973000586033, -286.4795353859663, -5.28538229316473, -3.2788280919194506, 1.1838032677769377, 2.7323076054453566, -19.028819769620924, 3.2122648805379868, -31.32346662506461, 6.949953198432894, -15.588041298091412, -0.5268087461590909, -34.359304737299695, -44.22492566704753, -322.18728944659233, -55.003252979367986, 3.9986954629421234, -334.93186150491243, -11.17853763699533, -21.19380334764722, -53.844209570437684, -21.729839853942394, -33.661327227950125, -22.8249654620886, -39.31227391958238, -326.70638532936573, -22.22019423544407, 4.343636743724318, -67.94791842997067, -10.509603217244148, -57.94293298572304, -17.117880381643772, -13.85446199029684, -40.87727160751821, -316.30152237415314, -79.65339156240236, 5.005800545215578, -40.285287521779566, -25.882670938968687, -8.15715155750516, -10.143323615193395, -6.892708525061607, -33.1203292310238, -15.704660815536045, 0.9277725592255308, 6.190389811992645, -324.7343762367964, -14.222172178328037, 20.208015613257885, -5.909954603761449, -296.97876919806004, -11.764593258500113, -22.692535109817996, 4.875312425196171, -30.171080149710207, -9.10789263993503, -45.19872508198023, -5.3730602338910245], "episode_lengths": [300, 300, 300, 300, 68, 300, 300, 300, 300, 69, 285, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 79, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 58, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 115, 300, 300, 300, 300, 300, 300, 300, 46, 300, 300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 74, 300, 300, 300, 130, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-3.57268948356311, -3.3474034840862004, -3.505626062552139, -9.271772851546615, -8.58703022201857, -8.126442072292178, -0.05654916167259216, -0.37617623805999756, 0.22527260705828667, -21.902010689179107, -22.60079885522525, -23.997023950020477, -112.2762637535731, -98.04791055123012, -96.63137122491996, -14.015899347762272, -13.9842238376538, -13.794778595368072, -22.292293988168247, -22.717018246650703, -22.97132787108422, 8.666194240252167, 9.845425738642604, 9.258006821076066, -5.760154888033867, -5.69371634721756, -5.609047241508961, -102.07543460528056, -97.90025455753009, -98.18655265371005, -105.24804477890333, -105.09450999399027, -105.6054433186849, 1.6954856788118633, 1.714758505423859, 1.313195606072739, -3.9103624473015515, -3.856073829034969, -3.918225678304836, -14.119453792770713, -14.115802710254997, -14.133291569848865, -7.306680366396904, -7.137818805873394, -7.939561814069748, -7.467945009469986, -7.191400021314621, -7.209171891212463, -18.709962536891304, -19.203087707360588, -19.757367243369423, -6.130886783202499, -5.641131659348815, -5.914187615116447, -3.101670386890575, -3.2656508112947193, -3.4065935562054364, 2.054000889261559, 2.229459603627518, 2.2739080910881313, 2.3255552326639446, 2.5004232650001796, 2.712008093794182, -0.35509781539440155, -0.018208041787147522, 0.1274070180952549, 0.19451836248238408, -0.023842732111617693, 0.1455385809143337, -15.836613357067108, -15.490071542561054, -16.39412584900856, -97.56121628483137, -98.52202840646109, -116.71185143788657, 8.242647623022393, 7.999334757526711, 8.09205052753289, 1.6778437097867283, 1.5592172046502384, 1.8362094139059337, 3.588966451585293, 3.7469023317098618, 3.4565546214580536, -17.51159672439099, -17.391683019697673, -17.913298130035407, -10.758541737993568, -10.478405737628549, -11.015129302938789, -19.923156316081688, -20.2475602204601, -19.896519335607692, -12.550171203911304, -12.927924171090126, -12.61410865932703, 5.087147263189152, 5.212877971430615, 4.882830475767449, -7.62317340572676, -7.752535377939552, -7.59753938515982, -4.79202926158905, -4.410379976034164, -5.025931149721146, -107.20295933882396, -107.50299600760142, -119.12421075503032, -9.102471123139068, -8.72556433702509, -9.648158053557083, -8.603345404068634, -8.608782092730209, -8.32609197745721, -9.510446918507427, -9.62834118058285, -9.978881349166244, -12.987157444159195, -14.192085901896164, -14.675115684668228, 0.19668812553086923, 0.7790055001775329, 0.2585914234320228, -2.2978353649377823, -2.4381258115172386, -3.303199201822281, -0.12707386910915375, 0.2392377071082592, -0.32216113805770874, -91.3934585650762, -105.03858717282614, -90.04748964806399, -1.6536824852228165, -1.940987303853035, -1.6907125040888786, -1.0495852728684838, -0.9188771670063431, -1.3103656520446236, 0.30173438290754007, 0.3188086176911895, 0.5632602671782081, 1.1724710936347549, 0.7570524613062446, 0.8027840505043571, -6.022789319356292, -6.240045790870994, -6.765984659393638, 1.0753473490476608, 0.8032568395137787, 1.3336606919765472, -9.981078166514635, -10.148185469210148, -11.194202989339828, 2.50975030908981, 2.016349355379731, 2.423853533963353, -4.9585661962628365, -5.21668615937233, -5.412788942456245, -0.39158395926158107, -0.12254513303439296, -0.012679653863116869, -11.584520923594638, -11.585123377541706, -11.18966043616335, -14.633018707235664, -14.81426749130091, -14.777639468510955, -105.94457810123762, -106.13810141881308, -110.10460992654166, -18.052241752545044, -19.183973620335266, -17.767037606487676, 1.1603659391403198, 1.485866792500019, 1.3524627313017845, -108.19342373808226, -118.7409932812055, -107.99744448562464, -3.7745680759350506, -3.678739304343864, -3.725230256716415, -7.109245230754226, -7.096374278267234, -6.988183838625758, -17.727409655849144, -17.449521197626993, -18.667278716961548, -7.067380882799625, -6.804870143532753, -7.857588827610016, -11.411183183391898, -11.123811607559531, -11.126332436998695, -8.058387676874801, -7.414015198747322, -7.352562586466476, -12.839130083719894, -13.03120254973571, -13.441941286126777, -103.90873452524345, -117.07902280489604, -105.71862799922626, -7.394092991948128, -7.277156949043274, -7.548944294452667, 1.4349526787797515, 1.3826847697297637, 1.5259992952148025, -22.31891682744027, -22.744289845228202, -22.88471175730229, -3.69073086977005, -3.964468330144882, -2.854404017329216, -19.308094367384918, -19.133668936789043, -19.50116968154908, -5.6112117022275925, -5.837870582938194, -5.668798096477985, -4.785388648509979, -4.635913908481598, -4.4331594333052635, -13.504685665170356, -13.406263271967575, -13.96632267038028, -101.77776213983695, -113.00620619455974, -101.51755403975646, -26.37832416345676, -26.48048916955789, -26.794578229387604, 1.9242041582862441, 1.8188852841655319, 1.2627111027638023, -13.803118785222381, -13.345508334537357, -13.136660402019828, -8.677094822128623, -8.521453422804683, -8.68412269403538, -3.3756191631158288, -2.485302572449058, -2.2962298219402726, -3.388683361311763, -3.3187044908603127, -3.4359357630213196, -2.192178338766098, -2.4360564053058624, -2.264473780989647, -11.0966461027662, -11.019272419313594, -11.004410708944008, -5.393595136702061, -5.470055416226387, -4.841010262607597, -0.6088822086652215, 0.8424306536714141, 0.6942241142193382, 2.073263168334961, 2.319820314645767, 1.7973063290119171, -104.12352840602398, -106.41641008853912, -114.19443774223328, -4.427845098078251, -4.8684834241867065, -4.92584365606308, 6.939605183899403, 7.087841153144836, 6.180569276213646, -2.0020118529597966, -2.3160496900479046, -1.5918930607537476, -94.7125656058391, -95.59375165899596, -106.672451933225, -3.930128807822868, -3.741339291135475, -4.093125159541771, -7.502792949477836, -7.562218966583416, -7.627523193756744, 1.5025465488433838, 1.518589586019516, 1.854176290333271, -9.908934233089298, -10.231069063146919, -10.03107685347399, -2.9118597681323735, -3.113165850440666, -3.0828670213619915, -15.2310182005167, -14.936137035489082, -15.031569845974445, -1.5229393715659825, -1.7842014680306164, -2.0659193942944256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1707389462734503, "mean_inference_ms": 0.7151287233392251, "mean_action_processing_ms": 0.09998250801518292, "mean_env_wait_ms": 0.8207414550591392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 191880, "timesteps_this_iter": 0, "agent_timesteps_total": 575640, "timers": {"sample_time_ms": 20664.445, "sample_throughput": 464.276, "load_time_ms": 0.1, "load_throughput": 96176272.887, "learn_time_ms": 3103.586, "learn_throughput": 3091.263, "update_time_ms": 9.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 165.8396759033203, "policy_loss": -0.0014930810641888836, "vf_loss": 165.90406036376953, "vf_explained_var": 0.04160456359386444, "kl": 0.009917412004145611, "entropy": 6.289230465888977, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 191880, "num_agent_steps_sampled": 575640, "num_steps_trained": 191880, "num_agent_steps_trained": 575640, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1403, "training_iteration": 20, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-50-07", "timestamp": 1706190607, "time_this_iter_s": 20.723001956939697, "time_total_s": 410.25511932373047, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 410.25511932373047, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.386206896551725, "ram_util_percent": 50.07241379310344}}
{"episode_reward_max": 20.208015613257885, "episode_reward_min": -334.93186150491243, "episode_reward_mean": -49.1187051175849, "episode_len_mean": 275.6, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -119.12421075503032}, "policy_reward_max": {"shared_policy": 7.087841153144836}, "policy_reward_mean": {"shared_policy": -16.37290170586164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.22834038734436, -333.8301661014557, -27.476193513721242, -25.538219474256053, -29.11766944825652, -41.854359030723586, 1.234285049140425, -8.039160378277302, -0.2099973000586033, -286.4795353859663, -5.28538229316473, -3.2788280919194506, 1.1838032677769377, 2.7323076054453566, -19.028819769620924, 3.2122648805379868, -31.32346662506461, 6.949953198432894, -15.588041298091412, -0.5268087461590909, -34.359304737299695, -44.22492566704753, -322.18728944659233, -55.003252979367986, 3.9986954629421234, -334.93186150491243, -11.17853763699533, -21.19380334764722, -53.844209570437684, -21.729839853942394, -33.661327227950125, -22.8249654620886, -39.31227391958238, -326.70638532936573, -22.22019423544407, 4.343636743724318, -67.94791842997067, -10.509603217244148, -57.94293298572304, -17.117880381643772, -13.85446199029684, -40.87727160751821, -316.30152237415314, -79.65339156240236, 5.005800545215578, -40.285287521779566, -25.882670938968687, -8.15715155750516, -10.143323615193395, -6.892708525061607, -33.1203292310238, -15.704660815536045, 0.9277725592255308, 6.190389811992645, -324.7343762367964, -14.222172178328037, 20.208015613257885, -5.909954603761449, -296.97876919806004, -11.764593258500113, -22.692535109817996, 4.875312425196171, -30.171080149710207, -9.10789263993503, -45.19872508198023, -5.3730602338910245, -17.52268578857185, -267.84616074711084, -3.607857555151014, -28.44439789652826, -318.8424692749977, -6.045497924089432, 0.4785795584321022, -2.988776981830611, 6.400974549353094, -19.845075488090515, 0.7319674659520103, -77.84106523543588, -12.433911949396133, -39.63416193425658, -3.992273896932616, -0.8755029886961267, -4.926621414721026, -304.1705905944109, 5.228439994156361, 2.8745791539549543, -1.094930075109005, -11.261457212269306, -9.338298235088601, -10.055692084133625, -5.842386469244985, -85.69058819860214, -33.60925410687926, -7.565450146794319, 8.322060942649813, 14.448253951966734, -9.64943523705007, 0.09531540423628826, -10.794398881494999, -21.666547417640714], "episode_lengths": [300, 58, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 300, 115, 300, 300, 300, 300, 300, 300, 300, 46, 300, 300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 74, 300, 300, 300, 130, 300, 300, 300, 300, 300, 300, 300, 300, 111, 300, 300, 42, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-4.79202926158905, -4.410379976034164, -5.025931149721146, -107.20295933882396, -107.50299600760142, -119.12421075503032, -9.102471123139068, -8.72556433702509, -9.648158053557083, -8.603345404068634, -8.608782092730209, -8.32609197745721, -9.510446918507427, -9.62834118058285, -9.978881349166244, -12.987157444159195, -14.192085901896164, -14.675115684668228, 0.19668812553086923, 0.7790055001775329, 0.2585914234320228, -2.2978353649377823, -2.4381258115172386, -3.303199201822281, -0.12707386910915375, 0.2392377071082592, -0.32216113805770874, -91.3934585650762, -105.03858717282614, -90.04748964806399, -1.6536824852228165, -1.940987303853035, -1.6907125040888786, -1.0495852728684838, -0.9188771670063431, -1.3103656520446236, 0.30173438290754007, 0.3188086176911895, 0.5632602671782081, 1.1724710936347549, 0.7570524613062446, 0.8027840505043571, -6.022789319356292, -6.240045790870994, -6.765984659393638, 1.0753473490476608, 0.8032568395137787, 1.3336606919765472, -9.981078166514635, -10.148185469210148, -11.194202989339828, 2.50975030908981, 2.016349355379731, 2.423853533963353, -4.9585661962628365, -5.21668615937233, -5.412788942456245, -0.39158395926158107, -0.12254513303439296, -0.012679653863116869, -11.584520923594638, -11.585123377541706, -11.18966043616335, -14.633018707235664, -14.81426749130091, -14.777639468510955, -105.94457810123762, -106.13810141881308, -110.10460992654166, -18.052241752545044, -19.183973620335266, -17.767037606487676, 1.1603659391403198, 1.485866792500019, 1.3524627313017845, -108.19342373808226, -118.7409932812055, -107.99744448562464, -3.7745680759350506, -3.678739304343864, -3.725230256716415, -7.109245230754226, -7.096374278267234, -6.988183838625758, -17.727409655849144, -17.449521197626993, -18.667278716961548, -7.067380882799625, -6.804870143532753, -7.857588827610016, -11.411183183391898, -11.123811607559531, -11.126332436998695, -8.058387676874801, -7.414015198747322, -7.352562586466476, -12.839130083719894, -13.03120254973571, -13.441941286126777, -103.90873452524345, -117.07902280489604, -105.71862799922626, -7.394092991948128, -7.277156949043274, -7.548944294452667, 1.4349526787797515, 1.3826847697297637, 1.5259992952148025, -22.31891682744027, -22.744289845228202, -22.88471175730229, -3.69073086977005, -3.964468330144882, -2.854404017329216, -19.308094367384918, -19.133668936789043, -19.50116968154908, -5.6112117022275925, -5.837870582938194, -5.668798096477985, -4.785388648509979, -4.635913908481598, -4.4331594333052635, -13.504685665170356, -13.406263271967575, -13.96632267038028, -101.77776213983695, -113.00620619455974, -101.51755403975646, -26.37832416345676, -26.48048916955789, -26.794578229387604, 1.9242041582862441, 1.8188852841655319, 1.2627111027638023, -13.803118785222381, -13.345508334537357, -13.136660402019828, -8.677094822128623, -8.521453422804683, -8.68412269403538, -3.3756191631158288, -2.485302572449058, -2.2962298219402726, -3.388683361311763, -3.3187044908603127, -3.4359357630213196, -2.192178338766098, -2.4360564053058624, -2.264473780989647, -11.0966461027662, -11.019272419313594, -11.004410708944008, -5.393595136702061, -5.470055416226387, -4.841010262607597, -0.6088822086652215, 0.8424306536714141, 0.6942241142193382, 2.073263168334961, 2.319820314645767, 1.7973063290119171, -104.12352840602398, -106.41641008853912, -114.19443774223328, -4.427845098078251, -4.8684834241867065, -4.92584365606308, 6.939605183899403, 7.087841153144836, 6.180569276213646, -2.0020118529597966, -2.3160496900479046, -1.5918930607537476, -94.7125656058391, -95.59375165899596, -106.672451933225, -3.930128807822868, -3.741339291135475, -4.093125159541771, -7.502792949477836, -7.562218966583416, -7.627523193756744, 1.5025465488433838, 1.518589586019516, 1.854176290333271, -9.908934233089298, -10.231069063146919, -10.03107685347399, -2.9118597681323735, -3.113165850440666, -3.0828670213619915, -15.2310182005167, -14.936137035489082, -15.031569845974445, -1.5229393715659825, -1.7842014680306164, -2.0659193942944256, -5.913607689241573, -5.891770931581661, -5.717307167748615, -84.10436381647985, -98.98673848311107, -84.75505844751994, -1.5486675848563607, -0.9647159253557618, -1.0944740449388917, -9.51743769148986, -9.53529203931491, -9.391668165723488, -102.54453484217326, -114.59706817070644, -101.70086626211803, -1.8884196281433105, -1.7528534829616547, -2.4042248129844666, 0.26292452216148376, 0.23608220368623734, -0.020427167415618896, -1.2067047903935162, -0.857434126238033, -0.924638065199062, 2.2394087562958305, 2.1879792238275115, 1.9735865692297523, -6.356703698635101, -6.597728341817856, -6.890643447637558, -0.03240651388964011, 0.16368453452983545, 0.600689445311815, -25.799252269168697, -25.74890165527662, -26.292911310990654, -4.091233566403389, -4.363154426217079, -3.9795239567756653, -13.072635894020408, -13.423144807418197, -13.138381232817977, -1.3548213044802395, -1.243980581561729, -1.3934720108906475, -0.18578410645326926, -0.017737453182547824, -0.6719814290603097, -1.2264325792590824, -1.6216308573881832, -2.0785579780737606, -99.56781922280788, -100.37243923544884, -104.23033213615417, 1.5779154300689697, 1.95440261811018, 1.696121945977211, 1.1031818340221946, 1.184430452684552, 0.5869668672482078, -0.15626206248998642, -0.23685771226882935, -0.7018103003501892, -3.616079516708851, -3.709327667951584, -3.9360500276088715, -3.4247398624817578, -3.1390813986460415, -2.7744769739608017, -3.5124588385224342, -3.4431154280900955, -3.1001178175210953, -1.7534351547559197, -2.2127522726853783, -1.8761990418036874, -28.976759150624282, -28.302910089492805, -28.410918958485134, -11.537603055437415, -11.003297631939262, -11.068353419502586, -2.3632586747407913, -2.5669322162866592, -2.6352592557668686, 2.665006573001534, 2.896541486183793, 2.760512883464486, 4.774689647058636, 4.894659380118043, 4.778904924790055, -2.9336170951525418, -3.244168842832252, -3.4716492990652768, -0.2189444949229653, 0.07234519223371194, 0.24191470692554162, -3.5338362753391266, -3.5309963747859, -3.7295662313699722, -6.819056515892356, -7.472598349054664, -7.374892552693694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17020940017539496, "mean_inference_ms": 0.7159410242656331, "mean_action_processing_ms": 0.10018993862970259, "mean_env_wait_ms": 0.8217876364458295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 201474, "timesteps_this_iter": 0, "agent_timesteps_total": 604422, "timers": {"sample_time_ms": 20694.501, "sample_throughput": 463.601, "load_time_ms": 0.1, "load_throughput": 96176272.887, "learn_time_ms": 3109.189, "learn_throughput": 3085.692, "update_time_ms": 9.091}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 110.96065425872803, "policy_loss": -0.001538821401207091, "vf_loss": 111.02596187591553, "vf_explained_var": 0.04314586520195007, "kl": 0.008837812216373659, "entropy": 6.377509355545044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 201474, "num_agent_steps_sampled": 604422, "num_steps_trained": 201474, "num_agent_steps_trained": 604422, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1437, "training_iteration": 21, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-50-28", "timestamp": 1706190628, "time_this_iter_s": 20.697046995162964, "time_total_s": 430.95216631889343, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 430.95216631889343, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.493103448275862, "ram_util_percent": 50.0896551724138}}
{"episode_reward_max": 20.208015613257885, "episode_reward_min": -340.26130835711956, "episode_reward_mean": -42.09057452169597, "episode_len_mean": 277.85, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -121.87030748526256}, "policy_reward_max": {"shared_policy": 7.087841153144836}, "policy_reward_mean": {"shared_policy": -14.030191507231994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.343636743724318, -67.94791842997067, -10.509603217244148, -57.94293298572304, -17.117880381643772, -13.85446199029684, -40.87727160751821, -316.30152237415314, -79.65339156240236, 5.005800545215578, -40.285287521779566, -25.882670938968687, -8.15715155750516, -10.143323615193395, -6.892708525061607, -33.1203292310238, -15.704660815536045, 0.9277725592255308, 6.190389811992645, -324.7343762367964, -14.222172178328037, 20.208015613257885, -5.909954603761449, -296.97876919806004, -11.764593258500113, -22.692535109817996, 4.875312425196171, -30.171080149710207, -9.10789263993503, -45.19872508198023, -5.3730602338910245, -17.52268578857185, -267.84616074711084, -3.607857555151014, -28.44439789652826, -318.8424692749977, -6.045497924089432, 0.4785795584321022, -2.988776981830611, 6.400974549353094, -19.845075488090515, 0.7319674659520103, -77.84106523543588, -12.433911949396133, -39.63416193425658, -3.992273896932616, -0.8755029886961267, -4.926621414721026, -304.1705905944109, 5.228439994156361, 2.8745791539549543, -1.094930075109005, -11.261457212269306, -9.338298235088601, -10.055692084133625, -5.842386469244985, -85.69058819860214, -33.60925410687926, -7.565450146794319, 8.322060942649813, 14.448253951966734, -9.64943523705007, 0.09531540423628826, -10.794398881494999, -21.666547417640714, 0.7964464202522947, -3.7003099992871427, 6.047375835478306, -68.82762855291372, -31.685175605118275, -282.8948547281325, -31.29452915117146, 15.985404051840277, 12.234404943883419, 13.275723084807368, -20.01295436918737, 6.54625084251164, -340.26130835711956, 0.3279007151722908, -2.3793853521347046, 0.6059833765029765, 13.865213369950652, -18.036216922104387, -3.1669119596481323, -30.99566885456443, -12.41661126166585, -7.8933315090835094, -14.442635044455557, 18.010774794965982, -11.30246222391726, -321.6055536866188, -13.090722434222712, -16.84815186262132, -5.1761303395033025, 2.2114241644740105, -5.518172465264811, -12.64313711971046, -7.722779929637937, -288.5329926908016, -2.518066890537767], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 74, 300, 300, 300, 130, 300, 300, 300, 300, 300, 300, 300, 300, 111, 300, 300, 42, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 66, 300], "policy_shared_policy_reward": [1.4349526787797515, 1.3826847697297637, 1.5259992952148025, -22.31891682744027, -22.744289845228202, -22.88471175730229, -3.69073086977005, -3.964468330144882, -2.854404017329216, -19.308094367384918, -19.133668936789043, -19.50116968154908, -5.6112117022275925, -5.837870582938194, -5.668798096477985, -4.785388648509979, -4.635913908481598, -4.4331594333052635, -13.504685665170356, -13.406263271967575, -13.96632267038028, -101.77776213983695, -113.00620619455974, -101.51755403975646, -26.37832416345676, -26.48048916955789, -26.794578229387604, 1.9242041582862441, 1.8188852841655319, 1.2627111027638023, -13.803118785222381, -13.345508334537357, -13.136660402019828, -8.677094822128623, -8.521453422804683, -8.68412269403538, -3.3756191631158288, -2.485302572449058, -2.2962298219402726, -3.388683361311763, -3.3187044908603127, -3.4359357630213196, -2.192178338766098, -2.4360564053058624, -2.264473780989647, -11.0966461027662, -11.019272419313594, -11.004410708944008, -5.393595136702061, -5.470055416226387, -4.841010262607597, -0.6088822086652215, 0.8424306536714141, 0.6942241142193382, 2.073263168334961, 2.319820314645767, 1.7973063290119171, -104.12352840602398, -106.41641008853912, -114.19443774223328, -4.427845098078251, -4.8684834241867065, -4.92584365606308, 6.939605183899403, 7.087841153144836, 6.180569276213646, -2.0020118529597966, -2.3160496900479046, -1.5918930607537476, -94.7125656058391, -95.59375165899596, -106.672451933225, -3.930128807822868, -3.741339291135475, -4.093125159541771, -7.502792949477836, -7.562218966583416, -7.627523193756744, 1.5025465488433838, 1.518589586019516, 1.854176290333271, -9.908934233089298, -10.231069063146919, -10.03107685347399, -2.9118597681323735, -3.113165850440666, -3.0828670213619915, -15.2310182005167, -14.936137035489082, -15.031569845974445, -1.5229393715659825, -1.7842014680306164, -2.0659193942944256, -5.913607689241573, -5.891770931581661, -5.717307167748615, -84.10436381647985, -98.98673848311107, -84.75505844751994, -1.5486675848563607, -0.9647159253557618, -1.0944740449388917, -9.51743769148986, -9.53529203931491, -9.391668165723488, -102.54453484217326, -114.59706817070644, -101.70086626211803, -1.8884196281433105, -1.7528534829616547, -2.4042248129844666, 0.26292452216148376, 0.23608220368623734, -0.020427167415618896, -1.2067047903935162, -0.857434126238033, -0.924638065199062, 2.2394087562958305, 2.1879792238275115, 1.9735865692297523, -6.356703698635101, -6.597728341817856, -6.890643447637558, -0.03240651388964011, 0.16368453452983545, 0.600689445311815, -25.799252269168697, -25.74890165527662, -26.292911310990654, -4.091233566403389, -4.363154426217079, -3.9795239567756653, -13.072635894020408, -13.423144807418197, -13.138381232817977, -1.3548213044802395, -1.243980581561729, -1.3934720108906475, -0.18578410645326926, -0.017737453182547824, -0.6719814290603097, -1.2264325792590824, -1.6216308573881832, -2.0785579780737606, -99.56781922280788, -100.37243923544884, -104.23033213615417, 1.5779154300689697, 1.95440261811018, 1.696121945977211, 1.1031818340221946, 1.184430452684552, 0.5869668672482078, -0.15626206248998642, -0.23685771226882935, -0.7018103003501892, -3.616079516708851, -3.709327667951584, -3.9360500276088715, -3.4247398624817578, -3.1390813986460415, -2.7744769739608017, -3.5124588385224342, -3.4431154280900955, -3.1001178175210953, -1.7534351547559197, -2.2127522726853783, -1.8761990418036874, -28.976759150624282, -28.302910089492805, -28.410918958485134, -11.537603055437415, -11.003297631939262, -11.068353419502586, -2.3632586747407913, -2.5669322162866592, -2.6352592557668686, 2.665006573001534, 2.896541486183793, 2.760512883464486, 4.774689647058636, 4.894659380118043, 4.778904924790055, -2.9336170951525418, -3.244168842832252, -3.4716492990652768, -0.2189444949229653, 0.07234519223371194, 0.24191470692554162, -3.5338362753391266, -3.5309963747859, -3.7295662313699722, -6.819056515892356, -7.472598349054664, -7.374892552693694, -0.04963009556135489, 0.6303958321610992, 0.21568068365255044, -1.2115916634599415, -1.1610554556051937, -1.3276628802220074, 2.14215736836195, 1.751205027103424, 2.154013440012932, -22.580562440057598, -22.90675332893928, -23.340312783916794, -10.479918248951435, -10.635153517127037, -10.570103839039803, -104.3870523373286, -89.43638285497825, -89.07141953582565, -10.629285993675396, -10.25173380101721, -10.413509356478855, 5.3489522586266105, 5.305964755515248, 5.330487037698418, 4.058151394128799, 4.17432252317667, 4.0019310265779495, 4.467408085862786, 4.3300536895791595, 4.478261309365422, -6.8143041084210125, -6.503614115218326, -6.6950361455480305, 2.1913518508275303, 2.2593740870555195, 2.09552490462859, -110.62831894556682, -121.87030748526256, -107.7626819262902, 0.08987525850534439, 0.08020518720149994, 0.15782026946544647, -1.090146616101265, -0.7336052283644676, -0.555633507668972, 0.35034597416718327, 0.458480571707085, -0.20284316937129176, 4.411430925130844, 4.446069493889809, 5.007712950929999, -5.9526320596536095, -5.813180771966785, -6.270404090483993, -1.0615636482834816, -0.9230082556605339, -1.1823400557041168, -10.194028414785862, -9.991755489259958, -10.809884950518608, -4.0726627235611375, -4.209710453947395, -4.134238084157317, -2.6605953499674797, -2.340839061886072, -2.8918970972299576, -4.809750770529121, -4.884553519388049, -4.748330754538387, 5.390744581818581, 6.173659414052963, 6.4463707990944386, -3.3978244798878876, -4.092776099840805, -3.8118616441885678, -103.39835752546787, -102.98417036235332, -115.22302579879761, -4.068879070381328, -4.211568827430412, -4.810274536410972, -5.505142892400428, -5.527603412667915, -5.815405557552978, -1.9308659533659664, -1.8729791144530026, -1.3722852716843335, 0.9240093007683754, 0.8446941822767258, 0.4427206814289093, -1.6592963437239376, -1.5426563496391026, -2.316219771901771, -4.135765853027507, -4.339991668860122, -4.16737959782283, -2.3376214404900963, -2.570142512520164, -2.815015976627677, -97.37337696552277, -95.84383803606033, -95.31577768921852, -0.7907066171368058, -0.7461925645669396, -0.9811677088340218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16962715738356032, "mean_inference_ms": 0.7168454109891398, "mean_action_processing_ms": 0.10042544806961688, "mean_env_wait_ms": 0.8231527661483627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 211068, "timesteps_this_iter": 0, "agent_timesteps_total": 633204, "timers": {"sample_time_ms": 20756.993, "sample_throughput": 462.206, "load_time_ms": 0.2, "load_throughput": 48030738.334, "learn_time_ms": 3132.05, "learn_throughput": 3063.17, "update_time_ms": 9.551}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 139.60967636108398, "policy_loss": -0.0012205352319901164, "vf_loss": 139.67737579345703, "vf_explained_var": 0.0736769363284111, "kl": 0.015902021958030883, "entropy": 6.648218035697937, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 211068, "num_agent_steps_sampled": 633204, "num_steps_trained": 211068, "num_agent_steps_trained": 633204, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1472, "training_iteration": 22, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-50-50", "timestamp": 1706190650, "time_this_iter_s": 21.49107837677002, "time_total_s": 452.44324469566345, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 452.44324469566345, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.14516129032258, "ram_util_percent": 50.229032258064514}}
{"episode_reward_max": 18.98848034441471, "episode_reward_min": -340.26130835711956, "episode_reward_mean": -39.5584888037853, "episode_len_mean": 278.23, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -121.87030748526256}, "policy_reward_max": {"shared_policy": 6.479371152818203}, "policy_reward_mean": {"shared_policy": -13.186162934595105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.607857555151014, -28.44439789652826, -318.8424692749977, -6.045497924089432, 0.4785795584321022, -2.988776981830611, 6.400974549353094, -19.845075488090515, 0.7319674659520103, -77.84106523543588, -12.433911949396133, -39.63416193425658, -3.992273896932616, -0.8755029886961267, -4.926621414721026, -304.1705905944109, 5.228439994156361, 2.8745791539549543, -1.094930075109005, -11.261457212269306, -9.338298235088601, -10.055692084133625, -5.842386469244985, -85.69058819860214, -33.60925410687926, -7.565450146794319, 8.322060942649813, 14.448253951966734, -9.64943523705007, 0.09531540423628826, -10.794398881494999, -21.666547417640714, 0.7964464202522947, -3.7003099992871427, 6.047375835478306, -68.82762855291372, -31.685175605118275, -282.8948547281325, -31.29452915117146, 15.985404051840277, 12.234404943883419, 13.275723084807368, -20.01295436918737, 6.54625084251164, -340.26130835711956, 0.3279007151722908, -2.3793853521347046, 0.6059833765029765, 13.865213369950652, -18.036216922104387, -3.1669119596481323, -30.99566885456443, -12.41661126166585, -7.8933315090835094, -14.442635044455557, 18.010774794965982, -11.30246222391726, -321.6055536866188, -13.090722434222712, -16.84815186262132, -5.1761303395033025, 2.2114241644740105, -5.518172465264811, -12.64313711971046, -7.722779929637937, -288.5329926908016, -2.518066890537767, 18.98848034441471, 1.658204972743988, -18.06148421391846, 6.223933495581136, -26.993387803435326, -305.8689927607775, -41.56911139935255, 8.75755212455985, -22.917095445096507, -28.219389244914083, -313.4747155159712, 15.184300981462002, 6.014497224241495, -270.4076699651778, 7.992624901235104, -55.93879973888399, 13.298630736768217, -18.347115479409695, -34.98560425639154, -8.027854748070254, -19.478470742702484, -5.392111945897355, -8.807573862373843, -16.899467412382393, -12.424542337656021, -64.69915941730144, -252.48958231508732, 2.069979095831499, -28.081756059080362, -11.224361628293991, -13.007661081850529, 3.8064936697483063, -7.832410663366318], "episode_lengths": [300, 300, 42, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 77, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 75, 300, 300, 300, 300, 109, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 115, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-1.5486675848563607, -0.9647159253557618, -1.0944740449388917, -9.51743769148986, -9.53529203931491, -9.391668165723488, -102.54453484217326, -114.59706817070644, -101.70086626211803, -1.8884196281433105, -1.7528534829616547, -2.4042248129844666, 0.26292452216148376, 0.23608220368623734, -0.020427167415618896, -1.2067047903935162, -0.857434126238033, -0.924638065199062, 2.2394087562958305, 2.1879792238275115, 1.9735865692297523, -6.356703698635101, -6.597728341817856, -6.890643447637558, -0.03240651388964011, 0.16368453452983545, 0.600689445311815, -25.799252269168697, -25.74890165527662, -26.292911310990654, -4.091233566403389, -4.363154426217079, -3.9795239567756653, -13.072635894020408, -13.423144807418197, -13.138381232817977, -1.3548213044802395, -1.243980581561729, -1.3934720108906475, -0.18578410645326926, -0.017737453182547824, -0.6719814290603097, -1.2264325792590824, -1.6216308573881832, -2.0785579780737606, -99.56781922280788, -100.37243923544884, -104.23033213615417, 1.5779154300689697, 1.95440261811018, 1.696121945977211, 1.1031818340221946, 1.184430452684552, 0.5869668672482078, -0.15626206248998642, -0.23685771226882935, -0.7018103003501892, -3.616079516708851, -3.709327667951584, -3.9360500276088715, -3.4247398624817578, -3.1390813986460415, -2.7744769739608017, -3.5124588385224342, -3.4431154280900955, -3.1001178175210953, -1.7534351547559197, -2.2127522726853783, -1.8761990418036874, -28.976759150624282, -28.302910089492805, -28.410918958485134, -11.537603055437415, -11.003297631939262, -11.068353419502586, -2.3632586747407913, -2.5669322162866592, -2.6352592557668686, 2.665006573001534, 2.896541486183793, 2.760512883464486, 4.774689647058636, 4.894659380118043, 4.778904924790055, -2.9336170951525418, -3.244168842832252, -3.4716492990652768, -0.2189444949229653, 0.07234519223371194, 0.24191470692554162, -3.5338362753391266, -3.5309963747859, -3.7295662313699722, -6.819056515892356, -7.472598349054664, -7.374892552693694, -0.04963009556135489, 0.6303958321610992, 0.21568068365255044, -1.2115916634599415, -1.1610554556051937, -1.3276628802220074, 2.14215736836195, 1.751205027103424, 2.154013440012932, -22.580562440057598, -22.90675332893928, -23.340312783916794, -10.479918248951435, -10.635153517127037, -10.570103839039803, -104.3870523373286, -89.43638285497825, -89.07141953582565, -10.629285993675396, -10.25173380101721, -10.413509356478855, 5.3489522586266105, 5.305964755515248, 5.330487037698418, 4.058151394128799, 4.17432252317667, 4.0019310265779495, 4.467408085862786, 4.3300536895791595, 4.478261309365422, -6.8143041084210125, -6.503614115218326, -6.6950361455480305, 2.1913518508275303, 2.2593740870555195, 2.09552490462859, -110.62831894556682, -121.87030748526256, -107.7626819262902, 0.08987525850534439, 0.08020518720149994, 0.15782026946544647, -1.090146616101265, -0.7336052283644676, -0.555633507668972, 0.35034597416718327, 0.458480571707085, -0.20284316937129176, 4.411430925130844, 4.446069493889809, 5.007712950929999, -5.9526320596536095, -5.813180771966785, -6.270404090483993, -1.0615636482834816, -0.9230082556605339, -1.1823400557041168, -10.194028414785862, -9.991755489259958, -10.809884950518608, -4.0726627235611375, -4.209710453947395, -4.134238084157317, -2.6605953499674797, -2.340839061886072, -2.8918970972299576, -4.809750770529121, -4.884553519388049, -4.748330754538387, 5.390744581818581, 6.173659414052963, 6.4463707990944386, -3.3978244798878876, -4.092776099840805, -3.8118616441885678, -103.39835752546787, -102.98417036235332, -115.22302579879761, -4.068879070381328, -4.211568827430412, -4.810274536410972, -5.505142892400428, -5.527603412667915, -5.815405557552978, -1.9308659533659664, -1.8729791144530026, -1.3722852716843335, 0.9240093007683754, 0.8446941822767258, 0.4427206814289093, -1.6592963437239376, -1.5426563496391026, -2.316219771901771, -4.135765853027507, -4.339991668860122, -4.16737959782283, -2.3376214404900963, -2.570142512520164, -2.815015976627677, -97.37337696552277, -95.84383803606033, -95.31577768921852, -0.7907066171368058, -0.7461925645669396, -0.9811677088340218, 6.304535828530788, 6.20457336306572, 6.479371152818203, 0.420456700026989, 0.721645750105381, 0.516102522611618, -5.830337511996433, -5.463603376100465, -6.767543325821563, 2.0105385979016575, 2.0989468892415317, 2.1144480084379467, -8.9150954708457, -8.918346531689167, -9.15994580090046, -96.55046292642753, -97.56947607795398, -111.74905375639598, -13.918046683073044, -13.978247001767159, -13.672817714512348, 3.0452969024578636, 2.9183654586474006, 2.7938897634545867, -7.347205872337028, -7.475433530906841, -8.094456041852638, -9.30448563148579, -9.645285656054824, -9.26961795737347, -100.12978777786097, -101.20329447587332, -112.14163326223692, 5.214321859180927, 5.1041115671396255, 4.865867555141449, 2.138886321336031, 1.925075240433216, 1.950535662472248, -93.37919847170512, -87.95454318697254, -89.07392830650012, 2.650437280535698, 2.5546902418136597, 2.787497378885746, -18.030546724796302, -18.86388790607453, -19.04436510801316, 4.517737473050744, 4.620987656215817, 4.159905607501656, -6.297506615519524, -5.944467596709728, -6.105141267180443, -11.713823753098652, -11.43573783586423, -11.836042667428657, -2.7769228319327084, -2.574788096050426, -2.6761438200871197, -6.52706903219223, -6.516416937112808, -6.434984773397446, -1.443993000934526, -2.0370416144530026, -1.9110773305098263, -2.9391510734955517, -2.8658196280400006, -3.002603160838291, -5.762426277001708, -5.634756368895381, -5.502284766485303, -3.587454840540886, -3.8994373232126236, -4.937650173902512, -21.558776691555984, -21.635897278785713, -21.50448544695974, -82.52655211091042, -87.14804995059967, -82.81498025357723, 0.5558320631583484, 0.8492100456108602, 0.6649369870622905, -9.435818403959274, -9.640793189406395, -9.005144465714693, -4.129537358880043, -3.575245827436447, -3.519578441977501, -4.370654031634331, -4.421857476234436, -4.215149573981762, 1.4085938334465027, 1.318656012415886, 1.0792438238859177, -2.6019613295793533, -2.669727750122547, -2.5607215836644173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16943222108863698, "mean_inference_ms": 0.7187647525856726, "mean_action_processing_ms": 0.10081938586634226, "mean_env_wait_ms": 0.8249586189844197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 220662, "timesteps_this_iter": 0, "agent_timesteps_total": 661986, "timers": {"sample_time_ms": 20949.523, "sample_throughput": 457.958, "load_time_ms": 0.2, "load_throughput": 48030738.334, "learn_time_ms": 3140.999, "learn_throughput": 3054.442, "update_time_ms": 9.553}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 151.7296543121338, "policy_loss": -0.0016121621065851022, "vf_loss": 151.79957008361816, "vf_explained_var": 0.061110518872737885, "kl": 0.0074180226474757395, "entropy": 6.830908834934235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220662, "num_agent_steps_sampled": 661986, "num_steps_trained": 220662, "num_agent_steps_trained": 661986, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1505, "training_iteration": 23, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-51-12", "timestamp": 1706190672, "time_this_iter_s": 22.17753314971924, "time_total_s": 474.6207778453827, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03511D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 474.6207778453827, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 8.338709677419354, "ram_util_percent": 51.332258064516125}}
{"episode_reward_max": 18.98848034441471, "episode_reward_min": -340.26130835711956, "episode_reward_mean": -45.255628094933925, "episode_len_mean": 271.42, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {"shared_policy": -121.87030748526256}, "policy_reward_max": {"shared_policy": 6.479371152818203}, "policy_reward_mean": {"shared_policy": -15.085209364977981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.985404051840277, 12.234404943883419, 13.275723084807368, -20.01295436918737, 6.54625084251164, -340.26130835711956, 0.3279007151722908, -2.3793853521347046, 0.6059833765029765, 13.865213369950652, -18.036216922104387, -3.1669119596481323, -30.99566885456443, -12.41661126166585, -7.8933315090835094, -14.442635044455557, 18.010774794965982, -11.30246222391726, -321.6055536866188, -13.090722434222712, -16.84815186262132, -5.1761303395033025, 2.2114241644740105, -5.518172465264811, -12.64313711971046, -7.722779929637937, -288.5329926908016, -2.518066890537767, 18.98848034441471, 1.658204972743988, -18.06148421391846, 6.223933495581136, -26.993387803435326, -305.8689927607775, -41.56911139935255, 8.75755212455985, -22.917095445096507, -28.219389244914083, -313.4747155159712, 15.184300981462002, 6.014497224241495, -270.4076699651778, 7.992624901235104, -55.93879973888399, 13.298630736768217, -18.347115479409695, -34.98560425639154, -8.027854748070254, -19.478470742702484, -5.392111945897355, -8.807573862373843, -16.899467412382393, -12.424542337656021, -64.69915941730144, -252.48958231508732, 2.069979095831499, -28.081756059080362, -11.224361628293991, -13.007661081850529, 3.8064936697483063, -7.832410663366318, -3.368592649698286, 5.581888131797285, -297.21389999613166, 9.394601039588451, -296.99092995375395, -3.082170665264144, -35.39999113231899, -18.69431622326374, -9.469816930592074, -7.709449321031585, -283.93332015536726, -23.296564579010024, -7.221518345177202, -5.031995506957173, -17.670710194855943, -290.8308632224798, 3.8607186079024984, -9.001048609614372, -17.451198078691988, 8.868287891149492, 2.592673890292616, -13.998124934732914, -17.986137829720988, -31.849765598773985, -290.68750524520874, 2.2502392381429672, -7.751742810010924, -1.143392838537693, -289.85165083408356, -10.507157504558592, -8.283803574740901, -15.531510755419745, 1.9667397290467932, 3.6506492868065834, 10.576794885098934, -12.168965354561806, -14.916448518633857, 8.796459510922404, 10.59446407854557], "episode_lengths": [300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 66, 300, 300, 300, 300, 300, 300, 75, 300, 300, 300, 300, 109, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 115, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 65, 300, 300, 300, 300, 300, 76, 300, 300, 300, 300, 122, 300, 300, 300, 300, 300, 300, 300, 300, 63, 300, 300, 300, 58, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.3489522586266105, 5.305964755515248, 5.330487037698418, 4.058151394128799, 4.17432252317667, 4.0019310265779495, 4.467408085862786, 4.3300536895791595, 4.478261309365422, -6.8143041084210125, -6.503614115218326, -6.6950361455480305, 2.1913518508275303, 2.2593740870555195, 2.09552490462859, -110.62831894556682, -121.87030748526256, -107.7626819262902, 0.08987525850534439, 0.08020518720149994, 0.15782026946544647, -1.090146616101265, -0.7336052283644676, -0.555633507668972, 0.35034597416718327, 0.458480571707085, -0.20284316937129176, 4.411430925130844, 4.446069493889809, 5.007712950929999, -5.9526320596536095, -5.813180771966785, -6.270404090483993, -1.0615636482834816, -0.9230082556605339, -1.1823400557041168, -10.194028414785862, -9.991755489259958, -10.809884950518608, -4.0726627235611375, -4.209710453947395, -4.134238084157317, -2.6605953499674797, -2.340839061886072, -2.8918970972299576, -4.809750770529121, -4.884553519388049, -4.748330754538387, 5.390744581818581, 6.173659414052963, 6.4463707990944386, -3.3978244798878876, -4.092776099840805, -3.8118616441885678, -103.39835752546787, -102.98417036235332, -115.22302579879761, -4.068879070381328, -4.211568827430412, -4.810274536410972, -5.505142892400428, -5.527603412667915, -5.815405557552978, -1.9308659533659664, -1.8729791144530026, -1.3722852716843335, 0.9240093007683754, 0.8446941822767258, 0.4427206814289093, -1.6592963437239376, -1.5426563496391026, -2.316219771901771, -4.135765853027507, -4.339991668860122, -4.16737959782283, -2.3376214404900963, -2.570142512520164, -2.815015976627677, -97.37337696552277, -95.84383803606033, -95.31577768921852, -0.7907066171368058, -0.7461925645669396, -0.9811677088340218, 6.304535828530788, 6.20457336306572, 6.479371152818203, 0.420456700026989, 0.721645750105381, 0.516102522611618, -5.830337511996433, -5.463603376100465, -6.767543325821563, 2.0105385979016575, 2.0989468892415317, 2.1144480084379467, -8.9150954708457, -8.918346531689167, -9.15994580090046, -96.55046292642753, -97.56947607795398, -111.74905375639598, -13.918046683073044, -13.978247001767159, -13.672817714512348, 3.0452969024578636, 2.9183654586474006, 2.7938897634545867, -7.347205872337028, -7.475433530906841, -8.094456041852638, -9.30448563148579, -9.645285656054824, -9.26961795737347, -100.12978777786097, -101.20329447587332, -112.14163326223692, 5.214321859180927, 5.1041115671396255, 4.865867555141449, 2.138886321336031, 1.925075240433216, 1.950535662472248, -93.37919847170512, -87.95454318697254, -89.07392830650012, 2.650437280535698, 2.5546902418136597, 2.787497378885746, -18.030546724796302, -18.86388790607453, -19.04436510801316, 4.517737473050744, 4.620987656215817, 4.159905607501656, -6.297506615519524, -5.944467596709728, -6.105141267180443, -11.713823753098652, -11.43573783586423, -11.836042667428657, -2.7769228319327084, -2.574788096050426, -2.6761438200871197, -6.52706903219223, -6.516416937112808, -6.434984773397446, -1.443993000934526, -2.0370416144530026, -1.9110773305098263, -2.9391510734955517, -2.8658196280400006, -3.002603160838291, -5.762426277001708, -5.634756368895381, -5.502284766485303, -3.587454840540886, -3.8994373232126236, -4.937650173902512, -21.558776691555984, -21.635897278785713, -21.50448544695974, -82.52655211091042, -87.14804995059967, -82.81498025357723, 0.5558320631583484, 0.8492100456108602, 0.6649369870622905, -9.435818403959274, -9.640793189406395, -9.005144465714693, -4.129537358880043, -3.575245827436447, -3.519578441977501, -4.370654031634331, -4.421857476234436, -4.215149573981762, 1.4085938334465027, 1.318656012415886, 1.0792438238859177, -2.6019613295793533, -2.669727750122547, -2.5607215836644173, -1.0609414105614121, -1.0628922705849106, -1.244758968551963, 1.9695525566736762, 1.975109236935765, 1.637226338187844, -102.33702023824057, -96.7908064586421, -98.08607329924902, 3.015919506549835, 3.2072838693857193, 3.171397663652897, -97.78509964545569, -97.69898445655903, -101.50684585173926, -1.0137981275717465, -1.0246030340592114, -1.043769503633186, -11.608345511058971, -11.850331316391632, -11.941314304868385, -6.123926714062691, -6.282185763120651, -6.288203746080399, -3.2181893611947743, -2.9315535674492565, -3.3200740019480435, -2.63685652861993, -2.578722330431148, -2.4938704619805065, -92.45258712768555, -102.4017938375473, -89.0789391901344, -7.7253326723973, -7.487672487894699, -8.083559418718025, -2.544358683129161, -2.4604129542907174, -2.2167467077573235, -1.874676987528801, -1.648794736713171, -1.5085237827152014, -5.668274125705167, -6.109321097532913, -5.893114971617862, -92.76442896326384, -104.90266319115958, -93.16377106805643, 1.3563923041025703, 1.3711281369129722, 1.133198166886956, -2.6503914445638657, -2.9247470796108246, -3.425910085439682, -6.358125289281219, -5.553701226909965, -5.539371562500804, 2.8408118138710563, 3.2303532014290397, 2.7971228758493965, 0.7874347368876045, 0.7445534418026512, 1.0606857116023605, -4.448636472225189, -4.401561431586742, -5.147927030920982, -5.953480663398906, -5.7852290819088665, -6.247428084413215, -10.43327580144009, -10.824425061543792, -10.592064735790103, -96.15573371946812, -96.06600295007229, -98.46576857566833, 0.679928183555603, 0.9825248718261719, 0.5877861827611923, -2.5416667337218968, -2.4731842751304356, -2.736891801158592, -0.132634699344635, -0.8615856468677521, -0.14917249232530594, -95.06430587917566, -99.43430948257446, -95.35303547233343, -3.492376786967128, -3.6249695171912606, -3.389811200400203, -2.756520460049316, -2.6833115393916813, -2.8439715752999035, -4.802088330189392, -5.226612503329918, -5.502809921900436, 0.6877700562278335, 0.8214704270164077, 0.45749924580255197, 1.0972190350294113, 1.2707927897572517, 1.2826374620199203, 3.473926991224289, 3.606595605611801, 3.496272288262844, -3.923577807843685, -3.8899420127272606, -4.35544553399086, -5.070876578489944, -4.8926506067315785, -4.952921333412334, 2.8607877964774673, 2.7247509608666007, 3.2109207535783355, 3.5820828825235367, 3.35353721678257, 3.658843979239464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16918130119448216, "mean_inference_ms": 0.7204362394834658, "mean_action_processing_ms": 0.10077879090483989, "mean_env_wait_ms": 0.8271053430704548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 230256, "timesteps_this_iter": 0, "agent_timesteps_total": 690768, "timers": {"sample_time_ms": 20919.084, "sample_throughput": 458.624, "load_time_ms": 0.2, "load_throughput": 48030738.334, "learn_time_ms": 3145.446, "learn_throughput": 3050.124, "update_time_ms": 9.741}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 187.37232780456543, "policy_loss": -0.0010660894374052588, "vf_loss": 187.4446086883545, "vf_explained_var": 0.13715122640132904, "kl": 0.012697662525175764, "entropy": 7.122043132781982, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 230256, "num_agent_steps_sampled": 690768, "num_steps_trained": 230256, "num_agent_steps_trained": 690768, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1544, "training_iteration": 24, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-51-32", "timestamp": 1706190692, "time_this_iter_s": 20.43333148956299, "time_total_s": 495.0541093349457, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175C4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 495.0541093349457, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.844827586206897, "ram_util_percent": 51.206896551724135}}
{"episode_reward_max": 28.08672296255827, "episode_reward_min": -313.4747155159712, "episode_reward_mean": -41.261309835063294, "episode_len_mean": 276.3, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -112.14163326223692}, "policy_reward_max": {"shared_policy": 9.560642398893833}, "policy_reward_mean": {"shared_policy": -13.753769945021103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.223933495581136, -26.993387803435326, -305.8689927607775, -41.56911139935255, 8.75755212455985, -22.917095445096507, -28.219389244914083, -313.4747155159712, 15.184300981462002, 6.014497224241495, -270.4076699651778, 7.992624901235104, -55.93879973888399, 13.298630736768217, -18.347115479409695, -34.98560425639154, -8.027854748070254, -19.478470742702484, -5.392111945897355, -8.807573862373843, -16.899467412382393, -12.424542337656021, -64.69915941730144, -252.48958231508732, 2.069979095831499, -28.081756059080362, -11.224361628293991, -13.007661081850529, 3.8064936697483063, -7.832410663366318, -3.368592649698286, 5.581888131797285, -297.21389999613166, 9.394601039588451, -296.99092995375395, -3.082170665264144, -35.39999113231899, -18.69431622326374, -9.469816930592074, -7.709449321031585, -283.93332015536726, -23.296564579010024, -7.221518345177202, -5.031995506957173, -17.670710194855943, -290.8308632224798, 3.8607186079024984, -9.001048609614372, -17.451198078691988, 8.868287891149492, 2.592673890292616, -13.998124934732914, -17.986137829720988, -31.849765598773985, -290.68750524520874, 2.2502392381429672, -7.751742810010924, -1.143392838537693, -289.85165083408356, -10.507157504558592, -8.283803574740901, -15.531510755419745, 1.9667397290467932, 3.6506492868065834, 10.576794885098934, -12.168965354561806, -14.916448518633857, 8.796459510922404, 10.59446407854557, -4.418911850079908, -26.090824616141617, 28.08672296255827, -288.25473855435854, 14.126515127718434, 9.10099183022976, -16.0778143517673, -14.460872475057855, 11.274978041648836, 2.1410536542534544, -10.469288326799884, -30.718516826629653, 6.936387218534946, -25.366057023406043, 9.685505092144012, -10.837708987295628, -13.678674049675465, 6.230271317064748, -6.217933386564255, -59.79545590281488, -50.409176521003275, 13.250821575522394, -19.77754015475513, -17.30067804455757, -37.702248506248026, -49.63026992976668, -27.86159238219264, 6.5892453640699244, -19.705540016293554, -36.26244184374812, 8.130704727023826], "episode_lengths": [300, 300, 75, 300, 300, 300, 300, 109, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 115, 300, 300, 300, 300, 300, 300, 300, 300, 64, 300, 65, 300, 300, 300, 300, 300, 76, 300, 300, 300, 300, 122, 300, 300, 300, 300, 300, 300, 300, 300, 63, 300, 300, 300, 58, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 76, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.0105385979016575, 2.0989468892415317, 2.1144480084379467, -8.9150954708457, -8.918346531689167, -9.15994580090046, -96.55046292642753, -97.56947607795398, -111.74905375639598, -13.918046683073044, -13.978247001767159, -13.672817714512348, 3.0452969024578636, 2.9183654586474006, 2.7938897634545867, -7.347205872337028, -7.475433530906841, -8.094456041852638, -9.30448563148579, -9.645285656054824, -9.26961795737347, -100.12978777786097, -101.20329447587332, -112.14163326223692, 5.214321859180927, 5.1041115671396255, 4.865867555141449, 2.138886321336031, 1.925075240433216, 1.950535662472248, -93.37919847170512, -87.95454318697254, -89.07392830650012, 2.650437280535698, 2.5546902418136597, 2.787497378885746, -18.030546724796302, -18.86388790607453, -19.04436510801316, 4.517737473050744, 4.620987656215817, 4.159905607501656, -6.297506615519524, -5.944467596709728, -6.105141267180443, -11.713823753098652, -11.43573783586423, -11.836042667428657, -2.7769228319327084, -2.574788096050426, -2.6761438200871197, -6.52706903219223, -6.516416937112808, -6.434984773397446, -1.443993000934526, -2.0370416144530026, -1.9110773305098263, -2.9391510734955517, -2.8658196280400006, -3.002603160838291, -5.762426277001708, -5.634756368895381, -5.502284766485303, -3.587454840540886, -3.8994373232126236, -4.937650173902512, -21.558776691555984, -21.635897278785713, -21.50448544695974, -82.52655211091042, -87.14804995059967, -82.81498025357723, 0.5558320631583484, 0.8492100456108602, 0.6649369870622905, -9.435818403959274, -9.640793189406395, -9.005144465714693, -4.129537358880043, -3.575245827436447, -3.519578441977501, -4.370654031634331, -4.421857476234436, -4.215149573981762, 1.4085938334465027, 1.318656012415886, 1.0792438238859177, -2.6019613295793533, -2.669727750122547, -2.5607215836644173, -1.0609414105614121, -1.0628922705849106, -1.244758968551963, 1.9695525566736762, 1.975109236935765, 1.637226338187844, -102.33702023824057, -96.7908064586421, -98.08607329924902, 3.015919506549835, 3.2072838693857193, 3.171397663652897, -97.78509964545569, -97.69898445655903, -101.50684585173926, -1.0137981275717465, -1.0246030340592114, -1.043769503633186, -11.608345511058971, -11.850331316391632, -11.941314304868385, -6.123926714062691, -6.282185763120651, -6.288203746080399, -3.2181893611947743, -2.9315535674492565, -3.3200740019480435, -2.63685652861993, -2.578722330431148, -2.4938704619805065, -92.45258712768555, -102.4017938375473, -89.0789391901344, -7.7253326723973, -7.487672487894699, -8.083559418718025, -2.544358683129161, -2.4604129542907174, -2.2167467077573235, -1.874676987528801, -1.648794736713171, -1.5085237827152014, -5.668274125705167, -6.109321097532913, -5.893114971617862, -92.76442896326384, -104.90266319115958, -93.16377106805643, 1.3563923041025703, 1.3711281369129722, 1.133198166886956, -2.6503914445638657, -2.9247470796108246, -3.425910085439682, -6.358125289281219, -5.553701226909965, -5.539371562500804, 2.8408118138710563, 3.2303532014290397, 2.7971228758493965, 0.7874347368876045, 0.7445534418026512, 1.0606857116023605, -4.448636472225189, -4.401561431586742, -5.147927030920982, -5.953480663398906, -5.7852290819088665, -6.247428084413215, -10.43327580144009, -10.824425061543792, -10.592064735790103, -96.15573371946812, -96.06600295007229, -98.46576857566833, 0.679928183555603, 0.9825248718261719, 0.5877861827611923, -2.5416667337218968, -2.4731842751304356, -2.736891801158592, -0.132634699344635, -0.8615856468677521, -0.14917249232530594, -95.06430587917566, -99.43430948257446, -95.35303547233343, -3.492376786967128, -3.6249695171912606, -3.389811200400203, -2.756520460049316, -2.6833115393916813, -2.8439715752999035, -4.802088330189392, -5.226612503329918, -5.502809921900436, 0.6877700562278335, 0.8214704270164077, 0.45749924580255197, 1.0972190350294113, 1.2707927897572517, 1.2826374620199203, 3.473926991224289, 3.606595605611801, 3.496272288262844, -3.923577807843685, -3.8899420127272606, -4.35544553399086, -5.070876578489944, -4.8926506067315785, -4.952921333412334, 2.8607877964774673, 2.7247509608666007, 3.2109207535783355, 3.5820828825235367, 3.35353721678257, 3.658843979239464, -1.7157153288523403, -1.5644518161813465, -1.1387447050462214, -8.792373403906822, -8.914737679064274, -8.383713533170521, 9.077593803405762, 9.448486760258675, 9.560642398893833, -94.84482150276503, -95.03013286491236, -98.37978418668112, 5.147930805881813, 5.167029363413647, 3.811554958422974, 2.786471039056778, 2.9910754561424255, 3.3234453350305557, -5.183967310935259, -5.379330717027187, -5.514516323804855, -4.812820705274746, -4.983562159041568, -4.664489610741541, 3.8623113582531516, 3.715300189952046, 3.6973664934436385, 0.6639793316523139, 1.0188124502698486, 0.4582618723312919, -3.1847698564330784, -3.4716034630934445, -3.812915007273361, -10.13417560855548, -10.407348314921066, -10.176992903153106, 2.3771409019827843, 1.992794543504715, 2.566451773047447, -8.373576345543071, -8.283529075483486, -8.708951602379486, 3.2923742458224297, 3.2577570602297783, 3.1353737860918045, -3.306958444416523, -3.772838443517685, -3.7579120993614197, -4.260467670857906, -4.628780230879784, -4.789426147937775, 2.341012944777802, 2.081853253146008, 1.8074051191409382, -2.427911713719368, -1.9127621427178383, -1.8772595301270485, -19.77659296492736, -19.507485891381904, -20.511377046505615, -16.58538116266331, -16.936274041732162, -16.887521316607803, 4.4293935994307105, 4.565866405765206, 4.255561570326478, -7.1079675356547085, -6.457545335094139, -6.2120272840062825, -5.993726849555969, -5.515714138746262, -5.791237056255341, -12.554948789378017, -12.613093679149955, -12.534206037720054, -16.580192645390838, -16.729937096436828, -16.320140187939018, -8.714176808794349, -9.286312853296607, -9.861102720101684, 2.522205417354897, 2.080291738112763, 1.9867482086022648, -6.691042085488647, -6.421581258376449, -6.5929166724284585, -12.029868447532266, -12.191769284506648, -12.040804111709207, 2.461005469163254, 3.1031566870709213, 2.5665425707896503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1687924761655717, "mean_inference_ms": 0.7212783546826452, "mean_action_processing_ms": 0.10096469136784661, "mean_env_wait_ms": 0.8280251574450423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 239850, "timesteps_this_iter": 0, "agent_timesteps_total": 719550, "timers": {"sample_time_ms": 20931.328, "sample_throughput": 458.356, "load_time_ms": 0.1, "load_throughput": 95946954.163, "learn_time_ms": 3155.017, "learn_throughput": 3040.871, "update_time_ms": 9.635}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 42.22394371032715, "policy_loss": -0.0020555451011541326, "vf_loss": 42.29634618759155, "vf_explained_var": 0.0480131059885025, "kl": 0.007730764053127562, "entropy": 7.034824907779694, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 239850, "num_agent_steps_sampled": 719550, "num_steps_trained": 239850, "num_agent_steps_trained": 719550, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1575, "training_iteration": 25, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-51-53", "timestamp": 1706190713, "time_this_iter_s": 20.95102095603943, "time_total_s": 516.0051302909851, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 516.0051302909851, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.693333333333333, "ram_util_percent": 51.14666666666667}}
{"episode_reward_max": 28.08672296255827, "episode_reward_min": -305.2358284294606, "episode_reward_mean": -27.367797176055618, "episode_len_mean": 286.76, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -108.5858753224214}, "policy_reward_max": {"shared_policy": 9.560642398893833}, "policy_reward_mean": {"shared_policy": -9.122599058685207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.39999113231899, -18.69431622326374, -9.469816930592074, -7.709449321031585, -283.93332015536726, -23.296564579010024, -7.221518345177202, -5.031995506957173, -17.670710194855943, -290.8308632224798, 3.8607186079024984, -9.001048609614372, -17.451198078691988, 8.868287891149492, 2.592673890292616, -13.998124934732914, -17.986137829720988, -31.849765598773985, -290.68750524520874, 2.2502392381429672, -7.751742810010924, -1.143392838537693, -289.85165083408356, -10.507157504558592, -8.283803574740901, -15.531510755419745, 1.9667397290467932, 3.6506492868065834, 10.576794885098934, -12.168965354561806, -14.916448518633857, 8.796459510922404, 10.59446407854557, -4.418911850079908, -26.090824616141617, 28.08672296255827, -288.25473855435854, 14.126515127718434, 9.10099183022976, -16.0778143517673, -14.460872475057855, 11.274978041648836, 2.1410536542534544, -10.469288326799884, -30.718516826629653, 6.936387218534946, -25.366057023406043, 9.685505092144012, -10.837708987295628, -13.678674049675465, 6.230271317064748, -6.217933386564255, -59.79545590281488, -50.409176521003275, 13.250821575522394, -19.77754015475513, -17.30067804455757, -37.702248506248026, -49.63026992976668, -27.86159238219264, 6.5892453640699244, -19.705540016293554, -36.26244184374812, 8.130704727023826, -1.2258216515183733, 9.964212797582121, -8.235571347177029, 7.88501987233758, -44.288895070552854, -9.26952603459361, -11.359613951295643, -305.2358284294606, -5.071368865668774, -4.366355046629906, -60.8106755949557, -3.2937051504850388, -22.76772504299879, -3.122715473175063, -1.159269344061613, -35.200680665671825, -8.992713838815703, 9.149632520973654, 1.2206788212060786, -17.20004865527153, -7.469430759549169, 10.85883571207522, -61.7269931882619, 5.932459160685539, -13.057253235019772, -68.29000726342213, 0.033996738493442535, -10.261103868484525, 9.481890097260447, 12.25202021002768, 4.970288500189781, -33.23555325344205, -38.886333949863925, -2.8841299042105675, 4.677688639611006, 0.9179367274045802], "episode_lengths": [300, 300, 300, 300, 76, 300, 300, 300, 300, 122, 300, 300, 300, 300, 300, 300, 300, 300, 63, 300, 300, 300, 58, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 76, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-11.608345511058971, -11.850331316391632, -11.941314304868385, -6.123926714062691, -6.282185763120651, -6.288203746080399, -3.2181893611947743, -2.9315535674492565, -3.3200740019480435, -2.63685652861993, -2.578722330431148, -2.4938704619805065, -92.45258712768555, -102.4017938375473, -89.0789391901344, -7.7253326723973, -7.487672487894699, -8.083559418718025, -2.544358683129161, -2.4604129542907174, -2.2167467077573235, -1.874676987528801, -1.648794736713171, -1.5085237827152014, -5.668274125705167, -6.109321097532913, -5.893114971617862, -92.76442896326384, -104.90266319115958, -93.16377106805643, 1.3563923041025703, 1.3711281369129722, 1.133198166886956, -2.6503914445638657, -2.9247470796108246, -3.425910085439682, -6.358125289281219, -5.553701226909965, -5.539371562500804, 2.8408118138710563, 3.2303532014290397, 2.7971228758493965, 0.7874347368876045, 0.7445534418026512, 1.0606857116023605, -4.448636472225189, -4.401561431586742, -5.147927030920982, -5.953480663398906, -5.7852290819088665, -6.247428084413215, -10.43327580144009, -10.824425061543792, -10.592064735790103, -96.15573371946812, -96.06600295007229, -98.46576857566833, 0.679928183555603, 0.9825248718261719, 0.5877861827611923, -2.5416667337218968, -2.4731842751304356, -2.736891801158592, -0.132634699344635, -0.8615856468677521, -0.14917249232530594, -95.06430587917566, -99.43430948257446, -95.35303547233343, -3.492376786967128, -3.6249695171912606, -3.389811200400203, -2.756520460049316, -2.6833115393916813, -2.8439715752999035, -4.802088330189392, -5.226612503329918, -5.502809921900436, 0.6877700562278335, 0.8214704270164077, 0.45749924580255197, 1.0972190350294113, 1.2707927897572517, 1.2826374620199203, 3.473926991224289, 3.606595605611801, 3.496272288262844, -3.923577807843685, -3.8899420127272606, -4.35544553399086, -5.070876578489944, -4.8926506067315785, -4.952921333412334, 2.8607877964774673, 2.7247509608666007, 3.2109207535783355, 3.5820828825235367, 3.35353721678257, 3.658843979239464, -1.7157153288523403, -1.5644518161813465, -1.1387447050462214, -8.792373403906822, -8.914737679064274, -8.383713533170521, 9.077593803405762, 9.448486760258675, 9.560642398893833, -94.84482150276503, -95.03013286491236, -98.37978418668112, 5.147930805881813, 5.167029363413647, 3.811554958422974, 2.786471039056778, 2.9910754561424255, 3.3234453350305557, -5.183967310935259, -5.379330717027187, -5.514516323804855, -4.812820705274746, -4.983562159041568, -4.664489610741541, 3.8623113582531516, 3.715300189952046, 3.6973664934436385, 0.6639793316523139, 1.0188124502698486, 0.4582618723312919, -3.1847698564330784, -3.4716034630934445, -3.812915007273361, -10.13417560855548, -10.407348314921066, -10.176992903153106, 2.3771409019827843, 1.992794543504715, 2.566451773047447, -8.373576345543071, -8.283529075483486, -8.708951602379486, 3.2923742458224297, 3.2577570602297783, 3.1353737860918045, -3.306958444416523, -3.772838443517685, -3.7579120993614197, -4.260467670857906, -4.628780230879784, -4.789426147937775, 2.341012944777802, 2.081853253146008, 1.8074051191409382, -2.427911713719368, -1.9127621427178383, -1.8772595301270485, -19.77659296492736, -19.507485891381904, -20.511377046505615, -16.58538116266331, -16.936274041732162, -16.887521316607803, 4.4293935994307105, 4.565866405765206, 4.255561570326478, -7.1079675356547085, -6.457545335094139, -6.2120272840062825, -5.993726849555969, -5.515714138746262, -5.791237056255341, -12.554948789378017, -12.613093679149955, -12.534206037720054, -16.580192645390838, -16.729937096436828, -16.320140187939018, -8.714176808794349, -9.286312853296607, -9.861102720101684, 2.522205417354897, 2.080291738112763, 1.9867482086022648, -6.691042085488647, -6.421581258376449, -6.5929166724284585, -12.029868447532266, -12.191769284506648, -12.040804111709207, 2.461005469163254, 3.1031566870709213, 2.5665425707896503, -0.5621618827184136, -0.455204104383796, -0.2084556644161637, 3.3010441760222022, 3.3322617361942832, 3.3309068853656356, -2.794717475771904, -2.826547250151634, -2.6143066212534904, 2.4772372096776962, 2.8865868784487247, 2.5211957842111588, -14.260263447960227, -14.856323753794044, -15.172307868798583, -3.2522362818320687, -2.806655054291099, -3.210634698470443, -3.7185720553000863, -3.48113723223409, -4.159904663761466, -98.641183813413, -108.5858753224214, -98.00876929362616, -1.5039636865258217, -1.6648749560117722, -1.9025302231311798, -1.4554176703095436, -1.3596441820263863, -1.5512931942939758, -20.537195811669037, -20.431497255961105, -19.841982527325555, -0.9679452255368233, -1.1640662997961044, -1.161693625152111, -7.530194960534573, -7.400205016136169, -7.837325066328049, -0.8953934932748524, -1.0721354956428257, -1.155186484257385, -0.22532964125275612, -0.1479547843337059, -0.7859849184751511, -11.617846459150314, -11.645304195582867, -11.937530010938644, -3.0528664092222897, -2.8869401911894528, -3.052907238403961, 3.307027528683335, 3.098157020906598, 2.744447971383721, 0.41823579122622334, 0.23467494299013936, 0.5677680869897159, -5.970952615141869, -5.636113874614239, -5.592982165515423, -2.411590879162162, -2.4521832068761285, -2.605656673510879, 3.7139693101247104, 3.744185512264565, 3.400680889685944, -20.815240820248924, -20.41215248902639, -20.49959987898668, 1.9698802009224892, 2.024407498538494, 1.938171461224556, -4.406456326444953, -4.6209973593553, -4.029799549219518, -22.66694037864606, -22.565262379745647, -23.05780450503032, 0.09015515446662903, 0.10839343070983887, -0.16455184668302536, -3.231400830050319, -3.2818240498503144, -3.747878988583892, 3.053098286191613, 3.2739278326431815, 3.1548639784256522, 4.234005724390343, 3.8665969570477756, 4.151417528589562, 1.933293417096138, 1.5317026525735855, 1.5052924305200577, -11.15548039227724, -10.814677219837904, -11.265395641326904, -12.320339600245163, -12.300756084422275, -14.265238265196487, -0.7409456819295883, -0.9697260037064552, -1.173458218574524, 1.2039603888988495, 1.9374207817018032, 1.536307469010353, 0.4008133014043125, 0.3962402840455326, 0.12088314195473515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16812362697920175, "mean_inference_ms": 0.7214700218212491, "mean_action_processing_ms": 0.10080028497995679, "mean_env_wait_ms": 0.8288141810534034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 249444, "timesteps_this_iter": 0, "agent_timesteps_total": 748332, "timers": {"sample_time_ms": 20963.761, "sample_throughput": 457.647, "load_time_ms": 0.1, "load_throughput": 95946954.163, "learn_time_ms": 3161.772, "learn_throughput": 3034.375, "update_time_ms": 9.835}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 54.54521942138672, "policy_loss": 1.0013340784958968e-05, "vf_loss": 54.61851978302002, "vf_explained_var": -0.12028500437736511, "kl": 0.024477179598767978, "entropy": 7.331836700439453, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 249444, "num_agent_steps_sampled": 748332, "num_steps_trained": 249444, "num_agent_steps_trained": 748332, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1611, "training_iteration": 26, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-52-14", "timestamp": 1706190734, "time_this_iter_s": 20.73972249031067, "time_total_s": 536.7448527812958, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175C9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 536.7448527812958, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.10344827586207, "ram_util_percent": 51.08275862068965}}
{"episode_reward_max": 28.08672296255827, "episode_reward_min": -309.1127537339926, "episode_reward_mean": -22.76166132852203, "episode_len_mean": 288.82, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -108.5858753224214}, "policy_reward_max": {"shared_policy": 9.560642398893833}, "policy_reward_mean": {"shared_policy": -7.58722044284068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.796459510922404, 10.59446407854557, -4.418911850079908, -26.090824616141617, 28.08672296255827, -288.25473855435854, 14.126515127718434, 9.10099183022976, -16.0778143517673, -14.460872475057855, 11.274978041648836, 2.1410536542534544, -10.469288326799884, -30.718516826629653, 6.936387218534946, -25.366057023406043, 9.685505092144012, -10.837708987295628, -13.678674049675465, 6.230271317064748, -6.217933386564255, -59.79545590281488, -50.409176521003275, 13.250821575522394, -19.77754015475513, -17.30067804455757, -37.702248506248026, -49.63026992976668, -27.86159238219264, 6.5892453640699244, -19.705540016293554, -36.26244184374812, 8.130704727023826, -1.2258216515183733, 9.964212797582121, -8.235571347177029, 7.88501987233758, -44.288895070552854, -9.26952603459361, -11.359613951295643, -305.2358284294606, -5.071368865668774, -4.366355046629906, -60.8106755949557, -3.2937051504850388, -22.76772504299879, -3.122715473175063, -1.159269344061613, -35.200680665671825, -8.992713838815703, 9.149632520973654, 1.2206788212060786, -17.20004865527153, -7.469430759549169, 10.85883571207522, -61.7269931882619, 5.932459160685539, -13.057253235019772, -68.29000726342213, 0.033996738493442535, -10.261103868484525, 9.481890097260447, 12.25202021002768, 4.970288500189781, -33.23555325344205, -38.886333949863925, -2.8841299042105675, 4.677688639611006, 0.9179367274045802, 9.803135238587856, -0.7829681336879872, 4.9879190325737, 15.33106227591631, -16.885869994759574, 14.983395338058443, 9.082825157791362, -284.5838982462883, -17.379223957657814, -309.1127537339926, -4.1428383849561214, -67.90641640126708, -4.886727362871184, -13.384754061698942, 6.926395952701554, 3.212163485586629, -0.7547473739832782, -2.5291741192340993, 17.107756477082148, -1.9884814843535565, -278.38300526328385, -20.990820340812206, 4.754557602107511, 4.830195412039757, -18.21631155163051, 24.494207970798, -28.279662184417276, 12.382980160415158, 1.5516259074210836, -23.0362478941679, 17.788370661437483], "episode_lengths": [300, 300, 300, 300, 300, 76, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.8607877964774673, 2.7247509608666007, 3.2109207535783355, 3.5820828825235367, 3.35353721678257, 3.658843979239464, -1.7157153288523403, -1.5644518161813465, -1.1387447050462214, -8.792373403906822, -8.914737679064274, -8.383713533170521, 9.077593803405762, 9.448486760258675, 9.560642398893833, -94.84482150276503, -95.03013286491236, -98.37978418668112, 5.147930805881813, 5.167029363413647, 3.811554958422974, 2.786471039056778, 2.9910754561424255, 3.3234453350305557, -5.183967310935259, -5.379330717027187, -5.514516323804855, -4.812820705274746, -4.983562159041568, -4.664489610741541, 3.8623113582531516, 3.715300189952046, 3.6973664934436385, 0.6639793316523139, 1.0188124502698486, 0.4582618723312919, -3.1847698564330784, -3.4716034630934445, -3.812915007273361, -10.13417560855548, -10.407348314921066, -10.176992903153106, 2.3771409019827843, 1.992794543504715, 2.566451773047447, -8.373576345543071, -8.283529075483486, -8.708951602379486, 3.2923742458224297, 3.2577570602297783, 3.1353737860918045, -3.306958444416523, -3.772838443517685, -3.7579120993614197, -4.260467670857906, -4.628780230879784, -4.789426147937775, 2.341012944777802, 2.081853253146008, 1.8074051191409382, -2.427911713719368, -1.9127621427178383, -1.8772595301270485, -19.77659296492736, -19.507485891381904, -20.511377046505615, -16.58538116266331, -16.936274041732162, -16.887521316607803, 4.4293935994307105, 4.565866405765206, 4.255561570326478, -7.1079675356547085, -6.457545335094139, -6.2120272840062825, -5.993726849555969, -5.515714138746262, -5.791237056255341, -12.554948789378017, -12.613093679149955, -12.534206037720054, -16.580192645390838, -16.729937096436828, -16.320140187939018, -8.714176808794349, -9.286312853296607, -9.861102720101684, 2.522205417354897, 2.080291738112763, 1.9867482086022648, -6.691042085488647, -6.421581258376449, -6.5929166724284585, -12.029868447532266, -12.191769284506648, -12.040804111709207, 2.461005469163254, 3.1031566870709213, 2.5665425707896503, -0.5621618827184136, -0.455204104383796, -0.2084556644161637, 3.3010441760222022, 3.3322617361942832, 3.3309068853656356, -2.794717475771904, -2.826547250151634, -2.6143066212534904, 2.4772372096776962, 2.8865868784487247, 2.5211957842111588, -14.260263447960227, -14.856323753794044, -15.172307868798583, -3.2522362818320687, -2.806655054291099, -3.210634698470443, -3.7185720553000863, -3.48113723223409, -4.159904663761466, -98.641183813413, -108.5858753224214, -98.00876929362616, -1.5039636865258217, -1.6648749560117722, -1.9025302231311798, -1.4554176703095436, -1.3596441820263863, -1.5512931942939758, -20.537195811669037, -20.431497255961105, -19.841982527325555, -0.9679452255368233, -1.1640662997961044, -1.161693625152111, -7.530194960534573, -7.400205016136169, -7.837325066328049, -0.8953934932748524, -1.0721354956428257, -1.155186484257385, -0.22532964125275612, -0.1479547843337059, -0.7859849184751511, -11.617846459150314, -11.645304195582867, -11.937530010938644, -3.0528664092222897, -2.8869401911894528, -3.052907238403961, 3.307027528683335, 3.098157020906598, 2.744447971383721, 0.41823579122622334, 0.23467494299013936, 0.5677680869897159, -5.970952615141869, -5.636113874614239, -5.592982165515423, -2.411590879162162, -2.4521832068761285, -2.605656673510879, 3.7139693101247104, 3.744185512264565, 3.400680889685944, -20.815240820248924, -20.41215248902639, -20.49959987898668, 1.9698802009224892, 2.024407498538494, 1.938171461224556, -4.406456326444953, -4.6209973593553, -4.029799549219518, -22.66694037864606, -22.565262379745647, -23.05780450503032, 0.09015515446662903, 0.10839343070983887, -0.16455184668302536, -3.231400830050319, -3.2818240498503144, -3.747878988583892, 3.053098286191613, 3.2739278326431815, 3.1548639784256522, 4.234005724390343, 3.8665969570477756, 4.151417528589562, 1.933293417096138, 1.5317026525735855, 1.5052924305200577, -11.15548039227724, -10.814677219837904, -11.265395641326904, -12.320339600245163, -12.300756084422275, -14.265238265196487, -0.7409456819295883, -0.9697260037064552, -1.173458218574524, 1.2039603888988495, 1.9374207817018032, 1.536307469010353, 0.4008133014043125, 0.3962402840455326, 0.12088314195473515, 3.4346577376127243, 3.425869144499302, 2.94260835647583, 0.10245057692129933, -0.09737257907788432, -0.7880461315314022, 1.6590556502342224, 1.7386194318532944, 1.5902439504861832, 5.1899092371265, 4.630169729391724, 5.510983309398085, -5.568733478585884, -5.468490387002632, -5.848646129171058, 5.006018976370484, 5.079859296480805, 4.897517065207154, 3.1117889819045814, 2.993066233893231, 2.9779699419935497, -91.21108084420364, -101.8862751821677, -91.48654221991698, -5.697412587702274, -6.087962374091148, -5.593848995864391, -101.70890595018864, -102.21108916401863, -105.19275861978531, -1.5349154993891716, -1.3384846858680248, -1.269438199698925, -22.28684414426486, -22.62019817034404, -22.999374086658165, -2.2160700062910763, -1.7003870854775158, -0.9702702711025921, -4.614520420630782, -4.36426439632973, -4.405969244738429, 2.2352346976598056, 2.517005299528435, 2.1741559555133136, 0.827938516934708, 1.1235480879743847, 1.2606768806775364, -0.3563498432437626, -0.2982404927412716, -0.10015703799824394, -0.7968713442484585, -0.6857461581627575, -1.0465566168228833, 5.377618461847305, 5.611540764570236, 6.118597250664607, -0.6483874271313397, -0.8750351319710461, -0.46505892525117076, -88.0775647337238, -102.54203365246455, -87.7634068770955, -7.08631806075573, -6.898443028330803, -7.006059251725674, 1.5956977357466968, 1.3010143836339267, 1.857845482726887, 1.5130667239427567, 1.6164853274822235, 1.7006433606147766, -6.166150319079563, -6.101699406902, -5.948461825648948, 8.311927785476044, 8.451054227848843, 7.731225957473114, -9.270303552349418, -9.38213397314152, -9.627224658926337, 4.107730296750859, 3.97952890147765, 4.29572096218665, 0.5247481266657417, 0.49653583268323587, 0.5303419480721061, -7.584266982972622, -7.6736458614468575, -7.778335049748421, 5.657792712251336, 6.024335535864026, 6.106242413322121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16793975322771207, "mean_inference_ms": 0.7221315668604266, "mean_action_processing_ms": 0.10095963478290114, "mean_env_wait_ms": 0.8297784921229346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 259038, "timesteps_this_iter": 0, "agent_timesteps_total": 777114, "timers": {"sample_time_ms": 21065.712, "sample_throughput": 455.432, "load_time_ms": 0.1, "load_throughput": 95946954.163, "learn_time_ms": 3151.665, "learn_throughput": 3044.105, "update_time_ms": 9.936}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 85.31532764434814, "policy_loss": -0.0017876298553223258, "vf_loss": 85.3922061920166, "vf_explained_var": 0.12147538363933563, "kl": 0.009691893432326314, "entropy": 7.5094998478889465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 259038, "num_agent_steps_sampled": 777114, "num_steps_trained": 259038, "num_agent_steps_trained": 777114, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1642, "training_iteration": 27, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-52-36", "timestamp": 1706190756, "time_this_iter_s": 21.552745580673218, "time_total_s": 558.297598361969, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 558.297598361969, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.351612903225806, "ram_util_percent": 48.26129032258065}}
{"episode_reward_max": 24.494207970798, "episode_reward_min": -309.1127537339926, "episode_reward_mean": -22.40142826872646, "episode_len_mean": 287.41, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -108.5858753224214}, "policy_reward_max": {"shared_policy": 8.451054227848843}, "policy_reward_mean": {"shared_policy": -7.467142756242153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.964212797582121, -8.235571347177029, 7.88501987233758, -44.288895070552854, -9.26952603459361, -11.359613951295643, -305.2358284294606, -5.071368865668774, -4.366355046629906, -60.8106755949557, -3.2937051504850388, -22.76772504299879, -3.122715473175063, -1.159269344061613, -35.200680665671825, -8.992713838815703, 9.149632520973654, 1.2206788212060786, -17.20004865527153, -7.469430759549169, 10.85883571207522, -61.7269931882619, 5.932459160685539, -13.057253235019772, -68.29000726342213, 0.033996738493442535, -10.261103868484525, 9.481890097260447, 12.25202021002768, 4.970288500189781, -33.23555325344205, -38.886333949863925, -2.8841299042105675, 4.677688639611006, 0.9179367274045802, 9.803135238587856, -0.7829681336879872, 4.9879190325737, 15.33106227591631, -16.885869994759574, 14.983395338058443, 9.082825157791362, -284.5838982462883, -17.379223957657814, -309.1127537339926, -4.1428383849561214, -67.90641640126708, -4.886727362871184, -13.384754061698942, 6.926395952701554, 3.212163485586629, -0.7547473739832782, -2.5291741192340993, 17.107756477082148, -1.9884814843535565, -278.38300526328385, -20.990820340812206, 4.754557602107511, 4.830195412039757, -18.21631155163051, 24.494207970798, -28.279662184417276, 12.382980160415158, 1.5516259074210836, -23.0362478941679, 17.788370661437483, 20.399301461875424, -298.6212837770581, -3.566657751798658, 18.18766012787819, -12.016568202525406, -17.862573839724092, 19.225885726511464, 6.844063758850069, -1.3080318570137024, 10.30045372620225, 0.24491436034440994, 7.3359775841236115, -27.81700788438323, -25.28244462609294, -11.906611077487469, 4.508238129317746, 6.454475391656146, -27.44388678669931, -10.348485790193095, 12.127841882407665, 5.449715863913269, 6.60662218183279, 11.352895265445085, -10.05099592357874, 8.600302994251237, -3.042637996375589, -26.953518711030497, -269.23291815817356, -4.453641161322622, -7.386824518442182, 3.9701974913477756, 5.032249420881243, 9.88022921979426, 5.478384554386139], "episode_lengths": [300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 126, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 109, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.3010441760222022, 3.3322617361942832, 3.3309068853656356, -2.794717475771904, -2.826547250151634, -2.6143066212534904, 2.4772372096776962, 2.8865868784487247, 2.5211957842111588, -14.260263447960227, -14.856323753794044, -15.172307868798583, -3.2522362818320687, -2.806655054291099, -3.210634698470443, -3.7185720553000863, -3.48113723223409, -4.159904663761466, -98.641183813413, -108.5858753224214, -98.00876929362616, -1.5039636865258217, -1.6648749560117722, -1.9025302231311798, -1.4554176703095436, -1.3596441820263863, -1.5512931942939758, -20.537195811669037, -20.431497255961105, -19.841982527325555, -0.9679452255368233, -1.1640662997961044, -1.161693625152111, -7.530194960534573, -7.400205016136169, -7.837325066328049, -0.8953934932748524, -1.0721354956428257, -1.155186484257385, -0.22532964125275612, -0.1479547843337059, -0.7859849184751511, -11.617846459150314, -11.645304195582867, -11.937530010938644, -3.0528664092222897, -2.8869401911894528, -3.052907238403961, 3.307027528683335, 3.098157020906598, 2.744447971383721, 0.41823579122622334, 0.23467494299013936, 0.5677680869897159, -5.970952615141869, -5.636113874614239, -5.592982165515423, -2.411590879162162, -2.4521832068761285, -2.605656673510879, 3.7139693101247104, 3.744185512264565, 3.400680889685944, -20.815240820248924, -20.41215248902639, -20.49959987898668, 1.9698802009224892, 2.024407498538494, 1.938171461224556, -4.406456326444953, -4.6209973593553, -4.029799549219518, -22.66694037864606, -22.565262379745647, -23.05780450503032, 0.09015515446662903, 0.10839343070983887, -0.16455184668302536, -3.231400830050319, -3.2818240498503144, -3.747878988583892, 3.053098286191613, 3.2739278326431815, 3.1548639784256522, 4.234005724390343, 3.8665969570477756, 4.151417528589562, 1.933293417096138, 1.5317026525735855, 1.5052924305200577, -11.15548039227724, -10.814677219837904, -11.265395641326904, -12.320339600245163, -12.300756084422275, -14.265238265196487, -0.7409456819295883, -0.9697260037064552, -1.173458218574524, 1.2039603888988495, 1.9374207817018032, 1.536307469010353, 0.4008133014043125, 0.3962402840455326, 0.12088314195473515, 3.4346577376127243, 3.425869144499302, 2.94260835647583, 0.10245057692129933, -0.09737257907788432, -0.7880461315314022, 1.6590556502342224, 1.7386194318532944, 1.5902439504861832, 5.1899092371265, 4.630169729391724, 5.510983309398085, -5.568733478585884, -5.468490387002632, -5.848646129171058, 5.006018976370484, 5.079859296480805, 4.897517065207154, 3.1117889819045814, 2.993066233893231, 2.9779699419935497, -91.21108084420364, -101.8862751821677, -91.48654221991698, -5.697412587702274, -6.087962374091148, -5.593848995864391, -101.70890595018864, -102.21108916401863, -105.19275861978531, -1.5349154993891716, -1.3384846858680248, -1.269438199698925, -22.28684414426486, -22.62019817034404, -22.999374086658165, -2.2160700062910763, -1.7003870854775158, -0.9702702711025921, -4.614520420630782, -4.36426439632973, -4.405969244738429, 2.2352346976598056, 2.517005299528435, 2.1741559555133136, 0.827938516934708, 1.1235480879743847, 1.2606768806775364, -0.3563498432437626, -0.2982404927412716, -0.10015703799824394, -0.7968713442484585, -0.6857461581627575, -1.0465566168228833, 5.377618461847305, 5.611540764570236, 6.118597250664607, -0.6483874271313397, -0.8750351319710461, -0.46505892525117076, -88.0775647337238, -102.54203365246455, -87.7634068770955, -7.08631806075573, -6.898443028330803, -7.006059251725674, 1.5956977357466968, 1.3010143836339267, 1.857845482726887, 1.5130667239427567, 1.6164853274822235, 1.7006433606147766, -6.166150319079563, -6.101699406902, -5.948461825648948, 8.311927785476044, 8.451054227848843, 7.731225957473114, -9.270303552349418, -9.38213397314152, -9.627224658926337, 4.107730296750859, 3.97952890147765, 4.29572096218665, 0.5247481266657417, 0.49653583268323587, 0.5303419480721061, -7.584266982972622, -7.6736458614468575, -7.778335049748421, 5.657792712251336, 6.024335535864026, 6.106242413322121, 6.881556262572602, 6.909886983533696, 6.607858215769127, -95.56482119113207, -107.70188564062119, -95.35457694530487, -1.2001382311185296, -1.1824422826369698, -1.1840772380431588, 6.397761479020119, 5.781133323907852, 6.008765324950218, -3.94160167624554, -3.6649955374499257, -4.40997098882994, -6.160514359672874, -5.712736961742252, -5.989322518308967, 6.549872448046997, 6.234166761239365, 6.441846517225102, 2.1923540482918327, 2.414860683182866, 2.2368490273753707, -0.7399500012397766, -0.2848421260714531, -0.2832397297024727, 3.7416793815791607, 3.429773695766926, 3.129000648856163, 0.1940952092409134, 0.06574573367834091, -0.01492658257484436, 2.4685100317001343, 2.547534763813019, 2.3199327886104584, -9.141661768158286, -9.471805860598892, -9.203540255626052, -8.211557575811952, -8.214238406469434, -8.856648643811553, -3.8566278219223022, -4.255923435091972, -3.794059820473194, 1.5516547833879741, 1.6783656527598652, 1.278217693169907, 2.069962372382477, 2.1355210368831905, 2.2489919823904785, -9.018374736110374, -9.224479327599212, -9.201032722989723, -3.547502572337791, -3.371084185938045, -3.429899031917259, 3.9477809220552444, 4.140174321830273, 4.039886638522148, 1.342221061388642, 1.9053901458779876, 2.2021046566466396, 2.2573175877332687, 1.9633026272058487, 2.386001966893673, 3.618777046600968, 3.5558667282263343, 4.178251490617782, -3.1858103275299072, -3.6588957458734512, -3.2062898501753807, 2.7574895521004947, 2.879287992914513, 2.9635254492362293, -0.8361451302965577, -1.0487270702918465, -1.157765795787185, -8.976394156614944, -9.214523727695152, -8.762600826720401, -97.52156815926234, -86.15676499406497, -85.55458500484626, -1.6201955651243622, -1.65626244743666, -1.1771831487615998, -2.303003107508033, -2.546179701884597, -2.537641709049552, 1.5576288526256832, 1.125631300111607, 1.2869373386104854, 1.8634497846166198, 1.700098040203244, 1.4687015960613792, 3.322562893231705, 3.576456700762108, 2.981209625800446, 1.987533576786518, 1.8353150859475136, 1.6555358916521072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16751233870964213, "mean_inference_ms": 0.72238359608884, "mean_action_processing_ms": 0.10093126969310734, "mean_env_wait_ms": 0.8310908219507316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 268632, "timesteps_this_iter": 0, "agent_timesteps_total": 805896, "timers": {"sample_time_ms": 21056.23, "sample_throughput": 455.637, "load_time_ms": 0.2, "load_throughput": 47973477.082, "learn_time_ms": 3142.035, "learn_throughput": 3053.435, "update_time_ms": 10.036}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 83.07176780700684, "policy_loss": -0.0009776742942430583, "vf_loss": 83.15100383758545, "vf_explained_var": 0.07886567711830139, "kl": 0.011988144062352548, "entropy": 7.825846493244171, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268632, "num_agent_steps_sampled": 805896, "num_steps_trained": 268632, "num_agent_steps_trained": 805896, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1676, "training_iteration": 28, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-52-56", "timestamp": 1706190776, "time_this_iter_s": 20.514195919036865, "time_total_s": 578.8117942810059, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B7BC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 578.8117942810059, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.179310344827584, "ram_util_percent": 45.23793103448277}}
{"episode_reward_max": 24.608663003891706, "episode_reward_min": -309.1127537339926, "episode_reward_mean": -15.65740417815513, "episode_len_mean": 289.6, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -107.70188564062119}, "policy_reward_max": {"shared_policy": 8.451054227848843}, "policy_reward_mean": {"shared_policy": -5.219134726051712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.886333949863925, -2.8841299042105675, 4.677688639611006, 0.9179367274045802, 9.803135238587856, -0.7829681336879872, 4.9879190325737, 15.33106227591631, -16.885869994759574, 14.983395338058443, 9.082825157791362, -284.5838982462883, -17.379223957657814, -309.1127537339926, -4.1428383849561214, -67.90641640126708, -4.886727362871184, -13.384754061698942, 6.926395952701554, 3.212163485586629, -0.7547473739832782, -2.5291741192340993, 17.107756477082148, -1.9884814843535565, -278.38300526328385, -20.990820340812206, 4.754557602107511, 4.830195412039757, -18.21631155163051, 24.494207970798, -28.279662184417276, 12.382980160415158, 1.5516259074210836, -23.0362478941679, 17.788370661437483, 20.399301461875424, -298.6212837770581, -3.566657751798658, 18.18766012787819, -12.016568202525406, -17.862573839724092, 19.225885726511464, 6.844063758850069, -1.3080318570137024, 10.30045372620225, 0.24491436034440994, 7.3359775841236115, -27.81700788438323, -25.28244462609294, -11.906611077487469, 4.508238129317746, 6.454475391656146, -27.44388678669931, -10.348485790193095, 12.127841882407665, 5.449715863913269, 6.60662218183279, 11.352895265445085, -10.05099592357874, 8.600302994251237, -3.042637996375589, -26.953518711030497, -269.23291815817356, -4.453641161322622, -7.386824518442182, 3.9701974913477756, 5.032249420881243, 9.88022921979426, 5.478384554386139, -7.401780139654875, -14.088735118508353, -3.6418768614530848, -3.38889891654253, -6.681855879724026, 3.3565994203090668, -8.22403571754694, 0.8966013938188553, -4.67056923545897, 5.766084231436253, -1.053201023489251, 12.557146303355694, 3.9756604544818117, -21.976268857717514, 6.782162725925417, 4.386945001780973, -18.611894011497526, 20.913513418287025, -18.87173630297187, 3.3715232238173343, 6.1227303370833255, -25.09857754409316, -9.165315143764019, 3.304198212921605, -10.649018362164526, 23.18653966486451, 0.16815320402383804, 8.43799563311039, 19.7394943833351, 24.608663003891706, 17.686161911115036], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 126, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 109, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-12.320339600245163, -12.300756084422275, -14.265238265196487, -0.7409456819295883, -0.9697260037064552, -1.173458218574524, 1.2039603888988495, 1.9374207817018032, 1.536307469010353, 0.4008133014043125, 0.3962402840455326, 0.12088314195473515, 3.4346577376127243, 3.425869144499302, 2.94260835647583, 0.10245057692129933, -0.09737257907788432, -0.7880461315314022, 1.6590556502342224, 1.7386194318532944, 1.5902439504861832, 5.1899092371265, 4.630169729391724, 5.510983309398085, -5.568733478585884, -5.468490387002632, -5.848646129171058, 5.006018976370484, 5.079859296480805, 4.897517065207154, 3.1117889819045814, 2.993066233893231, 2.9779699419935497, -91.21108084420364, -101.8862751821677, -91.48654221991698, -5.697412587702274, -6.087962374091148, -5.593848995864391, -101.70890595018864, -102.21108916401863, -105.19275861978531, -1.5349154993891716, -1.3384846858680248, -1.269438199698925, -22.28684414426486, -22.62019817034404, -22.999374086658165, -2.2160700062910763, -1.7003870854775158, -0.9702702711025921, -4.614520420630782, -4.36426439632973, -4.405969244738429, 2.2352346976598056, 2.517005299528435, 2.1741559555133136, 0.827938516934708, 1.1235480879743847, 1.2606768806775364, -0.3563498432437626, -0.2982404927412716, -0.10015703799824394, -0.7968713442484585, -0.6857461581627575, -1.0465566168228833, 5.377618461847305, 5.611540764570236, 6.118597250664607, -0.6483874271313397, -0.8750351319710461, -0.46505892525117076, -88.0775647337238, -102.54203365246455, -87.7634068770955, -7.08631806075573, -6.898443028330803, -7.006059251725674, 1.5956977357466968, 1.3010143836339267, 1.857845482726887, 1.5130667239427567, 1.6164853274822235, 1.7006433606147766, -6.166150319079563, -6.101699406902, -5.948461825648948, 8.311927785476044, 8.451054227848843, 7.731225957473114, -9.270303552349418, -9.38213397314152, -9.627224658926337, 4.107730296750859, 3.97952890147765, 4.29572096218665, 0.5247481266657417, 0.49653583268323587, 0.5303419480721061, -7.584266982972622, -7.6736458614468575, -7.778335049748421, 5.657792712251336, 6.024335535864026, 6.106242413322121, 6.881556262572602, 6.909886983533696, 6.607858215769127, -95.56482119113207, -107.70188564062119, -95.35457694530487, -1.2001382311185296, -1.1824422826369698, -1.1840772380431588, 6.397761479020119, 5.781133323907852, 6.008765324950218, -3.94160167624554, -3.6649955374499257, -4.40997098882994, -6.160514359672874, -5.712736961742252, -5.989322518308967, 6.549872448046997, 6.234166761239365, 6.441846517225102, 2.1923540482918327, 2.414860683182866, 2.2368490273753707, -0.7399500012397766, -0.2848421260714531, -0.2832397297024727, 3.7416793815791607, 3.429773695766926, 3.129000648856163, 0.1940952092409134, 0.06574573367834091, -0.01492658257484436, 2.4685100317001343, 2.547534763813019, 2.3199327886104584, -9.141661768158286, -9.471805860598892, -9.203540255626052, -8.211557575811952, -8.214238406469434, -8.856648643811553, -3.8566278219223022, -4.255923435091972, -3.794059820473194, 1.5516547833879741, 1.6783656527598652, 1.278217693169907, 2.069962372382477, 2.1355210368831905, 2.2489919823904785, -9.018374736110374, -9.224479327599212, -9.201032722989723, -3.547502572337791, -3.371084185938045, -3.429899031917259, 3.9477809220552444, 4.140174321830273, 4.039886638522148, 1.342221061388642, 1.9053901458779876, 2.2021046566466396, 2.2573175877332687, 1.9633026272058487, 2.386001966893673, 3.618777046600968, 3.5558667282263343, 4.178251490617782, -3.1858103275299072, -3.6588957458734512, -3.2062898501753807, 2.7574895521004947, 2.879287992914513, 2.9635254492362293, -0.8361451302965577, -1.0487270702918465, -1.157765795787185, -8.976394156614944, -9.214523727695152, -8.762600826720401, -97.52156815926234, -86.15676499406497, -85.55458500484626, -1.6201955651243622, -1.65626244743666, -1.1771831487615998, -2.303003107508033, -2.546179701884597, -2.537641709049552, 1.5576288526256832, 1.125631300111607, 1.2869373386104854, 1.8634497846166198, 1.700098040203244, 1.4687015960613792, 3.322562893231705, 3.576456700762108, 2.981209625800446, 1.987533576786518, 1.8353150859475136, 1.6555358916521072, -2.52331705391407, -2.205538149923086, -2.6729249358177185, -4.533933321634933, -4.204339231053993, -5.350462565819427, -1.4234493871529992, -1.1315630575021203, -1.0868644167979653, -1.0936829894781113, -1.630676731467247, -0.6645391955971718, -2.4514253437519073, -2.0503100380301476, -2.180120497941971, 1.1099237650632858, 0.9551564306020737, 1.2915192246437073, -2.9446995109319687, -2.724086180329323, -2.5552500262856483, 0.39015497267246246, 0.10333861410617828, 0.40310780704021454, -1.5129470825195312, -1.2233299110084772, -1.9342922419309616, 1.8777363002300262, 2.018686980009079, 1.8696609511971474, -0.46678345898787654, -0.39902717123429454, -0.18739039326707996, 4.1826374009251595, 3.948250889778137, 4.426258012652397, 1.476922279844672, 1.3513130719462936, 1.1474251026908462, -7.318603076040745, -7.284836895763874, -7.372828885912895, 2.2526021103064124, 2.263553681472928, 2.266006934146077, 1.5775316481788906, 1.4564252545436176, 1.3529880990584644, -6.472420488794654, -5.683430676658958, -6.456042846043914, 6.852737126251057, 7.197890506436423, 6.862885785599545, -6.251143080492824, -6.335358855625003, -6.285234366854041, 1.0423524727423938, 1.169712064166859, 1.1594586869080814, 1.8969703217347416, 2.0502346505721363, 2.1755253647764476, -8.32998323937258, -8.287736063202232, -8.480858241518348, -2.8899651765823364, -3.3605675399303436, -2.914782427251339, 1.054961313803986, 0.9229870190223011, 1.3262498800953182, -3.5318262254198487, -3.5350088899334366, -3.5821832468112405, 7.82520034412542, 7.887021164099366, 7.474318156639725, 0.0730951651930809, 0.09890423715114594, -0.003846198320388794, 3.071291062360004, 2.6590087612469944, 2.7076958095033916, 7.11528482039769, 6.384367962678269, 6.23984160025914, 8.04256409406662, 8.388310093432665, 8.177788816392422, 5.788866405685738, 5.58785257240136, 6.309442933027938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1671314849928546, "mean_inference_ms": 0.7224518655824869, "mean_action_processing_ms": 0.10104858688510493, "mean_env_wait_ms": 0.8324702654603022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 278226, "timesteps_this_iter": 0, "agent_timesteps_total": 834678, "timers": {"sample_time_ms": 21088.934, "sample_throughput": 454.931, "load_time_ms": 0.2, "load_throughput": 47973477.082, "learn_time_ms": 3161.756, "learn_throughput": 3034.389, "update_time_ms": 10.232}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 9.120064616203308, "policy_loss": -0.0019577496520124527, "vf_loss": 9.200369119644165, "vf_explained_var": -1.0, "kl": 0.007192642400706058, "entropy": 7.834932446479797, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 278226, "num_agent_steps_sampled": 834678, "num_steps_trained": 278226, "num_agent_steps_trained": 834678, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1707, "training_iteration": 29, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-53-18", "timestamp": 1706190798, "time_this_iter_s": 21.441614627838135, "time_total_s": 600.253408908844, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 600.253408908844, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.903333333333334, "ram_util_percent": 45.39666666666667}}
{"episode_reward_max": 27.649649191647754, "episode_reward_min": -298.6212837770581, "episode_reward_mean": -3.353670021577575, "episode_len_mean": 296.35, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -107.70188564062119}, "policy_reward_max": {"shared_policy": 9.375271224727229}, "policy_reward_mean": {"shared_policy": -1.1178900071925262}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0362478941679, 17.788370661437483, 20.399301461875424, -298.6212837770581, -3.566657751798658, 18.18766012787819, -12.016568202525406, -17.862573839724092, 19.225885726511464, 6.844063758850069, -1.3080318570137024, 10.30045372620225, 0.24491436034440994, 7.3359775841236115, -27.81700788438323, -25.28244462609294, -11.906611077487469, 4.508238129317746, 6.454475391656146, -27.44388678669931, -10.348485790193095, 12.127841882407665, 5.449715863913269, 6.60662218183279, 11.352895265445085, -10.05099592357874, 8.600302994251237, -3.042637996375589, -26.953518711030497, -269.23291815817356, -4.453641161322622, -7.386824518442182, 3.9701974913477756, 5.032249420881243, 9.88022921979426, 5.478384554386139, -7.401780139654875, -14.088735118508353, -3.6418768614530848, -3.38889891654253, -6.681855879724026, 3.3565994203090668, -8.22403571754694, 0.8966013938188553, -4.67056923545897, 5.766084231436253, -1.053201023489251, 12.557146303355694, 3.9756604544818117, -21.976268857717514, 6.782162725925417, 4.386945001780973, -18.611894011497526, 20.913513418287025, -18.87173630297187, 3.3715232238173343, 6.1227303370833255, -25.09857754409316, -9.165315143764019, 3.304198212921605, -10.649018362164526, 23.18653966486451, 0.16815320402383804, 8.43799563311039, 19.7394943833351, 24.608663003891706, 17.686161911115036, 3.9913692474365092, 13.955552585422993, 1.9956281781196452, 9.494961142539964, 27.649649191647754, 2.024981789290891, 16.293285176157923, 15.135462097823606, 5.395452059805393, 5.502606563270064, -17.854116234928398, 8.30121654272078, 5.057178910821662, 15.995227925479412, 2.08499269187449, -3.621186498552561, 15.696667522191973, -0.8072607815265656, 17.188505843281717, -1.0356876328587674, 12.450791008770466, 16.62660294026135, 21.993855062872157, 10.862320832646205, -4.328422464430346, 3.3998167291283323, 12.482942022383199, 6.850193742662654, 5.749969951808438, 13.550069810822592, -1.305104445666089, 3.840607419609995, 8.821015655994401], "episode_lengths": [300, 300, 300, 126, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 109, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-7.584266982972622, -7.6736458614468575, -7.778335049748421, 5.657792712251336, 6.024335535864026, 6.106242413322121, 6.881556262572602, 6.909886983533696, 6.607858215769127, -95.56482119113207, -107.70188564062119, -95.35457694530487, -1.2001382311185296, -1.1824422826369698, -1.1840772380431588, 6.397761479020119, 5.781133323907852, 6.008765324950218, -3.94160167624554, -3.6649955374499257, -4.40997098882994, -6.160514359672874, -5.712736961742252, -5.989322518308967, 6.549872448046997, 6.234166761239365, 6.441846517225102, 2.1923540482918327, 2.414860683182866, 2.2368490273753707, -0.7399500012397766, -0.2848421260714531, -0.2832397297024727, 3.7416793815791607, 3.429773695766926, 3.129000648856163, 0.1940952092409134, 0.06574573367834091, -0.01492658257484436, 2.4685100317001343, 2.547534763813019, 2.3199327886104584, -9.141661768158286, -9.471805860598892, -9.203540255626052, -8.211557575811952, -8.214238406469434, -8.856648643811553, -3.8566278219223022, -4.255923435091972, -3.794059820473194, 1.5516547833879741, 1.6783656527598652, 1.278217693169907, 2.069962372382477, 2.1355210368831905, 2.2489919823904785, -9.018374736110374, -9.224479327599212, -9.201032722989723, -3.547502572337791, -3.371084185938045, -3.429899031917259, 3.9477809220552444, 4.140174321830273, 4.039886638522148, 1.342221061388642, 1.9053901458779876, 2.2021046566466396, 2.2573175877332687, 1.9633026272058487, 2.386001966893673, 3.618777046600968, 3.5558667282263343, 4.178251490617782, -3.1858103275299072, -3.6588957458734512, -3.2062898501753807, 2.7574895521004947, 2.879287992914513, 2.9635254492362293, -0.8361451302965577, -1.0487270702918465, -1.157765795787185, -8.976394156614944, -9.214523727695152, -8.762600826720401, -97.52156815926234, -86.15676499406497, -85.55458500484626, -1.6201955651243622, -1.65626244743666, -1.1771831487615998, -2.303003107508033, -2.546179701884597, -2.537641709049552, 1.5576288526256832, 1.125631300111607, 1.2869373386104854, 1.8634497846166198, 1.700098040203244, 1.4687015960613792, 3.322562893231705, 3.576456700762108, 2.981209625800446, 1.987533576786518, 1.8353150859475136, 1.6555358916521072, -2.52331705391407, -2.205538149923086, -2.6729249358177185, -4.533933321634933, -4.204339231053993, -5.350462565819427, -1.4234493871529992, -1.1315630575021203, -1.0868644167979653, -1.0936829894781113, -1.630676731467247, -0.6645391955971718, -2.4514253437519073, -2.0503100380301476, -2.180120497941971, 1.1099237650632858, 0.9551564306020737, 1.2915192246437073, -2.9446995109319687, -2.724086180329323, -2.5552500262856483, 0.39015497267246246, 0.10333861410617828, 0.40310780704021454, -1.5129470825195312, -1.2233299110084772, -1.9342922419309616, 1.8777363002300262, 2.018686980009079, 1.8696609511971474, -0.46678345898787654, -0.39902717123429454, -0.18739039326707996, 4.1826374009251595, 3.948250889778137, 4.426258012652397, 1.476922279844672, 1.3513130719462936, 1.1474251026908462, -7.318603076040745, -7.284836895763874, -7.372828885912895, 2.2526021103064124, 2.263553681472928, 2.266006934146077, 1.5775316481788906, 1.4564252545436176, 1.3529880990584644, -6.472420488794654, -5.683430676658958, -6.456042846043914, 6.852737126251057, 7.197890506436423, 6.862885785599545, -6.251143080492824, -6.335358855625003, -6.285234366854041, 1.0423524727423938, 1.169712064166859, 1.1594586869080814, 1.8969703217347416, 2.0502346505721363, 2.1755253647764476, -8.32998323937258, -8.287736063202232, -8.480858241518348, -2.8899651765823364, -3.3605675399303436, -2.914782427251339, 1.054961313803986, 0.9229870190223011, 1.3262498800953182, -3.5318262254198487, -3.5350088899334366, -3.5821832468112405, 7.82520034412542, 7.887021164099366, 7.474318156639725, 0.0730951651930809, 0.09890423715114594, -0.003846198320388794, 3.071291062360004, 2.6590087612469944, 2.7076958095033916, 7.11528482039769, 6.384367962678269, 6.23984160025914, 8.04256409406662, 8.388310093432665, 8.177788816392422, 5.788866405685738, 5.58785257240136, 6.309442933027938, 1.7679474552472385, 1.2806513210137638, 0.9427704711755069, 4.5776721984148026, 4.623396150767803, 4.754484236240387, 0.7067460690935405, 0.6355838601787838, 0.6532982488473209, 3.0297455986340793, 3.1873690386613163, 3.277846505244568, 9.210455385347203, 9.375271224727229, 9.063922581573323, 0.7249594976504596, 0.7201986139019283, 0.5798236777385029, 5.660441475609929, 5.603282781938702, 5.029560918609292, 4.997347642978028, 5.070834135015801, 5.067280319829777, 1.8129497319459915, 1.9904582127928734, 1.5920441150665283, 1.757276023427636, 1.7706558505693977, 1.97467468927303, -5.970543396969646, -6.1106632252534325, -5.77290961270532, 3.1239339311917576, 2.927229662736252, 2.2500529487927707, 2.0176861894627365, 1.705745821197823, 1.3337469001611026, 5.522370986640453, 5.479021906852722, 4.993835031986237, 0.7718950559695514, 0.659019877513245, 0.6540777583916935, -1.2162253558635712, -0.9551606066524982, -1.4498005360364914, 5.224638971189648, 4.986051971713692, 5.485976579288632, -0.304079994559288, 0.018233761191368103, -0.5214145481586456, 5.835674236218125, 5.428600961963326, 5.924230645100266, -0.30548252413670696, -0.3321225593487469, -0.39808254937331355, 4.322486981749535, 4.0598131492733955, 4.068490877747536, 5.631852140029267, 5.394465280075863, 5.60028552015622, 6.88476402064164, 7.609201872100428, 7.499889170130089, 3.455452730258301, 3.259200488527611, 4.147667613860293, -1.4742931822935788, -1.6324156622091976, -1.22171361992757, 1.0729205409685676, 1.3391791457931106, 0.9877170423666541, 4.211992253859833, 4.363879976173237, 3.9070697923501285, 2.0610038389762195, 2.2895956610639843, 2.4995942426224502, 2.1310730104645046, 2.1237048705418857, 1.495192070802048, 4.4381768268843445, 4.410647695263222, 4.701245288675025, -0.2849932784835545, -0.02803592259685672, -0.9920752445856778, 1.5419282938043182, 1.530670913557202, 0.7680082122484748, 3.0017603312929424, 2.8754678865273746, 2.943787438174084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16679569839085212, "mean_inference_ms": 0.7233946850741411, "mean_action_processing_ms": 0.1011849738900217, "mean_env_wait_ms": 0.8343045963089224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 287820, "timesteps_this_iter": 0, "agent_timesteps_total": 863460, "timers": {"sample_time_ms": 21238.124, "sample_throughput": 451.735, "load_time_ms": 0.2, "load_throughput": 47973477.082, "learn_time_ms": 3170.659, "learn_throughput": 3025.869, "update_time_ms": 10.281}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 8.530050873756409, "policy_loss": -0.0037927066906708884, "vf_loss": 8.611876487731934, "vf_explained_var": -1.0, "kl": 0.007353474989951599, "entropy": 7.803514182567596, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 287820, "num_agent_steps_sampled": 863460, "num_steps_trained": 287820, "num_agent_steps_trained": 863460, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1740, "training_iteration": 30, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-53-40", "timestamp": 1706190820, "time_this_iter_s": 22.104997873306274, "time_total_s": 622.3584067821503, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 622.3584067821503, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.428125000000001, "ram_util_percent": 45.625}}
{"episode_reward_max": 44.39242588728665, "episode_reward_min": -39.87283122539523, "episode_reward_mean": 5.996289017002262, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -13.408620794614166}, "policy_reward_max": {"shared_policy": 14.94362650563319}, "policy_reward_mean": {"shared_policy": 1.9987630056674197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9701974913477756, 5.032249420881243, 9.88022921979426, 5.478384554386139, -7.401780139654875, -14.088735118508353, -3.6418768614530848, -3.38889891654253, -6.681855879724026, 3.3565994203090668, -8.22403571754694, 0.8966013938188553, -4.67056923545897, 5.766084231436253, -1.053201023489251, 12.557146303355694, 3.9756604544818117, -21.976268857717514, 6.782162725925417, 4.386945001780973, -18.611894011497526, 20.913513418287025, -18.87173630297187, 3.3715232238173343, 6.1227303370833255, -25.09857754409316, -9.165315143764019, 3.304198212921605, -10.649018362164526, 23.18653966486451, 0.16815320402383804, 8.43799563311039, 19.7394943833351, 24.608663003891706, 17.686161911115036, 3.9913692474365092, 13.955552585422993, 1.9956281781196452, 9.494961142539964, 27.649649191647754, 2.024981789290891, 16.293285176157923, 15.135462097823606, 5.395452059805393, 5.502606563270064, -17.854116234928398, 8.30121654272078, 5.057178910821662, 15.995227925479412, 2.08499269187449, -3.621186498552561, 15.696667522191973, -0.8072607815265656, 17.188505843281717, -1.0356876328587674, 12.450791008770466, 16.62660294026135, 21.993855062872157, 10.862320832646205, -4.328422464430346, 3.3998167291283323, 12.482942022383199, 6.850193742662654, 5.749969951808438, 13.550069810822592, -1.305104445666089, 3.840607419609995, 8.821015655994401, -11.373315937817097, 25.54025145061314, -15.528766132891207, 13.70922619663176, -0.7505146339535713, 5.218718230724306, 0.7853948473930075, 14.933933824300766, 24.202302485704422, 13.080764766782494, -8.89035870507361, 23.590088427066803, 17.362625741399825, 12.746139168739319, -39.87283122539523, 25.495871689170585, 22.67548928409815, 19.44550408422947, -1.1486222147941731, 9.6132125928998, 7.319833487272234, 44.39242588728665, 17.40585875511168, 28.03521938156335, -14.674673184752479, 32.218232985585914, 17.498803712427602, 5.251307424157858, -1.2317826598882817, 3.669195479713352, 8.645431252196403, 10.727320557460175], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [1.5576288526256832, 1.125631300111607, 1.2869373386104854, 1.8634497846166198, 1.700098040203244, 1.4687015960613792, 3.322562893231705, 3.576456700762108, 2.981209625800446, 1.987533576786518, 1.8353150859475136, 1.6555358916521072, -2.52331705391407, -2.205538149923086, -2.6729249358177185, -4.533933321634933, -4.204339231053993, -5.350462565819427, -1.4234493871529992, -1.1315630575021203, -1.0868644167979653, -1.0936829894781113, -1.630676731467247, -0.6645391955971718, -2.4514253437519073, -2.0503100380301476, -2.180120497941971, 1.1099237650632858, 0.9551564306020737, 1.2915192246437073, -2.9446995109319687, -2.724086180329323, -2.5552500262856483, 0.39015497267246246, 0.10333861410617828, 0.40310780704021454, -1.5129470825195312, -1.2233299110084772, -1.9342922419309616, 1.8777363002300262, 2.018686980009079, 1.8696609511971474, -0.46678345898787654, -0.39902717123429454, -0.18739039326707996, 4.1826374009251595, 3.948250889778137, 4.426258012652397, 1.476922279844672, 1.3513130719462936, 1.1474251026908462, -7.318603076040745, -7.284836895763874, -7.372828885912895, 2.2526021103064124, 2.263553681472928, 2.266006934146077, 1.5775316481788906, 1.4564252545436176, 1.3529880990584644, -6.472420488794654, -5.683430676658958, -6.456042846043914, 6.852737126251057, 7.197890506436423, 6.862885785599545, -6.251143080492824, -6.335358855625003, -6.285234366854041, 1.0423524727423938, 1.169712064166859, 1.1594586869080814, 1.8969703217347416, 2.0502346505721363, 2.1755253647764476, -8.32998323937258, -8.287736063202232, -8.480858241518348, -2.8899651765823364, -3.3605675399303436, -2.914782427251339, 1.054961313803986, 0.9229870190223011, 1.3262498800953182, -3.5318262254198487, -3.5350088899334366, -3.5821832468112405, 7.82520034412542, 7.887021164099366, 7.474318156639725, 0.0730951651930809, 0.09890423715114594, -0.003846198320388794, 3.071291062360004, 2.6590087612469944, 2.7076958095033916, 7.11528482039769, 6.384367962678269, 6.23984160025914, 8.04256409406662, 8.388310093432665, 8.177788816392422, 5.788866405685738, 5.58785257240136, 6.309442933027938, 1.7679474552472385, 1.2806513210137638, 0.9427704711755069, 4.5776721984148026, 4.623396150767803, 4.754484236240387, 0.7067460690935405, 0.6355838601787838, 0.6532982488473209, 3.0297455986340793, 3.1873690386613163, 3.277846505244568, 9.210455385347203, 9.375271224727229, 9.063922581573323, 0.7249594976504596, 0.7201986139019283, 0.5798236777385029, 5.660441475609929, 5.603282781938702, 5.029560918609292, 4.997347642978028, 5.070834135015801, 5.067280319829777, 1.8129497319459915, 1.9904582127928734, 1.5920441150665283, 1.757276023427636, 1.7706558505693977, 1.97467468927303, -5.970543396969646, -6.1106632252534325, -5.77290961270532, 3.1239339311917576, 2.927229662736252, 2.2500529487927707, 2.0176861894627365, 1.705745821197823, 1.3337469001611026, 5.522370986640453, 5.479021906852722, 4.993835031986237, 0.7718950559695514, 0.659019877513245, 0.6540777583916935, -1.2162253558635712, -0.9551606066524982, -1.4498005360364914, 5.224638971189648, 4.986051971713692, 5.485976579288632, -0.304079994559288, 0.018233761191368103, -0.5214145481586456, 5.835674236218125, 5.428600961963326, 5.924230645100266, -0.30548252413670696, -0.3321225593487469, -0.39808254937331355, 4.322486981749535, 4.0598131492733955, 4.068490877747536, 5.631852140029267, 5.394465280075863, 5.60028552015622, 6.88476402064164, 7.609201872100428, 7.499889170130089, 3.455452730258301, 3.259200488527611, 4.147667613860293, -1.4742931822935788, -1.6324156622091976, -1.22171361992757, 1.0729205409685676, 1.3391791457931106, 0.9877170423666541, 4.211992253859833, 4.363879976173237, 3.9070697923501285, 2.0610038389762195, 2.2895956610639843, 2.4995942426224502, 2.1310730104645046, 2.1237048705418857, 1.495192070802048, 4.4381768268843445, 4.410647695263222, 4.701245288675025, -0.2849932784835545, -0.02803592259685672, -0.9920752445856778, 1.5419282938043182, 1.530670913557202, 0.7680082122484748, 3.0017603312929424, 2.8754678865273746, 2.943787438174084, -4.18171226978302, -3.4960025921463966, -3.69560107588768, 8.46580521762371, 8.018163457512856, 9.056282775476575, -4.712755305071681, -5.150754188497871, -5.665256639321655, 4.409230957428605, 4.312056089440972, 4.987939149762184, -0.15814898908138275, -0.08949974924325943, -0.5028658956289291, 1.9650530541936462, 1.921537118653447, 1.3321280578772132, 0.28629233936467813, 0.2911175961295669, 0.20798491189876245, 5.180889114737511, 4.82989963889122, 4.923145070672035, 8.110708512365818, 8.027970410883427, 8.063623562455177, 4.219065333406121, 4.343283797303826, 4.518415636072547, -2.610545708487436, -2.892376268903419, -3.387436727682754, 7.6727656200528145, 8.089020505547523, 7.828302301466465, 5.595148108899593, 5.744747310876846, 6.022730321623385, 4.2274633049964905, 4.211587831377983, 4.307088032364845, -13.251593475540488, -13.212616955240577, -13.408620794614166, 8.583763984342411, 7.9111731400092395, 9.000934564818934, 7.728616379201412, 7.661386549472809, 7.285486355423927, 6.428070038557053, 6.371331632137299, 6.646102413535118, -0.325886989633247, -0.4380277271072117, -0.3847074980537144, 3.37152511626482, 3.2622836977243423, 2.979403778910637, 2.608299354712159, 2.34179104367891, 2.3697430888811652, 14.94362650563319, 14.600813632210091, 14.847985749443367, 6.031304699679211, 5.451773693164185, 5.922780362268284, 9.067527775963143, 9.105022226770714, 9.862669378829494, -4.965962814788028, -4.944133582214519, -4.764576787749931, 10.611436178286866, 10.48003103335698, 11.126765773942068, 5.827043694754437, 5.886845668156937, 5.784914349516228, 2.119117271155119, 1.6291740387678146, 1.5030161142349243, -0.17735792944829143, -0.6343190620342938, -0.4201056684056965, 1.0828624392549102, 1.1211948196093147, 1.465138220849127, 3.224490322793514, 3.028604267785937, 2.3923366616169517, 3.6776906599601062, 3.285944347580269, 3.763685549919799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1665141307139136, "mean_inference_ms": 0.7242042438708154, "mean_action_processing_ms": 0.1013781546008239, "mean_env_wait_ms": 0.8362995831714554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 297414, "timesteps_this_iter": 0, "agent_timesteps_total": 892242, "timers": {"sample_time_ms": 21348.973, "sample_throughput": 449.389, "load_time_ms": 0.2, "load_throughput": 47973477.082, "learn_time_ms": 3183.913, "learn_throughput": 3013.273, "update_time_ms": 10.681}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 8.378523588180542, "policy_loss": -0.0010746983434791746, "vf_loss": 8.460153460502625, "vf_explained_var": -1.0, "kl": 0.01085765463359399, "entropy": 8.055864334106445, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 297414, "num_agent_steps_sampled": 892242, "num_steps_trained": 297414, "num_agent_steps_trained": 892242, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1772, "training_iteration": 31, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-54-02", "timestamp": 1706190842, "time_this_iter_s": 21.86236310005188, "time_total_s": 644.2207698822021, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA035428B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 644.2207698822021, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 7.1645161290322585, "ram_util_percent": 45.632258064516144}}
{"episode_reward_max": 44.39242588728665, "episode_reward_min": -327.74848815146834, "episode_reward_mean": 2.6078794744724174, "episode_len_mean": 295.6, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -115.52802267515412}, "policy_reward_max": {"shared_policy": 14.94362650563319}, "policy_reward_mean": {"shared_policy": 0.869293158157472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.608663003891706, 17.686161911115036, 3.9913692474365092, 13.955552585422993, 1.9956281781196452, 9.494961142539964, 27.649649191647754, 2.024981789290891, 16.293285176157923, 15.135462097823606, 5.395452059805393, 5.502606563270064, -17.854116234928398, 8.30121654272078, 5.057178910821662, 15.995227925479412, 2.08499269187449, -3.621186498552561, 15.696667522191973, -0.8072607815265656, 17.188505843281717, -1.0356876328587674, 12.450791008770466, 16.62660294026135, 21.993855062872157, 10.862320832646205, -4.328422464430346, 3.3998167291283323, 12.482942022383199, 6.850193742662654, 5.749969951808438, 13.550069810822592, -1.305104445666089, 3.840607419609995, 8.821015655994401, -11.373315937817097, 25.54025145061314, -15.528766132891207, 13.70922619663176, -0.7505146339535713, 5.218718230724306, 0.7853948473930075, 14.933933824300766, 24.202302485704422, 13.080764766782494, -8.89035870507361, 23.590088427066803, 17.362625741399825, 12.746139168739319, -39.87283122539523, 25.495871689170585, 22.67548928409815, 19.44550408422947, -1.1486222147941731, 9.6132125928998, 7.319833487272234, 44.39242588728665, 17.40585875511168, 28.03521938156335, -14.674673184752479, 32.218232985585914, 17.498803712427602, 5.251307424157858, -1.2317826598882817, 3.669195479713352, 8.645431252196403, 10.727320557460175, 0.012142613530158997, -26.97522404044868, 23.575677253771573, 26.432841159403296, 12.753846526145907, 10.581924369558678, -10.168962553143501, -19.199292052537203, -322.8899639174342, 14.162503803148851, -5.83689309284091, 17.14694755151865, 27.671916484832735, 9.26037229038775, 20.92334362864493, 19.635081119835377, 5.128744311630726, 32.63912524282932, 14.719086872413726, 17.757399935275288, -16.82546436786653, 16.642031107097864, 27.559489456936703, 12.243741400539875, 7.002075962722287, 8.082461997866616, -12.306113827042296, -327.74848815146834, 8.960226558148861, 23.65152047201991, 13.82229720056057, 13.268897321075187, 13.278398290276527], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [8.04256409406662, 8.388310093432665, 8.177788816392422, 5.788866405685738, 5.58785257240136, 6.309442933027938, 1.7679474552472385, 1.2806513210137638, 0.9427704711755069, 4.5776721984148026, 4.623396150767803, 4.754484236240387, 0.7067460690935405, 0.6355838601787838, 0.6532982488473209, 3.0297455986340793, 3.1873690386613163, 3.277846505244568, 9.210455385347203, 9.375271224727229, 9.063922581573323, 0.7249594976504596, 0.7201986139019283, 0.5798236777385029, 5.660441475609929, 5.603282781938702, 5.029560918609292, 4.997347642978028, 5.070834135015801, 5.067280319829777, 1.8129497319459915, 1.9904582127928734, 1.5920441150665283, 1.757276023427636, 1.7706558505693977, 1.97467468927303, -5.970543396969646, -6.1106632252534325, -5.77290961270532, 3.1239339311917576, 2.927229662736252, 2.2500529487927707, 2.0176861894627365, 1.705745821197823, 1.3337469001611026, 5.522370986640453, 5.479021906852722, 4.993835031986237, 0.7718950559695514, 0.659019877513245, 0.6540777583916935, -1.2162253558635712, -0.9551606066524982, -1.4498005360364914, 5.224638971189648, 4.986051971713692, 5.485976579288632, -0.304079994559288, 0.018233761191368103, -0.5214145481586456, 5.835674236218125, 5.428600961963326, 5.924230645100266, -0.30548252413670696, -0.3321225593487469, -0.39808254937331355, 4.322486981749535, 4.0598131492733955, 4.068490877747536, 5.631852140029267, 5.394465280075863, 5.60028552015622, 6.88476402064164, 7.609201872100428, 7.499889170130089, 3.455452730258301, 3.259200488527611, 4.147667613860293, -1.4742931822935788, -1.6324156622091976, -1.22171361992757, 1.0729205409685676, 1.3391791457931106, 0.9877170423666541, 4.211992253859833, 4.363879976173237, 3.9070697923501285, 2.0610038389762195, 2.2895956610639843, 2.4995942426224502, 2.1310730104645046, 2.1237048705418857, 1.495192070802048, 4.4381768268843445, 4.410647695263222, 4.701245288675025, -0.2849932784835545, -0.02803592259685672, -0.9920752445856778, 1.5419282938043182, 1.530670913557202, 0.7680082122484748, 3.0017603312929424, 2.8754678865273746, 2.943787438174084, -4.18171226978302, -3.4960025921463966, -3.69560107588768, 8.46580521762371, 8.018163457512856, 9.056282775476575, -4.712755305071681, -5.150754188497871, -5.665256639321655, 4.409230957428605, 4.312056089440972, 4.987939149762184, -0.15814898908138275, -0.08949974924325943, -0.5028658956289291, 1.9650530541936462, 1.921537118653447, 1.3321280578772132, 0.28629233936467813, 0.2911175961295669, 0.20798491189876245, 5.180889114737511, 4.82989963889122, 4.923145070672035, 8.110708512365818, 8.027970410883427, 8.063623562455177, 4.219065333406121, 4.343283797303826, 4.518415636072547, -2.610545708487436, -2.892376268903419, -3.387436727682754, 7.6727656200528145, 8.089020505547523, 7.828302301466465, 5.595148108899593, 5.744747310876846, 6.022730321623385, 4.2274633049964905, 4.211587831377983, 4.307088032364845, -13.251593475540488, -13.212616955240577, -13.408620794614166, 8.583763984342411, 7.9111731400092395, 9.000934564818934, 7.728616379201412, 7.661386549472809, 7.285486355423927, 6.428070038557053, 6.371331632137299, 6.646102413535118, -0.325886989633247, -0.4380277271072117, -0.3847074980537144, 3.37152511626482, 3.2622836977243423, 2.979403778910637, 2.608299354712159, 2.34179104367891, 2.3697430888811652, 14.94362650563319, 14.600813632210091, 14.847985749443367, 6.031304699679211, 5.451773693164185, 5.922780362268284, 9.067527775963143, 9.105022226770714, 9.862669378829494, -4.965962814788028, -4.944133582214519, -4.764576787749931, 10.611436178286866, 10.48003103335698, 11.126765773942068, 5.827043694754437, 5.886845668156937, 5.784914349516228, 2.119117271155119, 1.6291740387678146, 1.5030161142349243, -0.17735792944829143, -0.6343190620342938, -0.4201056684056965, 1.0828624392549102, 1.1211948196093147, 1.465138220849127, 3.224490322793514, 3.028604267785937, 2.3923366616169517, 3.6776906599601062, 3.285944347580269, 3.763685549919799, 0.10917636007070541, -0.01738177239894867, -0.07965197414159775, -9.191696862379715, -8.915047230819866, -8.8684799472491, 7.693918876349926, 7.674672946333885, 8.207085431087762, 8.911806332568318, 8.827179099122674, 8.693855727712304, 4.261918375889451, 4.018765139083058, 4.473163011173398, 3.257429545124367, 3.5661792208750995, 3.758315603559211, -3.145403154194355, -3.483198992908001, -3.5403604060411453, -6.282488606870174, -6.122036200016737, -6.794767245650291, -103.75070424377918, -113.46671817451715, -105.67254149913788, 4.892503372703985, 4.617122230430439, 4.6528782000144275, -1.9057674445211887, -2.1137620434165, -1.8173636049032211, 5.573391715685517, 5.78333508844176, 5.790220747391373, 9.39781757692495, 9.248900140325219, 9.025198767582566, 2.527922138571739, 3.635743947699666, 3.0967062041163445, 7.281669115026787, 6.9018018593390735, 6.739872654279068, 6.551966771483421, 6.8562532141804695, 6.226861134171486, 1.8803383819758892, 1.8771681599318981, 1.3712377697229385, 10.417167082428932, 11.104060359299183, 11.117897801101208, 4.707844162980706, 5.323979434246809, 4.687263275186211, 5.869708153108746, 6.4325097563366, 5.4551820258299415, -5.6358407313625065, -5.708764443794891, -5.480859192709133, 5.442678213119507, 5.701803725212812, 5.497549168765545, 9.403187054519847, 8.993701850374535, 9.16260055204232, 4.074211053550243, 4.15720146894455, 4.012328878045082, 2.3384638180335315, 2.3138102938731464, 2.3498018508156093, 2.6479117472966465, 2.691863206525639, 2.742687044044331, -4.364224458734199, -3.7786040880406944, -4.163285280267402, -105.7890439828237, -115.52802267515412, -106.43142149349055, 2.9596937224268913, 2.993794731795788, 3.006738103926182, 8.013427931815386, 7.791245266795158, 7.846847273409367, 4.2887531369924545, 4.695699155330658, 4.837844908237457, 4.7921350387235435, 4.1903780748446735, 4.28638420750697, 4.036170318722725, 4.517348296940327, 4.724879674613476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1664552715916506, "mean_inference_ms": 0.7254309612108508, "mean_action_processing_ms": 0.10144756435443329, "mean_env_wait_ms": 0.8381597394460834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 307008, "timesteps_this_iter": 0, "agent_timesteps_total": 921024, "timers": {"sample_time_ms": 21300.312, "sample_throughput": 450.416, "load_time_ms": 0.1, "load_throughput": 95946954.163, "learn_time_ms": 3160.826, "learn_throughput": 3035.282, "update_time_ms": 10.122}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 91.95809173583984, "policy_loss": -0.00010444344545845752, "vf_loss": 92.04090881347656, "vf_explained_var": 0.03673534095287323, "kl": 0.017205680665951052, "entropy": 8.271944522857666, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 307008, "num_agent_steps_sampled": 921024, "num_steps_trained": 307008, "num_agent_steps_trained": 921024, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1805, "training_iteration": 32, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-54-22", "timestamp": 1706190862, "time_this_iter_s": 20.645696878433228, "time_total_s": 664.8664667606354, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017CB5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 664.8664667606354, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 8.548275862068966, "ram_util_percent": 45.731034482758616}}
{"episode_reward_max": 44.39242588728665, "episode_reward_min": -327.74848815146834, "episode_reward_mean": 0.23618213580163386, "episode_len_mean": 292.91, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -115.52802267515412}, "policy_reward_max": {"shared_policy": 14.94362650563319}, "policy_reward_mean": {"shared_policy": 0.07872737860054424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.821015655994401, -11.373315937817097, 25.54025145061314, -15.528766132891207, 13.70922619663176, -0.7505146339535713, 5.218718230724306, 0.7853948473930075, 14.933933824300766, 24.202302485704422, 13.080764766782494, -8.89035870507361, 23.590088427066803, 17.362625741399825, 12.746139168739319, -39.87283122539523, 25.495871689170585, 22.67548928409815, 19.44550408422947, -1.1486222147941731, 9.6132125928998, 7.319833487272234, 44.39242588728665, 17.40585875511168, 28.03521938156335, -14.674673184752479, 32.218232985585914, 17.498803712427602, 5.251307424157858, -1.2317826598882817, 3.669195479713352, 8.645431252196403, 10.727320557460175, 0.012142613530158997, -26.97522404044868, 23.575677253771573, 26.432841159403296, 12.753846526145907, 10.581924369558678, -10.168962553143501, -19.199292052537203, -322.8899639174342, 14.162503803148851, -5.83689309284091, 17.14694755151865, 27.671916484832735, 9.26037229038775, 20.92334362864493, 19.635081119835377, 5.128744311630726, 32.63912524282932, 14.719086872413726, 17.757399935275288, -16.82546436786653, 16.642031107097864, 27.559489456936703, 12.243741400539875, 7.002075962722287, 8.082461997866616, -12.306113827042296, -327.74848815146834, 8.960226558148861, 23.65152047201991, 13.82229720056057, 13.268897321075187, 13.278398290276527, 15.00407841801642, 6.868322735652299, 14.348273284733267, 13.957378968596444, 17.904370728880153, -11.343530200421839, 1.417792372405529, 9.162179723381968, -6.424531716853409, 21.75193251669404, 14.373898919671774, 21.46015373989937, -6.156089777126937, 25.608720280230017, 16.21972096711397, 15.0007720440626, 22.834181426092968, 19.342553690075874, -4.606567129492774, -13.952135346829905, 26.74708572402595, 12.234403438866124, 13.859765991568551, 11.11057560145855, 19.33981235325335, -0.6629660278559015, -303.7005836740136, 17.76155877858399, 0.07676363736389646, 7.9052582308649875, 15.41659512370822, 8.516315102286157, 10.33383633941412, 18.033323714509606], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.0017603312929424, 2.8754678865273746, 2.943787438174084, -4.18171226978302, -3.4960025921463966, -3.69560107588768, 8.46580521762371, 8.018163457512856, 9.056282775476575, -4.712755305071681, -5.150754188497871, -5.665256639321655, 4.409230957428605, 4.312056089440972, 4.987939149762184, -0.15814898908138275, -0.08949974924325943, -0.5028658956289291, 1.9650530541936462, 1.921537118653447, 1.3321280578772132, 0.28629233936467813, 0.2911175961295669, 0.20798491189876245, 5.180889114737511, 4.82989963889122, 4.923145070672035, 8.110708512365818, 8.027970410883427, 8.063623562455177, 4.219065333406121, 4.343283797303826, 4.518415636072547, -2.610545708487436, -2.892376268903419, -3.387436727682754, 7.6727656200528145, 8.089020505547523, 7.828302301466465, 5.595148108899593, 5.744747310876846, 6.022730321623385, 4.2274633049964905, 4.211587831377983, 4.307088032364845, -13.251593475540488, -13.212616955240577, -13.408620794614166, 8.583763984342411, 7.9111731400092395, 9.000934564818934, 7.728616379201412, 7.661386549472809, 7.285486355423927, 6.428070038557053, 6.371331632137299, 6.646102413535118, -0.325886989633247, -0.4380277271072117, -0.3847074980537144, 3.37152511626482, 3.2622836977243423, 2.979403778910637, 2.608299354712159, 2.34179104367891, 2.3697430888811652, 14.94362650563319, 14.600813632210091, 14.847985749443367, 6.031304699679211, 5.451773693164185, 5.922780362268284, 9.067527775963143, 9.105022226770714, 9.862669378829494, -4.965962814788028, -4.944133582214519, -4.764576787749931, 10.611436178286866, 10.48003103335698, 11.126765773942068, 5.827043694754437, 5.886845668156937, 5.784914349516228, 2.119117271155119, 1.6291740387678146, 1.5030161142349243, -0.17735792944829143, -0.6343190620342938, -0.4201056684056965, 1.0828624392549102, 1.1211948196093147, 1.465138220849127, 3.224490322793514, 3.028604267785937, 2.3923366616169517, 3.6776906599601062, 3.285944347580269, 3.763685549919799, 0.10917636007070541, -0.01738177239894867, -0.07965197414159775, -9.191696862379715, -8.915047230819866, -8.8684799472491, 7.693918876349926, 7.674672946333885, 8.207085431087762, 8.911806332568318, 8.827179099122674, 8.693855727712304, 4.261918375889451, 4.018765139083058, 4.473163011173398, 3.257429545124367, 3.5661792208750995, 3.758315603559211, -3.145403154194355, -3.483198992908001, -3.5403604060411453, -6.282488606870174, -6.122036200016737, -6.794767245650291, -103.75070424377918, -113.46671817451715, -105.67254149913788, 4.892503372703985, 4.617122230430439, 4.6528782000144275, -1.9057674445211887, -2.1137620434165, -1.8173636049032211, 5.573391715685517, 5.78333508844176, 5.790220747391373, 9.39781757692495, 9.248900140325219, 9.025198767582566, 2.527922138571739, 3.635743947699666, 3.0967062041163445, 7.281669115026787, 6.9018018593390735, 6.739872654279068, 6.551966771483421, 6.8562532141804695, 6.226861134171486, 1.8803383819758892, 1.8771681599318981, 1.3712377697229385, 10.417167082428932, 11.104060359299183, 11.117897801101208, 4.707844162980706, 5.323979434246809, 4.687263275186211, 5.869708153108746, 6.4325097563366, 5.4551820258299415, -5.6358407313625065, -5.708764443794891, -5.480859192709133, 5.442678213119507, 5.701803725212812, 5.497549168765545, 9.403187054519847, 8.993701850374535, 9.16260055204232, 4.074211053550243, 4.15720146894455, 4.012328878045082, 2.3384638180335315, 2.3138102938731464, 2.3498018508156093, 2.6479117472966465, 2.691863206525639, 2.742687044044331, -4.364224458734199, -3.7786040880406944, -4.163285280267402, -105.7890439828237, -115.52802267515412, -106.43142149349055, 2.9596937224268913, 2.993794731795788, 3.006738103926182, 8.013427931815386, 7.791245266795158, 7.846847273409367, 4.2887531369924545, 4.695699155330658, 4.837844908237457, 4.7921350387235435, 4.1903780748446735, 4.28638420750697, 4.036170318722725, 4.517348296940327, 4.724879674613476, 5.079746441294745, 4.849629168709114, 5.07470280801256, 2.2325436870256965, 2.7518593526134794, 1.8839196960131233, 4.74413205186525, 4.788955452541501, 4.815185780326516, 4.670355466504887, 4.536079724629715, 4.750943777461842, 5.880334769686058, 6.031424395119146, 5.992611564074949, -3.865984184046596, -3.647955310841411, -3.829590705533832, 0.45585887134075165, 0.6790390387177467, 0.28289446234703064, 3.371764684716851, 3.289781699577958, 2.500633339087159, -2.0544536796708996, -2.371190247436374, -1.998887789746135, 7.485268319646508, 7.072937617699296, 7.193726579348237, 4.778599560260773, 4.982409354299307, 4.612890005111694, 7.258886812875659, 7.122159997622163, 7.079106929401547, -2.0458269168933327, -2.343035494287818, -1.7672273659457858, 8.588044414917618, 8.653868692616612, 8.366807172695786, 5.351118102669716, 5.537185028195381, 5.331417836248875, 5.01266025503476, 4.984367681046322, 5.003744107981518, 7.213412841161087, 7.922811611865953, 7.697956973065928, 6.61936093121767, 6.7134105041623116, 6.009782254695892, -1.6715463350216595, -1.4592684159676281, -1.4757523785034863, -4.5222697580854145, -4.795371907452747, -4.634493681291744, 8.703714345892266, 9.030789525558546, 9.012581852575138, 4.267923963566616, 3.995027412970856, 3.9714520623286518, 4.560386096437767, 4.48610671361287, 4.813273181517914, 3.493303492665291, 3.944183796644211, 3.673088312149048, 6.459851523240403, 6.460551989575222, 6.419408840437725, -0.08874591191610648, -0.4820607950290139, -0.09215932091078116, -100.02786036084096, -100.24045876661937, -103.4322645465533, 5.953833063443497, 5.9709604581197055, 5.836765257020787, 0.19334803273279988, 0.13923986752827489, -0.2558242628971783, 2.6442917784055027, 2.3784713049729618, 2.882495147486523, 5.13956833879152, 5.3191141809026306, 4.957912604014069, 2.600483184059456, 2.7418486749132427, 3.173983243313458, 3.650076612830162, 3.4461428597569466, 3.237616866827011, 6.084619514644146, 6.307011233642697, 5.641692966222763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16597490781644045, "mean_inference_ms": 0.7254466801685092, "mean_action_processing_ms": 0.10143783444870005, "mean_env_wait_ms": 0.8393758829465154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 316602, "timesteps_this_iter": 0, "agent_timesteps_total": 949806, "timers": {"sample_time_ms": 21143.637, "sample_throughput": 453.754, "load_time_ms": 0.2, "load_throughput": 47979197.062, "learn_time_ms": 3164.052, "learn_throughput": 3032.188, "update_time_ms": 10.121}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 27.02634048461914, "policy_loss": -0.0014268849338564538, "vf_loss": 27.112088680267334, "vf_explained_var": -0.006219729781150818, "kl": 0.007124996023791525, "entropy": 8.432300090789795, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316602, "num_agent_steps_sampled": 949806, "num_steps_trained": 316602, "num_agent_steps_trained": 949806, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1839, "training_iteration": 33, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-54-43", "timestamp": 1706190883, "time_this_iter_s": 20.893588066101074, "time_total_s": 685.7600548267365, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B02820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 685.7600548267365, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 9.16551724137931, "ram_util_percent": 45.57241379310344}}
{"episode_reward_max": 38.253426888491944, "episode_reward_min": -327.74848815146834, "episode_reward_mean": -8.414148360787086, "episode_len_mean": 287.58, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -115.52802267515412}, "policy_reward_max": {"shared_policy": 13.197437113927052}, "policy_reward_mean": {"shared_policy": -2.804716120262363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.727320557460175, 0.012142613530158997, -26.97522404044868, 23.575677253771573, 26.432841159403296, 12.753846526145907, 10.581924369558678, -10.168962553143501, -19.199292052537203, -322.8899639174342, 14.162503803148851, -5.83689309284091, 17.14694755151865, 27.671916484832735, 9.26037229038775, 20.92334362864493, 19.635081119835377, 5.128744311630726, 32.63912524282932, 14.719086872413726, 17.757399935275288, -16.82546436786653, 16.642031107097864, 27.559489456936703, 12.243741400539875, 7.002075962722287, 8.082461997866616, -12.306113827042296, -327.74848815146834, 8.960226558148861, 23.65152047201991, 13.82229720056057, 13.268897321075187, 13.278398290276527, 15.00407841801642, 6.868322735652299, 14.348273284733267, 13.957378968596444, 17.904370728880153, -11.343530200421839, 1.417792372405529, 9.162179723381968, -6.424531716853409, 21.75193251669404, 14.373898919671774, 21.46015373989937, -6.156089777126937, 25.608720280230017, 16.21972096711397, 15.0007720440626, 22.834181426092968, 19.342553690075874, -4.606567129492774, -13.952135346829905, 26.74708572402595, 12.234403438866124, 13.859765991568551, 11.11057560145855, 19.33981235325335, -0.6629660278559015, -303.7005836740136, 17.76155877858399, 0.07676363736389646, 7.9052582308649875, 15.41659512370822, 8.516315102286157, 10.33383633941412, 18.033323714509606, -8.67647410184145, 8.681557150557637, 27.667426202446208, 12.637888932600603, 17.001448962837458, 8.711061189882429, -309.17946030944586, -324.1015251763165, 17.674449782818527, 5.0397456884384155, 17.55286631733179, 6.7448932603001595, -294.6091722548008, 19.085419416427612, -5.027539707720294, 38.253426888491944, 31.612123418599367, 19.085365697741494, 19.514122851192923, 21.52774002403021, 4.36208269372581, 10.347586944699287, 11.073886007070541, 11.40333003969863, -24.429657146334648, 12.647731777280569, 27.5038990974426, 15.611111529171467, 8.617129720747442, 11.179487071931348, 15.053111458197222, 10.587869030423462], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 53, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 107, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 45, 48, 300, 300, 300, 300, 274, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.6776906599601062, 3.285944347580269, 3.763685549919799, 0.10917636007070541, -0.01738177239894867, -0.07965197414159775, -9.191696862379715, -8.915047230819866, -8.8684799472491, 7.693918876349926, 7.674672946333885, 8.207085431087762, 8.911806332568318, 8.827179099122674, 8.693855727712304, 4.261918375889451, 4.018765139083058, 4.473163011173398, 3.257429545124367, 3.5661792208750995, 3.758315603559211, -3.145403154194355, -3.483198992908001, -3.5403604060411453, -6.282488606870174, -6.122036200016737, -6.794767245650291, -103.75070424377918, -113.46671817451715, -105.67254149913788, 4.892503372703985, 4.617122230430439, 4.6528782000144275, -1.9057674445211887, -2.1137620434165, -1.8173636049032211, 5.573391715685517, 5.78333508844176, 5.790220747391373, 9.39781757692495, 9.248900140325219, 9.025198767582566, 2.527922138571739, 3.635743947699666, 3.0967062041163445, 7.281669115026787, 6.9018018593390735, 6.739872654279068, 6.551966771483421, 6.8562532141804695, 6.226861134171486, 1.8803383819758892, 1.8771681599318981, 1.3712377697229385, 10.417167082428932, 11.104060359299183, 11.117897801101208, 4.707844162980706, 5.323979434246809, 4.687263275186211, 5.869708153108746, 6.4325097563366, 5.4551820258299415, -5.6358407313625065, -5.708764443794891, -5.480859192709133, 5.442678213119507, 5.701803725212812, 5.497549168765545, 9.403187054519847, 8.993701850374535, 9.16260055204232, 4.074211053550243, 4.15720146894455, 4.012328878045082, 2.3384638180335315, 2.3138102938731464, 2.3498018508156093, 2.6479117472966465, 2.691863206525639, 2.742687044044331, -4.364224458734199, -3.7786040880406944, -4.163285280267402, -105.7890439828237, -115.52802267515412, -106.43142149349055, 2.9596937224268913, 2.993794731795788, 3.006738103926182, 8.013427931815386, 7.791245266795158, 7.846847273409367, 4.2887531369924545, 4.695699155330658, 4.837844908237457, 4.7921350387235435, 4.1903780748446735, 4.28638420750697, 4.036170318722725, 4.517348296940327, 4.724879674613476, 5.079746441294745, 4.849629168709114, 5.07470280801256, 2.2325436870256965, 2.7518593526134794, 1.8839196960131233, 4.74413205186525, 4.788955452541501, 4.815185780326516, 4.670355466504887, 4.536079724629715, 4.750943777461842, 5.880334769686058, 6.031424395119146, 5.992611564074949, -3.865984184046596, -3.647955310841411, -3.829590705533832, 0.45585887134075165, 0.6790390387177467, 0.28289446234703064, 3.371764684716851, 3.289781699577958, 2.500633339087159, -2.0544536796708996, -2.371190247436374, -1.998887789746135, 7.485268319646508, 7.072937617699296, 7.193726579348237, 4.778599560260773, 4.982409354299307, 4.612890005111694, 7.258886812875659, 7.122159997622163, 7.079106929401547, -2.0458269168933327, -2.343035494287818, -1.7672273659457858, 8.588044414917618, 8.653868692616612, 8.366807172695786, 5.351118102669716, 5.537185028195381, 5.331417836248875, 5.01266025503476, 4.984367681046322, 5.003744107981518, 7.213412841161087, 7.922811611865953, 7.697956973065928, 6.61936093121767, 6.7134105041623116, 6.009782254695892, -1.6715463350216595, -1.4592684159676281, -1.4757523785034863, -4.5222697580854145, -4.795371907452747, -4.634493681291744, 8.703714345892266, 9.030789525558546, 9.012581852575138, 4.267923963566616, 3.995027412970856, 3.9714520623286518, 4.560386096437767, 4.48610671361287, 4.813273181517914, 3.493303492665291, 3.944183796644211, 3.673088312149048, 6.459851523240403, 6.460551989575222, 6.419408840437725, -0.08874591191610648, -0.4820607950290139, -0.09215932091078116, -100.02786036084096, -100.24045876661937, -103.4322645465533, 5.953833063443497, 5.9709604581197055, 5.836765257020787, 0.19334803273279988, 0.13923986752827489, -0.2558242628971783, 2.6442917784055027, 2.3784713049729618, 2.882495147486523, 5.13956833879152, 5.3191141809026306, 4.957912604014069, 2.600483184059456, 2.7418486749132427, 3.173983243313458, 3.650076612830162, 3.4461428597569466, 3.237616866827011, 6.084619514644146, 6.307011233642697, 5.641692966222763, -3.184263199567795, -2.9084094390273094, -2.5838014632463455, 3.339683460071683, 2.559765502810478, 2.782108187675476, 9.110598531862095, 9.338374943782881, 9.218452726801232, 3.952969258030251, 4.340896272410944, 4.344023402159408, 5.690832044929266, 5.527894012629986, 5.782722905278206, 3.2285976164663737, 2.8418046037355964, 2.6406589696804588, -101.07469154397647, -109.18378567198913, -98.92098309348027, -105.86058911681175, -114.21307974308729, -104.02785631641746, 5.792911017934472, 5.762259217600018, 6.119279547284037, 1.7763663604855537, 1.7492835000157356, 1.5140958279371262, 5.964450642466545, 5.7945128083229065, 5.793902866542339, 2.238497532904148, 2.332990638911724, 2.1734050884842873, -94.284009916087, -95.87355049451193, -104.45161184420189, 6.326175883412361, 6.583009019494057, 6.1762345135211945, -1.8630941013495175, -1.594022418061897, -1.5704231883088795, 12.313997094829872, 12.74199267973502, 13.197437113927052, 10.405400283634663, 10.567123014479876, 10.639600120484829, 6.680865330000714, 6.473792833586529, 5.9307075341542514, 6.403910363713891, 6.586168179909379, 6.524044307569653, 7.241521552205086, 7.185517810285091, 7.100700661540031, 1.628004321207598, 1.5540529688199314, 1.1800254036982807, 3.4707317501306534, 3.1030691415071487, 3.7737860530614853, 3.9302728325128555, 3.9538124948740005, 3.1898006796836853, 4.018778484780341, 3.7438405752182007, 3.6407109797000885, -8.193600036203861, -8.111321188509464, -8.124735921621323, 4.2269596606493, 4.360239949077368, 4.060532167553902, 9.402643921474606, 9.04449928055206, 9.056755895415932, 5.043506786227226, 5.0591010004282, 5.508503742516041, 3.2762471164266174, 2.8824172864357536, 2.4584653178850715, 3.8972327982385906, 3.5921253760655674, 3.69012889762719, 4.901562800010041, 5.5391183042277845, 4.612430353959397, 3.5047373175621033, 3.0994369089603424, 3.9836948039010167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1658119627498393, "mean_inference_ms": 0.7261110916378286, "mean_action_processing_ms": 0.10149332636368058, "mean_env_wait_ms": 0.840441327810897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 326196, "timesteps_this_iter": 0, "agent_timesteps_total": 978588, "timers": {"sample_time_ms": 21326.219, "sample_throughput": 449.869, "load_time_ms": 0.2, "load_throughput": 47979197.062, "learn_time_ms": 3156.919, "learn_throughput": 3039.039, "update_time_ms": 9.977}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 72.6923475265503, "policy_loss": 4.4564142391192996e-05, "vf_loss": 72.780686378479, "vf_explained_var": 0.0068989768624305725, "kl": 0.015136979243852032, "entropy": 8.838772892951965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 326196, "num_agent_steps_sampled": 978588, "num_steps_trained": 326196, "num_agent_steps_trained": 978588, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1871, "training_iteration": 34, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-55-06", "timestamp": 1706190906, "time_this_iter_s": 22.149657726287842, "time_total_s": 707.9097125530243, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B02E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 707.9097125530243, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 8.103125, "ram_util_percent": 45.803125}}
{"episode_reward_max": 40.66152961924671, "episode_reward_min": -324.1015251763165, "episode_reward_mean": -0.17194550968998826, "episode_len_mean": 291.98, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -114.21307974308729}, "policy_reward_max": {"shared_policy": 13.964400434245661}, "policy_reward_mean": {"shared_policy": -0.05731516989666337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.00407841801642, 6.868322735652299, 14.348273284733267, 13.957378968596444, 17.904370728880153, -11.343530200421839, 1.417792372405529, 9.162179723381968, -6.424531716853409, 21.75193251669404, 14.373898919671774, 21.46015373989937, -6.156089777126937, 25.608720280230017, 16.21972096711397, 15.0007720440626, 22.834181426092968, 19.342553690075874, -4.606567129492774, -13.952135346829905, 26.74708572402595, 12.234403438866124, 13.859765991568551, 11.11057560145855, 19.33981235325335, -0.6629660278559015, -303.7005836740136, 17.76155877858399, 0.07676363736389646, 7.9052582308649875, 15.41659512370822, 8.516315102286157, 10.33383633941412, 18.033323714509606, -8.67647410184145, 8.681557150557637, 27.667426202446208, 12.637888932600603, 17.001448962837458, 8.711061189882429, -309.17946030944586, -324.1015251763165, 17.674449782818527, 5.0397456884384155, 17.55286631733179, 6.7448932603001595, -294.6091722548008, 19.085419416427612, -5.027539707720294, 38.253426888491944, 31.612123418599367, 19.085365697741494, 19.514122851192923, 21.52774002403021, 4.36208269372581, 10.347586944699287, 11.073886007070541, 11.40333003969863, -24.429657146334648, 12.647731777280569, 27.5038990974426, 15.611111529171467, 8.617129720747442, 11.179487071931348, 15.053111458197222, 10.587869030423462, 11.965202502906322, 16.898731667548418, 5.022833634167895, 4.238101717084646, 16.040530301630483, 21.060193315148354, 40.66152961924671, 13.960206270217881, 3.12620677798985, -25.55415924452248, 6.015504717826843, 6.787702850997448, 16.97026893869041, 11.538589157164068, 15.806846365332575, 10.156901191920014, 28.865800289437175, 21.9865355119109, 22.68371754884717, 16.57495721429585, 29.847259679809213, 20.2857138738036, 14.492389719933243, 29.80608020350337, 20.913463473320007, 9.934160307049737, -17.398451881483226, 32.558636233210535, 16.088402196764918, 19.658184058964224, -1.358265995979309, 7.929097980260821, 23.490897677838788, 18.855528719723225], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 45, 48, 300, 300, 300, 300, 274, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.079746441294745, 4.849629168709114, 5.07470280801256, 2.2325436870256965, 2.7518593526134794, 1.8839196960131233, 4.74413205186525, 4.788955452541501, 4.815185780326516, 4.670355466504887, 4.536079724629715, 4.750943777461842, 5.880334769686058, 6.031424395119146, 5.992611564074949, -3.865984184046596, -3.647955310841411, -3.829590705533832, 0.45585887134075165, 0.6790390387177467, 0.28289446234703064, 3.371764684716851, 3.289781699577958, 2.500633339087159, -2.0544536796708996, -2.371190247436374, -1.998887789746135, 7.485268319646508, 7.072937617699296, 7.193726579348237, 4.778599560260773, 4.982409354299307, 4.612890005111694, 7.258886812875659, 7.122159997622163, 7.079106929401547, -2.0458269168933327, -2.343035494287818, -1.7672273659457858, 8.588044414917618, 8.653868692616612, 8.366807172695786, 5.351118102669716, 5.537185028195381, 5.331417836248875, 5.01266025503476, 4.984367681046322, 5.003744107981518, 7.213412841161087, 7.922811611865953, 7.697956973065928, 6.61936093121767, 6.7134105041623116, 6.009782254695892, -1.6715463350216595, -1.4592684159676281, -1.4757523785034863, -4.5222697580854145, -4.795371907452747, -4.634493681291744, 8.703714345892266, 9.030789525558546, 9.012581852575138, 4.267923963566616, 3.995027412970856, 3.9714520623286518, 4.560386096437767, 4.48610671361287, 4.813273181517914, 3.493303492665291, 3.944183796644211, 3.673088312149048, 6.459851523240403, 6.460551989575222, 6.419408840437725, -0.08874591191610648, -0.4820607950290139, -0.09215932091078116, -100.02786036084096, -100.24045876661937, -103.4322645465533, 5.953833063443497, 5.9709604581197055, 5.836765257020787, 0.19334803273279988, 0.13923986752827489, -0.2558242628971783, 2.6442917784055027, 2.3784713049729618, 2.882495147486523, 5.13956833879152, 5.3191141809026306, 4.957912604014069, 2.600483184059456, 2.7418486749132427, 3.173983243313458, 3.650076612830162, 3.4461428597569466, 3.237616866827011, 6.084619514644146, 6.307011233642697, 5.641692966222763, -3.184263199567795, -2.9084094390273094, -2.5838014632463455, 3.339683460071683, 2.559765502810478, 2.782108187675476, 9.110598531862095, 9.338374943782881, 9.218452726801232, 3.952969258030251, 4.340896272410944, 4.344023402159408, 5.690832044929266, 5.527894012629986, 5.782722905278206, 3.2285976164663737, 2.8418046037355964, 2.6406589696804588, -101.07469154397647, -109.18378567198913, -98.92098309348027, -105.86058911681175, -114.21307974308729, -104.02785631641746, 5.792911017934472, 5.762259217600018, 6.119279547284037, 1.7763663604855537, 1.7492835000157356, 1.5140958279371262, 5.964450642466545, 5.7945128083229065, 5.793902866542339, 2.238497532904148, 2.332990638911724, 2.1734050884842873, -94.284009916087, -95.87355049451193, -104.45161184420189, 6.326175883412361, 6.583009019494057, 6.1762345135211945, -1.8630941013495175, -1.594022418061897, -1.5704231883088795, 12.313997094829872, 12.74199267973502, 13.197437113927052, 10.405400283634663, 10.567123014479876, 10.639600120484829, 6.680865330000714, 6.473792833586529, 5.9307075341542514, 6.403910363713891, 6.586168179909379, 6.524044307569653, 7.241521552205086, 7.185517810285091, 7.100700661540031, 1.628004321207598, 1.5540529688199314, 1.1800254036982807, 3.4707317501306534, 3.1030691415071487, 3.7737860530614853, 3.9302728325128555, 3.9538124948740005, 3.1898006796836853, 4.018778484780341, 3.7438405752182007, 3.6407109797000885, -8.193600036203861, -8.111321188509464, -8.124735921621323, 4.2269596606493, 4.360239949077368, 4.060532167553902, 9.402643921474606, 9.04449928055206, 9.056755895415932, 5.043506786227226, 5.0591010004282, 5.508503742516041, 3.2762471164266174, 2.8824172864357536, 2.4584653178850715, 3.8972327982385906, 3.5921253760655674, 3.69012889762719, 4.901562800010041, 5.5391183042277845, 4.612430353959397, 3.5047373175621033, 3.0994369089603424, 3.9836948039010167, 4.127540737390518, 3.8482823595404625, 3.989379405975342, 5.750461582094431, 5.530000485479832, 5.618269599974155, 1.6318410535653385, 1.5322564070423397, 1.8587361735602173, 1.5715673714876175, 0.9596806168556213, 1.7068537287414074, 5.421312620242432, 5.385119264324501, 5.234098417063549, 6.886982813477516, 7.0864313170313835, 7.086779184639454, 13.806749408443764, 13.964400434245661, 12.890379776557282, 4.441794549425438, 4.733239543934658, 4.785172176857785, 1.2995696340997966, 0.7987688382466587, 1.0278683056433948, -8.572258008023113, -8.786338371535152, -8.195562864964216, 2.2801317423582077, 2.0023471266031265, 1.733025848865509, 2.29910422116518, 2.253444753587246, 2.235153876245022, 5.776883812000349, 5.716359560688332, 5.477025566001728, 3.8698413620392387, 4.2105415488282745, 3.4582062462965553, 5.279196018973977, 5.253134186069161, 5.274516160289437, 3.5008096235493724, 3.2354405994216506, 3.4206509689489906, 10.379346756264567, 9.437739968299866, 9.048713564872742, 7.672250104447201, 7.417986338337258, 6.896299069126442, 7.531286644438893, 7.444213795165211, 7.708217109243066, 5.786624995370701, 5.915782635410622, 4.872549583514527, 9.839226193726063, 10.333205135539174, 9.674828350543976, 6.7806388487418445, 6.6910237123568805, 6.814051312704876, 4.907842027644307, 4.955012342582137, 4.629535349706799, 9.963213361799717, 10.365210238844156, 9.477656602859497, 6.834760785102844, 7.013803079724312, 7.064899608492851, 3.4139335801204, 3.386689787109688, 3.133536939819649, -6.15743472178778, -5.402995272850006, -5.838021886845439, 10.80878013620773, 10.678833814958722, 11.071022282044083, 5.65075575063625, 5.078639710942895, 5.359006735185773, 6.465884077052266, 6.594412627319485, 6.597887354592473, -0.49915967136621475, -0.4025576040148735, -0.4565487205982208, 3.0159262965122764, 2.6801797399918144, 2.23299194375673, 7.348236193259552, 8.329382253189877, 7.813279231389359, 6.4580173045396805, 6.493046842515469, 5.904464572668076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1654088250839153, "mean_inference_ms": 0.7263569536121461, "mean_action_processing_ms": 0.10147967307516696, "mean_env_wait_ms": 0.841619761838813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 335790, "timesteps_this_iter": 0, "agent_timesteps_total": 1007370, "timers": {"sample_time_ms": 21252.222, "sample_throughput": 451.435, "load_time_ms": 0.2, "load_throughput": 47979197.062, "learn_time_ms": 3149.163, "learn_throughput": 3046.524, "update_time_ms": 9.926}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 8.620595932006836, "policy_loss": -0.0012055793454073538, "vf_loss": 8.711272597312927, "vf_explained_var": -1.0, "kl": 0.006111351791352603, "entropy": 8.947300434112549, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 335790, "num_agent_steps_sampled": 1007370, "num_steps_trained": 335790, "num_agent_steps_trained": 1007370, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1905, "training_iteration": 35, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-55-26", "timestamp": 1706190926, "time_this_iter_s": 20.211934328079224, "time_total_s": 728.1216468811035, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 728.1216468811035, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.037931034482758, "ram_util_percent": 45.744827586206895}}
{"episode_reward_max": 50.36293017631395, "episode_reward_min": -324.1015251763165, "episode_reward_mean": -1.9428636220796136, "episode_len_mean": 290.67, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -114.21307974308729}, "policy_reward_max": {"shared_policy": 16.96104308109109}, "policy_reward_mean": {"shared_policy": -0.6476212073598719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.33383633941412, 18.033323714509606, -8.67647410184145, 8.681557150557637, 27.667426202446208, 12.637888932600603, 17.001448962837458, 8.711061189882429, -309.17946030944586, -324.1015251763165, 17.674449782818527, 5.0397456884384155, 17.55286631733179, 6.7448932603001595, -294.6091722548008, 19.085419416427612, -5.027539707720294, 38.253426888491944, 31.612123418599367, 19.085365697741494, 19.514122851192923, 21.52774002403021, 4.36208269372581, 10.347586944699287, 11.073886007070541, 11.40333003969863, -24.429657146334648, 12.647731777280569, 27.5038990974426, 15.611111529171467, 8.617129720747442, 11.179487071931348, 15.053111458197222, 10.587869030423462, 11.965202502906322, 16.898731667548418, 5.022833634167895, 4.238101717084646, 16.040530301630483, 21.060193315148354, 40.66152961924671, 13.960206270217881, 3.12620677798985, -25.55415924452248, 6.015504717826843, 6.787702850997448, 16.97026893869041, 11.538589157164068, 15.806846365332575, 10.156901191920014, 28.865800289437175, 21.9865355119109, 22.68371754884717, 16.57495721429585, 29.847259679809213, 20.2857138738036, 14.492389719933243, 29.80608020350337, 20.913463473320007, 9.934160307049737, -17.398451881483226, 32.558636233210535, 16.088402196764918, 19.658184058964224, -1.358265995979309, 7.929097980260821, 23.490897677838788, 18.855528719723225, -302.5573450252414, 25.861192962154732, 33.747085966169834, 17.528357785195098, 4.503364656120539, 19.429548718035193, 50.36293017631395, -8.513343080878286, 6.485327944159479, -11.465850872918963, 17.531718775629983, 10.882920611649752, 19.898650500923367, 26.207501906901598, -293.2385711297393, 17.149857143871458, -1.469362448900938, 22.838000143878133, 27.17141920700668, 1.6281385570764257, 5.204127423465238, 20.408621050417395, 26.066715303808422, 26.821173638105392, 26.824707107618437, -34.837832134217024, 14.57887174561617, 14.697813615202904, -21.052118718624143, 32.11237152758984, 28.129732957109795, 21.348522672429667], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 45, 48, 300, 300, 300, 300, 274, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 138, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.650076612830162, 3.4461428597569466, 3.237616866827011, 6.084619514644146, 6.307011233642697, 5.641692966222763, -3.184263199567795, -2.9084094390273094, -2.5838014632463455, 3.339683460071683, 2.559765502810478, 2.782108187675476, 9.110598531862095, 9.338374943782881, 9.218452726801232, 3.952969258030251, 4.340896272410944, 4.344023402159408, 5.690832044929266, 5.527894012629986, 5.782722905278206, 3.2285976164663737, 2.8418046037355964, 2.6406589696804588, -101.07469154397647, -109.18378567198913, -98.92098309348027, -105.86058911681175, -114.21307974308729, -104.02785631641746, 5.792911017934472, 5.762259217600018, 6.119279547284037, 1.7763663604855537, 1.7492835000157356, 1.5140958279371262, 5.964450642466545, 5.7945128083229065, 5.793902866542339, 2.238497532904148, 2.332990638911724, 2.1734050884842873, -94.284009916087, -95.87355049451193, -104.45161184420189, 6.326175883412361, 6.583009019494057, 6.1762345135211945, -1.8630941013495175, -1.594022418061897, -1.5704231883088795, 12.313997094829872, 12.74199267973502, 13.197437113927052, 10.405400283634663, 10.567123014479876, 10.639600120484829, 6.680865330000714, 6.473792833586529, 5.9307075341542514, 6.403910363713891, 6.586168179909379, 6.524044307569653, 7.241521552205086, 7.185517810285091, 7.100700661540031, 1.628004321207598, 1.5540529688199314, 1.1800254036982807, 3.4707317501306534, 3.1030691415071487, 3.7737860530614853, 3.9302728325128555, 3.9538124948740005, 3.1898006796836853, 4.018778484780341, 3.7438405752182007, 3.6407109797000885, -8.193600036203861, -8.111321188509464, -8.124735921621323, 4.2269596606493, 4.360239949077368, 4.060532167553902, 9.402643921474606, 9.04449928055206, 9.056755895415932, 5.043506786227226, 5.0591010004282, 5.508503742516041, 3.2762471164266174, 2.8824172864357536, 2.4584653178850715, 3.8972327982385906, 3.5921253760655674, 3.69012889762719, 4.901562800010041, 5.5391183042277845, 4.612430353959397, 3.5047373175621033, 3.0994369089603424, 3.9836948039010167, 4.127540737390518, 3.8482823595404625, 3.989379405975342, 5.750461582094431, 5.530000485479832, 5.618269599974155, 1.6318410535653385, 1.5322564070423397, 1.8587361735602173, 1.5715673714876175, 0.9596806168556213, 1.7068537287414074, 5.421312620242432, 5.385119264324501, 5.234098417063549, 6.886982813477516, 7.0864313170313835, 7.086779184639454, 13.806749408443764, 13.964400434245661, 12.890379776557282, 4.441794549425438, 4.733239543934658, 4.785172176857785, 1.2995696340997966, 0.7987688382466587, 1.0278683056433948, -8.572258008023113, -8.786338371535152, -8.195562864964216, 2.2801317423582077, 2.0023471266031265, 1.733025848865509, 2.29910422116518, 2.253444753587246, 2.235153876245022, 5.776883812000349, 5.716359560688332, 5.477025566001728, 3.8698413620392387, 4.2105415488282745, 3.4582062462965553, 5.279196018973977, 5.253134186069161, 5.274516160289437, 3.5008096235493724, 3.2354405994216506, 3.4206509689489906, 10.379346756264567, 9.437739968299866, 9.048713564872742, 7.672250104447201, 7.417986338337258, 6.896299069126442, 7.531286644438893, 7.444213795165211, 7.708217109243066, 5.786624995370701, 5.915782635410622, 4.872549583514527, 9.839226193726063, 10.333205135539174, 9.674828350543976, 6.7806388487418445, 6.6910237123568805, 6.814051312704876, 4.907842027644307, 4.955012342582137, 4.629535349706799, 9.963213361799717, 10.365210238844156, 9.477656602859497, 6.834760785102844, 7.013803079724312, 7.064899608492851, 3.4139335801204, 3.386689787109688, 3.133536939819649, -6.15743472178778, -5.402995272850006, -5.838021886845439, 10.80878013620773, 10.678833814958722, 11.071022282044083, 5.65075575063625, 5.078639710942895, 5.359006735185773, 6.465884077052266, 6.594412627319485, 6.597887354592473, -0.49915967136621475, -0.4025576040148735, -0.4565487205982208, 3.0159262965122764, 2.6801797399918144, 2.23299194375673, 7.348236193259552, 8.329382253189877, 7.813279231389359, 6.4580173045396805, 6.493046842515469, 5.904464572668076, -97.43570512533188, -97.89070641994476, -107.23093347996473, 8.751615274076656, 8.442168978353337, 8.66740870972474, 11.368594020605087, 10.768059939146042, 11.610432006418705, 6.203651533772543, 5.5824862917264255, 5.742219959696129, 1.4431232213974, 1.4019744098186493, 1.6582670249044895, 6.632475952307374, 6.400693866113812, 6.396378899614007, 16.763730102529124, 16.96104308109109, 16.638156992693737, -3.0332112958033974, -3.036235411961883, -2.443896373113006, 2.1244867319861953, 2.2198507736126487, 2.1409904385606353, -3.710663802921772, -3.4769858326762915, -4.2782012373209, 6.091209915777043, 6.028433335324124, 5.412075524528817, 3.982701614499092, 3.0973448008298874, 3.802874196320772, 6.953294402609259, 6.138866911331803, 6.806489186982304, 8.565392941236496, 8.57757180929184, 9.064537156373262, -96.69076300909123, -96.61140959461531, -99.93639852603278, 5.710699687401444, 5.996144314917416, 5.443013141552598, -0.7198493480682373, -0.28752413764595985, -0.4619889631867409, 7.714817094306142, 7.114394585291535, 8.008788464280457, 9.192711667468146, 8.988374409576252, 8.99033312996228, 0.441336999336869, 0.2760340968767707, 0.910767460862786, 1.4735535134871753, 2.1096167688568386, 1.6209571411212238, 6.698313812414796, 6.757589104274899, 6.9527181337277, 8.59964461872974, 8.91153737778464, 8.555533307294041, 8.96066439151764, 9.004126906394958, 8.856382340192795, 8.911664848526314, 9.19543839929004, 8.717603859802082, -11.72848366200924, -11.239031236618757, -11.870317235589027, 5.030039778600127, 5.072529080013425, 4.476302887002618, 4.950337111949921, 4.942121356725693, 4.80535514652729, -7.071877566476672, -7.041160424550384, -6.939080727597087, 10.24463254710038, 10.769404878218964, 11.098334102270499, 9.446568844219044, 9.696710381035999, 8.986453731854752, 6.832317990561322, 7.242871235435203, 7.273333446433142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1652056628818386, "mean_inference_ms": 0.7265409925369769, "mean_action_processing_ms": 0.10148598657135637, "mean_env_wait_ms": 0.8424204592696384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 345384, "timesteps_this_iter": 0, "agent_timesteps_total": 1036152, "timers": {"sample_time_ms": 21216.284, "sample_throughput": 452.2, "load_time_ms": 0.2, "load_throughput": 47979197.062, "learn_time_ms": 3158.731, "learn_throughput": 3037.296, "update_time_ms": 10.238}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875000000004, "cur_lr": 0.0005, "total_loss": 84.7508430480957, "policy_loss": -8.256478088985997e-05, "vf_loss": 84.84246158599854, "vf_explained_var": 0.029618799686431885, "kl": 0.02080830859633625, "entropy": 9.154409170150757, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 345384, "num_agent_steps_sampled": 1036152, "num_steps_trained": 345384, "num_agent_steps_trained": 1036152, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1937, "training_iteration": 36, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-55-46", "timestamp": 1706190946, "time_this_iter_s": 20.564586639404297, "time_total_s": 748.6862335205078, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175CF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 748.6862335205078, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.903448275862068, "ram_util_percent": 45.75862068965518}}
{"episode_reward_max": 65.71461314707994, "episode_reward_min": -302.5573450252414, "episode_reward_mean": 9.63710912713314, "episode_len_mean": 296.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -107.23093347996473}, "policy_reward_max": {"shared_policy": 22.02686958760023}, "policy_reward_mean": {"shared_policy": 3.21236970904438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.053111458197222, 10.587869030423462, 11.965202502906322, 16.898731667548418, 5.022833634167895, 4.238101717084646, 16.040530301630483, 21.060193315148354, 40.66152961924671, 13.960206270217881, 3.12620677798985, -25.55415924452248, 6.015504717826843, 6.787702850997448, 16.97026893869041, 11.538589157164068, 15.806846365332575, 10.156901191920014, 28.865800289437175, 21.9865355119109, 22.68371754884717, 16.57495721429585, 29.847259679809213, 20.2857138738036, 14.492389719933243, 29.80608020350337, 20.913463473320007, 9.934160307049737, -17.398451881483226, 32.558636233210535, 16.088402196764918, 19.658184058964224, -1.358265995979309, 7.929097980260821, 23.490897677838788, 18.855528719723225, -302.5573450252414, 25.861192962154732, 33.747085966169834, 17.528357785195098, 4.503364656120539, 19.429548718035193, 50.36293017631395, -8.513343080878286, 6.485327944159479, -11.465850872918963, 17.531718775629983, 10.882920611649752, 19.898650500923367, 26.207501906901598, -293.2385711297393, 17.149857143871458, -1.469362448900938, 22.838000143878133, 27.17141920700668, 1.6281385570764257, 5.204127423465238, 20.408621050417395, 26.066715303808422, 26.821173638105392, 26.824707107618437, -34.837832134217024, 14.57887174561617, 14.697813615202904, -21.052118718624143, 32.11237152758984, 28.129732957109795, 21.348522672429667, 11.488299787044525, -27.826348666101723, 10.228009127080412, -5.059493757784381, 65.71461314707994, 15.290984362363815, -3.4444011449813985, 31.65952983498572, 5.082822285592528, 30.774834845215054, 18.440123129636035, 28.5962426960468, 8.177074134349809, 5.708460628986359, 29.658213246613727, 38.47179132699965, 17.70813402161002, 15.353448614478097, 17.873458549380274, 4.772409126162515, 11.520680813817307, 22.15917019522746, 18.537395533174262, 24.90795804932712, 11.586903489660457, 18.745847392827272, 40.79066771920769, 30.822734655812383, 3.5337347760796263, 45.05293687991795, 44.25446398090571, 13.295688163489089], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 138, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [4.901562800010041, 5.5391183042277845, 4.612430353959397, 3.5047373175621033, 3.0994369089603424, 3.9836948039010167, 4.127540737390518, 3.8482823595404625, 3.989379405975342, 5.750461582094431, 5.530000485479832, 5.618269599974155, 1.6318410535653385, 1.5322564070423397, 1.8587361735602173, 1.5715673714876175, 0.9596806168556213, 1.7068537287414074, 5.421312620242432, 5.385119264324501, 5.234098417063549, 6.886982813477516, 7.0864313170313835, 7.086779184639454, 13.806749408443764, 13.964400434245661, 12.890379776557282, 4.441794549425438, 4.733239543934658, 4.785172176857785, 1.2995696340997966, 0.7987688382466587, 1.0278683056433948, -8.572258008023113, -8.786338371535152, -8.195562864964216, 2.2801317423582077, 2.0023471266031265, 1.733025848865509, 2.29910422116518, 2.253444753587246, 2.235153876245022, 5.776883812000349, 5.716359560688332, 5.477025566001728, 3.8698413620392387, 4.2105415488282745, 3.4582062462965553, 5.279196018973977, 5.253134186069161, 5.274516160289437, 3.5008096235493724, 3.2354405994216506, 3.4206509689489906, 10.379346756264567, 9.437739968299866, 9.048713564872742, 7.672250104447201, 7.417986338337258, 6.896299069126442, 7.531286644438893, 7.444213795165211, 7.708217109243066, 5.786624995370701, 5.915782635410622, 4.872549583514527, 9.839226193726063, 10.333205135539174, 9.674828350543976, 6.7806388487418445, 6.6910237123568805, 6.814051312704876, 4.907842027644307, 4.955012342582137, 4.629535349706799, 9.963213361799717, 10.365210238844156, 9.477656602859497, 6.834760785102844, 7.013803079724312, 7.064899608492851, 3.4139335801204, 3.386689787109688, 3.133536939819649, -6.15743472178778, -5.402995272850006, -5.838021886845439, 10.80878013620773, 10.678833814958722, 11.071022282044083, 5.65075575063625, 5.078639710942895, 5.359006735185773, 6.465884077052266, 6.594412627319485, 6.597887354592473, -0.49915967136621475, -0.4025576040148735, -0.4565487205982208, 3.0159262965122764, 2.6801797399918144, 2.23299194375673, 7.348236193259552, 8.329382253189877, 7.813279231389359, 6.4580173045396805, 6.493046842515469, 5.904464572668076, -97.43570512533188, -97.89070641994476, -107.23093347996473, 8.751615274076656, 8.442168978353337, 8.66740870972474, 11.368594020605087, 10.768059939146042, 11.610432006418705, 6.203651533772543, 5.5824862917264255, 5.742219959696129, 1.4431232213974, 1.4019744098186493, 1.6582670249044895, 6.632475952307374, 6.400693866113812, 6.396378899614007, 16.763730102529124, 16.96104308109109, 16.638156992693737, -3.0332112958033974, -3.036235411961883, -2.443896373113006, 2.1244867319861953, 2.2198507736126487, 2.1409904385606353, -3.710663802921772, -3.4769858326762915, -4.2782012373209, 6.091209915777043, 6.028433335324124, 5.412075524528817, 3.982701614499092, 3.0973448008298874, 3.802874196320772, 6.953294402609259, 6.138866911331803, 6.806489186982304, 8.565392941236496, 8.57757180929184, 9.064537156373262, -96.69076300909123, -96.61140959461531, -99.93639852603278, 5.710699687401444, 5.996144314917416, 5.443013141552598, -0.7198493480682373, -0.28752413764595985, -0.4619889631867409, 7.714817094306142, 7.114394585291535, 8.008788464280457, 9.192711667468146, 8.988374409576252, 8.99033312996228, 0.441336999336869, 0.2760340968767707, 0.910767460862786, 1.4735535134871753, 2.1096167688568386, 1.6209571411212238, 6.698313812414796, 6.757589104274899, 6.9527181337277, 8.59964461872974, 8.91153737778464, 8.555533307294041, 8.96066439151764, 9.004126906394958, 8.856382340192795, 8.911664848526314, 9.19543839929004, 8.717603859802082, -11.72848366200924, -11.239031236618757, -11.870317235589027, 5.030039778600127, 5.072529080013425, 4.476302887002618, 4.950337111949921, 4.942121356725693, 4.80535514652729, -7.071877566476672, -7.041160424550384, -6.939080727597087, 10.24463254710038, 10.769404878218964, 11.098334102270499, 9.446568844219044, 9.696710381035999, 8.986453731854752, 6.832317990561322, 7.242871235435203, 7.273333446433142, 3.706946574151516, 3.897441677749157, 3.8839115351438522, -8.922668152799218, -9.2148122539123, -9.688868259390205, 3.608625325063855, 3.109445254007966, 3.5099385480085914, -1.9229512463013378, -1.6036087355266062, -1.5329337759564368, 22.00104583799839, 22.02686958760023, 21.686697721481323, 5.02987802028656, 5.435328930616379, 4.8257774114608765, -1.2375175232688633, -1.095108019808933, -1.1117756019036023, 10.8160853733619, 10.120956634481743, 10.722487827142075, 1.437133337060601, 1.8631195003787582, 1.7825694481531684, 10.227036500970513, 9.965899387995393, 10.581898956249148, 6.468852498879031, 5.989566018184021, 5.981704612572983, 9.806073653201253, 9.449899355570466, 9.340269687275082, 2.757248175640896, 2.833036524554089, 2.5867894341548237, 1.9839002341032028, 1.9398441314697266, 1.7847162634134293, 10.11151236419876, 9.691284586985901, 9.855416295429066, 13.132131469746426, 12.886461315055683, 12.45319854219754, 6.191646855324507, 5.917800784111023, 5.598686382174492, 5.41552086671193, 5.018974815805748, 4.918952931960419, 5.999768818418175, 6.1831479469935005, 5.690541783968598, 1.8105295238395485, 1.7200729561348709, 1.2418066461880954, 4.057493236847222, 4.08042194112204, 3.3827656358480453, 7.166241506735474, 7.116253698865563, 7.876674989626423, 6.034743895133332, 6.396302745987967, 6.106348892052964, 8.100401525696114, 8.65042471264799, 8.157131810983017, 3.475421269734696, 4.256696683199451, 3.854785536726311, 6.374975223094225, 6.302995629608631, 6.067876540124416, 13.572284822662667, 13.190305103858307, 14.028077792686716, 10.058441087603569, 10.506796324625611, 10.257497243583202, 1.4618488351503913, 0.7514650324980323, 1.3204209084312026, 14.97970578322807, 15.191337355102092, 14.881893741587788, 15.141762625426054, 15.311960964463651, 13.800740391016006, 4.617820077886179, 4.355781202514962, 4.322086883087948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16474685641431186, "mean_inference_ms": 0.7258086309453137, "mean_action_processing_ms": 0.10131488389468679, "mean_env_wait_ms": 0.84295246575601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 354978, "timesteps_this_iter": 0, "agent_timesteps_total": 1064934, "timers": {"sample_time_ms": 21148.568, "sample_throughput": 453.648, "load_time_ms": 0.2, "load_throughput": 47979197.062, "learn_time_ms": 3164.831, "learn_throughput": 3031.442, "update_time_ms": 10.139}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 7.9201149344444275, "policy_loss": -0.001161800061898477, "vf_loss": 8.01395559310913, "vf_explained_var": -1.0, "kl": 0.005473458466465049, "entropy": 9.268165946006775, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 354978, "num_agent_steps_sampled": 1064934, "num_steps_trained": 354978, "num_agent_steps_trained": 1064934, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1969, "training_iteration": 37, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-56-07", "timestamp": 1706190967, "time_this_iter_s": 20.826574563980103, "time_total_s": 769.5128080844879, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 769.5128080844879, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 7.558620689655171, "ram_util_percent": 45.937931034482766}}
{"episode_reward_max": 65.71461314707994, "episode_reward_min": -304.48759254813194, "episode_reward_mean": 8.396877580765855, "episode_len_mean": 293.31, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -107.23093347996473}, "policy_reward_max": {"shared_policy": 22.02686958760023}, "policy_reward_mean": {"shared_policy": 2.798959193588617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.358265995979309, 7.929097980260821, 23.490897677838788, 18.855528719723225, -302.5573450252414, 25.861192962154732, 33.747085966169834, 17.528357785195098, 4.503364656120539, 19.429548718035193, 50.36293017631395, -8.513343080878286, 6.485327944159479, -11.465850872918963, 17.531718775629983, 10.882920611649752, 19.898650500923367, 26.207501906901598, -293.2385711297393, 17.149857143871458, -1.469362448900938, 22.838000143878133, 27.17141920700668, 1.6281385570764257, 5.204127423465238, 20.408621050417395, 26.066715303808422, 26.821173638105392, 26.824707107618437, -34.837832134217024, 14.57887174561617, 14.697813615202904, -21.052118718624143, 32.11237152758984, 28.129732957109795, 21.348522672429667, 11.488299787044525, -27.826348666101723, 10.228009127080412, -5.059493757784381, 65.71461314707994, 15.290984362363815, -3.4444011449813985, 31.65952983498572, 5.082822285592528, 30.774834845215054, 18.440123129636035, 28.5962426960468, 8.177074134349809, 5.708460628986359, 29.658213246613727, 38.47179132699965, 17.70813402161002, 15.353448614478097, 17.873458549380274, 4.772409126162515, 11.520680813817307, 22.15917019522746, 18.537395533174262, 24.90795804932712, 11.586903489660457, 18.745847392827272, 40.79066771920769, 30.822734655812383, 3.5337347760796263, 45.05293687991795, 44.25446398090571, 13.295688163489089, 11.71975831687449, 27.234933666884885, 28.633086565532693, -304.48759254813194, 21.74650094099343, 16.688402378931627, 9.295107640326009, 17.51411040127276, 23.906485214829445, 20.859036922454806, 41.29558936506507, 28.032764133997233, 23.97238779533653, 16.13211265206334, 9.778586611151695, 23.041905836202204, 7.163765160366879, 34.92288770899174, 24.053846985101686, 9.013372275046976, 8.299497948959441, 47.88156915456055, 24.92666431516406, 23.512445390224457, 27.915646877139793, 22.772654570639105, 38.91680345684287, -16.078544531017556, 16.743671126663656, 7.669709566980572, 27.591864875983447, 21.940833289176197], "episode_lengths": [300, 300, 300, 300, 62, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 138, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-0.49915967136621475, -0.4025576040148735, -0.4565487205982208, 3.0159262965122764, 2.6801797399918144, 2.23299194375673, 7.348236193259552, 8.329382253189877, 7.813279231389359, 6.4580173045396805, 6.493046842515469, 5.904464572668076, -97.43570512533188, -97.89070641994476, -107.23093347996473, 8.751615274076656, 8.442168978353337, 8.66740870972474, 11.368594020605087, 10.768059939146042, 11.610432006418705, 6.203651533772543, 5.5824862917264255, 5.742219959696129, 1.4431232213974, 1.4019744098186493, 1.6582670249044895, 6.632475952307374, 6.400693866113812, 6.396378899614007, 16.763730102529124, 16.96104308109109, 16.638156992693737, -3.0332112958033974, -3.036235411961883, -2.443896373113006, 2.1244867319861953, 2.2198507736126487, 2.1409904385606353, -3.710663802921772, -3.4769858326762915, -4.2782012373209, 6.091209915777043, 6.028433335324124, 5.412075524528817, 3.982701614499092, 3.0973448008298874, 3.802874196320772, 6.953294402609259, 6.138866911331803, 6.806489186982304, 8.565392941236496, 8.57757180929184, 9.064537156373262, -96.69076300909123, -96.61140959461531, -99.93639852603278, 5.710699687401444, 5.996144314917416, 5.443013141552598, -0.7198493480682373, -0.28752413764595985, -0.4619889631867409, 7.714817094306142, 7.114394585291535, 8.008788464280457, 9.192711667468146, 8.988374409576252, 8.99033312996228, 0.441336999336869, 0.2760340968767707, 0.910767460862786, 1.4735535134871753, 2.1096167688568386, 1.6209571411212238, 6.698313812414796, 6.757589104274899, 6.9527181337277, 8.59964461872974, 8.91153737778464, 8.555533307294041, 8.96066439151764, 9.004126906394958, 8.856382340192795, 8.911664848526314, 9.19543839929004, 8.717603859802082, -11.72848366200924, -11.239031236618757, -11.870317235589027, 5.030039778600127, 5.072529080013425, 4.476302887002618, 4.950337111949921, 4.942121356725693, 4.80535514652729, -7.071877566476672, -7.041160424550384, -6.939080727597087, 10.24463254710038, 10.769404878218964, 11.098334102270499, 9.446568844219044, 9.696710381035999, 8.986453731854752, 6.832317990561322, 7.242871235435203, 7.273333446433142, 3.706946574151516, 3.897441677749157, 3.8839115351438522, -8.922668152799218, -9.2148122539123, -9.688868259390205, 3.608625325063855, 3.109445254007966, 3.5099385480085914, -1.9229512463013378, -1.6036087355266062, -1.5329337759564368, 22.00104583799839, 22.02686958760023, 21.686697721481323, 5.02987802028656, 5.435328930616379, 4.8257774114608765, -1.2375175232688633, -1.095108019808933, -1.1117756019036023, 10.8160853733619, 10.120956634481743, 10.722487827142075, 1.437133337060601, 1.8631195003787582, 1.7825694481531684, 10.227036500970513, 9.965899387995393, 10.581898956249148, 6.468852498879031, 5.989566018184021, 5.981704612572983, 9.806073653201253, 9.449899355570466, 9.340269687275082, 2.757248175640896, 2.833036524554089, 2.5867894341548237, 1.9839002341032028, 1.9398441314697266, 1.7847162634134293, 10.11151236419876, 9.691284586985901, 9.855416295429066, 13.132131469746426, 12.886461315055683, 12.45319854219754, 6.191646855324507, 5.917800784111023, 5.598686382174492, 5.41552086671193, 5.018974815805748, 4.918952931960419, 5.999768818418175, 6.1831479469935005, 5.690541783968598, 1.8105295238395485, 1.7200729561348709, 1.2418066461880954, 4.057493236847222, 4.08042194112204, 3.3827656358480453, 7.166241506735474, 7.116253698865563, 7.876674989626423, 6.034743895133332, 6.396302745987967, 6.106348892052964, 8.100401525696114, 8.65042471264799, 8.157131810983017, 3.475421269734696, 4.256696683199451, 3.854785536726311, 6.374975223094225, 6.302995629608631, 6.067876540124416, 13.572284822662667, 13.190305103858307, 14.028077792686716, 10.058441087603569, 10.506796324625611, 10.257497243583202, 1.4618488351503913, 0.7514650324980323, 1.3204209084312026, 14.97970578322807, 15.191337355102092, 14.881893741587788, 15.141762625426054, 15.311960964463651, 13.800740391016006, 4.617820077886179, 4.355781202514962, 4.322086883087948, 4.256994535525635, 3.951612969239548, 3.5111508121093067, 9.048702677090958, 9.317315516372517, 8.86891547342141, 9.523324283460767, 9.88072866787357, 9.229033614198357, -100.43637965122859, -100.6836982468764, -103.36751465002696, 7.14459977298975, 7.5072023291140795, 7.094698838889599, 5.4357257982095035, 5.576664016892508, 5.676012563829616, 3.3526002590854915, 3.113845174511269, 2.8286622067292484, 5.8945994352300914, 5.888106328745678, 5.73140463729699, 8.125963602215052, 8.178965505212545, 7.601556107401848, 7.191650318602711, 7.032863172392041, 6.634523431460053, 13.357571552197129, 13.91412981102863, 14.02388800183931, 9.425914476315171, 9.622679359900445, 8.984170297781617, 8.040618409713105, 7.597710897525147, 8.334058488098279, 5.818470264474541, 4.905019323031098, 5.408623064557702, 3.0822898894548416, 3.3488468527793884, 3.347449868917465, 7.871849035844207, 7.3307870253920555, 7.839269774965942, 2.6040909284104856, 2.3918943045039924, 2.1677799274524006, 11.846558547268302, 11.604049841562897, 11.472279320160538, 8.00041366865237, 8.437704113622502, 7.615729202826813, 3.172625774207205, 2.677404070893914, 3.163342429945857, 2.8410392428437774, 2.210742736856133, 3.2477159692595308, 16.338730690379933, 16.166814913352326, 15.376023550828293, 8.400185557703168, 8.067532519499451, 8.458946237961442, 8.004671186208725, 7.811479978263378, 7.696294225752354, 9.297356945772961, 9.010186051328972, 9.60810388003786, 7.793120982746274, 7.157727683583886, 7.821805904308945, 12.986596713463456, 13.582890706757695, 12.34731603662172, -5.239879163602993, -5.941949347654983, -4.89671601975958, 5.603326576451451, 5.542460324863583, 5.597884225348622, 2.5006389866272514, 2.4202278132239883, 2.7488427671293323, 8.966581657528877, 9.391784026753157, 9.233499191701412, 7.345439771811158, 7.147925066451222, 7.447468450913817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16449929768906504, "mean_inference_ms": 0.7254063077000478, "mean_action_processing_ms": 0.10125647439958323, "mean_env_wait_ms": 0.8434225293764693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 364572, "timesteps_this_iter": 0, "agent_timesteps_total": 1093716, "timers": {"sample_time_ms": 21163.566, "sample_throughput": 453.326, "load_time_ms": 0.1, "load_throughput": 95969836.814, "learn_time_ms": 3168.105, "learn_throughput": 3028.309, "update_time_ms": 10.238}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 29.189175605773926, "policy_loss": -0.0013132188645835208, "vf_loss": 29.283926725387573, "vf_explained_var": -0.051223814487457275, "kl": 0.005378546215095919, "entropy": 9.344101190567017, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364572, "num_agent_steps_sampled": 1093716, "num_steps_trained": 364572, "num_agent_steps_trained": 1093716, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2001, "training_iteration": 38, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-56-28", "timestamp": 1706190988, "time_this_iter_s": 20.6393404006958, "time_total_s": 790.1521484851837, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 790.1521484851837, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 6.316666666666667, "ram_util_percent": 45.86666666666666}}
{"episode_reward_max": 66.76782077550885, "episode_reward_min": -304.48759254813194, "episode_reward_mean": 19.82477576264761, "episode_len_mean": 297.31, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -103.36751465002696}, "policy_reward_max": {"shared_policy": 22.64599736283222}, "policy_reward_mean": {"shared_policy": 6.608258587549202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.11237152758984, 28.129732957109795, 21.348522672429667, 11.488299787044525, -27.826348666101723, 10.228009127080412, -5.059493757784381, 65.71461314707994, 15.290984362363815, -3.4444011449813985, 31.65952983498572, 5.082822285592528, 30.774834845215054, 18.440123129636035, 28.5962426960468, 8.177074134349809, 5.708460628986359, 29.658213246613727, 38.47179132699965, 17.70813402161002, 15.353448614478097, 17.873458549380274, 4.772409126162515, 11.520680813817307, 22.15917019522746, 18.537395533174262, 24.90795804932712, 11.586903489660457, 18.745847392827272, 40.79066771920769, 30.822734655812383, 3.5337347760796263, 45.05293687991795, 44.25446398090571, 13.295688163489089, 11.71975831687449, 27.234933666884885, 28.633086565532693, -304.48759254813194, 21.74650094099343, 16.688402378931627, 9.295107640326009, 17.51411040127276, 23.906485214829445, 20.859036922454806, 41.29558936506507, 28.032764133997233, 23.97238779533653, 16.13211265206334, 9.778586611151695, 23.041905836202204, 7.163765160366879, 34.92288770899174, 24.053846985101686, 9.013372275046976, 8.299497948959441, 47.88156915456055, 24.92666431516406, 23.512445390224457, 27.915646877139793, 22.772654570639105, 38.91680345684287, -16.078544531017556, 16.743671126663656, 7.669709566980572, 27.591864875983447, 21.940833289176197, 31.14694713801144, 17.662172943353625, 38.39251905679701, 15.560902582481503, 40.55521459877491, 26.55764247477053, 22.911851320415735, 36.77875795774159, 23.616575181484222, 35.810442570596905, 23.078772858716533, 37.88310634018853, 10.509684741497011, 15.575426302850232, 36.8264194615185, 21.353420794010134, 26.619609355926514, 55.59792545437813, 13.902225084602804, 40.31381628662348, 22.944075763225555, 20.238540820777416, 21.912298124283552, 53.082657773047686, 18.74075115472077, 41.172364894300685, 66.76782077550885, 16.08914977312085, 29.181174006313086, -12.993352081626682, 33.55680439434943, 34.53950353339313, 38.515476662665606], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.24463254710038, 10.769404878218964, 11.098334102270499, 9.446568844219044, 9.696710381035999, 8.986453731854752, 6.832317990561322, 7.242871235435203, 7.273333446433142, 3.706946574151516, 3.897441677749157, 3.8839115351438522, -8.922668152799218, -9.2148122539123, -9.688868259390205, 3.608625325063855, 3.109445254007966, 3.5099385480085914, -1.9229512463013378, -1.6036087355266062, -1.5329337759564368, 22.00104583799839, 22.02686958760023, 21.686697721481323, 5.02987802028656, 5.435328930616379, 4.8257774114608765, -1.2375175232688633, -1.095108019808933, -1.1117756019036023, 10.8160853733619, 10.120956634481743, 10.722487827142075, 1.437133337060601, 1.8631195003787582, 1.7825694481531684, 10.227036500970513, 9.965899387995393, 10.581898956249148, 6.468852498879031, 5.989566018184021, 5.981704612572983, 9.806073653201253, 9.449899355570466, 9.340269687275082, 2.757248175640896, 2.833036524554089, 2.5867894341548237, 1.9839002341032028, 1.9398441314697266, 1.7847162634134293, 10.11151236419876, 9.691284586985901, 9.855416295429066, 13.132131469746426, 12.886461315055683, 12.45319854219754, 6.191646855324507, 5.917800784111023, 5.598686382174492, 5.41552086671193, 5.018974815805748, 4.918952931960419, 5.999768818418175, 6.1831479469935005, 5.690541783968598, 1.8105295238395485, 1.7200729561348709, 1.2418066461880954, 4.057493236847222, 4.08042194112204, 3.3827656358480453, 7.166241506735474, 7.116253698865563, 7.876674989626423, 6.034743895133332, 6.396302745987967, 6.106348892052964, 8.100401525696114, 8.65042471264799, 8.157131810983017, 3.475421269734696, 4.256696683199451, 3.854785536726311, 6.374975223094225, 6.302995629608631, 6.067876540124416, 13.572284822662667, 13.190305103858307, 14.028077792686716, 10.058441087603569, 10.506796324625611, 10.257497243583202, 1.4618488351503913, 0.7514650324980323, 1.3204209084312026, 14.97970578322807, 15.191337355102092, 14.881893741587788, 15.141762625426054, 15.311960964463651, 13.800740391016006, 4.617820077886179, 4.355781202514962, 4.322086883087948, 4.256994535525635, 3.951612969239548, 3.5111508121093067, 9.048702677090958, 9.317315516372517, 8.86891547342141, 9.523324283460767, 9.88072866787357, 9.229033614198357, -100.43637965122859, -100.6836982468764, -103.36751465002696, 7.14459977298975, 7.5072023291140795, 7.094698838889599, 5.4357257982095035, 5.576664016892508, 5.676012563829616, 3.3526002590854915, 3.113845174511269, 2.8286622067292484, 5.8945994352300914, 5.888106328745678, 5.73140463729699, 8.125963602215052, 8.178965505212545, 7.601556107401848, 7.191650318602711, 7.032863172392041, 6.634523431460053, 13.357571552197129, 13.91412981102863, 14.02388800183931, 9.425914476315171, 9.622679359900445, 8.984170297781617, 8.040618409713105, 7.597710897525147, 8.334058488098279, 5.818470264474541, 4.905019323031098, 5.408623064557702, 3.0822898894548416, 3.3488468527793884, 3.347449868917465, 7.871849035844207, 7.3307870253920555, 7.839269774965942, 2.6040909284104856, 2.3918943045039924, 2.1677799274524006, 11.846558547268302, 11.604049841562897, 11.472279320160538, 8.00041366865237, 8.437704113622502, 7.615729202826813, 3.172625774207205, 2.677404070893914, 3.163342429945857, 2.8410392428437774, 2.210742736856133, 3.2477159692595308, 16.338730690379933, 16.166814913352326, 15.376023550828293, 8.400185557703168, 8.067532519499451, 8.458946237961442, 8.004671186208725, 7.811479978263378, 7.696294225752354, 9.297356945772961, 9.010186051328972, 9.60810388003786, 7.793120982746274, 7.157727683583886, 7.821805904308945, 12.986596713463456, 13.582890706757695, 12.34731603662172, -5.239879163602993, -5.941949347654983, -4.89671601975958, 5.603326576451451, 5.542460324863583, 5.597884225348622, 2.5006389866272514, 2.4202278132239883, 2.7488427671293323, 8.966581657528877, 9.391784026753157, 9.233499191701412, 7.345439771811158, 7.147925066451222, 7.447468450913817, 10.375365016361073, 10.16256596644719, 10.609016155203179, 5.890892381469399, 5.885956856111676, 5.885323705772549, 12.985990693171814, 12.541690667470291, 12.864837696154908, 5.16093859821558, 5.411920914426446, 4.9880430698394775, 13.642232038080692, 13.61149138957262, 13.301491171121597, 9.280238670607403, 8.43495975931485, 8.842444044848278, 7.3331383019685745, 7.902262728661299, 7.676450289785862, 12.240793141225964, 11.851696814099938, 12.686268002415687, 7.924040727317333, 7.939130090177059, 7.75340436398983, 12.031460250417382, 12.475742785880954, 11.30323953429857, 7.742037534092859, 7.777575187695518, 7.559160136928156, 12.788991086184978, 11.98760175704956, 13.106513496953994, 3.430947917203099, 3.4440831790367668, 3.6346536452571456, 4.996624131997422, 5.736375105877713, 4.842427064975098, 12.48769053692618, 12.183514120678097, 12.15521480391422, 6.990178572634846, 7.224668777237326, 7.138573444137961, 8.815003082156181, 8.932539213448763, 8.87206706032157, 18.515583142638206, 18.371765591204166, 18.710576720535755, 4.886023613313824, 4.302854786316544, 4.713346684972436, 13.469880543649197, 13.637893930077553, 13.206041812896729, 7.472984045743942, 7.823154479265213, 7.6479372382164, 6.881234787404537, 6.676508069038391, 6.680797964334488, 7.270103983581066, 7.150974750518799, 7.491219390183687, 17.901850286871195, 17.888273894786835, 17.292533591389656, 6.308099338163927, 6.110310358305767, 6.322341458251074, 13.788067170729235, 13.417121929426983, 13.967175794144467, 21.769212777415902, 22.64599736283222, 22.35261063526073, 5.456000375250966, 5.318988258639962, 5.314161139229924, 9.74599265307188, 9.837665919214487, 9.597515434026718, -4.7062294383843835, -4.199726862212032, -4.087395781030267, 10.965378957490117, 11.430085778857261, 11.16133965800205, 11.807761510213211, 11.725890451421336, 11.005851571758583, 12.847723372280598, 12.732412114739418, 12.93534117564559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16419450142976036, "mean_inference_ms": 0.7251377312079085, "mean_action_processing_ms": 0.1011235529127322, "mean_env_wait_ms": 0.8439801026499631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 374166, "timesteps_this_iter": 0, "agent_timesteps_total": 1122498, "timers": {"sample_time_ms": 21142.214, "sample_throughput": 453.784, "load_time_ms": 0.1, "load_throughput": 95969836.814, "learn_time_ms": 3139.221, "learn_throughput": 3056.173, "update_time_ms": 10.037}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 6.949613809585571, "policy_loss": -0.0010039948747558869, "vf_loss": 7.045737624168396, "vf_explained_var": -1.0, "kl": 0.006155198003427115, "entropy": 9.512262225151062, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 374166, "num_agent_steps_sampled": 1122498, "num_steps_trained": 374166, "num_agent_steps_trained": 1122498, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2034, "training_iteration": 39, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-56-49", "timestamp": 1706191009, "time_this_iter_s": 20.903191328048706, "time_total_s": 811.0553398132324, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B7B040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 811.0553398132324, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 8.324137931034484, "ram_util_percent": 46.03103448275862}}
{"episode_reward_max": 66.76782077550885, "episode_reward_min": -304.48759254813194, "episode_reward_mean": 23.108868500004743, "episode_len_mean": 297.31, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -103.36751465002696}, "policy_reward_max": {"shared_policy": 22.64599736283222}, "policy_reward_mean": {"shared_policy": 7.702956166668246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.05293687991795, 44.25446398090571, 13.295688163489089, 11.71975831687449, 27.234933666884885, 28.633086565532693, -304.48759254813194, 21.74650094099343, 16.688402378931627, 9.295107640326009, 17.51411040127276, 23.906485214829445, 20.859036922454806, 41.29558936506507, 28.032764133997233, 23.97238779533653, 16.13211265206334, 9.778586611151695, 23.041905836202204, 7.163765160366879, 34.92288770899174, 24.053846985101686, 9.013372275046976, 8.299497948959441, 47.88156915456055, 24.92666431516406, 23.512445390224457, 27.915646877139793, 22.772654570639105, 38.91680345684287, -16.078544531017556, 16.743671126663656, 7.669709566980572, 27.591864875983447, 21.940833289176197, 31.14694713801144, 17.662172943353625, 38.39251905679701, 15.560902582481503, 40.55521459877491, 26.55764247477053, 22.911851320415735, 36.77875795774159, 23.616575181484222, 35.810442570596905, 23.078772858716533, 37.88310634018853, 10.509684741497011, 15.575426302850232, 36.8264194615185, 21.353420794010134, 26.619609355926514, 55.59792545437813, 13.902225084602804, 40.31381628662348, 22.944075763225555, 20.238540820777416, 21.912298124283552, 53.082657773047686, 18.74075115472077, 41.172364894300685, 66.76782077550885, 16.08914977312085, 29.181174006313086, -12.993352081626682, 33.55680439434943, 34.53950353339313, 38.515476662665606, 13.073725506663308, 7.210367341525853, 40.82561003230511, 25.234662596136303, 17.975655095651746, 30.97874302417037, 44.99140991456804, 21.306313445791574, 20.717002391815186, 42.008399246260495, 26.026720685884328, 0.5352142602204992, 25.505862558260546, 34.67072255909443, 37.57552867941557, 22.59306924045083, 39.74419289082287, 27.589659653604002, 30.707402903586626, 24.863224748522015, 25.87496185675262, 30.88133342936635, 31.8693282031454, 40.1737835370004, 27.747994855046258, 30.87302981875834, 37.27384242787957, 28.425251461565466, 33.31029620766638, 34.55010450631377, 44.54653996415436, 11.613245770335197], "episode_lengths": [300, 300, 300, 300, 300, 300, 31, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [14.97970578322807, 15.191337355102092, 14.881893741587788, 15.141762625426054, 15.311960964463651, 13.800740391016006, 4.617820077886179, 4.355781202514962, 4.322086883087948, 4.256994535525635, 3.951612969239548, 3.5111508121093067, 9.048702677090958, 9.317315516372517, 8.86891547342141, 9.523324283460767, 9.88072866787357, 9.229033614198357, -100.43637965122859, -100.6836982468764, -103.36751465002696, 7.14459977298975, 7.5072023291140795, 7.094698838889599, 5.4357257982095035, 5.576664016892508, 5.676012563829616, 3.3526002590854915, 3.113845174511269, 2.8286622067292484, 5.8945994352300914, 5.888106328745678, 5.73140463729699, 8.125963602215052, 8.178965505212545, 7.601556107401848, 7.191650318602711, 7.032863172392041, 6.634523431460053, 13.357571552197129, 13.91412981102863, 14.02388800183931, 9.425914476315171, 9.622679359900445, 8.984170297781617, 8.040618409713105, 7.597710897525147, 8.334058488098279, 5.818470264474541, 4.905019323031098, 5.408623064557702, 3.0822898894548416, 3.3488468527793884, 3.347449868917465, 7.871849035844207, 7.3307870253920555, 7.839269774965942, 2.6040909284104856, 2.3918943045039924, 2.1677799274524006, 11.846558547268302, 11.604049841562897, 11.472279320160538, 8.00041366865237, 8.437704113622502, 7.615729202826813, 3.172625774207205, 2.677404070893914, 3.163342429945857, 2.8410392428437774, 2.210742736856133, 3.2477159692595308, 16.338730690379933, 16.166814913352326, 15.376023550828293, 8.400185557703168, 8.067532519499451, 8.458946237961442, 8.004671186208725, 7.811479978263378, 7.696294225752354, 9.297356945772961, 9.010186051328972, 9.60810388003786, 7.793120982746274, 7.157727683583886, 7.821805904308945, 12.986596713463456, 13.582890706757695, 12.34731603662172, -5.239879163602993, -5.941949347654983, -4.89671601975958, 5.603326576451451, 5.542460324863583, 5.597884225348622, 2.5006389866272514, 2.4202278132239883, 2.7488427671293323, 8.966581657528877, 9.391784026753157, 9.233499191701412, 7.345439771811158, 7.147925066451222, 7.447468450913817, 10.375365016361073, 10.16256596644719, 10.609016155203179, 5.890892381469399, 5.885956856111676, 5.885323705772549, 12.985990693171814, 12.541690667470291, 12.864837696154908, 5.16093859821558, 5.411920914426446, 4.9880430698394775, 13.642232038080692, 13.61149138957262, 13.301491171121597, 9.280238670607403, 8.43495975931485, 8.842444044848278, 7.3331383019685745, 7.902262728661299, 7.676450289785862, 12.240793141225964, 11.851696814099938, 12.686268002415687, 7.924040727317333, 7.939130090177059, 7.75340436398983, 12.031460250417382, 12.475742785880954, 11.30323953429857, 7.742037534092859, 7.777575187695518, 7.559160136928156, 12.788991086184978, 11.98760175704956, 13.106513496953994, 3.430947917203099, 3.4440831790367668, 3.6346536452571456, 4.996624131997422, 5.736375105877713, 4.842427064975098, 12.48769053692618, 12.183514120678097, 12.15521480391422, 6.990178572634846, 7.224668777237326, 7.138573444137961, 8.815003082156181, 8.932539213448763, 8.87206706032157, 18.515583142638206, 18.371765591204166, 18.710576720535755, 4.886023613313824, 4.302854786316544, 4.713346684972436, 13.469880543649197, 13.637893930077553, 13.206041812896729, 7.472984045743942, 7.823154479265213, 7.6479372382164, 6.881234787404537, 6.676508069038391, 6.680797964334488, 7.270103983581066, 7.150974750518799, 7.491219390183687, 17.901850286871195, 17.888273894786835, 17.292533591389656, 6.308099338163927, 6.110310358305767, 6.322341458251074, 13.788067170729235, 13.417121929426983, 13.967175794144467, 21.769212777415902, 22.64599736283222, 22.35261063526073, 5.456000375250966, 5.318988258639962, 5.314161139229924, 9.74599265307188, 9.837665919214487, 9.597515434026718, -4.7062294383843835, -4.199726862212032, -4.087395781030267, 10.965378957490117, 11.430085778857261, 11.16133965800205, 11.807761510213211, 11.725890451421336, 11.005851571758583, 12.847723372280598, 12.732412114739418, 12.93534117564559, 4.427670498689011, 4.2169816767175945, 4.429073331256703, 2.562678001821041, 2.7516997577622533, 1.8959895819425583, 13.409567025800541, 13.68708638225992, 13.728956624244645, 8.028958360354096, 8.577862796063215, 8.627841439718992, 5.954860486090183, 6.341401124373078, 5.679393485188484, 10.782898316780717, 9.49196736017862, 10.703877347211034, 15.00062161932388, 14.58791149655977, 15.402876798684389, 7.311107861498982, 6.556618745128304, 7.438586839164287, 7.251025728881359, 6.447003066539764, 7.018973596394062, 14.017808909217507, 14.297177322829754, 13.693413014213235, 8.498701239625603, 8.677403042713792, 8.850616403544933, 0.0777251074711387, 0.17347684005895303, 0.2840123126904075, 8.635576409598187, 8.128151451547936, 8.742134697114423, 11.404200978577137, 11.651734188199043, 11.614787392318249, 12.749144618709877, 11.972205152114228, 12.854178908591464, 7.286668325463921, 7.647839354972035, 7.658561560014874, 13.298522242655352, 13.11864848186572, 13.327022166301802, 9.137846554319054, 9.084142769376427, 9.36767032990852, 10.207957148551941, 10.477675188332796, 10.021770566701889, 8.120460073153168, 8.515676512072474, 8.227088163296372, 8.578006376822785, 8.600999017556504, 8.695956462373331, 10.16019982099533, 10.351702904328704, 10.369430704042315, 10.971101783060774, 10.46588111420472, 10.432345305879906, 13.267781918247536, 13.212829565008477, 13.69317205374439, 9.572537307937935, 9.240874936183289, 8.934582610925034, 10.532548107827694, 10.352543654541165, 9.987938056389481, 12.487226475030184, 12.575847946107388, 12.210768006742, 9.581468171129615, 9.77691478158036, 9.066868508855492, 11.231519290556506, 11.220202864458159, 10.858574052651718, 11.46247764180103, 11.556903115163237, 11.530723749349505, 15.00413552671671, 15.196454653516412, 14.345949783921242, 3.695979744195938, 3.9135722182691097, 4.00369380787015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.164033151729986, "mean_inference_ms": 0.7253315794610191, "mean_action_processing_ms": 0.1011274811039527, "mean_env_wait_ms": 0.8446769133316069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 383760, "timesteps_this_iter": 0, "agent_timesteps_total": 1151280, "timers": {"sample_time_ms": 21045.165, "sample_throughput": 455.877, "load_time_ms": 0.1, "load_throughput": 95969836.814, "learn_time_ms": 3130.784, "learn_throughput": 3064.408, "update_time_ms": 10.237}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 6.676712214946747, "policy_loss": -0.0020019496487161947, "vf_loss": 6.774095177650452, "vf_explained_var": -1.0, "kl": 0.009584466577535505, "entropy": 9.538524746894836, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 383760, "num_agent_steps_sampled": 1151280, "num_steps_trained": 383760, "num_agent_steps_trained": 1151280, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2066, "training_iteration": 40, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-57-10", "timestamp": 1706191030, "time_this_iter_s": 21.342689990997314, "time_total_s": 832.3980298042297, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 832.3980298042297, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.051612903225807, "ram_util_percent": 46.048387096774185}}
{"episode_reward_max": 66.76782077550885, "episode_reward_min": -12.993352081626682, "episode_reward_mean": 30.401850046548052, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -4.7062294383843835}, "policy_reward_max": {"shared_policy": 22.64599736283222}, "policy_reward_mean": {"shared_policy": 10.133950015516014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.669709566980572, 27.591864875983447, 21.940833289176197, 31.14694713801144, 17.662172943353625, 38.39251905679701, 15.560902582481503, 40.55521459877491, 26.55764247477053, 22.911851320415735, 36.77875795774159, 23.616575181484222, 35.810442570596905, 23.078772858716533, 37.88310634018853, 10.509684741497011, 15.575426302850232, 36.8264194615185, 21.353420794010134, 26.619609355926514, 55.59792545437813, 13.902225084602804, 40.31381628662348, 22.944075763225555, 20.238540820777416, 21.912298124283552, 53.082657773047686, 18.74075115472077, 41.172364894300685, 66.76782077550885, 16.08914977312085, 29.181174006313086, -12.993352081626682, 33.55680439434943, 34.53950353339313, 38.515476662665606, 13.073725506663308, 7.210367341525853, 40.82561003230511, 25.234662596136303, 17.975655095651746, 30.97874302417037, 44.99140991456804, 21.306313445791574, 20.717002391815186, 42.008399246260495, 26.026720685884328, 0.5352142602204992, 25.505862558260546, 34.67072255909443, 37.57552867941557, 22.59306924045083, 39.74419289082287, 27.589659653604002, 30.707402903586626, 24.863224748522015, 25.87496185675262, 30.88133342936635, 31.8693282031454, 40.1737835370004, 27.747994855046258, 30.87302981875834, 37.27384242787957, 28.425251461565466, 33.31029620766638, 34.55010450631377, 44.54653996415436, 11.613245770335197, 24.042643392458544, 26.290705859661074, 52.20195971056819, 46.67619429156183, 34.12455225503069, 29.96757496614009, 27.59744311403483, 26.704717610031352, 22.133331548422547, 35.97364106960592, 28.93619721755384, 29.75345580279827, 13.300244847312541, 41.98003420792517, 63.69758430309592, 40.077842470258446, 47.97102889977393, 22.338199228048325, 36.724080990068614, 47.36554335802791, 31.178923275321722, 52.050615234300494, 37.91562771610914, 30.383946536574484, 31.021490208804593, 47.16940615698692, 25.880501978099318, 38.67199716717005, 21.346561666578026, 34.66564314067364, 34.360930874943705, 34.806080913171144], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.5006389866272514, 2.4202278132239883, 2.7488427671293323, 8.966581657528877, 9.391784026753157, 9.233499191701412, 7.345439771811158, 7.147925066451222, 7.447468450913817, 10.375365016361073, 10.16256596644719, 10.609016155203179, 5.890892381469399, 5.885956856111676, 5.885323705772549, 12.985990693171814, 12.541690667470291, 12.864837696154908, 5.16093859821558, 5.411920914426446, 4.9880430698394775, 13.642232038080692, 13.61149138957262, 13.301491171121597, 9.280238670607403, 8.43495975931485, 8.842444044848278, 7.3331383019685745, 7.902262728661299, 7.676450289785862, 12.240793141225964, 11.851696814099938, 12.686268002415687, 7.924040727317333, 7.939130090177059, 7.75340436398983, 12.031460250417382, 12.475742785880954, 11.30323953429857, 7.742037534092859, 7.777575187695518, 7.559160136928156, 12.788991086184978, 11.98760175704956, 13.106513496953994, 3.430947917203099, 3.4440831790367668, 3.6346536452571456, 4.996624131997422, 5.736375105877713, 4.842427064975098, 12.48769053692618, 12.183514120678097, 12.15521480391422, 6.990178572634846, 7.224668777237326, 7.138573444137961, 8.815003082156181, 8.932539213448763, 8.87206706032157, 18.515583142638206, 18.371765591204166, 18.710576720535755, 4.886023613313824, 4.302854786316544, 4.713346684972436, 13.469880543649197, 13.637893930077553, 13.206041812896729, 7.472984045743942, 7.823154479265213, 7.6479372382164, 6.881234787404537, 6.676508069038391, 6.680797964334488, 7.270103983581066, 7.150974750518799, 7.491219390183687, 17.901850286871195, 17.888273894786835, 17.292533591389656, 6.308099338163927, 6.110310358305767, 6.322341458251074, 13.788067170729235, 13.417121929426983, 13.967175794144467, 21.769212777415902, 22.64599736283222, 22.35261063526073, 5.456000375250966, 5.318988258639962, 5.314161139229924, 9.74599265307188, 9.837665919214487, 9.597515434026718, -4.7062294383843835, -4.199726862212032, -4.087395781030267, 10.965378957490117, 11.430085778857261, 11.16133965800205, 11.807761510213211, 11.725890451421336, 11.005851571758583, 12.847723372280598, 12.732412114739418, 12.93534117564559, 4.427670498689011, 4.2169816767175945, 4.429073331256703, 2.562678001821041, 2.7516997577622533, 1.8959895819425583, 13.409567025800541, 13.68708638225992, 13.728956624244645, 8.028958360354096, 8.577862796063215, 8.627841439718992, 5.954860486090183, 6.341401124373078, 5.679393485188484, 10.782898316780717, 9.49196736017862, 10.703877347211034, 15.00062161932388, 14.58791149655977, 15.402876798684389, 7.311107861498982, 6.556618745128304, 7.438586839164287, 7.251025728881359, 6.447003066539764, 7.018973596394062, 14.017808909217507, 14.297177322829754, 13.693413014213235, 8.498701239625603, 8.677403042713792, 8.850616403544933, 0.0777251074711387, 0.17347684005895303, 0.2840123126904075, 8.635576409598187, 8.128151451547936, 8.742134697114423, 11.404200978577137, 11.651734188199043, 11.614787392318249, 12.749144618709877, 11.972205152114228, 12.854178908591464, 7.286668325463921, 7.647839354972035, 7.658561560014874, 13.298522242655352, 13.11864848186572, 13.327022166301802, 9.137846554319054, 9.084142769376427, 9.36767032990852, 10.207957148551941, 10.477675188332796, 10.021770566701889, 8.120460073153168, 8.515676512072474, 8.227088163296372, 8.578006376822785, 8.600999017556504, 8.695956462373331, 10.16019982099533, 10.351702904328704, 10.369430704042315, 10.971101783060774, 10.46588111420472, 10.432345305879906, 13.267781918247536, 13.212829565008477, 13.69317205374439, 9.572537307937935, 9.240874936183289, 8.934582610925034, 10.532548107827694, 10.352543654541165, 9.987938056389481, 12.487226475030184, 12.575847946107388, 12.210768006742, 9.581468171129615, 9.77691478158036, 9.066868508855492, 11.231519290556506, 11.220202864458159, 10.858574052651718, 11.46247764180103, 11.556903115163237, 11.530723749349505, 15.00413552671671, 15.196454653516412, 14.345949783921242, 3.695979744195938, 3.9135722182691097, 4.00369380787015, 8.07108025376995, 7.878188726802662, 8.093374411885932, 8.548653493324906, 8.976532476643712, 8.765519889692456, 17.44861687719822, 17.67510921880603, 17.078233614563942, 16.069038198639944, 15.349551295240715, 15.257604797681168, 11.316740899036319, 11.367454914997012, 11.440356440997363, 9.980612080544233, 10.237607308663428, 9.74935557693243, 9.503782586194575, 9.433315539732575, 8.660344988107681, 9.162874729682997, 8.915066463251904, 8.626776417096451, 7.388880590597779, 7.121980528036744, 7.622470429788024, 12.332963061208517, 11.864780525366456, 11.775897483030946, 9.858387497564152, 9.292916183670357, 9.78489353631933, 10.139736149460077, 10.164154719561338, 9.449564933776855, 4.2355795676509445, 4.475124264756829, 4.589541014904768, 13.975299420456082, 14.211519323910267, 13.793215463558823, 21.40068885063131, 20.850836281975106, 21.446059170489505, 13.411640151093394, 13.061788770059735, 13.604413549105317, 15.708146716157586, 16.217705920959503, 16.045176262656838, 7.607920605689287, 7.121739208698273, 7.608539413660765, 12.022179499268532, 12.581195476464927, 12.120706014335155, 15.494055474797875, 16.043289030591637, 15.828198852638394, 10.495642587542534, 10.276791021227837, 10.406489666551352, 17.542288763448596, 17.131410971283913, 17.376915499567986, 12.784061857809618, 12.207479511698082, 12.924086346601442, 10.318987686807901, 9.738752740124852, 10.326206109641731, 9.970410962899521, 10.544915565599993, 10.506163680305079, 15.826625968019158, 15.92143406594792, 15.421346123019845, 8.896690296630055, 8.318623999754578, 8.665187681714684, 12.718107171356678, 13.105890594422817, 12.847999401390553, 7.1478918815652435, 7.127272604654223, 7.071397180358559, 11.366867452859879, 11.661146759986877, 11.637628927826881, 11.367783444623143, 11.625754843155534, 11.367392587165028, 11.596095896015555, 11.73042054163912, 11.479564475516469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1637653656353864, "mean_inference_ms": 0.7253212875107955, "mean_action_processing_ms": 0.10108592014614448, "mean_env_wait_ms": 0.8450499525515012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 393354, "timesteps_this_iter": 0, "agent_timesteps_total": 1180062, "timers": {"sample_time_ms": 20912.655, "sample_throughput": 458.765, "load_time_ms": 0.1, "load_throughput": 95969836.814, "learn_time_ms": 3109.869, "learn_throughput": 3085.018, "update_time_ms": 9.737}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 5.599259257316589, "policy_loss": -0.0014579495438031692, "vf_loss": 5.696664035320282, "vf_explained_var": -1.0, "kl": 0.005578006006574869, "entropy": 9.594911456108093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 393354, "num_agent_steps_sampled": 1180062, "num_steps_trained": 393354, "num_agent_steps_trained": 1180062, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2098, "training_iteration": 41, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-57-31", "timestamp": 1706191051, "time_this_iter_s": 20.395899295806885, "time_total_s": 852.7939291000366, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B77DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 852.7939291000366, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.828571428571427, "ram_util_percent": 46.221428571428575}}
{"episode_reward_max": 65.88648379594086, "episode_reward_min": -294.81889321655035, "episode_reward_mean": 30.586143198233323, "episode_len_mean": 297.92, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -104.65112533171973}, "policy_reward_max": {"shared_policy": 22.103620459636048}, "policy_reward_mean": {"shared_policy": 10.19538106607777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.55680439434943, 34.53950353339313, 38.515476662665606, 13.073725506663308, 7.210367341525853, 40.82561003230511, 25.234662596136303, 17.975655095651746, 30.97874302417037, 44.99140991456804, 21.306313445791574, 20.717002391815186, 42.008399246260495, 26.026720685884328, 0.5352142602204992, 25.505862558260546, 34.67072255909443, 37.57552867941557, 22.59306924045083, 39.74419289082287, 27.589659653604002, 30.707402903586626, 24.863224748522015, 25.87496185675262, 30.88133342936635, 31.8693282031454, 40.1737835370004, 27.747994855046258, 30.87302981875834, 37.27384242787957, 28.425251461565466, 33.31029620766638, 34.55010450631377, 44.54653996415436, 11.613245770335197, 24.042643392458544, 26.290705859661074, 52.20195971056819, 46.67619429156183, 34.12455225503069, 29.96757496614009, 27.59744311403483, 26.704717610031352, 22.133331548422547, 35.97364106960592, 28.93619721755384, 29.75345580279827, 13.300244847312541, 41.98003420792517, 63.69758430309592, 40.077842470258446, 47.97102889977393, 22.338199228048325, 36.724080990068614, 47.36554335802791, 31.178923275321722, 52.050615234300494, 37.91562771610914, 30.383946536574484, 31.021490208804593, 47.16940615698692, 25.880501978099318, 38.67199716717005, 21.346561666578026, 34.66564314067364, 34.360930874943705, 34.806080913171144, -294.81889321655035, 20.871199283748837, 48.66702124103904, 32.628251012414665, 40.15098908171058, 33.934912107884884, 51.82687478885052, 31.277830451726913, 50.90248738694933, 41.27039263583717, 44.60998232290146, 11.608018087223158, 35.128549303859444, 27.541674241423593, 33.03843084350227, 14.165530744940028, 49.170867104083285, 65.88648379594086, 38.6386856548488, 46.86140123661606, 47.57674765773115, 23.955598973669083, 45.59572182036936, 33.51510322466491, 41.747060323134036, 30.926841594278798, 51.70695010665803, 38.39153285103383, 57.74951336532828, 38.147618563845754, 24.00417016400023, 31.616712020710096, 35.126377634704085], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 92, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.965378957490117, 11.430085778857261, 11.16133965800205, 11.807761510213211, 11.725890451421336, 11.005851571758583, 12.847723372280598, 12.732412114739418, 12.93534117564559, 4.427670498689011, 4.2169816767175945, 4.429073331256703, 2.562678001821041, 2.7516997577622533, 1.8959895819425583, 13.409567025800541, 13.68708638225992, 13.728956624244645, 8.028958360354096, 8.577862796063215, 8.627841439718992, 5.954860486090183, 6.341401124373078, 5.679393485188484, 10.782898316780717, 9.49196736017862, 10.703877347211034, 15.00062161932388, 14.58791149655977, 15.402876798684389, 7.311107861498982, 6.556618745128304, 7.438586839164287, 7.251025728881359, 6.447003066539764, 7.018973596394062, 14.017808909217507, 14.297177322829754, 13.693413014213235, 8.498701239625603, 8.677403042713792, 8.850616403544933, 0.0777251074711387, 0.17347684005895303, 0.2840123126904075, 8.635576409598187, 8.128151451547936, 8.742134697114423, 11.404200978577137, 11.651734188199043, 11.614787392318249, 12.749144618709877, 11.972205152114228, 12.854178908591464, 7.286668325463921, 7.647839354972035, 7.658561560014874, 13.298522242655352, 13.11864848186572, 13.327022166301802, 9.137846554319054, 9.084142769376427, 9.36767032990852, 10.207957148551941, 10.477675188332796, 10.021770566701889, 8.120460073153168, 8.515676512072474, 8.227088163296372, 8.578006376822785, 8.600999017556504, 8.695956462373331, 10.16019982099533, 10.351702904328704, 10.369430704042315, 10.971101783060774, 10.46588111420472, 10.432345305879906, 13.267781918247536, 13.212829565008477, 13.69317205374439, 9.572537307937935, 9.240874936183289, 8.934582610925034, 10.532548107827694, 10.352543654541165, 9.987938056389481, 12.487226475030184, 12.575847946107388, 12.210768006742, 9.581468171129615, 9.77691478158036, 9.066868508855492, 11.231519290556506, 11.220202864458159, 10.858574052651718, 11.46247764180103, 11.556903115163237, 11.530723749349505, 15.00413552671671, 15.196454653516412, 14.345949783921242, 3.695979744195938, 3.9135722182691097, 4.00369380787015, 8.07108025376995, 7.878188726802662, 8.093374411885932, 8.548653493324906, 8.976532476643712, 8.765519889692456, 17.44861687719822, 17.67510921880603, 17.078233614563942, 16.069038198639944, 15.349551295240715, 15.257604797681168, 11.316740899036319, 11.367454914997012, 11.440356440997363, 9.980612080544233, 10.237607308663428, 9.74935557693243, 9.503782586194575, 9.433315539732575, 8.660344988107681, 9.162874729682997, 8.915066463251904, 8.626776417096451, 7.388880590597779, 7.121980528036744, 7.622470429788024, 12.332963061208517, 11.864780525366456, 11.775897483030946, 9.858387497564152, 9.292916183670357, 9.78489353631933, 10.139736149460077, 10.164154719561338, 9.449564933776855, 4.2355795676509445, 4.475124264756829, 4.589541014904768, 13.975299420456082, 14.211519323910267, 13.793215463558823, 21.40068885063131, 20.850836281975106, 21.446059170489505, 13.411640151093394, 13.061788770059735, 13.604413549105317, 15.708146716157586, 16.217705920959503, 16.045176262656838, 7.607920605689287, 7.121739208698273, 7.608539413660765, 12.022179499268532, 12.581195476464927, 12.120706014335155, 15.494055474797875, 16.043289030591637, 15.828198852638394, 10.495642587542534, 10.276791021227837, 10.406489666551352, 17.542288763448596, 17.131410971283913, 17.376915499567986, 12.784061857809618, 12.207479511698082, 12.924086346601442, 10.318987686807901, 9.738752740124852, 10.326206109641731, 9.970410962899521, 10.544915565599993, 10.506163680305079, 15.826625968019158, 15.92143406594792, 15.421346123019845, 8.896690296630055, 8.318623999754578, 8.665187681714684, 12.718107171356678, 13.105890594422817, 12.847999401390553, 7.1478918815652435, 7.127272604654223, 7.071397180358559, 11.366867452859879, 11.661146759986877, 11.637628927826881, 11.367783444623143, 11.625754843155534, 11.367392587165028, 11.596095896015555, 11.73042054163912, 11.479564475516469, -94.7565199409922, -95.41124794383845, -104.65112533171973, 6.833957249919564, 7.3886554526785915, 6.648586581150681, 15.699747309088707, 16.497418137267232, 16.4698557946831, 10.94579420859614, 11.017837877074868, 10.664618926743657, 13.494782917201519, 13.513526622205973, 13.142679542303085, 11.292152151465416, 11.168655797839165, 11.474104158580303, 17.06595033655563, 17.383577830779046, 17.37734662151584, 10.429985634982586, 10.592878423631191, 10.254966393113136, 16.75923221061626, 16.97910040865341, 17.164154767679662, 13.89153337913254, 13.964173587659985, 13.414685669044644, 14.819373006621987, 14.747062998513371, 15.0435463177661, 4.185275334243968, 4.152195790161684, 3.2705469628175052, 11.652323300639779, 11.455307299892098, 12.020918703327567, 9.329127208640173, 8.86610374351342, 9.346443289269999, 11.34914795433481, 10.75916179021199, 10.930121098955468, 4.832316705336169, 4.69526009013255, 4.63795394947131, 16.37537307788928, 16.0939313819011, 16.701562644292906, 22.06885705639918, 21.714006279905632, 22.103620459636048, 12.616495822866753, 13.118333292504147, 12.9038565394779, 15.560007823010281, 15.873448472780481, 15.427944940825299, 15.77825481692949, 16.057290729756147, 15.74120211104551, 8.21876709877202, 7.737778807679803, 7.999053067217261, 15.0835522711277, 15.245302960276604, 15.266866588965058, 11.04899900903304, 11.108751398821667, 11.357352816810206, 13.726763206223637, 14.060149334991962, 13.960147781918437, 9.817054291566208, 10.645226595302418, 10.464560707410172, 17.22484104832013, 17.279854314712182, 17.202254743625716, 12.988306271804802, 12.789532785614327, 12.6136937936147, 19.148671383659035, 19.320804531375558, 19.28003745029369, 12.492409884929657, 12.816190804354846, 12.83901787456125, 7.7951152523358616, 8.147298876972243, 8.061756034692124, 10.48369551201661, 10.61594990206261, 10.517066606630877, 11.745901639262826, 11.789959828058869, 11.59051616738239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16357541038615545, "mean_inference_ms": 0.7252401980025962, "mean_action_processing_ms": 0.10112899203461374, "mean_env_wait_ms": 0.8451967972994165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 402948, "timesteps_this_iter": 0, "agent_timesteps_total": 1208844, "timers": {"sample_time_ms": 20821.98, "sample_throughput": 460.763, "load_time_ms": 0.1, "load_throughput": 95969836.814, "learn_time_ms": 3108.149, "learn_throughput": 3086.725, "update_time_ms": 9.835}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00043945312500000007, "cur_lr": 0.0005, "total_loss": 53.34782409667969, "policy_loss": -0.0007934101249931352, "vf_loss": 53.44522142410278, "vf_explained_var": -0.07387332618236542, "kl": 0.02054180920825589, "entropy": 9.66130268573761, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 402948, "num_agent_steps_sampled": 1208844, "num_steps_trained": 402948, "num_agent_steps_trained": 1208844, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2131, "training_iteration": 42, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-57-51", "timestamp": 1706191071, "time_this_iter_s": 19.9155011177063, "time_total_s": 872.7094302177429, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01790CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 872.7094302177429, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 7.889655172413794, "ram_util_percent": 45.989655172413784}}
{"episode_reward_max": 70.5727771981619, "episode_reward_min": -298.55700423009694, "episode_reward_mean": 32.77100107721867, "episode_len_mean": 295.73, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -106.60807649294536}, "policy_reward_max": {"shared_policy": 23.72031514175856}, "policy_reward_mean": {"shared_policy": 10.923667025739555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.55010450631377, 44.54653996415436, 11.613245770335197, 24.042643392458544, 26.290705859661074, 52.20195971056819, 46.67619429156183, 34.12455225503069, 29.96757496614009, 27.59744311403483, 26.704717610031352, 22.133331548422547, 35.97364106960592, 28.93619721755384, 29.75345580279827, 13.300244847312541, 41.98003420792517, 63.69758430309592, 40.077842470258446, 47.97102889977393, 22.338199228048325, 36.724080990068614, 47.36554335802791, 31.178923275321722, 52.050615234300494, 37.91562771610914, 30.383946536574484, 31.021490208804593, 47.16940615698692, 25.880501978099318, 38.67199716717005, 21.346561666578026, 34.66564314067364, 34.360930874943705, 34.806080913171144, -294.81889321655035, 20.871199283748837, 48.66702124103904, 32.628251012414665, 40.15098908171058, 33.934912107884884, 51.82687478885052, 31.277830451726913, 50.90248738694933, 41.27039263583717, 44.60998232290146, 11.608018087223158, 35.128549303859444, 27.541674241423593, 33.03843084350227, 14.165530744940028, 49.170867104083285, 65.88648379594086, 38.6386856548488, 46.86140123661606, 47.57674765773115, 23.955598973669083, 45.59572182036936, 33.51510322466491, 41.747060323134036, 30.926841594278798, 51.70695010665803, 38.39153285103383, 57.74951336532828, 38.147618563845754, 24.00417016400023, 31.616712020710096, 35.126377634704085, 33.14497260376811, 29.298898346722112, 56.10885758697984, 31.818103224039064, 59.138296348042786, 70.5727771981619, 67.73816459253429, 52.8703965251334, 34.88028395920992, 35.303744610398994, -298.55700423009694, 40.5364088192582, 30.724426232278333, 55.23369659529996, 50.082757256925106, 55.219561606645556, 47.658053241146234, 54.87647196650502, 41.048829495906816, 35.11768056266007, 54.284586198627935, 42.22400233894585, 43.846802920103045, 41.09233709360706, 62.393122356384964, 55.982698704116046, 63.25210278108716, 53.731897566467524, 33.10557187045923, 35.739750327542424, 43.8152374178171, 33.37739494419655], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 92, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.46247764180103, 11.556903115163237, 11.530723749349505, 15.00413552671671, 15.196454653516412, 14.345949783921242, 3.695979744195938, 3.9135722182691097, 4.00369380787015, 8.07108025376995, 7.878188726802662, 8.093374411885932, 8.548653493324906, 8.976532476643712, 8.765519889692456, 17.44861687719822, 17.67510921880603, 17.078233614563942, 16.069038198639944, 15.349551295240715, 15.257604797681168, 11.316740899036319, 11.367454914997012, 11.440356440997363, 9.980612080544233, 10.237607308663428, 9.74935557693243, 9.503782586194575, 9.433315539732575, 8.660344988107681, 9.162874729682997, 8.915066463251904, 8.626776417096451, 7.388880590597779, 7.121980528036744, 7.622470429788024, 12.332963061208517, 11.864780525366456, 11.775897483030946, 9.858387497564152, 9.292916183670357, 9.78489353631933, 10.139736149460077, 10.164154719561338, 9.449564933776855, 4.2355795676509445, 4.475124264756829, 4.589541014904768, 13.975299420456082, 14.211519323910267, 13.793215463558823, 21.40068885063131, 20.850836281975106, 21.446059170489505, 13.411640151093394, 13.061788770059735, 13.604413549105317, 15.708146716157586, 16.217705920959503, 16.045176262656838, 7.607920605689287, 7.121739208698273, 7.608539413660765, 12.022179499268532, 12.581195476464927, 12.120706014335155, 15.494055474797875, 16.043289030591637, 15.828198852638394, 10.495642587542534, 10.276791021227837, 10.406489666551352, 17.542288763448596, 17.131410971283913, 17.376915499567986, 12.784061857809618, 12.207479511698082, 12.924086346601442, 10.318987686807901, 9.738752740124852, 10.326206109641731, 9.970410962899521, 10.544915565599993, 10.506163680305079, 15.826625968019158, 15.92143406594792, 15.421346123019845, 8.896690296630055, 8.318623999754578, 8.665187681714684, 12.718107171356678, 13.105890594422817, 12.847999401390553, 7.1478918815652435, 7.127272604654223, 7.071397180358559, 11.366867452859879, 11.661146759986877, 11.637628927826881, 11.367783444623143, 11.625754843155534, 11.367392587165028, 11.596095896015555, 11.73042054163912, 11.479564475516469, -94.7565199409922, -95.41124794383845, -104.65112533171973, 6.833957249919564, 7.3886554526785915, 6.648586581150681, 15.699747309088707, 16.497418137267232, 16.4698557946831, 10.94579420859614, 11.017837877074868, 10.664618926743657, 13.494782917201519, 13.513526622205973, 13.142679542303085, 11.292152151465416, 11.168655797839165, 11.474104158580303, 17.06595033655563, 17.383577830779046, 17.37734662151584, 10.429985634982586, 10.592878423631191, 10.254966393113136, 16.75923221061626, 16.97910040865341, 17.164154767679662, 13.89153337913254, 13.964173587659985, 13.414685669044644, 14.819373006621987, 14.747062998513371, 15.0435463177661, 4.185275334243968, 4.152195790161684, 3.2705469628175052, 11.652323300639779, 11.455307299892098, 12.020918703327567, 9.329127208640173, 8.86610374351342, 9.346443289269999, 11.34914795433481, 10.75916179021199, 10.930121098955468, 4.832316705336169, 4.69526009013255, 4.63795394947131, 16.37537307788928, 16.0939313819011, 16.701562644292906, 22.06885705639918, 21.714006279905632, 22.103620459636048, 12.616495822866753, 13.118333292504147, 12.9038565394779, 15.560007823010281, 15.873448472780481, 15.427944940825299, 15.77825481692949, 16.057290729756147, 15.74120211104551, 8.21876709877202, 7.737778807679803, 7.999053067217261, 15.0835522711277, 15.245302960276604, 15.266866588965058, 11.04899900903304, 11.108751398821667, 11.357352816810206, 13.726763206223637, 14.060149334991962, 13.960147781918437, 9.817054291566208, 10.645226595302418, 10.464560707410172, 17.22484104832013, 17.279854314712182, 17.202254743625716, 12.988306271804802, 12.789532785614327, 12.6136937936147, 19.148671383659035, 19.320804531375558, 19.28003745029369, 12.492409884929657, 12.816190804354846, 12.83901787456125, 7.7951152523358616, 8.147298876972243, 8.061756034692124, 10.48369551201661, 10.61594990206261, 10.517066606630877, 11.745901639262826, 11.789959828058869, 11.59051616738239, 11.219921987503767, 10.908035635948181, 11.017014980316162, 9.897247252364949, 9.654043239851788, 9.747607854505375, 18.77511717627445, 18.87194991360107, 18.461790497104317, 10.783155073722199, 10.48938315113385, 10.545564999183014, 19.740035243332386, 19.84695227164775, 19.55130883306265, 23.72031514175856, 23.142759929100663, 23.709702127302677, 22.527053487797573, 22.432615180810288, 22.778495923926428, 17.6999342427589, 17.64392881281674, 17.526533469557762, 11.864823251962662, 11.584853455424309, 11.430607251822948, 11.16247098644574, 12.236736507465437, 11.904537116487816, -96.42970564464729, -106.60807649294536, -95.51922209250431, 13.542373293389872, 13.463207577665642, 13.530827948202685, 10.297566709419087, 10.537535419066742, 9.889324103792504, 18.553135412434727, 17.84103741745153, 18.839523765413702, 16.2850538790226, 17.069336153566837, 16.72836722433567, 18.463490052769572, 18.3901508587102, 18.365920695165784, 15.923152120706305, 15.7993259380261, 15.935575182413828, 17.846828321615845, 18.5836132193605, 18.446030425528676, 13.73040031207104, 13.637348697831229, 13.681080486004547, 11.712999428311974, 12.047312521065265, 11.35736861328283, 18.049741735061005, 18.09381128599246, 18.14103317757447, 13.464365442593888, 14.343940680225685, 14.415696216126278, 14.616588833431393, 14.618636327485234, 14.611577759186417, 13.780952749133576, 13.637569887563586, 13.673814456909895, 20.7622662509481, 20.808838135252387, 20.822017970184476, 18.775040794163942, 18.27928003668785, 18.928377873264253, 21.085202176123857, 21.03512755036354, 21.131773054599762, 17.91016675531864, 18.12248731032014, 17.699243500828743, 11.098520987744749, 10.91371927907069, 11.09333160364379, 11.90815557911992, 11.861370477825403, 11.9702242705971, 14.887670633693531, 14.8693584476908, 14.05820833643277, 11.162054872916386, 11.185877255707354, 11.029462815572813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16328290124566663, "mean_inference_ms": 0.7246236083953183, "mean_action_processing_ms": 0.10104253458879989, "mean_env_wait_ms": 0.8445492939695532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 412542, "timesteps_this_iter": 0, "agent_timesteps_total": 1237626, "timers": {"sample_time_ms": 20769.542, "sample_throughput": 461.926, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3097.915, "learn_throughput": 3096.922, "update_time_ms": 9.841}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.0005, "total_loss": 54.21263790130615, "policy_loss": -0.00046332652131914065, "vf_loss": 54.30879735946655, "vf_explained_var": -0.056510597467422485, "kl": 0.020991741723294537, "entropy": 9.571036696434021, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412542, "num_agent_steps_sampled": 1237626, "num_steps_trained": 412542, "num_agent_steps_trained": 1237626, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2163, "training_iteration": 43, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-58-11", "timestamp": 1706191091, "time_this_iter_s": 20.281186819076538, "time_total_s": 892.9906170368195, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41AA1700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 892.9906170368195, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.675, "ram_util_percent": 46.103571428571435}}
{"episode_reward_max": 74.75221378356218, "episode_reward_min": -298.55700423009694, "episode_reward_mean": 37.792934190206424, "episode_len_mean": 295.73, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -106.60807649294536}, "policy_reward_max": {"shared_policy": 25.265968285501003}, "policy_reward_mean": {"shared_policy": 12.597644730068804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.360930874943705, 34.806080913171144, -294.81889321655035, 20.871199283748837, 48.66702124103904, 32.628251012414665, 40.15098908171058, 33.934912107884884, 51.82687478885052, 31.277830451726913, 50.90248738694933, 41.27039263583717, 44.60998232290146, 11.608018087223158, 35.128549303859444, 27.541674241423593, 33.03843084350227, 14.165530744940028, 49.170867104083285, 65.88648379594086, 38.6386856548488, 46.86140123661606, 47.57674765773115, 23.955598973669083, 45.59572182036936, 33.51510322466491, 41.747060323134036, 30.926841594278798, 51.70695010665803, 38.39153285103383, 57.74951336532828, 38.147618563845754, 24.00417016400023, 31.616712020710096, 35.126377634704085, 33.14497260376811, 29.298898346722112, 56.10885758697984, 31.818103224039064, 59.138296348042786, 70.5727771981619, 67.73816459253429, 52.8703965251334, 34.88028395920992, 35.303744610398994, -298.55700423009694, 40.5364088192582, 30.724426232278333, 55.23369659529996, 50.082757256925106, 55.219561606645556, 47.658053241146234, 54.87647196650502, 41.048829495906816, 35.11768056266007, 54.284586198627935, 42.22400233894585, 43.846802920103045, 41.09233709360706, 62.393122356384964, 55.982698704116046, 63.25210278108716, 53.731897566467524, 33.10557187045923, 35.739750327542424, 43.8152374178171, 33.37739494419655, 60.679770806804285, 45.16543597076085, 49.59933929145336, 37.67056598328051, 74.75221378356218, 65.64464830979702, 42.3226294876076, 40.936166084604324, 63.058615332935005, 72.42503224126992, 57.4567825011909, 37.90637490898371, 39.63901253044604, 48.578404000028954, 52.95118280686435, 42.84363480843601, 39.19943195953965, 41.87057750672102, 47.915951892733545, 42.5283271949738, 49.899928295984864, 32.82358609512447, 52.36071062278643, 47.993711952120066, 47.74022376164791, 50.31262089358643, 73.76204645633698, 39.609014682471724, 61.66805804776959, 41.1272075716406, 42.38764197751877, 50.30130331963299, 47.91473868396132], "episode_lengths": [300, 300, 92, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.367783444623143, 11.625754843155534, 11.367392587165028, 11.596095896015555, 11.73042054163912, 11.479564475516469, -94.7565199409922, -95.41124794383845, -104.65112533171973, 6.833957249919564, 7.3886554526785915, 6.648586581150681, 15.699747309088707, 16.497418137267232, 16.4698557946831, 10.94579420859614, 11.017837877074868, 10.664618926743657, 13.494782917201519, 13.513526622205973, 13.142679542303085, 11.292152151465416, 11.168655797839165, 11.474104158580303, 17.06595033655563, 17.383577830779046, 17.37734662151584, 10.429985634982586, 10.592878423631191, 10.254966393113136, 16.75923221061626, 16.97910040865341, 17.164154767679662, 13.89153337913254, 13.964173587659985, 13.414685669044644, 14.819373006621987, 14.747062998513371, 15.0435463177661, 4.185275334243968, 4.152195790161684, 3.2705469628175052, 11.652323300639779, 11.455307299892098, 12.020918703327567, 9.329127208640173, 8.86610374351342, 9.346443289269999, 11.34914795433481, 10.75916179021199, 10.930121098955468, 4.832316705336169, 4.69526009013255, 4.63795394947131, 16.37537307788928, 16.0939313819011, 16.701562644292906, 22.06885705639918, 21.714006279905632, 22.103620459636048, 12.616495822866753, 13.118333292504147, 12.9038565394779, 15.560007823010281, 15.873448472780481, 15.427944940825299, 15.77825481692949, 16.057290729756147, 15.74120211104551, 8.21876709877202, 7.737778807679803, 7.999053067217261, 15.0835522711277, 15.245302960276604, 15.266866588965058, 11.04899900903304, 11.108751398821667, 11.357352816810206, 13.726763206223637, 14.060149334991962, 13.960147781918437, 9.817054291566208, 10.645226595302418, 10.464560707410172, 17.22484104832013, 17.279854314712182, 17.202254743625716, 12.988306271804802, 12.789532785614327, 12.6136937936147, 19.148671383659035, 19.320804531375558, 19.28003745029369, 12.492409884929657, 12.816190804354846, 12.83901787456125, 7.7951152523358616, 8.147298876972243, 8.061756034692124, 10.48369551201661, 10.61594990206261, 10.517066606630877, 11.745901639262826, 11.789959828058869, 11.59051616738239, 11.219921987503767, 10.908035635948181, 11.017014980316162, 9.897247252364949, 9.654043239851788, 9.747607854505375, 18.77511717627445, 18.87194991360107, 18.461790497104317, 10.783155073722199, 10.48938315113385, 10.545564999183014, 19.740035243332386, 19.84695227164775, 19.55130883306265, 23.72031514175856, 23.142759929100663, 23.709702127302677, 22.527053487797573, 22.432615180810288, 22.778495923926428, 17.6999342427589, 17.64392881281674, 17.526533469557762, 11.864823251962662, 11.584853455424309, 11.430607251822948, 11.16247098644574, 12.236736507465437, 11.904537116487816, -96.42970564464729, -106.60807649294536, -95.51922209250431, 13.542373293389872, 13.463207577665642, 13.530827948202685, 10.297566709419087, 10.537535419066742, 9.889324103792504, 18.553135412434727, 17.84103741745153, 18.839523765413702, 16.2850538790226, 17.069336153566837, 16.72836722433567, 18.463490052769572, 18.3901508587102, 18.365920695165784, 15.923152120706305, 15.7993259380261, 15.935575182413828, 17.846828321615845, 18.5836132193605, 18.446030425528676, 13.73040031207104, 13.637348697831229, 13.681080486004547, 11.712999428311974, 12.047312521065265, 11.35736861328283, 18.049741735061005, 18.09381128599246, 18.14103317757447, 13.464365442593888, 14.343940680225685, 14.415696216126278, 14.616588833431393, 14.618636327485234, 14.611577759186417, 13.780952749133576, 13.637569887563586, 13.673814456909895, 20.7622662509481, 20.808838135252387, 20.822017970184476, 18.775040794163942, 18.27928003668785, 18.928377873264253, 21.085202176123857, 21.03512755036354, 21.131773054599762, 17.91016675531864, 18.12248731032014, 17.699243500828743, 11.098520987744749, 10.91371927907069, 11.09333160364379, 11.90815557911992, 11.861370477825403, 11.9702242705971, 14.887670633693531, 14.8693584476908, 14.05820833643277, 11.162054872916386, 11.185877255707354, 11.029462815572813, 19.926567529638604, 20.036213253935173, 20.716990023230508, 14.872945154706628, 15.152982090289385, 15.139508725764841, 16.634389497339725, 16.69479213654995, 16.270157657563686, 12.425798239807278, 12.417609381179005, 12.827158362294227, 24.7197098582983, 25.265968285501003, 24.76653563976288, 21.77720909068981, 21.771888854602963, 22.09555036450425, 13.93328523884216, 14.348086089982331, 14.041258158783108, 13.353610028823212, 14.004049804604918, 13.578506251176194, 20.93588189035654, 20.77067919820547, 21.352054244372994, 24.162852820629865, 24.21064158032337, 24.051537840316684, 19.080956920981407, 19.078130170702934, 19.29769540950656, 12.645260609686375, 12.582145176827908, 12.678969122469425, 13.377627139290169, 12.925596689184502, 13.335788701971367, 16.25772310358782, 16.04406566297014, 16.27661523347099, 17.41256522635618, 17.71408090988794, 17.824536670620233, 14.373265559474618, 14.51926774221161, 13.95110150674978, 13.159394323825836, 13.059354018419981, 12.980683617293835, 13.871577054262161, 14.104230485856533, 13.894769966602325, 15.486475522319466, 16.200004531691462, 16.229471838722617, 14.136633830765874, 14.578884006167442, 13.812809358040482, 16.745462326332927, 16.482851311564445, 16.671614658087492, 11.07986332972844, 10.984841660906866, 10.758881104489163, 17.439807750284672, 17.76494026374712, 17.155962608754635, 15.678495712578297, 16.071447491645813, 16.243768747895956, 15.94310342023769, 15.724314662317425, 16.072805679092795, 16.409398049116135, 17.11212395178154, 16.79109889268875, 24.39999819546938, 24.677285196259618, 24.684763064607978, 13.024253855148942, 13.31544806311527, 13.269312764207513, 20.836088622687384, 20.364461451768875, 20.46750797331333, 13.945001467441514, 13.62432500471671, 13.557881099482373, 14.044301035503537, 14.1078220779697, 14.235518864045531, 16.757631083329514, 16.944314916928604, 16.599357319374874, 15.806710613270596, 15.932009653498724, 16.176018417191997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.162974034822511, "mean_inference_ms": 0.7241212641641641, "mean_action_processing_ms": 0.10101695174932104, "mean_env_wait_ms": 0.8439642263518803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 422136, "timesteps_this_iter": 0, "agent_timesteps_total": 1266408, "timers": {"sample_time_ms": 20572.254, "sample_throughput": 466.356, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3102.472, "learn_throughput": 3092.373, "update_time_ms": 9.98}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009887695312500002, "cur_lr": 0.0005, "total_loss": 6.013621687889099, "policy_loss": -0.001556465322170797, "vf_loss": 6.109779059886932, "vf_explained_var": -0.6924296468496323, "kl": 0.0051420281379559955, "entropy": 9.460600852966309, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 422136, "num_agent_steps_sampled": 1266408, "num_steps_trained": 422136, "num_agent_steps_trained": 1266408, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2196, "training_iteration": 44, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-58-31", "timestamp": 1706191111, "time_this_iter_s": 20.33368158340454, "time_total_s": 913.324298620224, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 913.324298620224, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 9.062068965517241, "ram_util_percent": 46.21379310344828}}
{"episode_reward_max": 74.75221378356218, "episode_reward_min": -298.55700423009694, "episode_reward_mean": 42.8365029065781, "episode_len_mean": 297.81, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -106.60807649294536}, "policy_reward_max": {"shared_policy": 25.265968285501003}, "policy_reward_mean": {"shared_policy": 14.278834302192694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.74951336532828, 38.147618563845754, 24.00417016400023, 31.616712020710096, 35.126377634704085, 33.14497260376811, 29.298898346722112, 56.10885758697984, 31.818103224039064, 59.138296348042786, 70.5727771981619, 67.73816459253429, 52.8703965251334, 34.88028395920992, 35.303744610398994, -298.55700423009694, 40.5364088192582, 30.724426232278333, 55.23369659529996, 50.082757256925106, 55.219561606645556, 47.658053241146234, 54.87647196650502, 41.048829495906816, 35.11768056266007, 54.284586198627935, 42.22400233894585, 43.846802920103045, 41.09233709360706, 62.393122356384964, 55.982698704116046, 63.25210278108716, 53.731897566467524, 33.10557187045923, 35.739750327542424, 43.8152374178171, 33.37739494419655, 60.679770806804285, 45.16543597076085, 49.59933929145336, 37.67056598328051, 74.75221378356218, 65.64464830979702, 42.3226294876076, 40.936166084604324, 63.058615332935005, 72.42503224126992, 57.4567825011909, 37.90637490898371, 39.63901253044604, 48.578404000028954, 52.95118280686435, 42.84363480843601, 39.19943195953965, 41.87057750672102, 47.915951892733545, 42.5283271949738, 49.899928295984864, 32.82358609512447, 52.36071062278643, 47.993711952120066, 47.74022376164791, 50.31262089358643, 73.76204645633698, 39.609014682471724, 61.66805804776959, 41.1272075716406, 42.38764197751877, 50.30130331963299, 47.91473868396132, 52.92851525917649, 47.352517162915305, 24.350729303434477, 29.3174791559577, 48.639492973685265, 34.18939134478566, 45.77458372712135, 43.17006251215935, 50.62770087271929, 12.858201775699854, 34.699788115918636, 40.2069569863379, 40.69846693426368, 67.83029097504912, 30.38082812167704, 54.87827633321284, 49.32179280370471, 41.57108581811187, 53.76175920618698, 62.32045689225194, 65.24435674306004, 45.00703177787361, 29.800415176898227, 40.59545703791079, 59.898034393787356, 61.60443901270628, 20.698393540456863, 54.20791209326126, 46.39396410062909, 21.97174793481824], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 81, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.148671383659035, 19.320804531375558, 19.28003745029369, 12.492409884929657, 12.816190804354846, 12.83901787456125, 7.7951152523358616, 8.147298876972243, 8.061756034692124, 10.48369551201661, 10.61594990206261, 10.517066606630877, 11.745901639262826, 11.789959828058869, 11.59051616738239, 11.219921987503767, 10.908035635948181, 11.017014980316162, 9.897247252364949, 9.654043239851788, 9.747607854505375, 18.77511717627445, 18.87194991360107, 18.461790497104317, 10.783155073722199, 10.48938315113385, 10.545564999183014, 19.740035243332386, 19.84695227164775, 19.55130883306265, 23.72031514175856, 23.142759929100663, 23.709702127302677, 22.527053487797573, 22.432615180810288, 22.778495923926428, 17.6999342427589, 17.64392881281674, 17.526533469557762, 11.864823251962662, 11.584853455424309, 11.430607251822948, 11.16247098644574, 12.236736507465437, 11.904537116487816, -96.42970564464729, -106.60807649294536, -95.51922209250431, 13.542373293389872, 13.463207577665642, 13.530827948202685, 10.297566709419087, 10.537535419066742, 9.889324103792504, 18.553135412434727, 17.84103741745153, 18.839523765413702, 16.2850538790226, 17.069336153566837, 16.72836722433567, 18.463490052769572, 18.3901508587102, 18.365920695165784, 15.923152120706305, 15.7993259380261, 15.935575182413828, 17.846828321615845, 18.5836132193605, 18.446030425528676, 13.73040031207104, 13.637348697831229, 13.681080486004547, 11.712999428311974, 12.047312521065265, 11.35736861328283, 18.049741735061005, 18.09381128599246, 18.14103317757447, 13.464365442593888, 14.343940680225685, 14.415696216126278, 14.616588833431393, 14.618636327485234, 14.611577759186417, 13.780952749133576, 13.637569887563586, 13.673814456909895, 20.7622662509481, 20.808838135252387, 20.822017970184476, 18.775040794163942, 18.27928003668785, 18.928377873264253, 21.085202176123857, 21.03512755036354, 21.131773054599762, 17.91016675531864, 18.12248731032014, 17.699243500828743, 11.098520987744749, 10.91371927907069, 11.09333160364379, 11.90815557911992, 11.861370477825403, 11.9702242705971, 14.887670633693531, 14.8693584476908, 14.05820833643277, 11.162054872916386, 11.185877255707354, 11.029462815572813, 19.926567529638604, 20.036213253935173, 20.716990023230508, 14.872945154706628, 15.152982090289385, 15.139508725764841, 16.634389497339725, 16.69479213654995, 16.270157657563686, 12.425798239807278, 12.417609381179005, 12.827158362294227, 24.7197098582983, 25.265968285501003, 24.76653563976288, 21.77720909068981, 21.771888854602963, 22.09555036450425, 13.93328523884216, 14.348086089982331, 14.041258158783108, 13.353610028823212, 14.004049804604918, 13.578506251176194, 20.93588189035654, 20.77067919820547, 21.352054244372994, 24.162852820629865, 24.21064158032337, 24.051537840316684, 19.080956920981407, 19.078130170702934, 19.29769540950656, 12.645260609686375, 12.582145176827908, 12.678969122469425, 13.377627139290169, 12.925596689184502, 13.335788701971367, 16.25772310358782, 16.04406566297014, 16.27661523347099, 17.41256522635618, 17.71408090988794, 17.824536670620233, 14.373265559474618, 14.51926774221161, 13.95110150674978, 13.159394323825836, 13.059354018419981, 12.980683617293835, 13.871577054262161, 14.104230485856533, 13.894769966602325, 15.486475522319466, 16.200004531691462, 16.229471838722617, 14.136633830765874, 14.578884006167442, 13.812809358040482, 16.745462326332927, 16.482851311564445, 16.671614658087492, 11.07986332972844, 10.984841660906866, 10.758881104489163, 17.439807750284672, 17.76494026374712, 17.155962608754635, 15.678495712578297, 16.071447491645813, 16.243768747895956, 15.94310342023769, 15.724314662317425, 16.072805679092795, 16.409398049116135, 17.11212395178154, 16.79109889268875, 24.39999819546938, 24.677285196259618, 24.684763064607978, 13.024253855148942, 13.31544806311527, 13.269312764207513, 20.836088622687384, 20.364461451768875, 20.46750797331333, 13.945001467441514, 13.62432500471671, 13.557881099482373, 14.044301035503537, 14.1078220779697, 14.235518864045531, 16.757631083329514, 16.944314916928604, 16.599357319374874, 15.806710613270596, 15.932009653498724, 16.176018417191997, 17.513037241995335, 17.797591529786587, 17.61788648739457, 15.63253942628701, 15.980746703998491, 15.739231032629803, 8.22198287521799, 8.226349446301654, 7.902396981914833, 10.078588731586933, 9.111544907093048, 10.127345517277718, 16.217693097889423, 16.168383665382862, 16.25341621041298, 11.40948939571777, 11.528703192869813, 11.251198756198079, 15.515836670994759, 14.959788143634796, 15.298958912491798, 14.617770284414291, 14.299007326364517, 14.253284901380539, 16.960518062114716, 16.831045895814896, 16.836136914789677, 4.34754479303956, 4.123459510505199, 4.387197472155094, 11.448437467217445, 11.704197011888027, 11.547153636813164, 13.47909750789404, 13.272247672080994, 13.455611806362867, 13.554217933366687, 13.723243853698165, 13.421005147198827, 22.302657683690384, 22.763346900542572, 22.764286390816167, 10.03400469571352, 9.92130583524704, 10.425517590716481, 18.35754421477516, 18.305849851419524, 18.214882267018154, 16.588814391444117, 16.576975530634314, 16.15600288162628, 13.724595169226319, 14.156034934024007, 13.690455714861542, 17.728737600147724, 17.825456976890564, 18.207564629148692, 20.53535712758699, 20.866358409325272, 20.918741355339677, 21.89943645925571, 21.763345220436648, 21.58157506336768, 14.778035166362912, 15.253246766204626, 14.97574984530607, 10.015878481169537, 10.04771341507633, 9.73682328065236, 13.429455811778695, 13.74056835534671, 13.425432870785386, 19.926589880759508, 19.988851290817053, 19.982593222210795, 20.214634709060192, 20.59195740520954, 20.797846898436546, 6.444966639081628, 7.12322027857104, 7.130206622804195, 18.06504748761654, 17.8243737667799, 18.318490838864818, 15.565503660589457, 15.480006106197834, 15.3484543338418, 7.152775260309369, 7.385998773078114, 7.432973901430756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16274067796763103, "mean_inference_ms": 0.7238857217244365, "mean_action_processing_ms": 0.10099544124127974, "mean_env_wait_ms": 0.8434768173516018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 431730, "timesteps_this_iter": 0, "agent_timesteps_total": 1295190, "timers": {"sample_time_ms": 20606.373, "sample_throughput": 465.584, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3105.049, "learn_throughput": 3089.806, "update_time_ms": 10.036}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009887695312500002, "cur_lr": 0.0005, "total_loss": 6.013079464435577, "policy_loss": -0.0017670062296857858, "vf_loss": 6.1104207038879395, "vf_explained_var": -0.5181573331356049, "kl": 0.004009198295567239, "entropy": 9.557827591896057, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 431730, "num_agent_steps_sampled": 1295190, "num_steps_trained": 431730, "num_agent_steps_trained": 1295190, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2226, "training_iteration": 45, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-58-52", "timestamp": 1706191132, "time_this_iter_s": 20.533283233642578, "time_total_s": 933.8575818538666, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB1DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 933.8575818538666, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.779310344827586, "ram_util_percent": 46.324137931034485}}
{"episode_reward_max": 74.75221378356218, "episode_reward_min": 12.858201775699854, "episode_reward_mean": 46.65575023269703, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": 4.123459510505199}, "policy_reward_max": {"shared_policy": 25.265968285501003}, "policy_reward_mean": {"shared_policy": 15.551916744232336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.739750327542424, 43.8152374178171, 33.37739494419655, 60.679770806804285, 45.16543597076085, 49.59933929145336, 37.67056598328051, 74.75221378356218, 65.64464830979702, 42.3226294876076, 40.936166084604324, 63.058615332935005, 72.42503224126992, 57.4567825011909, 37.90637490898371, 39.63901253044604, 48.578404000028954, 52.95118280686435, 42.84363480843601, 39.19943195953965, 41.87057750672102, 47.915951892733545, 42.5283271949738, 49.899928295984864, 32.82358609512447, 52.36071062278643, 47.993711952120066, 47.74022376164791, 50.31262089358643, 73.76204645633698, 39.609014682471724, 61.66805804776959, 41.1272075716406, 42.38764197751877, 50.30130331963299, 47.91473868396132, 52.92851525917649, 47.352517162915305, 24.350729303434477, 29.3174791559577, 48.639492973685265, 34.18939134478566, 45.77458372712135, 43.17006251215935, 50.62770087271929, 12.858201775699854, 34.699788115918636, 40.2069569863379, 40.69846693426368, 67.83029097504912, 30.38082812167704, 54.87827633321284, 49.32179280370471, 41.57108581811187, 53.76175920618698, 62.32045689225194, 65.24435674306004, 45.00703177787361, 29.800415176898227, 40.59545703791079, 59.898034393787356, 61.60443901270628, 20.698393540456863, 54.20791209326126, 46.39396410062909, 21.97174793481824, 49.484898183407466, 59.21761455945668, 40.77731108292936, 54.56721628503874, 58.1498562209308, 31.644299227744312, 31.16738210991025, 62.84536871314047, 54.59975966438651, 34.963303717784555, 42.06105029210447, 27.78527073748407, 60.69310995191336, 48.919758047908516, 48.56700937263665, 58.52360823005435, 35.34775207191703, 52.5835696160793, 43.69115735590458, 49.83533184975386, 41.741041245171786, 34.91321875154971, 62.63031497597693, 44.72720700129864, 57.67437994852661, 35.01140662655233, 38.891498202225165, 58.31545798480509, 64.10882206773384, 45.09050035849212, 37.900853745639296, 48.141746446490274, 51.60567681491375, 35.12087127193807], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.90815557911992, 11.861370477825403, 11.9702242705971, 14.887670633693531, 14.8693584476908, 14.05820833643277, 11.162054872916386, 11.185877255707354, 11.029462815572813, 19.926567529638604, 20.036213253935173, 20.716990023230508, 14.872945154706628, 15.152982090289385, 15.139508725764841, 16.634389497339725, 16.69479213654995, 16.270157657563686, 12.425798239807278, 12.417609381179005, 12.827158362294227, 24.7197098582983, 25.265968285501003, 24.76653563976288, 21.77720909068981, 21.771888854602963, 22.09555036450425, 13.93328523884216, 14.348086089982331, 14.041258158783108, 13.353610028823212, 14.004049804604918, 13.578506251176194, 20.93588189035654, 20.77067919820547, 21.352054244372994, 24.162852820629865, 24.21064158032337, 24.051537840316684, 19.080956920981407, 19.078130170702934, 19.29769540950656, 12.645260609686375, 12.582145176827908, 12.678969122469425, 13.377627139290169, 12.925596689184502, 13.335788701971367, 16.25772310358782, 16.04406566297014, 16.27661523347099, 17.41256522635618, 17.71408090988794, 17.824536670620233, 14.373265559474618, 14.51926774221161, 13.95110150674978, 13.159394323825836, 13.059354018419981, 12.980683617293835, 13.871577054262161, 14.104230485856533, 13.894769966602325, 15.486475522319466, 16.200004531691462, 16.229471838722617, 14.136633830765874, 14.578884006167442, 13.812809358040482, 16.745462326332927, 16.482851311564445, 16.671614658087492, 11.07986332972844, 10.984841660906866, 10.758881104489163, 17.439807750284672, 17.76494026374712, 17.155962608754635, 15.678495712578297, 16.071447491645813, 16.243768747895956, 15.94310342023769, 15.724314662317425, 16.072805679092795, 16.409398049116135, 17.11212395178154, 16.79109889268875, 24.39999819546938, 24.677285196259618, 24.684763064607978, 13.024253855148942, 13.31544806311527, 13.269312764207513, 20.836088622687384, 20.364461451768875, 20.46750797331333, 13.945001467441514, 13.62432500471671, 13.557881099482373, 14.044301035503537, 14.1078220779697, 14.235518864045531, 16.757631083329514, 16.944314916928604, 16.599357319374874, 15.806710613270596, 15.932009653498724, 16.176018417191997, 17.513037241995335, 17.797591529786587, 17.61788648739457, 15.63253942628701, 15.980746703998491, 15.739231032629803, 8.22198287521799, 8.226349446301654, 7.902396981914833, 10.078588731586933, 9.111544907093048, 10.127345517277718, 16.217693097889423, 16.168383665382862, 16.25341621041298, 11.40948939571777, 11.528703192869813, 11.251198756198079, 15.515836670994759, 14.959788143634796, 15.298958912491798, 14.617770284414291, 14.299007326364517, 14.253284901380539, 16.960518062114716, 16.831045895814896, 16.836136914789677, 4.34754479303956, 4.123459510505199, 4.387197472155094, 11.448437467217445, 11.704197011888027, 11.547153636813164, 13.47909750789404, 13.272247672080994, 13.455611806362867, 13.554217933366687, 13.723243853698165, 13.421005147198827, 22.302657683690384, 22.763346900542572, 22.764286390816167, 10.03400469571352, 9.92130583524704, 10.425517590716481, 18.35754421477516, 18.305849851419524, 18.214882267018154, 16.588814391444117, 16.576975530634314, 16.15600288162628, 13.724595169226319, 14.156034934024007, 13.690455714861542, 17.728737600147724, 17.825456976890564, 18.207564629148692, 20.53535712758699, 20.866358409325272, 20.918741355339677, 21.89943645925571, 21.763345220436648, 21.58157506336768, 14.778035166362912, 15.253246766204626, 14.97574984530607, 10.015878481169537, 10.04771341507633, 9.73682328065236, 13.429455811778695, 13.74056835534671, 13.425432870785386, 19.926589880759508, 19.988851290817053, 19.982593222210795, 20.214634709060192, 20.59195740520954, 20.797846898436546, 6.444966639081628, 7.12322027857104, 7.130206622804195, 18.06504748761654, 17.8243737667799, 18.318490838864818, 15.565503660589457, 15.480006106197834, 15.3484543338418, 7.152775260309369, 7.385998773078114, 7.432973901430756, 16.358989896873624, 16.392686674992234, 16.73322161154161, 19.730681019524724, 19.914010108138115, 19.57292343179384, 13.506997016568974, 13.602146369715527, 13.668167696644858, 17.990953385829926, 18.44530911790207, 18.130953781306744, 19.639985245962933, 19.076881130536393, 19.432989844431475, 10.694303466627986, 10.5405668268601, 10.409428934256226, 10.541198846884072, 10.518212809227407, 10.107970453798771, 21.004162204762295, 20.89901167651017, 20.942194831868008, 17.971429511904716, 18.23731730133295, 18.391012851148844, 11.518513681987912, 11.58339888850847, 11.861391147288174, 14.19359117125471, 14.120037121077374, 13.747421999772385, 9.84873151468733, 8.99566204349199, 8.94087717930475, 20.206529654562473, 20.115504942834377, 20.371075354516506, 16.20462184647718, 16.345397698382527, 16.369738503048808, 16.398386421302945, 16.33405985000232, 15.834563101331383, 19.5180710616211, 19.665936215470225, 19.339600952963025, 11.820230255524308, 11.76438323656717, 11.76313857982555, 17.616972653816134, 17.414785558978707, 17.55181140328446, 14.338550291955471, 14.466574996709824, 14.886032067239285, 16.32700376212597, 16.773064024746418, 16.73526406288147, 13.999771821855873, 13.862624415506914, 13.878645007808998, 11.464773138364151, 11.799799894293145, 11.64864571889241, 20.933641915520028, 20.924199124177292, 20.77247393627961, 14.958609531323106, 14.601689989368111, 15.16690748060742, 19.2986029771467, 19.273611364265278, 19.102165607114628, 11.748462763925389, 11.844758966316775, 11.418184896310166, 12.718448522190243, 13.30003308916153, 12.873016590873391, 19.331478421886757, 19.485502076645687, 19.498477486272648, 20.913415124018982, 21.628581992195294, 21.566824951519564, 14.76799977322419, 14.95772325744231, 15.364777327825621, 12.589961207161338, 12.624888150642306, 12.686004387835652, 16.170675077786044, 15.892991324265793, 16.078080044438437, 17.04749582707882, 17.170853190124035, 17.387327797710896, 11.894435485204056, 11.86617563789089, 11.360260148843125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16258452646851176, "mean_inference_ms": 0.7241186532773063, "mean_action_processing_ms": 0.10103388347068719, "mean_env_wait_ms": 0.8431029620607475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 441324, "timesteps_this_iter": 0, "agent_timesteps_total": 1323972, "timers": {"sample_time_ms": 20637.58, "sample_throughput": 464.88, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3092.891, "learn_throughput": 3101.952, "update_time_ms": 9.429}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004943847656250001, "cur_lr": 0.0005, "total_loss": 5.198668539524078, "policy_loss": -0.0019830736330095355, "vf_loss": 5.296423494815826, "vf_explained_var": -0.5525408387184143, "kl": 0.0052829189226356365, "entropy": 9.577438831329346, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 441324, "num_agent_steps_sampled": 1323972, "num_steps_trained": 441324, "num_agent_steps_trained": 1323972, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2260, "training_iteration": 46, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-59-13", "timestamp": 1706191153, "time_this_iter_s": 20.716703414916992, "time_total_s": 954.5742852687836, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB1790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 954.5742852687836, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 8.640000000000002, "ram_util_percent": 46.523333333333326}}
{"episode_reward_max": 79.55116943269965, "episode_reward_min": 12.858201775699854, "episode_reward_mean": 47.01355544713703, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 4.123459510505199}, "policy_reward_max": {"shared_policy": 26.618416572610528}, "policy_reward_mean": {"shared_policy": 15.671185149045675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.609014682471724, 61.66805804776959, 41.1272075716406, 42.38764197751877, 50.30130331963299, 47.91473868396132, 52.92851525917649, 47.352517162915305, 24.350729303434477, 29.3174791559577, 48.639492973685265, 34.18939134478566, 45.77458372712135, 43.17006251215935, 50.62770087271929, 12.858201775699854, 34.699788115918636, 40.2069569863379, 40.69846693426368, 67.83029097504912, 30.38082812167704, 54.87827633321284, 49.32179280370471, 41.57108581811187, 53.76175920618698, 62.32045689225194, 65.24435674306004, 45.00703177787361, 29.800415176898227, 40.59545703791079, 59.898034393787356, 61.60443901270628, 20.698393540456863, 54.20791209326126, 46.39396410062909, 21.97174793481824, 49.484898183407466, 59.21761455945668, 40.77731108292936, 54.56721628503874, 58.1498562209308, 31.644299227744312, 31.16738210991025, 62.84536871314047, 54.59975966438651, 34.963303717784555, 42.06105029210447, 27.78527073748407, 60.69310995191336, 48.919758047908516, 48.56700937263665, 58.52360823005435, 35.34775207191703, 52.5835696160793, 43.69115735590458, 49.83533184975386, 41.741041245171786, 34.91321875154971, 62.63031497597693, 44.72720700129864, 57.67437994852661, 35.01140662655233, 38.891498202225165, 58.31545798480509, 64.10882206773384, 45.09050035849212, 37.900853745639296, 48.141746446490274, 51.60567681491375, 35.12087127193807, 41.36673544673248, 43.57571293413636, 50.03095513954757, 56.7053354065865, 43.13842214643954, 52.07118778862058, 39.94468849152325, 51.01522534852846, 48.96868003532289, 79.55116943269965, 39.52145583182572, 46.13960801344362, 43.53182566538453, 37.40652222931385, 63.55345261748879, 54.55012354440986, 52.72761003300545, 32.31198266893625, 56.15507613867521, 64.89443720504642, 49.536373499780865, 50.79969341866672, 41.03388620913029, 57.71915819915009, 54.091527264565215, 53.15584888961165, 56.2434662133455, 41.12881447188555, 59.13145809993148, 46.74939722940326], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.024253855148942, 13.31544806311527, 13.269312764207513, 20.836088622687384, 20.364461451768875, 20.46750797331333, 13.945001467441514, 13.62432500471671, 13.557881099482373, 14.044301035503537, 14.1078220779697, 14.235518864045531, 16.757631083329514, 16.944314916928604, 16.599357319374874, 15.806710613270596, 15.932009653498724, 16.176018417191997, 17.513037241995335, 17.797591529786587, 17.61788648739457, 15.63253942628701, 15.980746703998491, 15.739231032629803, 8.22198287521799, 8.226349446301654, 7.902396981914833, 10.078588731586933, 9.111544907093048, 10.127345517277718, 16.217693097889423, 16.168383665382862, 16.25341621041298, 11.40948939571777, 11.528703192869813, 11.251198756198079, 15.515836670994759, 14.959788143634796, 15.298958912491798, 14.617770284414291, 14.299007326364517, 14.253284901380539, 16.960518062114716, 16.831045895814896, 16.836136914789677, 4.34754479303956, 4.123459510505199, 4.387197472155094, 11.448437467217445, 11.704197011888027, 11.547153636813164, 13.47909750789404, 13.272247672080994, 13.455611806362867, 13.554217933366687, 13.723243853698165, 13.421005147198827, 22.302657683690384, 22.763346900542572, 22.764286390816167, 10.03400469571352, 9.92130583524704, 10.425517590716481, 18.35754421477516, 18.305849851419524, 18.214882267018154, 16.588814391444117, 16.576975530634314, 16.15600288162628, 13.724595169226319, 14.156034934024007, 13.690455714861542, 17.728737600147724, 17.825456976890564, 18.207564629148692, 20.53535712758699, 20.866358409325272, 20.918741355339677, 21.89943645925571, 21.763345220436648, 21.58157506336768, 14.778035166362912, 15.253246766204626, 14.97574984530607, 10.015878481169537, 10.04771341507633, 9.73682328065236, 13.429455811778695, 13.74056835534671, 13.425432870785386, 19.926589880759508, 19.988851290817053, 19.982593222210795, 20.214634709060192, 20.59195740520954, 20.797846898436546, 6.444966639081628, 7.12322027857104, 7.130206622804195, 18.06504748761654, 17.8243737667799, 18.318490838864818, 15.565503660589457, 15.480006106197834, 15.3484543338418, 7.152775260309369, 7.385998773078114, 7.432973901430756, 16.358989896873624, 16.392686674992234, 16.73322161154161, 19.730681019524724, 19.914010108138115, 19.57292343179384, 13.506997016568974, 13.602146369715527, 13.668167696644858, 17.990953385829926, 18.44530911790207, 18.130953781306744, 19.639985245962933, 19.076881130536393, 19.432989844431475, 10.694303466627986, 10.5405668268601, 10.409428934256226, 10.541198846884072, 10.518212809227407, 10.107970453798771, 21.004162204762295, 20.89901167651017, 20.942194831868008, 17.971429511904716, 18.23731730133295, 18.391012851148844, 11.518513681987912, 11.58339888850847, 11.861391147288174, 14.19359117125471, 14.120037121077374, 13.747421999772385, 9.84873151468733, 8.99566204349199, 8.94087717930475, 20.206529654562473, 20.115504942834377, 20.371075354516506, 16.20462184647718, 16.345397698382527, 16.369738503048808, 16.398386421302945, 16.33405985000232, 15.834563101331383, 19.5180710616211, 19.665936215470225, 19.339600952963025, 11.820230255524308, 11.76438323656717, 11.76313857982555, 17.616972653816134, 17.414785558978707, 17.55181140328446, 14.338550291955471, 14.466574996709824, 14.886032067239285, 16.32700376212597, 16.773064024746418, 16.73526406288147, 13.999771821855873, 13.862624415506914, 13.878645007808998, 11.464773138364151, 11.799799894293145, 11.64864571889241, 20.933641915520028, 20.924199124177292, 20.77247393627961, 14.958609531323106, 14.601689989368111, 15.16690748060742, 19.2986029771467, 19.273611364265278, 19.102165607114628, 11.748462763925389, 11.844758966316775, 11.418184896310166, 12.718448522190243, 13.30003308916153, 12.873016590873391, 19.331478421886757, 19.485502076645687, 19.498477486272648, 20.913415124018982, 21.628581992195294, 21.566824951519564, 14.76799977322419, 14.95772325744231, 15.364777327825621, 12.589961207161338, 12.624888150642306, 12.686004387835652, 16.170675077786044, 15.892991324265793, 16.078080044438437, 17.04749582707882, 17.170853190124035, 17.387327797710896, 11.894435485204056, 11.86617563789089, 11.360260148843125, 13.642671537895993, 14.00818561095123, 13.715878297885254, 14.441532439241797, 14.597421877707035, 14.53675861718753, 16.86399145921071, 16.509081115325287, 16.657882565011576, 19.101242643470556, 19.00054023290673, 18.603552530209214, 14.366302502652005, 14.48694211741288, 14.285177526374653, 17.058981527884796, 17.65404968646665, 17.35815657426913, 13.313923751314476, 13.187266824146107, 13.443497916062668, 16.94569946577151, 16.807165530820683, 17.262360351936266, 16.216519226630524, 16.375102320065096, 16.37705848862727, 26.329302082459122, 26.618416572610528, 26.60345077763, 13.288351909567908, 13.2810363334914, 12.952067588766411, 15.516320337230951, 15.079637105266244, 15.543650570946426, 14.530508279800415, 14.754716496914625, 14.24660088866949, 12.277231901884079, 12.387587331235409, 12.741702996194363, 21.315366391402975, 21.080830072363213, 21.1572561537226, 17.922368330260113, 18.404351651047662, 18.22340356310208, 17.472708048919827, 17.4492759729425, 17.80562601114312, 10.64666909724474, 10.673744097352028, 10.991569474339485, 18.606154397130013, 18.56765441596508, 18.98126732558012, 21.54082501679659, 21.566611774265766, 21.78700041398406, 16.705812624345214, 16.19365660349527, 16.63690427194038, 16.95202924311161, 16.841550059616566, 17.006114115938544, 13.62156943231821, 13.63296639919281, 13.779350377619267, 19.02349681655565, 19.285967723156006, 19.40969365943843, 18.119327304263905, 17.772214104731873, 18.199985855569437, 17.241951142748192, 17.731891115506485, 18.18200663135697, 18.344844381014497, 18.861742640535027, 19.036879191795975, 13.671710801621273, 13.53507825483878, 13.922025415425495, 19.796109676361084, 19.599834337830544, 19.73551408573985, 15.638773743063211, 15.344376474618912, 15.766247011721134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16253976348043836, "mean_inference_ms": 0.7245271825076308, "mean_action_processing_ms": 0.10105343264799886, "mean_env_wait_ms": 0.8428667223546117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 450918, "timesteps_this_iter": 0, "agent_timesteps_total": 1352754, "timers": {"sample_time_ms": 20628.834, "sample_throughput": 465.077, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3097.865, "learn_throughput": 3096.971, "update_time_ms": 9.428}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004943847656250001, "cur_lr": 0.0005, "total_loss": 5.5207802057266235, "policy_loss": -0.0010970090851574743, "vf_loss": 5.618257224559784, "vf_explained_var": -0.3817458897829056, "kl": 0.005813625844926697, "entropy": 9.6383056640625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 450918, "num_agent_steps_sampled": 1352754, "num_steps_trained": 450918, "num_agent_steps_trained": 1352754, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2290, "training_iteration": 47, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-59-34", "timestamp": 1706191174, "time_this_iter_s": 20.930277109146118, "time_total_s": 975.5045623779297, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 975.5045623779297, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.506896551724136, "ram_util_percent": 46.47931034482759}}
{"episode_reward_max": 79.55116943269965, "episode_reward_min": 21.97174793481824, "episode_reward_mean": 49.575096858771566, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 7.152775260309369}, "policy_reward_max": {"shared_policy": 26.618416572610528}, "policy_reward_mean": {"shared_policy": 16.525032286257186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.20791209326126, 46.39396410062909, 21.97174793481824, 49.484898183407466, 59.21761455945668, 40.77731108292936, 54.56721628503874, 58.1498562209308, 31.644299227744312, 31.16738210991025, 62.84536871314047, 54.59975966438651, 34.963303717784555, 42.06105029210447, 27.78527073748407, 60.69310995191336, 48.919758047908516, 48.56700937263665, 58.52360823005435, 35.34775207191703, 52.5835696160793, 43.69115735590458, 49.83533184975386, 41.741041245171786, 34.91321875154971, 62.63031497597693, 44.72720700129864, 57.67437994852661, 35.01140662655233, 38.891498202225165, 58.31545798480509, 64.10882206773384, 45.09050035849212, 37.900853745639296, 48.141746446490274, 51.60567681491375, 35.12087127193807, 41.36673544673248, 43.57571293413636, 50.03095513954757, 56.7053354065865, 43.13842214643954, 52.07118778862058, 39.94468849152325, 51.01522534852846, 48.96868003532289, 79.55116943269965, 39.52145583182572, 46.13960801344362, 43.53182566538453, 37.40652222931385, 63.55345261748879, 54.55012354440986, 52.72761003300545, 32.31198266893625, 56.15507613867521, 64.89443720504642, 49.536373499780865, 50.79969341866672, 41.03388620913029, 57.71915819915009, 54.091527264565215, 53.15584888961165, 56.2434662133455, 41.12881447188555, 59.13145809993148, 46.74939722940326, 44.36604938283563, 46.65905186906457, 48.094061844050856, 51.31159174628553, 64.72034028172493, 49.282670157030196, 61.27433104068041, 34.66184572502968, 66.20091547816989, 59.54954016208646, 61.75527536123988, 38.754419582895935, 53.387676082551465, 70.22816192358731, 52.36113560944793, 58.57418791949746, 49.11605849489567, 49.788076213328154, 46.58030420728028, 35.94126129895449, 46.64377664774656, 54.039735712110996, 35.418216796591864, 49.460775714367614, 52.579206105321646, 34.97647109627722, 43.755296939983964, 60.44013879075645, 54.57321006804705, 75.66308053955436, 47.06859107874334, 56.660192430019364, 73.00296310335395], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.06504748761654, 17.8243737667799, 18.318490838864818, 15.565503660589457, 15.480006106197834, 15.3484543338418, 7.152775260309369, 7.385998773078114, 7.432973901430756, 16.358989896873624, 16.392686674992234, 16.73322161154161, 19.730681019524724, 19.914010108138115, 19.57292343179384, 13.506997016568974, 13.602146369715527, 13.668167696644858, 17.990953385829926, 18.44530911790207, 18.130953781306744, 19.639985245962933, 19.076881130536393, 19.432989844431475, 10.694303466627986, 10.5405668268601, 10.409428934256226, 10.541198846884072, 10.518212809227407, 10.107970453798771, 21.004162204762295, 20.89901167651017, 20.942194831868008, 17.971429511904716, 18.23731730133295, 18.391012851148844, 11.518513681987912, 11.58339888850847, 11.861391147288174, 14.19359117125471, 14.120037121077374, 13.747421999772385, 9.84873151468733, 8.99566204349199, 8.94087717930475, 20.206529654562473, 20.115504942834377, 20.371075354516506, 16.20462184647718, 16.345397698382527, 16.369738503048808, 16.398386421302945, 16.33405985000232, 15.834563101331383, 19.5180710616211, 19.665936215470225, 19.339600952963025, 11.820230255524308, 11.76438323656717, 11.76313857982555, 17.616972653816134, 17.414785558978707, 17.55181140328446, 14.338550291955471, 14.466574996709824, 14.886032067239285, 16.32700376212597, 16.773064024746418, 16.73526406288147, 13.999771821855873, 13.862624415506914, 13.878645007808998, 11.464773138364151, 11.799799894293145, 11.64864571889241, 20.933641915520028, 20.924199124177292, 20.77247393627961, 14.958609531323106, 14.601689989368111, 15.16690748060742, 19.2986029771467, 19.273611364265278, 19.102165607114628, 11.748462763925389, 11.844758966316775, 11.418184896310166, 12.718448522190243, 13.30003308916153, 12.873016590873391, 19.331478421886757, 19.485502076645687, 19.498477486272648, 20.913415124018982, 21.628581992195294, 21.566824951519564, 14.76799977322419, 14.95772325744231, 15.364777327825621, 12.589961207161338, 12.624888150642306, 12.686004387835652, 16.170675077786044, 15.892991324265793, 16.078080044438437, 17.04749582707882, 17.170853190124035, 17.387327797710896, 11.894435485204056, 11.86617563789089, 11.360260148843125, 13.642671537895993, 14.00818561095123, 13.715878297885254, 14.441532439241797, 14.597421877707035, 14.53675861718753, 16.86399145921071, 16.509081115325287, 16.657882565011576, 19.101242643470556, 19.00054023290673, 18.603552530209214, 14.366302502652005, 14.48694211741288, 14.285177526374653, 17.058981527884796, 17.65404968646665, 17.35815657426913, 13.313923751314476, 13.187266824146107, 13.443497916062668, 16.94569946577151, 16.807165530820683, 17.262360351936266, 16.216519226630524, 16.375102320065096, 16.37705848862727, 26.329302082459122, 26.618416572610528, 26.60345077763, 13.288351909567908, 13.2810363334914, 12.952067588766411, 15.516320337230951, 15.079637105266244, 15.543650570946426, 14.530508279800415, 14.754716496914625, 14.24660088866949, 12.277231901884079, 12.387587331235409, 12.741702996194363, 21.315366391402975, 21.080830072363213, 21.1572561537226, 17.922368330260113, 18.404351651047662, 18.22340356310208, 17.472708048919827, 17.4492759729425, 17.80562601114312, 10.64666909724474, 10.673744097352028, 10.991569474339485, 18.606154397130013, 18.56765441596508, 18.98126732558012, 21.54082501679659, 21.566611774265766, 21.78700041398406, 16.705812624345214, 16.19365660349527, 16.63690427194038, 16.95202924311161, 16.841550059616566, 17.006114115938544, 13.62156943231821, 13.63296639919281, 13.779350377619267, 19.02349681655565, 19.285967723156006, 19.40969365943843, 18.119327304263905, 17.772214104731873, 18.199985855569437, 17.241951142748192, 17.731891115506485, 18.18200663135697, 18.344844381014497, 18.861742640535027, 19.036879191795975, 13.671710801621273, 13.53507825483878, 13.922025415425495, 19.796109676361084, 19.599834337830544, 19.73551408573985, 15.638773743063211, 15.344376474618912, 15.766247011721134, 14.666984729468822, 14.636202841997147, 15.062861811369658, 15.534635335206985, 15.361030176281929, 15.763386357575655, 15.74923929075399, 16.17686543862024, 16.167957114676625, 16.898077274362237, 17.173790163050086, 17.239724308873207, 21.825235567986965, 21.082781076431274, 21.81232363730669, 16.696925413484365, 16.369093003372342, 16.21665174017349, 20.43531994521618, 20.217059396207333, 20.621951699256897, 11.62352259332934, 11.69281621525684, 11.345506916443497, 21.8554315889875, 22.07138219724098, 22.27410169194141, 19.98453953365484, 20.007593008379132, 19.557407620052487, 20.694961494455725, 20.542383103320986, 20.51793076346317, 12.68832965940237, 12.842557720839977, 13.223532202653587, 17.829586328317717, 17.606950556238488, 17.95113919799526, 23.28305685271819, 23.475250539680317, 23.4698545311888, 17.455563972393662, 17.431204522649438, 17.474367114404828, 19.1909112582604, 19.638227278987557, 19.745049382249505, 16.29062386105457, 16.52004554743567, 16.305389086405427, 16.63284598787625, 16.15297122796376, 17.00225899748814, 15.166591838002205, 15.734677923843265, 15.679034445434809, 12.036365250125527, 12.042927777394652, 11.861968271434307, 15.548097185790539, 15.613170593976974, 15.48250886797905, 18.060050135478377, 18.07464332692325, 17.905042249709368, 11.92994795305033, 11.650139731665448, 11.838129111876086, 16.528106701870755, 16.666892261554793, 16.265776750942067, 17.57065511867404, 17.370262887328863, 17.638288099318743, 11.681562063594654, 11.74029830594857, 11.554610726733998, 14.589044611901045, 14.664820173755288, 14.501432154327631, 20.0221088429292, 20.349773475279406, 20.068256472547844, 18.059981986880302, 18.08655671775341, 18.426671363413334, 25.26179076731205, 25.26547109335661, 25.1358186788857, 15.62177737802267, 15.825503399595618, 15.62131030112505, 18.972956965987876, 18.992826081191495, 18.694409382839993, 24.30174688498178, 24.23996667067209, 24.461249547700078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16242292853510187, "mean_inference_ms": 0.7248569237987164, "mean_action_processing_ms": 0.10112419354232494, "mean_env_wait_ms": 0.8424948365632625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 460512, "timesteps_this_iter": 0, "agent_timesteps_total": 1381536, "timers": {"sample_time_ms": 20673.835, "sample_throughput": 464.065, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3113.351, "learn_throughput": 3081.567, "update_time_ms": 9.528}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004943847656250001, "cur_lr": 0.0005, "total_loss": 5.6464802622795105, "policy_loss": -0.0017163643098566037, "vf_loss": 5.7460068464279175, "vf_explained_var": -0.2881262004375458, "kl": 0.005444091148128137, "entropy": 9.781322002410889, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460512, "num_agent_steps_sampled": 1381536, "num_steps_trained": 460512, "num_agent_steps_trained": 1381536, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2323, "training_iteration": 48, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_14-59-55", "timestamp": 1706191195, "time_this_iter_s": 21.20299220085144, "time_total_s": 996.7075545787811, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B7B820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 996.7075545787811, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 8.74, "ram_util_percent": 46.559999999999995}}
{"episode_reward_max": 79.55116943269965, "episode_reward_min": 7.3346088044345095, "episode_reward_mean": 50.8296537405817, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 2.2860577503840034}, "policy_reward_max": {"shared_policy": 26.738136340243116}, "policy_reward_mean": {"shared_policy": 16.94321791352723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.900853745639296, 48.141746446490274, 51.60567681491375, 35.12087127193807, 41.36673544673248, 43.57571293413636, 50.03095513954757, 56.7053354065865, 43.13842214643954, 52.07118778862058, 39.94468849152325, 51.01522534852846, 48.96868003532289, 79.55116943269965, 39.52145583182572, 46.13960801344362, 43.53182566538453, 37.40652222931385, 63.55345261748879, 54.55012354440986, 52.72761003300545, 32.31198266893625, 56.15507613867521, 64.89443720504642, 49.536373499780865, 50.79969341866672, 41.03388620913029, 57.71915819915009, 54.091527264565215, 53.15584888961165, 56.2434662133455, 41.12881447188555, 59.13145809993148, 46.74939722940326, 44.36604938283563, 46.65905186906457, 48.094061844050856, 51.31159174628553, 64.72034028172493, 49.282670157030196, 61.27433104068041, 34.66184572502968, 66.20091547816989, 59.54954016208646, 61.75527536123988, 38.754419582895935, 53.387676082551465, 70.22816192358731, 52.36113560944793, 58.57418791949746, 49.11605849489567, 49.788076213328154, 46.58030420728028, 35.94126129895449, 46.64377664774656, 54.039735712110996, 35.418216796591864, 49.460775714367614, 52.579206105321646, 34.97647109627722, 43.755296939983964, 60.44013879075645, 54.57321006804705, 75.66308053955436, 47.06859107874334, 56.660192430019364, 73.00296310335395, 55.44720840454099, 57.72210705745965, 61.71649379562584, 39.04335139691827, 48.17210369370878, 7.3346088044345095, 61.56531967967747, 51.41206994652745, 37.244432978332014, 51.318327100947485, 73.06233766255899, 54.252115111798034, 50.77147139795122, 38.357206481508896, 28.43520202487707, 57.831014063209295, 45.939290047681396, 56.647310148924575, 19.197766609489918, 48.02903645113108, 50.627718470990644, 50.677213840186596, 46.14716500043866, 64.5255860793404, 47.24004849046466, 45.81114914827046, 44.500185376731665, 65.50763670913875, 79.54483306314795, 48.000953208655105, 64.89340780116615, 63.73895790055394, 61.84415881615132], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.589961207161338, 12.624888150642306, 12.686004387835652, 16.170675077786044, 15.892991324265793, 16.078080044438437, 17.04749582707882, 17.170853190124035, 17.387327797710896, 11.894435485204056, 11.86617563789089, 11.360260148843125, 13.642671537895993, 14.00818561095123, 13.715878297885254, 14.441532439241797, 14.597421877707035, 14.53675861718753, 16.86399145921071, 16.509081115325287, 16.657882565011576, 19.101242643470556, 19.00054023290673, 18.603552530209214, 14.366302502652005, 14.48694211741288, 14.285177526374653, 17.058981527884796, 17.65404968646665, 17.35815657426913, 13.313923751314476, 13.187266824146107, 13.443497916062668, 16.94569946577151, 16.807165530820683, 17.262360351936266, 16.216519226630524, 16.375102320065096, 16.37705848862727, 26.329302082459122, 26.618416572610528, 26.60345077763, 13.288351909567908, 13.2810363334914, 12.952067588766411, 15.516320337230951, 15.079637105266244, 15.543650570946426, 14.530508279800415, 14.754716496914625, 14.24660088866949, 12.277231901884079, 12.387587331235409, 12.741702996194363, 21.315366391402975, 21.080830072363213, 21.1572561537226, 17.922368330260113, 18.404351651047662, 18.22340356310208, 17.472708048919827, 17.4492759729425, 17.80562601114312, 10.64666909724474, 10.673744097352028, 10.991569474339485, 18.606154397130013, 18.56765441596508, 18.98126732558012, 21.54082501679659, 21.566611774265766, 21.78700041398406, 16.705812624345214, 16.19365660349527, 16.63690427194038, 16.95202924311161, 16.841550059616566, 17.006114115938544, 13.62156943231821, 13.63296639919281, 13.779350377619267, 19.02349681655565, 19.285967723156006, 19.40969365943843, 18.119327304263905, 17.772214104731873, 18.199985855569437, 17.241951142748192, 17.731891115506485, 18.18200663135697, 18.344844381014497, 18.861742640535027, 19.036879191795975, 13.671710801621273, 13.53507825483878, 13.922025415425495, 19.796109676361084, 19.599834337830544, 19.73551408573985, 15.638773743063211, 15.344376474618912, 15.766247011721134, 14.666984729468822, 14.636202841997147, 15.062861811369658, 15.534635335206985, 15.361030176281929, 15.763386357575655, 15.74923929075399, 16.17686543862024, 16.167957114676625, 16.898077274362237, 17.173790163050086, 17.239724308873207, 21.825235567986965, 21.082781076431274, 21.81232363730669, 16.696925413484365, 16.369093003372342, 16.21665174017349, 20.43531994521618, 20.217059396207333, 20.621951699256897, 11.62352259332934, 11.69281621525684, 11.345506916443497, 21.8554315889875, 22.07138219724098, 22.27410169194141, 19.98453953365484, 20.007593008379132, 19.557407620052487, 20.694961494455725, 20.542383103320986, 20.51793076346317, 12.68832965940237, 12.842557720839977, 13.223532202653587, 17.829586328317717, 17.606950556238488, 17.95113919799526, 23.28305685271819, 23.475250539680317, 23.4698545311888, 17.455563972393662, 17.431204522649438, 17.474367114404828, 19.1909112582604, 19.638227278987557, 19.745049382249505, 16.29062386105457, 16.52004554743567, 16.305389086405427, 16.63284598787625, 16.15297122796376, 17.00225899748814, 15.166591838002205, 15.734677923843265, 15.679034445434809, 12.036365250125527, 12.042927777394652, 11.861968271434307, 15.548097185790539, 15.613170593976974, 15.48250886797905, 18.060050135478377, 18.07464332692325, 17.905042249709368, 11.92994795305033, 11.650139731665448, 11.838129111876086, 16.528106701870755, 16.666892261554793, 16.265776750942067, 17.57065511867404, 17.370262887328863, 17.638288099318743, 11.681562063594654, 11.74029830594857, 11.554610726733998, 14.589044611901045, 14.664820173755288, 14.501432154327631, 20.0221088429292, 20.349773475279406, 20.068256472547844, 18.059981986880302, 18.08655671775341, 18.426671363413334, 25.26179076731205, 25.26547109335661, 25.1358186788857, 15.62177737802267, 15.825503399595618, 15.62131030112505, 18.972956965987876, 18.992826081191495, 18.694409382839993, 24.30174688498178, 24.23996667067209, 24.461249547700078, 18.340183349947125, 18.586659620205552, 18.52036543438831, 19.193317912518978, 19.481700350530446, 19.04708879441023, 20.734254074903816, 20.286047304670006, 20.696192416052014, 12.891629333297402, 12.952605071167142, 13.199116992453725, 15.86691501736641, 16.068923000246286, 16.23626567609608, 2.2860577503840034, 2.6380613433817928, 2.4104897106687133, 20.590039518972233, 20.404666689534977, 20.57061347117026, 17.13731604317823, 16.990234876672417, 17.284519026676804, 12.547033975521714, 12.37515543277064, 12.32224357003966, 17.204598025729254, 16.81910865505536, 17.29462042016287, 24.43403853413959, 24.475776432858154, 24.152522695561245, 17.873536018033818, 18.16652329669644, 18.212055797067777, 16.695467213789613, 17.226650667066366, 16.84935351709524, 12.694625859459236, 12.370874290664986, 13.291706331384674, 9.415531657636166, 9.292239859700203, 9.727430507540703, 19.318554148077965, 19.446386199444532, 19.066073715686798, 15.136550838748605, 15.11698170254627, 15.685757506386523, 19.073596728344754, 19.060731717695788, 18.512981702884034, 6.284783773124218, 6.3998060412704945, 6.513176795095205, 16.05631887416044, 15.758807654182107, 16.21390992278853, 16.866491479178265, 17.090104599793747, 16.67112239201863, 17.048805698752403, 16.51601393520832, 17.112394206225872, 15.4546219545106, 15.521608001242072, 15.17093504468599, 21.50307858331749, 21.543487028374017, 21.479020467648894, 16.05647315333286, 15.979550863305718, 15.204024473826081, 15.396807769934327, 15.101149062315613, 15.313192316020519, 14.676789422829941, 15.026346467512965, 14.797049486388758, 21.835589345544577, 21.810696694999933, 21.86135066859424, 26.484263231356934, 26.322433491547898, 26.738136340243116, 16.003905345996216, 16.167500929286078, 15.82954693337281, 21.634133190537483, 21.542221608261258, 21.717053002367408, 20.941100262105465, 21.33913091570139, 21.458726722747087, 20.635322902351618, 20.66919187735766, 20.53964403644204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16238484330222336, "mean_inference_ms": 0.7252936145620749, "mean_action_processing_ms": 0.10121241219750317, "mean_env_wait_ms": 0.8423560160951107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 470106, "timesteps_this_iter": 0, "agent_timesteps_total": 1410318, "timers": {"sample_time_ms": 20672.695, "sample_throughput": 464.09, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3123.111, "learn_throughput": 3071.937, "update_time_ms": 9.428}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004943847656250001, "cur_lr": 0.0005, "total_loss": 5.2187424302101135, "policy_loss": -0.0009908735138726976, "vf_loss": 5.318723678588867, "vf_explained_var": -0.2901689410209656, "kl": 0.005733637401172826, "entropy": 9.899316668510437, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 470106, "num_agent_steps_sampled": 1410318, "num_steps_trained": 470106, "num_agent_steps_trained": 1410318, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2356, "training_iteration": 49, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-00-16", "timestamp": 1706191216, "time_this_iter_s": 20.84057092666626, "time_total_s": 1017.5481255054474, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0045F550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1017.5481255054474, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 9.059999999999999, "ram_util_percent": 46.72333333333334}}
{"episode_reward_max": 79.54483306314795, "episode_reward_min": 7.3346088044345095, "episode_reward_mean": 50.30675106526876, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 2.2860577503840034}, "policy_reward_max": {"shared_policy": 26.738136340243116}, "policy_reward_mean": {"shared_policy": 16.76891702175625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.12881447188555, 59.13145809993148, 46.74939722940326, 44.36604938283563, 46.65905186906457, 48.094061844050856, 51.31159174628553, 64.72034028172493, 49.282670157030196, 61.27433104068041, 34.66184572502968, 66.20091547816989, 59.54954016208646, 61.75527536123988, 38.754419582895935, 53.387676082551465, 70.22816192358731, 52.36113560944793, 58.57418791949746, 49.11605849489567, 49.788076213328154, 46.58030420728028, 35.94126129895449, 46.64377664774656, 54.039735712110996, 35.418216796591864, 49.460775714367614, 52.579206105321646, 34.97647109627722, 43.755296939983964, 60.44013879075645, 54.57321006804705, 75.66308053955436, 47.06859107874334, 56.660192430019364, 73.00296310335395, 55.44720840454099, 57.72210705745965, 61.71649379562584, 39.04335139691827, 48.17210369370878, 7.3346088044345095, 61.56531967967747, 51.41206994652745, 37.244432978332014, 51.318327100947485, 73.06233766255899, 54.252115111798034, 50.77147139795122, 38.357206481508896, 28.43520202487707, 57.831014063209295, 45.939290047681396, 56.647310148924575, 19.197766609489918, 48.02903645113108, 50.627718470990644, 50.677213840186596, 46.14716500043866, 64.5255860793404, 47.24004849046466, 45.81114914827046, 44.500185376731665, 65.50763670913875, 79.54483306314795, 48.000953208655105, 64.89340780116615, 63.73895790055394, 61.84415881615132, 56.25659212097524, 34.71003052964804, 58.87800389528273, 37.31858829362318, 52.41246860800311, 48.59875847399233, 37.58125810697673, 48.30608853325248, 60.023070525377975, 55.30791060347107, 48.133258778601856, 44.32824818859807, 42.811953179538236, 46.66445368900892, 46.530688183382125, 49.200859561562524, 63.63777832686898, 38.55059426650402, 56.32214150088839, 44.734586847946034, 56.275613747537136, 59.45017522200942, 37.39554589614269, 29.913636319804937, 40.183785665780306, 50.659147471189485, 52.7191936802119, 36.09633432887493, 51.54995452612637, 46.9330117572099, 48.73530973121524], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.671710801621273, 13.53507825483878, 13.922025415425495, 19.796109676361084, 19.599834337830544, 19.73551408573985, 15.638773743063211, 15.344376474618912, 15.766247011721134, 14.666984729468822, 14.636202841997147, 15.062861811369658, 15.534635335206985, 15.361030176281929, 15.763386357575655, 15.74923929075399, 16.17686543862024, 16.167957114676625, 16.898077274362237, 17.173790163050086, 17.239724308873207, 21.825235567986965, 21.082781076431274, 21.81232363730669, 16.696925413484365, 16.369093003372342, 16.21665174017349, 20.43531994521618, 20.217059396207333, 20.621951699256897, 11.62352259332934, 11.69281621525684, 11.345506916443497, 21.8554315889875, 22.07138219724098, 22.27410169194141, 19.98453953365484, 20.007593008379132, 19.557407620052487, 20.694961494455725, 20.542383103320986, 20.51793076346317, 12.68832965940237, 12.842557720839977, 13.223532202653587, 17.829586328317717, 17.606950556238488, 17.95113919799526, 23.28305685271819, 23.475250539680317, 23.4698545311888, 17.455563972393662, 17.431204522649438, 17.474367114404828, 19.1909112582604, 19.638227278987557, 19.745049382249505, 16.29062386105457, 16.52004554743567, 16.305389086405427, 16.63284598787625, 16.15297122796376, 17.00225899748814, 15.166591838002205, 15.734677923843265, 15.679034445434809, 12.036365250125527, 12.042927777394652, 11.861968271434307, 15.548097185790539, 15.613170593976974, 15.48250886797905, 18.060050135478377, 18.07464332692325, 17.905042249709368, 11.92994795305033, 11.650139731665448, 11.838129111876086, 16.528106701870755, 16.666892261554793, 16.265776750942067, 17.57065511867404, 17.370262887328863, 17.638288099318743, 11.681562063594654, 11.74029830594857, 11.554610726733998, 14.589044611901045, 14.664820173755288, 14.501432154327631, 20.0221088429292, 20.349773475279406, 20.068256472547844, 18.059981986880302, 18.08655671775341, 18.426671363413334, 25.26179076731205, 25.26547109335661, 25.1358186788857, 15.62177737802267, 15.825503399595618, 15.62131030112505, 18.972956965987876, 18.992826081191495, 18.694409382839993, 24.30174688498178, 24.23996667067209, 24.461249547700078, 18.340183349947125, 18.586659620205552, 18.52036543438831, 19.193317912518978, 19.481700350530446, 19.04708879441023, 20.734254074903816, 20.286047304670006, 20.696192416052014, 12.891629333297402, 12.952605071167142, 13.199116992453725, 15.86691501736641, 16.068923000246286, 16.23626567609608, 2.2860577503840034, 2.6380613433817928, 2.4104897106687133, 20.590039518972233, 20.404666689534977, 20.57061347117026, 17.13731604317823, 16.990234876672417, 17.284519026676804, 12.547033975521714, 12.37515543277064, 12.32224357003966, 17.204598025729254, 16.81910865505536, 17.29462042016287, 24.43403853413959, 24.475776432858154, 24.152522695561245, 17.873536018033818, 18.16652329669644, 18.212055797067777, 16.695467213789613, 17.226650667066366, 16.84935351709524, 12.694625859459236, 12.370874290664986, 13.291706331384674, 9.415531657636166, 9.292239859700203, 9.727430507540703, 19.318554148077965, 19.446386199444532, 19.066073715686798, 15.136550838748605, 15.11698170254627, 15.685757506386523, 19.073596728344754, 19.060731717695788, 18.512981702884034, 6.284783773124218, 6.3998060412704945, 6.513176795095205, 16.05631887416044, 15.758807654182107, 16.21390992278853, 16.866491479178265, 17.090104599793747, 16.67112239201863, 17.048805698752403, 16.51601393520832, 17.112394206225872, 15.4546219545106, 15.521608001242072, 15.17093504468599, 21.50307858331749, 21.543487028374017, 21.479020467648894, 16.05647315333286, 15.979550863305718, 15.204024473826081, 15.396807769934327, 15.101149062315613, 15.313192316020519, 14.676789422829941, 15.026346467512965, 14.797049486388758, 21.835589345544577, 21.810696694999933, 21.86135066859424, 26.484263231356934, 26.322433491547898, 26.738136340243116, 16.003905345996216, 16.167500929286078, 15.82954693337281, 21.634133190537483, 21.542221608261258, 21.717053002367408, 20.941100262105465, 21.33913091570139, 21.458726722747087, 20.635322902351618, 20.66919187735766, 20.53964403644204, 18.64199486126502, 18.729373296101883, 18.88522396360834, 11.368483799199254, 11.715374058733374, 11.626172671715409, 19.745448739578322, 19.452738021810845, 19.679817133893565, 12.559380623977631, 12.432931896299124, 12.326275773346424, 17.336460325866938, 17.586863310541958, 17.489144971594214, 16.362202492853, 16.14732901503642, 16.089226966102913, 12.536397268374756, 12.678335839261607, 12.36652499934037, 16.182160325348377, 15.606026783585548, 16.517901424318552, 20.06637145703037, 20.027168606718377, 19.929530461629227, 18.375245502839476, 18.375487609455973, 18.557177491175622, 15.792907680074364, 16.155811705316097, 16.184539393211395, 14.599309941132859, 14.646119070549801, 15.082819176915407, 14.308742811282471, 14.319263664384678, 14.183946703871086, 15.917380570123584, 16.045202935735375, 14.701870183149964, 15.679714196051151, 15.249508815507085, 15.60146517182389, 16.405529518922165, 16.278124031921223, 16.517206010719136, 21.126986200610787, 21.067000346879155, 21.44379177937904, 12.874589594701916, 12.859230651209742, 12.816774020592362, 18.396201744675636, 18.88235753029585, 19.043582225916907, 14.671738808353737, 15.018621440355972, 15.044226599236325, 18.537017315626144, 18.914524264633656, 18.824072167277336, 19.329112023115158, 20.05735951475799, 20.06370368413627, 12.403375363598258, 12.418914704273135, 12.5732558282713, 9.617398664355278, 10.357895508874208, 9.938342146575451, 13.258754342794418, 13.349485911428928, 13.57554541155696, 17.16124403228362, 16.954613280793026, 16.54329015811284, 17.447338610887527, 17.68071853928268, 17.591136530041695, 12.06981012349327, 12.227015651141599, 11.799508554240063, 17.390025084217385, 17.164297265311077, 16.99563217659791, 15.588999278843403, 15.562157556414604, 15.78185492195189, 16.05158545821905, 16.489778075367212, 16.193946197628975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1623344230062249, "mean_inference_ms": 0.7258129693811729, "mean_action_processing_ms": 0.10119943408389678, "mean_env_wait_ms": 0.8422935163231213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 479700, "timesteps_this_iter": 0, "agent_timesteps_total": 1439100, "timers": {"sample_time_ms": 20682.957, "sample_throughput": 463.86, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3128.034, "learn_throughput": 3067.102, "update_time_ms": 9.329}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004943847656250001, "cur_lr": 0.0005, "total_loss": 5.108526885509491, "policy_loss": -0.0009259970448256272, "vf_loss": 5.210453569889069, "vf_explained_var": -0.2487909346818924, "kl": 0.004842599242733707, "entropy": 10.10028088092804, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 479700, "num_agent_steps_sampled": 1439100, "num_steps_trained": 479700, "num_agent_steps_trained": 1439100, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 74.26253197714685, "episode_reward_min": 46.732415006495984, "episode_reward_mean": 59.8987478447947, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 15.381368952492863}, "policy_reward_max": {"shared_policy": 24.825029627730444}, "policy_reward_mean": {"shared_policy": 19.966249281598234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.972411110997186, 63.822418076917515, 46.732415006495984, 63.84394958136545, 71.6126632867381, 55.691678219474824, 55.968588184565306, 60.815139047801466, 74.26253197714685, 48.26568395644425], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.451114637156323, 19.502701265116528, 19.018595208724335, 21.173896444340542, 20.99261864026387, 21.655902992313102, 15.693825594770402, 15.657220459232718, 15.381368952492863, 21.308116640895605, 21.042827151715755, 21.49300578875409, 23.862456304952502, 23.813178211450577, 23.93702877033502, 18.342688309649617, 18.633499008292944, 18.715490901532263, 18.366523578763008, 18.86625910922885, 18.735805496573448, 20.22885103027025, 20.2689551214377, 20.317332896093518, 24.616354455550507, 24.825029627730444, 24.8211478938659, 15.950063382585839, 15.956136648853615, 16.359483925004795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14547378529869928, "mean_inference_ms": 0.7585214400680729, "mean_action_processing_ms": 0.10104633815603944, "mean_env_wait_ms": 0.8345270744763547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2387, "training_iteration": 50, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-00-43", "timestamp": 1706191243, "time_this_iter_s": 26.936686754226685, "time_total_s": 1044.484812259674, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B88A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1044.484812259674, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.852631578947369, "ram_util_percent": 46.91578947368421}}
{"episode_reward_max": 95.86997898668048, "episode_reward_min": 7.3346088044345095, "episode_reward_mean": 51.235049902196614, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 2.2860577503840034}, "policy_reward_max": {"shared_policy": 32.26733423272768}, "policy_reward_mean": {"shared_policy": 17.07834996739887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.06859107874334, 56.660192430019364, 73.00296310335395, 55.44720840454099, 57.72210705745965, 61.71649379562584, 39.04335139691827, 48.17210369370878, 7.3346088044345095, 61.56531967967747, 51.41206994652745, 37.244432978332014, 51.318327100947485, 73.06233766255899, 54.252115111798034, 50.77147139795122, 38.357206481508896, 28.43520202487707, 57.831014063209295, 45.939290047681396, 56.647310148924575, 19.197766609489918, 48.02903645113108, 50.627718470990644, 50.677213840186596, 46.14716500043866, 64.5255860793404, 47.24004849046466, 45.81114914827046, 44.500185376731665, 65.50763670913875, 79.54483306314795, 48.000953208655105, 64.89340780116615, 63.73895790055394, 61.84415881615132, 56.25659212097524, 34.71003052964804, 58.87800389528273, 37.31858829362318, 52.41246860800311, 48.59875847399233, 37.58125810697673, 48.30608853325248, 60.023070525377975, 55.30791060347107, 48.133258778601856, 44.32824818859807, 42.811953179538236, 46.66445368900892, 46.530688183382125, 49.200859561562524, 63.63777832686898, 38.55059426650402, 56.32214150088839, 44.734586847946034, 56.275613747537136, 59.45017522200942, 37.39554589614269, 29.913636319804937, 40.183785665780306, 50.659147471189485, 52.7191936802119, 36.09633432887493, 51.54995452612637, 46.9330117572099, 48.73530973121524, 56.97015667706728, 58.522190950810895, 51.137829989194856, 60.812122038332745, 59.42295143939552, 95.86997898668048, 51.62251660227773, 73.1531505063176, 43.041887832805514, 45.46036804094908, 45.94454839825627, 45.04733077995478, 66.55068330094217, 33.75846987310797, 46.26317109167573, 68.55536364018916, 62.29651817120609, 53.12159398943183, 32.895039599388824, 35.62195022776723, 41.1418448090553, 64.48802060447633, 55.95702869445083, 38.090525950770825, 50.88649874739349, 75.18660173937675, 32.63589352741836, 56.87625910341737, 55.60157412290572, 49.814858813304454, 52.04981669969854, 65.21756686083972, 65.98210447654125], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.62177737802267, 15.825503399595618, 15.62131030112505, 18.972956965987876, 18.992826081191495, 18.694409382839993, 24.30174688498178, 24.23996667067209, 24.461249547700078, 18.340183349947125, 18.586659620205552, 18.52036543438831, 19.193317912518978, 19.481700350530446, 19.04708879441023, 20.734254074903816, 20.286047304670006, 20.696192416052014, 12.891629333297402, 12.952605071167142, 13.199116992453725, 15.86691501736641, 16.068923000246286, 16.23626567609608, 2.2860577503840034, 2.6380613433817928, 2.4104897106687133, 20.590039518972233, 20.404666689534977, 20.57061347117026, 17.13731604317823, 16.990234876672417, 17.284519026676804, 12.547033975521714, 12.37515543277064, 12.32224357003966, 17.204598025729254, 16.81910865505536, 17.29462042016287, 24.43403853413959, 24.475776432858154, 24.152522695561245, 17.873536018033818, 18.16652329669644, 18.212055797067777, 16.695467213789613, 17.226650667066366, 16.84935351709524, 12.694625859459236, 12.370874290664986, 13.291706331384674, 9.415531657636166, 9.292239859700203, 9.727430507540703, 19.318554148077965, 19.446386199444532, 19.066073715686798, 15.136550838748605, 15.11698170254627, 15.685757506386523, 19.073596728344754, 19.060731717695788, 18.512981702884034, 6.284783773124218, 6.3998060412704945, 6.513176795095205, 16.05631887416044, 15.758807654182107, 16.21390992278853, 16.866491479178265, 17.090104599793747, 16.67112239201863, 17.048805698752403, 16.51601393520832, 17.112394206225872, 15.4546219545106, 15.521608001242072, 15.17093504468599, 21.50307858331749, 21.543487028374017, 21.479020467648894, 16.05647315333286, 15.979550863305718, 15.204024473826081, 15.396807769934327, 15.101149062315613, 15.313192316020519, 14.676789422829941, 15.026346467512965, 14.797049486388758, 21.835589345544577, 21.810696694999933, 21.86135066859424, 26.484263231356934, 26.322433491547898, 26.738136340243116, 16.003905345996216, 16.167500929286078, 15.82954693337281, 21.634133190537483, 21.542221608261258, 21.717053002367408, 20.941100262105465, 21.33913091570139, 21.458726722747087, 20.635322902351618, 20.66919187735766, 20.53964403644204, 18.64199486126502, 18.729373296101883, 18.88522396360834, 11.368483799199254, 11.715374058733374, 11.626172671715409, 19.745448739578322, 19.452738021810845, 19.679817133893565, 12.559380623977631, 12.432931896299124, 12.326275773346424, 17.336460325866938, 17.586863310541958, 17.489144971594214, 16.362202492853, 16.14732901503642, 16.089226966102913, 12.536397268374756, 12.678335839261607, 12.36652499934037, 16.182160325348377, 15.606026783585548, 16.517901424318552, 20.06637145703037, 20.027168606718377, 19.929530461629227, 18.375245502839476, 18.375487609455973, 18.557177491175622, 15.792907680074364, 16.155811705316097, 16.184539393211395, 14.599309941132859, 14.646119070549801, 15.082819176915407, 14.308742811282471, 14.319263664384678, 14.183946703871086, 15.917380570123584, 16.045202935735375, 14.701870183149964, 15.679714196051151, 15.249508815507085, 15.60146517182389, 16.405529518922165, 16.278124031921223, 16.517206010719136, 21.126986200610787, 21.067000346879155, 21.44379177937904, 12.874589594701916, 12.859230651209742, 12.816774020592362, 18.396201744675636, 18.88235753029585, 19.043582225916907, 14.671738808353737, 15.018621440355972, 15.044226599236325, 18.537017315626144, 18.914524264633656, 18.824072167277336, 19.329112023115158, 20.05735951475799, 20.06370368413627, 12.403375363598258, 12.418914704273135, 12.5732558282713, 9.617398664355278, 10.357895508874208, 9.938342146575451, 13.258754342794418, 13.349485911428928, 13.57554541155696, 17.16124403228362, 16.954613280793026, 16.54329015811284, 17.447338610887527, 17.68071853928268, 17.591136530041695, 12.06981012349327, 12.227015651141599, 11.799508554240063, 17.390025084217385, 17.164297265311077, 16.99563217659791, 15.588999278843403, 15.562157556414604, 15.78185492195189, 16.05158545821905, 16.489778075367212, 16.193946197628975, 18.841990314424038, 18.946410611271858, 19.181755751371384, 19.33522180219491, 19.570897431423262, 19.616071717192725, 17.36021852989991, 17.345414226253823, 16.432197233041123, 20.194450579583645, 20.118787698447704, 20.498883760301396, 19.894131942341716, 19.93909289004901, 19.589726607004792, 32.05740529547134, 31.54523945848146, 32.26733423272768, 17.24053660283485, 17.144908754775912, 17.237071244666964, 24.077172209819153, 24.605040592451886, 24.470937704046563, 14.174596928060055, 14.341709110885859, 14.525581793859601, 15.257939572135598, 14.941764051715523, 15.260664417097956, 15.020811359087617, 15.410791082928569, 15.512945956240088, 14.880936657389, 14.977529038985566, 15.188865083580211, 21.98237345119317, 22.26836933319767, 22.29994051655133, 11.278904810547829, 10.990547224879265, 11.489017837680876, 15.341300862530858, 15.389900813500077, 15.531969415644795, 23.155760535349444, 22.949634374429777, 22.449968730409935, 20.508304225901753, 20.71875153730312, 21.069462408001215, 17.485392461220414, 17.814540932575852, 17.821660595635564, 10.876020093758896, 11.253287972261504, 10.765731533368424, 11.942785516381264, 11.649405382573605, 12.02975932881236, 13.95240597675243, 13.880274372796208, 13.309164459506661, 21.41125936061144, 21.55290760099888, 21.523853642866015, 18.386718610922486, 18.749879616002232, 18.82043046752611, 12.613896194845438, 12.597968213260174, 12.878661542665213, 17.19442186318338, 16.83383869379759, 16.85823819041252, 24.820390130082757, 25.408341764161975, 24.957869845132024, 10.931689926733569, 10.751343948145703, 10.95285965253909, 18.76279459396997, 19.10564479480186, 19.007819714645535, 18.394315135975674, 18.68741591026385, 18.51984307666619, 16.569997504353523, 16.867303286213428, 16.377558022737503, 17.302504918227584, 17.279428551594407, 17.46788322987655, 21.892564674839377, 21.64724925160408, 21.677752934396267, 22.156795403609664, 21.800208660463483, 22.025100412468106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16231685689926065, "mean_inference_ms": 0.7262737566758262, "mean_action_processing_ms": 0.10126067015737952, "mean_env_wait_ms": 0.8422988058076478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 489294, "timesteps_this_iter": 0, "agent_timesteps_total": 1467882, "timers": {"sample_time_ms": 21243.35, "sample_throughput": 451.624, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3138.449, "learn_throughput": 3056.924, "update_time_ms": 9.429}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00024719238281250004, "cur_lr": 0.0005, "total_loss": 5.4769182205200195, "policy_loss": -0.0009830830428700435, "vf_loss": 5.5793498158454895, "vf_explained_var": -0.2284809798002243, "kl": 0.004597397404764325, "entropy": 10.144943833351135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 489294, "num_agent_steps_sampled": 1467882, "num_steps_trained": 489294, "num_agent_steps_trained": 1467882, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2420, "training_iteration": 51, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-01-03", "timestamp": 1706191263, "time_this_iter_s": 20.531719207763672, "time_total_s": 1065.0165314674377, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1065.0165314674377, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 9.610344827586207, "ram_util_percent": 46.99310344827585}}
{"episode_reward_max": 95.86997898668048, "episode_reward_min": 29.913636319804937, "episode_reward_mean": 53.98091637309059, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 9.617398664355278}, "policy_reward_max": {"shared_policy": 32.26733423272768}, "policy_reward_mean": {"shared_policy": 17.99363879103019}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.54483306314795, 48.000953208655105, 64.89340780116615, 63.73895790055394, 61.84415881615132, 56.25659212097524, 34.71003052964804, 58.87800389528273, 37.31858829362318, 52.41246860800311, 48.59875847399233, 37.58125810697673, 48.30608853325248, 60.023070525377975, 55.30791060347107, 48.133258778601856, 44.32824818859807, 42.811953179538236, 46.66445368900892, 46.530688183382125, 49.200859561562524, 63.63777832686898, 38.55059426650402, 56.32214150088839, 44.734586847946034, 56.275613747537136, 59.45017522200942, 37.39554589614269, 29.913636319804937, 40.183785665780306, 50.659147471189485, 52.7191936802119, 36.09633432887493, 51.54995452612637, 46.9330117572099, 48.73530973121524, 56.97015667706728, 58.522190950810895, 51.137829989194856, 60.812122038332745, 59.42295143939552, 95.86997898668048, 51.62251660227773, 73.1531505063176, 43.041887832805514, 45.46036804094908, 45.94454839825627, 45.04733077995478, 66.55068330094217, 33.75846987310797, 46.26317109167573, 68.55536364018916, 62.29651817120609, 53.12159398943183, 32.895039599388824, 35.62195022776723, 41.1418448090553, 64.48802060447633, 55.95702869445083, 38.090525950770825, 50.88649874739349, 75.18660173937675, 32.63589352741836, 56.87625910341737, 55.60157412290572, 49.814858813304454, 52.04981669969854, 65.21756686083972, 65.98210447654125, 65.84841232374309, 42.08201491832732, 57.860978882992626, 58.340176951140165, 57.03272852022198, 64.43716080114244, 69.0787025168538, 82.74428271874785, 49.742649673251435, 41.613875144394115, 73.47508477419613, 68.11197852529585, 57.37039282079786, 79.44324361532927, 58.88943767733872, 50.25434126239267, 68.54117219522593, 42.86218182928859, 42.08130508288741, 61.63109669706316, 72.25164859509096, 36.56812053918836, 62.02692925988231, 42.69842914305627, 63.024646747857304, 45.241191841661916, 73.3890856063226, 67.09725777059792, 50.958799637854085, 54.264499209821224, 50.89204439241438], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.484263231356934, 26.322433491547898, 26.738136340243116, 16.003905345996216, 16.167500929286078, 15.82954693337281, 21.634133190537483, 21.542221608261258, 21.717053002367408, 20.941100262105465, 21.33913091570139, 21.458726722747087, 20.635322902351618, 20.66919187735766, 20.53964403644204, 18.64199486126502, 18.729373296101883, 18.88522396360834, 11.368483799199254, 11.715374058733374, 11.626172671715409, 19.745448739578322, 19.452738021810845, 19.679817133893565, 12.559380623977631, 12.432931896299124, 12.326275773346424, 17.336460325866938, 17.586863310541958, 17.489144971594214, 16.362202492853, 16.14732901503642, 16.089226966102913, 12.536397268374756, 12.678335839261607, 12.36652499934037, 16.182160325348377, 15.606026783585548, 16.517901424318552, 20.06637145703037, 20.027168606718377, 19.929530461629227, 18.375245502839476, 18.375487609455973, 18.557177491175622, 15.792907680074364, 16.155811705316097, 16.184539393211395, 14.599309941132859, 14.646119070549801, 15.082819176915407, 14.308742811282471, 14.319263664384678, 14.183946703871086, 15.917380570123584, 16.045202935735375, 14.701870183149964, 15.679714196051151, 15.249508815507085, 15.60146517182389, 16.405529518922165, 16.278124031921223, 16.517206010719136, 21.126986200610787, 21.067000346879155, 21.44379177937904, 12.874589594701916, 12.859230651209742, 12.816774020592362, 18.396201744675636, 18.88235753029585, 19.043582225916907, 14.671738808353737, 15.018621440355972, 15.044226599236325, 18.537017315626144, 18.914524264633656, 18.824072167277336, 19.329112023115158, 20.05735951475799, 20.06370368413627, 12.403375363598258, 12.418914704273135, 12.5732558282713, 9.617398664355278, 10.357895508874208, 9.938342146575451, 13.258754342794418, 13.349485911428928, 13.57554541155696, 17.16124403228362, 16.954613280793026, 16.54329015811284, 17.447338610887527, 17.68071853928268, 17.591136530041695, 12.06981012349327, 12.227015651141599, 11.799508554240063, 17.390025084217385, 17.164297265311077, 16.99563217659791, 15.588999278843403, 15.562157556414604, 15.78185492195189, 16.05158545821905, 16.489778075367212, 16.193946197628975, 18.841990314424038, 18.946410611271858, 19.181755751371384, 19.33522180219491, 19.570897431423262, 19.616071717192725, 17.36021852989991, 17.345414226253823, 16.432197233041123, 20.194450579583645, 20.118787698447704, 20.498883760301396, 19.894131942341716, 19.93909289004901, 19.589726607004792, 32.05740529547134, 31.54523945848146, 32.26733423272768, 17.24053660283485, 17.144908754775912, 17.237071244666964, 24.077172209819153, 24.605040592451886, 24.470937704046563, 14.174596928060055, 14.341709110885859, 14.525581793859601, 15.257939572135598, 14.941764051715523, 15.260664417097956, 15.020811359087617, 15.410791082928569, 15.512945956240088, 14.880936657389, 14.977529038985566, 15.188865083580211, 21.98237345119317, 22.26836933319767, 22.29994051655133, 11.278904810547829, 10.990547224879265, 11.489017837680876, 15.341300862530858, 15.389900813500077, 15.531969415644795, 23.155760535349444, 22.949634374429777, 22.449968730409935, 20.508304225901753, 20.71875153730312, 21.069462408001215, 17.485392461220414, 17.814540932575852, 17.821660595635564, 10.876020093758896, 11.253287972261504, 10.765731533368424, 11.942785516381264, 11.649405382573605, 12.02975932881236, 13.95240597675243, 13.880274372796208, 13.309164459506661, 21.41125936061144, 21.55290760099888, 21.523853642866015, 18.386718610922486, 18.749879616002232, 18.82043046752611, 12.613896194845438, 12.597968213260174, 12.878661542665213, 17.19442186318338, 16.83383869379759, 16.85823819041252, 24.820390130082757, 25.408341764161975, 24.957869845132024, 10.931689926733569, 10.751343948145703, 10.95285965253909, 18.76279459396997, 19.10564479480186, 19.007819714645535, 18.394315135975674, 18.68741591026385, 18.51984307666619, 16.569997504353523, 16.867303286213428, 16.377558022737503, 17.302504918227584, 17.279428551594407, 17.46788322987655, 21.892564674839377, 21.64724925160408, 21.677752934396267, 22.156795403609664, 21.800208660463483, 22.025100412468106, 21.870145877202347, 21.79206796487172, 22.186198481669024, 13.968991940220192, 14.04184379180272, 14.071179186304406, 19.223014097039893, 19.306535671309874, 19.33142911464286, 19.302793949842453, 19.29799186438322, 19.73939113691449, 18.857051166395337, 18.93117997298637, 19.244497380840272, 21.306760122378662, 21.650364992519215, 21.480035686244562, 22.871805628140763, 23.222108868261174, 22.98478802045186, 27.429418213665485, 27.795924585312605, 27.518939919769764, 16.45685227960348, 16.55187663063407, 16.733920763013884, 14.055782613577321, 13.810954596847296, 13.747137933969498, 24.55523120363553, 24.429813494284943, 24.490040076275662, 23.084151880815625, 22.204814791679382, 22.823011852800846, 18.86014822125435, 19.04811578989029, 19.462128809653223, 26.494651295244694, 26.49856288731098, 26.45002943277359, 19.40660986304283, 19.609811410307884, 19.873016403988004, 16.98571221313128, 16.547698619465024, 16.72093042979637, 22.94846464941898, 23.037141925344855, 22.55556562046209, 14.269141023357705, 14.480456113194421, 14.112584692736462, 14.149991173297167, 13.779675431549549, 14.151638478040695, 20.689906255613693, 20.43620306129256, 20.504987380156905, 24.187015894800425, 23.79547318816185, 24.26915951212868, 12.372598389784486, 12.177163029710442, 12.018359119693429, 20.629558488726616, 20.985370763228275, 20.412000007927418, 14.346075486391783, 14.377635167911649, 13.974718488752842, 21.192997133980185, 20.98164467016855, 20.85000494370857, 15.01039671649535, 15.045180683334664, 15.185614441831902, 24.06389760474363, 24.57686301941672, 24.748324982162245, 22.542749616627887, 22.023570892711476, 22.530937261258558, 16.9364031193157, 16.91631257285674, 17.106083945681647, 18.113758452236652, 18.155787140130997, 17.994953617453575, 17.09280580685784, 16.994640994196132, 16.804597591360405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16218444697024936, "mean_inference_ms": 0.7264916557940225, "mean_action_processing_ms": 0.10117295848167661, "mean_env_wait_ms": 0.8421324336579391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 498888, "timesteps_this_iter": 0, "agent_timesteps_total": 1496664, "timers": {"sample_time_ms": 21307.232, "sample_throughput": 450.27, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3147.643, "learn_throughput": 3047.995, "update_time_ms": 9.88}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140625002, "cur_lr": 0.0005, "total_loss": 5.481762528419495, "policy_loss": -0.0008535122471664547, "vf_loss": 5.5848612785339355, "vf_explained_var": -0.1690303236246109, "kl": 0.005622992903269007, "entropy": 10.224571228027344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 498888, "num_agent_steps_sampled": 1496664, "num_steps_trained": 498888, "num_agent_steps_trained": 1496664, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2451, "training_iteration": 52, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-01-24", "timestamp": 1706191284, "time_this_iter_s": 20.575427532196045, "time_total_s": 1085.5919589996338, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA016263A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1085.5919589996338, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 9.263333333333332, "ram_util_percent": 47.03333333333334}}
{"episode_reward_max": 108.68469199445099, "episode_reward_min": 25.859363134950385, "episode_reward_mean": 56.189940138655366, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 8.607217514266566}, "policy_reward_max": {"shared_policy": 36.32108061667532}, "policy_reward_mean": {"shared_policy": 18.72998004621845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.54995452612637, 46.9330117572099, 48.73530973121524, 56.97015667706728, 58.522190950810895, 51.137829989194856, 60.812122038332745, 59.42295143939552, 95.86997898668048, 51.62251660227773, 73.1531505063176, 43.041887832805514, 45.46036804094908, 45.94454839825627, 45.04733077995478, 66.55068330094217, 33.75846987310797, 46.26317109167573, 68.55536364018916, 62.29651817120609, 53.12159398943183, 32.895039599388824, 35.62195022776723, 41.1418448090553, 64.48802060447633, 55.95702869445083, 38.090525950770825, 50.88649874739349, 75.18660173937675, 32.63589352741836, 56.87625910341737, 55.60157412290572, 49.814858813304454, 52.04981669969854, 65.21756686083972, 65.98210447654125, 65.84841232374309, 42.08201491832732, 57.860978882992626, 58.340176951140165, 57.03272852022198, 64.43716080114244, 69.0787025168538, 82.74428271874785, 49.742649673251435, 41.613875144394115, 73.47508477419613, 68.11197852529585, 57.37039282079786, 79.44324361532927, 58.88943767733872, 50.25434126239267, 68.54117219522593, 42.86218182928859, 42.08130508288741, 61.63109669706316, 72.25164859509096, 36.56812053918836, 62.02692925988231, 42.69842914305627, 63.024646747857304, 45.241191841661916, 73.3890856063226, 67.09725777059792, 50.958799637854085, 54.264499209821224, 50.89204439241438, 30.1593485516496, 52.45008339965716, 57.99585088994354, 108.68469199445099, 59.827772095799446, 57.66125690750776, 50.56184480502267, 25.859363134950385, 52.071757860481725, 65.07279157079755, 47.928453788161264, 58.62286661565301, 50.62518379185347, 64.11645989865062, 57.14166643470526, 50.63596698269245, 61.39052954351064, 53.25557093322274, 70.39042616076767, 53.56097678095102, 56.512912362813935, 56.68129605753347, 58.58821202581747, 57.83232354983919, 51.301320534199476, 59.63822565600276, 37.39346092939374, 59.469358760863514, 60.24373590480536, 54.55226079374552, 62.84258695319292, 59.85452746413647, 69.00236875843257], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.390025084217385, 17.164297265311077, 16.99563217659791, 15.588999278843403, 15.562157556414604, 15.78185492195189, 16.05158545821905, 16.489778075367212, 16.193946197628975, 18.841990314424038, 18.946410611271858, 19.181755751371384, 19.33522180219491, 19.570897431423262, 19.616071717192725, 17.36021852989991, 17.345414226253823, 16.432197233041123, 20.194450579583645, 20.118787698447704, 20.498883760301396, 19.894131942341716, 19.93909289004901, 19.589726607004792, 32.05740529547134, 31.54523945848146, 32.26733423272768, 17.24053660283485, 17.144908754775912, 17.237071244666964, 24.077172209819153, 24.605040592451886, 24.470937704046563, 14.174596928060055, 14.341709110885859, 14.525581793859601, 15.257939572135598, 14.941764051715523, 15.260664417097956, 15.020811359087617, 15.410791082928569, 15.512945956240088, 14.880936657389, 14.977529038985566, 15.188865083580211, 21.98237345119317, 22.26836933319767, 22.29994051655133, 11.278904810547829, 10.990547224879265, 11.489017837680876, 15.341300862530858, 15.389900813500077, 15.531969415644795, 23.155760535349444, 22.949634374429777, 22.449968730409935, 20.508304225901753, 20.71875153730312, 21.069462408001215, 17.485392461220414, 17.814540932575852, 17.821660595635564, 10.876020093758896, 11.253287972261504, 10.765731533368424, 11.942785516381264, 11.649405382573605, 12.02975932881236, 13.95240597675243, 13.880274372796208, 13.309164459506661, 21.41125936061144, 21.55290760099888, 21.523853642866015, 18.386718610922486, 18.749879616002232, 18.82043046752611, 12.613896194845438, 12.597968213260174, 12.878661542665213, 17.19442186318338, 16.83383869379759, 16.85823819041252, 24.820390130082757, 25.408341764161975, 24.957869845132024, 10.931689926733569, 10.751343948145703, 10.95285965253909, 18.76279459396997, 19.10564479480186, 19.007819714645535, 18.394315135975674, 18.68741591026385, 18.51984307666619, 16.569997504353523, 16.867303286213428, 16.377558022737503, 17.302504918227584, 17.279428551594407, 17.46788322987655, 21.892564674839377, 21.64724925160408, 21.677752934396267, 22.156795403609664, 21.800208660463483, 22.025100412468106, 21.870145877202347, 21.79206796487172, 22.186198481669024, 13.968991940220192, 14.04184379180272, 14.071179186304406, 19.223014097039893, 19.306535671309874, 19.33142911464286, 19.302793949842453, 19.29799186438322, 19.73939113691449, 18.857051166395337, 18.93117997298637, 19.244497380840272, 21.306760122378662, 21.650364992519215, 21.480035686244562, 22.871805628140763, 23.222108868261174, 22.98478802045186, 27.429418213665485, 27.795924585312605, 27.518939919769764, 16.45685227960348, 16.55187663063407, 16.733920763013884, 14.055782613577321, 13.810954596847296, 13.747137933969498, 24.55523120363553, 24.429813494284943, 24.490040076275662, 23.084151880815625, 22.204814791679382, 22.823011852800846, 18.86014822125435, 19.04811578989029, 19.462128809653223, 26.494651295244694, 26.49856288731098, 26.45002943277359, 19.40660986304283, 19.609811410307884, 19.873016403988004, 16.98571221313128, 16.547698619465024, 16.72093042979637, 22.94846464941898, 23.037141925344855, 22.55556562046209, 14.269141023357705, 14.480456113194421, 14.112584692736462, 14.149991173297167, 13.779675431549549, 14.151638478040695, 20.689906255613693, 20.43620306129256, 20.504987380156905, 24.187015894800425, 23.79547318816185, 24.26915951212868, 12.372598389784486, 12.177163029710442, 12.018359119693429, 20.629558488726616, 20.985370763228275, 20.412000007927418, 14.346075486391783, 14.377635167911649, 13.974718488752842, 21.192997133980185, 20.98164467016855, 20.85000494370857, 15.01039671649535, 15.045180683334664, 15.185614441831902, 24.06389760474363, 24.57686301941672, 24.748324982162245, 22.542749616627887, 22.023570892711476, 22.530937261258558, 16.9364031193157, 16.91631257285674, 17.106083945681647, 18.113758452236652, 18.155787140130997, 17.994953617453575, 17.09280580685784, 16.994640994196132, 16.804597591360405, 10.215699278283864, 9.958531059324741, 9.985118214040995, 17.60589883150533, 17.263565093278885, 17.580619474872947, 19.599032814614475, 18.94179378449917, 19.455024290829897, 36.32108061667532, 36.23584987223148, 36.127761505544186, 20.04756870865822, 19.94555066525936, 19.834652721881866, 19.33473512095709, 19.1136104290684, 19.21291135748227, 17.048637610316888, 16.861158358554036, 16.65204883615175, 8.631130264451102, 8.621015356232718, 8.607217514266566, 17.405646984775856, 17.294385900100067, 17.3717249756058, 21.943861312543348, 21.886729804178074, 21.242200454076126, 15.991849338014916, 15.952273232241467, 15.98433121790488, 19.40868608901897, 19.69841271887222, 19.51576780776182, 16.772742097576455, 17.124598993298903, 16.727842700978115, 21.32191979015866, 21.261405336360127, 21.53313477213183, 18.952652633190155, 19.03825555741787, 19.150758244097233, 16.746357309321553, 16.875444280604512, 17.014165392766387, 20.687597382813692, 20.98041312058922, 19.722519040107727, 18.000600478301436, 18.032747759173304, 17.222222695748002, 23.571781950071454, 23.414356872439384, 23.404287338256836, 17.742139592766762, 17.916655138134956, 17.902182050049305, 19.065933985014752, 18.808293988307312, 18.63868438949187, 18.964284093584865, 18.799137748777866, 18.91787421517074, 19.296681610246495, 19.708587840975568, 19.582942574595407, 18.94143673529227, 19.51844330494835, 19.37244350959857, 17.029092468321323, 16.737286046147346, 17.534942019730806, 19.89271004870534, 19.72920737415552, 20.0163082331419, 12.029884974161774, 12.750678262362868, 12.612897692869097, 20.024116581926734, 19.64108146975437, 19.804160709182412, 20.051467455923557, 20.259959916584194, 19.93230853229761, 18.1707668825984, 18.0863149613142, 18.295178949832916, 20.859500939647347, 20.917191381255776, 21.065894632289798, 19.902312533309058, 20.011799681310848, 19.940415249516562, 23.046243090182543, 23.0513851409778, 22.904740527272224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16200543228005743, "mean_inference_ms": 0.7265862206037207, "mean_action_processing_ms": 0.10120200659956635, "mean_env_wait_ms": 0.8418990767328254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 508482, "timesteps_this_iter": 0, "agent_timesteps_total": 1525446, "timers": {"sample_time_ms": 21354.143, "sample_throughput": 449.281, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3151.155, "learn_throughput": 3044.598, "update_time_ms": 9.876}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140625002, "cur_lr": 0.0005, "total_loss": 5.625670969486237, "policy_loss": -0.0012929648511488534, "vf_loss": 5.730128705501556, "vf_explained_var": -0.13827888667583466, "kl": 0.004988620465200617, "entropy": 10.316534161567688, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 508482, "num_agent_steps_sampled": 1525446, "num_steps_trained": 508482, "num_agent_steps_trained": 1525446, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2484, "training_iteration": 53, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-01-45", "timestamp": 1706191305, "time_this_iter_s": 20.68958067893982, "time_total_s": 1106.2815396785736, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B88F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1106.2815396785736, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 8.920689655172414, "ram_util_percent": 47.16896551724139}}
{"episode_reward_max": 108.68469199445099, "episode_reward_min": 25.859363134950385, "episode_reward_mean": 57.735571561042015, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 8.607217514266566}, "policy_reward_max": {"shared_policy": 36.32108061667532}, "policy_reward_mean": {"shared_policy": 19.245190520347336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.87625910341737, 55.60157412290572, 49.814858813304454, 52.04981669969854, 65.21756686083972, 65.98210447654125, 65.84841232374309, 42.08201491832732, 57.860978882992626, 58.340176951140165, 57.03272852022198, 64.43716080114244, 69.0787025168538, 82.74428271874785, 49.742649673251435, 41.613875144394115, 73.47508477419613, 68.11197852529585, 57.37039282079786, 79.44324361532927, 58.88943767733872, 50.25434126239267, 68.54117219522593, 42.86218182928859, 42.08130508288741, 61.63109669706316, 72.25164859509096, 36.56812053918836, 62.02692925988231, 42.69842914305627, 63.024646747857304, 45.241191841661916, 73.3890856063226, 67.09725777059792, 50.958799637854085, 54.264499209821224, 50.89204439241438, 30.1593485516496, 52.45008339965716, 57.99585088994354, 108.68469199445099, 59.827772095799446, 57.66125690750776, 50.56184480502267, 25.859363134950385, 52.071757860481725, 65.07279157079755, 47.928453788161264, 58.62286661565301, 50.62518379185347, 64.11645989865062, 57.14166643470526, 50.63596698269245, 61.39052954351064, 53.25557093322274, 70.39042616076767, 53.56097678095102, 56.512912362813935, 56.68129605753347, 58.58821202581747, 57.83232354983919, 51.301320534199476, 59.63822565600276, 37.39346092939374, 59.469358760863514, 60.24373590480536, 54.55226079374552, 62.84258695319292, 59.85452746413647, 69.00236875843257, 61.8415626361966, 62.96472140401602, 58.05061310902238, 51.83682468906042, 47.67731278389691, 56.28423367999494, 44.42313269898294, 66.12977421144022, 80.40993746556339, 51.123743160860585, 61.064368650317164, 34.692387972158016, 62.567258805036545, 46.4513173722662, 58.99200673028825, 72.0617775544524, 62.503813605639124, 68.97034674882886, 62.98483797907829, 51.407430578023195, 59.092153184581534, 47.843866081908345, 67.79019239544868, 46.079044861719, 47.9714348837733, 73.21086699422449, 58.61445899680254, 66.97297425568104, 60.28013008460401, 55.943130888044806], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.76279459396997, 19.10564479480186, 19.007819714645535, 18.394315135975674, 18.68741591026385, 18.51984307666619, 16.569997504353523, 16.867303286213428, 16.377558022737503, 17.302504918227584, 17.279428551594407, 17.46788322987655, 21.892564674839377, 21.64724925160408, 21.677752934396267, 22.156795403609664, 21.800208660463483, 22.025100412468106, 21.870145877202347, 21.79206796487172, 22.186198481669024, 13.968991940220192, 14.04184379180272, 14.071179186304406, 19.223014097039893, 19.306535671309874, 19.33142911464286, 19.302793949842453, 19.29799186438322, 19.73939113691449, 18.857051166395337, 18.93117997298637, 19.244497380840272, 21.306760122378662, 21.650364992519215, 21.480035686244562, 22.871805628140763, 23.222108868261174, 22.98478802045186, 27.429418213665485, 27.795924585312605, 27.518939919769764, 16.45685227960348, 16.55187663063407, 16.733920763013884, 14.055782613577321, 13.810954596847296, 13.747137933969498, 24.55523120363553, 24.429813494284943, 24.490040076275662, 23.084151880815625, 22.204814791679382, 22.823011852800846, 18.86014822125435, 19.04811578989029, 19.462128809653223, 26.494651295244694, 26.49856288731098, 26.45002943277359, 19.40660986304283, 19.609811410307884, 19.873016403988004, 16.98571221313128, 16.547698619465024, 16.72093042979637, 22.94846464941898, 23.037141925344855, 22.55556562046209, 14.269141023357705, 14.480456113194421, 14.112584692736462, 14.149991173297167, 13.779675431549549, 14.151638478040695, 20.689906255613693, 20.43620306129256, 20.504987380156905, 24.187015894800425, 23.79547318816185, 24.26915951212868, 12.372598389784486, 12.177163029710442, 12.018359119693429, 20.629558488726616, 20.985370763228275, 20.412000007927418, 14.346075486391783, 14.377635167911649, 13.974718488752842, 21.192997133980185, 20.98164467016855, 20.85000494370857, 15.01039671649535, 15.045180683334664, 15.185614441831902, 24.06389760474363, 24.57686301941672, 24.748324982162245, 22.542749616627887, 22.023570892711476, 22.530937261258558, 16.9364031193157, 16.91631257285674, 17.106083945681647, 18.113758452236652, 18.155787140130997, 17.994953617453575, 17.09280580685784, 16.994640994196132, 16.804597591360405, 10.215699278283864, 9.958531059324741, 9.985118214040995, 17.60589883150533, 17.263565093278885, 17.580619474872947, 19.599032814614475, 18.94179378449917, 19.455024290829897, 36.32108061667532, 36.23584987223148, 36.127761505544186, 20.04756870865822, 19.94555066525936, 19.834652721881866, 19.33473512095709, 19.1136104290684, 19.21291135748227, 17.048637610316888, 16.861158358554036, 16.65204883615175, 8.631130264451102, 8.621015356232718, 8.607217514266566, 17.405646984775856, 17.294385900100067, 17.3717249756058, 21.943861312543348, 21.886729804178074, 21.242200454076126, 15.991849338014916, 15.952273232241467, 15.98433121790488, 19.40868608901897, 19.69841271887222, 19.51576780776182, 16.772742097576455, 17.124598993298903, 16.727842700978115, 21.32191979015866, 21.261405336360127, 21.53313477213183, 18.952652633190155, 19.03825555741787, 19.150758244097233, 16.746357309321553, 16.875444280604512, 17.014165392766387, 20.687597382813692, 20.98041312058922, 19.722519040107727, 18.000600478301436, 18.032747759173304, 17.222222695748002, 23.571781950071454, 23.414356872439384, 23.404287338256836, 17.742139592766762, 17.916655138134956, 17.902182050049305, 19.065933985014752, 18.808293988307312, 18.63868438949187, 18.964284093584865, 18.799137748777866, 18.91787421517074, 19.296681610246495, 19.708587840975568, 19.582942574595407, 18.94143673529227, 19.51844330494835, 19.37244350959857, 17.029092468321323, 16.737286046147346, 17.534942019730806, 19.89271004870534, 19.72920737415552, 20.0163082331419, 12.029884974161774, 12.750678262362868, 12.612897692869097, 20.024116581926734, 19.64108146975437, 19.804160709182412, 20.051467455923557, 20.259959916584194, 19.93230853229761, 18.1707668825984, 18.0863149613142, 18.295178949832916, 20.859500939647347, 20.917191381255776, 21.065894632289798, 19.902312533309058, 20.011799681310848, 19.940415249516562, 23.046243090182543, 23.0513851409778, 22.904740527272224, 20.569303688903645, 20.563499574859932, 20.708759372433022, 21.004861440509558, 20.967228800058365, 20.992631163448095, 19.390055302530527, 19.432051822543144, 19.228505983948708, 17.19405965010324, 17.497370942185313, 17.145394096771867, 16.021041383345917, 15.795879659553364, 15.860391740997628, 18.81400239467621, 19.04107745550573, 18.429153829813004, 14.849350300927952, 14.954436437537268, 14.61934596051772, 21.797470723589257, 22.200012817823634, 22.13229067002733, 26.89087024020651, 26.693651797870785, 26.825415427486092, 17.183813190010056, 17.03311768049994, 16.906812290350587, 20.37446370224157, 20.329944657782704, 20.35996029029289, 11.618491453429058, 11.031545927127198, 12.04235059160176, 20.920206256210804, 20.711590111255646, 20.935462437570095, 15.447964034974575, 15.534891600254923, 15.468461737036705, 19.639076021810368, 19.747391053785876, 19.60553965469201, 24.027724151810006, 24.0535217312475, 23.9805316713949, 20.766381079951913, 21.114362320435845, 20.623070205251366, 22.87749624500671, 23.06346750507751, 23.029382998744637, 21.26025191694498, 20.642433494329453, 21.08215256780386, 17.298685435205698, 16.91400407999754, 17.194741062819958, 19.66424436991413, 19.524658878644303, 19.9032499360231, 16.25474883057177, 15.824686333537102, 15.764430917799473, 22.62073601037264, 22.821661181747913, 22.347795203328133, 15.135172372062996, 15.414924332251147, 15.528948157404855, 15.796327004830033, 16.09200562412539, 16.083102254817874, 24.2069441229105, 24.585416383109987, 24.418506488204002, 19.784913229445607, 19.7241007896761, 19.105444977680833, 22.432752653956413, 22.35563899576664, 22.184582605957985, 20.147172724207238, 19.9971955170234, 20.135761843373373, 18.727766169855983, 18.489402557412774, 18.72596216077605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16183820246301545, "mean_inference_ms": 0.7266829423604989, "mean_action_processing_ms": 0.1011317652327398, "mean_env_wait_ms": 0.8416504704746778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 518076, "timesteps_this_iter": 0, "agent_timesteps_total": 1554228, "timers": {"sample_time_ms": 21359.866, "sample_throughput": 449.16, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3153.141, "learn_throughput": 3042.68, "update_time_ms": 9.745}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.179809570312501e-05, "cur_lr": 0.0005, "total_loss": 5.618742883205414, "policy_loss": -0.0014494944152174949, "vf_loss": 5.724173426628113, "vf_explained_var": -0.10380631685256958, "kl": 0.005958838097330523, "entropy": 10.398159503936768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 518076, "num_agent_steps_sampled": 1554228, "num_steps_trained": 518076, "num_agent_steps_trained": 1554228, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2514, "training_iteration": 54, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-02-05", "timestamp": 1706191325, "time_this_iter_s": 20.38042712211609, "time_total_s": 1126.6619668006897, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA35DC6940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1126.6619668006897, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 9.082758620689654, "ram_util_percent": 47.15172413793104}}
{"episode_reward_max": 108.68469199445099, "episode_reward_min": 8.555035613477216, "episode_reward_mean": 56.455652919549756, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": 2.739323844512299}, "policy_reward_max": {"shared_policy": 36.32108061667532}, "policy_reward_mean": {"shared_policy": 18.81855097318325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.958799637854085, 54.264499209821224, 50.89204439241438, 30.1593485516496, 52.45008339965716, 57.99585088994354, 108.68469199445099, 59.827772095799446, 57.66125690750776, 50.56184480502267, 25.859363134950385, 52.071757860481725, 65.07279157079755, 47.928453788161264, 58.62286661565301, 50.62518379185347, 64.11645989865062, 57.14166643470526, 50.63596698269245, 61.39052954351064, 53.25557093322274, 70.39042616076767, 53.56097678095102, 56.512912362813935, 56.68129605753347, 58.58821202581747, 57.83232354983919, 51.301320534199476, 59.63822565600276, 37.39346092939374, 59.469358760863514, 60.24373590480536, 54.55226079374552, 62.84258695319292, 59.85452746413647, 69.00236875843257, 61.8415626361966, 62.96472140401602, 58.05061310902238, 51.83682468906042, 47.67731278389691, 56.28423367999494, 44.42313269898294, 66.12977421144022, 80.40993746556339, 51.123743160860585, 61.064368650317164, 34.692387972158016, 62.567258805036545, 46.4513173722662, 58.99200673028825, 72.0617775544524, 62.503813605639124, 68.97034674882886, 62.98483797907829, 51.407430578023195, 59.092153184581534, 47.843866081908345, 67.79019239544868, 46.079044861719, 47.9714348837733, 73.21086699422449, 58.61445899680254, 66.97297425568104, 60.28013008460401, 55.943130888044806, 56.45710209757088, 55.65822193026543, 44.82425242662427, 64.06091431528327, 55.04281319491565, 36.9657997637987, 53.253473225282505, 55.89323025941846, 75.38553906511514, 71.01485396176574, 33.02651744289324, 77.93261733278632, 46.30143482284619, 66.88490978837945, 71.97889117279554, 77.25702917249872, 43.51429678872228, 38.32059613987802, 50.10890592448412, 63.65514905937016, 28.78966842591761, 74.31901036947966, 53.36174145899713, 60.439183162525296, 52.88574515469372, 51.21151442825794, 56.23774894326925, 52.90006406605244, 76.45964183285832, 48.20395369455218, 8.555035613477216, 55.0118204951286, 60.7029834706336, 54.67418336123225], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.9364031193157, 16.91631257285674, 17.106083945681647, 18.113758452236652, 18.155787140130997, 17.994953617453575, 17.09280580685784, 16.994640994196132, 16.804597591360405, 10.215699278283864, 9.958531059324741, 9.985118214040995, 17.60589883150533, 17.263565093278885, 17.580619474872947, 19.599032814614475, 18.94179378449917, 19.455024290829897, 36.32108061667532, 36.23584987223148, 36.127761505544186, 20.04756870865822, 19.94555066525936, 19.834652721881866, 19.33473512095709, 19.1136104290684, 19.21291135748227, 17.048637610316888, 16.861158358554036, 16.65204883615175, 8.631130264451102, 8.621015356232718, 8.607217514266566, 17.405646984775856, 17.294385900100067, 17.3717249756058, 21.943861312543348, 21.886729804178074, 21.242200454076126, 15.991849338014916, 15.952273232241467, 15.98433121790488, 19.40868608901897, 19.69841271887222, 19.51576780776182, 16.772742097576455, 17.124598993298903, 16.727842700978115, 21.32191979015866, 21.261405336360127, 21.53313477213183, 18.952652633190155, 19.03825555741787, 19.150758244097233, 16.746357309321553, 16.875444280604512, 17.014165392766387, 20.687597382813692, 20.98041312058922, 19.722519040107727, 18.000600478301436, 18.032747759173304, 17.222222695748002, 23.571781950071454, 23.414356872439384, 23.404287338256836, 17.742139592766762, 17.916655138134956, 17.902182050049305, 19.065933985014752, 18.808293988307312, 18.63868438949187, 18.964284093584865, 18.799137748777866, 18.91787421517074, 19.296681610246495, 19.708587840975568, 19.582942574595407, 18.94143673529227, 19.51844330494835, 19.37244350959857, 17.029092468321323, 16.737286046147346, 17.534942019730806, 19.89271004870534, 19.72920737415552, 20.0163082331419, 12.029884974161774, 12.750678262362868, 12.612897692869097, 20.024116581926734, 19.64108146975437, 19.804160709182412, 20.051467455923557, 20.259959916584194, 19.93230853229761, 18.1707668825984, 18.0863149613142, 18.295178949832916, 20.859500939647347, 20.917191381255776, 21.065894632289798, 19.902312533309058, 20.011799681310848, 19.940415249516562, 23.046243090182543, 23.0513851409778, 22.904740527272224, 20.569303688903645, 20.563499574859932, 20.708759372433022, 21.004861440509558, 20.967228800058365, 20.992631163448095, 19.390055302530527, 19.432051822543144, 19.228505983948708, 17.19405965010324, 17.497370942185313, 17.145394096771867, 16.021041383345917, 15.795879659553364, 15.860391740997628, 18.81400239467621, 19.04107745550573, 18.429153829813004, 14.849350300927952, 14.954436437537268, 14.61934596051772, 21.797470723589257, 22.200012817823634, 22.13229067002733, 26.89087024020651, 26.693651797870785, 26.825415427486092, 17.183813190010056, 17.03311768049994, 16.906812290350587, 20.37446370224157, 20.329944657782704, 20.35996029029289, 11.618491453429058, 11.031545927127198, 12.04235059160176, 20.920206256210804, 20.711590111255646, 20.935462437570095, 15.447964034974575, 15.534891600254923, 15.468461737036705, 19.639076021810368, 19.747391053785876, 19.60553965469201, 24.027724151810006, 24.0535217312475, 23.9805316713949, 20.766381079951913, 21.114362320435845, 20.623070205251366, 22.87749624500671, 23.06346750507751, 23.029382998744637, 21.26025191694498, 20.642433494329453, 21.08215256780386, 17.298685435205698, 16.91400407999754, 17.194741062819958, 19.66424436991413, 19.524658878644303, 19.9032499360231, 16.25474883057177, 15.824686333537102, 15.764430917799473, 22.62073601037264, 22.821661181747913, 22.347795203328133, 15.135172372062996, 15.414924332251147, 15.528948157404855, 15.796327004830033, 16.09200562412539, 16.083102254817874, 24.2069441229105, 24.585416383109987, 24.418506488204002, 19.784913229445607, 19.7241007896761, 19.105444977680833, 22.432752653956413, 22.35563899576664, 22.184582605957985, 20.147172724207238, 19.9971955170234, 20.135761843373373, 18.727766169855983, 18.489402557412774, 18.72596216077605, 18.5818886210521, 18.90711201479037, 18.96810146172841, 18.514361895620823, 18.65104279667139, 18.492817237973213, 14.667744661370904, 15.025165776411683, 15.131341988841683, 21.417967388095946, 21.259085866312176, 21.383861060875148, 18.042781367897987, 18.46366511285305, 18.536366714164615, 12.593532895048455, 12.342820112903908, 12.029446755846337, 17.745157189667225, 17.45002192258835, 18.058294113026932, 18.74774549404779, 18.50161355237165, 18.643871212999017, 24.623818715413407, 25.474679652911917, 25.287040696789816, 23.76113179574409, 23.911940375963837, 23.34178179005781, 11.084881910588592, 10.878473989665508, 11.063161542639136, 26.118093866854906, 26.220782406628132, 25.593741059303284, 15.225740176935986, 15.681174771705017, 15.394519874205187, 22.194570317864418, 22.27946064993739, 22.410878820577636, 23.751039271553353, 23.98926517864068, 24.23858672260151, 25.546012622614697, 25.635381293793515, 26.075635256090507, 14.647815011441708, 14.888912092894316, 13.977569684386253, 13.08022693296273, 12.172744577129677, 13.067624629785612, 16.686654356618718, 16.626087134083107, 16.796164433782295, 20.929939165711403, 21.490402264520526, 21.23480762913823, 9.615234741320208, 9.590311841418341, 9.584121843179062, 24.66867132484913, 24.636684119701385, 25.013654924929142, 17.83727529644966, 18.155080696567893, 17.369385465979576, 20.19090984016657, 20.272626476362348, 19.97564684599638, 17.772613821551204, 17.581088684499264, 17.532042648643255, 17.144087500870228, 17.43006321042776, 16.637363716959953, 18.904165416955948, 18.470666274428368, 18.862917251884937, 17.554681226611137, 17.871205657720566, 17.474177181720734, 25.493449091911316, 25.627590592950583, 25.338602147996426, 16.28541613742709, 16.066093750298023, 15.852443806827068, 2.739323844512299, 2.8264206846555027, 2.9892910843094143, 18.34423842529455, 18.429972181717545, 18.23760988811651, 20.240449788669736, 20.02740658322969, 20.43512709873417, 18.128768282632024, 18.253869118789822, 18.291545959810406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1616421640848142, "mean_inference_ms": 0.7267389349103419, "mean_action_processing_ms": 0.10122575147692653, "mean_env_wait_ms": 0.8413181915341518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 527670, "timesteps_this_iter": 0, "agent_timesteps_total": 1583010, "timers": {"sample_time_ms": 21383.682, "sample_throughput": 448.66, "load_time_ms": 0.25, "load_throughput": 38309360.792, "learn_time_ms": 3149.755, "learn_throughput": 3045.951, "update_time_ms": 9.839}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.179809570312501e-05, "cur_lr": 0.0005, "total_loss": 5.253559172153473, "policy_loss": -0.0008966335260931491, "vf_loss": 5.359461188316345, "vf_explained_var": -0.14045396447181702, "kl": 0.003570160231950486, "entropy": 10.50055181980133, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 527670, "num_agent_steps_sampled": 1583010, "num_steps_trained": 527670, "num_agent_steps_trained": 1583010, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2548, "training_iteration": 55, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-02-26", "timestamp": 1706191346, "time_this_iter_s": 20.723206520080566, "time_total_s": 1147.3851733207703, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B5E1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1147.3851733207703, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 8.600000000000001, "ram_util_percent": 46.679310344827584}}
{"episode_reward_max": 94.02860294282435, "episode_reward_min": 8.555035613477216, "episode_reward_mean": 57.978931092447745, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2.739323844512299}, "policy_reward_max": {"shared_policy": 31.468537931640938}, "policy_reward_mean": {"shared_policy": 19.326310364149244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.469358760863514, 60.24373590480536, 54.55226079374552, 62.84258695319292, 59.85452746413647, 69.00236875843257, 61.8415626361966, 62.96472140401602, 58.05061310902238, 51.83682468906042, 47.67731278389691, 56.28423367999494, 44.42313269898294, 66.12977421144022, 80.40993746556339, 51.123743160860585, 61.064368650317164, 34.692387972158016, 62.567258805036545, 46.4513173722662, 58.99200673028825, 72.0617775544524, 62.503813605639124, 68.97034674882886, 62.98483797907829, 51.407430578023195, 59.092153184581534, 47.843866081908345, 67.79019239544868, 46.079044861719, 47.9714348837733, 73.21086699422449, 58.61445899680254, 66.97297425568104, 60.28013008460401, 55.943130888044806, 56.45710209757088, 55.65822193026543, 44.82425242662427, 64.06091431528327, 55.04281319491565, 36.9657997637987, 53.253473225282505, 55.89323025941846, 75.38553906511514, 71.01485396176574, 33.02651744289324, 77.93261733278632, 46.30143482284619, 66.88490978837945, 71.97889117279554, 77.25702917249872, 43.51429678872228, 38.32059613987802, 50.10890592448412, 63.65514905937016, 28.78966842591761, 74.31901036947966, 53.36174145899713, 60.439183162525296, 52.88574515469372, 51.21151442825794, 56.23774894326925, 52.90006406605244, 76.45964183285832, 48.20395369455218, 8.555035613477216, 55.0118204951286, 60.7029834706336, 54.67418336123225, 60.00755414552985, 63.94448006898163, 59.326874893158646, 67.87186575494707, 85.0589204803109, 54.50316235423088, 57.66982128471135, 70.33081742748618, 60.92161662783472, 38.03458390757439, 54.81572973728177, 60.27158799022435, 71.47935415804386, 31.834175437688813, 40.192329988873084, 45.68732382357119, 46.08451968245207, 57.11887971032408, 67.90581025957361, 61.142249267548294, 83.44187972880897, 40.55619113147256, 57.11097536981103, 67.96033719182012, 51.520952837541685, 70.13980673998593, 77.67223788611591, 51.88318616151808, 65.88794679567216, 94.02860294282435], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.024116581926734, 19.64108146975437, 19.804160709182412, 20.051467455923557, 20.259959916584194, 19.93230853229761, 18.1707668825984, 18.0863149613142, 18.295178949832916, 20.859500939647347, 20.917191381255776, 21.065894632289798, 19.902312533309058, 20.011799681310848, 19.940415249516562, 23.046243090182543, 23.0513851409778, 22.904740527272224, 20.569303688903645, 20.563499574859932, 20.708759372433022, 21.004861440509558, 20.967228800058365, 20.992631163448095, 19.390055302530527, 19.432051822543144, 19.228505983948708, 17.19405965010324, 17.497370942185313, 17.145394096771867, 16.021041383345917, 15.795879659553364, 15.860391740997628, 18.81400239467621, 19.04107745550573, 18.429153829813004, 14.849350300927952, 14.954436437537268, 14.61934596051772, 21.797470723589257, 22.200012817823634, 22.13229067002733, 26.89087024020651, 26.693651797870785, 26.825415427486092, 17.183813190010056, 17.03311768049994, 16.906812290350587, 20.37446370224157, 20.329944657782704, 20.35996029029289, 11.618491453429058, 11.031545927127198, 12.04235059160176, 20.920206256210804, 20.711590111255646, 20.935462437570095, 15.447964034974575, 15.534891600254923, 15.468461737036705, 19.639076021810368, 19.747391053785876, 19.60553965469201, 24.027724151810006, 24.0535217312475, 23.9805316713949, 20.766381079951913, 21.114362320435845, 20.623070205251366, 22.87749624500671, 23.06346750507751, 23.029382998744637, 21.26025191694498, 20.642433494329453, 21.08215256780386, 17.298685435205698, 16.91400407999754, 17.194741062819958, 19.66424436991413, 19.524658878644303, 19.9032499360231, 16.25474883057177, 15.824686333537102, 15.764430917799473, 22.62073601037264, 22.821661181747913, 22.347795203328133, 15.135172372062996, 15.414924332251147, 15.528948157404855, 15.796327004830033, 16.09200562412539, 16.083102254817874, 24.2069441229105, 24.585416383109987, 24.418506488204002, 19.784913229445607, 19.7241007896761, 19.105444977680833, 22.432752653956413, 22.35563899576664, 22.184582605957985, 20.147172724207238, 19.9971955170234, 20.135761843373373, 18.727766169855983, 18.489402557412774, 18.72596216077605, 18.5818886210521, 18.90711201479037, 18.96810146172841, 18.514361895620823, 18.65104279667139, 18.492817237973213, 14.667744661370904, 15.025165776411683, 15.131341988841683, 21.417967388095946, 21.259085866312176, 21.383861060875148, 18.042781367897987, 18.46366511285305, 18.536366714164615, 12.593532895048455, 12.342820112903908, 12.029446755846337, 17.745157189667225, 17.45002192258835, 18.058294113026932, 18.74774549404779, 18.50161355237165, 18.643871212999017, 24.623818715413407, 25.474679652911917, 25.287040696789816, 23.76113179574409, 23.911940375963837, 23.34178179005781, 11.084881910588592, 10.878473989665508, 11.063161542639136, 26.118093866854906, 26.220782406628132, 25.593741059303284, 15.225740176935986, 15.681174771705017, 15.394519874205187, 22.194570317864418, 22.27946064993739, 22.410878820577636, 23.751039271553353, 23.98926517864068, 24.23858672260151, 25.546012622614697, 25.635381293793515, 26.075635256090507, 14.647815011441708, 14.888912092894316, 13.977569684386253, 13.08022693296273, 12.172744577129677, 13.067624629785612, 16.686654356618718, 16.626087134083107, 16.796164433782295, 20.929939165711403, 21.490402264520526, 21.23480762913823, 9.615234741320208, 9.590311841418341, 9.584121843179062, 24.66867132484913, 24.636684119701385, 25.013654924929142, 17.83727529644966, 18.155080696567893, 17.369385465979576, 20.19090984016657, 20.272626476362348, 19.97564684599638, 17.772613821551204, 17.581088684499264, 17.532042648643255, 17.144087500870228, 17.43006321042776, 16.637363716959953, 18.904165416955948, 18.470666274428368, 18.862917251884937, 17.554681226611137, 17.871205657720566, 17.474177181720734, 25.493449091911316, 25.627590592950583, 25.338602147996426, 16.28541613742709, 16.066093750298023, 15.852443806827068, 2.739323844512299, 2.8264206846555027, 2.9892910843094143, 18.34423842529455, 18.429972181717545, 18.23760988811651, 20.240449788669736, 20.02740658322969, 20.43512709873417, 18.128768282632024, 18.253869118789822, 18.291545959810406, 20.006932129462555, 19.742191058893994, 20.258430957173303, 21.383341049154595, 21.391451117893055, 21.169687901933983, 19.608634176353604, 19.91123855734864, 19.807002159456403, 22.311857387423515, 22.885195890441537, 22.674812477082014, 28.215503824253872, 28.185292353232697, 28.658124302824334, 17.922400124371052, 18.23718510568142, 18.34357712417841, 19.61459395041068, 18.826227714618042, 19.228999619682625, 23.181786999106407, 23.67828707769513, 23.470743350684643, 20.3215868504097, 20.179601089407996, 20.420428688017026, 12.513910631338746, 12.93776315326491, 12.58291012297073, 18.150677281121403, 18.34889032940069, 18.31616212675968, 20.077591521044567, 19.83716795345147, 20.35682851572831, 23.600613869726658, 23.96260714530945, 23.916133143007755, 10.36049736042817, 10.855933514734105, 10.61774456252654, 13.275533133496836, 13.33485236515601, 13.581944490220238, 15.228684083869055, 15.281679206838206, 15.17696053286393, 15.0014520039161, 15.45844442894061, 15.62462324959536, 19.024990542481333, 18.94163830826679, 19.152250859575958, 22.933236760688786, 22.24267578621705, 22.72989771266778, 19.9447838316361, 20.40928979466358, 20.788175641248614, 27.889305132130772, 28.10238340186575, 27.450191194812447, 13.421996893982083, 13.454431692759186, 13.67976254473129, 18.986569004754216, 18.915335233012826, 19.209071132043988, 22.36872402826944, 22.775231598565966, 22.81638156498471, 17.250861545403794, 16.945020725329712, 17.32507056680818, 23.27906238039334, 23.42389730860789, 23.436847050984696, 25.809709042310715, 25.868573304265738, 25.993955539539456, 17.321906891961888, 17.234947701295212, 17.326331568260983, 21.966633216788367, 21.82851031174262, 22.09280326714118, 31.468537931640938, 31.161077504356697, 31.398987506826714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16156014799831808, "mean_inference_ms": 0.7269104910324401, "mean_action_processing_ms": 0.10127615179550857, "mean_env_wait_ms": 0.8411002580200888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 537264, "timesteps_this_iter": 0, "agent_timesteps_total": 1611792, "timers": {"sample_time_ms": 21348.395, "sample_throughput": 449.401, "load_time_ms": 0.25, "load_throughput": 38309360.792, "learn_time_ms": 3149.99, "learn_throughput": 3045.724, "update_time_ms": 9.837}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0899047851562505e-05, "cur_lr": 0.0005, "total_loss": 6.364883303642273, "policy_loss": -0.00080303826611626, "vf_loss": 6.47076028585434, "vf_explained_var": -0.12291489541530609, "kl": 0.0051970644563439986, "entropy": 10.507408022880554, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 537264, "num_agent_steps_sampled": 1611792, "num_steps_trained": 537264, "num_agent_steps_trained": 1611792, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2578, "training_iteration": 56, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-02-46", "timestamp": 1706191366, "time_this_iter_s": 20.403475761413574, "time_total_s": 1167.7886490821838, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017901F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1167.7886490821838, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 7.862068965517241, "ram_util_percent": 46.53103448275861}}
{"episode_reward_max": 102.99299046769738, "episode_reward_min": 8.555035613477216, "episode_reward_mean": 57.659676989651054, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 2.739323844512299}, "policy_reward_max": {"shared_policy": 34.44529655203223}, "policy_reward_mean": {"shared_policy": 19.219892329883677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.97297425568104, 60.28013008460401, 55.943130888044806, 56.45710209757088, 55.65822193026543, 44.82425242662427, 64.06091431528327, 55.04281319491565, 36.9657997637987, 53.253473225282505, 55.89323025941846, 75.38553906511514, 71.01485396176574, 33.02651744289324, 77.93261733278632, 46.30143482284619, 66.88490978837945, 71.97889117279554, 77.25702917249872, 43.51429678872228, 38.32059613987802, 50.10890592448412, 63.65514905937016, 28.78966842591761, 74.31901036947966, 53.36174145899713, 60.439183162525296, 52.88574515469372, 51.21151442825794, 56.23774894326925, 52.90006406605244, 76.45964183285832, 48.20395369455218, 8.555035613477216, 55.0118204951286, 60.7029834706336, 54.67418336123225, 60.00755414552985, 63.94448006898163, 59.326874893158646, 67.87186575494707, 85.0589204803109, 54.50316235423088, 57.66982128471135, 70.33081742748618, 60.92161662783472, 38.03458390757439, 54.81572973728177, 60.27158799022435, 71.47935415804386, 31.834175437688813, 40.192329988873084, 45.68732382357119, 46.08451968245207, 57.11887971032408, 67.90581025957361, 61.142249267548294, 83.44187972880897, 40.55619113147256, 57.11097536981103, 67.96033719182012, 51.520952837541685, 70.13980673998593, 77.67223788611591, 51.88318616151808, 65.88794679567216, 94.02860294282435, 68.98735224083065, 61.85591731034219, 85.20358296344057, 44.32045686617491, 60.46828433126211, 19.999250210821614, 59.0354318190366, 74.06180257978848, 45.138237758073956, 67.06879291776566, 45.49317295476794, 63.15017009526491, 55.257416622713194, 38.10408088937402, 54.09648936241865, 48.261317569762454, 65.08264700544531, 62.14840358123183, 65.53627396933734, 42.431111387908444, 53.92321499250828, 65.85308976471423, 38.32170547544955, 58.7812679335475, 55.751425974071, 79.1056137084961, 62.07329028472304, 66.03594229370353, 55.86233546584843, 46.85066958330572, 14.042316250503049, 71.78479295875874, 102.99299046769738], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.432752653956413, 22.35563899576664, 22.184582605957985, 20.147172724207238, 19.9971955170234, 20.135761843373373, 18.727766169855983, 18.489402557412774, 18.72596216077605, 18.5818886210521, 18.90711201479037, 18.96810146172841, 18.514361895620823, 18.65104279667139, 18.492817237973213, 14.667744661370904, 15.025165776411683, 15.131341988841683, 21.417967388095946, 21.259085866312176, 21.383861060875148, 18.042781367897987, 18.46366511285305, 18.536366714164615, 12.593532895048455, 12.342820112903908, 12.029446755846337, 17.745157189667225, 17.45002192258835, 18.058294113026932, 18.74774549404779, 18.50161355237165, 18.643871212999017, 24.623818715413407, 25.474679652911917, 25.287040696789816, 23.76113179574409, 23.911940375963837, 23.34178179005781, 11.084881910588592, 10.878473989665508, 11.063161542639136, 26.118093866854906, 26.220782406628132, 25.593741059303284, 15.225740176935986, 15.681174771705017, 15.394519874205187, 22.194570317864418, 22.27946064993739, 22.410878820577636, 23.751039271553353, 23.98926517864068, 24.23858672260151, 25.546012622614697, 25.635381293793515, 26.075635256090507, 14.647815011441708, 14.888912092894316, 13.977569684386253, 13.08022693296273, 12.172744577129677, 13.067624629785612, 16.686654356618718, 16.626087134083107, 16.796164433782295, 20.929939165711403, 21.490402264520526, 21.23480762913823, 9.615234741320208, 9.590311841418341, 9.584121843179062, 24.66867132484913, 24.636684119701385, 25.013654924929142, 17.83727529644966, 18.155080696567893, 17.369385465979576, 20.19090984016657, 20.272626476362348, 19.97564684599638, 17.772613821551204, 17.581088684499264, 17.532042648643255, 17.144087500870228, 17.43006321042776, 16.637363716959953, 18.904165416955948, 18.470666274428368, 18.862917251884937, 17.554681226611137, 17.871205657720566, 17.474177181720734, 25.493449091911316, 25.627590592950583, 25.338602147996426, 16.28541613742709, 16.066093750298023, 15.852443806827068, 2.739323844512299, 2.8264206846555027, 2.9892910843094143, 18.34423842529455, 18.429972181717545, 18.23760988811651, 20.240449788669736, 20.02740658322969, 20.43512709873417, 18.128768282632024, 18.253869118789822, 18.291545959810406, 20.006932129462555, 19.742191058893994, 20.258430957173303, 21.383341049154595, 21.391451117893055, 21.169687901933983, 19.608634176353604, 19.91123855734864, 19.807002159456403, 22.311857387423515, 22.885195890441537, 22.674812477082014, 28.215503824253872, 28.185292353232697, 28.658124302824334, 17.922400124371052, 18.23718510568142, 18.34357712417841, 19.61459395041068, 18.826227714618042, 19.228999619682625, 23.181786999106407, 23.67828707769513, 23.470743350684643, 20.3215868504097, 20.179601089407996, 20.420428688017026, 12.513910631338746, 12.93776315326491, 12.58291012297073, 18.150677281121403, 18.34889032940069, 18.31616212675968, 20.077591521044567, 19.83716795345147, 20.35682851572831, 23.600613869726658, 23.96260714530945, 23.916133143007755, 10.36049736042817, 10.855933514734105, 10.61774456252654, 13.275533133496836, 13.33485236515601, 13.581944490220238, 15.228684083869055, 15.281679206838206, 15.17696053286393, 15.0014520039161, 15.45844442894061, 15.62462324959536, 19.024990542481333, 18.94163830826679, 19.152250859575958, 22.933236760688786, 22.24267578621705, 22.72989771266778, 19.9447838316361, 20.40928979466358, 20.788175641248614, 27.889305132130772, 28.10238340186575, 27.450191194812447, 13.421996893982083, 13.454431692759186, 13.67976254473129, 18.986569004754216, 18.915335233012826, 19.209071132043988, 22.36872402826944, 22.775231598565966, 22.81638156498471, 17.250861545403794, 16.945020725329712, 17.32507056680818, 23.27906238039334, 23.42389730860789, 23.436847050984696, 25.809709042310715, 25.868573304265738, 25.993955539539456, 17.321906891961888, 17.234947701295212, 17.326331568260983, 21.966633216788367, 21.82851031174262, 22.09280326714118, 31.468537931640938, 31.161077504356697, 31.398987506826714, 22.71323724587758, 23.13036938135822, 23.143745613594845, 20.514297425746918, 20.438223458826542, 20.903396425768733, 28.258856385946274, 28.852652034256607, 28.092074543237686, 14.705503730724246, 14.8259783151249, 14.788974820325762, 20.244227148592472, 20.24239084124565, 19.98166634142399, 6.734745570768908, 6.46829606344302, 6.796208576609686, 19.547466807067394, 19.847185289487243, 19.640779722481966, 24.511833821733788, 24.791695648881912, 24.758273109172777, 15.253696062136441, 14.721243679523468, 15.163298016414046, 21.40918933351834, 22.623833050330475, 23.035770533916846, 14.943485498428345, 15.321517508476973, 15.228169947862625, 20.801149986684322, 21.10283375531435, 21.24618635326624, 18.531921358158186, 18.03799720605214, 18.687498058502868, 12.96575815603137, 12.434064626693726, 12.704258106648922, 18.085570745170116, 17.87869982421398, 18.132218793034554, 16.34111226101716, 15.656696339448288, 16.263508969297007, 21.51528425266345, 21.71579224740465, 21.85157050537721, 20.391048789024353, 20.745493732392788, 21.01186105981469, 21.57604791224003, 21.807345002889633, 22.152881054207683, 14.070798759659127, 14.21772853036721, 14.142584097882107, 17.917274830241993, 17.943561959390834, 18.06237820287545, 21.708934878309563, 22.06532000874479, 22.078834877659872, 12.81473272045453, 12.7480679800113, 12.75890477498372, 19.60957282781601, 19.630363412201405, 19.541331693530083, 18.393547887603432, 18.84825153152147, 18.509626554946095, 26.328556708991528, 26.243813768029213, 26.533243231475353, 20.469662681221962, 20.902196880429983, 20.7014307230711, 21.913396048049123, 21.837054679791123, 22.285491565863282, 18.788596508403614, 18.23459670444329, 18.839142253001526, 15.962898841127753, 15.41552048921585, 15.472250252962112, 4.835633282860115, 4.445806500812367, 4.760876466830567, 23.89873473967114, 23.77185222754875, 24.114205991538853, 34.44529655203223, 34.363876327872276, 34.18381758779287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16140998565622255, "mean_inference_ms": 0.7266806533167474, "mean_action_processing_ms": 0.10133275931958206, "mean_env_wait_ms": 0.8405526051329251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 546858, "timesteps_this_iter": 0, "agent_timesteps_total": 1640574, "timers": {"sample_time_ms": 21277.369, "sample_throughput": 450.902, "load_time_ms": 0.25, "load_throughput": 38309360.792, "learn_time_ms": 3151.24, "learn_throughput": 3044.516, "update_time_ms": 9.637}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0899047851562505e-05, "cur_lr": 0.0005, "total_loss": 6.212029159069061, "policy_loss": -0.0007128781894966685, "vf_loss": 6.317248284816742, "vf_explained_var": -0.007669106125831604, "kl": 0.0034279132378762225, "entropy": 10.450643181800842, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 546858, "num_agent_steps_sampled": 1640574, "num_steps_trained": 546858, "num_agent_steps_trained": 1640574, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2611, "training_iteration": 57, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-03-06", "timestamp": 1706191386, "time_this_iter_s": 20.22967028617859, "time_total_s": 1188.0183193683624, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B5E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1188.0183193683624, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 8.648275862068965, "ram_util_percent": 46.71379310344827}}
{"episode_reward_max": 102.99299046769738, "episode_reward_min": 8.555035613477216, "episode_reward_mean": 55.8238115157769, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 2.739323844512299}, "policy_reward_max": {"shared_policy": 34.44529655203223}, "policy_reward_mean": {"shared_policy": 18.60793717192563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.555035613477216, 55.0118204951286, 60.7029834706336, 54.67418336123225, 60.00755414552985, 63.94448006898163, 59.326874893158646, 67.87186575494707, 85.0589204803109, 54.50316235423088, 57.66982128471135, 70.33081742748618, 60.92161662783472, 38.03458390757439, 54.81572973728177, 60.27158799022435, 71.47935415804386, 31.834175437688813, 40.192329988873084, 45.68732382357119, 46.08451968245207, 57.11887971032408, 67.90581025957361, 61.142249267548294, 83.44187972880897, 40.55619113147256, 57.11097536981103, 67.96033719182012, 51.520952837541685, 70.13980673998593, 77.67223788611591, 51.88318616151808, 65.88794679567216, 94.02860294282435, 68.98735224083065, 61.85591731034219, 85.20358296344057, 44.32045686617491, 60.46828433126211, 19.999250210821614, 59.0354318190366, 74.06180257978848, 45.138237758073956, 67.06879291776566, 45.49317295476794, 63.15017009526491, 55.257416622713194, 38.10408088937402, 54.09648936241865, 48.261317569762454, 65.08264700544531, 62.14840358123183, 65.53627396933734, 42.431111387908444, 53.92321499250828, 65.85308976471423, 38.32170547544955, 58.7812679335475, 55.751425974071, 79.1056137084961, 62.07329028472304, 66.03594229370353, 55.86233546584843, 46.85066958330572, 14.042316250503049, 71.78479295875874, 102.99299046769738, 60.944211133290054, 70.31090454384683, 74.58763772342354, 61.04138507694006, 43.83767696563153, 61.05778423976153, 77.98195158410817, 47.91698624100536, 49.406953882425995, 70.34501948952673, 60.385529123246656, 49.62107810750601, 74.25518064200877, 63.29741895571351, 50.632140980800614, 35.73321839980778, 18.097964016720624, 25.18664033245294, 14.96694449428469, 18.33212343323973, 34.13755694497374, 34.59567368403076, 58.03882595896721, 49.275662984699, 49.29449712485075, 27.194791026413412, 80.66529039852318, 59.35732568567617, 50.89061869774012, 57.53697899729012, 32.013577327132225, 76.78796751704067, 54.22699154913424], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [2.739323844512299, 2.8264206846555027, 2.9892910843094143, 18.34423842529455, 18.429972181717545, 18.23760988811651, 20.240449788669736, 20.02740658322969, 20.43512709873417, 18.128768282632024, 18.253869118789822, 18.291545959810406, 20.006932129462555, 19.742191058893994, 20.258430957173303, 21.383341049154595, 21.391451117893055, 21.169687901933983, 19.608634176353604, 19.91123855734864, 19.807002159456403, 22.311857387423515, 22.885195890441537, 22.674812477082014, 28.215503824253872, 28.185292353232697, 28.658124302824334, 17.922400124371052, 18.23718510568142, 18.34357712417841, 19.61459395041068, 18.826227714618042, 19.228999619682625, 23.181786999106407, 23.67828707769513, 23.470743350684643, 20.3215868504097, 20.179601089407996, 20.420428688017026, 12.513910631338746, 12.93776315326491, 12.58291012297073, 18.150677281121403, 18.34889032940069, 18.31616212675968, 20.077591521044567, 19.83716795345147, 20.35682851572831, 23.600613869726658, 23.96260714530945, 23.916133143007755, 10.36049736042817, 10.855933514734105, 10.61774456252654, 13.275533133496836, 13.33485236515601, 13.581944490220238, 15.228684083869055, 15.281679206838206, 15.17696053286393, 15.0014520039161, 15.45844442894061, 15.62462324959536, 19.024990542481333, 18.94163830826679, 19.152250859575958, 22.933236760688786, 22.24267578621705, 22.72989771266778, 19.9447838316361, 20.40928979466358, 20.788175641248614, 27.889305132130772, 28.10238340186575, 27.450191194812447, 13.421996893982083, 13.454431692759186, 13.67976254473129, 18.986569004754216, 18.915335233012826, 19.209071132043988, 22.36872402826944, 22.775231598565966, 22.81638156498471, 17.250861545403794, 16.945020725329712, 17.32507056680818, 23.27906238039334, 23.42389730860789, 23.436847050984696, 25.809709042310715, 25.868573304265738, 25.993955539539456, 17.321906891961888, 17.234947701295212, 17.326331568260983, 21.966633216788367, 21.82851031174262, 22.09280326714118, 31.468537931640938, 31.161077504356697, 31.398987506826714, 22.71323724587758, 23.13036938135822, 23.143745613594845, 20.514297425746918, 20.438223458826542, 20.903396425768733, 28.258856385946274, 28.852652034256607, 28.092074543237686, 14.705503730724246, 14.8259783151249, 14.788974820325762, 20.244227148592472, 20.24239084124565, 19.98166634142399, 6.734745570768908, 6.46829606344302, 6.796208576609686, 19.547466807067394, 19.847185289487243, 19.640779722481966, 24.511833821733788, 24.791695648881912, 24.758273109172777, 15.253696062136441, 14.721243679523468, 15.163298016414046, 21.40918933351834, 22.623833050330475, 23.035770533916846, 14.943485498428345, 15.321517508476973, 15.228169947862625, 20.801149986684322, 21.10283375531435, 21.24618635326624, 18.531921358158186, 18.03799720605214, 18.687498058502868, 12.96575815603137, 12.434064626693726, 12.704258106648922, 18.085570745170116, 17.87869982421398, 18.132218793034554, 16.34111226101716, 15.656696339448288, 16.263508969297007, 21.51528425266345, 21.71579224740465, 21.85157050537721, 20.391048789024353, 20.745493732392788, 21.01186105981469, 21.57604791224003, 21.807345002889633, 22.152881054207683, 14.070798759659127, 14.21772853036721, 14.142584097882107, 17.917274830241993, 17.943561959390834, 18.06237820287545, 21.708934878309563, 22.06532000874479, 22.078834877659872, 12.81473272045453, 12.7480679800113, 12.75890477498372, 19.60957282781601, 19.630363412201405, 19.541331693530083, 18.393547887603432, 18.84825153152147, 18.509626554946095, 26.328556708991528, 26.243813768029213, 26.533243231475353, 20.469662681221962, 20.902196880429983, 20.7014307230711, 21.913396048049123, 21.837054679791123, 22.285491565863282, 18.788596508403614, 18.23459670444329, 18.839142253001526, 15.962898841127753, 15.41552048921585, 15.472250252962112, 4.835633282860115, 4.445806500812367, 4.760876466830567, 23.89873473967114, 23.77185222754875, 24.114205991538853, 34.44529655203223, 34.363876327872276, 34.18381758779287, 20.40288928259784, 20.300779157007725, 20.24054269368449, 23.540978308146194, 23.2297973682483, 23.54012886745234, 24.840019153431058, 24.930795616470277, 24.816822953522205, 20.274166375398636, 20.31816838681698, 20.449050314724445, 14.694830680576459, 14.521684305121497, 14.621161979933575, 20.06120403110981, 20.416125755757093, 20.580454452894628, 26.079718974418938, 25.93547248840332, 25.966760121285915, 16.008535059168935, 16.085008521564305, 15.823442660272121, 16.556773899743945, 16.35435419778028, 16.49582578490177, 23.64241689940293, 23.479332593580082, 23.22326999654372, 19.867694621284798, 20.207691137989357, 20.3101433639725, 16.390023323396832, 16.62104231181243, 16.610012472296745, 24.934254103650645, 24.72707376008232, 24.593852778275803, 21.267711155116558, 20.789199963212013, 21.24050783738494, 16.534297831356525, 17.006829848513007, 17.09101330093108, 11.331651146213204, 12.23491879242161, 12.166648461172969, 6.1318159333119695, 5.813938076297433, 6.152210007111222, 8.424102184673146, 8.216289473076657, 8.546248674703136, 5.236655601300299, 4.842135116457939, 4.888153776526451, 6.400720409738511, 6.037554780642182, 5.893848242859036, 11.486793461876601, 11.205205487708241, 11.445557995388896, 11.57969351050754, 11.48109272246559, 11.534887451057628, 19.20010568201542, 19.586181804537773, 19.252538472414017, 16.424665187795952, 16.664421090235308, 16.186576706667736, 16.369040936231613, 16.399705663323402, 16.525750525295734, 9.465281429390103, 9.28790348271528, 8.44160611430803, 26.897015747303755, 26.89885418737927, 26.869420463840157, 19.940145087738827, 19.931373665885374, 19.485806932051972, 17.053175688100353, 16.956812332694724, 16.880630676945046, 18.50849852462609, 19.56119199780126, 19.46728847486277, 10.480731710791588, 10.769477359950542, 10.763368256390095, 25.421503759920597, 25.79102412890643, 25.575439628213644, 17.99448512991269, 18.206201796730355, 18.026304622491196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1613300709973063, "mean_inference_ms": 0.7264887609414774, "mean_action_processing_ms": 0.1013604457721895, "mean_env_wait_ms": 0.8400726347987526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 556452, "timesteps_this_iter": 0, "agent_timesteps_total": 1669356, "timers": {"sample_time_ms": 21212.861, "sample_throughput": 452.273, "load_time_ms": 0.25, "load_throughput": 38309360.792, "learn_time_ms": 3138.266, "learn_throughput": 3057.103, "update_time_ms": 9.387}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5449523925781253e-05, "cur_lr": 0.0005, "total_loss": 5.431122362613678, "policy_loss": -0.0007810560420966617, "vf_loss": 5.536689639091492, "vf_explained_var": 0.024196408689022064, "kl": 0.0044118911610467465, "entropy": 10.478618621826172, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 556452, "num_agent_steps_sampled": 1669356, "num_steps_trained": 556452, "num_agent_steps_trained": 1669356, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2644, "training_iteration": 58, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-03-27", "timestamp": 1706191407, "time_this_iter_s": 20.41413116455078, "time_total_s": 1208.4324505329132, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1208.4324505329132, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 9.279310344827588, "ram_util_percent": 46.87931034482759}}
{"episode_reward_max": 102.99299046769738, "episode_reward_min": -8.748603112995639, "episode_reward_mean": 53.69941545793554, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -3.210705439249679}, "policy_reward_max": {"shared_policy": 34.44529655203223}, "policy_reward_mean": {"shared_policy": 17.899805152645172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.88318616151808, 65.88794679567216, 94.02860294282435, 68.98735224083065, 61.85591731034219, 85.20358296344057, 44.32045686617491, 60.46828433126211, 19.999250210821614, 59.0354318190366, 74.06180257978848, 45.138237758073956, 67.06879291776566, 45.49317295476794, 63.15017009526491, 55.257416622713194, 38.10408088937402, 54.09648936241865, 48.261317569762454, 65.08264700544531, 62.14840358123183, 65.53627396933734, 42.431111387908444, 53.92321499250828, 65.85308976471423, 38.32170547544955, 58.7812679335475, 55.751425974071, 79.1056137084961, 62.07329028472304, 66.03594229370353, 55.86233546584843, 46.85066958330572, 14.042316250503049, 71.78479295875874, 102.99299046769738, 60.944211133290054, 70.31090454384683, 74.58763772342354, 61.04138507694006, 43.83767696563153, 61.05778423976153, 77.98195158410817, 47.91698624100536, 49.406953882425995, 70.34501948952673, 60.385529123246656, 49.62107810750601, 74.25518064200877, 63.29741895571351, 50.632140980800614, 35.73321839980778, 18.097964016720624, 25.18664033245294, 14.96694449428469, 18.33212343323973, 34.13755694497374, 34.59567368403076, 58.03882595896721, 49.275662984699, 49.29449712485075, 27.194791026413412, 80.66529039852318, 59.35732568567617, 50.89061869774012, 57.53697899729012, 32.013577327132225, 76.78796751704067, 54.22699154913424, 57.07563779875635, 63.61166929081081, 22.054897036403418, 42.36285612266508, 73.38830000907183, 39.099564000964165, 69.89925869926807, 57.715143878012896, 57.9165835008025, 63.474403447471545, 17.10251233354208, 64.13857858255504, 66.62450892850754, 62.758980333805056, 52.78142774105069, 23.228777416050406, 80.7482337541878, 50.9748623324558, 43.58959976618641, 24.887150254100547, 63.45640159072353, 42.574197575449915, 55.10905786603688, 61.420055836439104, 73.67700508330017, 54.53744289092718, 35.75256534665823, 60.83394550904629, 41.504118755459785, 55.55932247452438, -8.748603112995639], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.321906891961888, 17.234947701295212, 17.326331568260983, 21.966633216788367, 21.82851031174262, 22.09280326714118, 31.468537931640938, 31.161077504356697, 31.398987506826714, 22.71323724587758, 23.13036938135822, 23.143745613594845, 20.514297425746918, 20.438223458826542, 20.903396425768733, 28.258856385946274, 28.852652034256607, 28.092074543237686, 14.705503730724246, 14.8259783151249, 14.788974820325762, 20.244227148592472, 20.24239084124565, 19.98166634142399, 6.734745570768908, 6.46829606344302, 6.796208576609686, 19.547466807067394, 19.847185289487243, 19.640779722481966, 24.511833821733788, 24.791695648881912, 24.758273109172777, 15.253696062136441, 14.721243679523468, 15.163298016414046, 21.40918933351834, 22.623833050330475, 23.035770533916846, 14.943485498428345, 15.321517508476973, 15.228169947862625, 20.801149986684322, 21.10283375531435, 21.24618635326624, 18.531921358158186, 18.03799720605214, 18.687498058502868, 12.96575815603137, 12.434064626693726, 12.704258106648922, 18.085570745170116, 17.87869982421398, 18.132218793034554, 16.34111226101716, 15.656696339448288, 16.263508969297007, 21.51528425266345, 21.71579224740465, 21.85157050537721, 20.391048789024353, 20.745493732392788, 21.01186105981469, 21.57604791224003, 21.807345002889633, 22.152881054207683, 14.070798759659127, 14.21772853036721, 14.142584097882107, 17.917274830241993, 17.943561959390834, 18.06237820287545, 21.708934878309563, 22.06532000874479, 22.078834877659872, 12.81473272045453, 12.7480679800113, 12.75890477498372, 19.60957282781601, 19.630363412201405, 19.541331693530083, 18.393547887603432, 18.84825153152147, 18.509626554946095, 26.328556708991528, 26.243813768029213, 26.533243231475353, 20.469662681221962, 20.902196880429983, 20.7014307230711, 21.913396048049123, 21.837054679791123, 22.285491565863282, 18.788596508403614, 18.23459670444329, 18.839142253001526, 15.962898841127753, 15.41552048921585, 15.472250252962112, 4.835633282860115, 4.445806500812367, 4.760876466830567, 23.89873473967114, 23.77185222754875, 24.114205991538853, 34.44529655203223, 34.363876327872276, 34.18381758779287, 20.40288928259784, 20.300779157007725, 20.24054269368449, 23.540978308146194, 23.2297973682483, 23.54012886745234, 24.840019153431058, 24.930795616470277, 24.816822953522205, 20.274166375398636, 20.31816838681698, 20.449050314724445, 14.694830680576459, 14.521684305121497, 14.621161979933575, 20.06120403110981, 20.416125755757093, 20.580454452894628, 26.079718974418938, 25.93547248840332, 25.966760121285915, 16.008535059168935, 16.085008521564305, 15.823442660272121, 16.556773899743945, 16.35435419778028, 16.49582578490177, 23.64241689940293, 23.479332593580082, 23.22326999654372, 19.867694621284798, 20.207691137989357, 20.3101433639725, 16.390023323396832, 16.62104231181243, 16.610012472296745, 24.934254103650645, 24.72707376008232, 24.593852778275803, 21.267711155116558, 20.789199963212013, 21.24050783738494, 16.534297831356525, 17.006829848513007, 17.09101330093108, 11.331651146213204, 12.23491879242161, 12.166648461172969, 6.1318159333119695, 5.813938076297433, 6.152210007111222, 8.424102184673146, 8.216289473076657, 8.546248674703136, 5.236655601300299, 4.842135116457939, 4.888153776526451, 6.400720409738511, 6.037554780642182, 5.893848242859036, 11.486793461876601, 11.205205487708241, 11.445557995388896, 11.57969351050754, 11.48109272246559, 11.534887451057628, 19.20010568201542, 19.586181804537773, 19.252538472414017, 16.424665187795952, 16.664421090235308, 16.186576706667736, 16.369040936231613, 16.399705663323402, 16.525750525295734, 9.465281429390103, 9.28790348271528, 8.44160611430803, 26.897015747303755, 26.89885418737927, 26.869420463840157, 19.940145087738827, 19.931373665885374, 19.485806932051972, 17.053175688100353, 16.956812332694724, 16.880630676945046, 18.50849852462609, 19.56119199780126, 19.46728847486277, 10.480731710791588, 10.769477359950542, 10.763368256390095, 25.421503759920597, 25.79102412890643, 25.575439628213644, 17.99448512991269, 18.206201796730355, 18.026304622491196, 19.264067993809775, 18.845278066893414, 18.966291738053158, 21.404940911879137, 20.940654908617333, 21.26607347031434, 7.306453850120306, 7.434072107076645, 7.314371079206467, 14.13501717398563, 14.002851362029702, 14.224987586649746, 24.588874600827694, 24.472168184816837, 24.327257223427296, 13.043934494256973, 13.118828512728214, 12.936800993978977, 23.489911342660577, 23.279920770476252, 23.129426586131245, 19.181216806173325, 19.156362861394882, 19.37756421044469, 19.246116401006773, 19.313864101966217, 19.356602997829512, 20.725717966755226, 21.37514525170748, 21.37354022900884, 5.948102737466485, 5.854139684389025, 5.30026991168657, 21.583781116952494, 21.43499568601449, 21.11980177958806, 22.27650466064611, 22.10293977210918, 22.245064495752246, 20.921145769457013, 20.93632589901486, 20.901508665333182, 17.325140366951615, 17.639414759973675, 17.8168726141254, 8.022014322380215, 7.400602037707955, 7.806161055962235, 26.720695624748856, 26.770933176080376, 27.25660495335856, 17.382464759362236, 16.92361032714446, 16.668787245949105, 14.829795698674076, 14.339571798841149, 14.420232268671185, 8.337122955669955, 8.289424096544579, 8.260603201886013, 21.013191645344094, 21.09516956408818, 21.348040381291256, 13.967914047340543, 14.31929739813009, 14.286986129979283, 18.46027213831742, 18.253982604791716, 18.39480312292774, 20.376704851786286, 20.262864525119454, 20.780486459533364, 24.746489473618567, 24.58720251917839, 24.343313090503216, 18.220326719184712, 18.661180357759193, 17.655935813983277, 11.447426989674568, 11.824716866016388, 12.480421490967274, 20.27654428097108, 20.349485204244644, 20.207916023830563, 13.797764658927917, 13.573800727725029, 14.132553368806839, 18.412866842001677, 18.63752236403525, 18.508933268487453, -2.957622776428863, -2.5802748973170964, -3.210705439249679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16123277472988914, "mean_inference_ms": 0.7262441688295876, "mean_action_processing_ms": 0.10124516047811381, "mean_env_wait_ms": 0.8395152124480079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 566046, "timesteps_this_iter": 0, "agent_timesteps_total": 1698138, "timers": {"sample_time_ms": 21138.25, "sample_throughput": 453.869, "load_time_ms": 0.351, "load_throughput": 27340774.953, "learn_time_ms": 3136.414, "learn_throughput": 3058.908, "update_time_ms": 9.438}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.724761962890626e-06, "cur_lr": 0.0005, "total_loss": 6.055803179740906, "policy_loss": -0.0014725374781826561, "vf_loss": 6.162784934043884, "vf_explained_var": 0.03057863563299179, "kl": 0.0031503122736958418, "entropy": 10.550915002822876, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 566046, "num_agent_steps_sampled": 1698138, "num_steps_trained": 566046, "num_agent_steps_trained": 1698138, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2675, "training_iteration": 59, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-03-47", "timestamp": 1706191427, "time_this_iter_s": 20.20453977584839, "time_total_s": 1228.6369903087616, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017901F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1228.6369903087616, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 8.141379310344828, "ram_util_percent": 46.96896551724138}}
{"episode_reward_max": 102.99299046769738, "episode_reward_min": -8.748603112995639, "episode_reward_mean": 53.63297469197627, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -3.210705439249679}, "policy_reward_max": {"shared_policy": 34.44529655203223}, "policy_reward_mean": {"shared_policy": 17.87765823065875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.042316250503049, 71.78479295875874, 102.99299046769738, 60.944211133290054, 70.31090454384683, 74.58763772342354, 61.04138507694006, 43.83767696563153, 61.05778423976153, 77.98195158410817, 47.91698624100536, 49.406953882425995, 70.34501948952673, 60.385529123246656, 49.62107810750601, 74.25518064200877, 63.29741895571351, 50.632140980800614, 35.73321839980778, 18.097964016720624, 25.18664033245294, 14.96694449428469, 18.33212343323973, 34.13755694497374, 34.59567368403076, 58.03882595896721, 49.275662984699, 49.29449712485075, 27.194791026413412, 80.66529039852318, 59.35732568567617, 50.89061869774012, 57.53697899729012, 32.013577327132225, 76.78796751704067, 54.22699154913424, 57.07563779875635, 63.61166929081081, 22.054897036403418, 42.36285612266508, 73.38830000907183, 39.099564000964165, 69.89925869926807, 57.715143878012896, 57.9165835008025, 63.474403447471545, 17.10251233354208, 64.13857858255504, 66.62450892850754, 62.758980333805056, 52.78142774105069, 23.228777416050406, 80.7482337541878, 50.9748623324558, 43.58959976618641, 24.887150254100547, 63.45640159072353, 42.574197575449915, 55.10905786603688, 61.420055836439104, 73.67700508330017, 54.53744289092718, 35.75256534665823, 60.83394550904629, 41.504118755459785, 55.55932247452438, -8.748603112995639, 60.614041085354984, 71.035757035017, 32.225574631243944, 74.0220232317224, 76.25102365948257, 63.94175119325516, 66.63469309732317, 63.487424165010424, 75.30356734804806, 21.68851851299405, 77.47648898512124, 64.80163676667144, 50.10901945084332, 61.82220662757754, 57.982124475762234, 59.77973315119743, 33.926811978220925, 13.863982433103928, 59.71289716847241, 73.02444617450234, 78.76058785244821, 36.68402475788025, 73.50147709250449, 36.11910282820462, 73.18267911672592, 50.52298282831906, 58.647321868687854, 70.80840409174562, 69.31414081901309, 71.07239717466288, 55.23391303606331, 33.36746179219334, 48.496192786842556], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [4.835633282860115, 4.445806500812367, 4.760876466830567, 23.89873473967114, 23.77185222754875, 24.114205991538853, 34.44529655203223, 34.363876327872276, 34.18381758779287, 20.40288928259784, 20.300779157007725, 20.24054269368449, 23.540978308146194, 23.2297973682483, 23.54012886745234, 24.840019153431058, 24.930795616470277, 24.816822953522205, 20.274166375398636, 20.31816838681698, 20.449050314724445, 14.694830680576459, 14.521684305121497, 14.621161979933575, 20.06120403110981, 20.416125755757093, 20.580454452894628, 26.079718974418938, 25.93547248840332, 25.966760121285915, 16.008535059168935, 16.085008521564305, 15.823442660272121, 16.556773899743945, 16.35435419778028, 16.49582578490177, 23.64241689940293, 23.479332593580082, 23.22326999654372, 19.867694621284798, 20.207691137989357, 20.3101433639725, 16.390023323396832, 16.62104231181243, 16.610012472296745, 24.934254103650645, 24.72707376008232, 24.593852778275803, 21.267711155116558, 20.789199963212013, 21.24050783738494, 16.534297831356525, 17.006829848513007, 17.09101330093108, 11.331651146213204, 12.23491879242161, 12.166648461172969, 6.1318159333119695, 5.813938076297433, 6.152210007111222, 8.424102184673146, 8.216289473076657, 8.546248674703136, 5.236655601300299, 4.842135116457939, 4.888153776526451, 6.400720409738511, 6.037554780642182, 5.893848242859036, 11.486793461876601, 11.205205487708241, 11.445557995388896, 11.57969351050754, 11.48109272246559, 11.534887451057628, 19.20010568201542, 19.586181804537773, 19.252538472414017, 16.424665187795952, 16.664421090235308, 16.186576706667736, 16.369040936231613, 16.399705663323402, 16.525750525295734, 9.465281429390103, 9.28790348271528, 8.44160611430803, 26.897015747303755, 26.89885418737927, 26.869420463840157, 19.940145087738827, 19.931373665885374, 19.485806932051972, 17.053175688100353, 16.956812332694724, 16.880630676945046, 18.50849852462609, 19.56119199780126, 19.46728847486277, 10.480731710791588, 10.769477359950542, 10.763368256390095, 25.421503759920597, 25.79102412890643, 25.575439628213644, 17.99448512991269, 18.206201796730355, 18.026304622491196, 19.264067993809775, 18.845278066893414, 18.966291738053158, 21.404940911879137, 20.940654908617333, 21.26607347031434, 7.306453850120306, 7.434072107076645, 7.314371079206467, 14.13501717398563, 14.002851362029702, 14.224987586649746, 24.588874600827694, 24.472168184816837, 24.327257223427296, 13.043934494256973, 13.118828512728214, 12.936800993978977, 23.489911342660577, 23.279920770476252, 23.129426586131245, 19.181216806173325, 19.156362861394882, 19.37756421044469, 19.246116401006773, 19.313864101966217, 19.356602997829512, 20.725717966755226, 21.37514525170748, 21.37354022900884, 5.948102737466485, 5.854139684389025, 5.30026991168657, 21.583781116952494, 21.43499568601449, 21.11980177958806, 22.27650466064611, 22.10293977210918, 22.245064495752246, 20.921145769457013, 20.93632589901486, 20.901508665333182, 17.325140366951615, 17.639414759973675, 17.8168726141254, 8.022014322380215, 7.400602037707955, 7.806161055962235, 26.720695624748856, 26.770933176080376, 27.25660495335856, 17.382464759362236, 16.92361032714446, 16.668787245949105, 14.829795698674076, 14.339571798841149, 14.420232268671185, 8.337122955669955, 8.289424096544579, 8.260603201886013, 21.013191645344094, 21.09516956408818, 21.348040381291256, 13.967914047340543, 14.31929739813009, 14.286986129979283, 18.46027213831742, 18.253982604791716, 18.39480312292774, 20.376704851786286, 20.262864525119454, 20.780486459533364, 24.746489473618567, 24.58720251917839, 24.343313090503216, 18.220326719184712, 18.661180357759193, 17.655935813983277, 11.447426989674568, 11.824716866016388, 12.480421490967274, 20.27654428097108, 20.349485204244644, 20.207916023830563, 13.797764658927917, 13.573800727725029, 14.132553368806839, 18.412866842001677, 18.63752236403525, 18.508933268487453, -2.957622776428863, -2.5802748973170964, -3.210705439249679, 20.457393950782716, 19.824963361024857, 20.33168377354741, 23.39905313154061, 23.88154902433355, 23.755154879142836, 10.803399316966534, 10.918002005666494, 10.504173308610916, 24.73306084548433, 24.903203035083905, 24.385759351154164, 25.660943229372293, 25.389521698156983, 25.200558731953294, 21.542119233558566, 21.370676624278218, 21.028955335418374, 22.00806314994891, 22.3236565751334, 22.302973372240857, 21.298051471511513, 21.097271549204976, 21.092101144293935, 24.92693469176689, 24.95563831428686, 25.420994341994316, 7.207794651389122, 7.104016967117786, 7.376706894487143, 26.086438981195286, 25.8951806773742, 25.49486932655175, 21.50887218862772, 21.83979588377406, 21.452968694269657, 16.77953267594178, 16.785947663088635, 16.543539111812905, 20.593455746769905, 20.868508961051702, 20.360241919755936, 19.200231974323586, 19.49553751510878, 19.28635498632987, 19.840404525399208, 19.92240049317479, 20.016928132623434, 11.256703925629452, 11.232304391761616, 11.437803660829857, 4.30006983379522, 4.469977493087441, 5.0939351062212666, 19.912324868142605, 19.79476699978113, 20.005805300548673, 23.93983521560827, 24.383100057641656, 24.70151090125242, 26.16368857522805, 26.142629620929554, 26.454269656290606, 12.21264705620706, 12.250328981957864, 12.221048719715327, 24.38757823159297, 24.54412924436231, 24.56976961654921, 11.766825055082634, 12.160751612236098, 12.191526160885886, 24.05417673289776, 24.582117330282927, 24.546385053545237, 16.819639918704823, 16.665360709031418, 17.037982200582817, 19.46751781304677, 19.76979377244909, 19.410010283191994, 23.796605419367552, 23.612719260156155, 23.39907941222191, 23.099254863957555, 23.060598271588475, 23.15428768346706, 23.6264495315651, 23.583265556643397, 23.862682086454384, 17.90465146303177, 18.765101907774806, 18.56415966525674, 11.36563296647121, 10.8808026065429, 11.121026219179228, 15.814922998348862, 16.505855477104575, 16.17541431138912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16118318476075255, "mean_inference_ms": 0.7261955725225911, "mean_action_processing_ms": 0.10126173133795195, "mean_env_wait_ms": 0.8390717874902117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 575640, "timesteps_this_iter": 0, "agent_timesteps_total": 1726920, "timers": {"sample_time_ms": 21032.178, "sample_throughput": 456.158, "load_time_ms": 0.351, "load_throughput": 27340774.953, "learn_time_ms": 3138.119, "learn_throughput": 3057.246, "update_time_ms": 9.336}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.862380981445313e-06, "cur_lr": 0.0005, "total_loss": 6.608773171901703, "policy_loss": -0.0001733919464332878, "vf_loss": 6.7145960330963135, "vf_explained_var": 0.01270410418510437, "kl": 0.00390428179530652, "entropy": 10.564962267875671, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 575640, "num_agent_steps_sampled": 1726920, "num_steps_trained": 575640, "num_agent_steps_trained": 1726920, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2708, "training_iteration": 60, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-04-07", "timestamp": 1706191447, "time_this_iter_s": 20.371373891830444, "time_total_s": 1249.008364200592, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1249.008364200592, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 7.971428571428571, "ram_util_percent": 47.1}}
{"episode_reward_max": 93.92824427038428, "episode_reward_min": -257.8756027845666, "episode_reward_mean": 54.03381806715478, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -86.92743164300919}, "policy_reward_max": {"shared_policy": 31.487572661290557}, "policy_reward_mean": {"shared_policy": 18.01127268905159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.89061869774012, 57.53697899729012, 32.013577327132225, 76.78796751704067, 54.22699154913424, 57.07563779875635, 63.61166929081081, 22.054897036403418, 42.36285612266508, 73.38830000907183, 39.099564000964165, 69.89925869926807, 57.715143878012896, 57.9165835008025, 63.474403447471545, 17.10251233354208, 64.13857858255504, 66.62450892850754, 62.758980333805056, 52.78142774105069, 23.228777416050406, 80.7482337541878, 50.9748623324558, 43.58959976618641, 24.887150254100547, 63.45640159072353, 42.574197575449915, 55.10905786603688, 61.420055836439104, 73.67700508330017, 54.53744289092718, 35.75256534665823, 60.83394550904629, 41.504118755459785, 55.55932247452438, -8.748603112995639, 60.614041085354984, 71.035757035017, 32.225574631243944, 74.0220232317224, 76.25102365948257, 63.94175119325516, 66.63469309732317, 63.487424165010424, 75.30356734804806, 21.68851851299405, 77.47648898512124, 64.80163676667144, 50.10901945084332, 61.82220662757754, 57.982124475762234, 59.77973315119743, 33.926811978220925, 13.863982433103928, 59.71289716847241, 73.02444617450234, 78.76058785244821, 36.68402475788025, 73.50147709250449, 36.11910282820462, 73.18267911672592, 50.52298282831906, 58.647321868687854, 70.80840409174562, 69.31414081901309, 71.07239717466288, 55.23391303606331, 33.36746179219334, 48.496192786842556, 20.76774144172667, 72.83172618597743, 69.10032440349458, 57.496916361153126, 70.19363776594399, -257.8756027845666, 53.77854805812238, 60.19351505488157, 49.04788186773655, 67.1727258078754, 74.64698918163776, 61.3243008032441, 58.76744063943622, 52.07678890321404, 93.92824427038428, 78.6847287151031, 75.10832331329581, 59.47693504858762, 62.50852838624269, 44.502343542873845, 77.71742673777042, 52.95827596634625, 51.617096836678655, 65.24206697754559, 76.14524538069963, 57.6212761644274, 52.896674156188965, 75.39640312083063, 67.91151648014782, 65.79244821518658, 82.37234336649996], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.053175688100353, 16.956812332694724, 16.880630676945046, 18.50849852462609, 19.56119199780126, 19.46728847486277, 10.480731710791588, 10.769477359950542, 10.763368256390095, 25.421503759920597, 25.79102412890643, 25.575439628213644, 17.99448512991269, 18.206201796730355, 18.026304622491196, 19.264067993809775, 18.845278066893414, 18.966291738053158, 21.404940911879137, 20.940654908617333, 21.26607347031434, 7.306453850120306, 7.434072107076645, 7.314371079206467, 14.13501717398563, 14.002851362029702, 14.224987586649746, 24.588874600827694, 24.472168184816837, 24.327257223427296, 13.043934494256973, 13.118828512728214, 12.936800993978977, 23.489911342660577, 23.279920770476252, 23.129426586131245, 19.181216806173325, 19.156362861394882, 19.37756421044469, 19.246116401006773, 19.313864101966217, 19.356602997829512, 20.725717966755226, 21.37514525170748, 21.37354022900884, 5.948102737466485, 5.854139684389025, 5.30026991168657, 21.583781116952494, 21.43499568601449, 21.11980177958806, 22.27650466064611, 22.10293977210918, 22.245064495752246, 20.921145769457013, 20.93632589901486, 20.901508665333182, 17.325140366951615, 17.639414759973675, 17.8168726141254, 8.022014322380215, 7.400602037707955, 7.806161055962235, 26.720695624748856, 26.770933176080376, 27.25660495335856, 17.382464759362236, 16.92361032714446, 16.668787245949105, 14.829795698674076, 14.339571798841149, 14.420232268671185, 8.337122955669955, 8.289424096544579, 8.260603201886013, 21.013191645344094, 21.09516956408818, 21.348040381291256, 13.967914047340543, 14.31929739813009, 14.286986129979283, 18.46027213831742, 18.253982604791716, 18.39480312292774, 20.376704851786286, 20.262864525119454, 20.780486459533364, 24.746489473618567, 24.58720251917839, 24.343313090503216, 18.220326719184712, 18.661180357759193, 17.655935813983277, 11.447426989674568, 11.824716866016388, 12.480421490967274, 20.27654428097108, 20.349485204244644, 20.207916023830563, 13.797764658927917, 13.573800727725029, 14.132553368806839, 18.412866842001677, 18.63752236403525, 18.508933268487453, -2.957622776428863, -2.5802748973170964, -3.210705439249679, 20.457393950782716, 19.824963361024857, 20.33168377354741, 23.39905313154061, 23.88154902433355, 23.755154879142836, 10.803399316966534, 10.918002005666494, 10.504173308610916, 24.73306084548433, 24.903203035083905, 24.385759351154164, 25.660943229372293, 25.389521698156983, 25.200558731953294, 21.542119233558566, 21.370676624278218, 21.028955335418374, 22.00806314994891, 22.3236565751334, 22.302973372240857, 21.298051471511513, 21.097271549204976, 21.092101144293935, 24.92693469176689, 24.95563831428686, 25.420994341994316, 7.207794651389122, 7.104016967117786, 7.376706894487143, 26.086438981195286, 25.8951806773742, 25.49486932655175, 21.50887218862772, 21.83979588377406, 21.452968694269657, 16.77953267594178, 16.785947663088635, 16.543539111812905, 20.593455746769905, 20.868508961051702, 20.360241919755936, 19.200231974323586, 19.49553751510878, 19.28635498632987, 19.840404525399208, 19.92240049317479, 20.016928132623434, 11.256703925629452, 11.232304391761616, 11.437803660829857, 4.30006983379522, 4.469977493087441, 5.0939351062212666, 19.912324868142605, 19.79476699978113, 20.005805300548673, 23.93983521560827, 24.383100057641656, 24.70151090125242, 26.16368857522805, 26.142629620929554, 26.454269656290606, 12.21264705620706, 12.250328981957864, 12.221048719715327, 24.38757823159297, 24.54412924436231, 24.56976961654921, 11.766825055082634, 12.160751612236098, 12.191526160885886, 24.05417673289776, 24.582117330282927, 24.546385053545237, 16.819639918704823, 16.665360709031418, 17.037982200582817, 19.46751781304677, 19.76979377244909, 19.410010283191994, 23.796605419367552, 23.612719260156155, 23.39907941222191, 23.099254863957555, 23.060598271588475, 23.15428768346706, 23.6264495315651, 23.583265556643397, 23.862682086454384, 17.90465146303177, 18.765101907774806, 18.56415966525674, 11.36563296647121, 10.8808026065429, 11.121026219179228, 15.814922998348862, 16.505855477104575, 16.17541431138912, 6.836763606717184, 6.999998442207769, 6.930979392801717, 24.334690465281398, 24.01793836305538, 24.479097357640654, 23.21778256570299, 22.73478077848752, 23.147761059304074, 19.254393182694912, 18.962757602334023, 19.27976557612419, 23.56943855931361, 23.300743167599038, 23.323456039031342, -86.92743164300919, -85.69446538388729, -85.2537057576701, 18.094309029479817, 17.43558356662591, 18.248655462016657, 20.13035649061203, 20.127915419638157, 19.935243144631386, 16.436652994404227, 16.463450255493314, 16.14777861783901, 22.319043785333633, 22.42094761133194, 22.43273441120982, 25.056247226893902, 24.982092268764973, 24.60864968597889, 20.642780087267354, 20.144195233782128, 20.537325482194618, 19.670999473581702, 19.584183669338614, 19.5122574965159, 17.481254120357335, 17.168226279318333, 17.42730850353837, 31.48118997241059, 30.959481636683137, 31.487572661290557, 26.22628812802334, 26.185363625486687, 26.273076961593077, 24.976708749930054, 25.17825738588968, 24.95335717747608, 19.54359669238329, 19.945296589285135, 19.988041766919196, 20.90069718658924, 21.108708237297833, 20.499122962355614, 14.470936124523476, 15.06199239691098, 14.969415021439389, 26.084708820407585, 25.694772151609257, 25.937945765753582, 16.671772857507065, 18.32083597530921, 17.965667133529976, 16.779058809081704, 17.312571509430796, 17.525466518166155, 21.675796194622905, 21.89697186710933, 21.669298915813357, 25.568948060274124, 25.261712826788425, 25.314584493637085, 19.10791229456663, 18.92000399529934, 19.59335987456143, 17.72223199158907, 17.579675897955894, 17.594766266644, 24.98127399633327, 25.245273147399217, 25.169855977098138, 22.839133241524294, 22.952853837360934, 22.119529401262596, 21.673039381702736, 22.04402982940276, 22.075379004081086, 27.327315787474305, 27.9813393355968, 27.063688243428857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16113146915892276, "mean_inference_ms": 0.7262348473404384, "mean_action_processing_ms": 0.10122442770173869, "mean_env_wait_ms": 0.8386910145300175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 585234, "timesteps_this_iter": 0, "agent_timesteps_total": 1755702, "timers": {"sample_time_ms": 20540.418, "sample_throughput": 467.079, "load_time_ms": 0.352, "load_throughput": 27259282.33, "learn_time_ms": 3131.958, "learn_throughput": 3063.259, "update_time_ms": 9.344}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9311904907226566e-06, "cur_lr": 0.0005, "total_loss": 57.37293767929077, "policy_loss": -7.218295348998538e-06, "vf_loss": 57.48041248321533, "vf_explained_var": 0.022649593651294708, "kl": 0.006949001326626455, "entropy": 10.746576428413391, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 585234, "num_agent_steps_sampled": 1755702, "num_steps_trained": 585234, "num_agent_steps_trained": 1755702, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2739, "training_iteration": 61, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-04-29", "timestamp": 1706191469, "time_this_iter_s": 21.06496024131775, "time_total_s": 1270.0733244419098, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1270.0733244419098, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 8.596666666666666, "ram_util_percent": 47.13666666666667}}
{"episode_reward_max": 93.92824427038428, "episode_reward_min": -257.8756027845666, "episode_reward_mean": 54.72242086192331, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -86.92743164300919}, "policy_reward_max": {"shared_policy": 31.487572661290557}, "policy_reward_mean": {"shared_policy": 18.24080695397443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.504118755459785, 55.55932247452438, -8.748603112995639, 60.614041085354984, 71.035757035017, 32.225574631243944, 74.0220232317224, 76.25102365948257, 63.94175119325516, 66.63469309732317, 63.487424165010424, 75.30356734804806, 21.68851851299405, 77.47648898512124, 64.80163676667144, 50.10901945084332, 61.82220662757754, 57.982124475762234, 59.77973315119743, 33.926811978220925, 13.863982433103928, 59.71289716847241, 73.02444617450234, 78.76058785244821, 36.68402475788025, 73.50147709250449, 36.11910282820462, 73.18267911672592, 50.52298282831906, 58.647321868687854, 70.80840409174562, 69.31414081901309, 71.07239717466288, 55.23391303606331, 33.36746179219334, 48.496192786842556, 20.76774144172667, 72.83172618597743, 69.10032440349458, 57.496916361153126, 70.19363776594399, -257.8756027845666, 53.77854805812238, 60.19351505488157, 49.04788186773655, 67.1727258078754, 74.64698918163776, 61.3243008032441, 58.76744063943622, 52.07678890321404, 93.92824427038428, 78.6847287151031, 75.10832331329581, 59.47693504858762, 62.50852838624269, 44.502343542873845, 77.71742673777042, 52.95827596634625, 51.617096836678655, 65.24206697754559, 76.14524538069963, 57.6212761644274, 52.896674156188965, 75.39640312083063, 67.91151648014782, 65.79244821518658, 82.37234336649996, 53.90621351264416, 50.642237665131674, 59.551879953593016, 68.6214873078279, 45.97516613081095, 71.41181092895567, 59.09161600703372, 64.89850121177733, 49.109876292757676, 62.338590521365404, 49.2748704049736, 15.542591629549833, 85.42101344978435, 51.4399717650376, 75.89272873476148, 32.34592322167006, 65.02553712204099, 78.05016827210781, 73.43610298633575, 58.037399515509605, 57.50710070133208, 54.13125090301034, 72.86913809925315, 65.51818714104591, 22.875304654240608, 36.79942993447183, 55.572073854506, 26.09095965325831, 8.49799554795024, 70.46168246120214, 48.08330570766702, 69.05667730793355, 63.63323789089915], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.797764658927917, 13.573800727725029, 14.132553368806839, 18.412866842001677, 18.63752236403525, 18.508933268487453, -2.957622776428863, -2.5802748973170964, -3.210705439249679, 20.457393950782716, 19.824963361024857, 20.33168377354741, 23.39905313154061, 23.88154902433355, 23.755154879142836, 10.803399316966534, 10.918002005666494, 10.504173308610916, 24.73306084548433, 24.903203035083905, 24.385759351154164, 25.660943229372293, 25.389521698156983, 25.200558731953294, 21.542119233558566, 21.370676624278218, 21.028955335418374, 22.00806314994891, 22.3236565751334, 22.302973372240857, 21.298051471511513, 21.097271549204976, 21.092101144293935, 24.92693469176689, 24.95563831428686, 25.420994341994316, 7.207794651389122, 7.104016967117786, 7.376706894487143, 26.086438981195286, 25.8951806773742, 25.49486932655175, 21.50887218862772, 21.83979588377406, 21.452968694269657, 16.77953267594178, 16.785947663088635, 16.543539111812905, 20.593455746769905, 20.868508961051702, 20.360241919755936, 19.200231974323586, 19.49553751510878, 19.28635498632987, 19.840404525399208, 19.92240049317479, 20.016928132623434, 11.256703925629452, 11.232304391761616, 11.437803660829857, 4.30006983379522, 4.469977493087441, 5.0939351062212666, 19.912324868142605, 19.79476699978113, 20.005805300548673, 23.93983521560827, 24.383100057641656, 24.70151090125242, 26.16368857522805, 26.142629620929554, 26.454269656290606, 12.21264705620706, 12.250328981957864, 12.221048719715327, 24.38757823159297, 24.54412924436231, 24.56976961654921, 11.766825055082634, 12.160751612236098, 12.191526160885886, 24.05417673289776, 24.582117330282927, 24.546385053545237, 16.819639918704823, 16.665360709031418, 17.037982200582817, 19.46751781304677, 19.76979377244909, 19.410010283191994, 23.796605419367552, 23.612719260156155, 23.39907941222191, 23.099254863957555, 23.060598271588475, 23.15428768346706, 23.6264495315651, 23.583265556643397, 23.862682086454384, 17.90465146303177, 18.765101907774806, 18.56415966525674, 11.36563296647121, 10.8808026065429, 11.121026219179228, 15.814922998348862, 16.505855477104575, 16.17541431138912, 6.836763606717184, 6.999998442207769, 6.930979392801717, 24.334690465281398, 24.01793836305538, 24.479097357640654, 23.21778256570299, 22.73478077848752, 23.147761059304074, 19.254393182694912, 18.962757602334023, 19.27976557612419, 23.56943855931361, 23.300743167599038, 23.323456039031342, -86.92743164300919, -85.69446538388729, -85.2537057576701, 18.094309029479817, 17.43558356662591, 18.248655462016657, 20.13035649061203, 20.127915419638157, 19.935243144631386, 16.436652994404227, 16.463450255493314, 16.14777861783901, 22.319043785333633, 22.42094761133194, 22.43273441120982, 25.056247226893902, 24.982092268764973, 24.60864968597889, 20.642780087267354, 20.144195233782128, 20.537325482194618, 19.670999473581702, 19.584183669338614, 19.5122574965159, 17.481254120357335, 17.168226279318333, 17.42730850353837, 31.48118997241059, 30.959481636683137, 31.487572661290557, 26.22628812802334, 26.185363625486687, 26.273076961593077, 24.976708749930054, 25.17825738588968, 24.95335717747608, 19.54359669238329, 19.945296589285135, 19.988041766919196, 20.90069718658924, 21.108708237297833, 20.499122962355614, 14.470936124523476, 15.06199239691098, 14.969415021439389, 26.084708820407585, 25.694772151609257, 25.937945765753582, 16.671772857507065, 18.32083597530921, 17.965667133529976, 16.779058809081704, 17.312571509430796, 17.525466518166155, 21.675796194622905, 21.89697186710933, 21.669298915813357, 25.568948060274124, 25.261712826788425, 25.314584493637085, 19.10791229456663, 18.92000399529934, 19.59335987456143, 17.72223199158907, 17.579675897955894, 17.594766266644, 24.98127399633327, 25.245273147399217, 25.169855977098138, 22.839133241524294, 22.952853837360934, 22.119529401262596, 21.673039381702736, 22.04402982940276, 22.075379004081086, 27.327315787474305, 27.9813393355968, 27.063688243428857, 18.310353446130947, 17.78120930989583, 17.814650756617382, 17.111479535078004, 16.62308431913455, 16.90767381091912, 19.715732008218765, 19.805038057267666, 20.031109888106585, 22.69949437429507, 23.145550825477883, 22.77644210805495, 15.405448159823806, 15.29839778939882, 15.271320181588322, 23.545764781534672, 24.02299895323813, 23.843047194182873, 19.28896065553029, 19.77858869110544, 20.02406666039799, 21.420189805328846, 21.69394300505519, 21.784368401393294, 16.350893869375184, 16.33918403399487, 16.419798389387623, 20.674808382987976, 20.516353756189346, 21.14742838218808, 16.203913966814667, 16.306138950089604, 16.764817488069326, 5.113346109787614, 5.128683018187672, 5.300562501574547, 28.613880094916865, 28.24629761030276, 28.560835744564727, 17.404892787492514, 17.064160155753285, 16.9709188217918, 25.32881123945117, 25.223414786159992, 25.340502709150314, 10.530220376948506, 11.058593736651034, 10.757109108070523, 21.690780494362116, 21.689442463219166, 21.645314164459705, 26.18906812245646, 25.900895702342183, 25.960204447309167, 24.32019155099988, 24.605337573215365, 24.51057386212051, 19.58107005059719, 19.3945110142231, 19.061818450689316, 18.478365292151764, 19.52530139436324, 19.503434014817074, 18.163795347015053, 17.820642242828995, 18.14681331316629, 24.056908915440232, 24.264510850111634, 24.547718333701283, 21.95310056706269, 21.566569251318768, 21.998517322664455, 7.526939369738102, 7.548684298992157, 7.799680985510349, 11.958224599560097, 12.186567087968186, 12.654638246943549, 18.474751842518643, 18.484927249451474, 18.612394762535885, 8.781676543255642, 8.800999996562794, 8.508283113439873, 2.545236522952706, 2.7852414051691596, 3.1675176198283737, 23.772576987743378, 23.49820164591074, 23.190903827548027, 15.911368303000927, 16.063271820545197, 16.1086655841209, 22.774938081701592, 23.180007596810654, 23.10173162942131, 21.264012070993573, 21.29581595460573, 21.07340986529985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16112705914999595, "mean_inference_ms": 0.7262367461574581, "mean_action_processing_ms": 0.1013097879735572, "mean_env_wait_ms": 0.8382410495667867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 594828, "timesteps_this_iter": 0, "agent_timesteps_total": 1784484, "timers": {"sample_time_ms": 20509.13, "sample_throughput": 467.792, "load_time_ms": 0.453, "load_throughput": 21173455.71, "learn_time_ms": 3130.295, "learn_throughput": 3064.887, "update_time_ms": 8.792}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9311904907226566e-06, "cur_lr": 0.0005, "total_loss": 5.430071115493774, "policy_loss": -0.0006187772393115853, "vf_loss": 5.537338495254517, "vf_explained_var": 0.02348613739013672, "kl": 0.003261674559376956, "entropy": 10.664871454238892, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 594828, "num_agent_steps_sampled": 1784484, "num_steps_trained": 594828, "num_agent_steps_trained": 1784484, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2772, "training_iteration": 62, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-04-49", "timestamp": 1706191489, "time_this_iter_s": 20.26879858970642, "time_total_s": 1290.3421230316162, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1290.3421230316162, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 8.362068965517242, "ram_util_percent": 47.062068965517234}}
{"episode_reward_max": 93.92824427038428, "episode_reward_min": -257.8756027845666, "episode_reward_mean": 56.34224493057991, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -86.92743164300919}, "policy_reward_max": {"shared_policy": 31.487572661290557}, "policy_reward_mean": {"shared_policy": 18.780748310193296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.80840409174562, 69.31414081901309, 71.07239717466288, 55.23391303606331, 33.36746179219334, 48.496192786842556, 20.76774144172667, 72.83172618597743, 69.10032440349458, 57.496916361153126, 70.19363776594399, -257.8756027845666, 53.77854805812238, 60.19351505488157, 49.04788186773655, 67.1727258078754, 74.64698918163776, 61.3243008032441, 58.76744063943622, 52.07678890321404, 93.92824427038428, 78.6847287151031, 75.10832331329581, 59.47693504858762, 62.50852838624269, 44.502343542873845, 77.71742673777042, 52.95827596634625, 51.617096836678655, 65.24206697754559, 76.14524538069963, 57.6212761644274, 52.896674156188965, 75.39640312083063, 67.91151648014782, 65.79244821518658, 82.37234336649996, 53.90621351264416, 50.642237665131674, 59.551879953593016, 68.6214873078279, 45.97516613081095, 71.41181092895567, 59.09161600703372, 64.89850121177733, 49.109876292757676, 62.338590521365404, 49.2748704049736, 15.542591629549833, 85.42101344978435, 51.4399717650376, 75.89272873476148, 32.34592322167006, 65.02553712204099, 78.05016827210781, 73.43610298633575, 58.037399515509605, 57.50710070133208, 54.13125090301034, 72.86913809925315, 65.51818714104591, 22.875304654240608, 36.79942993447183, 55.572073854506, 26.09095965325831, 8.49799554795024, 70.46168246120214, 48.08330570766702, 69.05667730793355, 63.63323789089915, 48.119252806529374, 82.96110310638323, 51.217061283532516, 54.938872404396506, 69.84252853132782, 76.21313763502982, 46.89597304537891, 50.69338145782238, 83.82911724597213, 70.94101426750419, 52.10349611192942, 78.71037013828754, 36.27702575083822, 62.39396453648804, 75.72307241708037, 64.2545538432896, 16.897831330075846, 81.01799684477734, 81.41016692295669, 62.91614419594406, 55.030449345707865, 80.39754300564528, 64.43404609244314, 69.08391689509153, 41.624141540378304, -3.1035307664424323, 64.13229043874888, 67.92351102037354, 46.09666941314936, 82.44404163770376], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.796605419367552, 23.612719260156155, 23.39907941222191, 23.099254863957555, 23.060598271588475, 23.15428768346706, 23.6264495315651, 23.583265556643397, 23.862682086454384, 17.90465146303177, 18.765101907774806, 18.56415966525674, 11.36563296647121, 10.8808026065429, 11.121026219179228, 15.814922998348862, 16.505855477104575, 16.17541431138912, 6.836763606717184, 6.999998442207769, 6.930979392801717, 24.334690465281398, 24.01793836305538, 24.479097357640654, 23.21778256570299, 22.73478077848752, 23.147761059304074, 19.254393182694912, 18.962757602334023, 19.27976557612419, 23.56943855931361, 23.300743167599038, 23.323456039031342, -86.92743164300919, -85.69446538388729, -85.2537057576701, 18.094309029479817, 17.43558356662591, 18.248655462016657, 20.13035649061203, 20.127915419638157, 19.935243144631386, 16.436652994404227, 16.463450255493314, 16.14777861783901, 22.319043785333633, 22.42094761133194, 22.43273441120982, 25.056247226893902, 24.982092268764973, 24.60864968597889, 20.642780087267354, 20.144195233782128, 20.537325482194618, 19.670999473581702, 19.584183669338614, 19.5122574965159, 17.481254120357335, 17.168226279318333, 17.42730850353837, 31.48118997241059, 30.959481636683137, 31.487572661290557, 26.22628812802334, 26.185363625486687, 26.273076961593077, 24.976708749930054, 25.17825738588968, 24.95335717747608, 19.54359669238329, 19.945296589285135, 19.988041766919196, 20.90069718658924, 21.108708237297833, 20.499122962355614, 14.470936124523476, 15.06199239691098, 14.969415021439389, 26.084708820407585, 25.694772151609257, 25.937945765753582, 16.671772857507065, 18.32083597530921, 17.965667133529976, 16.779058809081704, 17.312571509430796, 17.525466518166155, 21.675796194622905, 21.89697186710933, 21.669298915813357, 25.568948060274124, 25.261712826788425, 25.314584493637085, 19.10791229456663, 18.92000399529934, 19.59335987456143, 17.72223199158907, 17.579675897955894, 17.594766266644, 24.98127399633327, 25.245273147399217, 25.169855977098138, 22.839133241524294, 22.952853837360934, 22.119529401262596, 21.673039381702736, 22.04402982940276, 22.075379004081086, 27.327315787474305, 27.9813393355968, 27.063688243428857, 18.310353446130947, 17.78120930989583, 17.814650756617382, 17.111479535078004, 16.62308431913455, 16.90767381091912, 19.715732008218765, 19.805038057267666, 20.031109888106585, 22.69949437429507, 23.145550825477883, 22.77644210805495, 15.405448159823806, 15.29839778939882, 15.271320181588322, 23.545764781534672, 24.02299895323813, 23.843047194182873, 19.28896065553029, 19.77858869110544, 20.02406666039799, 21.420189805328846, 21.69394300505519, 21.784368401393294, 16.350893869375184, 16.33918403399487, 16.419798389387623, 20.674808382987976, 20.516353756189346, 21.14742838218808, 16.203913966814667, 16.306138950089604, 16.764817488069326, 5.113346109787614, 5.128683018187672, 5.300562501574547, 28.613880094916865, 28.24629761030276, 28.560835744564727, 17.404892787492514, 17.064160155753285, 16.9709188217918, 25.32881123945117, 25.223414786159992, 25.340502709150314, 10.530220376948506, 11.058593736651034, 10.757109108070523, 21.690780494362116, 21.689442463219166, 21.645314164459705, 26.18906812245646, 25.900895702342183, 25.960204447309167, 24.32019155099988, 24.605337573215365, 24.51057386212051, 19.58107005059719, 19.3945110142231, 19.061818450689316, 18.478365292151764, 19.52530139436324, 19.503434014817074, 18.163795347015053, 17.820642242828995, 18.14681331316629, 24.056908915440232, 24.264510850111634, 24.547718333701283, 21.95310056706269, 21.566569251318768, 21.998517322664455, 7.526939369738102, 7.548684298992157, 7.799680985510349, 11.958224599560097, 12.186567087968186, 12.654638246943549, 18.474751842518643, 18.484927249451474, 18.612394762535885, 8.781676543255642, 8.800999996562794, 8.508283113439873, 2.545236522952706, 2.7852414051691596, 3.1675176198283737, 23.772576987743378, 23.49820164591074, 23.190903827548027, 15.911368303000927, 16.063271820545197, 16.1086655841209, 22.774938081701592, 23.180007596810654, 23.10173162942131, 21.264012070993573, 21.29581595460573, 21.07340986529985, 16.109818790728838, 16.01321945215264, 15.996214563647897, 27.18689502775669, 27.891498560551554, 27.88270951807499, 16.875715417166546, 17.018449058135346, 17.322896808230624, 18.40252989406386, 18.42284848416844, 18.113494026164204, 23.177090066174657, 23.175899947683007, 23.48953851747015, 25.24060922736922, 25.46443419593075, 25.508094211729855, 15.081926514705017, 15.828942791869238, 15.985103738804654, 16.929935583223894, 16.745126390208796, 17.018319484389693, 28.11095794538656, 28.27273206661144, 27.44542723397413, 23.763970526556164, 23.65136010448137, 23.525683636466653, 17.61153294146061, 17.063868328928947, 17.42809484153986, 26.46498564630747, 25.72762504220009, 26.517759449779987, 12.276680341921747, 11.911190196871758, 12.089155212044716, 20.837783635904387, 20.779887819041804, 20.77629308154185, 25.2649109798173, 25.089454295734555, 25.368707141528517, 21.065544878443077, 21.614934300382927, 21.574074664463595, 5.761679551874593, 5.700538513561085, 5.435613264640168, 26.74400937060514, 27.04235142345229, 27.231636050719914, 26.750134026010826, 27.145987284680203, 27.51404561226566, 20.992065490533903, 21.081384559472397, 20.842694145937756, 18.546377419183642, 18.053986037770898, 18.430085888753325, 26.74773132801056, 26.840112157166004, 26.809699520468712, 20.554689089457185, 21.996875554012746, 21.88248144897321, 23.16773246228695, 22.970409274101257, 22.945775158703327, 13.934116090337426, 13.822749132911355, 13.867276317129523, -0.6202228727440087, -0.4896723187218157, -1.993635574976608, 21.44324068849285, 21.58595185199131, 21.10309789826472, 22.92134929153447, 22.255127867062882, 22.74703386177619, 15.485794201493263, 15.324938140809536, 15.285937070846558, 27.226878856619194, 27.752860668425754, 27.464302112658814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1611179289106568, "mean_inference_ms": 0.7263163401425163, "mean_action_processing_ms": 0.10132847461123878, "mean_env_wait_ms": 0.8379546875160219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 604422, "timesteps_this_iter": 0, "agent_timesteps_total": 1813266, "timers": {"sample_time_ms": 20471.346, "sample_throughput": 468.655, "load_time_ms": 0.453, "load_throughput": 21173455.71, "learn_time_ms": 3155.992, "learn_throughput": 3039.931, "update_time_ms": 8.7}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.655952453613283e-07, "cur_lr": 0.0005, "total_loss": 5.603571593761444, "policy_loss": -0.0012379860270115284, "vf_loss": 5.711360335350037, "vf_explained_var": 0.06505259871482849, "kl": 0.004304826943604221, "entropy": 10.655080318450928, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 604422, "num_agent_steps_sampled": 1813266, "num_steps_trained": 604422, "num_agent_steps_trained": 1813266, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2802, "training_iteration": 63, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-05-10", "timestamp": 1706191510, "time_this_iter_s": 20.586193799972534, "time_total_s": 1310.9283168315887, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1310.9283168315887, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 8.175862068965516, "ram_util_percent": 47.14137931034483}}
{"episode_reward_max": 89.87991498038171, "episode_reward_min": -8.025760061107604, "episode_reward_mean": 58.344308726788725, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -2.861075547834247}, "policy_reward_max": {"shared_policy": 30.300889925410345}, "policy_reward_mean": {"shared_policy": 19.44810290892957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.91151648014782, 65.79244821518658, 82.37234336649996, 53.90621351264416, 50.642237665131674, 59.551879953593016, 68.6214873078279, 45.97516613081095, 71.41181092895567, 59.09161600703372, 64.89850121177733, 49.109876292757676, 62.338590521365404, 49.2748704049736, 15.542591629549833, 85.42101344978435, 51.4399717650376, 75.89272873476148, 32.34592322167006, 65.02553712204099, 78.05016827210781, 73.43610298633575, 58.037399515509605, 57.50710070133208, 54.13125090301034, 72.86913809925315, 65.51818714104591, 22.875304654240608, 36.79942993447183, 55.572073854506, 26.09095965325831, 8.49799554795024, 70.46168246120214, 48.08330570766702, 69.05667730793355, 63.63323789089915, 48.119252806529374, 82.96110310638323, 51.217061283532516, 54.938872404396506, 69.84252853132782, 76.21313763502982, 46.89597304537891, 50.69338145782238, 83.82911724597213, 70.94101426750419, 52.10349611192942, 78.71037013828754, 36.27702575083822, 62.39396453648804, 75.72307241708037, 64.2545538432896, 16.897831330075846, 81.01799684477734, 81.41016692295669, 62.91614419594406, 55.030449345707865, 80.39754300564528, 64.43404609244314, 69.08391689509153, 41.624141540378304, -3.1035307664424323, 64.13229043874888, 67.92351102037354, 46.09666941314936, 82.44404163770376, 61.859637102577835, 66.83910600841044, 68.32454907149075, 77.8450342863798, 60.791769612580524, 23.288624182343483, 55.971728918550056, 89.46378891915082, 26.168794959783554, 68.45637860149142, 68.8991704918444, 70.0802181661129, 37.7793564806925, 71.20929750055073, 89.87991498038171, 69.70430507510898, 39.17317324876784, 57.38136437535283, 89.83633064851163, 59.67166958341838, -8.025760061107604, 68.54476008750498, 56.82108837366103, 0.6929754242300703, 83.52279051765798, 30.77775892056522, 44.24065891653298, 78.28857515309936, 58.03357641352339, 58.158742684870944, 49.879795040935264, 80.02513606846333, 67.82092417404054, 60.420157700777025], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.839133241524294, 22.952853837360934, 22.119529401262596, 21.673039381702736, 22.04402982940276, 22.075379004081086, 27.327315787474305, 27.9813393355968, 27.063688243428857, 18.310353446130947, 17.78120930989583, 17.814650756617382, 17.111479535078004, 16.62308431913455, 16.90767381091912, 19.715732008218765, 19.805038057267666, 20.031109888106585, 22.69949437429507, 23.145550825477883, 22.77644210805495, 15.405448159823806, 15.29839778939882, 15.271320181588322, 23.545764781534672, 24.02299895323813, 23.843047194182873, 19.28896065553029, 19.77858869110544, 20.02406666039799, 21.420189805328846, 21.69394300505519, 21.784368401393294, 16.350893869375184, 16.33918403399487, 16.419798389387623, 20.674808382987976, 20.516353756189346, 21.14742838218808, 16.203913966814667, 16.306138950089604, 16.764817488069326, 5.113346109787614, 5.128683018187672, 5.300562501574547, 28.613880094916865, 28.24629761030276, 28.560835744564727, 17.404892787492514, 17.064160155753285, 16.9709188217918, 25.32881123945117, 25.223414786159992, 25.340502709150314, 10.530220376948506, 11.058593736651034, 10.757109108070523, 21.690780494362116, 21.689442463219166, 21.645314164459705, 26.18906812245646, 25.900895702342183, 25.960204447309167, 24.32019155099988, 24.605337573215365, 24.51057386212051, 19.58107005059719, 19.3945110142231, 19.061818450689316, 18.478365292151764, 19.52530139436324, 19.503434014817074, 18.163795347015053, 17.820642242828995, 18.14681331316629, 24.056908915440232, 24.264510850111634, 24.547718333701283, 21.95310056706269, 21.566569251318768, 21.998517322664455, 7.526939369738102, 7.548684298992157, 7.799680985510349, 11.958224599560097, 12.186567087968186, 12.654638246943549, 18.474751842518643, 18.484927249451474, 18.612394762535885, 8.781676543255642, 8.800999996562794, 8.508283113439873, 2.545236522952706, 2.7852414051691596, 3.1675176198283737, 23.772576987743378, 23.49820164591074, 23.190903827548027, 15.911368303000927, 16.063271820545197, 16.1086655841209, 22.774938081701592, 23.180007596810654, 23.10173162942131, 21.264012070993573, 21.29581595460573, 21.07340986529985, 16.109818790728838, 16.01321945215264, 15.996214563647897, 27.18689502775669, 27.891498560551554, 27.88270951807499, 16.875715417166546, 17.018449058135346, 17.322896808230624, 18.40252989406386, 18.42284848416844, 18.113494026164204, 23.177090066174657, 23.175899947683007, 23.48953851747015, 25.24060922736922, 25.46443419593075, 25.508094211729855, 15.081926514705017, 15.828942791869238, 15.985103738804654, 16.929935583223894, 16.745126390208796, 17.018319484389693, 28.11095794538656, 28.27273206661144, 27.44542723397413, 23.763970526556164, 23.65136010448137, 23.525683636466653, 17.61153294146061, 17.063868328928947, 17.42809484153986, 26.46498564630747, 25.72762504220009, 26.517759449779987, 12.276680341921747, 11.911190196871758, 12.089155212044716, 20.837783635904387, 20.779887819041804, 20.77629308154185, 25.2649109798173, 25.089454295734555, 25.368707141528517, 21.065544878443077, 21.614934300382927, 21.574074664463595, 5.761679551874593, 5.700538513561085, 5.435613264640168, 26.74400937060514, 27.04235142345229, 27.231636050719914, 26.750134026010826, 27.145987284680203, 27.51404561226566, 20.992065490533903, 21.081384559472397, 20.842694145937756, 18.546377419183642, 18.053986037770898, 18.430085888753325, 26.74773132801056, 26.840112157166004, 26.809699520468712, 20.554689089457185, 21.996875554012746, 21.88248144897321, 23.16773246228695, 22.970409274101257, 22.945775158703327, 13.934116090337426, 13.822749132911355, 13.867276317129523, -0.6202228727440087, -0.4896723187218157, -1.993635574976608, 21.44324068849285, 21.58595185199131, 21.10309789826472, 22.92134929153447, 22.255127867062882, 22.74703386177619, 15.485794201493263, 15.324938140809536, 15.285937070846558, 27.226878856619194, 27.752860668425754, 27.464302112658814, 19.83266270160675, 21.144197868648916, 20.88277653232217, 22.126965274413422, 22.295235221584633, 22.416905512412384, 22.628357765575245, 22.925220785041645, 22.77097052087386, 26.057725009818867, 25.9241308098038, 25.863178466757134, 20.106461131324366, 20.330275305857256, 20.3550331753989, 7.758820649236441, 7.914595525711775, 7.6152080073952675, 18.9482876684245, 18.51130298276742, 18.51213826735814, 29.522494604190186, 30.07983997960885, 29.86145433535178, 8.638498581945896, 8.509793117642403, 9.020503260195255, 22.87251907835403, 22.906759935120732, 22.67709958801666, 23.187427078684166, 22.266767551501587, 23.444975861658648, 23.227824792265892, 23.34335219115019, 23.50904118269682, 12.86528886245408, 12.117220481236771, 12.796847137001649, 23.761029449601963, 23.808037360509232, 23.640230690439537, 30.09902825330694, 29.958154295881585, 29.822732431193188, 23.185218433539063, 23.296570154527814, 23.2225164870421, 12.960096267362431, 13.102038898815707, 13.111038082589701, 19.311175311605126, 19.01277847836414, 19.057410585383565, 29.642206986745194, 30.300889925410345, 29.893233736356095, 19.456720421711594, 19.8612911949555, 20.353657966751285, -2.742829543848842, -2.4218549694245155, -2.861075547834247, 22.828244598582387, 22.874939668923616, 22.84157581999898, 18.93005523582299, 19.062936191757515, 18.82809694608052, 0.8084562967220847, 0.6252902920047347, -0.7407711644967492, 27.81057734539111, 27.84411309783657, 27.868100074430302, 10.232395856330783, 10.253945412735135, 10.291417651499302, 14.88136039425929, 14.160848607619599, 15.198449914654091, 25.8620339979728, 26.272941556371123, 26.153599598755434, 19.1710113932689, 19.083850403626755, 19.778714616627738, 19.166387130816773, 19.555158035208777, 19.437197518845394, 16.75049492095907, 16.467287865777806, 16.662012254198387, 26.34568826854229, 26.8822236135602, 26.797224186360836, 22.91983564322193, 22.335853566726044, 22.565234964092568, 20.090147162477166, 20.09681088725725, 20.23319965104261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16100165256891735, "mean_inference_ms": 0.7258618175224646, "mean_action_processing_ms": 0.10139847125890233, "mean_env_wait_ms": 0.8372810231719139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 614016, "timesteps_this_iter": 0, "agent_timesteps_total": 1842048, "timers": {"sample_time_ms": 20401.903, "sample_throughput": 470.25, "load_time_ms": 0.453, "load_throughput": 21173455.71, "learn_time_ms": 3142.294, "learn_throughput": 3053.183, "update_time_ms": 8.586}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.827976226806641e-07, "cur_lr": 0.0005, "total_loss": 8.564289093017578, "policy_loss": -0.0002649114283992393, "vf_loss": 8.671196460723877, "vf_explained_var": 0.10424715280532837, "kl": 0.004476390633550759, "entropy": 10.664227962493896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 614016, "num_agent_steps_sampled": 1842048, "num_steps_trained": 614016, "num_agent_steps_trained": 1842048, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2836, "training_iteration": 64, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-05-29", "timestamp": 1706191529, "time_this_iter_s": 19.282942295074463, "time_total_s": 1330.2112591266632, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BD03A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1330.2112591266632, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 9.764285714285716, "ram_util_percent": 46.31785714285714}}
{"episode_reward_max": 89.87991498038171, "episode_reward_min": -17.732166312634945, "episode_reward_mean": 57.32392897047218, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -6.322231516242027}, "policy_reward_max": {"shared_policy": 30.300889925410345}, "policy_reward_mean": {"shared_policy": 19.107976323490725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.09095965325831, 8.49799554795024, 70.46168246120214, 48.08330570766702, 69.05667730793355, 63.63323789089915, 48.119252806529374, 82.96110310638323, 51.217061283532516, 54.938872404396506, 69.84252853132782, 76.21313763502982, 46.89597304537891, 50.69338145782238, 83.82911724597213, 70.94101426750419, 52.10349611192942, 78.71037013828754, 36.27702575083822, 62.39396453648804, 75.72307241708037, 64.2545538432896, 16.897831330075846, 81.01799684477734, 81.41016692295669, 62.91614419594406, 55.030449345707865, 80.39754300564528, 64.43404609244314, 69.08391689509153, 41.624141540378304, -3.1035307664424323, 64.13229043874888, 67.92351102037354, 46.09666941314936, 82.44404163770376, 61.859637102577835, 66.83910600841044, 68.32454907149075, 77.8450342863798, 60.791769612580524, 23.288624182343483, 55.971728918550056, 89.46378891915082, 26.168794959783554, 68.45637860149142, 68.8991704918444, 70.0802181661129, 37.7793564806925, 71.20929750055073, 89.87991498038171, 69.70430507510898, 39.17317324876784, 57.38136437535283, 89.83633064851163, 59.67166958341838, -8.025760061107604, 68.54476008750498, 56.82108837366103, 0.6929754242300703, 83.52279051765798, 30.77775892056522, 44.24065891653298, 78.28857515309936, 58.03357641352339, 58.158742684870944, 49.879795040935264, 80.02513606846333, 67.82092417404054, 60.420157700777025, -11.630335230380325, 9.950912702828646, 64.15015882626173, 53.671561970841125, 58.976931709796176, 53.92866763472556, 60.941115934401736, 50.5224428027868, 39.279973044991465, 52.528166275471435, 67.58875197544694, 71.9228034680709, 70.16440387070178, -17.732166312634945, 31.4926808066666, 59.72610369324683, 74.47783701634033, 56.57358445972203, 75.26495589129624, 84.07434284314512, 68.06937677413222, 58.763526374474154, 62.71630478650329, 66.16996449045837, 48.85787465982136, 75.69013073667884, 64.39377545006572, 67.98983120918273, 76.44295175373554, 54.357874732930185], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [8.781676543255642, 8.800999996562794, 8.508283113439873, 2.545236522952706, 2.7852414051691596, 3.1675176198283737, 23.772576987743378, 23.49820164591074, 23.190903827548027, 15.911368303000927, 16.063271820545197, 16.1086655841209, 22.774938081701592, 23.180007596810654, 23.10173162942131, 21.264012070993573, 21.29581595460573, 21.07340986529985, 16.109818790728838, 16.01321945215264, 15.996214563647897, 27.18689502775669, 27.891498560551554, 27.88270951807499, 16.875715417166546, 17.018449058135346, 17.322896808230624, 18.40252989406386, 18.42284848416844, 18.113494026164204, 23.177090066174657, 23.175899947683007, 23.48953851747015, 25.24060922736922, 25.46443419593075, 25.508094211729855, 15.081926514705017, 15.828942791869238, 15.985103738804654, 16.929935583223894, 16.745126390208796, 17.018319484389693, 28.11095794538656, 28.27273206661144, 27.44542723397413, 23.763970526556164, 23.65136010448137, 23.525683636466653, 17.61153294146061, 17.063868328928947, 17.42809484153986, 26.46498564630747, 25.72762504220009, 26.517759449779987, 12.276680341921747, 11.911190196871758, 12.089155212044716, 20.837783635904387, 20.779887819041804, 20.77629308154185, 25.2649109798173, 25.089454295734555, 25.368707141528517, 21.065544878443077, 21.614934300382927, 21.574074664463595, 5.761679551874593, 5.700538513561085, 5.435613264640168, 26.74400937060514, 27.04235142345229, 27.231636050719914, 26.750134026010826, 27.145987284680203, 27.51404561226566, 20.992065490533903, 21.081384559472397, 20.842694145937756, 18.546377419183642, 18.053986037770898, 18.430085888753325, 26.74773132801056, 26.840112157166004, 26.809699520468712, 20.554689089457185, 21.996875554012746, 21.88248144897321, 23.16773246228695, 22.970409274101257, 22.945775158703327, 13.934116090337426, 13.822749132911355, 13.867276317129523, -0.6202228727440087, -0.4896723187218157, -1.993635574976608, 21.44324068849285, 21.58595185199131, 21.10309789826472, 22.92134929153447, 22.255127867062882, 22.74703386177619, 15.485794201493263, 15.324938140809536, 15.285937070846558, 27.226878856619194, 27.752860668425754, 27.464302112658814, 19.83266270160675, 21.144197868648916, 20.88277653232217, 22.126965274413422, 22.295235221584633, 22.416905512412384, 22.628357765575245, 22.925220785041645, 22.77097052087386, 26.057725009818867, 25.9241308098038, 25.863178466757134, 20.106461131324366, 20.330275305857256, 20.3550331753989, 7.758820649236441, 7.914595525711775, 7.6152080073952675, 18.9482876684245, 18.51130298276742, 18.51213826735814, 29.522494604190186, 30.07983997960885, 29.86145433535178, 8.638498581945896, 8.509793117642403, 9.020503260195255, 22.87251907835403, 22.906759935120732, 22.67709958801666, 23.187427078684166, 22.266767551501587, 23.444975861658648, 23.227824792265892, 23.34335219115019, 23.50904118269682, 12.86528886245408, 12.117220481236771, 12.796847137001649, 23.761029449601963, 23.808037360509232, 23.640230690439537, 30.09902825330694, 29.958154295881585, 29.822732431193188, 23.185218433539063, 23.296570154527814, 23.2225164870421, 12.960096267362431, 13.102038898815707, 13.111038082589701, 19.311175311605126, 19.01277847836414, 19.057410585383565, 29.642206986745194, 30.300889925410345, 29.893233736356095, 19.456720421711594, 19.8612911949555, 20.353657966751285, -2.742829543848842, -2.4218549694245155, -2.861075547834247, 22.828244598582387, 22.874939668923616, 22.84157581999898, 18.93005523582299, 19.062936191757515, 18.82809694608052, 0.8084562967220847, 0.6252902920047347, -0.7407711644967492, 27.81057734539111, 27.84411309783657, 27.868100074430302, 10.232395856330783, 10.253945412735135, 10.291417651499302, 14.88136039425929, 14.160848607619599, 15.198449914654091, 25.8620339979728, 26.272941556371123, 26.153599598755434, 19.1710113932689, 19.083850403626755, 19.778714616627738, 19.166387130816773, 19.555158035208777, 19.437197518845394, 16.75049492095907, 16.467287865777806, 16.662012254198387, 26.34568826854229, 26.8822236135602, 26.797224186360836, 22.91983564322193, 22.335853566726044, 22.565234964092568, 20.090147162477166, 20.09681088725725, 20.23319965104261, -3.761622869720071, -3.9059161966045792, -3.962796164055675, 3.20912554115057, 3.3938227146863937, 3.347964446991682, 21.31066650400558, 21.827367118249327, 21.01212520400682, 17.955944438775376, 18.358266969056174, 17.357350563009575, 19.70143788432081, 19.676794995864228, 19.598698829611138, 17.94246796270211, 17.949159887929753, 18.037039784093693, 20.33020546038945, 20.36585572486122, 20.245054749151066, 16.96006443599859, 16.95167716840902, 16.61070119837919, 13.1176397340993, 13.006533882270247, 13.155799428621918, 17.10728361209233, 17.697083893542484, 17.72379876983662, 22.819522839039564, 22.435573019087315, 22.33365611732006, 24.127032135302812, 24.13567040829608, 23.660100924472005, 23.489730914433792, 23.379792903860405, 23.294880052407578, -6.322231516242027, -5.629563890397549, -5.780370905995369, 10.5388871555527, 10.200191472967461, 10.753602178146437, 19.840056498845414, 19.988069621225193, 19.89797757317622, 24.700500321884945, 24.88585554932554, 24.891481145129845, 18.91979141098757, 19.00049399522443, 18.653299053510025, 24.73410056034723, 25.245246878514678, 25.28560845243433, 28.043060810615614, 27.90441923340161, 28.126862799127892, 22.54885474095741, 22.706817778448254, 22.81370425472656, 19.713503337775663, 19.493570571144417, 19.556452465554074, 20.864587778846413, 20.929665620128304, 20.92205138752857, 22.086286099627614, 22.1288978792727, 21.954780511558056, 16.538380332912, 16.108169960478932, 16.211324366430432, 25.4191009439528, 25.049982398748398, 25.221047393977642, 21.304774438341454, 21.287852828701332, 21.80114818302293, 22.811057311793164, 22.61442248274882, 22.56435141464074, 25.571275368332863, 25.329294741153717, 25.542381644248962, 18.208198724935443, 17.65724384287992, 18.49243216511482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16090487248134253, "mean_inference_ms": 0.725681200778731, "mean_action_processing_ms": 0.10142343262718914, "mean_env_wait_ms": 0.8367758784844095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 623610, "timesteps_this_iter": 0, "agent_timesteps_total": 1870830, "timers": {"sample_time_ms": 20352.39, "sample_throughput": 471.394, "load_time_ms": 0.403, "load_throughput": 23819197.689, "learn_time_ms": 3129.986, "learn_throughput": 3065.19, "update_time_ms": 8.436}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.413988113403321e-07, "cur_lr": 0.0005, "total_loss": 6.670296669006348, "policy_loss": -0.0005830289332702798, "vf_loss": 6.779354691505432, "vf_explained_var": 0.0859740823507309, "kl": 0.0056861529884007535, "entropy": 10.847513556480408, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 623610, "num_agent_steps_sampled": 1870830, "num_steps_trained": 623610, "num_agent_steps_trained": 1870830, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2866, "training_iteration": 65, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-05-49", "timestamp": 1706191549, "time_this_iter_s": 20.238983869552612, "time_total_s": 1350.4502429962158, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BD01F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1350.4502429962158, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 8.385714285714286, "ram_util_percent": 46.46071428571428}}
{"episode_reward_max": 89.87991498038171, "episode_reward_min": -17.732166312634945, "episode_reward_mean": 58.12063059588602, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -6.322231516242027}, "policy_reward_max": {"shared_policy": 30.300889925410345}, "policy_reward_mean": {"shared_policy": 19.373543531962003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.92351102037354, 46.09666941314936, 82.44404163770376, 61.859637102577835, 66.83910600841044, 68.32454907149075, 77.8450342863798, 60.791769612580524, 23.288624182343483, 55.971728918550056, 89.46378891915082, 26.168794959783554, 68.45637860149142, 68.8991704918444, 70.0802181661129, 37.7793564806925, 71.20929750055073, 89.87991498038171, 69.70430507510898, 39.17317324876784, 57.38136437535283, 89.83633064851163, 59.67166958341838, -8.025760061107604, 68.54476008750498, 56.82108837366103, 0.6929754242300703, 83.52279051765798, 30.77775892056522, 44.24065891653298, 78.28857515309936, 58.03357641352339, 58.158742684870944, 49.879795040935264, 80.02513606846333, 67.82092417404054, 60.420157700777025, -11.630335230380325, 9.950912702828646, 64.15015882626173, 53.671561970841125, 58.976931709796176, 53.92866763472556, 60.941115934401736, 50.5224428027868, 39.279973044991465, 52.528166275471435, 67.58875197544694, 71.9228034680709, 70.16440387070178, -17.732166312634945, 31.4926808066666, 59.72610369324683, 74.47783701634033, 56.57358445972203, 75.26495589129624, 84.07434284314512, 68.06937677413222, 58.763526374474154, 62.71630478650329, 66.16996449045837, 48.85787465982136, 75.69013073667884, 64.39377545006572, 67.98983120918273, 76.44295175373554, 54.357874732930185, 50.61948453634976, 54.62334417551753, 84.63916332274673, 49.98895269632338, 68.45217486936598, 59.49711599200964, 57.741602424532175, 70.08254390489309, 58.33697107434271, 69.25380265619606, 63.36813735216853, 47.845871046185465, 73.14158549159764, 46.69200338609515, 65.09722744207828, 67.9583642585203, 59.30734186992049, 73.36867958214134, 45.994627321138964, 61.54482720908709, 48.22063075378534, 39.62247895542532, 62.20760588347909, 68.43676816485821, 74.24878759682178, 23.487262032926054, 64.06267134286462, 62.4356691157445, 66.60141481831667, 49.99679158255455, 70.88380415737629, 44.61602624505757, 82.07521027699113], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.92134929153447, 22.255127867062882, 22.74703386177619, 15.485794201493263, 15.324938140809536, 15.285937070846558, 27.226878856619194, 27.752860668425754, 27.464302112658814, 19.83266270160675, 21.144197868648916, 20.88277653232217, 22.126965274413422, 22.295235221584633, 22.416905512412384, 22.628357765575245, 22.925220785041645, 22.77097052087386, 26.057725009818867, 25.9241308098038, 25.863178466757134, 20.106461131324366, 20.330275305857256, 20.3550331753989, 7.758820649236441, 7.914595525711775, 7.6152080073952675, 18.9482876684245, 18.51130298276742, 18.51213826735814, 29.522494604190186, 30.07983997960885, 29.86145433535178, 8.638498581945896, 8.509793117642403, 9.020503260195255, 22.87251907835403, 22.906759935120732, 22.67709958801666, 23.187427078684166, 22.266767551501587, 23.444975861658648, 23.227824792265892, 23.34335219115019, 23.50904118269682, 12.86528886245408, 12.117220481236771, 12.796847137001649, 23.761029449601963, 23.808037360509232, 23.640230690439537, 30.09902825330694, 29.958154295881585, 29.822732431193188, 23.185218433539063, 23.296570154527814, 23.2225164870421, 12.960096267362431, 13.102038898815707, 13.111038082589701, 19.311175311605126, 19.01277847836414, 19.057410585383565, 29.642206986745194, 30.300889925410345, 29.893233736356095, 19.456720421711594, 19.8612911949555, 20.353657966751285, -2.742829543848842, -2.4218549694245155, -2.861075547834247, 22.828244598582387, 22.874939668923616, 22.84157581999898, 18.93005523582299, 19.062936191757515, 18.82809694608052, 0.8084562967220847, 0.6252902920047347, -0.7407711644967492, 27.81057734539111, 27.84411309783657, 27.868100074430302, 10.232395856330783, 10.253945412735135, 10.291417651499302, 14.88136039425929, 14.160848607619599, 15.198449914654091, 25.8620339979728, 26.272941556371123, 26.153599598755434, 19.1710113932689, 19.083850403626755, 19.778714616627738, 19.166387130816773, 19.555158035208777, 19.437197518845394, 16.75049492095907, 16.467287865777806, 16.662012254198387, 26.34568826854229, 26.8822236135602, 26.797224186360836, 22.91983564322193, 22.335853566726044, 22.565234964092568, 20.090147162477166, 20.09681088725725, 20.23319965104261, -3.761622869720071, -3.9059161966045792, -3.962796164055675, 3.20912554115057, 3.3938227146863937, 3.347964446991682, 21.31066650400558, 21.827367118249327, 21.01212520400682, 17.955944438775376, 18.358266969056174, 17.357350563009575, 19.70143788432081, 19.676794995864228, 19.598698829611138, 17.94246796270211, 17.949159887929753, 18.037039784093693, 20.33020546038945, 20.36585572486122, 20.245054749151066, 16.96006443599859, 16.95167716840902, 16.61070119837919, 13.1176397340993, 13.006533882270247, 13.155799428621918, 17.10728361209233, 17.697083893542484, 17.72379876983662, 22.819522839039564, 22.435573019087315, 22.33365611732006, 24.127032135302812, 24.13567040829608, 23.660100924472005, 23.489730914433792, 23.379792903860405, 23.294880052407578, -6.322231516242027, -5.629563890397549, -5.780370905995369, 10.5388871555527, 10.200191472967461, 10.753602178146437, 19.840056498845414, 19.988069621225193, 19.89797757317622, 24.700500321884945, 24.88585554932554, 24.891481145129845, 18.91979141098757, 19.00049399522443, 18.653299053510025, 24.73410056034723, 25.245246878514678, 25.28560845243433, 28.043060810615614, 27.90441923340161, 28.126862799127892, 22.54885474095741, 22.706817778448254, 22.81370425472656, 19.713503337775663, 19.493570571144417, 19.556452465554074, 20.864587778846413, 20.929665620128304, 20.92205138752857, 22.086286099627614, 22.1288978792727, 21.954780511558056, 16.538380332912, 16.108169960478932, 16.211324366430432, 25.4191009439528, 25.049982398748398, 25.221047393977642, 21.304774438341454, 21.287852828701332, 21.80114818302293, 22.811057311793164, 22.61442248274882, 22.56435141464074, 25.571275368332863, 25.329294741153717, 25.542381644248962, 18.208198724935443, 17.65724384287992, 18.49243216511482, 16.47275187571843, 16.893256199856594, 17.253476460774735, 18.00403435031572, 18.44488416115442, 18.17442566404739, 28.395896221200616, 28.297251763443143, 27.946015338102967, 16.777332247545317, 16.763955549647406, 16.447664899130658, 23.07824754187216, 22.511722226937607, 22.86220510055621, 19.85475316271186, 19.850164694711566, 19.792198134586215, 19.026818066835403, 19.233754850924015, 19.481029506772757, 23.134219413002327, 23.682115435910717, 23.266209055980042, 19.74385357399781, 19.2388455470403, 19.354271953304604, 22.829412311315536, 23.32167453225702, 23.1027158126235, 21.101045193771512, 21.000541518131882, 21.266550640265137, 16.18009917686382, 15.85782718161741, 15.807944687704236, 24.332990800340966, 24.371328098078564, 24.43726659317811, 15.97321600404878, 15.47861311336358, 15.240174268682793, 21.39017530282338, 22.1606016534691, 21.546450485785797, 22.720531839877367, 22.394122444093227, 22.84370997454971, 19.86477852985263, 19.725633963942528, 19.716929376125336, 24.381131425499916, 24.318932376801968, 24.668615779839456, 15.492719748367861, 15.506624589984611, 14.995282982786492, 20.07758927345276, 20.7282319762744, 20.73900595935993, 15.784832785526902, 16.18521080041924, 16.2505871678392, 13.443883084692061, 13.133627399802208, 13.044968470931053, 20.395454580585152, 20.98830923686424, 20.823842066029698, 22.463984628518418, 23.1026726954927, 22.87011084084709, 24.396170273423195, 24.985709086060524, 24.866908237338066, 7.678391615549714, 7.790818902353436, 8.018051515022904, 21.121313152213887, 21.354498033722237, 21.586860156928495, 20.921544688443333, 20.504309753576905, 21.009814673724264, 22.09407866249481, 22.147046255568654, 22.360289900253207, 16.7461931357781, 16.756607501457125, 16.493990945319325, 23.662728384137154, 23.52991645783186, 23.691159315407276, 14.913382617135838, 14.973406245311097, 14.729237382610634, 27.303845692425966, 27.335688319057226, 27.435676265507936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16071835824631742, "mean_inference_ms": 0.7252254141243094, "mean_action_processing_ms": 0.10145462044690925, "mean_env_wait_ms": 0.8361232509748701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 633204, "timesteps_this_iter": 0, "agent_timesteps_total": 1899612, "timers": {"sample_time_ms": 20323.92, "sample_throughput": 472.055, "load_time_ms": 0.403, "load_throughput": 23819197.689, "learn_time_ms": 3122.954, "learn_throughput": 3072.092, "update_time_ms": 8.381}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.413988113403321e-07, "cur_lr": 0.0005, "total_loss": 5.258774816989899, "policy_loss": 0.00153675366142364, "vf_loss": 5.367433547973633, "vf_explained_var": -0.04148632287979126, "kl": 0.005940483824872307, "entropy": 11.019537210464478, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 633204, "num_agent_steps_sampled": 1899612, "num_steps_trained": 633204, "num_agent_steps_trained": 1899612, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2899, "training_iteration": 66, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-06-09", "timestamp": 1706191569, "time_this_iter_s": 20.168387174606323, "time_total_s": 1370.6186301708221, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1370.6186301708221, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 9.413793103448276, "ram_util_percent": 46.662068965517236}}
{"episode_reward_max": 84.63916332274673, "episode_reward_min": -17.732166312634945, "episode_reward_mean": 57.97788402077683, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -6.322231516242027}, "policy_reward_max": {"shared_policy": 28.395896221200616}, "policy_reward_mean": {"shared_policy": 19.32596134025894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.158742684870944, 49.879795040935264, 80.02513606846333, 67.82092417404054, 60.420157700777025, -11.630335230380325, 9.950912702828646, 64.15015882626173, 53.671561970841125, 58.976931709796176, 53.92866763472556, 60.941115934401736, 50.5224428027868, 39.279973044991465, 52.528166275471435, 67.58875197544694, 71.9228034680709, 70.16440387070178, -17.732166312634945, 31.4926808066666, 59.72610369324683, 74.47783701634033, 56.57358445972203, 75.26495589129624, 84.07434284314512, 68.06937677413222, 58.763526374474154, 62.71630478650329, 66.16996449045837, 48.85787465982136, 75.69013073667884, 64.39377545006572, 67.98983120918273, 76.44295175373554, 54.357874732930185, 50.61948453634976, 54.62334417551753, 84.63916332274673, 49.98895269632338, 68.45217486936598, 59.49711599200964, 57.741602424532175, 70.08254390489309, 58.33697107434271, 69.25380265619606, 63.36813735216853, 47.845871046185465, 73.14158549159764, 46.69200338609515, 65.09722744207828, 67.9583642585203, 59.30734186992049, 73.36867958214134, 45.994627321138964, 61.54482720908709, 48.22063075378534, 39.62247895542532, 62.20760588347909, 68.43676816485821, 74.24878759682178, 23.487262032926054, 64.06267134286462, 62.4356691157445, 66.60141481831667, 49.99679158255455, 70.88380415737629, 44.61602624505757, 82.07521027699113, 50.06225328892468, 81.55647645622955, 5.021865651011453, 75.4659317731857, 66.20787449745691, 50.06653414852916, 64.51372598856688, 78.06785168498753, 46.77832394838333, 39.79716587252912, 83.51190961152312, 34.07277038693425, 68.17816934362051, 62.1107400781475, 78.85791148617864, 52.94852359779179, 24.63652680441737, 66.88516839500514, 79.50150036811827, 68.47773694014175, 63.49727870523928, 42.50397100113331, 71.63904191367328, 49.80091940239072, 74.73364565055817, 57.265839532017694, 10.425967812538119, 41.00239947251973, 58.269482036121175, 65.44197966158387, 71.09922790154812, 65.311487108469], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.166387130816773, 19.555158035208777, 19.437197518845394, 16.75049492095907, 16.467287865777806, 16.662012254198387, 26.34568826854229, 26.8822236135602, 26.797224186360836, 22.91983564322193, 22.335853566726044, 22.565234964092568, 20.090147162477166, 20.09681088725725, 20.23319965104261, -3.761622869720071, -3.9059161966045792, -3.962796164055675, 3.20912554115057, 3.3938227146863937, 3.347964446991682, 21.31066650400558, 21.827367118249327, 21.01212520400682, 17.955944438775376, 18.358266969056174, 17.357350563009575, 19.70143788432081, 19.676794995864228, 19.598698829611138, 17.94246796270211, 17.949159887929753, 18.037039784093693, 20.33020546038945, 20.36585572486122, 20.245054749151066, 16.96006443599859, 16.95167716840902, 16.61070119837919, 13.1176397340993, 13.006533882270247, 13.155799428621918, 17.10728361209233, 17.697083893542484, 17.72379876983662, 22.819522839039564, 22.435573019087315, 22.33365611732006, 24.127032135302812, 24.13567040829608, 23.660100924472005, 23.489730914433792, 23.379792903860405, 23.294880052407578, -6.322231516242027, -5.629563890397549, -5.780370905995369, 10.5388871555527, 10.200191472967461, 10.753602178146437, 19.840056498845414, 19.988069621225193, 19.89797757317622, 24.700500321884945, 24.88585554932554, 24.891481145129845, 18.91979141098757, 19.00049399522443, 18.653299053510025, 24.73410056034723, 25.245246878514678, 25.28560845243433, 28.043060810615614, 27.90441923340161, 28.126862799127892, 22.54885474095741, 22.706817778448254, 22.81370425472656, 19.713503337775663, 19.493570571144417, 19.556452465554074, 20.864587778846413, 20.929665620128304, 20.92205138752857, 22.086286099627614, 22.1288978792727, 21.954780511558056, 16.538380332912, 16.108169960478932, 16.211324366430432, 25.4191009439528, 25.049982398748398, 25.221047393977642, 21.304774438341454, 21.287852828701332, 21.80114818302293, 22.811057311793164, 22.61442248274882, 22.56435141464074, 25.571275368332863, 25.329294741153717, 25.542381644248962, 18.208198724935443, 17.65724384287992, 18.49243216511482, 16.47275187571843, 16.893256199856594, 17.253476460774735, 18.00403435031572, 18.44488416115442, 18.17442566404739, 28.395896221200616, 28.297251763443143, 27.946015338102967, 16.777332247545317, 16.763955549647406, 16.447664899130658, 23.07824754187216, 22.511722226937607, 22.86220510055621, 19.85475316271186, 19.850164694711566, 19.792198134586215, 19.026818066835403, 19.233754850924015, 19.481029506772757, 23.134219413002327, 23.682115435910717, 23.266209055980042, 19.74385357399781, 19.2388455470403, 19.354271953304604, 22.829412311315536, 23.32167453225702, 23.1027158126235, 21.101045193771512, 21.000541518131882, 21.266550640265137, 16.18009917686382, 15.85782718161741, 15.807944687704236, 24.332990800340966, 24.371328098078564, 24.43726659317811, 15.97321600404878, 15.47861311336358, 15.240174268682793, 21.39017530282338, 22.1606016534691, 21.546450485785797, 22.720531839877367, 22.394122444093227, 22.84370997454971, 19.86477852985263, 19.725633963942528, 19.716929376125336, 24.381131425499916, 24.318932376801968, 24.668615779839456, 15.492719748367861, 15.506624589984611, 14.995282982786492, 20.07758927345276, 20.7282319762744, 20.73900595935993, 15.784832785526902, 16.18521080041924, 16.2505871678392, 13.443883084692061, 13.133627399802208, 13.044968470931053, 20.395454580585152, 20.98830923686424, 20.823842066029698, 22.463984628518418, 23.1026726954927, 22.87011084084709, 24.396170273423195, 24.985709086060524, 24.866908237338066, 7.678391615549714, 7.790818902353436, 8.018051515022904, 21.121313152213887, 21.354498033722237, 21.586860156928495, 20.921544688443333, 20.504309753576905, 21.009814673724264, 22.09407866249481, 22.147046255568654, 22.360289900253207, 16.7461931357781, 16.756607501457125, 16.493990945319325, 23.662728384137154, 23.52991645783186, 23.691159315407276, 14.913382617135838, 14.973406245311097, 14.729237382610634, 27.303845692425966, 27.335688319057226, 27.435676265507936, 16.529318926235035, 16.921167497833565, 16.61176686485608, 27.11328688884774, 27.30125860477952, 27.141930962602288, 1.552485172947243, 1.6452207987507137, 1.824159679313496, 25.156846317152173, 25.147748822967202, 25.161336633066327, 21.995512219766766, 22.09459658075744, 22.117765696932707, 16.762680885692433, 16.870158053313688, 16.433695209523037, 21.507708217948675, 21.370683640241623, 21.635334130376577, 26.06025334571798, 26.081180201222494, 25.926418138047055, 15.149319991469383, 15.788745228201151, 15.840258728712797, 13.374461787442357, 13.657146324093134, 12.76555776099363, 27.898839014271886, 27.564385170737893, 28.048685426513345, 11.360876965026051, 11.409697639445454, 11.302195782462746, 22.69273258994022, 22.697076967606932, 22.788359786073357, 20.550870772451162, 20.83585357805714, 20.7240157276392, 26.226692341268063, 26.237767592072487, 26.393451552838087, 17.673566929996014, 17.347523003816605, 17.927433663979173, 7.974269963800907, 8.337572176009417, 8.324684664607048, 22.041763606170804, 22.580026605787367, 22.263378183046967, 26.294775386651352, 26.548773949344948, 26.65795103212197, 22.817555460457996, 22.94628059196596, 22.7139008877178, 21.212622379263237, 21.20393194754918, 21.080724378426865, 14.026581657429531, 14.432460780565933, 14.044928563137844, 23.762466561049223, 23.97401641868055, 23.90255893394351, 16.55293534696102, 16.470507487654686, 16.77747656777501, 25.08400392718613, 25.167287425138056, 24.482354298233986, 18.9233926658829, 19.123744887610272, 19.21870197852452, 3.3959431747595374, 3.577642532686383, 3.452382105092198, 13.43878776083389, 13.918339007223636, 13.6452727044622, 19.62903441706051, 19.3187486877044, 19.321698931356266, 21.544234494368226, 21.96765387679139, 21.930091290424258, 23.76295796657601, 23.53758410612741, 23.798685828844697, 21.598530416687325, 21.837459062536553, 21.875497629245118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16063732478972892, "mean_inference_ms": 0.7252543511849834, "mean_action_processing_ms": 0.10148003310442771, "mean_env_wait_ms": 0.8358673107939458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 642798, "timesteps_this_iter": 0, "agent_timesteps_total": 1928394, "timers": {"sample_time_ms": 20360.554, "sample_throughput": 471.205, "load_time_ms": 0.503, "load_throughput": 19080205.11, "learn_time_ms": 3116.723, "learn_throughput": 3078.233, "update_time_ms": 8.579}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.413988113403321e-07, "cur_lr": 0.0005, "total_loss": 6.161803185939789, "policy_loss": 0.0001600276158597591, "vf_loss": 6.272182762622833, "vf_explained_var": 0.011649377644062042, "kl": 0.003603253688255184, "entropy": 11.053947806358337, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 642798, "num_agent_steps_sampled": 1928394, "num_steps_trained": 642798, "num_agent_steps_trained": 1928394, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2931, "training_iteration": 67, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-06-30", "timestamp": 1706191590, "time_this_iter_s": 20.601745128631592, "time_total_s": 1391.2203752994537, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1391.2203752994537, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 10.624137931034484, "ram_util_percent": 46.74137931034481}}
{"episode_reward_max": 95.59985815733668, "episode_reward_min": 5.021865651011453, "episode_reward_mean": 59.72601900451991, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 1.552485172947243}, "policy_reward_max": {"shared_policy": 31.94747256177166}, "policy_reward_mean": {"shared_policy": 19.90867300150663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.98983120918273, 76.44295175373554, 54.357874732930185, 50.61948453634976, 54.62334417551753, 84.63916332274673, 49.98895269632338, 68.45217486936598, 59.49711599200964, 57.741602424532175, 70.08254390489309, 58.33697107434271, 69.25380265619606, 63.36813735216853, 47.845871046185465, 73.14158549159764, 46.69200338609515, 65.09722744207828, 67.9583642585203, 59.30734186992049, 73.36867958214134, 45.994627321138964, 61.54482720908709, 48.22063075378534, 39.62247895542532, 62.20760588347909, 68.43676816485821, 74.24878759682178, 23.487262032926054, 64.06267134286462, 62.4356691157445, 66.60141481831667, 49.99679158255455, 70.88380415737629, 44.61602624505757, 82.07521027699113, 50.06225328892468, 81.55647645622955, 5.021865651011453, 75.4659317731857, 66.20787449745691, 50.06653414852916, 64.51372598856688, 78.06785168498753, 46.77832394838333, 39.79716587252912, 83.51190961152312, 34.07277038693425, 68.17816934362051, 62.1107400781475, 78.85791148617864, 52.94852359779179, 24.63652680441737, 66.88516839500514, 79.50150036811827, 68.47773694014175, 63.49727870523928, 42.50397100113331, 71.63904191367328, 49.80091940239072, 74.73364565055817, 57.265839532017694, 10.425967812538119, 41.00239947251973, 58.269482036121175, 65.44197966158387, 71.09922790154812, 65.311487108469, 58.86211390420793, 51.287398079410195, 69.29119021259248, 63.03938199579714, 49.683235894888625, 83.2595986165106, 80.96168680209666, 77.12822899594903, 78.33773919939995, 62.39425336569545, 59.18699643388388, 49.48163698241113, 61.26237682253121, 61.58891859650609, 40.04425331205127, 56.79873603582382, 54.98706113453953, 53.265079143224256, 27.25254900008437, 51.596092954277964, 62.03750502644104, 57.23185734450814, 68.37252523750065, 39.69101552665231, 64.48742844164369, 54.04713059309867, 70.71897542476653, 95.59985815733668, 71.1566313644871, 40.68394892662761, 50.90784788876772, 77.00884928554294], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.811057311793164, 22.61442248274882, 22.56435141464074, 25.571275368332863, 25.329294741153717, 25.542381644248962, 18.208198724935443, 17.65724384287992, 18.49243216511482, 16.47275187571843, 16.893256199856594, 17.253476460774735, 18.00403435031572, 18.44488416115442, 18.17442566404739, 28.395896221200616, 28.297251763443143, 27.946015338102967, 16.777332247545317, 16.763955549647406, 16.447664899130658, 23.07824754187216, 22.511722226937607, 22.86220510055621, 19.85475316271186, 19.850164694711566, 19.792198134586215, 19.026818066835403, 19.233754850924015, 19.481029506772757, 23.134219413002327, 23.682115435910717, 23.266209055980042, 19.74385357399781, 19.2388455470403, 19.354271953304604, 22.829412311315536, 23.32167453225702, 23.1027158126235, 21.101045193771512, 21.000541518131882, 21.266550640265137, 16.18009917686382, 15.85782718161741, 15.807944687704236, 24.332990800340966, 24.371328098078564, 24.43726659317811, 15.97321600404878, 15.47861311336358, 15.240174268682793, 21.39017530282338, 22.1606016534691, 21.546450485785797, 22.720531839877367, 22.394122444093227, 22.84370997454971, 19.86477852985263, 19.725633963942528, 19.716929376125336, 24.381131425499916, 24.318932376801968, 24.668615779839456, 15.492719748367861, 15.506624589984611, 14.995282982786492, 20.07758927345276, 20.7282319762744, 20.73900595935993, 15.784832785526902, 16.18521080041924, 16.2505871678392, 13.443883084692061, 13.133627399802208, 13.044968470931053, 20.395454580585152, 20.98830923686424, 20.823842066029698, 22.463984628518418, 23.1026726954927, 22.87011084084709, 24.396170273423195, 24.985709086060524, 24.866908237338066, 7.678391615549714, 7.790818902353436, 8.018051515022904, 21.121313152213887, 21.354498033722237, 21.586860156928495, 20.921544688443333, 20.504309753576905, 21.009814673724264, 22.09407866249481, 22.147046255568654, 22.360289900253207, 16.7461931357781, 16.756607501457125, 16.493990945319325, 23.662728384137154, 23.52991645783186, 23.691159315407276, 14.913382617135838, 14.973406245311097, 14.729237382610634, 27.303845692425966, 27.335688319057226, 27.435676265507936, 16.529318926235035, 16.921167497833565, 16.61176686485608, 27.11328688884774, 27.30125860477952, 27.141930962602288, 1.552485172947243, 1.6452207987507137, 1.824159679313496, 25.156846317152173, 25.147748822967202, 25.161336633066327, 21.995512219766766, 22.09459658075744, 22.117765696932707, 16.762680885692433, 16.870158053313688, 16.433695209523037, 21.507708217948675, 21.370683640241623, 21.635334130376577, 26.06025334571798, 26.081180201222494, 25.926418138047055, 15.149319991469383, 15.788745228201151, 15.840258728712797, 13.374461787442357, 13.657146324093134, 12.76555776099363, 27.898839014271886, 27.564385170737893, 28.048685426513345, 11.360876965026051, 11.409697639445454, 11.302195782462746, 22.69273258994022, 22.697076967606932, 22.788359786073357, 20.550870772451162, 20.83585357805714, 20.7240157276392, 26.226692341268063, 26.237767592072487, 26.393451552838087, 17.673566929996014, 17.347523003816605, 17.927433663979173, 7.974269963800907, 8.337572176009417, 8.324684664607048, 22.041763606170804, 22.580026605787367, 22.263378183046967, 26.294775386651352, 26.548773949344948, 26.65795103212197, 22.817555460457996, 22.94628059196596, 22.7139008877178, 21.212622379263237, 21.20393194754918, 21.080724378426865, 14.026581657429531, 14.432460780565933, 14.044928563137844, 23.762466561049223, 23.97401641868055, 23.90255893394351, 16.55293534696102, 16.470507487654686, 16.77747656777501, 25.08400392718613, 25.167287425138056, 24.482354298233986, 18.9233926658829, 19.123744887610272, 19.21870197852452, 3.3959431747595374, 3.577642532686383, 3.452382105092198, 13.43878776083389, 13.918339007223636, 13.6452727044622, 19.62903441706051, 19.3187486877044, 19.321698931356266, 21.544234494368226, 21.96765387679139, 21.930091290424258, 23.76295796657601, 23.53758410612741, 23.798685828844697, 21.598530416687325, 21.837459062536553, 21.875497629245118, 19.396344562371567, 19.713766825695828, 19.752002516140536, 17.19852433912456, 17.222802717238665, 16.86607102304697, 22.76949829608202, 23.270970319397748, 23.250721597112715, 21.23292415340741, 21.027915244301155, 20.778542598088578, 16.511773771916822, 16.569822511946157, 16.601639611025647, 27.808839357147605, 27.669282662371785, 27.78147659699121, 26.972231540828943, 26.93568867817521, 27.05376658309251, 25.502259328961372, 25.956742491573095, 25.669227175414562, 26.130766563117504, 26.054926246404648, 26.152046389877796, 20.513147617379815, 20.816456543902547, 21.064649204413087, 19.81582140798369, 19.643480482200772, 19.727694543699414, 16.543322065224245, 16.64489271988471, 16.293422197302178, 20.44686399151881, 20.325753909846142, 20.489758921166256, 20.50943412880102, 20.616642283896596, 20.462842183808476, 13.440605179096252, 13.364654109502823, 13.238994023452193, 18.852674648165703, 18.85818513482809, 19.08787625283003, 18.626674391639725, 17.84855069716771, 18.511836045732096, 18.18765196708651, 17.773905190328747, 17.303521985809, 9.001767459015042, 9.19395615408817, 9.05682538698116, 17.05115797619024, 17.280278174827487, 17.264656803260237, 20.616473498443753, 21.05280306764567, 20.368228460351617, 18.5908458183209, 19.545837732652814, 19.09517379353443, 22.482378793259457, 23.00317221631606, 22.886974227925137, 13.285064476231724, 13.411437759796769, 12.994513290623814, 21.242989401022584, 21.592058890188724, 21.65238015043238, 18.255202520328254, 17.80143706748882, 17.990491005281598, 23.664265555640057, 23.44440421213706, 23.61030565698941, 31.94747256177166, 31.84819117250541, 31.804194423059613, 24.02993487225224, 23.499028724928692, 23.627667767306164, 13.185767794648797, 13.744020688037068, 13.754160443941743, 16.89960691705346, 17.068892993032932, 16.939347978681326, 25.733760910729558, 25.381849649051816, 25.893238725761563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16054499808530528, "mean_inference_ms": 0.7252471633882276, "mean_action_processing_ms": 0.10147076376614753, "mean_env_wait_ms": 0.8356798026818703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 652392, "timesteps_this_iter": 0, "agent_timesteps_total": 1957176, "timers": {"sample_time_ms": 20444.751, "sample_throughput": 469.265, "load_time_ms": 0.503, "load_throughput": 19080205.11, "learn_time_ms": 3105.651, "learn_throughput": 3089.208, "update_time_ms": 8.778}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2069940567016604e-07, "cur_lr": 0.0005, "total_loss": 5.59490579366684, "policy_loss": -0.000857097429927095, "vf_loss": 5.707714855670929, "vf_explained_var": -0.05812753736972809, "kl": 0.004164110781917432, "entropy": 11.195195198059082, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652392, "num_agent_steps_sampled": 1957176, "num_steps_trained": 652392, "num_agent_steps_trained": 1957176, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2963, "training_iteration": 68, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-06-51", "timestamp": 1706191611, "time_this_iter_s": 21.20058798789978, "time_total_s": 1412.4209632873535, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1412.4209632873535, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 10.586666666666666, "ram_util_percent": 47.32666666666667}}
{"episode_reward_max": 95.59985815733668, "episode_reward_min": 5.021865651011453, "episode_reward_mean": 60.70970098689606, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 1.552485172947243}, "policy_reward_max": {"shared_policy": 31.94747256177166}, "policy_reward_mean": {"shared_policy": 20.236566995632014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.99679158255455, 70.88380415737629, 44.61602624505757, 82.07521027699113, 50.06225328892468, 81.55647645622955, 5.021865651011453, 75.4659317731857, 66.20787449745691, 50.06653414852916, 64.51372598856688, 78.06785168498753, 46.77832394838333, 39.79716587252912, 83.51190961152312, 34.07277038693425, 68.17816934362051, 62.1107400781475, 78.85791148617864, 52.94852359779179, 24.63652680441737, 66.88516839500514, 79.50150036811827, 68.47773694014175, 63.49727870523928, 42.50397100113331, 71.63904191367328, 49.80091940239072, 74.73364565055817, 57.265839532017694, 10.425967812538119, 41.00239947251973, 58.269482036121175, 65.44197966158387, 71.09922790154812, 65.311487108469, 58.86211390420793, 51.287398079410195, 69.29119021259248, 63.03938199579714, 49.683235894888625, 83.2595986165106, 80.96168680209666, 77.12822899594903, 78.33773919939995, 62.39425336569545, 59.18699643388388, 49.48163698241113, 61.26237682253121, 61.58891859650609, 40.04425331205127, 56.79873603582382, 54.98706113453953, 53.265079143224256, 27.25254900008437, 51.596092954277964, 62.03750502644104, 57.23185734450814, 68.37252523750065, 39.69101552665231, 64.48742844164369, 54.04713059309867, 70.71897542476653, 95.59985815733668, 71.1566313644871, 40.68394892662761, 50.90784788876772, 77.00884928554294, 88.75574530661106, 60.78821801394221, 40.32256014645097, 51.72807680442929, 47.509270340204225, 46.70869346708058, 48.644760593771906, 63.050322238355875, 69.14572779834268, 61.65984731912613, 82.58298891037703, 45.16332277655599, 57.86745975539088, 70.92329981690273, 64.59829081967473, 66.67401911318301, 57.457720157690346, 78.91331227123736, 62.51758726127443, 64.59546944685277, 58.74915216118096, 60.87681045755744, 81.41375099122523, 77.17952875420451, 71.20149342995137, 61.226739374920726, 80.83524259552357, 67.32470773952082, 66.36493458412586, 56.587569899857016, 65.21323957666753, 57.4561032867059], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.7461931357781, 16.756607501457125, 16.493990945319325, 23.662728384137154, 23.52991645783186, 23.691159315407276, 14.913382617135838, 14.973406245311097, 14.729237382610634, 27.303845692425966, 27.335688319057226, 27.435676265507936, 16.529318926235035, 16.921167497833565, 16.61176686485608, 27.11328688884774, 27.30125860477952, 27.141930962602288, 1.552485172947243, 1.6452207987507137, 1.824159679313496, 25.156846317152173, 25.147748822967202, 25.161336633066327, 21.995512219766766, 22.09459658075744, 22.117765696932707, 16.762680885692433, 16.870158053313688, 16.433695209523037, 21.507708217948675, 21.370683640241623, 21.635334130376577, 26.06025334571798, 26.081180201222494, 25.926418138047055, 15.149319991469383, 15.788745228201151, 15.840258728712797, 13.374461787442357, 13.657146324093134, 12.76555776099363, 27.898839014271886, 27.564385170737893, 28.048685426513345, 11.360876965026051, 11.409697639445454, 11.302195782462746, 22.69273258994022, 22.697076967606932, 22.788359786073357, 20.550870772451162, 20.83585357805714, 20.7240157276392, 26.226692341268063, 26.237767592072487, 26.393451552838087, 17.673566929996014, 17.347523003816605, 17.927433663979173, 7.974269963800907, 8.337572176009417, 8.324684664607048, 22.041763606170804, 22.580026605787367, 22.263378183046967, 26.294775386651352, 26.548773949344948, 26.65795103212197, 22.817555460457996, 22.94628059196596, 22.7139008877178, 21.212622379263237, 21.20393194754918, 21.080724378426865, 14.026581657429531, 14.432460780565933, 14.044928563137844, 23.762466561049223, 23.97401641868055, 23.90255893394351, 16.55293534696102, 16.470507487654686, 16.77747656777501, 25.08400392718613, 25.167287425138056, 24.482354298233986, 18.9233926658829, 19.123744887610272, 19.21870197852452, 3.3959431747595374, 3.577642532686383, 3.452382105092198, 13.43878776083389, 13.918339007223636, 13.6452727044622, 19.62903441706051, 19.3187486877044, 19.321698931356266, 21.544234494368226, 21.96765387679139, 21.930091290424258, 23.76295796657601, 23.53758410612741, 23.798685828844697, 21.598530416687325, 21.837459062536553, 21.875497629245118, 19.396344562371567, 19.713766825695828, 19.752002516140536, 17.19852433912456, 17.222802717238665, 16.86607102304697, 22.76949829608202, 23.270970319397748, 23.250721597112715, 21.23292415340741, 21.027915244301155, 20.778542598088578, 16.511773771916822, 16.569822511946157, 16.601639611025647, 27.808839357147605, 27.669282662371785, 27.78147659699121, 26.972231540828943, 26.93568867817521, 27.05376658309251, 25.502259328961372, 25.956742491573095, 25.669227175414562, 26.130766563117504, 26.054926246404648, 26.152046389877796, 20.513147617379815, 20.816456543902547, 21.064649204413087, 19.81582140798369, 19.643480482200772, 19.727694543699414, 16.543322065224245, 16.64489271988471, 16.293422197302178, 20.44686399151881, 20.325753909846142, 20.489758921166256, 20.50943412880102, 20.616642283896596, 20.462842183808476, 13.440605179096252, 13.364654109502823, 13.238994023452193, 18.852674648165703, 18.85818513482809, 19.08787625283003, 18.626674391639725, 17.84855069716771, 18.511836045732096, 18.18765196708651, 17.773905190328747, 17.303521985809, 9.001767459015042, 9.19395615408817, 9.05682538698116, 17.05115797619024, 17.280278174827487, 17.264656803260237, 20.616473498443753, 21.05280306764567, 20.368228460351617, 18.5908458183209, 19.545837732652814, 19.09517379353443, 22.482378793259457, 23.00317221631606, 22.886974227925137, 13.285064476231724, 13.411437759796769, 12.994513290623814, 21.242989401022584, 21.592058890188724, 21.65238015043238, 18.255202520328254, 17.80143706748882, 17.990491005281598, 23.664265555640057, 23.44440421213706, 23.61030565698941, 31.94747256177166, 31.84819117250541, 31.804194423059613, 24.02993487225224, 23.499028724928692, 23.627667767306164, 13.185767794648797, 13.744020688037068, 13.754160443941743, 16.89960691705346, 17.068892993032932, 16.939347978681326, 25.733760910729558, 25.381849649051816, 25.893238725761563, 29.830332055687904, 29.971796303987503, 28.953616946935654, 19.845393563310296, 20.439503381649644, 20.503321068982274, 13.439032693083078, 13.396884916971118, 13.486642536396772, 17.28897863999009, 17.20000471919775, 17.23909344524145, 16.073739190896347, 15.773077232142285, 15.662453917165593, 15.478086223204926, 15.938037199278668, 15.292570044596985, 16.09379682938257, 16.385516266028077, 16.16544749836126, 21.101769104599953, 20.681058436632156, 21.267494697123766, 23.090471944461257, 23.120250872025878, 22.935004981855542, 20.59744570031762, 20.488210447132587, 20.57419117167592, 27.393368899822235, 27.674447529017925, 27.515172481536865, 15.319950001935155, 15.350444706777722, 14.49292806784311, 19.36949262022972, 19.502594616264105, 18.995372518897057, 23.744605131447315, 23.41964742541313, 23.75904726004228, 21.56547563523054, 21.472714453935623, 21.560100730508566, 22.10692685594161, 22.387710740168885, 22.179381517072514, 19.430206138640642, 18.60782042145729, 19.419693597592413, 26.38993479808171, 26.272780900200203, 26.250596572955445, 21.080148194606096, 20.628807025651128, 20.808632041017205, 21.65689128326872, 21.31710739682117, 21.621470766762883, 19.59943537910779, 19.465123017628983, 19.684593764444188, 20.110686793923378, 20.214214958250523, 20.55190870538354, 26.890415390332535, 27.201867913206414, 27.32146768768628, 25.453456342220306, 25.88445395231247, 25.841618459671736, 23.866279631853104, 24.157872068695724, 23.177341729402542, 20.365514911711216, 20.37804961949587, 20.48317484371364, 26.70397293070951, 27.049968058864266, 27.08130160594979, 22.5870293607004, 22.26764242351055, 22.470035955309868, 21.922681679328278, 22.132231400658682, 22.310021504138902, 18.86401830861965, 19.05333327750364, 18.670218313733727, 21.77013739695151, 21.83038269852598, 21.61271948119004, 18.911499631901577, 19.393549155754343, 19.151054499049977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16054632933497928, "mean_inference_ms": 0.7254186876142668, "mean_action_processing_ms": 0.10156406706784615, "mean_env_wait_ms": 0.8355698904108926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 661986, "timesteps_this_iter": 0, "agent_timesteps_total": 1985958, "timers": {"sample_time_ms": 20422.538, "sample_throughput": 469.775, "load_time_ms": 0.402, "load_throughput": 23844603.328, "learn_time_ms": 3083.517, "learn_throughput": 3111.382, "update_time_ms": 8.573}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.034970283508302e-08, "cur_lr": 0.0005, "total_loss": 5.6494951248168945, "policy_loss": -0.0011424682798604757, "vf_loss": 5.763387501239777, "vf_explained_var": -0.018332839012145996, "kl": 0.005315572896567915, "entropy": 11.27499783039093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 661986, "num_agent_steps_sampled": 1985958, "num_steps_trained": 661986, "num_agent_steps_trained": 1985958, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2995, "training_iteration": 69, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-07-11", "timestamp": 1706191631, "time_this_iter_s": 19.871020793914795, "time_total_s": 1432.2919840812683, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03552940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1432.2919840812683, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 9.364285714285714, "ram_util_percent": 47.535714285714285}}
{"episode_reward_max": 95.59985815733668, "episode_reward_min": 27.25254900008437, "episode_reward_mean": 62.857022113277345, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 9.001767459015042}, "policy_reward_max": {"shared_policy": 31.94747256177166}, "policy_reward_mean": {"shared_policy": 20.952340704425776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.269482036121175, 65.44197966158387, 71.09922790154812, 65.311487108469, 58.86211390420793, 51.287398079410195, 69.29119021259248, 63.03938199579714, 49.683235894888625, 83.2595986165106, 80.96168680209666, 77.12822899594903, 78.33773919939995, 62.39425336569545, 59.18699643388388, 49.48163698241113, 61.26237682253121, 61.58891859650609, 40.04425331205127, 56.79873603582382, 54.98706113453953, 53.265079143224256, 27.25254900008437, 51.596092954277964, 62.03750502644104, 57.23185734450814, 68.37252523750065, 39.69101552665231, 64.48742844164369, 54.04713059309867, 70.71897542476653, 95.59985815733668, 71.1566313644871, 40.68394892662761, 50.90784788876772, 77.00884928554294, 88.75574530661106, 60.78821801394221, 40.32256014645097, 51.72807680442929, 47.509270340204225, 46.70869346708058, 48.644760593771906, 63.050322238355875, 69.14572779834268, 61.65984731912613, 82.58298891037703, 45.16332277655599, 57.86745975539088, 70.92329981690273, 64.59829081967473, 66.67401911318301, 57.457720157690346, 78.91331227123736, 62.51758726127443, 64.59546944685277, 58.74915216118096, 60.87681045755744, 81.41375099122523, 77.17952875420451, 71.20149342995137, 61.226739374920726, 80.83524259552357, 67.32470773952082, 66.36493458412586, 56.587569899857016, 65.21323957666753, 57.4561032867059, 93.59673431515691, 33.80281183123587, 62.65327187255022, 88.02892359951508, 57.497528936713934, 67.65114063024521, 71.46038791909812, 59.92671986669302, 86.52091255970296, 44.84456631541252, 58.30538106523454, 91.70272754877806, 76.49184158071874, 58.54470492433754, 49.8797350991517, 72.80819763429463, 71.21706204861403, 64.44639051705597, 56.49366593174635, 44.6687206160277, 77.5226550614461, 73.59042693302032, 47.2812745195115, 77.36314482986926, 62.78644622676072, 50.35182454437016, 68.7056099772453, 55.227479070425034, 45.0363010619767, 85.71984265372156, 34.146703477948904, 61.61883554328233], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.62903441706051, 19.3187486877044, 19.321698931356266, 21.544234494368226, 21.96765387679139, 21.930091290424258, 23.76295796657601, 23.53758410612741, 23.798685828844697, 21.598530416687325, 21.837459062536553, 21.875497629245118, 19.396344562371567, 19.713766825695828, 19.752002516140536, 17.19852433912456, 17.222802717238665, 16.86607102304697, 22.76949829608202, 23.270970319397748, 23.250721597112715, 21.23292415340741, 21.027915244301155, 20.778542598088578, 16.511773771916822, 16.569822511946157, 16.601639611025647, 27.808839357147605, 27.669282662371785, 27.78147659699121, 26.972231540828943, 26.93568867817521, 27.05376658309251, 25.502259328961372, 25.956742491573095, 25.669227175414562, 26.130766563117504, 26.054926246404648, 26.152046389877796, 20.513147617379815, 20.816456543902547, 21.064649204413087, 19.81582140798369, 19.643480482200772, 19.727694543699414, 16.543322065224245, 16.64489271988471, 16.293422197302178, 20.44686399151881, 20.325753909846142, 20.489758921166256, 20.50943412880102, 20.616642283896596, 20.462842183808476, 13.440605179096252, 13.364654109502823, 13.238994023452193, 18.852674648165703, 18.85818513482809, 19.08787625283003, 18.626674391639725, 17.84855069716771, 18.511836045732096, 18.18765196708651, 17.773905190328747, 17.303521985809, 9.001767459015042, 9.19395615408817, 9.05682538698116, 17.05115797619024, 17.280278174827487, 17.264656803260237, 20.616473498443753, 21.05280306764567, 20.368228460351617, 18.5908458183209, 19.545837732652814, 19.09517379353443, 22.482378793259457, 23.00317221631606, 22.886974227925137, 13.285064476231724, 13.411437759796769, 12.994513290623814, 21.242989401022584, 21.592058890188724, 21.65238015043238, 18.255202520328254, 17.80143706748882, 17.990491005281598, 23.664265555640057, 23.44440421213706, 23.61030565698941, 31.94747256177166, 31.84819117250541, 31.804194423059613, 24.02993487225224, 23.499028724928692, 23.627667767306164, 13.185767794648797, 13.744020688037068, 13.754160443941743, 16.89960691705346, 17.068892993032932, 16.939347978681326, 25.733760910729558, 25.381849649051816, 25.893238725761563, 29.830332055687904, 29.971796303987503, 28.953616946935654, 19.845393563310296, 20.439503381649644, 20.503321068982274, 13.439032693083078, 13.396884916971118, 13.486642536396772, 17.28897863999009, 17.20000471919775, 17.23909344524145, 16.073739190896347, 15.773077232142285, 15.662453917165593, 15.478086223204926, 15.938037199278668, 15.292570044596985, 16.09379682938257, 16.385516266028077, 16.16544749836126, 21.101769104599953, 20.681058436632156, 21.267494697123766, 23.090471944461257, 23.120250872025878, 22.935004981855542, 20.59744570031762, 20.488210447132587, 20.57419117167592, 27.393368899822235, 27.674447529017925, 27.515172481536865, 15.319950001935155, 15.350444706777722, 14.49292806784311, 19.36949262022972, 19.502594616264105, 18.995372518897057, 23.744605131447315, 23.41964742541313, 23.75904726004228, 21.56547563523054, 21.472714453935623, 21.560100730508566, 22.10692685594161, 22.387710740168885, 22.179381517072514, 19.430206138640642, 18.60782042145729, 19.419693597592413, 26.38993479808171, 26.272780900200203, 26.250596572955445, 21.080148194606096, 20.628807025651128, 20.808632041017205, 21.65689128326872, 21.31710739682117, 21.621470766762883, 19.59943537910779, 19.465123017628983, 19.684593764444188, 20.110686793923378, 20.214214958250523, 20.55190870538354, 26.890415390332535, 27.201867913206414, 27.32146768768628, 25.453456342220306, 25.88445395231247, 25.841618459671736, 23.866279631853104, 24.157872068695724, 23.177341729402542, 20.365514911711216, 20.37804961949587, 20.48317484371364, 26.70397293070951, 27.049968058864266, 27.08130160594979, 22.5870293607004, 22.26764242351055, 22.470035955309868, 21.922681679328278, 22.132231400658682, 22.310021504138902, 18.86401830861965, 19.05333327750364, 18.670218313733727, 21.77013739695151, 21.83038269852598, 21.61271948119004, 18.911499631901577, 19.393549155754343, 19.151054499049977, 31.363206947843224, 31.35547525684038, 30.878052110473305, 11.156446372469262, 11.535969150563076, 11.110396308203534, 20.7915553698937, 21.11603309089938, 20.745683411757142, 29.20250132928291, 29.313836603114993, 29.51258566711718, 19.181568689644337, 18.932472497224808, 19.38348774984479, 22.35196414589882, 22.525051191449165, 22.774125292897224, 23.89969092731674, 23.99876407285531, 23.561932918926075, 20.141470685601234, 19.89954038709402, 19.885708793997765, 29.187239882225782, 28.17557183901468, 29.158100838462502, 14.341700360178947, 15.052958264946938, 15.449907690286636, 19.326999381184578, 19.630719048902392, 19.34766263514757, 29.646567225456238, 30.955735974013805, 31.100424349308014, 25.461661157508686, 25.463015859325722, 25.567164563884333, 19.699566973062844, 19.424021205554396, 19.421116745720298, 16.95099259602526, 16.587435285250336, 16.341307217876107, 24.28696770220995, 24.464848646894097, 24.056381285190582, 23.648300141096115, 23.6574839502573, 23.91127795726061, 21.366221589346722, 21.450078432758644, 21.630090494950608, 19.1006120921423, 18.739089665313557, 18.653964174290493, 14.651620027919606, 15.041082076107458, 14.976018512000635, 25.381380180517823, 25.99882998565832, 26.14244489526996, 24.63319720203677, 24.431414040426404, 24.525815690557152, 16.128173499950208, 15.806461401283741, 15.34663961827755, 25.570241150756672, 25.927279166256383, 25.8656245128562, 20.93047273779908, 20.86328291768828, 20.992690571273357, 16.57779498895009, 16.916638323416308, 16.857391232003764, 22.812046053508908, 23.017892519632966, 22.87567140410343, 18.505510970950127, 18.3314393684268, 18.390528731048107, 14.323393806815147, 15.319306181743741, 15.393601073417813, 28.73411500950654, 28.31421988209088, 28.671507762124136, 11.379626143723726, 11.479286767542362, 11.287790566682816, 20.48819762468338, 20.34808684885502, 20.78255106974393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16041731360643827, "mean_inference_ms": 0.7251969046497554, "mean_action_processing_ms": 0.10153595230634606, "mean_env_wait_ms": 0.835091236516335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 671580, "timesteps_this_iter": 0, "agent_timesteps_total": 2014740, "timers": {"sample_time_ms": 20302.589, "sample_throughput": 472.551, "load_time_ms": 0.402, "load_throughput": 23844603.328, "learn_time_ms": 3070.256, "learn_throughput": 3124.821, "update_time_ms": 8.623}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.034970283508302e-08, "cur_lr": 0.0005, "total_loss": 6.69943380355835, "policy_loss": -0.0005365030232652446, "vf_loss": 6.813066720962524, "vf_explained_var": -0.01629619300365448, "kl": 0.004768596540151085, "entropy": 11.309632897377014, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 671580, "num_agent_steps_sampled": 2014740, "num_steps_trained": 671580, "num_agent_steps_trained": 2014740, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3027, "training_iteration": 70, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-07-30", "timestamp": 1706191650, "time_this_iter_s": 19.267263889312744, "time_total_s": 1451.559247970581, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01626F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1451.559247970581, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 8.166666666666666, "ram_util_percent": 47.46666666666666}}
{"episode_reward_max": 94.31371692009269, "episode_reward_min": -0.017605289816856384, "episode_reward_mean": 62.92399917784263, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -0.2864803671836853}, "policy_reward_max": {"shared_policy": 31.756637907897428}, "policy_reward_mean": {"shared_policy": 20.974666392614207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.68394892662761, 50.90784788876772, 77.00884928554294, 88.75574530661106, 60.78821801394221, 40.32256014645097, 51.72807680442929, 47.509270340204225, 46.70869346708058, 48.644760593771906, 63.050322238355875, 69.14572779834268, 61.65984731912613, 82.58298891037703, 45.16332277655599, 57.86745975539088, 70.92329981690273, 64.59829081967473, 66.67401911318301, 57.457720157690346, 78.91331227123736, 62.51758726127443, 64.59546944685277, 58.74915216118096, 60.87681045755744, 81.41375099122523, 77.17952875420451, 71.20149342995137, 61.226739374920726, 80.83524259552357, 67.32470773952082, 66.36493458412586, 56.587569899857016, 65.21323957666753, 57.4561032867059, 93.59673431515691, 33.80281183123587, 62.65327187255022, 88.02892359951508, 57.497528936713934, 67.65114063024521, 71.46038791909812, 59.92671986669302, 86.52091255970296, 44.84456631541252, 58.30538106523454, 91.70272754877806, 76.49184158071874, 58.54470492433754, 49.8797350991517, 72.80819763429463, 71.21706204861403, 64.44639051705597, 56.49366593174635, 44.6687206160277, 77.5226550614461, 73.59042693302032, 47.2812745195115, 77.36314482986926, 62.78644622676072, 50.35182454437016, 68.7056099772453, 55.227479070425034, 45.0363010619767, 85.71984265372156, 34.146703477948904, 61.61883554328233, 44.64890771359204, 64.87157379463315, 79.01354991458355, 65.85415401309726, 72.81529163196683, 68.73221816215663, 59.38049650192259, 9.985621767118573, 49.11388755170627, 54.783242953941226, 79.33504473231733, 65.0226066401228, 77.06597860530019, 53.48835734464227, 68.9716670922935, 60.15011486876753, 92.3981998376548, 72.48610270395875, 56.989320874214144, 60.39541097357866, 68.39076896384358, 42.950844708830104, 80.1604525633156, 71.93120123818514, 41.94928449392317, 54.03895714133978, 66.18694564606993, 67.86549806594847, -0.017605289816856384, 69.88843846321105, 94.31371692009269, 66.52277800347653, 60.18830916658044], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.185767794648797, 13.744020688037068, 13.754160443941743, 16.89960691705346, 17.068892993032932, 16.939347978681326, 25.733760910729558, 25.381849649051816, 25.893238725761563, 29.830332055687904, 29.971796303987503, 28.953616946935654, 19.845393563310296, 20.439503381649644, 20.503321068982274, 13.439032693083078, 13.396884916971118, 13.486642536396772, 17.28897863999009, 17.20000471919775, 17.23909344524145, 16.073739190896347, 15.773077232142285, 15.662453917165593, 15.478086223204926, 15.938037199278668, 15.292570044596985, 16.09379682938257, 16.385516266028077, 16.16544749836126, 21.101769104599953, 20.681058436632156, 21.267494697123766, 23.090471944461257, 23.120250872025878, 22.935004981855542, 20.59744570031762, 20.488210447132587, 20.57419117167592, 27.393368899822235, 27.674447529017925, 27.515172481536865, 15.319950001935155, 15.350444706777722, 14.49292806784311, 19.36949262022972, 19.502594616264105, 18.995372518897057, 23.744605131447315, 23.41964742541313, 23.75904726004228, 21.56547563523054, 21.472714453935623, 21.560100730508566, 22.10692685594161, 22.387710740168885, 22.179381517072514, 19.430206138640642, 18.60782042145729, 19.419693597592413, 26.38993479808171, 26.272780900200203, 26.250596572955445, 21.080148194606096, 20.628807025651128, 20.808632041017205, 21.65689128326872, 21.31710739682117, 21.621470766762883, 19.59943537910779, 19.465123017628983, 19.684593764444188, 20.110686793923378, 20.214214958250523, 20.55190870538354, 26.890415390332535, 27.201867913206414, 27.32146768768628, 25.453456342220306, 25.88445395231247, 25.841618459671736, 23.866279631853104, 24.157872068695724, 23.177341729402542, 20.365514911711216, 20.37804961949587, 20.48317484371364, 26.70397293070951, 27.049968058864266, 27.08130160594979, 22.5870293607004, 22.26764242351055, 22.470035955309868, 21.922681679328278, 22.132231400658682, 22.310021504138902, 18.86401830861965, 19.05333327750364, 18.670218313733727, 21.77013739695151, 21.83038269852598, 21.61271948119004, 18.911499631901577, 19.393549155754343, 19.151054499049977, 31.363206947843224, 31.35547525684038, 30.878052110473305, 11.156446372469262, 11.535969150563076, 11.110396308203534, 20.7915553698937, 21.11603309089938, 20.745683411757142, 29.20250132928291, 29.313836603114993, 29.51258566711718, 19.181568689644337, 18.932472497224808, 19.38348774984479, 22.35196414589882, 22.525051191449165, 22.774125292897224, 23.89969092731674, 23.99876407285531, 23.561932918926075, 20.141470685601234, 19.89954038709402, 19.885708793997765, 29.187239882225782, 28.17557183901468, 29.158100838462502, 14.341700360178947, 15.052958264946938, 15.449907690286636, 19.326999381184578, 19.630719048902392, 19.34766263514757, 29.646567225456238, 30.955735974013805, 31.100424349308014, 25.461661157508686, 25.463015859325722, 25.567164563884333, 19.699566973062844, 19.424021205554396, 19.421116745720298, 16.95099259602526, 16.587435285250336, 16.341307217876107, 24.28696770220995, 24.464848646894097, 24.056381285190582, 23.648300141096115, 23.6574839502573, 23.91127795726061, 21.366221589346722, 21.450078432758644, 21.630090494950608, 19.1006120921423, 18.739089665313557, 18.653964174290493, 14.651620027919606, 15.041082076107458, 14.976018512000635, 25.381380180517823, 25.99882998565832, 26.14244489526996, 24.63319720203677, 24.431414040426404, 24.525815690557152, 16.128173499950208, 15.806461401283741, 15.34663961827755, 25.570241150756672, 25.927279166256383, 25.8656245128562, 20.93047273779908, 20.86328291768828, 20.992690571273357, 16.57779498895009, 16.916638323416308, 16.857391232003764, 22.812046053508908, 23.017892519632966, 22.87567140410343, 18.505510970950127, 18.3314393684268, 18.390528731048107, 14.323393806815147, 15.319306181743741, 15.393601073417813, 28.73411500950654, 28.31421988209088, 28.671507762124136, 11.379626143723726, 11.479286767542362, 11.287790566682816, 20.48819762468338, 20.34808684885502, 20.78255106974393, 14.813455556829766, 14.750509997208908, 15.084942159553364, 21.688215252012014, 21.48880122601986, 21.694557316601276, 26.51476005588968, 25.948161487778023, 26.550628370915845, 21.997456329564244, 22.149445230762154, 21.70725245277086, 24.245773054659367, 24.561244066804647, 24.008274510502815, 22.759856318434075, 22.827566375335053, 23.1447954683875, 19.996848461528614, 19.85456882168849, 19.52907921870549, 3.4495748672634363, 3.134165219962597, 3.40188167989254, 16.178654250999287, 16.344437827666596, 16.590795473040387, 18.03553492575884, 18.238376051187515, 18.509331976994872, 26.3572339117527, 26.75662857107818, 26.221182249486446, 21.762222649219126, 21.621915629754454, 21.638468361149222, 25.536780163645744, 25.77061788365245, 25.758580558001995, 17.437839572628334, 18.06418374118705, 17.98633403082688, 22.95330149680376, 23.28008796647191, 22.73827762901783, 19.76675924162069, 20.357205725895852, 20.02614990125099, 30.9751487361888, 30.70855167011419, 30.71449943135181, 24.385037053376436, 24.076588921248913, 24.0244767293334, 19.13295734177032, 19.045261847476155, 18.811101684967667, 20.142148040855915, 20.175446939344198, 20.07781599337855, 22.764222271740437, 22.699305661022663, 22.927241031080484, 14.252663248529032, 14.413924918820456, 14.284256541480616, 26.613893585900456, 26.674696060518414, 26.87186291689673, 23.688943187395722, 24.143607361863047, 24.09865068892637, 14.027242464323834, 13.810288486381367, 14.111753543217972, 17.95605206489563, 18.091435186564922, 17.991469889879227, 21.825672154625252, 22.01048533370097, 22.350788157743708, 22.553303496291235, 22.68824293588598, 22.623951633771256, -0.2864803671836853, 0.2019278034567833, 0.06694727391004562, 23.289363754292324, 23.520734903713063, 23.07833980520566, 31.756637907897428, 31.273996477325753, 31.283082534869507, 21.992072741190583, 22.259138523290545, 22.271566738995404, 20.050286702811718, 19.744678303599358, 20.393344160169363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16027329648667532, "mean_inference_ms": 0.7246261160256691, "mean_action_processing_ms": 0.10155230773039285, "mean_env_wait_ms": 0.8343015213567639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 681174, "timesteps_this_iter": 0, "agent_timesteps_total": 2043522, "timers": {"sample_time_ms": 20116.168, "sample_throughput": 476.93, "load_time_ms": 0.401, "load_throughput": 23908355.164, "learn_time_ms": 3066.279, "learn_throughput": 3128.873, "update_time_ms": 8.564}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.017485141754151e-08, "cur_lr": 0.0005, "total_loss": 6.374031245708466, "policy_loss": 0.001714037783745903, "vf_loss": 6.486704230308533, "vf_explained_var": -0.034335315227508545, "kl": 0.0076055430982448075, "entropy": 11.438671469688416, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 681174, "num_agent_steps_sampled": 2043522, "num_steps_trained": 681174, "num_agent_steps_trained": 2043522, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3060, "training_iteration": 71, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-07-50", "timestamp": 1706191670, "time_this_iter_s": 19.2993803024292, "time_total_s": 1470.8586282730103, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B7B940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1470.8586282730103, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.12142857142857, "ram_util_percent": 47.53928571428572}}
{"episode_reward_max": 95.17313613562143, "episode_reward_min": -0.017605289816856384, "episode_reward_mean": 61.56342009621847, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -0.2864803671836853}, "policy_reward_max": {"shared_policy": 31.816294568338577}, "policy_reward_mean": {"shared_policy": 20.521140032072818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.32470773952082, 66.36493458412586, 56.587569899857016, 65.21323957666753, 57.4561032867059, 93.59673431515691, 33.80281183123587, 62.65327187255022, 88.02892359951508, 57.497528936713934, 67.65114063024521, 71.46038791909812, 59.92671986669302, 86.52091255970296, 44.84456631541252, 58.30538106523454, 91.70272754877806, 76.49184158071874, 58.54470492433754, 49.8797350991517, 72.80819763429463, 71.21706204861403, 64.44639051705597, 56.49366593174635, 44.6687206160277, 77.5226550614461, 73.59042693302032, 47.2812745195115, 77.36314482986926, 62.78644622676072, 50.35182454437016, 68.7056099772453, 55.227479070425034, 45.0363010619767, 85.71984265372156, 34.146703477948904, 61.61883554328233, 44.64890771359204, 64.87157379463315, 79.01354991458355, 65.85415401309726, 72.81529163196683, 68.73221816215663, 59.38049650192259, 9.985621767118573, 49.11388755170627, 54.783242953941226, 79.33504473231733, 65.0226066401228, 77.06597860530019, 53.48835734464227, 68.9716670922935, 60.15011486876753, 92.3981998376548, 72.48610270395875, 56.989320874214144, 60.39541097357866, 68.39076896384358, 42.950844708830104, 80.1604525633156, 71.93120123818514, 41.94928449392317, 54.03895714133978, 66.18694564606993, 67.86549806594847, -0.017605289816856384, 69.88843846321105, 94.31371692009269, 66.52277800347653, 60.18830916658044, 49.66128181666133, 53.15501564089209, 48.54344698856582, 45.16672736033797, 56.990432254970045, 46.30958348792046, 46.98605282977222, 73.4853846617043, 73.52231713989747, 42.823738902807236, 48.27129197120665, 52.52477090433237, 66.36122372373936, 91.1784135252237, 56.10602470487356, 62.31746457144615, 62.800553387030945, 70.32108996249735, 46.16874894127247, 95.17313613562143, 13.698029791004956, 59.862409688532324, 48.87618680857119, 73.99151487275958, 61.4615334793925, 70.66616632975636, 65.13030378799884, 59.64572100713846, 56.67099351063369, 55.76258987397884], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.5870293607004, 22.26764242351055, 22.470035955309868, 21.922681679328278, 22.132231400658682, 22.310021504138902, 18.86401830861965, 19.05333327750364, 18.670218313733727, 21.77013739695151, 21.83038269852598, 21.61271948119004, 18.911499631901577, 19.393549155754343, 19.151054499049977, 31.363206947843224, 31.35547525684038, 30.878052110473305, 11.156446372469262, 11.535969150563076, 11.110396308203534, 20.7915553698937, 21.11603309089938, 20.745683411757142, 29.20250132928291, 29.313836603114993, 29.51258566711718, 19.181568689644337, 18.932472497224808, 19.38348774984479, 22.35196414589882, 22.525051191449165, 22.774125292897224, 23.89969092731674, 23.99876407285531, 23.561932918926075, 20.141470685601234, 19.89954038709402, 19.885708793997765, 29.187239882225782, 28.17557183901468, 29.158100838462502, 14.341700360178947, 15.052958264946938, 15.449907690286636, 19.326999381184578, 19.630719048902392, 19.34766263514757, 29.646567225456238, 30.955735974013805, 31.100424349308014, 25.461661157508686, 25.463015859325722, 25.567164563884333, 19.699566973062844, 19.424021205554396, 19.421116745720298, 16.95099259602526, 16.587435285250336, 16.341307217876107, 24.28696770220995, 24.464848646894097, 24.056381285190582, 23.648300141096115, 23.6574839502573, 23.91127795726061, 21.366221589346722, 21.450078432758644, 21.630090494950608, 19.1006120921423, 18.739089665313557, 18.653964174290493, 14.651620027919606, 15.041082076107458, 14.976018512000635, 25.381380180517823, 25.99882998565832, 26.14244489526996, 24.63319720203677, 24.431414040426404, 24.525815690557152, 16.128173499950208, 15.806461401283741, 15.34663961827755, 25.570241150756672, 25.927279166256383, 25.8656245128562, 20.93047273779908, 20.86328291768828, 20.992690571273357, 16.57779498895009, 16.916638323416308, 16.857391232003764, 22.812046053508908, 23.017892519632966, 22.87567140410343, 18.505510970950127, 18.3314393684268, 18.390528731048107, 14.323393806815147, 15.319306181743741, 15.393601073417813, 28.73411500950654, 28.31421988209088, 28.671507762124136, 11.379626143723726, 11.479286767542362, 11.287790566682816, 20.48819762468338, 20.34808684885502, 20.78255106974393, 14.813455556829766, 14.750509997208908, 15.084942159553364, 21.688215252012014, 21.48880122601986, 21.694557316601276, 26.51476005588968, 25.948161487778023, 26.550628370915845, 21.997456329564244, 22.149445230762154, 21.70725245277086, 24.245773054659367, 24.561244066804647, 24.008274510502815, 22.759856318434075, 22.827566375335053, 23.1447954683875, 19.996848461528614, 19.85456882168849, 19.52907921870549, 3.4495748672634363, 3.134165219962597, 3.40188167989254, 16.178654250999287, 16.344437827666596, 16.590795473040387, 18.03553492575884, 18.238376051187515, 18.509331976994872, 26.3572339117527, 26.75662857107818, 26.221182249486446, 21.762222649219126, 21.621915629754454, 21.638468361149222, 25.536780163645744, 25.77061788365245, 25.758580558001995, 17.437839572628334, 18.06418374118705, 17.98633403082688, 22.95330149680376, 23.28008796647191, 22.73827762901783, 19.76675924162069, 20.357205725895852, 20.02614990125099, 30.9751487361888, 30.70855167011419, 30.71449943135181, 24.385037053376436, 24.076588921248913, 24.0244767293334, 19.13295734177032, 19.045261847476155, 18.811101684967667, 20.142148040855915, 20.175446939344198, 20.07781599337855, 22.764222271740437, 22.699305661022663, 22.927241031080484, 14.252663248529032, 14.413924918820456, 14.284256541480616, 26.613893585900456, 26.674696060518414, 26.87186291689673, 23.688943187395722, 24.143607361863047, 24.09865068892637, 14.027242464323834, 13.810288486381367, 14.111753543217972, 17.95605206489563, 18.091435186564922, 17.991469889879227, 21.825672154625252, 22.01048533370097, 22.350788157743708, 22.553303496291235, 22.68824293588598, 22.623951633771256, -0.2864803671836853, 0.2019278034567833, 0.06694727391004562, 23.289363754292324, 23.520734903713063, 23.07833980520566, 31.756637907897428, 31.273996477325753, 31.283082534869507, 21.992072741190583, 22.259138523290545, 22.271566738995404, 20.050286702811718, 19.744678303599358, 20.393344160169363, 16.60619209210077, 16.08145440618196, 16.973635318378598, 17.748519003391266, 17.948766306973994, 17.45773033052683, 16.434561669283227, 16.162966950486094, 15.945918368796498, 15.07160970941186, 15.194726809859276, 14.900390841066837, 18.930932494501263, 19.03749621162811, 19.022003548840672, 15.47660315502435, 15.48270738311112, 15.350272949784994, 15.040919174750641, 16.015515392025307, 15.929618262996271, 24.32537265866995, 24.515091188251972, 24.64492081478238, 24.586808015747607, 24.497196583698184, 24.438312540451676, 14.528716392815113, 14.117613174021244, 14.177409335970879, 16.047514629860714, 16.12955431391795, 16.094223027427986, 17.77029942596951, 17.393590005735547, 17.360881472627312, 22.43817703301707, 22.3445271278421, 21.57851956288019, 30.53554758677879, 30.413079152504594, 30.22978678594032, 18.536716669797897, 19.112827710807323, 18.45648032426834, 20.845571401218564, 20.500256958107144, 20.971636212120444, 21.13046551806231, 20.977570710082844, 20.692517158885792, 23.1460822224617, 23.33700007200241, 23.838007668033242, 15.495805895576865, 15.338181095818669, 15.334761949876935, 31.59786857540408, 31.816294568338577, 31.758972991878778, 4.520381815731525, 4.642928727902472, 4.534719247370958, 20.063448737064988, 19.75315701464811, 20.045803936819226, 16.222877385715634, 16.506140888358146, 16.14716853449741, 24.58566814661026, 24.48930438607931, 24.91654234007001, 20.83257685850063, 20.377876753608376, 20.251079867283494, 23.309809540708855, 23.504207519193486, 23.852149269854024, 21.928191811156765, 21.75792820503314, 21.444183771808937, 20.154613165805728, 19.559304902950913, 19.93180293838182, 18.728453529377774, 18.888294541587427, 19.05424543966849, 18.780853706334398, 18.72227690058449, 18.259459267059952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16006605949878502, "mean_inference_ms": 0.7240944870470016, "mean_action_processing_ms": 0.10149063220670612, "mean_env_wait_ms": 0.833616965873601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 690768, "timesteps_this_iter": 0, "agent_timesteps_total": 2072304, "timers": {"sample_time_ms": 20075.662, "sample_throughput": 477.892, "load_time_ms": 0.4, "load_throughput": 23978162.66, "learn_time_ms": 3055.013, "learn_throughput": 3140.412, "update_time_ms": 8.614}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.017485141754151e-08, "cur_lr": 0.0005, "total_loss": 6.081348419189453, "policy_loss": -4.755826826086107e-05, "vf_loss": 6.1973488330841064, "vf_explained_var": 0.029917292296886444, "kl": 0.004921987681950348, "entropy": 11.595258712768555, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 690768, "num_agent_steps_sampled": 2072304, "num_steps_trained": 690768, "num_agent_steps_trained": 2072304, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3090, "training_iteration": 72, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-08-10", "timestamp": 1706191690, "time_this_iter_s": 19.815803050994873, "time_total_s": 1490.6744313240051, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017AFC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1490.6744313240051, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 8.900000000000002, "ram_util_percent": 47.86428571428571}}
{"episode_reward_max": 95.17313613562143, "episode_reward_min": -8.63412728230469, "episode_reward_mean": 60.220958814429174, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -3.02323754504323}, "policy_reward_max": {"shared_policy": 31.816294568338577}, "policy_reward_mean": {"shared_policy": 20.073652938143052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.71984265372156, 34.146703477948904, 61.61883554328233, 44.64890771359204, 64.87157379463315, 79.01354991458355, 65.85415401309726, 72.81529163196683, 68.73221816215663, 59.38049650192259, 9.985621767118573, 49.11388755170627, 54.783242953941226, 79.33504473231733, 65.0226066401228, 77.06597860530019, 53.48835734464227, 68.9716670922935, 60.15011486876753, 92.3981998376548, 72.48610270395875, 56.989320874214144, 60.39541097357866, 68.39076896384358, 42.950844708830104, 80.1604525633156, 71.93120123818514, 41.94928449392317, 54.03895714133978, 66.18694564606993, 67.86549806594847, -0.017605289816856384, 69.88843846321105, 94.31371692009269, 66.52277800347653, 60.18830916658044, 49.66128181666133, 53.15501564089209, 48.54344698856582, 45.16672736033797, 56.990432254970045, 46.30958348792046, 46.98605282977222, 73.4853846617043, 73.52231713989747, 42.823738902807236, 48.27129197120665, 52.52477090433237, 66.36122372373936, 91.1784135252237, 56.10602470487356, 62.31746457144615, 62.800553387030945, 70.32108996249735, 46.16874894127247, 95.17313613562143, 13.698029791004956, 59.862409688532324, 48.87618680857119, 73.99151487275958, 61.4615334793925, 70.66616632975636, 65.13030378799884, 59.64572100713846, 56.67099351063369, 55.76258987397884, 69.17015796247867, 67.76320352777837, 68.06330205500124, 51.06183413416147, 68.61410258337855, 74.19173229299486, 59.07241462543607, 78.94933598861098, 55.11630280688405, 47.404673286713646, 58.613194577395916, 77.70498789288101, 67.01664370670915, 42.344263830484124, 61.18104882538317, 61.72616675123572, 89.45254606357773, 55.67467420594765, 73.86618978530166, 54.80245124176143, 68.40575122646986, 82.62525014020503, 58.38500479143113, 86.98489589244126, 71.26186875998972, 14.360638130456195, 70.26752518257123, 69.29790331819095, 46.19187707826495, -8.63412728230469, 48.21005934040295, 47.571641496848315, 63.028081989847124, 47.36141773592681], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.73411500950654, 28.31421988209088, 28.671507762124136, 11.379626143723726, 11.479286767542362, 11.287790566682816, 20.48819762468338, 20.34808684885502, 20.78255106974393, 14.813455556829766, 14.750509997208908, 15.084942159553364, 21.688215252012014, 21.48880122601986, 21.694557316601276, 26.51476005588968, 25.948161487778023, 26.550628370915845, 21.997456329564244, 22.149445230762154, 21.70725245277086, 24.245773054659367, 24.561244066804647, 24.008274510502815, 22.759856318434075, 22.827566375335053, 23.1447954683875, 19.996848461528614, 19.85456882168849, 19.52907921870549, 3.4495748672634363, 3.134165219962597, 3.40188167989254, 16.178654250999287, 16.344437827666596, 16.590795473040387, 18.03553492575884, 18.238376051187515, 18.509331976994872, 26.3572339117527, 26.75662857107818, 26.221182249486446, 21.762222649219126, 21.621915629754454, 21.638468361149222, 25.536780163645744, 25.77061788365245, 25.758580558001995, 17.437839572628334, 18.06418374118705, 17.98633403082688, 22.95330149680376, 23.28008796647191, 22.73827762901783, 19.76675924162069, 20.357205725895852, 20.02614990125099, 30.9751487361888, 30.70855167011419, 30.71449943135181, 24.385037053376436, 24.076588921248913, 24.0244767293334, 19.13295734177032, 19.045261847476155, 18.811101684967667, 20.142148040855915, 20.175446939344198, 20.07781599337855, 22.764222271740437, 22.699305661022663, 22.927241031080484, 14.252663248529032, 14.413924918820456, 14.284256541480616, 26.613893585900456, 26.674696060518414, 26.87186291689673, 23.688943187395722, 24.143607361863047, 24.09865068892637, 14.027242464323834, 13.810288486381367, 14.111753543217972, 17.95605206489563, 18.091435186564922, 17.991469889879227, 21.825672154625252, 22.01048533370097, 22.350788157743708, 22.553303496291235, 22.68824293588598, 22.623951633771256, -0.2864803671836853, 0.2019278034567833, 0.06694727391004562, 23.289363754292324, 23.520734903713063, 23.07833980520566, 31.756637907897428, 31.273996477325753, 31.283082534869507, 21.992072741190583, 22.259138523290545, 22.271566738995404, 20.050286702811718, 19.744678303599358, 20.393344160169363, 16.60619209210077, 16.08145440618196, 16.973635318378598, 17.748519003391266, 17.948766306973994, 17.45773033052683, 16.434561669283227, 16.162966950486094, 15.945918368796498, 15.07160970941186, 15.194726809859276, 14.900390841066837, 18.930932494501263, 19.03749621162811, 19.022003548840672, 15.47660315502435, 15.48270738311112, 15.350272949784994, 15.040919174750641, 16.015515392025307, 15.929618262996271, 24.32537265866995, 24.515091188251972, 24.64492081478238, 24.586808015747607, 24.497196583698184, 24.438312540451676, 14.528716392815113, 14.117613174021244, 14.177409335970879, 16.047514629860714, 16.12955431391795, 16.094223027427986, 17.77029942596951, 17.393590005735547, 17.360881472627312, 22.43817703301707, 22.3445271278421, 21.57851956288019, 30.53554758677879, 30.413079152504594, 30.22978678594032, 18.536716669797897, 19.112827710807323, 18.45648032426834, 20.845571401218564, 20.500256958107144, 20.971636212120444, 21.13046551806231, 20.977570710082844, 20.692517158885792, 23.1460822224617, 23.33700007200241, 23.838007668033242, 15.495805895576865, 15.338181095818669, 15.334761949876935, 31.59786857540408, 31.816294568338577, 31.758972991878778, 4.520381815731525, 4.642928727902472, 4.534719247370958, 20.063448737064988, 19.75315701464811, 20.045803936819226, 16.222877385715634, 16.506140888358146, 16.14716853449741, 24.58566814661026, 24.48930438607931, 24.91654234007001, 20.83257685850063, 20.377876753608376, 20.251079867283494, 23.309809540708855, 23.504207519193486, 23.852149269854024, 21.928191811156765, 21.75792820503314, 21.444183771808937, 20.154613165805728, 19.559304902950913, 19.93180293838182, 18.728453529377774, 18.888294541587427, 19.05424543966849, 18.780853706334398, 18.72227690058449, 18.259459267059952, 23.294366631346435, 23.289329717556626, 22.586461613575608, 22.331064385672406, 22.75941890229781, 22.672720239808157, 22.95945734282334, 22.533742045362786, 22.570102666815117, 17.138078305870295, 16.79621946066618, 17.127536367624998, 23.36071813479066, 22.16622680425644, 23.087157644331455, 24.66091548651457, 24.845357002690434, 24.685459803789854, 19.67263163626194, 19.711565390229225, 19.688217598944902, 26.519767731428146, 26.076809592545033, 26.352758664637804, 18.164026528596878, 18.673327933996916, 18.278948344290257, 15.660295156141117, 15.667377342780426, 16.0770007877921, 19.162973046302795, 19.86048535630107, 19.58973617479205, 25.80187769110003, 25.947124897191912, 25.955985304589063, 22.675331387668848, 22.213504746556282, 22.127807572484016, 13.089114218950272, 14.435502268373966, 14.819647343159886, 20.192519811292485, 20.523624954124287, 20.4649040599664, 20.826750800013542, 21.30102128908038, 19.5983946621418, 29.864929468759016, 29.774591124306113, 29.8130254705126, 17.829267432292298, 18.84772553419073, 18.997681239464626, 24.40053933362165, 24.74333399037519, 24.722316461304814, 18.308360656102494, 18.125237864752606, 18.368852720906332, 22.922641692062214, 22.90724774015446, 22.575861794253186, 27.741274245083332, 27.183328427374363, 27.70064746774733, 19.127764001488686, 19.39386286586523, 19.863377924077213, 29.008781244357422, 28.986784150203064, 28.989330497880772, 23.792765234907463, 24.119165261586502, 23.34993826349576, 4.798009612907961, 4.84060327832897, 4.722025239219263, 23.069324965278298, 23.627375591701508, 23.570824625591428, 22.852463111281395, 23.232247289502993, 23.21319291740656, 15.351009607315063, 15.424352582544088, 15.4165148884058, -2.859497746452689, -2.75139199080877, -3.02323754504323, 16.375177532725502, 16.324246774427593, 15.510635033249855, 15.458193019032478, 16.208865023683757, 15.90458345413208, 21.124227836728096, 21.495189539156854, 20.408664613962173, 15.78789996355772, 16.18725040834397, 15.386267364025116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1599155311296666, "mean_inference_ms": 0.7232442133872479, "mean_action_processing_ms": 0.10146429960870121, "mean_env_wait_ms": 0.832710874264626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 700362, "timesteps_this_iter": 0, "agent_timesteps_total": 2101086, "timers": {"sample_time_ms": 19921.903, "sample_throughput": 481.58, "load_time_ms": 0.501, "load_throughput": 19156504.13, "learn_time_ms": 3001.231, "learn_throughput": 3196.688, "update_time_ms": 8.552}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 6.810893356800079, "policy_loss": -0.00010460964167546827, "vf_loss": 6.926856875419617, "vf_explained_var": 0.08669731765985489, "kl": 0.007124317111518329, "entropy": 11.585879683494568, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700362, "num_agent_steps_sampled": 2101086, "num_steps_trained": 700362, "num_agent_steps_trained": 2101086, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3124, "training_iteration": 73, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-08-28", "timestamp": 1706191708, "time_this_iter_s": 18.619470834732056, "time_total_s": 1509.2939021587372, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017AF1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1509.2939021587372, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 6.153846153846152, "ram_util_percent": 47.6923076923077}}
{"episode_reward_max": 95.17313613562143, "episode_reward_min": -260.5923414081335, "episode_reward_mean": 54.990273620929514, "episode_len_mean": 298.01, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -90.31889847914378}, "policy_reward_max": {"shared_policy": 31.816294568338577}, "policy_reward_mean": {"shared_policy": 18.330091206976498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.86549806594847, -0.017605289816856384, 69.88843846321105, 94.31371692009269, 66.52277800347653, 60.18830916658044, 49.66128181666133, 53.15501564089209, 48.54344698856582, 45.16672736033797, 56.990432254970045, 46.30958348792046, 46.98605282977222, 73.4853846617043, 73.52231713989747, 42.823738902807236, 48.27129197120665, 52.52477090433237, 66.36122372373936, 91.1784135252237, 56.10602470487356, 62.31746457144615, 62.800553387030945, 70.32108996249735, 46.16874894127247, 95.17313613562143, 13.698029791004956, 59.862409688532324, 48.87618680857119, 73.99151487275958, 61.4615334793925, 70.66616632975636, 65.13030378799884, 59.64572100713846, 56.67099351063369, 55.76258987397884, 69.17015796247867, 67.76320352777837, 68.06330205500124, 51.06183413416147, 68.61410258337855, 74.19173229299486, 59.07241462543607, 78.94933598861098, 55.11630280688405, 47.404673286713646, 58.613194577395916, 77.70498789288101, 67.01664370670915, 42.344263830484124, 61.18104882538317, 61.72616675123572, 89.45254606357773, 55.67467420594765, 73.86618978530166, 54.80245124176143, 68.40575122646986, 82.62525014020503, 58.38500479143113, 86.98489589244126, 71.26186875998972, 14.360638130456195, 70.26752518257123, 69.29790331819095, 46.19187707826495, -8.63412728230469, 48.21005934040295, 47.571641496848315, 63.028081989847124, 47.36141773592681, 47.226601921021924, 64.64599424414335, 9.722877090796814, 55.86294138059017, 26.36501132464035, 40.68531525507569, 71.98059554211795, 38.6037008501589, 68.45489092357454, 62.261554416269036, 76.1386765092611, 74.74134879559276, 55.30009123310445, 34.43990383297202, 72.42944836616515, 60.02098968782228, 21.138790676370263, 71.35964837297797, 77.17357750050724, 53.72331606177613, 59.9816205203533, 27.576988853514194, 61.1416855305433, 54.2099579181522, 38.73622843623161, 69.08326786383985, 84.76236709579824, 41.83991204202174, 80.51210392080247, -260.5923414081335], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 101], "policy_shared_policy_reward": [22.553303496291235, 22.68824293588598, 22.623951633771256, -0.2864803671836853, 0.2019278034567833, 0.06694727391004562, 23.289363754292324, 23.520734903713063, 23.07833980520566, 31.756637907897428, 31.273996477325753, 31.283082534869507, 21.992072741190583, 22.259138523290545, 22.271566738995404, 20.050286702811718, 19.744678303599358, 20.393344160169363, 16.60619209210077, 16.08145440618196, 16.973635318378598, 17.748519003391266, 17.948766306973994, 17.45773033052683, 16.434561669283227, 16.162966950486094, 15.945918368796498, 15.07160970941186, 15.194726809859276, 14.900390841066837, 18.930932494501263, 19.03749621162811, 19.022003548840672, 15.47660315502435, 15.48270738311112, 15.350272949784994, 15.040919174750641, 16.015515392025307, 15.929618262996271, 24.32537265866995, 24.515091188251972, 24.64492081478238, 24.586808015747607, 24.497196583698184, 24.438312540451676, 14.528716392815113, 14.117613174021244, 14.177409335970879, 16.047514629860714, 16.12955431391795, 16.094223027427986, 17.77029942596951, 17.393590005735547, 17.360881472627312, 22.43817703301707, 22.3445271278421, 21.57851956288019, 30.53554758677879, 30.413079152504594, 30.22978678594032, 18.536716669797897, 19.112827710807323, 18.45648032426834, 20.845571401218564, 20.500256958107144, 20.971636212120444, 21.13046551806231, 20.977570710082844, 20.692517158885792, 23.1460822224617, 23.33700007200241, 23.838007668033242, 15.495805895576865, 15.338181095818669, 15.334761949876935, 31.59786857540408, 31.816294568338577, 31.758972991878778, 4.520381815731525, 4.642928727902472, 4.534719247370958, 20.063448737064988, 19.75315701464811, 20.045803936819226, 16.222877385715634, 16.506140888358146, 16.14716853449741, 24.58566814661026, 24.48930438607931, 24.91654234007001, 20.83257685850063, 20.377876753608376, 20.251079867283494, 23.309809540708855, 23.504207519193486, 23.852149269854024, 21.928191811156765, 21.75792820503314, 21.444183771808937, 20.154613165805728, 19.559304902950913, 19.93180293838182, 18.728453529377774, 18.888294541587427, 19.05424543966849, 18.780853706334398, 18.72227690058449, 18.259459267059952, 23.294366631346435, 23.289329717556626, 22.586461613575608, 22.331064385672406, 22.75941890229781, 22.672720239808157, 22.95945734282334, 22.533742045362786, 22.570102666815117, 17.138078305870295, 16.79621946066618, 17.127536367624998, 23.36071813479066, 22.16622680425644, 23.087157644331455, 24.66091548651457, 24.845357002690434, 24.685459803789854, 19.67263163626194, 19.711565390229225, 19.688217598944902, 26.519767731428146, 26.076809592545033, 26.352758664637804, 18.164026528596878, 18.673327933996916, 18.278948344290257, 15.660295156141117, 15.667377342780426, 16.0770007877921, 19.162973046302795, 19.86048535630107, 19.58973617479205, 25.80187769110003, 25.947124897191912, 25.955985304589063, 22.675331387668848, 22.213504746556282, 22.127807572484016, 13.089114218950272, 14.435502268373966, 14.819647343159886, 20.192519811292485, 20.523624954124287, 20.4649040599664, 20.826750800013542, 21.30102128908038, 19.5983946621418, 29.864929468759016, 29.774591124306113, 29.8130254705126, 17.829267432292298, 18.84772553419073, 18.997681239464626, 24.40053933362165, 24.74333399037519, 24.722316461304814, 18.308360656102494, 18.125237864752606, 18.368852720906332, 22.922641692062214, 22.90724774015446, 22.575861794253186, 27.741274245083332, 27.183328427374363, 27.70064746774733, 19.127764001488686, 19.39386286586523, 19.863377924077213, 29.008781244357422, 28.986784150203064, 28.989330497880772, 23.792765234907463, 24.119165261586502, 23.34993826349576, 4.798009612907961, 4.84060327832897, 4.722025239219263, 23.069324965278298, 23.627375591701508, 23.570824625591428, 22.852463111281395, 23.232247289502993, 23.21319291740656, 15.351009607315063, 15.424352582544088, 15.4165148884058, -2.859497746452689, -2.75139199080877, -3.02323754504323, 16.375177532725502, 16.324246774427593, 15.510635033249855, 15.458193019032478, 16.208865023683757, 15.90458345413208, 21.124227836728096, 21.495189539156854, 20.408664613962173, 15.78789996355772, 16.18725040834397, 15.386267364025116, 15.823368755479649, 15.9347354521354, 15.468497713406876, 21.31013224025567, 21.912925924484924, 21.42293607940276, 2.990808521707848, 3.4642896497001203, 3.267778919388846, 18.112146268288285, 18.96946373457709, 18.781331377724797, 8.674962294598416, 9.188777240769312, 8.501271789272622, 13.658229246735573, 13.642503287643194, 13.384582720696926, 23.86200550943613, 23.84004507213831, 24.278544960543513, 12.585072139898926, 13.02902942026654, 12.989599289993436, 22.893487103904278, 22.762296768526227, 22.799107051144034, 20.62759968886772, 20.681569720307976, 20.95238500709334, 25.45352882767716, 25.298476396749408, 25.386671284834534, 24.780852193633706, 25.12868746618429, 24.831809135774762, 18.64105888580282, 18.378304344912365, 18.280728002389267, 11.682605581978947, 11.581576789418847, 11.175721461574227, 24.457190198202923, 23.931163524587944, 24.04109464337428, 20.16075219495299, 19.886003290613488, 19.9742342022558, 7.040517047047615, 7.045012317597866, 7.053261311724782, 23.726535353809595, 23.666531078517437, 23.96658194065094, 25.692088529467583, 25.85460833273828, 25.626880638301373, 17.889222227036953, 18.25417713401839, 17.579916700720787, 19.92539906998475, 20.23789184292157, 19.818329607446984, 9.255651816725731, 9.11462052166462, 9.206716515123844, 20.28242956350246, 20.339528801540524, 20.519727165500314, 18.147174437840775, 17.752238680919007, 18.310544799392417, 13.047210678458214, 12.718372598290443, 12.970645159482956, 23.01905697335799, 22.90228484322627, 23.16192604725559, 28.18367179234822, 28.22907384236653, 28.349621461083487, 14.076551121970013, 13.801935126384095, 13.96142579366763, 26.799786776304245, 26.535341382026672, 27.176975762471557, -90.31889847914378, -84.75872843960921, -85.51471448938052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15968151727071644, "mean_inference_ms": 0.7227422465924391, "mean_action_processing_ms": 0.1014194548732497, "mean_env_wait_ms": 0.8321278030203034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 709956, "timesteps_this_iter": 0, "agent_timesteps_total": 2129868, "timers": {"sample_time_ms": 19913.402, "sample_throughput": 481.786, "load_time_ms": 0.501, "load_throughput": 19156504.13, "learn_time_ms": 2999.054, "learn_throughput": 3199.009, "update_time_ms": 8.552}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 49.54966115951538, "policy_loss": 0.0015335069075695928, "vf_loss": 49.66408967971802, "vf_explained_var": 0.012732096016407013, "kl": 0.014609636156888938, "entropy": 11.596259117126465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 709956, "num_agent_steps_sampled": 2129868, "num_steps_trained": 709956, "num_agent_steps_trained": 2129868, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3154, "training_iteration": 74, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-08-48", "timestamp": 1706191728, "time_this_iter_s": 19.71444845199585, "time_total_s": 1529.008350610733, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B0BD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1529.008350610733, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 7.757142857142858, "ram_util_percent": 48.25}}
{"episode_reward_max": 97.76091218180952, "episode_reward_min": -260.5923414081335, "episode_reward_mean": 55.83845999163139, "episode_len_mean": 298.01, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -90.31889847914378}, "policy_reward_max": {"shared_policy": 32.78773546280959}, "policy_reward_mean": {"shared_policy": 18.612819997210458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.67099351063369, 55.76258987397884, 69.17015796247867, 67.76320352777837, 68.06330205500124, 51.06183413416147, 68.61410258337855, 74.19173229299486, 59.07241462543607, 78.94933598861098, 55.11630280688405, 47.404673286713646, 58.613194577395916, 77.70498789288101, 67.01664370670915, 42.344263830484124, 61.18104882538317, 61.72616675123572, 89.45254606357773, 55.67467420594765, 73.86618978530166, 54.80245124176143, 68.40575122646986, 82.62525014020503, 58.38500479143113, 86.98489589244126, 71.26186875998972, 14.360638130456195, 70.26752518257123, 69.29790331819095, 46.19187707826495, -8.63412728230469, 48.21005934040295, 47.571641496848315, 63.028081989847124, 47.36141773592681, 47.226601921021924, 64.64599424414335, 9.722877090796814, 55.86294138059017, 26.36501132464035, 40.68531525507569, 71.98059554211795, 38.6037008501589, 68.45489092357454, 62.261554416269036, 76.1386765092611, 74.74134879559276, 55.30009123310445, 34.43990383297202, 72.42944836616515, 60.02098968782228, 21.138790676370263, 71.35964837297797, 77.17357750050724, 53.72331606177613, 59.9816205203533, 27.576988853514194, 61.1416855305433, 54.2099579181522, 38.73622843623161, 69.08326786383985, 84.76236709579824, 41.83991204202174, 80.51210392080247, -260.5923414081335, 64.07760993391275, 60.35468761250377, 47.52737691253421, 45.58006338775158, 65.10604395437984, 92.13327162805945, 24.26242103800176, 62.18186829867771, 71.57205697707829, 82.19239101186392, 35.87547743320464, 63.047157999128075, 56.018564097583294, 55.22945828735827, 64.05700288992375, 44.23265877459198, 71.72408817801623, 38.08985262364146, 72.48155048582703, 68.80152682587503, 49.55813173390922, 89.40679619088766, 58.10391188785434, 30.144256599247427, 48.86957581155002, 63.28522391524163, 70.0031881481409, 69.31567503139377, 87.45884522050618, 56.52805193886161, 97.76091218180952, 60.98144871322435, 82.69178605079651, 36.12540530227125], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 101, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.728453529377774, 18.888294541587427, 19.05424543966849, 18.780853706334398, 18.72227690058449, 18.259459267059952, 23.294366631346435, 23.289329717556626, 22.586461613575608, 22.331064385672406, 22.75941890229781, 22.672720239808157, 22.95945734282334, 22.533742045362786, 22.570102666815117, 17.138078305870295, 16.79621946066618, 17.127536367624998, 23.36071813479066, 22.16622680425644, 23.087157644331455, 24.66091548651457, 24.845357002690434, 24.685459803789854, 19.67263163626194, 19.711565390229225, 19.688217598944902, 26.519767731428146, 26.076809592545033, 26.352758664637804, 18.164026528596878, 18.673327933996916, 18.278948344290257, 15.660295156141117, 15.667377342780426, 16.0770007877921, 19.162973046302795, 19.86048535630107, 19.58973617479205, 25.80187769110003, 25.947124897191912, 25.955985304589063, 22.675331387668848, 22.213504746556282, 22.127807572484016, 13.089114218950272, 14.435502268373966, 14.819647343159886, 20.192519811292485, 20.523624954124287, 20.4649040599664, 20.826750800013542, 21.30102128908038, 19.5983946621418, 29.864929468759016, 29.774591124306113, 29.8130254705126, 17.829267432292298, 18.84772553419073, 18.997681239464626, 24.40053933362165, 24.74333399037519, 24.722316461304814, 18.308360656102494, 18.125237864752606, 18.368852720906332, 22.922641692062214, 22.90724774015446, 22.575861794253186, 27.741274245083332, 27.183328427374363, 27.70064746774733, 19.127764001488686, 19.39386286586523, 19.863377924077213, 29.008781244357422, 28.986784150203064, 28.989330497880772, 23.792765234907463, 24.119165261586502, 23.34993826349576, 4.798009612907961, 4.84060327832897, 4.722025239219263, 23.069324965278298, 23.627375591701508, 23.570824625591428, 22.852463111281395, 23.232247289502993, 23.21319291740656, 15.351009607315063, 15.424352582544088, 15.4165148884058, -2.859497746452689, -2.75139199080877, -3.02323754504323, 16.375177532725502, 16.324246774427593, 15.510635033249855, 15.458193019032478, 16.208865023683757, 15.90458345413208, 21.124227836728096, 21.495189539156854, 20.408664613962173, 15.78789996355772, 16.18725040834397, 15.386267364025116, 15.823368755479649, 15.9347354521354, 15.468497713406876, 21.31013224025567, 21.912925924484924, 21.42293607940276, 2.990808521707848, 3.4642896497001203, 3.267778919388846, 18.112146268288285, 18.96946373457709, 18.781331377724797, 8.674962294598416, 9.188777240769312, 8.501271789272622, 13.658229246735573, 13.642503287643194, 13.384582720696926, 23.86200550943613, 23.84004507213831, 24.278544960543513, 12.585072139898926, 13.02902942026654, 12.989599289993436, 22.893487103904278, 22.762296768526227, 22.799107051144034, 20.62759968886772, 20.681569720307976, 20.95238500709334, 25.45352882767716, 25.298476396749408, 25.386671284834534, 24.780852193633706, 25.12868746618429, 24.831809135774762, 18.64105888580282, 18.378304344912365, 18.280728002389267, 11.682605581978947, 11.581576789418847, 11.175721461574227, 24.457190198202923, 23.931163524587944, 24.04109464337428, 20.16075219495299, 19.886003290613488, 19.9742342022558, 7.040517047047615, 7.045012317597866, 7.053261311724782, 23.726535353809595, 23.666531078517437, 23.96658194065094, 25.692088529467583, 25.85460833273828, 25.626880638301373, 17.889222227036953, 18.25417713401839, 17.579916700720787, 19.92539906998475, 20.23789184292157, 19.818329607446984, 9.255651816725731, 9.11462052166462, 9.206716515123844, 20.28242956350246, 20.339528801540524, 20.519727165500314, 18.147174437840775, 17.752238680919007, 18.310544799392417, 13.047210678458214, 12.718372598290443, 12.970645159482956, 23.01905697335799, 22.90228484322627, 23.16192604725559, 28.18367179234822, 28.22907384236653, 28.349621461083487, 14.076551121970013, 13.801935126384095, 13.96142579366763, 26.799786776304245, 26.535341382026672, 27.176975762471557, -90.31889847914378, -84.75872843960921, -85.51471448938052, 21.314251493662596, 21.530691865831614, 21.232666574418545, 20.05656861513853, 20.129917234182358, 20.16820176318288, 15.881537831077964, 15.957792996118457, 15.688046085337788, 15.583259090781212, 14.644941538572311, 15.351862758398056, 21.885005078588918, 21.35376876344283, 21.867270112348095, 30.027266561985016, 31.419336118735373, 30.686668947339058, 8.019014087816075, 7.910754432280854, 8.332652517904833, 20.53007713456948, 21.170573894012094, 20.48121727009614, 23.764726052681596, 23.672886321942002, 24.134444602454693, 27.34826739380756, 27.18310262511173, 27.66102099294463, 12.053861194600657, 11.983687696357563, 11.837928542246416, 20.653463343779237, 21.219270632291824, 21.174424023057014, 18.887856774032116, 18.47116032987833, 18.659546993672848, 18.321694818635777, 18.610949640472725, 18.296813828249768, 21.209118083119392, 21.53205811139196, 21.315826695412397, 13.953894317150116, 15.154908207245171, 15.123856250196695, 24.084099231598273, 23.766528492172554, 23.873460454245404, 12.453586320082337, 12.787934402624757, 12.848331900934369, 23.763308078050613, 24.421779583208263, 24.296462824568152, 23.041215920199946, 22.694760923584298, 23.065549982090786, 16.6295528790603, 16.422320465246827, 16.506258389602095, 29.979839293907077, 29.752625996867806, 29.67433090011278, 19.53185059502721, 19.258074708282948, 19.313986584544182, 10.08323188374439, 9.927168409029633, 10.133856306473405, 16.446753134950995, 16.172665245831013, 16.250157430768013, 21.15499810750285, 21.307926503630966, 20.822299304107815, 23.341637802620724, 23.38519102831681, 23.276359317203358, 23.147278428077698, 22.870098128914833, 23.298298474401236, 29.132560600837067, 29.2579364751776, 29.06834814449151, 18.875829812139273, 18.77807568013668, 18.874146446585655, 32.24466734627882, 32.728509372721106, 32.78773546280959, 20.414273547629506, 20.65095523574078, 19.916219929854066, 27.754904337227345, 27.587360374629498, 27.349521338939667, 11.846546962857246, 11.965350791811943, 12.313507547602057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15946333456692496, "mean_inference_ms": 0.7218956114763954, "mean_action_processing_ms": 0.10137777198437664, "mean_env_wait_ms": 0.831172138419713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 719550, "timesteps_this_iter": 0, "agent_timesteps_total": 2158650, "timers": {"sample_time_ms": 19784.744, "sample_throughput": 484.919, "load_time_ms": 0.401, "load_throughput": 23941071.261, "learn_time_ms": 3001.147, "learn_throughput": 3196.778, "update_time_ms": 8.451}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.634690046310425, "policy_loss": 0.0011212618139928576, "vf_loss": 5.748436748981476, "vf_explained_var": 0.031122632324695587, "kl": 0.008286001335434206, "entropy": 11.486775755882263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 719550, "num_agent_steps_sampled": 2158650, "num_steps_trained": 719550, "num_agent_steps_trained": 2158650, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3188, "training_iteration": 75, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-09-07", "timestamp": 1706191747, "time_this_iter_s": 18.994236946105957, "time_total_s": 1548.002587556839, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B779D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1548.002587556839, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 10.151851851851852, "ram_util_percent": 48.270370370370365}}
{"episode_reward_max": 97.76091218180952, "episode_reward_min": -260.5923414081335, "episode_reward_mean": 54.833556277217575, "episode_len_mean": 298.01, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -90.31889847914378}, "policy_reward_max": {"shared_policy": 32.78773546280959}, "policy_reward_mean": {"shared_policy": 18.27785209240585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.19187707826495, -8.63412728230469, 48.21005934040295, 47.571641496848315, 63.028081989847124, 47.36141773592681, 47.226601921021924, 64.64599424414335, 9.722877090796814, 55.86294138059017, 26.36501132464035, 40.68531525507569, 71.98059554211795, 38.6037008501589, 68.45489092357454, 62.261554416269036, 76.1386765092611, 74.74134879559276, 55.30009123310445, 34.43990383297202, 72.42944836616515, 60.02098968782228, 21.138790676370263, 71.35964837297797, 77.17357750050724, 53.72331606177613, 59.9816205203533, 27.576988853514194, 61.1416855305433, 54.2099579181522, 38.73622843623161, 69.08326786383985, 84.76236709579824, 41.83991204202174, 80.51210392080247, -260.5923414081335, 64.07760993391275, 60.35468761250377, 47.52737691253421, 45.58006338775158, 65.10604395437984, 92.13327162805945, 24.26242103800176, 62.18186829867771, 71.57205697707829, 82.19239101186392, 35.87547743320464, 63.047157999128075, 56.018564097583294, 55.22945828735827, 64.05700288992375, 44.23265877459198, 71.72408817801623, 38.08985262364146, 72.48155048582703, 68.80152682587503, 49.55813173390922, 89.40679619088766, 58.10391188785434, 30.144256599247427, 48.86957581155002, 63.28522391524163, 70.0031881481409, 69.31567503139377, 87.45884522050618, 56.52805193886161, 97.76091218180952, 60.98144871322435, 82.69178605079651, 36.12540530227125, 41.486166511662304, 68.1680984755512, 31.699584940448403, 43.13972578570245, 67.69610780477522, 79.34865625202654, 65.61004436574875, 63.090847145766006, 84.54697222448883, 74.58690123260018, 64.89537519961596, 68.89291552966459, 59.720126397907734, 74.61392319016157, 61.99572828318921, 50.80156443454324, 74.98458616808055, 38.262729335576296, 58.366263091564164, 74.13157956674695, 71.02863086760041, 41.97494566161183, 36.11116932332516, 44.7045506419381, 80.77673085778952, 65.85556523082775, 60.77270455984399, 62.79746728762983, 68.21486964821814, 37.04674551449716], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 101, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.351009607315063, 15.424352582544088, 15.4165148884058, -2.859497746452689, -2.75139199080877, -3.02323754504323, 16.375177532725502, 16.324246774427593, 15.510635033249855, 15.458193019032478, 16.208865023683757, 15.90458345413208, 21.124227836728096, 21.495189539156854, 20.408664613962173, 15.78789996355772, 16.18725040834397, 15.386267364025116, 15.823368755479649, 15.9347354521354, 15.468497713406876, 21.31013224025567, 21.912925924484924, 21.42293607940276, 2.990808521707848, 3.4642896497001203, 3.267778919388846, 18.112146268288285, 18.96946373457709, 18.781331377724797, 8.674962294598416, 9.188777240769312, 8.501271789272622, 13.658229246735573, 13.642503287643194, 13.384582720696926, 23.86200550943613, 23.84004507213831, 24.278544960543513, 12.585072139898926, 13.02902942026654, 12.989599289993436, 22.893487103904278, 22.762296768526227, 22.799107051144034, 20.62759968886772, 20.681569720307976, 20.95238500709334, 25.45352882767716, 25.298476396749408, 25.386671284834534, 24.780852193633706, 25.12868746618429, 24.831809135774762, 18.64105888580282, 18.378304344912365, 18.280728002389267, 11.682605581978947, 11.581576789418847, 11.175721461574227, 24.457190198202923, 23.931163524587944, 24.04109464337428, 20.16075219495299, 19.886003290613488, 19.9742342022558, 7.040517047047615, 7.045012317597866, 7.053261311724782, 23.726535353809595, 23.666531078517437, 23.96658194065094, 25.692088529467583, 25.85460833273828, 25.626880638301373, 17.889222227036953, 18.25417713401839, 17.579916700720787, 19.92539906998475, 20.23789184292157, 19.818329607446984, 9.255651816725731, 9.11462052166462, 9.206716515123844, 20.28242956350246, 20.339528801540524, 20.519727165500314, 18.147174437840775, 17.752238680919007, 18.310544799392417, 13.047210678458214, 12.718372598290443, 12.970645159482956, 23.01905697335799, 22.90228484322627, 23.16192604725559, 28.18367179234822, 28.22907384236653, 28.349621461083487, 14.076551121970013, 13.801935126384095, 13.96142579366763, 26.799786776304245, 26.535341382026672, 27.176975762471557, -90.31889847914378, -84.75872843960921, -85.51471448938052, 21.314251493662596, 21.530691865831614, 21.232666574418545, 20.05656861513853, 20.129917234182358, 20.16820176318288, 15.881537831077964, 15.957792996118457, 15.688046085337788, 15.583259090781212, 14.644941538572311, 15.351862758398056, 21.885005078588918, 21.35376876344283, 21.867270112348095, 30.027266561985016, 31.419336118735373, 30.686668947339058, 8.019014087816075, 7.910754432280854, 8.332652517904833, 20.53007713456948, 21.170573894012094, 20.48121727009614, 23.764726052681596, 23.672886321942002, 24.134444602454693, 27.34826739380756, 27.18310262511173, 27.66102099294463, 12.053861194600657, 11.983687696357563, 11.837928542246416, 20.653463343779237, 21.219270632291824, 21.174424023057014, 18.887856774032116, 18.47116032987833, 18.659546993672848, 18.321694818635777, 18.610949640472725, 18.296813828249768, 21.209118083119392, 21.53205811139196, 21.315826695412397, 13.953894317150116, 15.154908207245171, 15.123856250196695, 24.084099231598273, 23.766528492172554, 23.873460454245404, 12.453586320082337, 12.787934402624757, 12.848331900934369, 23.763308078050613, 24.421779583208263, 24.296462824568152, 23.041215920199946, 22.694760923584298, 23.065549982090786, 16.6295528790603, 16.422320465246827, 16.506258389602095, 29.979839293907077, 29.752625996867806, 29.67433090011278, 19.53185059502721, 19.258074708282948, 19.313986584544182, 10.08323188374439, 9.927168409029633, 10.133856306473405, 16.446753134950995, 16.172665245831013, 16.250157430768013, 21.15499810750285, 21.307926503630966, 20.822299304107815, 23.341637802620724, 23.38519102831681, 23.276359317203358, 23.147278428077698, 22.870098128914833, 23.298298474401236, 29.132560600837067, 29.2579364751776, 29.06834814449151, 18.875829812139273, 18.77807568013668, 18.874146446585655, 32.24466734627882, 32.728509372721106, 32.78773546280959, 20.414273547629506, 20.65095523574078, 19.916219929854066, 27.754904337227345, 27.587360374629498, 27.349521338939667, 11.846546962857246, 11.965350791811943, 12.313507547602057, 14.171044488437474, 13.629492215812206, 13.685629807412624, 22.674053880075604, 22.43255869547525, 23.06148590000035, 10.808132940903306, 10.397164940834045, 10.494287058711052, 14.527002458771065, 13.796497469147042, 14.816225857784346, 22.500966039796666, 22.609807343532637, 22.58533442144592, 26.472497047235564, 26.38217896719773, 26.49398023759325, 21.709823471804455, 21.80821893115838, 22.092001962785915, 21.326375806083277, 21.050547656913594, 20.713923682769135, 27.948767418662698, 28.444444534058363, 28.153760271767766, 24.613845514754445, 24.819880890349538, 25.1531748274962, 21.641785196959972, 21.587427139282227, 21.666162863373756, 23.05864455302556, 23.216422962800905, 22.617848013838127, 20.004182659089565, 19.982426814734936, 19.733516924083233, 24.932828924929098, 24.807435625543192, 24.873658639689282, 20.8461015910531, 20.5234070966641, 20.62621959547201, 16.774792698522404, 17.233462519322828, 16.793309216698006, 24.99877960545321, 25.044751662140087, 24.94105490048726, 12.486437350511551, 12.804722353816032, 12.971569631248713, 19.581244771679238, 19.719324742754296, 19.06569357713063, 24.72183857113123, 24.440907835960388, 24.968833159655333, 23.56989204386869, 23.667226354281098, 23.791512469450623, 14.098542715112359, 13.76109582434097, 14.115307122158498, 11.76772254705429, 12.336289875209332, 12.007156901061535, 14.820386422177151, 15.128976859812, 14.755187359948948, 27.074197228997946, 27.141020741313696, 26.561512887477875, 21.894457549477607, 21.948651508117706, 22.012456173232437, 20.346441950649023, 20.386044457089156, 20.04021815210581, 20.885725160439804, 20.983832002927855, 20.92791012426217, 22.67000262935956, 22.728527796765164, 22.81633922209342, 12.34971659630537, 12.274807266891003, 12.422221651300788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15926536833310787, "mean_inference_ms": 0.7216272977557441, "mean_action_processing_ms": 0.10138250415999003, "mean_env_wait_ms": 0.8306753793052906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 729144, "timesteps_this_iter": 0, "agent_timesteps_total": 2187432, "timers": {"sample_time_ms": 19768.873, "sample_throughput": 485.308, "load_time_ms": 0.501, "load_throughput": 19155592.22, "learn_time_ms": 3016.123, "learn_throughput": 3180.905, "update_time_ms": 8.602}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.475809276103973, "policy_loss": 0.001734806910394071, "vf_loss": 5.5905569195747375, "vf_explained_var": 0.082489512860775, "kl": 0.007449806464209854, "entropy": 11.648258209228516, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 729144, "num_agent_steps_sampled": 2187432, "num_steps_trained": 729144, "num_agent_steps_trained": 2187432, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3218, "training_iteration": 76, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-09-27", "timestamp": 1706191767, "time_this_iter_s": 20.14149522781372, "time_total_s": 1568.1440827846527, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1568.1440827846527, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 9.049999999999999, "ram_util_percent": 48.40714285714285}}
{"episode_reward_max": 97.76091218180952, "episode_reward_min": -260.5923414081335, "episode_reward_mean": 57.84889454267861, "episode_len_mean": 298.01, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -90.31889847914378}, "policy_reward_max": {"shared_policy": 32.78773546280959}, "policy_reward_mean": {"shared_policy": 19.28296484755953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.51210392080247, -260.5923414081335, 64.07760993391275, 60.35468761250377, 47.52737691253421, 45.58006338775158, 65.10604395437984, 92.13327162805945, 24.26242103800176, 62.18186829867771, 71.57205697707829, 82.19239101186392, 35.87547743320464, 63.047157999128075, 56.018564097583294, 55.22945828735827, 64.05700288992375, 44.23265877459198, 71.72408817801623, 38.08985262364146, 72.48155048582703, 68.80152682587503, 49.55813173390922, 89.40679619088766, 58.10391188785434, 30.144256599247427, 48.86957581155002, 63.28522391524163, 70.0031881481409, 69.31567503139377, 87.45884522050618, 56.52805193886161, 97.76091218180952, 60.98144871322435, 82.69178605079651, 36.12540530227125, 41.486166511662304, 68.1680984755512, 31.699584940448403, 43.13972578570245, 67.69610780477522, 79.34865625202654, 65.61004436574875, 63.090847145766006, 84.54697222448883, 74.58690123260018, 64.89537519961596, 68.89291552966459, 59.720126397907734, 74.61392319016157, 61.99572828318921, 50.80156443454324, 74.98458616808055, 38.262729335576296, 58.366263091564164, 74.13157956674695, 71.02863086760041, 41.97494566161183, 36.11116932332516, 44.7045506419381, 80.77673085778952, 65.85556523082775, 60.77270455984399, 62.79746728762983, 68.21486964821814, 37.04674551449716, 49.53196749696508, 81.48285980522631, 11.638547470793114, 73.42057738825677, 69.06853716168553, 19.74852439574896, 73.02650543209162, 7.577131181955309, 96.83933722972867, 59.3839468434453, 61.47707783104849, 79.79495249316093, 71.85257756710051, 61.45419657230374, 73.16020743176341, 65.5559320137836, 62.37514491379261, 68.16446658316998, 59.063691541552515, 63.02141613280399, 52.12470383942127, 77.9098793901503, 66.09593643993138, 65.15245909988877, 69.22821166180074, 72.87251748144627, 35.408334627747536, 64.49572522658852, 70.5514231789857, 68.25006218400083, 61.92972909472883, 58.968179799150676, 43.49770707823333, 50.747612562030525], "episode_lengths": [300, 101, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.799786776304245, 26.535341382026672, 27.176975762471557, -90.31889847914378, -84.75872843960921, -85.51471448938052, 21.314251493662596, 21.530691865831614, 21.232666574418545, 20.05656861513853, 20.129917234182358, 20.16820176318288, 15.881537831077964, 15.957792996118457, 15.688046085337788, 15.583259090781212, 14.644941538572311, 15.351862758398056, 21.885005078588918, 21.35376876344283, 21.867270112348095, 30.027266561985016, 31.419336118735373, 30.686668947339058, 8.019014087816075, 7.910754432280854, 8.332652517904833, 20.53007713456948, 21.170573894012094, 20.48121727009614, 23.764726052681596, 23.672886321942002, 24.134444602454693, 27.34826739380756, 27.18310262511173, 27.66102099294463, 12.053861194600657, 11.983687696357563, 11.837928542246416, 20.653463343779237, 21.219270632291824, 21.174424023057014, 18.887856774032116, 18.47116032987833, 18.659546993672848, 18.321694818635777, 18.610949640472725, 18.296813828249768, 21.209118083119392, 21.53205811139196, 21.315826695412397, 13.953894317150116, 15.154908207245171, 15.123856250196695, 24.084099231598273, 23.766528492172554, 23.873460454245404, 12.453586320082337, 12.787934402624757, 12.848331900934369, 23.763308078050613, 24.421779583208263, 24.296462824568152, 23.041215920199946, 22.694760923584298, 23.065549982090786, 16.6295528790603, 16.422320465246827, 16.506258389602095, 29.979839293907077, 29.752625996867806, 29.67433090011278, 19.53185059502721, 19.258074708282948, 19.313986584544182, 10.08323188374439, 9.927168409029633, 10.133856306473405, 16.446753134950995, 16.172665245831013, 16.250157430768013, 21.15499810750285, 21.307926503630966, 20.822299304107815, 23.341637802620724, 23.38519102831681, 23.276359317203358, 23.147278428077698, 22.870098128914833, 23.298298474401236, 29.132560600837067, 29.2579364751776, 29.06834814449151, 18.875829812139273, 18.77807568013668, 18.874146446585655, 32.24466734627882, 32.728509372721106, 32.78773546280959, 20.414273547629506, 20.65095523574078, 19.916219929854066, 27.754904337227345, 27.587360374629498, 27.349521338939667, 11.846546962857246, 11.965350791811943, 12.313507547602057, 14.171044488437474, 13.629492215812206, 13.685629807412624, 22.674053880075604, 22.43255869547525, 23.06148590000035, 10.808132940903306, 10.397164940834045, 10.494287058711052, 14.527002458771065, 13.796497469147042, 14.816225857784346, 22.500966039796666, 22.609807343532637, 22.58533442144592, 26.472497047235564, 26.38217896719773, 26.49398023759325, 21.709823471804455, 21.80821893115838, 22.092001962785915, 21.326375806083277, 21.050547656913594, 20.713923682769135, 27.948767418662698, 28.444444534058363, 28.153760271767766, 24.613845514754445, 24.819880890349538, 25.1531748274962, 21.641785196959972, 21.587427139282227, 21.666162863373756, 23.05864455302556, 23.216422962800905, 22.617848013838127, 20.004182659089565, 19.982426814734936, 19.733516924083233, 24.932828924929098, 24.807435625543192, 24.873658639689282, 20.8461015910531, 20.5234070966641, 20.62621959547201, 16.774792698522404, 17.233462519322828, 16.793309216698006, 24.99877960545321, 25.044751662140087, 24.94105490048726, 12.486437350511551, 12.804722353816032, 12.971569631248713, 19.581244771679238, 19.719324742754296, 19.06569357713063, 24.72183857113123, 24.440907835960388, 24.968833159655333, 23.56989204386869, 23.667226354281098, 23.791512469450623, 14.098542715112359, 13.76109582434097, 14.115307122158498, 11.76772254705429, 12.336289875209332, 12.007156901061535, 14.820386422177151, 15.128976859812, 14.755187359948948, 27.074197228997946, 27.141020741313696, 26.561512887477875, 21.894457549477607, 21.948651508117706, 22.012456173232437, 20.346441950649023, 20.386044457089156, 20.04021815210581, 20.885725160439804, 20.983832002927855, 20.92791012426217, 22.67000262935956, 22.728527796765164, 22.81633922209342, 12.34971659630537, 12.274807266891003, 12.422221651300788, 16.606799613684416, 16.313096068799496, 16.61207181448117, 27.187885267039135, 27.136195858319596, 27.15877867986758, 3.9131224093337806, 3.6799311389525684, 4.045493922506765, 24.622675274809197, 24.564513639857367, 24.23338847359021, 22.7762213870883, 23.000584818422794, 23.291730956174433, 6.415711869796112, 6.996903377895549, 6.335909148057297, 24.488662004160375, 24.10478815684715, 24.4330552710841, 2.376949990789086, 2.6988344068328445, 2.5013467843333785, 32.33004530022541, 32.28031133363643, 32.22898059586683, 19.172489941120148, 20.138585157692432, 20.07287174463272, 19.932088340322167, 20.902578759162367, 20.642410731563956, 26.675199362138898, 26.486164423326642, 26.633588707695395, 23.8519430955251, 24.21471894284089, 23.78591552873452, 20.48412303129831, 20.462998660902173, 20.50707488010326, 24.534681532764807, 24.53824494755827, 24.087280951440334, 22.139042957220227, 21.704482048749924, 21.712407007813454, 20.9652087315917, 20.53280843794346, 20.87712774425745, 22.477958393593624, 22.767104008545473, 22.919404181030885, 19.663943986097962, 19.674621711174638, 19.725125844279916, 20.765340213974312, 21.10032516283293, 21.15575075599675, 17.286855943500996, 17.248315058648586, 17.58953283727169, 25.862943475445107, 26.044304577012852, 26.002631337692335, 21.986132485171154, 22.26975954820712, 21.840044406553105, 21.5911528567473, 21.647253605226666, 21.914052637914807, 22.329802572727203, 23.320818789303303, 23.577590299770236, 24.254213869571686, 24.601540192961693, 24.016763418912888, 11.95724518597126, 11.977211773395538, 11.473877668380737, 21.34500345836082, 21.387779700259358, 21.76294206796834, 23.781426421677068, 23.380422381063298, 23.389574376245335, 23.016277253841196, 22.459992858270795, 22.773792071888835, 20.451389715075493, 20.664807088673115, 20.81353229098022, 19.90168725233525, 19.93754728557542, 19.128945261240005, 14.687185336525232, 14.496888260046632, 14.31363348166147, 16.88504300887385, 16.980696915338427, 16.881872637818248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1591409180219535, "mean_inference_ms": 0.7212844492840389, "mean_action_processing_ms": 0.10134668792942145, "mean_env_wait_ms": 0.8300191732608562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 738738, "timesteps_this_iter": 0, "agent_timesteps_total": 2216214, "timers": {"sample_time_ms": 19782.712, "sample_throughput": 484.969, "load_time_ms": 0.401, "load_throughput": 23936798.867, "learn_time_ms": 3006.108, "learn_throughput": 3191.503, "update_time_ms": 8.452}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.828875482082367, "policy_loss": 0.001906512115167569, "vf_loss": 5.94385701417923, "vf_explained_var": 0.07788003236055374, "kl": 0.009161341760847121, "entropy": 11.688803911209106, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 738738, "num_agent_steps_sampled": 2216214, "num_steps_trained": 738738, "num_agent_steps_trained": 2216214, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3252, "training_iteration": 77, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-09-48", "timestamp": 1706191788, "time_this_iter_s": 20.488776445388794, "time_total_s": 1588.6328592300415, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1588.6328592300415, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.189655172413795, "ram_util_percent": 48.889655172413796}}
{"episode_reward_max": 97.76091218180952, "episode_reward_min": -2.7895139904576354, "episode_reward_mean": 61.73712365187079, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -1.2405407950282097}, "policy_reward_max": {"shared_policy": 32.78773546280959}, "policy_reward_mean": {"shared_policy": 20.57904121729026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.52805193886161, 97.76091218180952, 60.98144871322435, 82.69178605079651, 36.12540530227125, 41.486166511662304, 68.1680984755512, 31.699584940448403, 43.13972578570245, 67.69610780477522, 79.34865625202654, 65.61004436574875, 63.090847145766006, 84.54697222448883, 74.58690123260018, 64.89537519961596, 68.89291552966459, 59.720126397907734, 74.61392319016157, 61.99572828318921, 50.80156443454324, 74.98458616808055, 38.262729335576296, 58.366263091564164, 74.13157956674695, 71.02863086760041, 41.97494566161183, 36.11116932332516, 44.7045506419381, 80.77673085778952, 65.85556523082775, 60.77270455984399, 62.79746728762983, 68.21486964821814, 37.04674551449716, 49.53196749696508, 81.48285980522631, 11.638547470793114, 73.42057738825677, 69.06853716168553, 19.74852439574896, 73.02650543209162, 7.577131181955309, 96.83933722972867, 59.3839468434453, 61.47707783104849, 79.79495249316093, 71.85257756710051, 61.45419657230374, 73.16020743176341, 65.5559320137836, 62.37514491379261, 68.16446658316998, 59.063691541552515, 63.02141613280399, 52.12470383942127, 77.9098793901503, 66.09593643993138, 65.15245909988877, 69.22821166180074, 72.87251748144627, 35.408334627747536, 64.49572522658852, 70.5514231789857, 68.25006218400083, 61.92972909472883, 58.968179799150676, 43.49770707823333, 50.747612562030525, 48.113801758736344, 61.78343284409492, 80.13049677759406, 59.4470574578736, 58.645142139866934, 70.04760020971297, 31.143816724419565, 53.40018282458186, 52.67736499279269, 79.3410245089326, 65.68077702820301, 69.05395716428754, 70.18423354066908, 61.998200527348644, 88.07279182597995, 86.326560982503, 79.93099893629551, 56.5703051369637, 88.08412820100783, 51.7734689489007, 66.3575452528894, 76.1378697156906, -2.7895139904576354, 86.76699677482246, 59.9044545162469, 68.17645320668814, 61.737867664545746, 52.01527533959597, 55.67355095967649, 68.28817814588547, 54.75938620418307], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.875829812139273, 18.77807568013668, 18.874146446585655, 32.24466734627882, 32.728509372721106, 32.78773546280959, 20.414273547629506, 20.65095523574078, 19.916219929854066, 27.754904337227345, 27.587360374629498, 27.349521338939667, 11.846546962857246, 11.965350791811943, 12.313507547602057, 14.171044488437474, 13.629492215812206, 13.685629807412624, 22.674053880075604, 22.43255869547525, 23.06148590000035, 10.808132940903306, 10.397164940834045, 10.494287058711052, 14.527002458771065, 13.796497469147042, 14.816225857784346, 22.500966039796666, 22.609807343532637, 22.58533442144592, 26.472497047235564, 26.38217896719773, 26.49398023759325, 21.709823471804455, 21.80821893115838, 22.092001962785915, 21.326375806083277, 21.050547656913594, 20.713923682769135, 27.948767418662698, 28.444444534058363, 28.153760271767766, 24.613845514754445, 24.819880890349538, 25.1531748274962, 21.641785196959972, 21.587427139282227, 21.666162863373756, 23.05864455302556, 23.216422962800905, 22.617848013838127, 20.004182659089565, 19.982426814734936, 19.733516924083233, 24.932828924929098, 24.807435625543192, 24.873658639689282, 20.8461015910531, 20.5234070966641, 20.62621959547201, 16.774792698522404, 17.233462519322828, 16.793309216698006, 24.99877960545321, 25.044751662140087, 24.94105490048726, 12.486437350511551, 12.804722353816032, 12.971569631248713, 19.581244771679238, 19.719324742754296, 19.06569357713063, 24.72183857113123, 24.440907835960388, 24.968833159655333, 23.56989204386869, 23.667226354281098, 23.791512469450623, 14.098542715112359, 13.76109582434097, 14.115307122158498, 11.76772254705429, 12.336289875209332, 12.007156901061535, 14.820386422177151, 15.128976859812, 14.755187359948948, 27.074197228997946, 27.141020741313696, 26.561512887477875, 21.894457549477607, 21.948651508117706, 22.012456173232437, 20.346441950649023, 20.386044457089156, 20.04021815210581, 20.885725160439804, 20.983832002927855, 20.92791012426217, 22.67000262935956, 22.728527796765164, 22.81633922209342, 12.34971659630537, 12.274807266891003, 12.422221651300788, 16.606799613684416, 16.313096068799496, 16.61207181448117, 27.187885267039135, 27.136195858319596, 27.15877867986758, 3.9131224093337806, 3.6799311389525684, 4.045493922506765, 24.622675274809197, 24.564513639857367, 24.23338847359021, 22.7762213870883, 23.000584818422794, 23.291730956174433, 6.415711869796112, 6.996903377895549, 6.335909148057297, 24.488662004160375, 24.10478815684715, 24.4330552710841, 2.376949990789086, 2.6988344068328445, 2.5013467843333785, 32.33004530022541, 32.28031133363643, 32.22898059586683, 19.172489941120148, 20.138585157692432, 20.07287174463272, 19.932088340322167, 20.902578759162367, 20.642410731563956, 26.675199362138898, 26.486164423326642, 26.633588707695395, 23.8519430955251, 24.21471894284089, 23.78591552873452, 20.48412303129831, 20.462998660902173, 20.50707488010326, 24.534681532764807, 24.53824494755827, 24.087280951440334, 22.139042957220227, 21.704482048749924, 21.712407007813454, 20.9652087315917, 20.53280843794346, 20.87712774425745, 22.477958393593624, 22.767104008545473, 22.919404181030885, 19.663943986097962, 19.674621711174638, 19.725125844279916, 20.765340213974312, 21.10032516283293, 21.15575075599675, 17.286855943500996, 17.248315058648586, 17.58953283727169, 25.862943475445107, 26.044304577012852, 26.002631337692335, 21.986132485171154, 22.26975954820712, 21.840044406553105, 21.5911528567473, 21.647253605226666, 21.914052637914807, 22.329802572727203, 23.320818789303303, 23.577590299770236, 24.254213869571686, 24.601540192961693, 24.016763418912888, 11.95724518597126, 11.977211773395538, 11.473877668380737, 21.34500345836082, 21.387779700259358, 21.76294206796834, 23.781426421677068, 23.380422381063298, 23.389574376245335, 23.016277253841196, 22.459992858270795, 22.773792071888835, 20.451389715075493, 20.664807088673115, 20.81353229098022, 19.90168725233525, 19.93754728557542, 19.128945261240005, 14.687185336525232, 14.496888260046632, 14.31363348166147, 16.88504300887385, 16.980696915338427, 16.881872637818248, 15.686331863204629, 16.131130444506795, 16.29633945102492, 20.6185185474654, 20.727566395265356, 20.437347901364163, 26.692150163153798, 26.661124045650155, 26.77722256879011, 19.711981527507305, 19.530705735087395, 20.204370195278898, 19.548184772332505, 19.400361118217305, 19.696596249317125, 23.305534352858857, 23.242499460776642, 23.49956639607747, 10.332244912783295, 10.583604554335267, 10.227967257301003, 17.84360207244754, 17.771468121558428, 17.785112630575895, 17.443533199528844, 17.492943959931523, 17.740887833332323, 26.437339201569557, 26.200396433472633, 26.703288873890415, 21.830774821341038, 21.812727689743042, 22.03727451711893, 22.96596440176168, 23.11663894603649, 22.97135381648937, 23.284805841743946, 23.401536099612713, 23.497891599312425, 20.57107777396837, 20.911225134152716, 20.51589761922756, 29.33384098112583, 29.321427457034588, 29.41752338781953, 28.966572520323098, 28.847791951149702, 28.512196511030197, 26.3377116471529, 26.720141604542732, 26.873145684599876, 19.204378836477787, 18.534289980928094, 18.831636319557816, 29.340863985319928, 29.478491110106305, 29.264773105581597, 17.5326846241951, 17.42683083564043, 16.81395348906517, 22.10992469638586, 22.25892038270831, 21.988700173795223, 25.4078645085295, 25.454274175067738, 25.27573103209336, -0.7080674154567532, -0.8409057799726725, -1.2405407950282097, 28.522744004925087, 29.149631572266415, 29.094621197630957, 20.04679773872097, 19.800373082359627, 20.057283695166305, 22.664438697199017, 22.673413964609296, 22.838600544879824, 20.62436397994557, 20.83657694856325, 20.276926736036927, 17.363414995372295, 17.153724811971188, 17.49813553225249, 18.469092739125088, 18.625942548116043, 18.57851567243536, 22.861296739429235, 22.88940465077758, 22.537476755678654, 18.312911349038274, 18.424519668022782, 18.021955187122018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15902201312096023, "mean_inference_ms": 0.721171493220585, "mean_action_processing_ms": 0.10136287425869023, "mean_env_wait_ms": 0.829619238168917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 748332, "timesteps_this_iter": 0, "agent_timesteps_total": 2244996, "timers": {"sample_time_ms": 19606.361, "sample_throughput": 489.331, "load_time_ms": 0.501, "load_throughput": 19156504.13, "learn_time_ms": 2993.677, "learn_throughput": 3204.754, "update_time_ms": 8.352}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.614167511463165, "policy_loss": 0.002207448871990536, "vf_loss": 5.731643378734589, "vf_explained_var": 0.05506765842437744, "kl": 0.01039389480145976, "entropy": 11.96831464767456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 748332, "num_agent_steps_sampled": 2244996, "num_steps_trained": 748332, "num_agent_steps_trained": 2244996, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3283, "training_iteration": 78, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-10-07", "timestamp": 1706191807, "time_this_iter_s": 19.412916898727417, "time_total_s": 1608.045776128769, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004C9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1608.045776128769, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 9.060714285714285, "ram_util_percent": 48.8}}
{"episode_reward_max": 99.5029999911785, "episode_reward_min": -2.7895139904576354, "episode_reward_mean": 62.367965347829305, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -1.2405407950282097}, "policy_reward_max": {"shared_policy": 33.35896289100249}, "policy_reward_mean": {"shared_policy": 20.78932178260976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.79746728762983, 68.21486964821814, 37.04674551449716, 49.53196749696508, 81.48285980522631, 11.638547470793114, 73.42057738825677, 69.06853716168553, 19.74852439574896, 73.02650543209162, 7.577131181955309, 96.83933722972867, 59.3839468434453, 61.47707783104849, 79.79495249316093, 71.85257756710051, 61.45419657230374, 73.16020743176341, 65.5559320137836, 62.37514491379261, 68.16446658316998, 59.063691541552515, 63.02141613280399, 52.12470383942127, 77.9098793901503, 66.09593643993138, 65.15245909988877, 69.22821166180074, 72.87251748144627, 35.408334627747536, 64.49572522658852, 70.5514231789857, 68.25006218400083, 61.92972909472883, 58.968179799150676, 43.49770707823333, 50.747612562030525, 48.113801758736344, 61.78343284409492, 80.13049677759406, 59.4470574578736, 58.645142139866934, 70.04760020971297, 31.143816724419565, 53.40018282458186, 52.67736499279269, 79.3410245089326, 65.68077702820301, 69.05395716428754, 70.18423354066908, 61.998200527348644, 88.07279182597995, 86.326560982503, 79.93099893629551, 56.5703051369637, 88.08412820100783, 51.7734689489007, 66.3575452528894, 76.1378697156906, -2.7895139904576354, 86.76699677482246, 59.9044545162469, 68.17645320668814, 61.737867664545746, 52.01527533959597, 55.67355095967649, 68.28817814588547, 54.75938620418307, 71.0063917711377, 49.386993030086145, 76.91096041724084, 56.7973730114754, 82.29724420886487, 99.5029999911785, 61.33551258593795, 71.08387863636015, 68.93457545340058, 80.04930900782345, 63.06085754744707, 49.224220328032956, 64.11923812492748, 67.50639647990465, 52.14589098934081, 57.11135413870214, 72.90435641258954, 52.6763923780527, 49.86802317947148, 70.92679484933613, 53.759121324866996, 68.34364868793637, 77.55538394488393, 51.08408410102129, 59.070810344070196, 64.45750330388546, 51.95334878563878, 50.121562996879206, 58.929528694367036, 49.75897524086756, 73.62961150333284, 68.92162539251147], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.885725160439804, 20.983832002927855, 20.92791012426217, 22.67000262935956, 22.728527796765164, 22.81633922209342, 12.34971659630537, 12.274807266891003, 12.422221651300788, 16.606799613684416, 16.313096068799496, 16.61207181448117, 27.187885267039135, 27.136195858319596, 27.15877867986758, 3.9131224093337806, 3.6799311389525684, 4.045493922506765, 24.622675274809197, 24.564513639857367, 24.23338847359021, 22.7762213870883, 23.000584818422794, 23.291730956174433, 6.415711869796112, 6.996903377895549, 6.335909148057297, 24.488662004160375, 24.10478815684715, 24.4330552710841, 2.376949990789086, 2.6988344068328445, 2.5013467843333785, 32.33004530022541, 32.28031133363643, 32.22898059586683, 19.172489941120148, 20.138585157692432, 20.07287174463272, 19.932088340322167, 20.902578759162367, 20.642410731563956, 26.675199362138898, 26.486164423326642, 26.633588707695395, 23.8519430955251, 24.21471894284089, 23.78591552873452, 20.48412303129831, 20.462998660902173, 20.50707488010326, 24.534681532764807, 24.53824494755827, 24.087280951440334, 22.139042957220227, 21.704482048749924, 21.712407007813454, 20.9652087315917, 20.53280843794346, 20.87712774425745, 22.477958393593624, 22.767104008545473, 22.919404181030885, 19.663943986097962, 19.674621711174638, 19.725125844279916, 20.765340213974312, 21.10032516283293, 21.15575075599675, 17.286855943500996, 17.248315058648586, 17.58953283727169, 25.862943475445107, 26.044304577012852, 26.002631337692335, 21.986132485171154, 22.26975954820712, 21.840044406553105, 21.5911528567473, 21.647253605226666, 21.914052637914807, 22.329802572727203, 23.320818789303303, 23.577590299770236, 24.254213869571686, 24.601540192961693, 24.016763418912888, 11.95724518597126, 11.977211773395538, 11.473877668380737, 21.34500345836082, 21.387779700259358, 21.76294206796834, 23.781426421677068, 23.380422381063298, 23.389574376245335, 23.016277253841196, 22.459992858270795, 22.773792071888835, 20.451389715075493, 20.664807088673115, 20.81353229098022, 19.90168725233525, 19.93754728557542, 19.128945261240005, 14.687185336525232, 14.496888260046632, 14.31363348166147, 16.88504300887385, 16.980696915338427, 16.881872637818248, 15.686331863204629, 16.131130444506795, 16.29633945102492, 20.6185185474654, 20.727566395265356, 20.437347901364163, 26.692150163153798, 26.661124045650155, 26.77722256879011, 19.711981527507305, 19.530705735087395, 20.204370195278898, 19.548184772332505, 19.400361118217305, 19.696596249317125, 23.305534352858857, 23.242499460776642, 23.49956639607747, 10.332244912783295, 10.583604554335267, 10.227967257301003, 17.84360207244754, 17.771468121558428, 17.785112630575895, 17.443533199528844, 17.492943959931523, 17.740887833332323, 26.437339201569557, 26.200396433472633, 26.703288873890415, 21.830774821341038, 21.812727689743042, 22.03727451711893, 22.96596440176168, 23.11663894603649, 22.97135381648937, 23.284805841743946, 23.401536099612713, 23.497891599312425, 20.57107777396837, 20.911225134152716, 20.51589761922756, 29.33384098112583, 29.321427457034588, 29.41752338781953, 28.966572520323098, 28.847791951149702, 28.512196511030197, 26.3377116471529, 26.720141604542732, 26.873145684599876, 19.204378836477787, 18.534289980928094, 18.831636319557816, 29.340863985319928, 29.478491110106305, 29.264773105581597, 17.5326846241951, 17.42683083564043, 16.81395348906517, 22.10992469638586, 22.25892038270831, 21.988700173795223, 25.4078645085295, 25.454274175067738, 25.27573103209336, -0.7080674154567532, -0.8409057799726725, -1.2405407950282097, 28.522744004925087, 29.149631572266415, 29.094621197630957, 20.04679773872097, 19.800373082359627, 20.057283695166305, 22.664438697199017, 22.673413964609296, 22.838600544879824, 20.62436397994557, 20.83657694856325, 20.276926736036927, 17.363414995372295, 17.153724811971188, 17.49813553225249, 18.469092739125088, 18.625942548116043, 18.57851567243536, 22.861296739429235, 22.88940465077758, 22.537476755678654, 18.312911349038274, 18.424519668022782, 18.021955187122018, 23.972878535588578, 23.721262482305363, 23.31225075324376, 16.645944713925317, 16.447246474524334, 16.293801841636494, 25.473767464359597, 26.101534367849425, 25.335658585031823, 19.037140779585258, 18.9569781726847, 18.803254059205443, 27.566752335056663, 27.064420342445374, 27.66607153136283, 32.91211666663487, 33.35896289100249, 33.231920433541134, 20.52076448375979, 20.4635987492899, 20.351149352888257, 23.78094134976466, 23.828049433728054, 23.47488785286744, 23.094828980664403, 23.34342237065235, 22.496324102083832, 26.404878218968705, 26.55080946286519, 27.09362132598956, 21.269275429969028, 21.000103955467537, 20.791478162010506, 16.333560546239212, 16.309464772542313, 16.58119500925143, 21.156753073136002, 22.04511980378689, 20.917365248004586, 22.458688035607338, 22.098974898457527, 22.948733545839787, 17.19118400166431, 17.578976686733455, 17.375730300943047, 18.960444164772824, 19.03245935340722, 19.118450620522097, 24.227987860639885, 24.46612238635619, 24.21024616559346, 17.574569899588823, 17.679580928524956, 17.422241549938917, 16.715454896291092, 16.5398147975405, 16.612753485639885, 23.392069449027375, 23.719069843490914, 23.815655556817845, 18.06200747316082, 17.584987123807267, 18.11212672789891, 22.5235800370574, 22.887678469531238, 22.932390181347728, 25.44593295951684, 25.978708685686186, 26.130742299680904, 17.029914036393166, 17.080176956951618, 16.973993107676506, 19.74223018437624, 19.65270547941327, 19.675874680280685, 21.582529447972775, 21.460580617189407, 21.414393238723278, 17.628889496127755, 16.945927555362374, 17.378531734148652, 16.8861859117945, 16.33935546626647, 16.89602161881824, 19.6050441339612, 19.28385552763939, 20.040629032766446, 16.67365400136137, 16.578411099190504, 16.506910140315682, 24.66357933854063, 24.494976816078022, 24.471055348714188, 22.80653305103381, 23.05569383067389, 23.059398510803774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1588340635424044, "mean_inference_ms": 0.7207745982907403, "mean_action_processing_ms": 0.10132378364744236, "mean_env_wait_ms": 0.8289785710488785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 757926, "timesteps_this_iter": 0, "agent_timesteps_total": 2273778, "timers": {"sample_time_ms": 19483.964, "sample_throughput": 492.405, "load_time_ms": 0.501, "load_throughput": 19156504.13, "learn_time_ms": 3002.373, "learn_throughput": 3195.473, "update_time_ms": 8.452}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 6.0570016503334045, "policy_loss": 0.005181528146851022, "vf_loss": 6.173910856246948, "vf_explained_var": -0.009660348296165466, "kl": 0.01676223828698625, "entropy": 12.209070444107056, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 757926, "num_agent_steps_sampled": 2273778, "num_steps_trained": 757926, "num_agent_steps_trained": 2273778, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3315, "training_iteration": 79, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-10-26", "timestamp": 1706191826, "time_this_iter_s": 18.8585786819458, "time_total_s": 1626.9043548107147, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03502EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1626.9043548107147, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 9.123076923076924, "ram_util_percent": 48.6576923076923}}
{"episode_reward_max": 99.5029999911785, "episode_reward_min": -2.7895139904576354, "episode_reward_mean": 63.98830286335331, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -1.2405407950282097}, "policy_reward_max": {"shared_policy": 33.35896289100249}, "policy_reward_mean": {"shared_policy": 21.32943428778443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.92972909472883, 58.968179799150676, 43.49770707823333, 50.747612562030525, 48.113801758736344, 61.78343284409492, 80.13049677759406, 59.4470574578736, 58.645142139866934, 70.04760020971297, 31.143816724419565, 53.40018282458186, 52.67736499279269, 79.3410245089326, 65.68077702820301, 69.05395716428754, 70.18423354066908, 61.998200527348644, 88.07279182597995, 86.326560982503, 79.93099893629551, 56.5703051369637, 88.08412820100783, 51.7734689489007, 66.3575452528894, 76.1378697156906, -2.7895139904576354, 86.76699677482246, 59.9044545162469, 68.17645320668814, 61.737867664545746, 52.01527533959597, 55.67355095967649, 68.28817814588547, 54.75938620418307, 71.0063917711377, 49.386993030086145, 76.91096041724084, 56.7973730114754, 82.29724420886487, 99.5029999911785, 61.33551258593795, 71.08387863636015, 68.93457545340058, 80.04930900782345, 63.06085754744707, 49.224220328032956, 64.11923812492748, 67.50639647990465, 52.14589098934081, 57.11135413870214, 72.90435641258954, 52.6763923780527, 49.86802317947148, 70.92679484933613, 53.759121324866996, 68.34364868793637, 77.55538394488393, 51.08408410102129, 59.070810344070196, 64.45750330388546, 51.95334878563878, 50.121562996879206, 58.929528694367036, 49.75897524086756, 73.62961150333284, 68.92162539251147, 95.11926239728925, 63.26868874207139, 55.759994319640086, 83.88456175103784, 66.84820742346345, 69.8923494715709, 50.8242638967931, 61.13218642771244, 70.83856990188359, 65.15581091120836, 67.30787760671228, 80.06715998798606, 78.41341358423232, 80.95583464205262, 56.15559719037262, 59.6625396236777, 49.79859393835068, 60.6118129454553, 70.50877077504992, 68.24639661610125, 60.85508591029793, 68.39599312935024, 73.41871516779064, 74.81756321713326, 47.41159453615546, 44.48144579306242, 74.47365976497531, 47.74354339018463, 62.76424618437886, 81.12849779217501, 56.0074109509587, 65.1242286339402, 68.74580799601969], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.451389715075493, 20.664807088673115, 20.81353229098022, 19.90168725233525, 19.93754728557542, 19.128945261240005, 14.687185336525232, 14.496888260046632, 14.31363348166147, 16.88504300887385, 16.980696915338427, 16.881872637818248, 15.686331863204629, 16.131130444506795, 16.29633945102492, 20.6185185474654, 20.727566395265356, 20.437347901364163, 26.692150163153798, 26.661124045650155, 26.77722256879011, 19.711981527507305, 19.530705735087395, 20.204370195278898, 19.548184772332505, 19.400361118217305, 19.696596249317125, 23.305534352858857, 23.242499460776642, 23.49956639607747, 10.332244912783295, 10.583604554335267, 10.227967257301003, 17.84360207244754, 17.771468121558428, 17.785112630575895, 17.443533199528844, 17.492943959931523, 17.740887833332323, 26.437339201569557, 26.200396433472633, 26.703288873890415, 21.830774821341038, 21.812727689743042, 22.03727451711893, 22.96596440176168, 23.11663894603649, 22.97135381648937, 23.284805841743946, 23.401536099612713, 23.497891599312425, 20.57107777396837, 20.911225134152716, 20.51589761922756, 29.33384098112583, 29.321427457034588, 29.41752338781953, 28.966572520323098, 28.847791951149702, 28.512196511030197, 26.3377116471529, 26.720141604542732, 26.873145684599876, 19.204378836477787, 18.534289980928094, 18.831636319557816, 29.340863985319928, 29.478491110106305, 29.264773105581597, 17.5326846241951, 17.42683083564043, 16.81395348906517, 22.10992469638586, 22.25892038270831, 21.988700173795223, 25.4078645085295, 25.454274175067738, 25.27573103209336, -0.7080674154567532, -0.8409057799726725, -1.2405407950282097, 28.522744004925087, 29.149631572266415, 29.094621197630957, 20.04679773872097, 19.800373082359627, 20.057283695166305, 22.664438697199017, 22.673413964609296, 22.838600544879824, 20.62436397994557, 20.83657694856325, 20.276926736036927, 17.363414995372295, 17.153724811971188, 17.49813553225249, 18.469092739125088, 18.625942548116043, 18.57851567243536, 22.861296739429235, 22.88940465077758, 22.537476755678654, 18.312911349038274, 18.424519668022782, 18.021955187122018, 23.972878535588578, 23.721262482305363, 23.31225075324376, 16.645944713925317, 16.447246474524334, 16.293801841636494, 25.473767464359597, 26.101534367849425, 25.335658585031823, 19.037140779585258, 18.9569781726847, 18.803254059205443, 27.566752335056663, 27.064420342445374, 27.66607153136283, 32.91211666663487, 33.35896289100249, 33.231920433541134, 20.52076448375979, 20.4635987492899, 20.351149352888257, 23.78094134976466, 23.828049433728054, 23.47488785286744, 23.094828980664403, 23.34342237065235, 22.496324102083832, 26.404878218968705, 26.55080946286519, 27.09362132598956, 21.269275429969028, 21.000103955467537, 20.791478162010506, 16.333560546239212, 16.309464772542313, 16.58119500925143, 21.156753073136002, 22.04511980378689, 20.917365248004586, 22.458688035607338, 22.098974898457527, 22.948733545839787, 17.19118400166431, 17.578976686733455, 17.375730300943047, 18.960444164772824, 19.03245935340722, 19.118450620522097, 24.227987860639885, 24.46612238635619, 24.21024616559346, 17.574569899588823, 17.679580928524956, 17.422241549938917, 16.715454896291092, 16.5398147975405, 16.612753485639885, 23.392069449027375, 23.719069843490914, 23.815655556817845, 18.06200747316082, 17.584987123807267, 18.11212672789891, 22.5235800370574, 22.887678469531238, 22.932390181347728, 25.44593295951684, 25.978708685686186, 26.130742299680904, 17.029914036393166, 17.080176956951618, 16.973993107676506, 19.74223018437624, 19.65270547941327, 19.675874680280685, 21.582529447972775, 21.460580617189407, 21.414393238723278, 17.628889496127755, 16.945927555362374, 17.378531734148652, 16.8861859117945, 16.33935546626647, 16.89602161881824, 19.6050441339612, 19.28385552763939, 20.040629032766446, 16.67365400136137, 16.578411099190504, 16.506910140315682, 24.66357933854063, 24.494976816078022, 24.471055348714188, 22.80653305103381, 23.05569383067389, 23.059398510803774, 31.691636643062026, 31.58667470763126, 31.84095104659596, 20.97343484312296, 21.22767709568143, 21.067576803267002, 18.621169228417173, 18.48826618616779, 18.65055890505512, 27.958042286336422, 27.831463143229485, 28.09505632147193, 22.26444901277621, 22.487675383066133, 22.096083027621106, 23.076198394099862, 23.19245412449041, 23.623696952980623, 17.29369931543866, 16.548938329021126, 16.981626252333314, 20.329445600509644, 20.68952888250351, 20.113211944699287, 23.59847158690293, 23.832658944030598, 23.40743937095006, 21.851955736676842, 21.72501108671227, 21.57884408781925, 22.577766563743353, 22.71846043597907, 22.01165060698986, 26.849708596865327, 26.653293224672467, 26.564158166448266, 26.328963757803038, 25.814935257037476, 26.269514569391802, 27.00355154524246, 26.93671953926483, 27.015563557545335, 18.775413419740886, 18.60565562422076, 18.774528146410972, 20.099399896959454, 19.779744694630295, 19.783395032087952, 16.71633479744196, 16.480355724692345, 16.601903416216373, 19.9364948918422, 20.469756246854857, 20.20556180675824, 23.349108919501305, 23.685120902955532, 23.474540952593088, 22.694243138035134, 22.831173186500862, 22.720980291565255, 20.36400525830686, 20.09931843727827, 20.3917622147128, 22.56831219792366, 22.993792564608157, 22.833888366818428, 24.15398073693116, 24.5958177310725, 24.668916699786976, 24.818917902807385, 24.87029632429281, 25.12834899003306, 15.941377554088831, 15.824758104979992, 15.64545887708664, 14.586033920447022, 14.914675901333482, 14.980735971281916, 24.646624319255352, 24.958273788914084, 24.868761656805873, 16.162542441238955, 15.713573118050888, 15.867427830894783, 20.842480920255184, 21.128783132880926, 20.792982131242752, 27.056182133654744, 27.259469859690086, 26.812845798830182, 18.850841494897992, 18.77615840236345, 18.38041105369726, 21.801952955623463, 21.49901197602351, 21.823263702293232, 22.755415874222905, 23.01962148087719, 22.970770640919596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1586651918158992, "mean_inference_ms": 0.7201138191592227, "mean_action_processing_ms": 0.10130083081339611, "mean_env_wait_ms": 0.828072193854957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 767520, "timesteps_this_iter": 0, "agent_timesteps_total": 2302560, "timers": {"sample_time_ms": 19428.198, "sample_throughput": 493.818, "load_time_ms": 0.501, "load_throughput": 19156504.13, "learn_time_ms": 2993.419, "learn_throughput": 3205.031, "update_time_ms": 8.453}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.541551649570465, "policy_loss": 0.004280357717322714, "vf_loss": 5.6610347628593445, "vf_explained_var": 0.030206404626369476, "kl": 0.01167118790917766, "entropy": 12.376345038414001, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 767520, "num_agent_steps_sampled": 2302560, "num_steps_trained": 767520, "num_agent_steps_trained": 2302560, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3348, "training_iteration": 80, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-10-45", "timestamp": 1706191845, "time_this_iter_s": 18.52793788909912, "time_total_s": 1645.4322926998138, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1645.4322926998138, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 7.950000000000001, "ram_util_percent": 48.77307692307692}}
{"episode_reward_max": 99.5029999911785, "episode_reward_min": 18.80080555006859, "episode_reward_mean": 65.64998894414632, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 6.08829456816116}, "policy_reward_max": {"shared_policy": 33.35896289100249}, "policy_reward_mean": {"shared_policy": 21.883329648048765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.01527533959597, 55.67355095967649, 68.28817814588547, 54.75938620418307, 71.0063917711377, 49.386993030086145, 76.91096041724084, 56.7973730114754, 82.29724420886487, 99.5029999911785, 61.33551258593795, 71.08387863636015, 68.93457545340058, 80.04930900782345, 63.06085754744707, 49.224220328032956, 64.11923812492748, 67.50639647990465, 52.14589098934081, 57.11135413870214, 72.90435641258954, 52.6763923780527, 49.86802317947148, 70.92679484933613, 53.759121324866996, 68.34364868793637, 77.55538394488393, 51.08408410102129, 59.070810344070196, 64.45750330388546, 51.95334878563878, 50.121562996879206, 58.929528694367036, 49.75897524086756, 73.62961150333284, 68.92162539251147, 95.11926239728925, 63.26868874207139, 55.759994319640086, 83.88456175103784, 66.84820742346345, 69.8923494715709, 50.8242638967931, 61.13218642771244, 70.83856990188359, 65.15581091120836, 67.30787760671228, 80.06715998798606, 78.41341358423232, 80.95583464205262, 56.15559719037262, 59.6625396236777, 49.79859393835068, 60.6118129454553, 70.50877077504992, 68.24639661610125, 60.85508591029793, 68.39599312935024, 73.41871516779064, 74.81756321713326, 47.41159453615546, 44.48144579306242, 74.47365976497531, 47.74354339018463, 62.76424618437886, 81.12849779217501, 56.0074109509587, 65.1242286339402, 68.74580799601969, 65.09184007672593, 62.86807408928871, 34.08071207255125, 80.24210126511753, 75.60823519714177, 70.1753461724147, 70.34595141373573, 75.98165444284676, 50.895651921629906, 73.59594742022452, 56.542848672717795, 72.39775308966634, 89.49788375012575, 42.009073019959004, 73.35693194018677, 63.86515558511019, 77.18792427331208, 76.86203514039514, 93.35498999245465, 81.91331360861656, 79.55128568038343, 46.19437335431574, 73.66583200544116, 47.62951992824671, 64.42890888149847, 69.68140271585433, 60.32245236635205, 18.80080555006859, 79.40736058726905, 91.43149450654161, 93.02199356444179], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.363414995372295, 17.153724811971188, 17.49813553225249, 18.469092739125088, 18.625942548116043, 18.57851567243536, 22.861296739429235, 22.88940465077758, 22.537476755678654, 18.312911349038274, 18.424519668022782, 18.021955187122018, 23.972878535588578, 23.721262482305363, 23.31225075324376, 16.645944713925317, 16.447246474524334, 16.293801841636494, 25.473767464359597, 26.101534367849425, 25.335658585031823, 19.037140779585258, 18.9569781726847, 18.803254059205443, 27.566752335056663, 27.064420342445374, 27.66607153136283, 32.91211666663487, 33.35896289100249, 33.231920433541134, 20.52076448375979, 20.4635987492899, 20.351149352888257, 23.78094134976466, 23.828049433728054, 23.47488785286744, 23.094828980664403, 23.34342237065235, 22.496324102083832, 26.404878218968705, 26.55080946286519, 27.09362132598956, 21.269275429969028, 21.000103955467537, 20.791478162010506, 16.333560546239212, 16.309464772542313, 16.58119500925143, 21.156753073136002, 22.04511980378689, 20.917365248004586, 22.458688035607338, 22.098974898457527, 22.948733545839787, 17.19118400166431, 17.578976686733455, 17.375730300943047, 18.960444164772824, 19.03245935340722, 19.118450620522097, 24.227987860639885, 24.46612238635619, 24.21024616559346, 17.574569899588823, 17.679580928524956, 17.422241549938917, 16.715454896291092, 16.5398147975405, 16.612753485639885, 23.392069449027375, 23.719069843490914, 23.815655556817845, 18.06200747316082, 17.584987123807267, 18.11212672789891, 22.5235800370574, 22.887678469531238, 22.932390181347728, 25.44593295951684, 25.978708685686186, 26.130742299680904, 17.029914036393166, 17.080176956951618, 16.973993107676506, 19.74223018437624, 19.65270547941327, 19.675874680280685, 21.582529447972775, 21.460580617189407, 21.414393238723278, 17.628889496127755, 16.945927555362374, 17.378531734148652, 16.8861859117945, 16.33935546626647, 16.89602161881824, 19.6050441339612, 19.28385552763939, 20.040629032766446, 16.67365400136137, 16.578411099190504, 16.506910140315682, 24.66357933854063, 24.494976816078022, 24.471055348714188, 22.80653305103381, 23.05569383067389, 23.059398510803774, 31.691636643062026, 31.58667470763126, 31.84095104659596, 20.97343484312296, 21.22767709568143, 21.067576803267002, 18.621169228417173, 18.48826618616779, 18.65055890505512, 27.958042286336422, 27.831463143229485, 28.09505632147193, 22.26444901277621, 22.487675383066133, 22.096083027621106, 23.076198394099862, 23.19245412449041, 23.623696952980623, 17.29369931543866, 16.548938329021126, 16.981626252333314, 20.329445600509644, 20.68952888250351, 20.113211944699287, 23.59847158690293, 23.832658944030598, 23.40743937095006, 21.851955736676842, 21.72501108671227, 21.57884408781925, 22.577766563743353, 22.71846043597907, 22.01165060698986, 26.849708596865327, 26.653293224672467, 26.564158166448266, 26.328963757803038, 25.814935257037476, 26.269514569391802, 27.00355154524246, 26.93671953926483, 27.015563557545335, 18.775413419740886, 18.60565562422076, 18.774528146410972, 20.099399896959454, 19.779744694630295, 19.783395032087952, 16.71633479744196, 16.480355724692345, 16.601903416216373, 19.9364948918422, 20.469756246854857, 20.20556180675824, 23.349108919501305, 23.685120902955532, 23.474540952593088, 22.694243138035134, 22.831173186500862, 22.720980291565255, 20.36400525830686, 20.09931843727827, 20.3917622147128, 22.56831219792366, 22.993792564608157, 22.833888366818428, 24.15398073693116, 24.5958177310725, 24.668916699786976, 24.818917902807385, 24.87029632429281, 25.12834899003306, 15.941377554088831, 15.824758104979992, 15.64545887708664, 14.586033920447022, 14.914675901333482, 14.980735971281916, 24.646624319255352, 24.958273788914084, 24.868761656805873, 16.162542441238955, 15.713573118050888, 15.867427830894783, 20.842480920255184, 21.128783132880926, 20.792982131242752, 27.056182133654744, 27.259469859690086, 26.812845798830182, 18.850841494897992, 18.77615840236345, 18.38041105369726, 21.801952955623463, 21.49901197602351, 21.823263702293232, 22.755415874222905, 23.01962148087719, 22.970770640919596, 21.496389850974083, 22.005060646217316, 21.59038957953453, 21.32440396398306, 20.61164167523384, 20.93202845007181, 11.319380968809128, 11.625540785491467, 11.135790318250656, 26.823621604591608, 26.56908069550991, 26.849398965016007, 25.14122437685728, 25.110287442803383, 25.356723377481103, 23.297551480432347, 23.344344740112618, 23.53344995186974, 23.180355985959366, 23.74969280076523, 23.415902627011135, 25.358245370288685, 25.25379281242688, 25.369616260131195, 17.060143552720547, 17.06983657181263, 16.76567179709673, 24.28764314452806, 24.749169164026767, 24.55913511166969, 18.851852928598717, 18.73501270016034, 18.95598304395874, 23.99472018579641, 24.228966663281113, 24.174066240588814, 29.607574713726834, 29.951819188271955, 29.938489848126963, 13.594327042500169, 14.186470727125794, 14.228275250333041, 24.394143106415868, 24.465408529154956, 24.497380304615945, 21.49546755105257, 21.37691543996334, 20.992772594094276, 25.89640562733014, 25.5605083455642, 25.731010300417736, 25.751223454872758, 25.633090103665978, 25.4777215818564, 31.04566615819931, 30.99259850382805, 31.31672533042729, 27.088753799597413, 27.41197172055641, 27.41258808846274, 26.552822859336928, 26.42421333988507, 26.57424948116143, 15.506661181648568, 15.326366891463593, 15.361345281203583, 24.5630452359716, 24.742155107359082, 24.360631662110478, 16.102846837292105, 15.841580512622983, 15.68509257833162, 21.74124229645045, 21.023712689677865, 21.663953895370156, 23.329073805672422, 23.131804601599768, 23.220524308582142, 20.254702428976685, 20.46386309961477, 19.603886837760598, 6.293215448657662, 6.419295533249766, 6.08829456816116, 26.40401481216152, 26.49323370804389, 26.510112067063645, 30.055532629291207, 30.63652018706003, 30.739441690190375, 31.274620431785777, 31.026369349410132, 30.721003783245877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584028942993505, "mean_inference_ms": 0.7193322946023559, "mean_action_processing_ms": 0.10118243179111311, "mean_env_wait_ms": 0.8271904118631334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 777114, "timesteps_this_iter": 0, "agent_timesteps_total": 2331342, "timers": {"sample_time_ms": 19384.518, "sample_throughput": 494.931, "load_time_ms": 0.401, "load_throughput": 23935375.075, "learn_time_ms": 2978.241, "learn_throughput": 3221.365, "update_time_ms": 8.353}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 7.275501072406769, "policy_loss": 0.00042370369538997227, "vf_loss": 7.399804353713989, "vf_explained_var": 0.018827363848686218, "kl": 0.005891922453976841, "entropy": 12.472697138786316, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 777114, "num_agent_steps_sampled": 2331342, "num_steps_trained": 777114, "num_agent_steps_trained": 2331342, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3379, "training_iteration": 81, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-11-03", "timestamp": 1706191863, "time_this_iter_s": 18.792986154556274, "time_total_s": 1664.2252788543701, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41C64820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1664.2252788543701, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 9.011111111111111, "ram_util_percent": 48.70370370370371}}
{"episode_reward_max": 95.29484393820165, "episode_reward_min": 18.80080555006859, "episode_reward_mean": 67.71773128547939, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 6.08829456816116}, "policy_reward_max": {"shared_policy": 31.992028587808207}, "policy_reward_mean": {"shared_policy": 22.57257709515979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.929528694367036, 49.75897524086756, 73.62961150333284, 68.92162539251147, 95.11926239728925, 63.26868874207139, 55.759994319640086, 83.88456175103784, 66.84820742346345, 69.8923494715709, 50.8242638967931, 61.13218642771244, 70.83856990188359, 65.15581091120836, 67.30787760671228, 80.06715998798606, 78.41341358423232, 80.95583464205262, 56.15559719037262, 59.6625396236777, 49.79859393835068, 60.6118129454553, 70.50877077504992, 68.24639661610125, 60.85508591029793, 68.39599312935024, 73.41871516779064, 74.81756321713326, 47.41159453615546, 44.48144579306242, 74.47365976497531, 47.74354339018463, 62.76424618437886, 81.12849779217501, 56.0074109509587, 65.1242286339402, 68.74580799601969, 65.09184007672593, 62.86807408928871, 34.08071207255125, 80.24210126511753, 75.60823519714177, 70.1753461724147, 70.34595141373573, 75.98165444284676, 50.895651921629906, 73.59594742022452, 56.542848672717795, 72.39775308966634, 89.49788375012575, 42.009073019959004, 73.35693194018677, 63.86515558511019, 77.18792427331208, 76.86203514039514, 93.35498999245465, 81.91331360861656, 79.55128568038343, 46.19437335431574, 73.66583200544116, 47.62951992824671, 64.42890888149847, 69.68140271585433, 60.32245236635205, 18.80080555006859, 79.40736058726905, 91.43149450654161, 93.02199356444179, 78.48904249537733, 67.84178993524982, 62.18580833356825, 65.25197310000658, 65.06701194867489, 91.57087259925902, 70.38594641722739, 67.4567491672933, 70.61539343744516, 72.1992477364838, 71.70641904743388, 73.70833725482223, 60.159760446986155, 83.71215082891284, 84.72806290164587, 87.00818973034619, 73.8899887166917, 58.90547124296424, 59.185822293162346, 64.99572709947824, 74.31888645235449, 61.4179775826633, 63.3333605546504, 36.068532165139885, 74.84015619289129, 65.25087111163883, 75.97028593719006, 55.099492032080875, 46.56228218786417, 76.5982907935977, 76.88610713183877, 95.29484393820165], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.6050441339612, 19.28385552763939, 20.040629032766446, 16.67365400136137, 16.578411099190504, 16.506910140315682, 24.66357933854063, 24.494976816078022, 24.471055348714188, 22.80653305103381, 23.05569383067389, 23.059398510803774, 31.691636643062026, 31.58667470763126, 31.84095104659596, 20.97343484312296, 21.22767709568143, 21.067576803267002, 18.621169228417173, 18.48826618616779, 18.65055890505512, 27.958042286336422, 27.831463143229485, 28.09505632147193, 22.26444901277621, 22.487675383066133, 22.096083027621106, 23.076198394099862, 23.19245412449041, 23.623696952980623, 17.29369931543866, 16.548938329021126, 16.981626252333314, 20.329445600509644, 20.68952888250351, 20.113211944699287, 23.59847158690293, 23.832658944030598, 23.40743937095006, 21.851955736676842, 21.72501108671227, 21.57884408781925, 22.577766563743353, 22.71846043597907, 22.01165060698986, 26.849708596865327, 26.653293224672467, 26.564158166448266, 26.328963757803038, 25.814935257037476, 26.269514569391802, 27.00355154524246, 26.93671953926483, 27.015563557545335, 18.775413419740886, 18.60565562422076, 18.774528146410972, 20.099399896959454, 19.779744694630295, 19.783395032087952, 16.71633479744196, 16.480355724692345, 16.601903416216373, 19.9364948918422, 20.469756246854857, 20.20556180675824, 23.349108919501305, 23.685120902955532, 23.474540952593088, 22.694243138035134, 22.831173186500862, 22.720980291565255, 20.36400525830686, 20.09931843727827, 20.3917622147128, 22.56831219792366, 22.993792564608157, 22.833888366818428, 24.15398073693116, 24.5958177310725, 24.668916699786976, 24.818917902807385, 24.87029632429281, 25.12834899003306, 15.941377554088831, 15.824758104979992, 15.64545887708664, 14.586033920447022, 14.914675901333482, 14.980735971281916, 24.646624319255352, 24.958273788914084, 24.868761656805873, 16.162542441238955, 15.713573118050888, 15.867427830894783, 20.842480920255184, 21.128783132880926, 20.792982131242752, 27.056182133654744, 27.259469859690086, 26.812845798830182, 18.850841494897992, 18.77615840236345, 18.38041105369726, 21.801952955623463, 21.49901197602351, 21.823263702293232, 22.755415874222905, 23.01962148087719, 22.970770640919596, 21.496389850974083, 22.005060646217316, 21.59038957953453, 21.32440396398306, 20.61164167523384, 20.93202845007181, 11.319380968809128, 11.625540785491467, 11.135790318250656, 26.823621604591608, 26.56908069550991, 26.849398965016007, 25.14122437685728, 25.110287442803383, 25.356723377481103, 23.297551480432347, 23.344344740112618, 23.53344995186974, 23.180355985959366, 23.74969280076523, 23.415902627011135, 25.358245370288685, 25.25379281242688, 25.369616260131195, 17.060143552720547, 17.06983657181263, 16.76567179709673, 24.28764314452806, 24.749169164026767, 24.55913511166969, 18.851852928598717, 18.73501270016034, 18.95598304395874, 23.99472018579641, 24.228966663281113, 24.174066240588814, 29.607574713726834, 29.951819188271955, 29.938489848126963, 13.594327042500169, 14.186470727125794, 14.228275250333041, 24.394143106415868, 24.465408529154956, 24.497380304615945, 21.49546755105257, 21.37691543996334, 20.992772594094276, 25.89640562733014, 25.5605083455642, 25.731010300417736, 25.751223454872758, 25.633090103665978, 25.4777215818564, 31.04566615819931, 30.99259850382805, 31.31672533042729, 27.088753799597413, 27.41197172055641, 27.41258808846274, 26.552822859336928, 26.42421333988507, 26.57424948116143, 15.506661181648568, 15.326366891463593, 15.361345281203583, 24.5630452359716, 24.742155107359082, 24.360631662110478, 16.102846837292105, 15.841580512622983, 15.68509257833162, 21.74124229645045, 21.023712689677865, 21.663953895370156, 23.329073805672422, 23.131804601599768, 23.220524308582142, 20.254702428976685, 20.46386309961477, 19.603886837760598, 6.293215448657662, 6.419295533249766, 6.08829456816116, 26.40401481216152, 26.49323370804389, 26.510112067063645, 30.055532629291207, 30.63652018706003, 30.739441690190375, 31.274620431785777, 31.026369349410132, 30.721003783245877, 26.347820933597774, 26.17221517736712, 25.969006384412438, 22.600908703481153, 22.680509852090225, 22.560371379678443, 20.869133934068174, 20.51573623965183, 20.800938159848243, 21.409818410873413, 21.8458463922143, 21.99630829691887, 21.63717799882093, 21.984447604666144, 21.445386345187814, 30.655984161421657, 30.37489701062441, 30.539991427212954, 23.414326086640358, 23.554346533492208, 23.417273797094822, 22.778624424089983, 22.415951934953526, 22.262172808249787, 23.636664379388094, 23.59445121511817, 23.3842778429389, 24.03525762756665, 23.952243854602173, 24.211746254314974, 23.88043013960123, 23.56549644470215, 24.260492463130504, 24.69316233197847, 24.54505045215288, 24.470124470690877, 19.78216307858625, 20.03731661165753, 20.340280756742374, 28.005597654109195, 27.86615155388911, 27.840401620914534, 27.765483553210885, 28.484156955654413, 28.478422392780573, 29.105058332284287, 29.052170683940247, 28.850960714121655, 24.449156100551278, 24.776666133354098, 24.664166482786328, 19.705982002119214, 19.652208815018327, 19.5472804258267, 19.522278986871243, 19.83943524584174, 19.824108060449362, 21.122990116477013, 22.088296838104725, 21.784440144896507, 24.69591787457466, 24.50961685180664, 25.11335172597319, 19.76310658454895, 20.852882258594036, 20.80198873952031, 21.184553439418465, 20.436358908812196, 21.712448206419737, 12.197027801225573, 12.023537362615258, 11.847967001299054, 24.959584354733423, 25.012998177049056, 24.867573661108807, 21.84412918829669, 21.740145174165562, 21.666596749176577, 25.22380931675434, 25.098422154784203, 25.648054465651512, 18.32658529778321, 18.342924421032265, 18.4299823132654, 15.729893590634063, 15.511819166441754, 15.320569430788353, 25.31275326758623, 25.548424445092678, 25.73711308091879, 25.584598603347928, 25.787064890066773, 25.51444363842407, 31.60439173628886, 31.698423614104584, 31.992028587808207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15818570920306732, "mean_inference_ms": 0.7184674181344266, "mean_action_processing_ms": 0.10112535047124308, "mean_env_wait_ms": 0.8262899847450659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 786708, "timesteps_this_iter": 0, "agent_timesteps_total": 2360124, "timers": {"sample_time_ms": 19283.03, "sample_throughput": 497.536, "load_time_ms": 0.401, "load_throughput": 23922568.561, "learn_time_ms": 2965.554, "learn_throughput": 3235.146, "update_time_ms": 8.254}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5087425708770755e-08, "cur_lr": 0.0005, "total_loss": 5.873152792453766, "policy_loss": -0.00023024541778848828, "vf_loss": 5.9986624121665955, "vf_explained_var": 0.012239627540111542, "kl": 0.004981040925580482, "entropy": 12.527941346168518, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 786708, "num_agent_steps_sampled": 2360124, "num_steps_trained": 786708, "num_agent_steps_trained": 2360124, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3411, "training_iteration": 82, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-11-22", "timestamp": 1706191882, "time_this_iter_s": 18.808584451675415, "time_total_s": 1683.0338633060455, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1683.0338633060455, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 9.648148148148149, "ram_util_percent": 48.670370370370364}}
{"episode_reward_max": 96.70614222437143, "episode_reward_min": 18.80080555006859, "episode_reward_mean": 66.8855646444182, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 6.08829456816116}, "policy_reward_max": {"shared_policy": 32.28373975306749}, "policy_reward_mean": {"shared_policy": 22.295188214806057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.74354339018463, 62.76424618437886, 81.12849779217501, 56.0074109509587, 65.1242286339402, 68.74580799601969, 65.09184007672593, 62.86807408928871, 34.08071207255125, 80.24210126511753, 75.60823519714177, 70.1753461724147, 70.34595141373573, 75.98165444284676, 50.895651921629906, 73.59594742022452, 56.542848672717795, 72.39775308966634, 89.49788375012575, 42.009073019959004, 73.35693194018677, 63.86515558511019, 77.18792427331208, 76.86203514039514, 93.35498999245465, 81.91331360861656, 79.55128568038343, 46.19437335431574, 73.66583200544116, 47.62951992824671, 64.42890888149847, 69.68140271585433, 60.32245236635205, 18.80080555006859, 79.40736058726905, 91.43149450654161, 93.02199356444179, 78.48904249537733, 67.84178993524982, 62.18580833356825, 65.25197310000658, 65.06701194867489, 91.57087259925902, 70.38594641722739, 67.4567491672933, 70.61539343744516, 72.1992477364838, 71.70641904743388, 73.70833725482223, 60.159760446986155, 83.71215082891284, 84.72806290164587, 87.00818973034619, 73.8899887166917, 58.90547124296424, 59.185822293162346, 64.99572709947824, 74.31888645235449, 61.4179775826633, 63.3333605546504, 36.068532165139885, 74.84015619289129, 65.25087111163883, 75.97028593719006, 55.099492032080875, 46.56228218786417, 76.5982907935977, 76.88610713183877, 95.29484393820165, 53.01593460584991, 86.58772215899077, 74.03449160605668, 66.51351213455197, 71.32665642257778, 81.5479322746396, 60.38183803111315, 39.346482984721646, 57.91575392708181, 34.72738913446662, 47.28433786332606, 37.446531388908625, 89.7279633581638, 58.789636559784384, 66.49894943833351, 72.41883993335065, 96.70614222437143, 65.71375211328265, 56.37537805736062, 52.4128554081544, 45.51638439856467, 87.91990110278128, 67.43220928683876, 65.04226804617791, 60.81921902671456, 64.75699645280838, 63.77438442409036, 69.65058717504144, 60.11860776902175, 44.25961217936127, 68.2667569098994], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.162542441238955, 15.713573118050888, 15.867427830894783, 20.842480920255184, 21.128783132880926, 20.792982131242752, 27.056182133654744, 27.259469859690086, 26.812845798830182, 18.850841494897992, 18.77615840236345, 18.38041105369726, 21.801952955623463, 21.49901197602351, 21.823263702293232, 22.755415874222905, 23.01962148087719, 22.970770640919596, 21.496389850974083, 22.005060646217316, 21.59038957953453, 21.32440396398306, 20.61164167523384, 20.93202845007181, 11.319380968809128, 11.625540785491467, 11.135790318250656, 26.823621604591608, 26.56908069550991, 26.849398965016007, 25.14122437685728, 25.110287442803383, 25.356723377481103, 23.297551480432347, 23.344344740112618, 23.53344995186974, 23.180355985959366, 23.74969280076523, 23.415902627011135, 25.358245370288685, 25.25379281242688, 25.369616260131195, 17.060143552720547, 17.06983657181263, 16.76567179709673, 24.28764314452806, 24.749169164026767, 24.55913511166969, 18.851852928598717, 18.73501270016034, 18.95598304395874, 23.99472018579641, 24.228966663281113, 24.174066240588814, 29.607574713726834, 29.951819188271955, 29.938489848126963, 13.594327042500169, 14.186470727125794, 14.228275250333041, 24.394143106415868, 24.465408529154956, 24.497380304615945, 21.49546755105257, 21.37691543996334, 20.992772594094276, 25.89640562733014, 25.5605083455642, 25.731010300417736, 25.751223454872758, 25.633090103665978, 25.4777215818564, 31.04566615819931, 30.99259850382805, 31.31672533042729, 27.088753799597413, 27.41197172055641, 27.41258808846274, 26.552822859336928, 26.42421333988507, 26.57424948116143, 15.506661181648568, 15.326366891463593, 15.361345281203583, 24.5630452359716, 24.742155107359082, 24.360631662110478, 16.102846837292105, 15.841580512622983, 15.68509257833162, 21.74124229645045, 21.023712689677865, 21.663953895370156, 23.329073805672422, 23.131804601599768, 23.220524308582142, 20.254702428976685, 20.46386309961477, 19.603886837760598, 6.293215448657662, 6.419295533249766, 6.08829456816116, 26.40401481216152, 26.49323370804389, 26.510112067063645, 30.055532629291207, 30.63652018706003, 30.739441690190375, 31.274620431785777, 31.026369349410132, 30.721003783245877, 26.347820933597774, 26.17221517736712, 25.969006384412438, 22.600908703481153, 22.680509852090225, 22.560371379678443, 20.869133934068174, 20.51573623965183, 20.800938159848243, 21.409818410873413, 21.8458463922143, 21.99630829691887, 21.63717799882093, 21.984447604666144, 21.445386345187814, 30.655984161421657, 30.37489701062441, 30.539991427212954, 23.414326086640358, 23.554346533492208, 23.417273797094822, 22.778624424089983, 22.415951934953526, 22.262172808249787, 23.636664379388094, 23.59445121511817, 23.3842778429389, 24.03525762756665, 23.952243854602173, 24.211746254314974, 23.88043013960123, 23.56549644470215, 24.260492463130504, 24.69316233197847, 24.54505045215288, 24.470124470690877, 19.78216307858625, 20.03731661165753, 20.340280756742374, 28.005597654109195, 27.86615155388911, 27.840401620914534, 27.765483553210885, 28.484156955654413, 28.478422392780573, 29.105058332284287, 29.052170683940247, 28.850960714121655, 24.449156100551278, 24.776666133354098, 24.664166482786328, 19.705982002119214, 19.652208815018327, 19.5472804258267, 19.522278986871243, 19.83943524584174, 19.824108060449362, 21.122990116477013, 22.088296838104725, 21.784440144896507, 24.69591787457466, 24.50961685180664, 25.11335172597319, 19.76310658454895, 20.852882258594036, 20.80198873952031, 21.184553439418465, 20.436358908812196, 21.712448206419737, 12.197027801225573, 12.023537362615258, 11.847967001299054, 24.959584354733423, 25.012998177049056, 24.867573661108807, 21.84412918829669, 21.740145174165562, 21.666596749176577, 25.22380931675434, 25.098422154784203, 25.648054465651512, 18.32658529778321, 18.342924421032265, 18.4299823132654, 15.729893590634063, 15.511819166441754, 15.320569430788353, 25.31275326758623, 25.548424445092678, 25.73711308091879, 25.584598603347928, 25.787064890066773, 25.51444363842407, 31.60439173628886, 31.698423614104584, 31.992028587808207, 17.276307597756386, 17.91400266881101, 17.825624339282513, 28.872196591148764, 28.693954954544694, 29.021570613297314, 24.810537589093045, 24.659766634305313, 24.564187382658318, 22.23084936539331, 22.27758529285589, 22.005077476302773, 23.702175465722874, 23.60820509244998, 24.016275864404932, 27.259354300796986, 27.48487849533558, 26.803699478507042, 20.018539734184742, 20.195343501865864, 20.167954795062542, 12.940974225600556, 12.942000990112618, 13.463507769008473, 18.719470923145607, 19.771999412526682, 19.42428359140952, 11.627851064006478, 12.015468599895627, 11.084069470564515, 15.94764234622319, 15.519406740864113, 15.817288776238755, 12.31236907839775, 12.357209950685501, 12.776952359825373, 29.987657914559037, 29.76882355908552, 29.97148188451925, 19.577033827702195, 19.604842635492474, 19.607760096589715, 22.20458595827222, 22.007834434509277, 22.286529045552015, 23.96732152501741, 24.343057070548326, 24.108461337784917, 32.28373975306749, 32.20506698638201, 32.21733548492193, 21.995815791810543, 21.96492335634926, 21.75301296512285, 18.77619396398464, 18.850752408305794, 18.748431685070187, 17.659334061356873, 17.40430678303042, 17.349214563767106, 14.877558479706437, 15.56703765752414, 15.071788261334092, 29.427460958560303, 29.330647592743233, 29.161792551477745, 22.61948077504833, 22.476284993191555, 22.33644351859887, 21.444625948866204, 21.736819596340254, 21.86082250097145, 20.218148179352283, 20.11788985133171, 20.48318099603057, 21.682149969041348, 21.323680222034454, 21.75116626173258, 21.154187152783066, 21.233290712038666, 21.386906559268624, 23.163673125207424, 23.101355016231537, 23.385559033602476, 20.416666708498568, 19.739027698834732, 19.96291336168845, 14.71006442358096, 15.127698276502386, 14.421849479277924, 22.681888611366347, 22.8059901803111, 22.778878118221954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1579260110283757, "mean_inference_ms": 0.7179889169081874, "mean_action_processing_ms": 0.10101220857388771, "mean_env_wait_ms": 0.8256398629773252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 796302, "timesteps_this_iter": 0, "agent_timesteps_total": 2388906, "timers": {"sample_time_ms": 19340.469, "sample_throughput": 496.058, "load_time_ms": 0.3, "load_throughput": 31944234.799, "learn_time_ms": 2966.898, "learn_throughput": 3233.681, "update_time_ms": 8.253}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.543712854385377e-09, "cur_lr": 0.0005, "total_loss": 6.13235080242157, "policy_loss": 0.0019251724891373723, "vf_loss": 6.255696356296539, "vf_explained_var": 0.028027795255184174, "kl": 0.007679901900797919, "entropy": 12.527089953422546, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 796302, "num_agent_steps_sampled": 2388906, "num_steps_trained": 796302, "num_agent_steps_trained": 2388906, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3442, "training_iteration": 83, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-11-42", "timestamp": 1706191902, "time_this_iter_s": 19.343266487121582, "time_total_s": 1702.3771297931671, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41C649D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1702.3771297931671, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.237037037037037, "ram_util_percent": 48.91851851851851}}
{"episode_reward_max": 98.97499640285969, "episode_reward_min": 21.560196507023633, "episode_reward_mean": 67.6492652533413, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": 7.119137232502297}, "policy_reward_max": {"shared_policy": 33.19115737080574}, "policy_reward_mean": {"shared_policy": 22.549755084447092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.40736058726905, 91.43149450654161, 93.02199356444179, 78.48904249537733, 67.84178993524982, 62.18580833356825, 65.25197310000658, 65.06701194867489, 91.57087259925902, 70.38594641722739, 67.4567491672933, 70.61539343744516, 72.1992477364838, 71.70641904743388, 73.70833725482223, 60.159760446986155, 83.71215082891284, 84.72806290164587, 87.00818973034619, 73.8899887166917, 58.90547124296424, 59.185822293162346, 64.99572709947824, 74.31888645235449, 61.4179775826633, 63.3333605546504, 36.068532165139885, 74.84015619289129, 65.25087111163883, 75.97028593719006, 55.099492032080875, 46.56228218786417, 76.5982907935977, 76.88610713183877, 95.29484393820165, 53.01593460584991, 86.58772215899077, 74.03449160605668, 66.51351213455197, 71.32665642257778, 81.5479322746396, 60.38183803111315, 39.346482984721646, 57.91575392708181, 34.72738913446662, 47.28433786332606, 37.446531388908625, 89.7279633581638, 58.789636559784384, 66.49894943833351, 72.41883993335065, 96.70614222437143, 65.71375211328265, 56.37537805736062, 52.4128554081544, 45.51638439856467, 87.91990110278128, 67.43220928683876, 65.04226804617791, 60.81921902671456, 64.75699645280838, 63.77438442409036, 69.65058717504144, 60.11860776902175, 44.25961217936127, 68.2667569098994, 64.98399570398031, 97.59404173493382, 72.15034673735497, 61.41145418956876, 61.13064763043076, 80.8759111240506, 81.1409085392952, 60.62899576034394, 62.388016880024225, 56.700153417885275, 64.09927093237637, 98.97499640285969, 54.3106148142833, 80.75122340768574, 75.5073386467993, 79.28710266202687, 58.11020197905599, 21.560196507023633, 35.19217925192788, 54.607769157737465, 75.57538120821118, 59.367636390030356, 80.17994279414413, 87.42923060059546, 65.79478160105646, 82.48800980160013, 69.60705195367336, 77.31128814443943, 75.30210886150597, 53.25731900893152, 65.65045199822634, 79.31197636947034, 70.22227848321197, 41.12897677160798], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.40401481216152, 26.49323370804389, 26.510112067063645, 30.055532629291207, 30.63652018706003, 30.739441690190375, 31.274620431785777, 31.026369349410132, 30.721003783245877, 26.347820933597774, 26.17221517736712, 25.969006384412438, 22.600908703481153, 22.680509852090225, 22.560371379678443, 20.869133934068174, 20.51573623965183, 20.800938159848243, 21.409818410873413, 21.8458463922143, 21.99630829691887, 21.63717799882093, 21.984447604666144, 21.445386345187814, 30.655984161421657, 30.37489701062441, 30.539991427212954, 23.414326086640358, 23.554346533492208, 23.417273797094822, 22.778624424089983, 22.415951934953526, 22.262172808249787, 23.636664379388094, 23.59445121511817, 23.3842778429389, 24.03525762756665, 23.952243854602173, 24.211746254314974, 23.88043013960123, 23.56549644470215, 24.260492463130504, 24.69316233197847, 24.54505045215288, 24.470124470690877, 19.78216307858625, 20.03731661165753, 20.340280756742374, 28.005597654109195, 27.86615155388911, 27.840401620914534, 27.765483553210885, 28.484156955654413, 28.478422392780573, 29.105058332284287, 29.052170683940247, 28.850960714121655, 24.449156100551278, 24.776666133354098, 24.664166482786328, 19.705982002119214, 19.652208815018327, 19.5472804258267, 19.522278986871243, 19.83943524584174, 19.824108060449362, 21.122990116477013, 22.088296838104725, 21.784440144896507, 24.69591787457466, 24.50961685180664, 25.11335172597319, 19.76310658454895, 20.852882258594036, 20.80198873952031, 21.184553439418465, 20.436358908812196, 21.712448206419737, 12.197027801225573, 12.023537362615258, 11.847967001299054, 24.959584354733423, 25.012998177049056, 24.867573661108807, 21.84412918829669, 21.740145174165562, 21.666596749176577, 25.22380931675434, 25.098422154784203, 25.648054465651512, 18.32658529778321, 18.342924421032265, 18.4299823132654, 15.729893590634063, 15.511819166441754, 15.320569430788353, 25.31275326758623, 25.548424445092678, 25.73711308091879, 25.584598603347928, 25.787064890066773, 25.51444363842407, 31.60439173628886, 31.698423614104584, 31.992028587808207, 17.276307597756386, 17.91400266881101, 17.825624339282513, 28.872196591148764, 28.693954954544694, 29.021570613297314, 24.810537589093045, 24.659766634305313, 24.564187382658318, 22.23084936539331, 22.27758529285589, 22.005077476302773, 23.702175465722874, 23.60820509244998, 24.016275864404932, 27.259354300796986, 27.48487849533558, 26.803699478507042, 20.018539734184742, 20.195343501865864, 20.167954795062542, 12.940974225600556, 12.942000990112618, 13.463507769008473, 18.719470923145607, 19.771999412526682, 19.42428359140952, 11.627851064006478, 12.015468599895627, 11.084069470564515, 15.94764234622319, 15.519406740864113, 15.817288776238755, 12.31236907839775, 12.357209950685501, 12.776952359825373, 29.987657914559037, 29.76882355908552, 29.97148188451925, 19.577033827702195, 19.604842635492474, 19.607760096589715, 22.20458595827222, 22.007834434509277, 22.286529045552015, 23.96732152501741, 24.343057070548326, 24.108461337784917, 32.28373975306749, 32.20506698638201, 32.21733548492193, 21.995815791810543, 21.96492335634926, 21.75301296512285, 18.77619396398464, 18.850752408305794, 18.748431685070187, 17.659334061356873, 17.40430678303042, 17.349214563767106, 14.877558479706437, 15.56703765752414, 15.071788261334092, 29.427460958560303, 29.330647592743233, 29.161792551477745, 22.61948077504833, 22.476284993191555, 22.33644351859887, 21.444625948866204, 21.736819596340254, 21.86082250097145, 20.218148179352283, 20.11788985133171, 20.48318099603057, 21.682149969041348, 21.323680222034454, 21.75116626173258, 21.154187152783066, 21.233290712038666, 21.386906559268624, 23.163673125207424, 23.101355016231537, 23.385559033602476, 20.416666708498568, 19.739027698834732, 19.96291336168845, 14.71006442358096, 15.127698276502386, 14.421849479277924, 22.681888611366347, 22.8059901803111, 22.778878118221954, 21.29690050085385, 21.89016988438864, 21.79692531873782, 32.55423541615406, 32.65848602602878, 32.381320292750985, 23.77594333390394, 23.96668222049871, 24.407721182952315, 20.481744419783354, 20.444857377558947, 20.484852392226458, 20.390813637524843, 20.30085413530469, 20.438979857601225, 26.852693771322564, 27.249149483939007, 26.774067868789032, 27.14869662374258, 27.04981527477503, 26.942396640777588, 20.15892247358957, 20.55181231504926, 19.91826097170511, 20.447814851999283, 21.101959001738578, 20.838243026286364, 18.870125795404107, 18.91035848359266, 18.91966913888851, 20.985924517114952, 21.571848047276333, 21.541498367985085, 33.0207926183939, 32.76304641366005, 33.19115737080574, 18.352935269397364, 17.998065958420426, 17.959613586465508, 27.167032228161887, 27.15855674569805, 26.425634433825806, 25.30919404203692, 25.027421335379273, 25.170723269383103, 26.131811176737145, 26.640412283440426, 26.514879201849297, 19.069606741269425, 19.380658124883965, 19.659937112902597, 7.212875645918146, 7.22818362860319, 7.119137232502297, 11.842348490376025, 11.698425091803074, 11.651405669748783, 18.164170297483594, 18.121966669956834, 18.321632190297038, 25.397160161286592, 25.129927337169647, 25.048293709754944, 19.873583274583012, 19.745022835830838, 19.749030279616505, 26.51909268895784, 26.919728624323994, 26.74112148086229, 29.125995827217892, 28.97018302728732, 29.33305174609025, 22.070482784882188, 22.033445920795202, 21.690852895379066, 27.44254883378744, 27.20392346382141, 27.841537503991276, 22.739370331168175, 23.3436236679554, 23.52405795454979, 25.737855474154145, 25.58334846297899, 25.990084207306296, 25.032086310287312, 25.211320233841732, 25.058702317376927, 17.888828970491886, 17.351353883743286, 18.017136154696345, 22.22374006640166, 21.917453706264496, 21.50925822556019, 26.36946193625529, 26.481122567628816, 26.461391865586236, 23.362128282586724, 23.304438548783452, 23.55571165184179, 13.272923966248825, 13.735365745921925, 14.12068705943723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15772904094279402, "mean_inference_ms": 0.7171669254472601, "mean_action_processing_ms": 0.1010094711648561, "mean_env_wait_ms": 0.824742169828561, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 805896, "timesteps_this_iter": 0, "agent_timesteps_total": 2417688, "timers": {"sample_time_ms": 19242.139, "sample_throughput": 498.593, "load_time_ms": 0.3, "load_throughput": 31944234.799, "learn_time_ms": 2967.08, "learn_throughput": 3233.482, "update_time_ms": 8.247}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.543712854385377e-09, "cur_lr": 0.0005, "total_loss": 6.900163650512695, "policy_loss": 0.0036398586921318477, "vf_loss": 7.022150099277496, "vf_explained_var": 0.03140702843666077, "kl": 0.01073969504805868, "entropy": 12.562624335289001, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 805896, "num_agent_steps_sampled": 2417688, "num_steps_trained": 805896, "num_agent_steps_trained": 2417688, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3476, "training_iteration": 84, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-12-00", "timestamp": 1706191920, "time_this_iter_s": 18.72354245185852, "time_total_s": 1721.1006722450256, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0158A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1721.1006722450256, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 10.557692307692308, "ram_util_percent": 48.80769230769231}}
{"episode_reward_max": 98.99822519253938, "episode_reward_min": 21.560196507023633, "episode_reward_mean": 66.09751055073691, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 7.119137232502297}, "policy_reward_max": {"shared_policy": 33.20203935758521}, "policy_reward_mean": {"shared_policy": 22.0325035169123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.099492032080875, 46.56228218786417, 76.5982907935977, 76.88610713183877, 95.29484393820165, 53.01593460584991, 86.58772215899077, 74.03449160605668, 66.51351213455197, 71.32665642257778, 81.5479322746396, 60.38183803111315, 39.346482984721646, 57.91575392708181, 34.72738913446662, 47.28433786332606, 37.446531388908625, 89.7279633581638, 58.789636559784384, 66.49894943833351, 72.41883993335065, 96.70614222437143, 65.71375211328265, 56.37537805736062, 52.4128554081544, 45.51638439856467, 87.91990110278128, 67.43220928683876, 65.04226804617791, 60.81921902671456, 64.75699645280838, 63.77438442409036, 69.65058717504144, 60.11860776902175, 44.25961217936127, 68.2667569098994, 64.98399570398031, 97.59404173493382, 72.15034673735497, 61.41145418956876, 61.13064763043076, 80.8759111240506, 81.1409085392952, 60.62899576034394, 62.388016880024225, 56.700153417885275, 64.09927093237637, 98.97499640285969, 54.3106148142833, 80.75122340768574, 75.5073386467993, 79.28710266202687, 58.11020197905599, 21.560196507023633, 35.19217925192788, 54.607769157737465, 75.57538120821118, 59.367636390030356, 80.17994279414413, 87.42923060059546, 65.79478160105646, 82.48800980160013, 69.60705195367336, 77.31128814443943, 75.30210886150597, 53.25731900893152, 65.65045199822634, 79.31197636947034, 70.22227848321197, 41.12897677160798, 64.68362368643284, 57.86675101239234, 67.22241249401121, 51.02574107772669, 62.45610012672839, 67.35166506841779, 69.28220841288567, 76.77276945859192, 55.75730786845088, 67.85620548576117, 71.17374492809175, 69.86293702758847, 56.533090817276374, 55.16912094037977, 50.04621990025042, 77.33952579600736, 98.99822519253938, 65.26019139401615, 85.25194173213092, 72.1869581583887, 71.7188609614968, 73.57690360210835, 55.37073185667394, 58.75773373804985, 62.698455747216926, 65.67846863903105, 52.596786275506005, 86.1305491104722, 61.07514813542366, 59.24883448332545], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.32658529778321, 18.342924421032265, 18.4299823132654, 15.729893590634063, 15.511819166441754, 15.320569430788353, 25.31275326758623, 25.548424445092678, 25.73711308091879, 25.584598603347928, 25.787064890066773, 25.51444363842407, 31.60439173628886, 31.698423614104584, 31.992028587808207, 17.276307597756386, 17.91400266881101, 17.825624339282513, 28.872196591148764, 28.693954954544694, 29.021570613297314, 24.810537589093045, 24.659766634305313, 24.564187382658318, 22.23084936539331, 22.27758529285589, 22.005077476302773, 23.702175465722874, 23.60820509244998, 24.016275864404932, 27.259354300796986, 27.48487849533558, 26.803699478507042, 20.018539734184742, 20.195343501865864, 20.167954795062542, 12.940974225600556, 12.942000990112618, 13.463507769008473, 18.719470923145607, 19.771999412526682, 19.42428359140952, 11.627851064006478, 12.015468599895627, 11.084069470564515, 15.94764234622319, 15.519406740864113, 15.817288776238755, 12.31236907839775, 12.357209950685501, 12.776952359825373, 29.987657914559037, 29.76882355908552, 29.97148188451925, 19.577033827702195, 19.604842635492474, 19.607760096589715, 22.20458595827222, 22.007834434509277, 22.286529045552015, 23.96732152501741, 24.343057070548326, 24.108461337784917, 32.28373975306749, 32.20506698638201, 32.21733548492193, 21.995815791810543, 21.96492335634926, 21.75301296512285, 18.77619396398464, 18.850752408305794, 18.748431685070187, 17.659334061356873, 17.40430678303042, 17.349214563767106, 14.877558479706437, 15.56703765752414, 15.071788261334092, 29.427460958560303, 29.330647592743233, 29.161792551477745, 22.61948077504833, 22.476284993191555, 22.33644351859887, 21.444625948866204, 21.736819596340254, 21.86082250097145, 20.218148179352283, 20.11788985133171, 20.48318099603057, 21.682149969041348, 21.323680222034454, 21.75116626173258, 21.154187152783066, 21.233290712038666, 21.386906559268624, 23.163673125207424, 23.101355016231537, 23.385559033602476, 20.416666708498568, 19.739027698834732, 19.96291336168845, 14.71006442358096, 15.127698276502386, 14.421849479277924, 22.681888611366347, 22.8059901803111, 22.778878118221954, 21.29690050085385, 21.89016988438864, 21.79692531873782, 32.55423541615406, 32.65848602602878, 32.381320292750985, 23.77594333390394, 23.96668222049871, 24.407721182952315, 20.481744419783354, 20.444857377558947, 20.484852392226458, 20.390813637524843, 20.30085413530469, 20.438979857601225, 26.852693771322564, 27.249149483939007, 26.774067868789032, 27.14869662374258, 27.04981527477503, 26.942396640777588, 20.15892247358957, 20.55181231504926, 19.91826097170511, 20.447814851999283, 21.101959001738578, 20.838243026286364, 18.870125795404107, 18.91035848359266, 18.91966913888851, 20.985924517114952, 21.571848047276333, 21.541498367985085, 33.0207926183939, 32.76304641366005, 33.19115737080574, 18.352935269397364, 17.998065958420426, 17.959613586465508, 27.167032228161887, 27.15855674569805, 26.425634433825806, 25.30919404203692, 25.027421335379273, 25.170723269383103, 26.131811176737145, 26.640412283440426, 26.514879201849297, 19.069606741269425, 19.380658124883965, 19.659937112902597, 7.212875645918146, 7.22818362860319, 7.119137232502297, 11.842348490376025, 11.698425091803074, 11.651405669748783, 18.164170297483594, 18.121966669956834, 18.321632190297038, 25.397160161286592, 25.129927337169647, 25.048293709754944, 19.873583274583012, 19.745022835830838, 19.749030279616505, 26.51909268895784, 26.919728624323994, 26.74112148086229, 29.125995827217892, 28.97018302728732, 29.33305174609025, 22.070482784882188, 22.033445920795202, 21.690852895379066, 27.44254883378744, 27.20392346382141, 27.841537503991276, 22.739370331168175, 23.3436236679554, 23.52405795454979, 25.737855474154145, 25.58334846297899, 25.990084207306296, 25.032086310287312, 25.211320233841732, 25.058702317376927, 17.888828970491886, 17.351353883743286, 18.017136154696345, 22.22374006640166, 21.917453706264496, 21.50925822556019, 26.36946193625529, 26.481122567628816, 26.461391865586236, 23.362128282586724, 23.304438548783452, 23.55571165184179, 13.272923966248825, 13.735365745921925, 14.12068705943723, 21.524892933666706, 21.253662407398224, 21.90506834536791, 19.234106682240963, 19.186725925654173, 19.445918404497206, 22.103154001136616, 22.506176376094416, 22.613082116780177, 16.722467576464012, 16.98432497431834, 17.31894852694434, 20.651705029110104, 20.824891390899808, 20.979503706718475, 22.55997121334076, 22.545603942126036, 22.246089912950993, 23.132536498829722, 23.10217676125467, 23.047495152801275, 25.574266870816544, 25.47355744739373, 25.72494514038165, 18.645383030176163, 18.570546492934227, 18.54137834534049, 22.648490253835917, 22.70735665783286, 22.500358574092388, 23.41108688463767, 23.90815342155595, 23.85450462189813, 23.384064083298043, 23.574633776520685, 22.904239167769745, 19.024882253104195, 18.54698496808608, 18.9612235960861, 18.47203305984536, 18.01275202135244, 18.68433585918197, 16.687561882038906, 16.617318366964653, 16.74133965124686, 26.022482610773295, 25.78010269999504, 25.53694048523903, 32.99499286835392, 33.20203935758521, 32.801192966600254, 21.933856954798102, 21.86431708186865, 21.462017357349396, 28.49264491504678, 28.375580615053565, 28.38371620203057, 24.133574553454906, 23.955813134709985, 24.097570470223815, 23.66690035412708, 24.079561861852795, 23.972398745516927, 24.653962849949792, 24.31811100741227, 24.604829744746283, 18.451133233805493, 18.389765558143452, 18.529833064724997, 19.638716028382376, 19.579908027624086, 19.53910968204339, 20.775214736660317, 21.425607935835913, 20.497633074720696, 21.84443124383688, 21.763061553239822, 22.07097584195435, 17.608066254605845, 17.348079716165856, 17.640640304734305, 28.728850193321705, 28.82300180196762, 28.578697115182877, 20.160546228289604, 20.54429804906249, 20.370303858071566, 19.93564490477243, 19.50678032139936, 19.80640925715366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15752210032741057, "mean_inference_ms": 0.71665883032042, "mean_action_processing_ms": 0.10095621499261005, "mean_env_wait_ms": 0.8240904672092638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 815490, "timesteps_this_iter": 0, "agent_timesteps_total": 2446470, "timers": {"sample_time_ms": 19209.697, "sample_throughput": 499.435, "load_time_ms": 0.4, "load_throughput": 23968165.213, "learn_time_ms": 2959.459, "learn_throughput": 3241.809, "update_time_ms": 8.347}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.543712854385377e-09, "cur_lr": 0.0005, "total_loss": 6.035117447376251, "policy_loss": 0.007311581396220845, "vf_loss": 6.15643984079361, "vf_explained_var": 0.008467614650726318, "kl": 0.02810838952438527, "entropy": 12.863369584083557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 815490, "num_agent_steps_sampled": 2446470, "num_steps_trained": 815490, "num_agent_steps_trained": 2446470, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3506, "training_iteration": 85, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-12-19", "timestamp": 1706191939, "time_this_iter_s": 18.593914031982422, "time_total_s": 1739.694586277008, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41C64820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1739.694586277008, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.033333333333333, "ram_util_percent": 48.83703703703704}}
{"episode_reward_max": 98.99822519253938, "episode_reward_min": 21.560196507023633, "episode_reward_mean": 66.614937242663, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": 7.119137232502297}, "policy_reward_max": {"shared_policy": 33.20203935758521}, "policy_reward_mean": {"shared_policy": 22.20497908088766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.25961217936127, 68.2667569098994, 64.98399570398031, 97.59404173493382, 72.15034673735497, 61.41145418956876, 61.13064763043076, 80.8759111240506, 81.1409085392952, 60.62899576034394, 62.388016880024225, 56.700153417885275, 64.09927093237637, 98.97499640285969, 54.3106148142833, 80.75122340768574, 75.5073386467993, 79.28710266202687, 58.11020197905599, 21.560196507023633, 35.19217925192788, 54.607769157737465, 75.57538120821118, 59.367636390030356, 80.17994279414413, 87.42923060059546, 65.79478160105646, 82.48800980160013, 69.60705195367336, 77.31128814443943, 75.30210886150597, 53.25731900893152, 65.65045199822634, 79.31197636947034, 70.22227848321197, 41.12897677160798, 64.68362368643284, 57.86675101239234, 67.22241249401121, 51.02574107772669, 62.45610012672839, 67.35166506841779, 69.28220841288567, 76.77276945859192, 55.75730786845088, 67.85620548576117, 71.17374492809175, 69.86293702758847, 56.533090817276374, 55.16912094037977, 50.04621990025042, 77.33952579600736, 98.99822519253938, 65.26019139401615, 85.25194173213092, 72.1869581583887, 71.7188609614968, 73.57690360210835, 55.37073185667394, 58.75773373804985, 62.698455747216926, 65.67846863903105, 52.596786275506005, 86.1305491104722, 61.07514813542366, 59.24883448332545, 54.51435527950525, 59.79054737277326, 59.25309672206639, 61.71814629621802, 65.36114930175245, 63.251394443213925, 58.56547373533249, 75.28372632339594, 56.958757469430566, 73.55559937655924, 82.03518115542826, 80.79072630032897, 79.92915313038975, 62.76144714653492, 60.75731109827757, 67.78873249888417, 51.37839101999997, 77.44785479456183, 54.566009588539586, 70.9033166617155, 53.58819066733119, 64.91140475589779, 71.87586868554354, 53.528681136667714, 78.62141252867876, 67.26470410823822, 75.72194759920238, 50.0797780267894, 59.66740689845753, 77.31131075881419, 73.0080153569579, 74.79102416336534, 61.6847195960581, 77.3215085864067], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [14.71006442358096, 15.127698276502386, 14.421849479277924, 22.681888611366347, 22.8059901803111, 22.778878118221954, 21.29690050085385, 21.89016988438864, 21.79692531873782, 32.55423541615406, 32.65848602602878, 32.381320292750985, 23.77594333390394, 23.96668222049871, 24.407721182952315, 20.481744419783354, 20.444857377558947, 20.484852392226458, 20.390813637524843, 20.30085413530469, 20.438979857601225, 26.852693771322564, 27.249149483939007, 26.774067868789032, 27.14869662374258, 27.04981527477503, 26.942396640777588, 20.15892247358957, 20.55181231504926, 19.91826097170511, 20.447814851999283, 21.101959001738578, 20.838243026286364, 18.870125795404107, 18.91035848359266, 18.91966913888851, 20.985924517114952, 21.571848047276333, 21.541498367985085, 33.0207926183939, 32.76304641366005, 33.19115737080574, 18.352935269397364, 17.998065958420426, 17.959613586465508, 27.167032228161887, 27.15855674569805, 26.425634433825806, 25.30919404203692, 25.027421335379273, 25.170723269383103, 26.131811176737145, 26.640412283440426, 26.514879201849297, 19.069606741269425, 19.380658124883965, 19.659937112902597, 7.212875645918146, 7.22818362860319, 7.119137232502297, 11.842348490376025, 11.698425091803074, 11.651405669748783, 18.164170297483594, 18.121966669956834, 18.321632190297038, 25.397160161286592, 25.129927337169647, 25.048293709754944, 19.873583274583012, 19.745022835830838, 19.749030279616505, 26.51909268895784, 26.919728624323994, 26.74112148086229, 29.125995827217892, 28.97018302728732, 29.33305174609025, 22.070482784882188, 22.033445920795202, 21.690852895379066, 27.44254883378744, 27.20392346382141, 27.841537503991276, 22.739370331168175, 23.3436236679554, 23.52405795454979, 25.737855474154145, 25.58334846297899, 25.990084207306296, 25.032086310287312, 25.211320233841732, 25.058702317376927, 17.888828970491886, 17.351353883743286, 18.017136154696345, 22.22374006640166, 21.917453706264496, 21.50925822556019, 26.36946193625529, 26.481122567628816, 26.461391865586236, 23.362128282586724, 23.304438548783452, 23.55571165184179, 13.272923966248825, 13.735365745921925, 14.12068705943723, 21.524892933666706, 21.253662407398224, 21.90506834536791, 19.234106682240963, 19.186725925654173, 19.445918404497206, 22.103154001136616, 22.506176376094416, 22.613082116780177, 16.722467576464012, 16.98432497431834, 17.31894852694434, 20.651705029110104, 20.824891390899808, 20.979503706718475, 22.55997121334076, 22.545603942126036, 22.246089912950993, 23.132536498829722, 23.10217676125467, 23.047495152801275, 25.574266870816544, 25.47355744739373, 25.72494514038165, 18.645383030176163, 18.570546492934227, 18.54137834534049, 22.648490253835917, 22.70735665783286, 22.500358574092388, 23.41108688463767, 23.90815342155595, 23.85450462189813, 23.384064083298043, 23.574633776520685, 22.904239167769745, 19.024882253104195, 18.54698496808608, 18.9612235960861, 18.47203305984536, 18.01275202135244, 18.68433585918197, 16.687561882038906, 16.617318366964653, 16.74133965124686, 26.022482610773295, 25.78010269999504, 25.53694048523903, 32.99499286835392, 33.20203935758521, 32.801192966600254, 21.933856954798102, 21.86431708186865, 21.462017357349396, 28.49264491504678, 28.375580615053565, 28.38371620203057, 24.133574553454906, 23.955813134709985, 24.097570470223815, 23.66690035412708, 24.079561861852795, 23.972398745516927, 24.653962849949792, 24.31811100741227, 24.604829744746283, 18.451133233805493, 18.389765558143452, 18.529833064724997, 19.638716028382376, 19.579908027624086, 19.53910968204339, 20.775214736660317, 21.425607935835913, 20.497633074720696, 21.84443124383688, 21.763061553239822, 22.07097584195435, 17.608066254605845, 17.348079716165856, 17.640640304734305, 28.728850193321705, 28.82300180196762, 28.578697115182877, 20.160546228289604, 20.54429804906249, 20.370303858071566, 19.93564490477243, 19.50678032139936, 19.80640925715366, 18.151793278753757, 18.046968527138233, 18.315593473613262, 19.804673897723347, 20.281648714716226, 19.704224760333688, 19.657392685612038, 19.8704398771127, 19.72526415934165, 20.37378418197234, 20.551611361404255, 20.792750752841428, 21.60298202186823, 21.650575324892998, 22.10759195499122, 21.433217463394, 20.977410351236657, 20.840766628583268, 19.530370499938726, 19.43392141163349, 19.60118182376027, 25.4509897964696, 24.76328211526075, 25.06945441166559, 18.970013666898012, 18.84503261744976, 19.143711185082793, 24.28914641340573, 24.688751374681786, 24.577701588471726, 27.005215937892586, 27.573240873093397, 27.45672434444228, 26.577003002166748, 27.197586130350828, 27.016137167811394, 26.748977742157876, 26.68044582568109, 26.499729562550783, 20.752133831381798, 20.98428885638714, 21.025024458765984, 19.919706284999847, 20.585158430039883, 20.25244638323784, 22.95163022975126, 21.784130732218415, 23.052971536914498, 17.364329387744263, 16.60348295172055, 17.410578680535153, 25.85112166653076, 25.605780790249497, 25.99095233778158, 18.51731566836436, 17.955909987290696, 18.09278393288453, 23.73481848587592, 23.739302170773342, 23.42919600506623, 17.93875244508186, 18.155513713757188, 17.493924508492142, 21.290232742826134, 21.94274766712138, 21.678424345950276, 24.24002230912447, 23.71033799648285, 23.92550837993622, 17.637086783846215, 18.002853592236832, 17.888740760584668, 25.9937470977505, 26.44591794473429, 26.18174748619397, 21.975257694721222, 22.410190626978874, 22.879255786538124, 25.288758927335337, 25.421265472968415, 25.01192319889863, 16.601835074524075, 16.619041370848805, 16.858901581416518, 20.21487635296458, 19.397946442166955, 20.054584103325993, 25.65151086697975, 26.136755847061664, 25.523044044772774, 24.19210162510474, 24.458074015875653, 24.357839715977505, 24.882239610577614, 24.893328272427112, 25.01545628036061, 20.103511075178773, 20.64598714063564, 20.93522138024369, 25.796198566754654, 26.024406423171357, 25.500903596480683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15723369226969702, "mean_inference_ms": 0.7156489324853342, "mean_action_processing_ms": 0.10088242836966359, "mean_env_wait_ms": 0.8231297579946871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 825084, "timesteps_this_iter": 0, "agent_timesteps_total": 2475252, "timers": {"sample_time_ms": 19037.819, "sample_throughput": 503.944, "load_time_ms": 0.3, "load_throughput": 31961995.692, "learn_time_ms": 2941.49, "learn_throughput": 3261.612, "update_time_ms": 8.296}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1315569281578066e-08, "cur_lr": 0.0005, "total_loss": 4.938533782958984, "policy_loss": 0.0004992438354565198, "vf_loss": 5.0666380524635315, "vf_explained_var": 0.06212758272886276, "kl": 0.0060934838839932295, "entropy": 12.86034870147705, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 825084, "num_agent_steps_sampled": 2475252, "num_steps_trained": 825084, "num_agent_steps_trained": 2475252, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3540, "training_iteration": 86, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-12-37", "timestamp": 1706191957, "time_this_iter_s": 18.318256378173828, "time_total_s": 1758.0128426551819, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1758.0128426551819, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.515384615384615, "ram_util_percent": 48.93461538461538}}
{"episode_reward_max": 98.99822519253938, "episode_reward_min": 38.59095302829519, "episode_reward_mean": 65.82144559135136, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 12.60309910774231}, "policy_reward_max": {"shared_policy": 33.20203935758521}, "policy_reward_mean": {"shared_policy": 21.940481863783784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.25731900893152, 65.65045199822634, 79.31197636947034, 70.22227848321197, 41.12897677160798, 64.68362368643284, 57.86675101239234, 67.22241249401121, 51.02574107772669, 62.45610012672839, 67.35166506841779, 69.28220841288567, 76.77276945859192, 55.75730786845088, 67.85620548576117, 71.17374492809175, 69.86293702758847, 56.533090817276374, 55.16912094037977, 50.04621990025042, 77.33952579600736, 98.99822519253938, 65.26019139401615, 85.25194173213092, 72.1869581583887, 71.7188609614968, 73.57690360210835, 55.37073185667394, 58.75773373804985, 62.698455747216926, 65.67846863903105, 52.596786275506005, 86.1305491104722, 61.07514813542366, 59.24883448332545, 54.51435527950525, 59.79054737277326, 59.25309672206639, 61.71814629621802, 65.36114930175245, 63.251394443213925, 58.56547373533249, 75.28372632339594, 56.958757469430566, 73.55559937655924, 82.03518115542826, 80.79072630032897, 79.92915313038975, 62.76144714653492, 60.75731109827757, 67.78873249888417, 51.37839101999997, 77.44785479456183, 54.566009588539586, 70.9033166617155, 53.58819066733119, 64.91140475589779, 71.87586868554354, 53.528681136667714, 78.62141252867876, 67.26470410823822, 75.72194759920238, 50.0797780267894, 59.66740689845753, 77.31131075881419, 73.0080153569579, 74.79102416336534, 61.6847195960581, 77.3215085864067, 76.29942845925687, 88.68303864449263, 63.72900791466236, 61.477216266095624, 62.28929191082713, 69.14079921069786, 55.4558449424803, 60.16476132720709, 75.84014045819637, 61.67070250585675, 86.11391801759599, 49.25839276425539, 76.29863594844934, 92.75838358479086, 64.38147035799919, 43.0483041796833, 59.028570666909204, 48.5195871768519, 58.842226890148595, 80.57525986339895, 66.88865628838539, 38.59095302829519, 58.82019215077159, 46.6322116218507, 56.4038599282503, 59.13103075744584, 87.54062653705476, 91.15734409168363, 70.14888982102272, 48.59414257109162, 70.15511290729044], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.888828970491886, 17.351353883743286, 18.017136154696345, 22.22374006640166, 21.917453706264496, 21.50925822556019, 26.36946193625529, 26.481122567628816, 26.461391865586236, 23.362128282586724, 23.304438548783452, 23.55571165184179, 13.272923966248825, 13.735365745921925, 14.12068705943723, 21.524892933666706, 21.253662407398224, 21.90506834536791, 19.234106682240963, 19.186725925654173, 19.445918404497206, 22.103154001136616, 22.506176376094416, 22.613082116780177, 16.722467576464012, 16.98432497431834, 17.31894852694434, 20.651705029110104, 20.824891390899808, 20.979503706718475, 22.55997121334076, 22.545603942126036, 22.246089912950993, 23.132536498829722, 23.10217676125467, 23.047495152801275, 25.574266870816544, 25.47355744739373, 25.72494514038165, 18.645383030176163, 18.570546492934227, 18.54137834534049, 22.648490253835917, 22.70735665783286, 22.500358574092388, 23.41108688463767, 23.90815342155595, 23.85450462189813, 23.384064083298043, 23.574633776520685, 22.904239167769745, 19.024882253104195, 18.54698496808608, 18.9612235960861, 18.47203305984536, 18.01275202135244, 18.68433585918197, 16.687561882038906, 16.617318366964653, 16.74133965124686, 26.022482610773295, 25.78010269999504, 25.53694048523903, 32.99499286835392, 33.20203935758521, 32.801192966600254, 21.933856954798102, 21.86431708186865, 21.462017357349396, 28.49264491504678, 28.375580615053565, 28.38371620203057, 24.133574553454906, 23.955813134709985, 24.097570470223815, 23.66690035412708, 24.079561861852795, 23.972398745516927, 24.653962849949792, 24.31811100741227, 24.604829744746283, 18.451133233805493, 18.389765558143452, 18.529833064724997, 19.638716028382376, 19.579908027624086, 19.53910968204339, 20.775214736660317, 21.425607935835913, 20.497633074720696, 21.84443124383688, 21.763061553239822, 22.07097584195435, 17.608066254605845, 17.348079716165856, 17.640640304734305, 28.728850193321705, 28.82300180196762, 28.578697115182877, 20.160546228289604, 20.54429804906249, 20.370303858071566, 19.93564490477243, 19.50678032139936, 19.80640925715366, 18.151793278753757, 18.046968527138233, 18.315593473613262, 19.804673897723347, 20.281648714716226, 19.704224760333688, 19.657392685612038, 19.8704398771127, 19.72526415934165, 20.37378418197234, 20.551611361404255, 20.792750752841428, 21.60298202186823, 21.650575324892998, 22.10759195499122, 21.433217463394, 20.977410351236657, 20.840766628583268, 19.530370499938726, 19.43392141163349, 19.60118182376027, 25.4509897964696, 24.76328211526075, 25.06945441166559, 18.970013666898012, 18.84503261744976, 19.143711185082793, 24.28914641340573, 24.688751374681786, 24.577701588471726, 27.005215937892586, 27.573240873093397, 27.45672434444228, 26.577003002166748, 27.197586130350828, 27.016137167811394, 26.748977742157876, 26.68044582568109, 26.499729562550783, 20.752133831381798, 20.98428885638714, 21.025024458765984, 19.919706284999847, 20.585158430039883, 20.25244638323784, 22.95163022975126, 21.784130732218415, 23.052971536914498, 17.364329387744263, 16.60348295172055, 17.410578680535153, 25.85112166653076, 25.605780790249497, 25.99095233778158, 18.51731566836436, 17.955909987290696, 18.09278393288453, 23.73481848587592, 23.739302170773342, 23.42919600506623, 17.93875244508186, 18.155513713757188, 17.493924508492142, 21.290232742826134, 21.94274766712138, 21.678424345950276, 24.24002230912447, 23.71033799648285, 23.92550837993622, 17.637086783846215, 18.002853592236832, 17.888740760584668, 25.9937470977505, 26.44591794473429, 26.18174748619397, 21.975257694721222, 22.410190626978874, 22.879255786538124, 25.288758927335337, 25.421265472968415, 25.01192319889863, 16.601835074524075, 16.619041370848805, 16.858901581416518, 20.21487635296458, 19.397946442166955, 20.054584103325993, 25.65151086697975, 26.136755847061664, 25.523044044772774, 24.19210162510474, 24.458074015875653, 24.357839715977505, 24.882239610577614, 24.893328272427112, 25.01545628036061, 20.103511075178773, 20.64598714063564, 20.93522138024369, 25.796198566754654, 26.024406423171357, 25.500903596480683, 25.096793194611863, 25.624935814489916, 25.577699450155094, 29.423567041754723, 29.527181074023247, 29.732290528714657, 21.362889017909765, 21.290235836058855, 21.07588306069374, 20.309035172065094, 20.529457991321877, 20.638723102708653, 20.574966082970292, 20.67717746893564, 21.0371483589212, 22.97945238401492, 22.819450495143727, 23.341896331539218, 18.56340356792012, 18.34955061475435, 18.54289075980583, 20.31256215274334, 19.862509571015835, 19.989689603447914, 25.035503583649785, 25.413641494388372, 25.390995380158216, 20.44975458830595, 20.55280662328005, 20.668141294270754, 28.751647492249802, 28.53285791476567, 28.82941261058052, 16.66880135548611, 16.067955439289406, 16.521635969479874, 25.195699157814175, 25.468934318671614, 25.634002471963555, 31.100956106209196, 30.76900179684162, 30.888425681740046, 21.516443948571876, 21.447126158823565, 21.41790025060375, 14.454433244342596, 14.28394569704929, 14.309925238291413, 19.674181272586182, 19.800780345996216, 19.553609048326805, 15.98703811566034, 16.326700580927223, 16.205848480264336, 20.109454279066995, 19.649471692740917, 19.083300918340683, 26.9265944774573, 26.855696582545832, 26.792968803395823, 22.542298395186663, 21.969692423939705, 22.376665469259024, 12.758598312735558, 13.229255607817322, 12.60309910774231, 19.898061121503503, 19.3907840574781, 19.531346971789986, 15.652421270186693, 15.207787896196038, 15.77200245546797, 18.7071352576216, 18.804839750130967, 18.89188492049773, 19.411177538335323, 19.78619096428156, 19.93366225482896, 29.19957337652643, 29.136709680159882, 29.20434348036845, 30.21086010336876, 30.348753921687603, 30.597730066627264, 23.462349756310374, 23.563140893975884, 23.123399170736462, 16.40548440317312, 16.083117338518292, 16.105540829400212, 23.48104665552576, 23.4664748845001, 23.207591367264584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1569623183908695, "mean_inference_ms": 0.7148479470678447, "mean_action_processing_ms": 0.10082449267157272, "mean_env_wait_ms": 0.8223666350078027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 834678, "timesteps_this_iter": 0, "agent_timesteps_total": 2504034, "timers": {"sample_time_ms": 18857.289, "sample_throughput": 508.769, "load_time_ms": 0.3, "load_throughput": 31961995.692, "learn_time_ms": 2924.037, "learn_throughput": 3281.08, "update_time_ms": 8.695}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1315569281578066e-08, "cur_lr": 0.0005, "total_loss": 5.5959689021110535, "policy_loss": -0.00023455988402221184, "vf_loss": 5.72582620382309, "vf_explained_var": 0.027074910700321198, "kl": 0.00514290714647292, "entropy": 12.962274074554443, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 834678, "num_agent_steps_sampled": 2504034, "num_steps_trained": 834678, "num_agent_steps_trained": 2504034, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3571, "training_iteration": 87, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-12-56", "timestamp": 1706191976, "time_this_iter_s": 18.696202278137207, "time_total_s": 1776.709044933319, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1776.709044933319, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 6.123076923076923, "ram_util_percent": 48.97692307692308}}
{"episode_reward_max": 92.75838358479086, "episode_reward_min": 33.10023254901169, "episode_reward_mean": 66.10436809480132, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 10.592221279939011}, "policy_reward_max": {"shared_policy": 31.100956106209196}, "policy_reward_mean": {"shared_policy": 22.03478936493377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.1305491104722, 61.07514813542366, 59.24883448332545, 54.51435527950525, 59.79054737277326, 59.25309672206639, 61.71814629621802, 65.36114930175245, 63.251394443213925, 58.56547373533249, 75.28372632339594, 56.958757469430566, 73.55559937655924, 82.03518115542826, 80.79072630032897, 79.92915313038975, 62.76144714653492, 60.75731109827757, 67.78873249888417, 51.37839101999997, 77.44785479456183, 54.566009588539586, 70.9033166617155, 53.58819066733119, 64.91140475589779, 71.87586868554354, 53.528681136667714, 78.62141252867876, 67.26470410823822, 75.72194759920238, 50.0797780267894, 59.66740689845753, 77.31131075881419, 73.0080153569579, 74.79102416336534, 61.6847195960581, 77.3215085864067, 76.29942845925687, 88.68303864449263, 63.72900791466236, 61.477216266095624, 62.28929191082713, 69.14079921069786, 55.4558449424803, 60.16476132720709, 75.84014045819637, 61.67070250585675, 86.11391801759599, 49.25839276425539, 76.29863594844934, 92.75838358479086, 64.38147035799919, 43.0483041796833, 59.028570666909204, 48.5195871768519, 58.842226890148595, 80.57525986339895, 66.88865628838539, 38.59095302829519, 58.82019215077159, 46.6322116218507, 56.4038599282503, 59.13103075744584, 87.54062653705476, 91.15734409168363, 70.14888982102272, 48.59414257109162, 70.15511290729044, 86.15300401579587, 80.31090730428693, 66.04300342872737, 63.944646134972544, 49.99801879934964, 71.54443554393946, 66.86273028235881, 50.11882542073724, 66.22997047752142, 76.65463944897054, 65.01997503638268, 74.93650157377124, 66.73631176352498, 71.57113024778661, 68.68371810019016, 69.36949764471501, 65.62854033708571, 66.46844869852063, 73.11444981396197, 80.22797822579739, 73.18938800599426, 56.75351266376674, 85.94416099414228, 55.212979911128045, 41.19762899726629, 67.98846052028237, 58.03897529095411, 33.10023254901169, 71.06258684024212, 73.4448544550687, 59.25885393284261, 65.54956791549918], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.728850193321705, 28.82300180196762, 28.578697115182877, 20.160546228289604, 20.54429804906249, 20.370303858071566, 19.93564490477243, 19.50678032139936, 19.80640925715366, 18.151793278753757, 18.046968527138233, 18.315593473613262, 19.804673897723347, 20.281648714716226, 19.704224760333688, 19.657392685612038, 19.8704398771127, 19.72526415934165, 20.37378418197234, 20.551611361404255, 20.792750752841428, 21.60298202186823, 21.650575324892998, 22.10759195499122, 21.433217463394, 20.977410351236657, 20.840766628583268, 19.530370499938726, 19.43392141163349, 19.60118182376027, 25.4509897964696, 24.76328211526075, 25.06945441166559, 18.970013666898012, 18.84503261744976, 19.143711185082793, 24.28914641340573, 24.688751374681786, 24.577701588471726, 27.005215937892586, 27.573240873093397, 27.45672434444228, 26.577003002166748, 27.197586130350828, 27.016137167811394, 26.748977742157876, 26.68044582568109, 26.499729562550783, 20.752133831381798, 20.98428885638714, 21.025024458765984, 19.919706284999847, 20.585158430039883, 20.25244638323784, 22.95163022975126, 21.784130732218415, 23.052971536914498, 17.364329387744263, 16.60348295172055, 17.410578680535153, 25.85112166653076, 25.605780790249497, 25.99095233778158, 18.51731566836436, 17.955909987290696, 18.09278393288453, 23.73481848587592, 23.739302170773342, 23.42919600506623, 17.93875244508186, 18.155513713757188, 17.493924508492142, 21.290232742826134, 21.94274766712138, 21.678424345950276, 24.24002230912447, 23.71033799648285, 23.92550837993622, 17.637086783846215, 18.002853592236832, 17.888740760584668, 25.9937470977505, 26.44591794473429, 26.18174748619397, 21.975257694721222, 22.410190626978874, 22.879255786538124, 25.288758927335337, 25.421265472968415, 25.01192319889863, 16.601835074524075, 16.619041370848805, 16.858901581416518, 20.21487635296458, 19.397946442166955, 20.054584103325993, 25.65151086697975, 26.136755847061664, 25.523044044772774, 24.19210162510474, 24.458074015875653, 24.357839715977505, 24.882239610577614, 24.893328272427112, 25.01545628036061, 20.103511075178773, 20.64598714063564, 20.93522138024369, 25.796198566754654, 26.024406423171357, 25.500903596480683, 25.096793194611863, 25.624935814489916, 25.577699450155094, 29.423567041754723, 29.527181074023247, 29.732290528714657, 21.362889017909765, 21.290235836058855, 21.07588306069374, 20.309035172065094, 20.529457991321877, 20.638723102708653, 20.574966082970292, 20.67717746893564, 21.0371483589212, 22.97945238401492, 22.819450495143727, 23.341896331539218, 18.56340356792012, 18.34955061475435, 18.54289075980583, 20.31256215274334, 19.862509571015835, 19.989689603447914, 25.035503583649785, 25.413641494388372, 25.390995380158216, 20.44975458830595, 20.55280662328005, 20.668141294270754, 28.751647492249802, 28.53285791476567, 28.82941261058052, 16.66880135548611, 16.067955439289406, 16.521635969479874, 25.195699157814175, 25.468934318671614, 25.634002471963555, 31.100956106209196, 30.76900179684162, 30.888425681740046, 21.516443948571876, 21.447126158823565, 21.41790025060375, 14.454433244342596, 14.28394569704929, 14.309925238291413, 19.674181272586182, 19.800780345996216, 19.553609048326805, 15.98703811566034, 16.326700580927223, 16.205848480264336, 20.109454279066995, 19.649471692740917, 19.083300918340683, 26.9265944774573, 26.855696582545832, 26.792968803395823, 22.542298395186663, 21.969692423939705, 22.376665469259024, 12.758598312735558, 13.229255607817322, 12.60309910774231, 19.898061121503503, 19.3907840574781, 19.531346971789986, 15.652421270186693, 15.207787896196038, 15.77200245546797, 18.7071352576216, 18.804839750130967, 18.89188492049773, 19.411177538335323, 19.78619096428156, 19.93366225482896, 29.19957337652643, 29.136709680159882, 29.20434348036845, 30.21086010336876, 30.348753921687603, 30.597730066627264, 23.462349756310374, 23.563140893975884, 23.123399170736462, 16.40548440317312, 16.083117338518292, 16.105540829400212, 23.48104665552576, 23.4664748845001, 23.207591367264584, 28.792601649959877, 28.976143941593662, 28.384258424242333, 26.084917465845734, 26.938492784897477, 27.287497053543717, 22.15437714134653, 22.07091076423724, 21.817715523143605, 21.18665454785028, 21.328087801734597, 21.429903785387665, 16.85195762726167, 16.654993454615266, 16.491067717472703, 23.407408510645226, 24.012143890683845, 24.124883142610386, 22.22171266128619, 22.094055717190102, 22.54696190388252, 16.697299512724072, 16.574260550240666, 16.8472653577725, 21.261498749256134, 22.452468879520893, 22.516002848744392, 25.673629970600203, 25.652795446415738, 25.3282140319546, 21.63520833849907, 21.640948712825775, 21.74381798505783, 24.524005100131035, 25.01524270325899, 25.397253770381212, 21.866699332992226, 22.50352960700789, 22.366082823524863, 23.60255532215038, 23.89279270793, 24.075782217706234, 22.775352023541927, 23.226699627935886, 22.68166644871235, 22.922347143292427, 22.95849497616291, 23.488655525259674, 22.11559574057658, 21.69035120805104, 21.82259338845809, 22.30865168819824, 22.13070164869228, 22.029095361630112, 24.459549394746617, 24.33724859853585, 24.3176518206795, 26.63588115821281, 26.755387688676507, 26.83670937890807, 24.211764708161354, 24.41325193271041, 24.564371365122497, 19.091694198548794, 19.165727293118834, 18.496091172099113, 28.300398280223206, 28.644076091547802, 28.99968662237127, 18.303240237136677, 18.322451670964554, 18.587288003026813, 13.67864017188549, 13.595696322619915, 13.923292502760887, 22.73760570523639, 22.720169884463147, 22.530684930582837, 19.400700502097607, 19.20143833756447, 19.436836451292038, 11.132779714961842, 11.37523155411084, 10.592221279939011, 23.79134331891933, 23.914485751340777, 23.35675776998201, 24.33424849559863, 24.454093878467873, 24.65651208100219, 19.865909330546856, 20.225634900853038, 19.16730970144272, 21.53447603682676, 21.78414838264385, 22.230943496028573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15668812303986462, "mean_inference_ms": 0.7139932758535197, "mean_action_processing_ms": 0.10071251728982204, "mean_env_wait_ms": 0.8215458981692558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 844272, "timesteps_this_iter": 0, "agent_timesteps_total": 2532816, "timers": {"sample_time_ms": 18791.552, "sample_throughput": 510.549, "load_time_ms": 0.2, "load_throughput": 47933475.373, "learn_time_ms": 2924.756, "learn_throughput": 3280.273, "update_time_ms": 8.702}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1315569281578066e-08, "cur_lr": 0.0005, "total_loss": 5.9934967160224915, "policy_loss": 0.0004103072985723877, "vf_loss": 6.1225005984306335, "vf_explained_var": 0.05350325256586075, "kl": 0.0049303408596807746, "entropy": 12.941434264183044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 844272, "num_agent_steps_sampled": 2532816, "num_steps_trained": 844272, "num_agent_steps_trained": 2532816, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3603, "training_iteration": 88, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-13-15", "timestamp": 1706191995, "time_this_iter_s": 18.939736366271973, "time_total_s": 1795.648781299591, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA016889D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1795.648781299591, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 9.10740740740741, "ram_util_percent": 49.022222222222226}}
{"episode_reward_max": 92.75838358479086, "episode_reward_min": 33.10023254901169, "episode_reward_mean": 66.80210620627331, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 10.592221279939011}, "policy_reward_max": {"shared_policy": 31.100956106209196}, "policy_reward_mean": {"shared_policy": 22.26736873542443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.31131075881419, 73.0080153569579, 74.79102416336534, 61.6847195960581, 77.3215085864067, 76.29942845925687, 88.68303864449263, 63.72900791466236, 61.477216266095624, 62.28929191082713, 69.14079921069786, 55.4558449424803, 60.16476132720709, 75.84014045819637, 61.67070250585675, 86.11391801759599, 49.25839276425539, 76.29863594844934, 92.75838358479086, 64.38147035799919, 43.0483041796833, 59.028570666909204, 48.5195871768519, 58.842226890148595, 80.57525986339895, 66.88865628838539, 38.59095302829519, 58.82019215077159, 46.6322116218507, 56.4038599282503, 59.13103075744584, 87.54062653705476, 91.15734409168363, 70.14888982102272, 48.59414257109162, 70.15511290729044, 86.15300401579587, 80.31090730428693, 66.04300342872737, 63.944646134972544, 49.99801879934964, 71.54443554393946, 66.86273028235881, 50.11882542073724, 66.22997047752142, 76.65463944897054, 65.01997503638268, 74.93650157377124, 66.73631176352498, 71.57113024778661, 68.68371810019016, 69.36949764471501, 65.62854033708571, 66.46844869852063, 73.11444981396197, 80.22797822579739, 73.18938800599426, 56.75351266376674, 85.94416099414228, 55.212979911128045, 41.19762899726629, 67.98846052028237, 58.03897529095411, 33.10023254901169, 71.06258684024212, 73.4448544550687, 59.25885393284261, 65.54956791549918, 42.587726209778324, 80.54532647877932, 45.7656190767884, 53.184524759650216, 70.32490293681622, 69.5067894583335, 74.55469996109603, 60.663184449076624, 52.56040052883324, 55.836316897068144, 42.66171471774578, 73.26584770157932, 86.41299039125443, 83.73510639369485, 71.67846715822813, 79.05252949893473, 84.56820399686691, 87.28749772906303, 65.87959391623735, 60.62735651899129, 72.95996149117127, 73.09973893687126, 85.91784355044364, 63.34348471369593, 52.45300195366144, 62.59592685382813, 89.63331314735112, 79.73290638998148, 58.1256477732677, 69.55116999521852, 45.98106178641318, 74.00525162741542], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.65151086697975, 26.136755847061664, 25.523044044772774, 24.19210162510474, 24.458074015875653, 24.357839715977505, 24.882239610577614, 24.893328272427112, 25.01545628036061, 20.103511075178773, 20.64598714063564, 20.93522138024369, 25.796198566754654, 26.024406423171357, 25.500903596480683, 25.096793194611863, 25.624935814489916, 25.577699450155094, 29.423567041754723, 29.527181074023247, 29.732290528714657, 21.362889017909765, 21.290235836058855, 21.07588306069374, 20.309035172065094, 20.529457991321877, 20.638723102708653, 20.574966082970292, 20.67717746893564, 21.0371483589212, 22.97945238401492, 22.819450495143727, 23.341896331539218, 18.56340356792012, 18.34955061475435, 18.54289075980583, 20.31256215274334, 19.862509571015835, 19.989689603447914, 25.035503583649785, 25.413641494388372, 25.390995380158216, 20.44975458830595, 20.55280662328005, 20.668141294270754, 28.751647492249802, 28.53285791476567, 28.82941261058052, 16.66880135548611, 16.067955439289406, 16.521635969479874, 25.195699157814175, 25.468934318671614, 25.634002471963555, 31.100956106209196, 30.76900179684162, 30.888425681740046, 21.516443948571876, 21.447126158823565, 21.41790025060375, 14.454433244342596, 14.28394569704929, 14.309925238291413, 19.674181272586182, 19.800780345996216, 19.553609048326805, 15.98703811566034, 16.326700580927223, 16.205848480264336, 20.109454279066995, 19.649471692740917, 19.083300918340683, 26.9265944774573, 26.855696582545832, 26.792968803395823, 22.542298395186663, 21.969692423939705, 22.376665469259024, 12.758598312735558, 13.229255607817322, 12.60309910774231, 19.898061121503503, 19.3907840574781, 19.531346971789986, 15.652421270186693, 15.207787896196038, 15.77200245546797, 18.7071352576216, 18.804839750130967, 18.89188492049773, 19.411177538335323, 19.78619096428156, 19.93366225482896, 29.19957337652643, 29.136709680159882, 29.20434348036845, 30.21086010336876, 30.348753921687603, 30.597730066627264, 23.462349756310374, 23.563140893975884, 23.123399170736462, 16.40548440317312, 16.083117338518292, 16.105540829400212, 23.48104665552576, 23.4664748845001, 23.207591367264584, 28.792601649959877, 28.976143941593662, 28.384258424242333, 26.084917465845734, 26.938492784897477, 27.287497053543717, 22.15437714134653, 22.07091076423724, 21.817715523143605, 21.18665454785028, 21.328087801734597, 21.429903785387665, 16.85195762726167, 16.654993454615266, 16.491067717472703, 23.407408510645226, 24.012143890683845, 24.124883142610386, 22.22171266128619, 22.094055717190102, 22.54696190388252, 16.697299512724072, 16.574260550240666, 16.8472653577725, 21.261498749256134, 22.452468879520893, 22.516002848744392, 25.673629970600203, 25.652795446415738, 25.3282140319546, 21.63520833849907, 21.640948712825775, 21.74381798505783, 24.524005100131035, 25.01524270325899, 25.397253770381212, 21.866699332992226, 22.50352960700789, 22.366082823524863, 23.60255532215038, 23.89279270793, 24.075782217706234, 22.775352023541927, 23.226699627935886, 22.68166644871235, 22.922347143292427, 22.95849497616291, 23.488655525259674, 22.11559574057658, 21.69035120805104, 21.82259338845809, 22.30865168819824, 22.13070164869228, 22.029095361630112, 24.459549394746617, 24.33724859853585, 24.3176518206795, 26.63588115821281, 26.755387688676507, 26.83670937890807, 24.211764708161354, 24.41325193271041, 24.564371365122497, 19.091694198548794, 19.165727293118834, 18.496091172099113, 28.300398280223206, 28.644076091547802, 28.99968662237127, 18.303240237136677, 18.322451670964554, 18.587288003026813, 13.67864017188549, 13.595696322619915, 13.923292502760887, 22.73760570523639, 22.720169884463147, 22.530684930582837, 19.400700502097607, 19.20143833756447, 19.436836451292038, 11.132779714961842, 11.37523155411084, 10.592221279939011, 23.79134331891933, 23.914485751340777, 23.35675776998201, 24.33424849559863, 24.454093878467873, 24.65651208100219, 19.865909330546856, 20.225634900853038, 19.16730970144272, 21.53447603682676, 21.78414838264385, 22.230943496028573, 14.171170014267162, 14.136487012108162, 14.280069183403, 26.56987012922764, 26.965336721390486, 27.010119628161192, 15.27513939390579, 15.198774370054394, 15.291705312828213, 18.02833641072114, 17.67726721366246, 17.478921135266617, 23.100478410720825, 23.57813097909093, 23.64629354700446, 22.784605865677193, 23.175807950397328, 23.54637564225898, 24.82054781292875, 24.905370866258934, 24.82878128190835, 20.211479576925427, 20.32796687136093, 20.12373800079027, 17.118480573097855, 17.79500911446908, 17.646910841266305, 18.539754434178263, 18.753691991015017, 18.542870471874863, 14.234786789864302, 14.33860008791089, 14.088327839970589, 24.67790176098545, 24.18795886387427, 24.399987076719597, 28.948005512356758, 28.94547961652279, 28.519505262374878, 27.916835388789565, 27.82190457979837, 27.996366425106913, 23.897541912893445, 23.91030866901079, 23.870616576323897, 26.336873178680733, 26.386063178380326, 26.329593141873673, 27.67284923295179, 28.483022424081952, 28.41233233983317, 29.136977687478065, 29.15615674853325, 28.99436329305172, 21.905035108327866, 21.940432276576757, 22.03412653133273, 19.994258001446724, 19.935055688023567, 20.698042829521, 24.420309277251363, 24.085686333477497, 24.45396588044241, 24.14084332684675, 24.658031209061534, 24.30086440096298, 28.660123021652296, 28.651774906863764, 28.605945621927575, 21.247237406981483, 21.112122324605778, 20.984124982108668, 17.452920641750097, 17.486384104937315, 17.51369720697403, 20.72760719805956, 21.12574330996722, 20.742576345801353, 29.924698198835046, 29.5000913987557, 30.208523549760372, 26.4811577896277, 26.580796322474868, 26.67095227787891, 19.010817036032677, 19.609758724691346, 19.50507201254368, 23.096745781600475, 23.207378074526787, 23.247046139091253, 14.856083874901131, 15.629812513788536, 15.495165397723511, 24.400684885680676, 24.655675940215588, 24.948890801519156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15653543633904263, "mean_inference_ms": 0.7134740982707909, "mean_action_processing_ms": 0.10066259041653902, "mean_env_wait_ms": 0.8208708719624953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 853866, "timesteps_this_iter": 0, "agent_timesteps_total": 2561598, "timers": {"sample_time_ms": 18819.658, "sample_throughput": 509.786, "load_time_ms": 0.2, "load_throughput": 47933475.373, "learn_time_ms": 2924.181, "learn_throughput": 3280.918, "update_time_ms": 8.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.657784640789033e-09, "cur_lr": 0.0005, "total_loss": 6.428873538970947, "policy_loss": 0.002822087405817353, "vf_loss": 6.555698990821838, "vf_explained_var": 0.054819464683532715, "kl": 0.010139456193537793, "entropy": 12.964756727218628, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 853866, "num_agent_steps_sampled": 2561598, "num_steps_trained": 853866, "num_agent_steps_trained": 2561598, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3635, "training_iteration": 89, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-13-34", "timestamp": 1706192014, "time_this_iter_s": 19.126477003097534, "time_total_s": 1814.7752583026886, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0049B820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1814.7752583026886, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 8.455555555555556, "ram_util_percent": 49.281481481481485}}
{"episode_reward_max": 91.15734409168363, "episode_reward_min": 33.10023254901169, "episode_reward_mean": 67.43934918369975, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 10.592221279939011}, "policy_reward_max": {"shared_policy": 30.597730066627264}, "policy_reward_mean": {"shared_policy": 22.479783061233242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.15734409168363, 70.14888982102272, 48.59414257109162, 70.15511290729044, 86.15300401579587, 80.31090730428693, 66.04300342872737, 63.944646134972544, 49.99801879934964, 71.54443554393946, 66.86273028235881, 50.11882542073724, 66.22997047752142, 76.65463944897054, 65.01997503638268, 74.93650157377124, 66.73631176352498, 71.57113024778661, 68.68371810019016, 69.36949764471501, 65.62854033708571, 66.46844869852063, 73.11444981396197, 80.22797822579739, 73.18938800599426, 56.75351266376674, 85.94416099414228, 55.212979911128045, 41.19762899726629, 67.98846052028237, 58.03897529095411, 33.10023254901169, 71.06258684024212, 73.4448544550687, 59.25885393284261, 65.54956791549918, 42.587726209778324, 80.54532647877932, 45.7656190767884, 53.184524759650216, 70.32490293681622, 69.5067894583335, 74.55469996109603, 60.663184449076624, 52.56040052883324, 55.836316897068144, 42.66171471774578, 73.26584770157932, 86.41299039125443, 83.73510639369485, 71.67846715822813, 79.05252949893473, 84.56820399686691, 87.28749772906303, 65.87959391623735, 60.62735651899129, 72.95996149117127, 73.09973893687126, 85.91784355044364, 63.34348471369593, 52.45300195366144, 62.59592685382813, 89.63331314735112, 79.73290638998148, 58.1256477732677, 69.55116999521852, 45.98106178641318, 74.00525162741542, 69.20949763059615, 86.00195544958115, 66.32756778132169, 74.08419270440935, 49.220968835055814, 69.38339243456721, 63.07637203577903, 70.5043067438528, 65.41984758526085, 79.68109045177695, 69.44344690814614, 79.09498287132007, 71.46198116056621, 57.65057349950074, 63.88446880877015, 71.00567873846738, 61.55985927581784, 44.13355973269789, 64.84695571754126, 75.74171119742094, 66.07007879391311, 72.66671826131639, 80.99915693700314, 71.154856339097, 81.36345944553612, 71.19230360630897, 49.23744106292722, 75.5374636352062, 74.87141415056976, 57.86111163394523, 67.1224063783884, 55.61456779949367], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.21086010336876, 30.348753921687603, 30.597730066627264, 23.462349756310374, 23.563140893975884, 23.123399170736462, 16.40548440317312, 16.083117338518292, 16.105540829400212, 23.48104665552576, 23.4664748845001, 23.207591367264584, 28.792601649959877, 28.976143941593662, 28.384258424242333, 26.084917465845734, 26.938492784897477, 27.287497053543717, 22.15437714134653, 22.07091076423724, 21.817715523143605, 21.18665454785028, 21.328087801734597, 21.429903785387665, 16.85195762726167, 16.654993454615266, 16.491067717472703, 23.407408510645226, 24.012143890683845, 24.124883142610386, 22.22171266128619, 22.094055717190102, 22.54696190388252, 16.697299512724072, 16.574260550240666, 16.8472653577725, 21.261498749256134, 22.452468879520893, 22.516002848744392, 25.673629970600203, 25.652795446415738, 25.3282140319546, 21.63520833849907, 21.640948712825775, 21.74381798505783, 24.524005100131035, 25.01524270325899, 25.397253770381212, 21.866699332992226, 22.50352960700789, 22.366082823524863, 23.60255532215038, 23.89279270793, 24.075782217706234, 22.775352023541927, 23.226699627935886, 22.68166644871235, 22.922347143292427, 22.95849497616291, 23.488655525259674, 22.11559574057658, 21.69035120805104, 21.82259338845809, 22.30865168819824, 22.13070164869228, 22.029095361630112, 24.459549394746617, 24.33724859853585, 24.3176518206795, 26.63588115821281, 26.755387688676507, 26.83670937890807, 24.211764708161354, 24.41325193271041, 24.564371365122497, 19.091694198548794, 19.165727293118834, 18.496091172099113, 28.300398280223206, 28.644076091547802, 28.99968662237127, 18.303240237136677, 18.322451670964554, 18.587288003026813, 13.67864017188549, 13.595696322619915, 13.923292502760887, 22.73760570523639, 22.720169884463147, 22.530684930582837, 19.400700502097607, 19.20143833756447, 19.436836451292038, 11.132779714961842, 11.37523155411084, 10.592221279939011, 23.79134331891933, 23.914485751340777, 23.35675776998201, 24.33424849559863, 24.454093878467873, 24.65651208100219, 19.865909330546856, 20.225634900853038, 19.16730970144272, 21.53447603682676, 21.78414838264385, 22.230943496028573, 14.171170014267162, 14.136487012108162, 14.280069183403, 26.56987012922764, 26.965336721390486, 27.010119628161192, 15.27513939390579, 15.198774370054394, 15.291705312828213, 18.02833641072114, 17.67726721366246, 17.478921135266617, 23.100478410720825, 23.57813097909093, 23.64629354700446, 22.784605865677193, 23.175807950397328, 23.54637564225898, 24.82054781292875, 24.905370866258934, 24.82878128190835, 20.211479576925427, 20.32796687136093, 20.12373800079027, 17.118480573097855, 17.79500911446908, 17.646910841266305, 18.539754434178263, 18.753691991015017, 18.542870471874863, 14.234786789864302, 14.33860008791089, 14.088327839970589, 24.67790176098545, 24.18795886387427, 24.399987076719597, 28.948005512356758, 28.94547961652279, 28.519505262374878, 27.916835388789565, 27.82190457979837, 27.996366425106913, 23.897541912893445, 23.91030866901079, 23.870616576323897, 26.336873178680733, 26.386063178380326, 26.329593141873673, 27.67284923295179, 28.483022424081952, 28.41233233983317, 29.136977687478065, 29.15615674853325, 28.99436329305172, 21.905035108327866, 21.940432276576757, 22.03412653133273, 19.994258001446724, 19.935055688023567, 20.698042829521, 24.420309277251363, 24.085686333477497, 24.45396588044241, 24.14084332684675, 24.658031209061534, 24.30086440096298, 28.660123021652296, 28.651774906863764, 28.605945621927575, 21.247237406981483, 21.112122324605778, 20.984124982108668, 17.452920641750097, 17.486384104937315, 17.51369720697403, 20.72760719805956, 21.12574330996722, 20.742576345801353, 29.924698198835046, 29.5000913987557, 30.208523549760372, 26.4811577896277, 26.580796322474868, 26.67095227787891, 19.010817036032677, 19.609758724691346, 19.50507201254368, 23.096745781600475, 23.207378074526787, 23.247046139091253, 14.856083874901131, 15.629812513788536, 15.495165397723511, 24.400684885680676, 24.655675940215588, 24.948890801519156, 23.165463638802365, 23.018687052031353, 23.02534693976243, 28.54796739667654, 28.717304173856974, 28.736683879047632, 21.936528631796435, 22.19446123608698, 22.196577913438276, 24.9145774928232, 24.430347328384713, 24.739267883201435, 16.376131070156887, 16.492366832991436, 16.35247093190749, 22.77302624285221, 23.314442966133356, 23.295923225581646, 21.220464327993483, 20.71726610759893, 21.138641600186617, 23.56673533655703, 23.268348515033722, 23.66922289226204, 21.799438705046967, 21.79415702571471, 21.826251854499176, 26.338429326812417, 26.54777808735767, 26.794883037606866, 23.11219321191311, 23.255428481847048, 23.075825214385986, 26.0524625579516, 26.771822948163987, 26.270697365204484, 23.82530826702714, 23.773614667356014, 23.863058226183057, 19.349609447022274, 19.165757094820336, 19.135206957658127, 21.35766993711391, 21.66633557031551, 20.86046330134073, 23.50488032152255, 23.551675890882805, 23.949122526062027, 20.5123899920533, 20.564760048563272, 20.48270923520127, 14.487426874538258, 14.79678909045954, 14.849343767700091, 21.58343869199355, 21.96037882411231, 21.303138201435402, 25.180479512860373, 25.308819945280746, 25.25241173927982, 22.110662036885813, 21.77633073677619, 22.18308602025111, 24.137875984112412, 24.49917830216387, 24.02966397504011, 26.79628899693489, 26.93727633357048, 27.265591606497765, 23.663458759586007, 23.782515759269387, 23.7088818202416, 26.985253949960068, 27.228542303045586, 27.14966319253047, 23.47107313076654, 23.696943702797086, 24.02428677274534, 16.43099399159351, 16.40787491450706, 16.398572156826646, 25.095168905953557, 25.173447872201592, 25.268846857051045, 24.958220601081848, 24.616642996668816, 25.2965505528191, 19.28604994962612, 19.141179742912442, 19.433881941406668, 22.119703955948353, 22.359468333423138, 22.643234089016914, 18.519494608044624, 18.695465167984366, 18.39960802346468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15637565101854808, "mean_inference_ms": 0.7129504142973986, "mean_action_processing_ms": 0.10057781597610198, "mean_env_wait_ms": 0.8203157565697973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 863460, "timesteps_this_iter": 0, "agent_timesteps_total": 2590380, "timers": {"sample_time_ms": 18912.585, "sample_throughput": 507.281, "load_time_ms": 0.2, "load_throughput": 47933475.373, "learn_time_ms": 2927.296, "learn_throughput": 3277.427, "update_time_ms": 8.703}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.657784640789033e-09, "cur_lr": 0.0005, "total_loss": 5.065991461277008, "policy_loss": -3.8481414645796796e-05, "vf_loss": 5.1959646344184875, "vf_explained_var": 0.050757572054862976, "kl": 0.004018994397592559, "entropy": 12.993471503257751, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 863460, "num_agent_steps_sampled": 2590380, "num_steps_trained": 863460, "num_agent_steps_trained": 2590380, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3667, "training_iteration": 90, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-13-54", "timestamp": 1706192034, "time_this_iter_s": 19.49434208869934, "time_total_s": 1834.269600391388, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41C649D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1834.269600391388, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.481481481481481, "ram_util_percent": 49.33333333333332}}
{"episode_reward_max": 90.2354149688035, "episode_reward_min": 42.587726209778324, "episode_reward_mean": 68.45011300381383, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 14.088327839970589}, "policy_reward_max": {"shared_policy": 30.250810433800012}, "policy_reward_mean": {"shared_policy": 22.8167043346046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.06258684024212, 73.4448544550687, 59.25885393284261, 65.54956791549918, 42.587726209778324, 80.54532647877932, 45.7656190767884, 53.184524759650216, 70.32490293681622, 69.5067894583335, 74.55469996109603, 60.663184449076624, 52.56040052883324, 55.836316897068144, 42.66171471774578, 73.26584770157932, 86.41299039125443, 83.73510639369485, 71.67846715822813, 79.05252949893473, 84.56820399686691, 87.28749772906303, 65.87959391623735, 60.62735651899129, 72.95996149117127, 73.09973893687126, 85.91784355044364, 63.34348471369593, 52.45300195366144, 62.59592685382813, 89.63331314735112, 79.73290638998148, 58.1256477732677, 69.55116999521852, 45.98106178641318, 74.00525162741542, 69.20949763059615, 86.00195544958115, 66.32756778132169, 74.08419270440935, 49.220968835055814, 69.38339243456721, 63.07637203577903, 70.5043067438528, 65.41984758526085, 79.68109045177695, 69.44344690814614, 79.09498287132007, 71.46198116056621, 57.65057349950074, 63.88446880877015, 71.00567873846738, 61.55985927581784, 44.13355973269789, 64.84695571754126, 75.74171119742094, 66.07007879391311, 72.66671826131639, 80.99915693700314, 71.154856339097, 81.36345944553612, 71.19230360630897, 49.23744106292722, 75.5374636352062, 74.87141415056976, 57.86111163394523, 67.1224063783884, 55.61456779949367, 53.27516847243531, 65.83405487984419, 45.79422146640718, 84.06298654992132, 69.7565714549273, 64.43190415203568, 66.37303357385099, 80.82696205750108, 67.19165655504912, 74.32156522199509, 76.90290035540238, 79.5123467799276, 57.71434108540413, 50.95083308964968, 65.46810475736855, 78.60957368835807, 64.52541647991164, 60.449352849274845, 70.06072236783801, 90.2354149688035, 81.9689623620361, 78.42292008176445, 55.76786547154185, 82.64204429090022, 70.66058862581849, 83.31700408272442, 75.55090893432497, 81.76948300004004, 85.06585152354091, 45.62874986231327, 65.3645915314555, 59.717842061072574], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.79134331891933, 23.914485751340777, 23.35675776998201, 24.33424849559863, 24.454093878467873, 24.65651208100219, 19.865909330546856, 20.225634900853038, 19.16730970144272, 21.53447603682676, 21.78414838264385, 22.230943496028573, 14.171170014267162, 14.136487012108162, 14.280069183403, 26.56987012922764, 26.965336721390486, 27.010119628161192, 15.27513939390579, 15.198774370054394, 15.291705312828213, 18.02833641072114, 17.67726721366246, 17.478921135266617, 23.100478410720825, 23.57813097909093, 23.64629354700446, 22.784605865677193, 23.175807950397328, 23.54637564225898, 24.82054781292875, 24.905370866258934, 24.82878128190835, 20.211479576925427, 20.32796687136093, 20.12373800079027, 17.118480573097855, 17.79500911446908, 17.646910841266305, 18.539754434178263, 18.753691991015017, 18.542870471874863, 14.234786789864302, 14.33860008791089, 14.088327839970589, 24.67790176098545, 24.18795886387427, 24.399987076719597, 28.948005512356758, 28.94547961652279, 28.519505262374878, 27.916835388789565, 27.82190457979837, 27.996366425106913, 23.897541912893445, 23.91030866901079, 23.870616576323897, 26.336873178680733, 26.386063178380326, 26.329593141873673, 27.67284923295179, 28.483022424081952, 28.41233233983317, 29.136977687478065, 29.15615674853325, 28.99436329305172, 21.905035108327866, 21.940432276576757, 22.03412653133273, 19.994258001446724, 19.935055688023567, 20.698042829521, 24.420309277251363, 24.085686333477497, 24.45396588044241, 24.14084332684675, 24.658031209061534, 24.30086440096298, 28.660123021652296, 28.651774906863764, 28.605945621927575, 21.247237406981483, 21.112122324605778, 20.984124982108668, 17.452920641750097, 17.486384104937315, 17.51369720697403, 20.72760719805956, 21.12574330996722, 20.742576345801353, 29.924698198835046, 29.5000913987557, 30.208523549760372, 26.4811577896277, 26.580796322474868, 26.67095227787891, 19.010817036032677, 19.609758724691346, 19.50507201254368, 23.096745781600475, 23.207378074526787, 23.247046139091253, 14.856083874901131, 15.629812513788536, 15.495165397723511, 24.400684885680676, 24.655675940215588, 24.948890801519156, 23.165463638802365, 23.018687052031353, 23.02534693976243, 28.54796739667654, 28.717304173856974, 28.736683879047632, 21.936528631796435, 22.19446123608698, 22.196577913438276, 24.9145774928232, 24.430347328384713, 24.739267883201435, 16.376131070156887, 16.492366832991436, 16.35247093190749, 22.77302624285221, 23.314442966133356, 23.295923225581646, 21.220464327993483, 20.71726610759893, 21.138641600186617, 23.56673533655703, 23.268348515033722, 23.66922289226204, 21.799438705046967, 21.79415702571471, 21.826251854499176, 26.338429326812417, 26.54777808735767, 26.794883037606866, 23.11219321191311, 23.255428481847048, 23.075825214385986, 26.0524625579516, 26.771822948163987, 26.270697365204484, 23.82530826702714, 23.773614667356014, 23.863058226183057, 19.349609447022274, 19.165757094820336, 19.135206957658127, 21.35766993711391, 21.66633557031551, 20.86046330134073, 23.50488032152255, 23.551675890882805, 23.949122526062027, 20.5123899920533, 20.564760048563272, 20.48270923520127, 14.487426874538258, 14.79678909045954, 14.849343767700091, 21.58343869199355, 21.96037882411231, 21.303138201435402, 25.180479512860373, 25.308819945280746, 25.25241173927982, 22.110662036885813, 21.77633073677619, 22.18308602025111, 24.137875984112412, 24.49917830216387, 24.02966397504011, 26.79628899693489, 26.93727633357048, 27.265591606497765, 23.663458759586007, 23.782515759269387, 23.7088818202416, 26.985253949960068, 27.228542303045586, 27.14966319253047, 23.47107313076654, 23.696943702797086, 24.02428677274534, 16.43099399159351, 16.40787491450706, 16.398572156826646, 25.095168905953557, 25.173447872201592, 25.268846857051045, 24.958220601081848, 24.616642996668816, 25.2965505528191, 19.28604994962612, 19.141179742912442, 19.433881941406668, 22.119703955948353, 22.359468333423138, 22.643234089016914, 18.519494608044624, 18.695465167984366, 18.39960802346468, 17.940701967881367, 17.712178600331143, 17.6222879042228, 21.972405441105366, 21.8925908356905, 21.969058603048325, 15.07506388425827, 15.251203991472721, 15.467953590676188, 27.941003647943333, 27.93954549481471, 28.182437407163277, 23.430648694435746, 23.3948511412988, 22.93107161919275, 21.304092484215886, 21.517466476807982, 21.610345191011817, 22.22641778923571, 21.97088000178337, 22.175735782831907, 27.176061157137156, 27.030602633953094, 26.620298266410828, 22.22947733849287, 22.387864518910646, 22.574314697645605, 24.500036197404057, 24.902922925228864, 24.918606099362165, 25.385287508368492, 25.71462159231305, 25.802991254720837, 26.873733277743057, 26.278214712937668, 26.360398789246872, 19.215630854169518, 19.494591078410537, 19.004119152824074, 16.972902335226536, 16.828083239495754, 17.149847514927387, 21.838569813718394, 21.79970320810874, 21.82983173554142, 26.221118096262217, 26.272908814251423, 26.11554677784443, 21.606970519603536, 21.49240378228326, 21.426042178024844, 19.981008956829697, 20.37363579745093, 20.094708094994218, 23.266904284556702, 23.129219492276505, 23.664598591004804, 30.250810433800012, 29.851430806020886, 30.133173728982598, 27.37952462335427, 27.428689095502094, 27.16074864317973, 26.335380894442395, 25.704328825076416, 26.383210362245634, 18.56999785701433, 18.540203283230454, 18.65766433129707, 27.666932572921112, 27.643507053454712, 27.33160466452439, 23.448953062295914, 23.647647995501757, 23.56398756802082, 27.669502435872943, 27.773764081920177, 27.873737564931304, 24.902060647805527, 25.186893866707877, 25.461954419811562, 27.34763793771465, 27.112093103428677, 27.30975195889671, 28.366692173294723, 28.352485122159123, 28.346674228087068, 15.320380114018917, 15.442341350018978, 14.866028398275375, 21.81143083175023, 21.946561900277928, 21.606598799427346, 19.923261155684784, 19.638423298796013, 20.156157606591776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15636242001699996, "mean_inference_ms": 0.7127383122407752, "mean_action_processing_ms": 0.1006093383074097, "mean_env_wait_ms": 0.8199376554287012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 873054, "timesteps_this_iter": 0, "agent_timesteps_total": 2619162, "timers": {"sample_time_ms": 19115.314, "sample_throughput": 501.901, "load_time_ms": 0.2, "load_throughput": 47933475.373, "learn_time_ms": 2969.658, "learn_throughput": 3230.675, "update_time_ms": 8.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8288923203945165e-09, "cur_lr": 0.0005, "total_loss": 5.369624316692352, "policy_loss": -0.0007732847371570983, "vf_loss": 5.501673519611359, "vf_explained_var": 0.04385710507631302, "kl": 0.005042572418574756, "entropy": 13.127620577812195, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 873054, "num_agent_steps_sampled": 2619162, "num_steps_trained": 873054, "num_agent_steps_trained": 2619162, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3699, "training_iteration": 91, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-14-15", "timestamp": 1706192055, "time_this_iter_s": 21.226048707962036, "time_total_s": 1855.49564909935, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB0430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1855.49564909935, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 9.423333333333334, "ram_util_percent": 49.50666666666667}}
{"episode_reward_max": 102.5406484901905, "episode_reward_min": 42.79729284532365, "episode_reward_mean": 67.77844364908749, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 13.927616263429314}, "policy_reward_max": {"shared_policy": 34.33504995703697}, "policy_reward_mean": {"shared_policy": 22.592814549695824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.73290638998148, 58.1256477732677, 69.55116999521852, 45.98106178641318, 74.00525162741542, 69.20949763059615, 86.00195544958115, 66.32756778132169, 74.08419270440935, 49.220968835055814, 69.38339243456721, 63.07637203577903, 70.5043067438528, 65.41984758526085, 79.68109045177695, 69.44344690814614, 79.09498287132007, 71.46198116056621, 57.65057349950074, 63.88446880877015, 71.00567873846738, 61.55985927581784, 44.13355973269789, 64.84695571754126, 75.74171119742094, 66.07007879391311, 72.66671826131639, 80.99915693700314, 71.154856339097, 81.36345944553612, 71.19230360630897, 49.23744106292722, 75.5374636352062, 74.87141415056976, 57.86111163394523, 67.1224063783884, 55.61456779949367, 53.27516847243531, 65.83405487984419, 45.79422146640718, 84.06298654992132, 69.7565714549273, 64.43190415203568, 66.37303357385099, 80.82696205750108, 67.19165655504912, 74.32156522199509, 76.90290035540238, 79.5123467799276, 57.71434108540413, 50.95083308964968, 65.46810475736855, 78.60957368835807, 64.52541647991164, 60.449352849274845, 70.06072236783801, 90.2354149688035, 81.9689623620361, 78.42292008176445, 55.76786547154185, 82.64204429090022, 70.66058862581849, 83.31700408272442, 75.55090893432497, 81.76948300004004, 85.06585152354091, 45.62874986231327, 65.3645915314555, 59.717842061072574, 42.79729284532365, 50.40331948548554, 60.127992618829, 57.59998171776533, 102.5406484901905, 76.91553650330751, 67.99877058714625, 79.98750468343496, 45.13014479354024, 52.27916442882268, 56.26430447399616, 98.72192410752174, 56.833816258236766, 58.95201917551455, 54.34994752332567, 80.93798011541364, 48.442171583883464, 66.46248056739567, 54.14057860150933, 65.22791482554749, 65.0268825404346, 77.49244520068167, 75.71596574783322, 86.31449187081307, 50.67093601822853, 79.88579350896178, 58.970020430162535, 61.413098350167274, 81.74101832509038, 59.12336181150749, 70.38348990678787], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.4811577896277, 26.580796322474868, 26.67095227787891, 19.010817036032677, 19.609758724691346, 19.50507201254368, 23.096745781600475, 23.207378074526787, 23.247046139091253, 14.856083874901131, 15.629812513788536, 15.495165397723511, 24.400684885680676, 24.655675940215588, 24.948890801519156, 23.165463638802365, 23.018687052031353, 23.02534693976243, 28.54796739667654, 28.717304173856974, 28.736683879047632, 21.936528631796435, 22.19446123608698, 22.196577913438276, 24.9145774928232, 24.430347328384713, 24.739267883201435, 16.376131070156887, 16.492366832991436, 16.35247093190749, 22.77302624285221, 23.314442966133356, 23.295923225581646, 21.220464327993483, 20.71726610759893, 21.138641600186617, 23.56673533655703, 23.268348515033722, 23.66922289226204, 21.799438705046967, 21.79415702571471, 21.826251854499176, 26.338429326812417, 26.54777808735767, 26.794883037606866, 23.11219321191311, 23.255428481847048, 23.075825214385986, 26.0524625579516, 26.771822948163987, 26.270697365204484, 23.82530826702714, 23.773614667356014, 23.863058226183057, 19.349609447022274, 19.165757094820336, 19.135206957658127, 21.35766993711391, 21.66633557031551, 20.86046330134073, 23.50488032152255, 23.551675890882805, 23.949122526062027, 20.5123899920533, 20.564760048563272, 20.48270923520127, 14.487426874538258, 14.79678909045954, 14.849343767700091, 21.58343869199355, 21.96037882411231, 21.303138201435402, 25.180479512860373, 25.308819945280746, 25.25241173927982, 22.110662036885813, 21.77633073677619, 22.18308602025111, 24.137875984112412, 24.49917830216387, 24.02966397504011, 26.79628899693489, 26.93727633357048, 27.265591606497765, 23.663458759586007, 23.782515759269387, 23.7088818202416, 26.985253949960068, 27.228542303045586, 27.14966319253047, 23.47107313076654, 23.696943702797086, 24.02428677274534, 16.43099399159351, 16.40787491450706, 16.398572156826646, 25.095168905953557, 25.173447872201592, 25.268846857051045, 24.958220601081848, 24.616642996668816, 25.2965505528191, 19.28604994962612, 19.141179742912442, 19.433881941406668, 22.119703955948353, 22.359468333423138, 22.643234089016914, 18.519494608044624, 18.695465167984366, 18.39960802346468, 17.940701967881367, 17.712178600331143, 17.6222879042228, 21.972405441105366, 21.8925908356905, 21.969058603048325, 15.07506388425827, 15.251203991472721, 15.467953590676188, 27.941003647943333, 27.93954549481471, 28.182437407163277, 23.430648694435746, 23.3948511412988, 22.93107161919275, 21.304092484215886, 21.517466476807982, 21.610345191011817, 22.22641778923571, 21.97088000178337, 22.175735782831907, 27.176061157137156, 27.030602633953094, 26.620298266410828, 22.22947733849287, 22.387864518910646, 22.574314697645605, 24.500036197404057, 24.902922925228864, 24.918606099362165, 25.385287508368492, 25.71462159231305, 25.802991254720837, 26.873733277743057, 26.278214712937668, 26.360398789246872, 19.215630854169518, 19.494591078410537, 19.004119152824074, 16.972902335226536, 16.828083239495754, 17.149847514927387, 21.838569813718394, 21.79970320810874, 21.82983173554142, 26.221118096262217, 26.272908814251423, 26.11554677784443, 21.606970519603536, 21.49240378228326, 21.426042178024844, 19.981008956829697, 20.37363579745093, 20.094708094994218, 23.266904284556702, 23.129219492276505, 23.664598591004804, 30.250810433800012, 29.851430806020886, 30.133173728982598, 27.37952462335427, 27.428689095502094, 27.16074864317973, 26.335380894442395, 25.704328825076416, 26.383210362245634, 18.56999785701433, 18.540203283230454, 18.65766433129707, 27.666932572921112, 27.643507053454712, 27.33160466452439, 23.448953062295914, 23.647647995501757, 23.56398756802082, 27.669502435872943, 27.773764081920177, 27.873737564931304, 24.902060647805527, 25.186893866707877, 25.461954419811562, 27.34763793771465, 27.112093103428677, 27.30975195889671, 28.366692173294723, 28.352485122159123, 28.346674228087068, 15.320380114018917, 15.442341350018978, 14.866028398275375, 21.81143083175023, 21.946561900277928, 21.606598799427346, 19.923261155684784, 19.638423298796013, 20.156157606591776, 14.624718819434435, 14.244957762459904, 13.927616263429314, 16.80598934491475, 16.481602316101387, 17.115727824469403, 19.783140187462166, 20.158400171746806, 20.186452259620026, 19.049965389072895, 19.234857954084873, 19.315158374607563, 34.33504995703697, 34.06779967993498, 34.137798853218555, 25.569261723508433, 25.707653375652924, 25.63862140414615, 22.460069904724747, 22.636347288886697, 22.90235339353481, 26.186194822192192, 26.832793720066547, 26.968516141176224, 15.127680633217096, 15.237592548131943, 14.7648716121912, 17.423345023145274, 17.2587258045872, 17.597093601090208, 18.651150915771723, 18.757310327142477, 18.855843231081963, 32.74028534690538, 32.87632521862784, 33.10531354198852, 19.164822099730372, 18.740602850914, 18.928391307592392, 19.398361186186463, 19.634214530388505, 19.919443458939583, 18.052264907707766, 18.120758598049477, 18.176924017568425, 26.90860907236734, 26.918889979521424, 27.110481063524873, 15.819997228682041, 16.273002615198493, 16.34917174000293, 22.548562248547867, 22.179133889575795, 21.73478442927201, 17.869012393057346, 18.305190782994032, 17.966375425457954, 22.073715821374208, 21.533281072974205, 21.620917931199074, 21.623902037739754, 21.70432548597455, 21.698655016720295, 25.75610377391179, 25.629151319464043, 26.10719010730584, 25.330922587464244, 25.349711796889693, 25.035331363479287, 28.45710699260235, 28.76819983869791, 29.089185039512813, 17.11283654719591, 16.885082133114338, 16.67301733791828, 26.574220826228455, 26.615224109341696, 26.69634857339163, 19.710925435026482, 20.05437876967092, 19.204716225465134, 20.217781141400337, 20.402211360633373, 20.793105848133564, 27.390970448652894, 27.329562986890465, 27.02048488954702, 20.093430534470826, 19.450635835528374, 19.579295441508293, 23.528182305395603, 22.953638792037964, 23.901668809354305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563467606191175, "mean_inference_ms": 0.7129591479322848, "mean_action_processing_ms": 0.1006445205047074, "mean_env_wait_ms": 0.8198843066139232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 882648, "timesteps_this_iter": 0, "agent_timesteps_total": 2647944, "timers": {"sample_time_ms": 19341.739, "sample_throughput": 496.026, "load_time_ms": 0.1, "load_throughput": 95992730.382, "learn_time_ms": 2982.697, "learn_throughput": 3216.552, "update_time_ms": 8.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8288923203945165e-09, "cur_lr": 0.0005, "total_loss": 6.637437343597412, "policy_loss": -0.00020487116557729723, "vf_loss": 6.771729230880737, "vf_explained_var": 0.030318625271320343, "kl": 0.004849640157893978, "entropy": 13.408685803413391, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 882648, "num_agent_steps_sampled": 2647944, "num_steps_trained": 882648, "num_agent_steps_trained": 2647944, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3730, "training_iteration": 92, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-14-36", "timestamp": 1706192076, "time_this_iter_s": 20.796266078948975, "time_total_s": 1876.291915178299, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03502820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1876.291915178299, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.536666666666669, "ram_util_percent": 49.72999999999999}}
{"episode_reward_max": 102.5406484901905, "episode_reward_min": -2.727824334986522, "episode_reward_mean": 66.34031269436586, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -1.12306208411853}, "policy_reward_max": {"shared_policy": 34.33504995703697}, "policy_reward_mean": {"shared_policy": 22.11343756478861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.86111163394523, 67.1224063783884, 55.61456779949367, 53.27516847243531, 65.83405487984419, 45.79422146640718, 84.06298654992132, 69.7565714549273, 64.43190415203568, 66.37303357385099, 80.82696205750108, 67.19165655504912, 74.32156522199509, 76.90290035540238, 79.5123467799276, 57.71434108540413, 50.95083308964968, 65.46810475736855, 78.60957368835807, 64.52541647991164, 60.449352849274845, 70.06072236783801, 90.2354149688035, 81.9689623620361, 78.42292008176445, 55.76786547154185, 82.64204429090022, 70.66058862581849, 83.31700408272442, 75.55090893432497, 81.76948300004004, 85.06585152354091, 45.62874986231327, 65.3645915314555, 59.717842061072574, 42.79729284532365, 50.40331948548554, 60.127992618829, 57.59998171776533, 102.5406484901905, 76.91553650330751, 67.99877058714625, 79.98750468343496, 45.13014479354024, 52.27916442882268, 56.26430447399616, 98.72192410752174, 56.833816258236766, 58.95201917551455, 54.34994752332567, 80.93798011541364, 48.442171583883464, 66.46248056739567, 54.14057860150933, 65.22791482554749, 65.0268825404346, 77.49244520068167, 75.71596574783322, 86.31449187081307, 50.67093601822853, 79.88579350896178, 58.970020430162535, 61.413098350167274, 81.74101832509038, 59.12336181150749, 70.38348990678787, 36.26272003911433, 92.17602241411805, 88.70968633145094, 81.42080794647335, 72.85234821867196, 71.42863419651982, 39.37117569148538, 55.74236448109147, 84.95360253378749, 54.76773271150887, 48.77835476025936, 73.56489352881906, 65.59510747715828, 66.62679961090906, 36.250235408544526, 74.58218517154455, 80.19739690702407, 73.36819423397534, 84.2772203683853, 62.831510506570325, -2.727824334986522, 67.22190451063214, 53.34581709653136, 61.5975348219508, 78.67828769236803, 73.81174187362194, 63.770785830914946, 54.66967164166272, 68.52601709961891, 66.80211777240035, 65.30121472151947, 53.097549811820485, 49.82532857172191, 80.73110424727199], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.28604994962612, 19.141179742912442, 19.433881941406668, 22.119703955948353, 22.359468333423138, 22.643234089016914, 18.519494608044624, 18.695465167984366, 18.39960802346468, 17.940701967881367, 17.712178600331143, 17.6222879042228, 21.972405441105366, 21.8925908356905, 21.969058603048325, 15.07506388425827, 15.251203991472721, 15.467953590676188, 27.941003647943333, 27.93954549481471, 28.182437407163277, 23.430648694435746, 23.3948511412988, 22.93107161919275, 21.304092484215886, 21.517466476807982, 21.610345191011817, 22.22641778923571, 21.97088000178337, 22.175735782831907, 27.176061157137156, 27.030602633953094, 26.620298266410828, 22.22947733849287, 22.387864518910646, 22.574314697645605, 24.500036197404057, 24.902922925228864, 24.918606099362165, 25.385287508368492, 25.71462159231305, 25.802991254720837, 26.873733277743057, 26.278214712937668, 26.360398789246872, 19.215630854169518, 19.494591078410537, 19.004119152824074, 16.972902335226536, 16.828083239495754, 17.149847514927387, 21.838569813718394, 21.79970320810874, 21.82983173554142, 26.221118096262217, 26.272908814251423, 26.11554677784443, 21.606970519603536, 21.49240378228326, 21.426042178024844, 19.981008956829697, 20.37363579745093, 20.094708094994218, 23.266904284556702, 23.129219492276505, 23.664598591004804, 30.250810433800012, 29.851430806020886, 30.133173728982598, 27.37952462335427, 27.428689095502094, 27.16074864317973, 26.335380894442395, 25.704328825076416, 26.383210362245634, 18.56999785701433, 18.540203283230454, 18.65766433129707, 27.666932572921112, 27.643507053454712, 27.33160466452439, 23.448953062295914, 23.647647995501757, 23.56398756802082, 27.669502435872943, 27.773764081920177, 27.873737564931304, 24.902060647805527, 25.186893866707877, 25.461954419811562, 27.34763793771465, 27.112093103428677, 27.30975195889671, 28.366692173294723, 28.352485122159123, 28.346674228087068, 15.320380114018917, 15.442341350018978, 14.866028398275375, 21.81143083175023, 21.946561900277928, 21.606598799427346, 19.923261155684784, 19.638423298796013, 20.156157606591776, 14.624718819434435, 14.244957762459904, 13.927616263429314, 16.80598934491475, 16.481602316101387, 17.115727824469403, 19.783140187462166, 20.158400171746806, 20.186452259620026, 19.049965389072895, 19.234857954084873, 19.315158374607563, 34.33504995703697, 34.06779967993498, 34.137798853218555, 25.569261723508433, 25.707653375652924, 25.63862140414615, 22.460069904724747, 22.636347288886697, 22.90235339353481, 26.186194822192192, 26.832793720066547, 26.968516141176224, 15.127680633217096, 15.237592548131943, 14.7648716121912, 17.423345023145274, 17.2587258045872, 17.597093601090208, 18.651150915771723, 18.757310327142477, 18.855843231081963, 32.74028534690538, 32.87632521862784, 33.10531354198852, 19.164822099730372, 18.740602850914, 18.928391307592392, 19.398361186186463, 19.634214530388505, 19.919443458939583, 18.052264907707766, 18.120758598049477, 18.176924017568425, 26.90860907236734, 26.918889979521424, 27.110481063524873, 15.819997228682041, 16.273002615198493, 16.34917174000293, 22.548562248547867, 22.179133889575795, 21.73478442927201, 17.869012393057346, 18.305190782994032, 17.966375425457954, 22.073715821374208, 21.533281072974205, 21.620917931199074, 21.623902037739754, 21.70432548597455, 21.698655016720295, 25.75610377391179, 25.629151319464043, 26.10719010730584, 25.330922587464244, 25.349711796889693, 25.035331363479287, 28.45710699260235, 28.76819983869791, 29.089185039512813, 17.11283654719591, 16.885082133114338, 16.67301733791828, 26.574220826228455, 26.615224109341696, 26.69634857339163, 19.710925435026482, 20.05437876967092, 19.204716225465134, 20.217781141400337, 20.402211360633373, 20.793105848133564, 27.390970448652894, 27.329562986890465, 27.02048488954702, 20.093430534470826, 19.450635835528374, 19.579295441508293, 23.528182305395603, 22.953638792037964, 23.901668809354305, 12.40058168085912, 11.811236853400857, 12.050901504854352, 30.80395794659853, 30.36833482980728, 31.00372963771224, 29.25739498436451, 29.722216591238976, 29.730074755847454, 27.239848864575222, 26.825291146834687, 27.355667935063437, 24.626569576871887, 24.179196265836552, 24.046582375963524, 23.987360301117093, 23.873292023936898, 23.567981871465832, 13.260590924570948, 13.222175842771918, 12.88840892414251, 18.786569173137337, 18.56416632483402, 18.391628983120114, 28.212701957672834, 28.43980997800827, 28.301090598106384, 18.40162083134055, 17.880268335342407, 18.48584354482591, 16.399298841754586, 16.07605309287706, 16.303002825627715, 24.389609458545834, 24.637971284488827, 24.537312785784394, 21.71910090620318, 21.92104337985316, 21.95496319110194, 22.205770622317985, 22.305593349815652, 22.115435638775423, 11.67454122503598, 12.119823535283402, 12.455870648225144, 24.801620960235596, 24.70397186279297, 25.076592348515987, 26.729664349307612, 26.497771379848317, 26.969961177868143, 24.92387661993658, 24.483042563001305, 23.96127505103746, 28.054082070787743, 28.297045206030205, 27.926093091567353, 20.63360907634099, 21.05785510068138, 21.140046329547957, -1.12306208411853, -0.8348536311338393, -0.7699086197341529, 22.36695835118492, 22.29372787972291, 22.561218279724315, 17.82773186514774, 17.68346023807922, 17.834624993304402, 20.26224974791208, 20.766788561168738, 20.568496512869984, 26.33900285884738, 26.496181648224592, 25.84310318529606, 24.546885065734386, 24.512275256216526, 24.752581551671028, 21.09732439617315, 21.4795398886005, 21.193921546141297, 18.31721904873848, 17.947096034884453, 18.405356558039784, 23.207631021738052, 22.687921211123466, 22.630464866757393, 22.381976986924798, 22.43563230584064, 21.98450847963491, 21.52697456131378, 21.743134419123322, 22.03110574108237, 17.707248666517742, 17.701068827261523, 17.68923231804122, 16.674535818398, 16.37546120584011, 16.775331547483802, 26.855576785902173, 26.850539336601884, 27.02498812476793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15643528698455175, "mean_inference_ms": 0.7130624549667637, "mean_action_processing_ms": 0.10072600653963688, "mean_env_wait_ms": 0.8197753942912088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 892242, "timesteps_this_iter": 0, "agent_timesteps_total": 2676726, "timers": {"sample_time_ms": 19371.946, "sample_throughput": 495.252, "load_time_ms": 0.1, "load_throughput": 95992730.382, "learn_time_ms": 2994.239, "learn_throughput": 3204.153, "update_time_ms": 9.203}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4144461601972582e-09, "cur_lr": 0.0005, "total_loss": 6.2631202936172485, "policy_loss": 0.005272717935702498, "vf_loss": 6.391122460365295, "vf_explained_var": 0.10738863050937653, "kl": 0.020166712056503826, "entropy": 13.32749605178833, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 892242, "num_agent_steps_sampled": 2676726, "num_steps_trained": 892242, "num_agent_steps_trained": 2676726, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3764, "training_iteration": 93, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-14-55", "timestamp": 1706192095, "time_this_iter_s": 19.63796353340149, "time_total_s": 1895.9298787117004, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1895.9298787117004, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 6.925000000000002, "ram_util_percent": 49.728571428571435}}
{"episode_reward_max": 102.87994730472562, "episode_reward_min": -279.11036617284117, "episode_reward_mean": 61.38486125676675, "episode_len_mean": 298.21, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -99.58012526358168}, "policy_reward_max": {"shared_policy": 34.528560164074094}, "policy_reward_mean": {"shared_policy": 20.46162041892224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.06585152354091, 45.62874986231327, 65.3645915314555, 59.717842061072574, 42.79729284532365, 50.40331948548554, 60.127992618829, 57.59998171776533, 102.5406484901905, 76.91553650330751, 67.99877058714625, 79.98750468343496, 45.13014479354024, 52.27916442882268, 56.26430447399616, 98.72192410752174, 56.833816258236766, 58.95201917551455, 54.34994752332567, 80.93798011541364, 48.442171583883464, 66.46248056739567, 54.14057860150933, 65.22791482554749, 65.0268825404346, 77.49244520068167, 75.71596574783322, 86.31449187081307, 50.67093601822853, 79.88579350896178, 58.970020430162535, 61.413098350167274, 81.74101832509038, 59.12336181150749, 70.38348990678787, 36.26272003911433, 92.17602241411805, 88.70968633145094, 81.42080794647335, 72.85234821867196, 71.42863419651982, 39.37117569148538, 55.74236448109147, 84.95360253378749, 54.76773271150887, 48.77835476025936, 73.56489352881906, 65.59510747715828, 66.62679961090906, 36.250235408544526, 74.58218517154455, 80.19739690702407, 73.36819423397534, 84.2772203683853, 62.831510506570325, -2.727824334986522, 67.22190451063214, 53.34581709653136, 61.5975348219508, 78.67828769236803, 73.81174187362194, 63.770785830914946, 54.66967164166272, 68.52601709961891, 66.80211777240035, 65.30121472151947, 53.097549811820485, 49.82532857172191, 80.73110424727199, 75.7715933918953, 54.0014205649495, 102.87994730472562, 75.66378312185404, 44.71397741325197, 69.01401239458937, 13.17120966315268, 63.66709747910498, 65.62415873957795, -279.11036617284117, 67.32371835410592, 60.832631293917075, 69.72551197558641, 43.32067859917876, 48.41356306150554, 53.20440581627189, 90.84346445091066, 48.26994940638539, 70.98217605426905, 74.2919416949153, 90.6669190376997, 53.81189821846782, 65.97868869267401, 65.2048994041979, 64.94538358971477, 52.294150145724416, 61.247751858085365, 68.38221568800506, 77.78445933084004, 74.43771285936234, 74.09089627489448], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 121, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.366692173294723, 28.352485122159123, 28.346674228087068, 15.320380114018917, 15.442341350018978, 14.866028398275375, 21.81143083175023, 21.946561900277928, 21.606598799427346, 19.923261155684784, 19.638423298796013, 20.156157606591776, 14.624718819434435, 14.244957762459904, 13.927616263429314, 16.80598934491475, 16.481602316101387, 17.115727824469403, 19.783140187462166, 20.158400171746806, 20.186452259620026, 19.049965389072895, 19.234857954084873, 19.315158374607563, 34.33504995703697, 34.06779967993498, 34.137798853218555, 25.569261723508433, 25.707653375652924, 25.63862140414615, 22.460069904724747, 22.636347288886697, 22.90235339353481, 26.186194822192192, 26.832793720066547, 26.968516141176224, 15.127680633217096, 15.237592548131943, 14.7648716121912, 17.423345023145274, 17.2587258045872, 17.597093601090208, 18.651150915771723, 18.757310327142477, 18.855843231081963, 32.74028534690538, 32.87632521862784, 33.10531354198852, 19.164822099730372, 18.740602850914, 18.928391307592392, 19.398361186186463, 19.634214530388505, 19.919443458939583, 18.052264907707766, 18.120758598049477, 18.176924017568425, 26.90860907236734, 26.918889979521424, 27.110481063524873, 15.819997228682041, 16.273002615198493, 16.34917174000293, 22.548562248547867, 22.179133889575795, 21.73478442927201, 17.869012393057346, 18.305190782994032, 17.966375425457954, 22.073715821374208, 21.533281072974205, 21.620917931199074, 21.623902037739754, 21.70432548597455, 21.698655016720295, 25.75610377391179, 25.629151319464043, 26.10719010730584, 25.330922587464244, 25.349711796889693, 25.035331363479287, 28.45710699260235, 28.76819983869791, 29.089185039512813, 17.11283654719591, 16.885082133114338, 16.67301733791828, 26.574220826228455, 26.615224109341696, 26.69634857339163, 19.710925435026482, 20.05437876967092, 19.204716225465134, 20.217781141400337, 20.402211360633373, 20.793105848133564, 27.390970448652894, 27.329562986890465, 27.02048488954702, 20.093430534470826, 19.450635835528374, 19.579295441508293, 23.528182305395603, 22.953638792037964, 23.901668809354305, 12.40058168085912, 11.811236853400857, 12.050901504854352, 30.80395794659853, 30.36833482980728, 31.00372963771224, 29.25739498436451, 29.722216591238976, 29.730074755847454, 27.239848864575222, 26.825291146834687, 27.355667935063437, 24.626569576871887, 24.179196265836552, 24.046582375963524, 23.987360301117093, 23.873292023936898, 23.567981871465832, 13.260590924570948, 13.222175842771918, 12.88840892414251, 18.786569173137337, 18.56416632483402, 18.391628983120114, 28.212701957672834, 28.43980997800827, 28.301090598106384, 18.40162083134055, 17.880268335342407, 18.48584354482591, 16.399298841754586, 16.07605309287706, 16.303002825627715, 24.389609458545834, 24.637971284488827, 24.537312785784394, 21.71910090620318, 21.92104337985316, 21.95496319110194, 22.205770622317985, 22.305593349815652, 22.115435638775423, 11.67454122503598, 12.119823535283402, 12.455870648225144, 24.801620960235596, 24.70397186279297, 25.076592348515987, 26.729664349307612, 26.497771379848317, 26.969961177868143, 24.92387661993658, 24.483042563001305, 23.96127505103746, 28.054082070787743, 28.297045206030205, 27.926093091567353, 20.63360907634099, 21.05785510068138, 21.140046329547957, -1.12306208411853, -0.8348536311338393, -0.7699086197341529, 22.36695835118492, 22.29372787972291, 22.561218279724315, 17.82773186514774, 17.68346023807922, 17.834624993304402, 20.26224974791208, 20.766788561168738, 20.568496512869984, 26.33900285884738, 26.496181648224592, 25.84310318529606, 24.546885065734386, 24.512275256216526, 24.752581551671028, 21.09732439617315, 21.4795398886005, 21.193921546141297, 18.31721904873848, 17.947096034884453, 18.405356558039784, 23.207631021738052, 22.687921211123466, 22.630464866757393, 22.381976986924798, 22.43563230584064, 21.98450847963491, 21.52697456131378, 21.743134419123322, 22.03110574108237, 17.707248666517742, 17.701068827261523, 17.68923231804122, 16.674535818398, 16.37546120584011, 16.775331547483802, 26.855576785902173, 26.850539336601884, 27.02498812476793, 25.404581755399704, 24.990930065512657, 25.376081570982933, 17.748021637399987, 18.052568105359867, 18.200830822189644, 34.10988875726858, 34.24149838338295, 34.528560164074094, 25.506441878775746, 25.585948309550673, 24.57139293352762, 14.84856493646899, 14.913305955628545, 14.952106521154434, 23.149540326208808, 22.737834215164185, 23.12663785321638, 4.001745348175362, 4.649487574895218, 4.5199767400821, 20.835805987318352, 21.58449873824914, 21.24679275353749, 21.624749469260365, 21.874118371556193, 22.125290898761392, -89.3166097462187, -90.2136311630408, -99.58012526358168, 22.642363174508006, 22.45650568480292, 22.224849494794995, 20.187725979834795, 20.238570921123028, 20.406334392959252, 23.263578169047832, 23.271110333502293, 23.19082347303629, 14.552112462619931, 14.584491456548363, 14.184074680010468, 16.338349757095173, 15.843158652385071, 16.232054652025298, 17.70917384450634, 17.740149307375148, 17.7550826643904, 29.829113895694405, 30.5360117300103, 30.478338825205952, 16.351664538184792, 15.840364533166081, 16.07792033503452, 23.621369323382766, 23.60926334063211, 23.75154339025417, 24.868010941892862, 24.829231675714254, 24.594699077308178, 30.292276971042156, 30.246357664465904, 30.12828440219164, 17.549178903301552, 18.148446525757507, 18.11427278940876, 22.05852088580528, 22.33778376194337, 21.582384044925362, 21.56712422768274, 22.005282534907252, 21.63249264160791, 21.574728555977345, 21.97884288802743, 21.39181214570999, 17.85990368016064, 16.851553827524185, 17.58269263803959, 20.228950845698506, 20.533471981684357, 20.485329030702502, 22.589470381538064, 22.958165147031337, 22.83458015943566, 26.11646043509245, 25.108018577098846, 26.55998031864874, 24.824945988754422, 25.01217522347966, 24.600591647128255, 24.788949485868216, 24.506632402539253, 24.795314386487007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15643260315756768, "mean_inference_ms": 0.7130790306742856, "mean_action_processing_ms": 0.10075252833123222, "mean_env_wait_ms": 0.8196464954214434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 901836, "timesteps_this_iter": 0, "agent_timesteps_total": 2705508, "timers": {"sample_time_ms": 19463.335, "sample_throughput": 492.927, "load_time_ms": 0.1, "load_throughput": 95992730.382, "learn_time_ms": 3013.679, "learn_throughput": 3183.485, "update_time_ms": 9.209}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.121669240295887e-09, "cur_lr": 0.0005, "total_loss": 54.25301170349121, "policy_loss": 0.0012982821519740284, "vf_loss": 54.386324882507324, "vf_explained_var": 0.005781650543212891, "kl": 0.008633417892393316, "entropy": 13.461138844490051, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 901836, "num_agent_steps_sampled": 2705508, "num_steps_trained": 901836, "num_agent_steps_trained": 2705508, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3795, "training_iteration": 94, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-15-15", "timestamp": 1706192115, "time_this_iter_s": 19.709312677383423, "time_total_s": 1915.6391913890839, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1915.6391913890839, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 10.532142857142858, "ram_util_percent": 49.78214285714285}}
{"episode_reward_max": 102.87994730472562, "episode_reward_min": -279.11036617284117, "episode_reward_mean": 62.50521550728372, "episode_len_mean": 298.21, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -99.58012526358168}, "policy_reward_max": {"shared_policy": 34.528560164074094}, "policy_reward_mean": {"shared_policy": 20.835071835761234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.12336181150749, 70.38348990678787, 36.26272003911433, 92.17602241411805, 88.70968633145094, 81.42080794647335, 72.85234821867196, 71.42863419651982, 39.37117569148538, 55.74236448109147, 84.95360253378749, 54.76773271150887, 48.77835476025936, 73.56489352881906, 65.59510747715828, 66.62679961090906, 36.250235408544526, 74.58218517154455, 80.19739690702407, 73.36819423397534, 84.2772203683853, 62.831510506570325, -2.727824334986522, 67.22190451063214, 53.34581709653136, 61.5975348219508, 78.67828769236803, 73.81174187362194, 63.770785830914946, 54.66967164166272, 68.52601709961891, 66.80211777240035, 65.30121472151947, 53.097549811820485, 49.82532857172191, 80.73110424727199, 75.7715933918953, 54.0014205649495, 102.87994730472562, 75.66378312185404, 44.71397741325197, 69.01401239458937, 13.17120966315268, 63.66709747910498, 65.62415873957795, -279.11036617284117, 67.32371835410592, 60.832631293917075, 69.72551197558641, 43.32067859917876, 48.41356306150554, 53.20440581627189, 90.84346445091066, 48.26994940638539, 70.98217605426905, 74.2919416949153, 90.6669190376997, 53.81189821846782, 65.97868869267401, 65.2048994041979, 64.94538358971477, 52.294150145724416, 61.247751858085365, 68.38221568800506, 77.78445933084004, 74.43771285936234, 74.09089627489448, 68.61273371800779, 65.2846163799986, 59.8429334722459, 31.816275820136056, 87.28627795237115, 73.63996851444243, 62.85246509779242, 63.33054392039773, 80.82184856384993, 96.73494198918341, 61.81325546838343, 58.11211816594002, 60.63419174589215, 96.41458240523934, 79.94026532024145, 71.73259653430429, 78.69253738224505, 72.211241889745, 70.56594375893474, 83.97387836128472, 27.35484938463196, 69.25525023601948, 48.86117114406076, 88.02142971195279, 73.05719600105658, 38.087630880880155, 86.70078393816945, 58.33745666220781, 73.8160293661058, 77.85701417177914, 67.12699223170054, 62.83080080151555, 85.53678441792727], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 121, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.093430534470826, 19.450635835528374, 19.579295441508293, 23.528182305395603, 22.953638792037964, 23.901668809354305, 12.40058168085912, 11.811236853400857, 12.050901504854352, 30.80395794659853, 30.36833482980728, 31.00372963771224, 29.25739498436451, 29.722216591238976, 29.730074755847454, 27.239848864575222, 26.825291146834687, 27.355667935063437, 24.626569576871887, 24.179196265836552, 24.046582375963524, 23.987360301117093, 23.873292023936898, 23.567981871465832, 13.260590924570948, 13.222175842771918, 12.88840892414251, 18.786569173137337, 18.56416632483402, 18.391628983120114, 28.212701957672834, 28.43980997800827, 28.301090598106384, 18.40162083134055, 17.880268335342407, 18.48584354482591, 16.399298841754586, 16.07605309287706, 16.303002825627715, 24.389609458545834, 24.637971284488827, 24.537312785784394, 21.71910090620318, 21.92104337985316, 21.95496319110194, 22.205770622317985, 22.305593349815652, 22.115435638775423, 11.67454122503598, 12.119823535283402, 12.455870648225144, 24.801620960235596, 24.70397186279297, 25.076592348515987, 26.729664349307612, 26.497771379848317, 26.969961177868143, 24.92387661993658, 24.483042563001305, 23.96127505103746, 28.054082070787743, 28.297045206030205, 27.926093091567353, 20.63360907634099, 21.05785510068138, 21.140046329547957, -1.12306208411853, -0.8348536311338393, -0.7699086197341529, 22.36695835118492, 22.29372787972291, 22.561218279724315, 17.82773186514774, 17.68346023807922, 17.834624993304402, 20.26224974791208, 20.766788561168738, 20.568496512869984, 26.33900285884738, 26.496181648224592, 25.84310318529606, 24.546885065734386, 24.512275256216526, 24.752581551671028, 21.09732439617315, 21.4795398886005, 21.193921546141297, 18.31721904873848, 17.947096034884453, 18.405356558039784, 23.207631021738052, 22.687921211123466, 22.630464866757393, 22.381976986924798, 22.43563230584064, 21.98450847963491, 21.52697456131378, 21.743134419123322, 22.03110574108237, 17.707248666517742, 17.701068827261523, 17.68923231804122, 16.674535818398, 16.37546120584011, 16.775331547483802, 26.855576785902173, 26.850539336601884, 27.02498812476793, 25.404581755399704, 24.990930065512657, 25.376081570982933, 17.748021637399987, 18.052568105359867, 18.200830822189644, 34.10988875726858, 34.24149838338295, 34.528560164074094, 25.506441878775746, 25.585948309550673, 24.57139293352762, 14.84856493646899, 14.913305955628545, 14.952106521154434, 23.149540326208808, 22.737834215164185, 23.12663785321638, 4.001745348175362, 4.649487574895218, 4.5199767400821, 20.835805987318352, 21.58449873824914, 21.24679275353749, 21.624749469260365, 21.874118371556193, 22.125290898761392, -89.3166097462187, -90.2136311630408, -99.58012526358168, 22.642363174508006, 22.45650568480292, 22.224849494794995, 20.187725979834795, 20.238570921123028, 20.406334392959252, 23.263578169047832, 23.271110333502293, 23.19082347303629, 14.552112462619931, 14.584491456548363, 14.184074680010468, 16.338349757095173, 15.843158652385071, 16.232054652025298, 17.70917384450634, 17.740149307375148, 17.7550826643904, 29.829113895694405, 30.5360117300103, 30.478338825205952, 16.351664538184792, 15.840364533166081, 16.07792033503452, 23.621369323382766, 23.60926334063211, 23.75154339025417, 24.868010941892862, 24.829231675714254, 24.594699077308178, 30.292276971042156, 30.246357664465904, 30.12828440219164, 17.549178903301552, 18.148446525757507, 18.11427278940876, 22.05852088580528, 22.33778376194337, 21.582384044925362, 21.56712422768274, 22.005282534907252, 21.63249264160791, 21.574728555977345, 21.97884288802743, 21.39181214570999, 17.85990368016064, 16.851553827524185, 17.58269263803959, 20.228950845698506, 20.533471981684357, 20.485329030702502, 22.589470381538064, 22.958165147031337, 22.83458015943566, 26.11646043509245, 25.108018577098846, 26.55998031864874, 24.824945988754422, 25.01217522347966, 24.600591647128255, 24.788949485868216, 24.506632402539253, 24.795314386487007, 22.70511157562335, 22.860364352663353, 23.047257789721087, 21.643369215230138, 22.177161605718226, 21.464085559050233, 19.86468559751907, 19.922715375820786, 20.055532498906047, 10.483631153901413, 10.637849287440375, 10.694795378794268, 29.09630039784436, 29.097283827917025, 29.092693726609767, 24.629278031488255, 24.35822944839795, 24.652461034556225, 20.78059949974218, 20.815221751729638, 21.2566438463206, 21.258527184526116, 21.135273943344743, 20.93674279252687, 26.971120975911617, 26.81531022489071, 27.0354173630476, 32.11395591994126, 32.22495653231938, 32.39602953692277, 20.639551897067577, 20.634296867530793, 20.539406703785062, 19.858254155764968, 19.263154471913964, 18.990709538261086, 20.25916940051441, 20.27258355154966, 20.102438793828085, 31.876660645008087, 32.56203458085656, 31.975887179374695, 26.744231462478638, 26.662200085818768, 26.533833771944046, 24.12717934480557, 23.766702974836022, 23.8387142146627, 26.214728375275925, 26.05515333016713, 26.422655676801995, 24.022355526685715, 24.066136311739683, 24.1227500513196, 23.531093381345272, 23.705522257834673, 23.32932811975479, 28.177741294105843, 27.756799658139542, 28.039337409039334, 9.301700917538255, 8.774131380021572, 9.279017087072134, 22.717844819029168, 23.250966121753052, 23.28643929523726, 16.40190344831595, 16.22341069454947, 16.235857001195342, 29.23171130319436, 29.108692084749535, 29.681026324008897, 24.35997388884425, 24.62487272778526, 24.07234938442707, 12.56878526632984, 12.721616530170039, 12.797229084380277, 28.96985017011562, 28.668404186765343, 29.062529581288487, 19.273497680823, 19.5865987005333, 19.477360280851514, 24.605348952114582, 24.29796753823757, 24.91271287575364, 25.829076682527855, 26.32375108947356, 25.704186399777726, 22.468864525357873, 21.841681281725556, 22.816446424617112, 20.86451096336046, 21.151939461628587, 20.814350376526505, 29.057895578444004, 27.926160991191864, 28.552727848291397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15643470173907761, "mean_inference_ms": 0.7129638648602702, "mean_action_processing_ms": 0.100715777963877, "mean_env_wait_ms": 0.8193968948994079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 911430, "timesteps_this_iter": 0, "agent_timesteps_total": 2734290, "timers": {"sample_time_ms": 19704.573, "sample_throughput": 486.892, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3032.42, "learn_throughput": 3163.81, "update_time_ms": 9.209}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.121669240295887e-09, "cur_lr": 0.0005, "total_loss": 6.977445840835571, "policy_loss": 0.00040317678067464807, "vf_loss": 7.1114420890808105, "vf_explained_var": 0.06368289887905121, "kl": 0.004488684469960304, "entropy": 13.439907908439636, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 911430, "num_agent_steps_sampled": 2734290, "num_steps_trained": 911430, "num_agent_steps_trained": 2734290, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3828, "training_iteration": 95, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-15-36", "timestamp": 1706192136, "time_this_iter_s": 20.997846603393555, "time_total_s": 1936.6370379924774, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017AFEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1936.6370379924774, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 12.537931034482755, "ram_util_percent": 50.08275862068967}}
{"episode_reward_max": 102.87994730472562, "episode_reward_min": -279.11036617284117, "episode_reward_mean": 62.71069458096332, "episode_len_mean": 298.21, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -99.58012526358168}, "policy_reward_max": {"shared_policy": 34.528560164074094}, "policy_reward_mean": {"shared_policy": 20.9035648603211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.80211777240035, 65.30121472151947, 53.097549811820485, 49.82532857172191, 80.73110424727199, 75.7715933918953, 54.0014205649495, 102.87994730472562, 75.66378312185404, 44.71397741325197, 69.01401239458937, 13.17120966315268, 63.66709747910498, 65.62415873957795, -279.11036617284117, 67.32371835410592, 60.832631293917075, 69.72551197558641, 43.32067859917876, 48.41356306150554, 53.20440581627189, 90.84346445091066, 48.26994940638539, 70.98217605426905, 74.2919416949153, 90.6669190376997, 53.81189821846782, 65.97868869267401, 65.2048994041979, 64.94538358971477, 52.294150145724416, 61.247751858085365, 68.38221568800506, 77.78445933084004, 74.43771285936234, 74.09089627489448, 68.61273371800779, 65.2846163799986, 59.8429334722459, 31.816275820136056, 87.28627795237115, 73.63996851444243, 62.85246509779242, 63.33054392039773, 80.82184856384993, 96.73494198918341, 61.81325546838343, 58.11211816594002, 60.63419174589215, 96.41458240523934, 79.94026532024145, 71.73259653430429, 78.69253738224505, 72.211241889745, 70.56594375893474, 83.97387836128472, 27.35484938463196, 69.25525023601948, 48.86117114406076, 88.02142971195279, 73.05719600105658, 38.087630880880155, 86.70078393816945, 58.33745666220781, 73.8160293661058, 77.85701417177914, 67.12699223170054, 62.83080080151555, 85.53678441792727, 78.35244269296524, 80.63296259194613, 62.19015573151407, 68.84542895480988, 84.55820591747761, 69.13664130214599, 75.01815083622931, 64.79810883849856, 51.11371789872645, 73.65328303910789, 59.44841640815136, 57.40629755239931, 44.81902302335945, 74.8491907902062, 52.850742511451216, 44.17270574346183, 65.49956263229251, 52.62433267012237, 61.5636424086988, 51.800158388912664, 65.34059858103865, 84.50977945700285, 93.21418082062155, 66.46677693352103, 56.08378524705765, 48.8372392579913, 69.93543253466484, 84.53200414031741, 75.49321365170178, 43.878078471869216, 51.08142882771787], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 121, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.381976986924798, 22.43563230584064, 21.98450847963491, 21.52697456131378, 21.743134419123322, 22.03110574108237, 17.707248666517742, 17.701068827261523, 17.68923231804122, 16.674535818398, 16.37546120584011, 16.775331547483802, 26.855576785902173, 26.850539336601884, 27.02498812476793, 25.404581755399704, 24.990930065512657, 25.376081570982933, 17.748021637399987, 18.052568105359867, 18.200830822189644, 34.10988875726858, 34.24149838338295, 34.528560164074094, 25.506441878775746, 25.585948309550673, 24.57139293352762, 14.84856493646899, 14.913305955628545, 14.952106521154434, 23.149540326208808, 22.737834215164185, 23.12663785321638, 4.001745348175362, 4.649487574895218, 4.5199767400821, 20.835805987318352, 21.58449873824914, 21.24679275353749, 21.624749469260365, 21.874118371556193, 22.125290898761392, -89.3166097462187, -90.2136311630408, -99.58012526358168, 22.642363174508006, 22.45650568480292, 22.224849494794995, 20.187725979834795, 20.238570921123028, 20.406334392959252, 23.263578169047832, 23.271110333502293, 23.19082347303629, 14.552112462619931, 14.584491456548363, 14.184074680010468, 16.338349757095173, 15.843158652385071, 16.232054652025298, 17.70917384450634, 17.740149307375148, 17.7550826643904, 29.829113895694405, 30.5360117300103, 30.478338825205952, 16.351664538184792, 15.840364533166081, 16.07792033503452, 23.621369323382766, 23.60926334063211, 23.75154339025417, 24.868010941892862, 24.829231675714254, 24.594699077308178, 30.292276971042156, 30.246357664465904, 30.12828440219164, 17.549178903301552, 18.148446525757507, 18.11427278940876, 22.05852088580528, 22.33778376194337, 21.582384044925362, 21.56712422768274, 22.005282534907252, 21.63249264160791, 21.574728555977345, 21.97884288802743, 21.39181214570999, 17.85990368016064, 16.851553827524185, 17.58269263803959, 20.228950845698506, 20.533471981684357, 20.485329030702502, 22.589470381538064, 22.958165147031337, 22.83458015943566, 26.11646043509245, 25.108018577098846, 26.55998031864874, 24.824945988754422, 25.01217522347966, 24.600591647128255, 24.788949485868216, 24.506632402539253, 24.795314386487007, 22.70511157562335, 22.860364352663353, 23.047257789721087, 21.643369215230138, 22.177161605718226, 21.464085559050233, 19.86468559751907, 19.922715375820786, 20.055532498906047, 10.483631153901413, 10.637849287440375, 10.694795378794268, 29.09630039784436, 29.097283827917025, 29.092693726609767, 24.629278031488255, 24.35822944839795, 24.652461034556225, 20.78059949974218, 20.815221751729638, 21.2566438463206, 21.258527184526116, 21.135273943344743, 20.93674279252687, 26.971120975911617, 26.81531022489071, 27.0354173630476, 32.11395591994126, 32.22495653231938, 32.39602953692277, 20.639551897067577, 20.634296867530793, 20.539406703785062, 19.858254155764968, 19.263154471913964, 18.990709538261086, 20.25916940051441, 20.27258355154966, 20.102438793828085, 31.876660645008087, 32.56203458085656, 31.975887179374695, 26.744231462478638, 26.662200085818768, 26.533833771944046, 24.12717934480557, 23.766702974836022, 23.8387142146627, 26.214728375275925, 26.05515333016713, 26.422655676801995, 24.022355526685715, 24.066136311739683, 24.1227500513196, 23.531093381345272, 23.705522257834673, 23.32932811975479, 28.177741294105843, 27.756799658139542, 28.039337409039334, 9.301700917538255, 8.774131380021572, 9.279017087072134, 22.717844819029168, 23.250966121753052, 23.28643929523726, 16.40190344831595, 16.22341069454947, 16.235857001195342, 29.23171130319436, 29.108692084749535, 29.681026324008897, 24.35997388884425, 24.62487272778526, 24.07234938442707, 12.56878526632984, 12.721616530170039, 12.797229084380277, 28.96985017011562, 28.668404186765343, 29.062529581288487, 19.273497680823, 19.5865987005333, 19.477360280851514, 24.605348952114582, 24.29796753823757, 24.91271287575364, 25.829076682527855, 26.32375108947356, 25.704186399777726, 22.468864525357873, 21.841681281725556, 22.816446424617112, 20.86451096336046, 21.151939461628587, 20.814350376526505, 29.057895578444004, 27.926160991191864, 28.552727848291397, 25.82811744014421, 26.13081772873798, 26.39350752408305, 27.17110300064087, 26.897588275372982, 26.564271315932274, 20.81002523812154, 20.900242670128733, 20.479887823263795, 22.462636331717164, 23.169281526158244, 23.213511096934468, 28.22636901587248, 28.09328529238701, 28.23855160921812, 22.714770483473927, 23.218073477658123, 23.20379734101394, 25.095300560196236, 25.200417225559548, 24.722433050473526, 21.64871998007098, 21.402731182674557, 21.746657675753028, 17.15212448438008, 17.016948116322354, 16.944645298024014, 24.399084667364747, 24.577517988781125, 24.67668038296202, 20.12087160969773, 20.10946039358774, 19.21808440486589, 19.139336387316376, 19.194015150579304, 19.07294601450363, 14.904397594432027, 15.026322392436356, 14.888303036491067, 24.96564845368266, 24.792544178664684, 25.09099815785885, 18.148311632374913, 17.169986883799226, 17.532443995277077, 14.836974502851561, 14.515675534804657, 14.820055705805615, 21.762250758707523, 21.831175707280636, 21.90613616630435, 17.600024816890553, 17.205409472187355, 17.818898381044463, 20.594226218760014, 20.648607578128576, 20.320808611810207, 17.51011624683936, 17.040560131271675, 17.24948201080163, 21.48438160121441, 21.91573511622846, 21.940481863595778, 27.968623141447694, 28.13709347198406, 28.404062843571097, 30.9832309409976, 31.243097194470465, 30.987852685153484, 21.932298988103867, 21.684244722127914, 22.85023322328925, 18.745566981534154, 18.41196026901403, 18.926257996509463, 16.188500573237732, 16.182086442907647, 16.46665224184592, 23.191074552635342, 23.405477712551743, 23.338880269477755, 27.939478839437157, 28.36128910134235, 28.231236199537904, 25.46221074524024, 24.81631127993265, 25.21469162652889, 14.526493546863392, 14.808755384137228, 14.542829540868595, 17.292887438709528, 16.830097074309975, 16.95844431469837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564088114156117, "mean_inference_ms": 0.7129970892836538, "mean_action_processing_ms": 0.10073524204089666, "mean_env_wait_ms": 0.8193353346876953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 921024, "timesteps_this_iter": 0, "agent_timesteps_total": 2763072, "timers": {"sample_time_ms": 19821.395, "sample_throughput": 484.022, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3031.951, "learn_throughput": 3164.299, "update_time_ms": 9.104}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0608346201479436e-09, "cur_lr": 0.0005, "total_loss": 5.351951956748962, "policy_loss": -0.00130712736602423, "vf_loss": 5.487778425216675, "vf_explained_var": 0.05215270817279816, "kl": 0.003844232625982016, "entropy": 13.451911091804504, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 921024, "num_agent_steps_sampled": 2763072, "num_steps_trained": 921024, "num_agent_steps_trained": 2763072, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3859, "training_iteration": 96, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-15-56", "timestamp": 1706192156, "time_this_iter_s": 19.28867483139038, "time_total_s": 1955.9257128238678, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017AF310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1955.9257128238678, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 10.18888888888889, "ram_util_percent": 50.29259259259259}}
{"episode_reward_max": 96.73494198918341, "episode_reward_min": 27.35484938463196, "episode_reward_mean": 68.06863440630055, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 8.774131380021572}, "policy_reward_max": {"shared_policy": 32.56203458085656}, "policy_reward_mean": {"shared_policy": 22.68954480210018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.78445933084004, 74.43771285936234, 74.09089627489448, 68.61273371800779, 65.2846163799986, 59.8429334722459, 31.816275820136056, 87.28627795237115, 73.63996851444243, 62.85246509779242, 63.33054392039773, 80.82184856384993, 96.73494198918341, 61.81325546838343, 58.11211816594002, 60.63419174589215, 96.41458240523934, 79.94026532024145, 71.73259653430429, 78.69253738224505, 72.211241889745, 70.56594375893474, 83.97387836128472, 27.35484938463196, 69.25525023601948, 48.86117114406076, 88.02142971195279, 73.05719600105658, 38.087630880880155, 86.70078393816945, 58.33745666220781, 73.8160293661058, 77.85701417177914, 67.12699223170054, 62.83080080151555, 85.53678441792727, 78.35244269296524, 80.63296259194613, 62.19015573151407, 68.84542895480988, 84.55820591747761, 69.13664130214599, 75.01815083622931, 64.79810883849856, 51.11371789872645, 73.65328303910789, 59.44841640815136, 57.40629755239931, 44.81902302335945, 74.8491907902062, 52.850742511451216, 44.17270574346183, 65.49956263229251, 52.62433267012237, 61.5636424086988, 51.800158388912664, 65.34059858103865, 84.50977945700285, 93.21418082062155, 66.46677693352103, 56.08378524705765, 48.8372392579913, 69.93543253466484, 84.53200414031741, 75.49321365170178, 43.878078471869216, 51.08142882771787, 50.167877828702316, 85.89920735917984, 66.54349968396126, 69.0199534073472, 53.0392609797418, 75.01459962129591, 71.29198048636317, 57.765202708076686, 79.07669062167403, 91.1655710414052, 64.60407618898897, 82.315588735044, 30.914503987878533, 75.40322633646429, 68.47311313077807, 76.39611650630829, 55.070199302397654, 85.99571140855551, 71.17425791919229, 67.33227076102048, 64.71859519137068, 80.75079824030396, 54.44788582902402, 88.98559948801993, 68.05619824677703, 88.16348569840193, 70.79893432511014, 62.90542835555969, 82.33174959011374, 47.60478764399883, 65.66429765801874, 58.23339068144557, 77.36401993781327], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.11646043509245, 25.108018577098846, 26.55998031864874, 24.824945988754422, 25.01217522347966, 24.600591647128255, 24.788949485868216, 24.506632402539253, 24.795314386487007, 22.70511157562335, 22.860364352663353, 23.047257789721087, 21.643369215230138, 22.177161605718226, 21.464085559050233, 19.86468559751907, 19.922715375820786, 20.055532498906047, 10.483631153901413, 10.637849287440375, 10.694795378794268, 29.09630039784436, 29.097283827917025, 29.092693726609767, 24.629278031488255, 24.35822944839795, 24.652461034556225, 20.78059949974218, 20.815221751729638, 21.2566438463206, 21.258527184526116, 21.135273943344743, 20.93674279252687, 26.971120975911617, 26.81531022489071, 27.0354173630476, 32.11395591994126, 32.22495653231938, 32.39602953692277, 20.639551897067577, 20.634296867530793, 20.539406703785062, 19.858254155764968, 19.263154471913964, 18.990709538261086, 20.25916940051441, 20.27258355154966, 20.102438793828085, 31.876660645008087, 32.56203458085656, 31.975887179374695, 26.744231462478638, 26.662200085818768, 26.533833771944046, 24.12717934480557, 23.766702974836022, 23.8387142146627, 26.214728375275925, 26.05515333016713, 26.422655676801995, 24.022355526685715, 24.066136311739683, 24.1227500513196, 23.531093381345272, 23.705522257834673, 23.32932811975479, 28.177741294105843, 27.756799658139542, 28.039337409039334, 9.301700917538255, 8.774131380021572, 9.279017087072134, 22.717844819029168, 23.250966121753052, 23.28643929523726, 16.40190344831595, 16.22341069454947, 16.235857001195342, 29.23171130319436, 29.108692084749535, 29.681026324008897, 24.35997388884425, 24.62487272778526, 24.07234938442707, 12.56878526632984, 12.721616530170039, 12.797229084380277, 28.96985017011562, 28.668404186765343, 29.062529581288487, 19.273497680823, 19.5865987005333, 19.477360280851514, 24.605348952114582, 24.29796753823757, 24.91271287575364, 25.829076682527855, 26.32375108947356, 25.704186399777726, 22.468864525357873, 21.841681281725556, 22.816446424617112, 20.86451096336046, 21.151939461628587, 20.814350376526505, 29.057895578444004, 27.926160991191864, 28.552727848291397, 25.82811744014421, 26.13081772873798, 26.39350752408305, 27.17110300064087, 26.897588275372982, 26.564271315932274, 20.81002523812154, 20.900242670128733, 20.479887823263795, 22.462636331717164, 23.169281526158244, 23.213511096934468, 28.22636901587248, 28.09328529238701, 28.23855160921812, 22.714770483473927, 23.218073477658123, 23.20379734101394, 25.095300560196236, 25.200417225559548, 24.722433050473526, 21.64871998007098, 21.402731182674557, 21.746657675753028, 17.15212448438008, 17.016948116322354, 16.944645298024014, 24.399084667364747, 24.577517988781125, 24.67668038296202, 20.12087160969773, 20.10946039358774, 19.21808440486589, 19.139336387316376, 19.194015150579304, 19.07294601450363, 14.904397594432027, 15.026322392436356, 14.888303036491067, 24.96564845368266, 24.792544178664684, 25.09099815785885, 18.148311632374913, 17.169986883799226, 17.532443995277077, 14.836974502851561, 14.515675534804657, 14.820055705805615, 21.762250758707523, 21.831175707280636, 21.90613616630435, 17.600024816890553, 17.205409472187355, 17.818898381044463, 20.594226218760014, 20.648607578128576, 20.320808611810207, 17.51011624683936, 17.040560131271675, 17.24948201080163, 21.48438160121441, 21.91573511622846, 21.940481863595778, 27.968623141447694, 28.13709347198406, 28.404062843571097, 30.9832309409976, 31.243097194470465, 30.987852685153484, 21.932298988103867, 21.684244722127914, 22.85023322328925, 18.745566981534154, 18.41196026901403, 18.926257996509463, 16.188500573237732, 16.182086442907647, 16.46665224184592, 23.191074552635342, 23.405477712551743, 23.338880269477755, 27.939478839437157, 28.36128910134235, 28.231236199537904, 25.46221074524024, 24.81631127993265, 25.21469162652889, 14.526493546863392, 14.808755384137228, 14.542829540868595, 17.292887438709528, 16.830097074309975, 16.95844431469837, 16.256632437308625, 16.958625200514987, 16.952620190878704, 28.54032689084609, 28.35158800085385, 29.0072924674799, 21.919006561239556, 22.3337450393786, 22.290748083343104, 23.085697039961815, 23.01502899080515, 22.91922737658024, 17.614766237636402, 17.612211917837456, 17.81228282426794, 24.92403308053811, 24.94835564990838, 25.142210890849427, 23.77895972505212, 23.61820687353611, 23.894813887774944, 19.380914924200624, 19.34739667363465, 19.036891110241413, 26.315138558546693, 26.42407718549171, 26.33747487763563, 30.251157984137535, 30.535766623914242, 30.378646433353424, 21.115535025795296, 21.81472593763222, 21.673815225561455, 27.411727741360664, 27.47916030138731, 27.424700692296028, 10.19098414729038, 10.094250726203114, 10.629269114385039, 25.065026342868805, 24.848554119467735, 25.489645874127746, 22.991667348891497, 22.510413467884064, 22.971032314002514, 25.453565171609313, 25.436164806286484, 25.50638652841249, 18.62481431321551, 18.101312068601445, 18.3440729205807, 28.66718278080225, 28.496224030852318, 28.83230459690094, 23.575357149044663, 23.89682679126659, 23.70207397888103, 22.76931527722627, 22.04445745050907, 22.51849803328514, 21.28207692255576, 21.645817098518208, 21.790701170296714, 27.066230988750846, 26.770572076241166, 26.913995175311953, 18.503104998730123, 18.361768383532763, 17.58301244676113, 29.690790252139166, 29.560112973054245, 29.734696262826517, 22.733216087023408, 22.50434214870134, 22.81864001105228, 29.23935130983591, 29.396853901445866, 29.52728048712015, 23.364653224746377, 23.84881436654055, 23.58546673382321, 20.705644597609833, 21.21751579207678, 20.982267965873078, 27.742985933398202, 27.320865494509533, 27.26789816220601, 16.00480181972185, 15.899300909290702, 15.700684914986283, 21.87436295176545, 22.050845408501715, 21.739089297751576, 18.062647024790436, 20.018217379848153, 20.15252627680698, 25.627722044785813, 25.542213072379425, 26.19408482064803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15635990578976044, "mean_inference_ms": 0.7128222156350954, "mean_action_processing_ms": 0.10066704480128025, "mean_env_wait_ms": 0.8191096398762951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 930618, "timesteps_this_iter": 0, "agent_timesteps_total": 2791854, "timers": {"sample_time_ms": 19888.003, "sample_throughput": 482.401, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3041.672, "learn_throughput": 3154.186, "update_time_ms": 8.804}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.304173100739718e-10, "cur_lr": 0.0005, "total_loss": 6.815425395965576, "policy_loss": -0.0002761130924013866, "vf_loss": 6.94788122177124, "vf_explained_var": 0.07877803593873978, "kl": 0.003427378775207688, "entropy": 13.217992424964905, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 930618, "num_agent_steps_sampled": 2791854, "num_steps_trained": 930618, "num_agent_steps_trained": 2791854, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3892, "training_iteration": 97, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-16-15", "timestamp": 1706192175, "time_this_iter_s": 19.456631898880005, "time_total_s": 1975.3823447227478, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205C3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1975.3823447227478, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 8.642857142857142, "ram_util_percent": 50.19285714285716}}
{"episode_reward_max": 93.21418082062155, "episode_reward_min": -258.84749288111925, "episode_reward_mean": 62.88139843396355, "episode_len_mean": 299.99, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -86.51123009125392}, "policy_reward_max": {"shared_policy": 31.243097194470465}, "policy_reward_mean": {"shared_policy": 20.96046614465451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.8160293661058, 77.85701417177914, 67.12699223170054, 62.83080080151555, 85.53678441792727, 78.35244269296524, 80.63296259194613, 62.19015573151407, 68.84542895480988, 84.55820591747761, 69.13664130214599, 75.01815083622931, 64.79810883849856, 51.11371789872645, 73.65328303910789, 59.44841640815136, 57.40629755239931, 44.81902302335945, 74.8491907902062, 52.850742511451216, 44.17270574346183, 65.49956263229251, 52.62433267012237, 61.5636424086988, 51.800158388912664, 65.34059858103865, 84.50977945700285, 93.21418082062155, 66.46677693352103, 56.08378524705765, 48.8372392579913, 69.93543253466484, 84.53200414031741, 75.49321365170178, 43.878078471869216, 51.08142882771787, 50.167877828702316, 85.89920735917984, 66.54349968396126, 69.0199534073472, 53.0392609797418, 75.01459962129591, 71.29198048636317, 57.765202708076686, 79.07669062167403, 91.1655710414052, 64.60407618898897, 82.315588735044, 30.914503987878533, 75.40322633646429, 68.47311313077807, 76.39611650630829, 55.070199302397654, 85.99571140855551, 71.17425791919229, 67.33227076102048, 64.71859519137068, 80.75079824030396, 54.44788582902402, 88.98559948801993, 68.05619824677703, 88.16348569840193, 70.79893432511014, 62.90542835555969, 82.33174959011374, 47.60478764399883, 65.66429765801874, 58.23339068144557, 77.36401993781327, 61.15813510119912, 80.05538729188265, 38.63242746889591, 71.25200995057821, 62.998987079597995, 72.79468314000404, 30.620444531086804, 42.0970483459532, 72.26581580936906, 92.85564194619656, 76.26714969053862, 45.23689570045099, 73.35677449777721, 56.56125623732805, 70.00635303556919, 87.48873460665345, 69.94736438244578, 54.191173527389765, 58.80251460522413, 52.69303309731184, 61.839091759175034, 60.384029017761335, 59.321631690021604, 48.58493261784314, 87.29966044053434, -258.84749288111925, 75.15478263050318, 80.13444718276877, 75.8076369781047, 69.84950526244936, -7.2315990924835205], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.605348952114582, 24.29796753823757, 24.91271287575364, 25.829076682527855, 26.32375108947356, 25.704186399777726, 22.468864525357873, 21.841681281725556, 22.816446424617112, 20.86451096336046, 21.151939461628587, 20.814350376526505, 29.057895578444004, 27.926160991191864, 28.552727848291397, 25.82811744014421, 26.13081772873798, 26.39350752408305, 27.17110300064087, 26.897588275372982, 26.564271315932274, 20.81002523812154, 20.900242670128733, 20.479887823263795, 22.462636331717164, 23.169281526158244, 23.213511096934468, 28.22636901587248, 28.09328529238701, 28.23855160921812, 22.714770483473927, 23.218073477658123, 23.20379734101394, 25.095300560196236, 25.200417225559548, 24.722433050473526, 21.64871998007098, 21.402731182674557, 21.746657675753028, 17.15212448438008, 17.016948116322354, 16.944645298024014, 24.399084667364747, 24.577517988781125, 24.67668038296202, 20.12087160969773, 20.10946039358774, 19.21808440486589, 19.139336387316376, 19.194015150579304, 19.07294601450363, 14.904397594432027, 15.026322392436356, 14.888303036491067, 24.96564845368266, 24.792544178664684, 25.09099815785885, 18.148311632374913, 17.169986883799226, 17.532443995277077, 14.836974502851561, 14.515675534804657, 14.820055705805615, 21.762250758707523, 21.831175707280636, 21.90613616630435, 17.600024816890553, 17.205409472187355, 17.818898381044463, 20.594226218760014, 20.648607578128576, 20.320808611810207, 17.51011624683936, 17.040560131271675, 17.24948201080163, 21.48438160121441, 21.91573511622846, 21.940481863595778, 27.968623141447694, 28.13709347198406, 28.404062843571097, 30.9832309409976, 31.243097194470465, 30.987852685153484, 21.932298988103867, 21.684244722127914, 22.85023322328925, 18.745566981534154, 18.41196026901403, 18.926257996509463, 16.188500573237732, 16.182086442907647, 16.46665224184592, 23.191074552635342, 23.405477712551743, 23.338880269477755, 27.939478839437157, 28.36128910134235, 28.231236199537904, 25.46221074524024, 24.81631127993265, 25.21469162652889, 14.526493546863392, 14.808755384137228, 14.542829540868595, 17.292887438709528, 16.830097074309975, 16.95844431469837, 16.256632437308625, 16.958625200514987, 16.952620190878704, 28.54032689084609, 28.35158800085385, 29.0072924674799, 21.919006561239556, 22.3337450393786, 22.290748083343104, 23.085697039961815, 23.01502899080515, 22.91922737658024, 17.614766237636402, 17.612211917837456, 17.81228282426794, 24.92403308053811, 24.94835564990838, 25.142210890849427, 23.77895972505212, 23.61820687353611, 23.894813887774944, 19.380914924200624, 19.34739667363465, 19.036891110241413, 26.315138558546693, 26.42407718549171, 26.33747487763563, 30.251157984137535, 30.535766623914242, 30.378646433353424, 21.115535025795296, 21.81472593763222, 21.673815225561455, 27.411727741360664, 27.47916030138731, 27.424700692296028, 10.19098414729038, 10.094250726203114, 10.629269114385039, 25.065026342868805, 24.848554119467735, 25.489645874127746, 22.991667348891497, 22.510413467884064, 22.971032314002514, 25.453565171609313, 25.436164806286484, 25.50638652841249, 18.62481431321551, 18.101312068601445, 18.3440729205807, 28.66718278080225, 28.496224030852318, 28.83230459690094, 23.575357149044663, 23.89682679126659, 23.70207397888103, 22.76931527722627, 22.04445745050907, 22.51849803328514, 21.28207692255576, 21.645817098518208, 21.790701170296714, 27.066230988750846, 26.770572076241166, 26.913995175311953, 18.503104998730123, 18.361768383532763, 17.58301244676113, 29.690790252139166, 29.560112973054245, 29.734696262826517, 22.733216087023408, 22.50434214870134, 22.81864001105228, 29.23935130983591, 29.396853901445866, 29.52728048712015, 23.364653224746377, 23.84881436654055, 23.58546673382321, 20.705644597609833, 21.21751579207678, 20.982267965873078, 27.742985933398202, 27.320865494509533, 27.26789816220601, 16.00480181972185, 15.899300909290702, 15.700684914986283, 21.87436295176545, 22.050845408501715, 21.739089297751576, 18.062647024790436, 20.018217379848153, 20.15252627680698, 25.627722044785813, 25.542213072379425, 26.19408482064803, 19.02049599091211, 20.961814465622098, 21.175824644664914, 26.72950113005936, 26.485209211707115, 26.840676950116176, 12.933574665337801, 13.096254628151655, 12.602598175406456, 23.678658545017242, 23.84234530478716, 23.73100610077381, 20.97637937155862, 21.011413710502282, 21.01119399753709, 24.23312848930557, 24.427979068442554, 24.133575582255915, 10.240997771422059, 10.636015524311603, 9.743431235353142, 14.199189970890671, 13.903547691802174, 13.994310683260352, 23.9864474783341, 24.033188472191483, 24.246179858843476, 30.768366366624832, 30.99689321964979, 31.090382359921932, 25.216841424504906, 25.609184621522814, 25.441123644510895, 14.910928837954998, 15.23674397310242, 15.089222889393568, 24.628748202075556, 24.380135496457413, 24.34789079924424, 18.967312313616276, 18.625436685979366, 18.96850723773241, 23.443928565829992, 23.449915293604136, 23.112509176135063, 29.333707757294178, 29.152206864207983, 29.00281998515129, 23.227393383781106, 23.349626733611018, 23.37034426505366, 18.133468829095364, 17.929019197821617, 18.128685500472784, 19.65248603001237, 19.45495469123125, 19.695073883980513, 17.494403285284832, 17.740500721459583, 17.458129090567425, 20.47636619458595, 20.612204770247132, 20.750520794341952, 20.04105581839879, 20.277984812234834, 20.064988387127713, 19.855300904717296, 19.773018091917038, 19.69331269338727, 16.01123697062333, 16.071641360719994, 16.502054286499813, 29.230620959152773, 29.09749102344115, 28.971548457940415, -86.13717104742925, -86.51123009125392, -86.1990917424361, 25.04594025015831, 25.06292213499546, 25.045920245349407, 26.515653786559895, 26.890622564210688, 26.728170831998185, 25.38206325595577, 25.472571055715278, 24.953002666433648, 23.283833450327307, 23.404006593550235, 23.161665218571812, -2.2489141672849655, -2.551683261990547, -2.431001663208008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15635471978767057, "mean_inference_ms": 0.7128661982766695, "mean_action_processing_ms": 0.1006789232114712, "mean_env_wait_ms": 0.8189003701530017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 940212, "timesteps_this_iter": 0, "agent_timesteps_total": 2820636, "timers": {"sample_time_ms": 20050.447, "sample_throughput": 478.493, "load_time_ms": 0.1, "load_throughput": 95832704.396, "learn_time_ms": 3051.435, "learn_throughput": 3144.095, "update_time_ms": 8.797}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.652086550369859e-10, "cur_lr": 0.0005, "total_loss": 66.89633274078369, "policy_loss": -0.00035484706083277473, "vf_loss": 67.03019905090332, "vf_explained_var": 0.026398979127407074, "kl": 0.009256299614330672, "entropy": 13.35096299648285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940212, "num_agent_steps_sampled": 2820636, "num_steps_trained": 940212, "num_agent_steps_trained": 2820636, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3923, "training_iteration": 98, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-16-36", "timestamp": 1706192196, "time_this_iter_s": 20.565464973449707, "time_total_s": 1995.9478096961975, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1995.9478096961975, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.755172413793105, "ram_util_percent": 50.43793103448276}}
{"episode_reward_max": 92.85564194619656, "episode_reward_min": -258.84749288111925, "episode_reward_mean": 62.39897923703837, "episode_len_mean": 299.99, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -86.51123009125392}, "policy_reward_max": {"shared_policy": 31.090382359921932}, "policy_reward_mean": {"shared_policy": 20.79965974567945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.49321365170178, 43.878078471869216, 51.08142882771787, 50.167877828702316, 85.89920735917984, 66.54349968396126, 69.0199534073472, 53.0392609797418, 75.01459962129591, 71.29198048636317, 57.765202708076686, 79.07669062167403, 91.1655710414052, 64.60407618898897, 82.315588735044, 30.914503987878533, 75.40322633646429, 68.47311313077807, 76.39611650630829, 55.070199302397654, 85.99571140855551, 71.17425791919229, 67.33227076102048, 64.71859519137068, 80.75079824030396, 54.44788582902402, 88.98559948801993, 68.05619824677703, 88.16348569840193, 70.79893432511014, 62.90542835555969, 82.33174959011374, 47.60478764399883, 65.66429765801874, 58.23339068144557, 77.36401993781327, 61.15813510119912, 80.05538729188265, 38.63242746889591, 71.25200995057821, 62.998987079597995, 72.79468314000404, 30.620444531086804, 42.0970483459532, 72.26581580936906, 92.85564194619656, 76.26714969053862, 45.23689570045099, 73.35677449777721, 56.56125623732805, 70.00635303556919, 87.48873460665345, 69.94736438244578, 54.191173527389765, 58.80251460522413, 52.69303309731184, 61.839091759175034, 60.384029017761335, 59.321631690021604, 48.58493261784314, 87.29966044053434, -258.84749288111925, 75.15478263050318, 80.13444718276877, 75.8076369781047, 69.84950526244936, -7.2315990924835205, 86.41392472386357, 67.14256081730127, 73.94164545647797, 55.03530088253318, 72.05720062903129, 74.66053716093302, 64.58699803426862, 58.462407380342455, 70.3823709487915, 68.83571948949246, 59.32719371840355, 82.19117287546396, 75.10424057580529, 69.34796019271013, 52.82686151005326, 85.96329213818534, 79.23674151860175, 77.54331159591675, 49.18165785446763, 88.57218634709716, 78.53063953667878, 38.176595274358974, 59.892697488889084, 48.20927117019889, 37.95323865860698, 61.570518612861605, 75.41682617086917, 65.7500482071191, 63.87708906084298, 70.13387476652858, 59.1116329273209, 45.44353758171201, 46.29941489547491], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.46221074524024, 24.81631127993265, 25.21469162652889, 14.526493546863392, 14.808755384137228, 14.542829540868595, 17.292887438709528, 16.830097074309975, 16.95844431469837, 16.256632437308625, 16.958625200514987, 16.952620190878704, 28.54032689084609, 28.35158800085385, 29.0072924674799, 21.919006561239556, 22.3337450393786, 22.290748083343104, 23.085697039961815, 23.01502899080515, 22.91922737658024, 17.614766237636402, 17.612211917837456, 17.81228282426794, 24.92403308053811, 24.94835564990838, 25.142210890849427, 23.77895972505212, 23.61820687353611, 23.894813887774944, 19.380914924200624, 19.34739667363465, 19.036891110241413, 26.315138558546693, 26.42407718549171, 26.33747487763563, 30.251157984137535, 30.535766623914242, 30.378646433353424, 21.115535025795296, 21.81472593763222, 21.673815225561455, 27.411727741360664, 27.47916030138731, 27.424700692296028, 10.19098414729038, 10.094250726203114, 10.629269114385039, 25.065026342868805, 24.848554119467735, 25.489645874127746, 22.991667348891497, 22.510413467884064, 22.971032314002514, 25.453565171609313, 25.436164806286484, 25.50638652841249, 18.62481431321551, 18.101312068601445, 18.3440729205807, 28.66718278080225, 28.496224030852318, 28.83230459690094, 23.575357149044663, 23.89682679126659, 23.70207397888103, 22.76931527722627, 22.04445745050907, 22.51849803328514, 21.28207692255576, 21.645817098518208, 21.790701170296714, 27.066230988750846, 26.770572076241166, 26.913995175311953, 18.503104998730123, 18.361768383532763, 17.58301244676113, 29.690790252139166, 29.560112973054245, 29.734696262826517, 22.733216087023408, 22.50434214870134, 22.81864001105228, 29.23935130983591, 29.396853901445866, 29.52728048712015, 23.364653224746377, 23.84881436654055, 23.58546673382321, 20.705644597609833, 21.21751579207678, 20.982267965873078, 27.742985933398202, 27.320865494509533, 27.26789816220601, 16.00480181972185, 15.899300909290702, 15.700684914986283, 21.87436295176545, 22.050845408501715, 21.739089297751576, 18.062647024790436, 20.018217379848153, 20.15252627680698, 25.627722044785813, 25.542213072379425, 26.19408482064803, 19.02049599091211, 20.961814465622098, 21.175824644664914, 26.72950113005936, 26.485209211707115, 26.840676950116176, 12.933574665337801, 13.096254628151655, 12.602598175406456, 23.678658545017242, 23.84234530478716, 23.73100610077381, 20.97637937155862, 21.011413710502282, 21.01119399753709, 24.23312848930557, 24.427979068442554, 24.133575582255915, 10.240997771422059, 10.636015524311603, 9.743431235353142, 14.199189970890671, 13.903547691802174, 13.994310683260352, 23.9864474783341, 24.033188472191483, 24.246179858843476, 30.768366366624832, 30.99689321964979, 31.090382359921932, 25.216841424504906, 25.609184621522814, 25.441123644510895, 14.910928837954998, 15.23674397310242, 15.089222889393568, 24.628748202075556, 24.380135496457413, 24.34789079924424, 18.967312313616276, 18.625436685979366, 18.96850723773241, 23.443928565829992, 23.449915293604136, 23.112509176135063, 29.333707757294178, 29.152206864207983, 29.00281998515129, 23.227393383781106, 23.349626733611018, 23.37034426505366, 18.133468829095364, 17.929019197821617, 18.128685500472784, 19.65248603001237, 19.45495469123125, 19.695073883980513, 17.494403285284832, 17.740500721459583, 17.458129090567425, 20.47636619458595, 20.612204770247132, 20.750520794341952, 20.04105581839879, 20.277984812234834, 20.064988387127713, 19.855300904717296, 19.773018091917038, 19.69331269338727, 16.01123697062333, 16.071641360719994, 16.502054286499813, 29.230620959152773, 29.09749102344115, 28.971548457940415, -86.13717104742925, -86.51123009125392, -86.1990917424361, 25.04594025015831, 25.06292213499546, 25.045920245349407, 26.515653786559895, 26.890622564210688, 26.728170831998185, 25.38206325595577, 25.472571055715278, 24.953002666433648, 23.283833450327307, 23.404006593550235, 23.161665218571812, -2.2489141672849655, -2.551683261990547, -2.431001663208008, 28.968361942718417, 28.522783155242593, 28.922779625902564, 22.032087221741676, 22.594261839985847, 22.51621175557375, 24.38985851655403, 24.702264099071414, 24.84952284085253, 18.525860450540975, 18.18398768206437, 18.325452749927834, 24.0564309284091, 24.1909521704074, 23.809817530214787, 24.939683362841606, 24.570656329393387, 25.150197468698025, 21.38522206991911, 21.47913309931755, 21.722642865031958, 19.452702345947415, 19.496981816987187, 19.512723217407853, 23.554848209023476, 23.455667942762375, 23.371854797005653, 22.594289933641747, 22.90174987663825, 23.339679679212466, 19.76453028495112, 19.7512720512847, 19.811391382167727, 27.598192114382982, 27.054734751582146, 27.538246009498835, 24.792893310387925, 25.288483738278345, 25.022863527139023, 22.87971921513477, 23.204496486733348, 23.263744490842015, 17.318586726983384, 17.620446515580014, 17.887828267489866, 28.111975540717438, 28.87545858820279, 28.97585800926511, 26.263514923552663, 26.379268447558076, 26.59395814749101, 25.898674450814724, 25.745502434670925, 25.8991347104311, 16.423619356006384, 16.365776475518942, 16.392262022942305, 29.56212390959263, 29.488996852189302, 29.521065585315228, 26.073086713751152, 26.134339315195874, 26.32321350773175, 12.33970621724923, 13.128196859111384, 12.70869219799836, 20.10076889333625, 19.938458879788712, 19.85346971576412, 16.079974273840577, 16.27905166397491, 15.8502452323834, 12.606893400351197, 12.685739821443946, 12.660605436811835, 20.469086604813725, 20.420459533731133, 20.680972474316746, 24.894885659217834, 25.275046220980585, 25.246894290670753, 21.969882895549134, 22.01221598622699, 21.76794932534297, 21.520921525855854, 21.388430272539452, 20.96773726244767, 23.4334275300304, 23.29650206367174, 23.40394517282644, 20.125138110481203, 19.66558464616537, 19.320910170674324, 15.09344557672739, 15.04113207012415, 15.308959934860468, 15.52073085680604, 15.244745686650276, 15.533938352018595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15630068751010176, "mean_inference_ms": 0.7126929044843356, "mean_action_processing_ms": 0.10062872532401965, "mean_env_wait_ms": 0.8186526542600852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 949806, "timesteps_this_iter": 0, "agent_timesteps_total": 2849418, "timers": {"sample_time_ms": 20182.589, "sample_throughput": 475.36, "load_time_ms": 0.199, "load_throughput": 48099632.532, "learn_time_ms": 3048.069, "learn_throughput": 3147.566, "update_time_ms": 8.697}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.652086550369859e-10, "cur_lr": 0.0005, "total_loss": 5.49578857421875, "policy_loss": -6.865693852664556e-05, "vf_loss": 5.628939986228943, "vf_explained_var": 0.12637025117874146, "kl": 0.004135371273274709, "entropy": 13.308285236358643, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 949806, "num_agent_steps_sampled": 2849418, "num_steps_trained": 949806, "num_agent_steps_trained": 2849418, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3956, "training_iteration": 99, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-16-56", "timestamp": 1706192216, "time_this_iter_s": 20.31338143348694, "time_total_s": 2016.2611911296844, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01626A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2016.2611911296844, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 8.906896551724136, "ram_util_percent": 50.46551724137931}}
{"episode_reward_max": 95.85523238300811, "episode_reward_min": -258.84749288111925, "episode_reward_mean": 61.57164274629504, "episode_len_mean": 299.99, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -86.51123009125392}, "policy_reward_max": {"shared_policy": 32.32356828718912}, "policy_reward_mean": {"shared_policy": 20.523880915431672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.33174959011374, 47.60478764399883, 65.66429765801874, 58.23339068144557, 77.36401993781327, 61.15813510119912, 80.05538729188265, 38.63242746889591, 71.25200995057821, 62.998987079597995, 72.79468314000404, 30.620444531086804, 42.0970483459532, 72.26581580936906, 92.85564194619656, 76.26714969053862, 45.23689570045099, 73.35677449777721, 56.56125623732805, 70.00635303556919, 87.48873460665345, 69.94736438244578, 54.191173527389765, 58.80251460522413, 52.69303309731184, 61.839091759175034, 60.384029017761335, 59.321631690021604, 48.58493261784314, 87.29966044053434, -258.84749288111925, 75.15478263050318, 80.13444718276877, 75.8076369781047, 69.84950526244936, -7.2315990924835205, 86.41392472386357, 67.14256081730127, 73.94164545647797, 55.03530088253318, 72.05720062903129, 74.66053716093302, 64.58699803426862, 58.462407380342455, 70.3823709487915, 68.83571948949246, 59.32719371840355, 82.19117287546396, 75.10424057580529, 69.34796019271013, 52.82686151005326, 85.96329213818534, 79.23674151860175, 77.54331159591675, 49.18165785446763, 88.57218634709716, 78.53063953667878, 38.176595274358974, 59.892697488889084, 48.20927117019889, 37.95323865860698, 61.570518612861605, 75.41682617086917, 65.7500482071191, 63.87708906084298, 70.13387476652858, 59.1116329273209, 45.44353758171201, 46.29941489547491, 51.38131590373813, 78.97669930942357, 61.58183743432161, 80.74298381060359, 63.138246295973644, 66.32354432716963, 70.79409937560555, 65.89541036263105, 73.61681313160807, 69.10749659687278, 63.53876667283474, 71.96410814486443, 84.59588732570407, 90.9299262500135, 51.35997141897677, 95.85523238300811, 46.48721989244221, 55.699355229735374, 19.474832881242023, 61.71759770810603, 88.06136059761045, 84.66665018722415, 26.98865289799869, 68.60729869967327, 70.49305346421896, 60.19904997199774, 61.54482084512709, 68.50526165217158, 39.972214721143246, 74.74821841530499, 76.24097935855387], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.742985933398202, 27.320865494509533, 27.26789816220601, 16.00480181972185, 15.899300909290702, 15.700684914986283, 21.87436295176545, 22.050845408501715, 21.739089297751576, 18.062647024790436, 20.018217379848153, 20.15252627680698, 25.627722044785813, 25.542213072379425, 26.19408482064803, 19.02049599091211, 20.961814465622098, 21.175824644664914, 26.72950113005936, 26.485209211707115, 26.840676950116176, 12.933574665337801, 13.096254628151655, 12.602598175406456, 23.678658545017242, 23.84234530478716, 23.73100610077381, 20.97637937155862, 21.011413710502282, 21.01119399753709, 24.23312848930557, 24.427979068442554, 24.133575582255915, 10.240997771422059, 10.636015524311603, 9.743431235353142, 14.199189970890671, 13.903547691802174, 13.994310683260352, 23.9864474783341, 24.033188472191483, 24.246179858843476, 30.768366366624832, 30.99689321964979, 31.090382359921932, 25.216841424504906, 25.609184621522814, 25.441123644510895, 14.910928837954998, 15.23674397310242, 15.089222889393568, 24.628748202075556, 24.380135496457413, 24.34789079924424, 18.967312313616276, 18.625436685979366, 18.96850723773241, 23.443928565829992, 23.449915293604136, 23.112509176135063, 29.333707757294178, 29.152206864207983, 29.00281998515129, 23.227393383781106, 23.349626733611018, 23.37034426505366, 18.133468829095364, 17.929019197821617, 18.128685500472784, 19.65248603001237, 19.45495469123125, 19.695073883980513, 17.494403285284832, 17.740500721459583, 17.458129090567425, 20.47636619458595, 20.612204770247132, 20.750520794341952, 20.04105581839879, 20.277984812234834, 20.064988387127713, 19.855300904717296, 19.773018091917038, 19.69331269338727, 16.01123697062333, 16.071641360719994, 16.502054286499813, 29.230620959152773, 29.09749102344115, 28.971548457940415, -86.13717104742925, -86.51123009125392, -86.1990917424361, 25.04594025015831, 25.06292213499546, 25.045920245349407, 26.515653786559895, 26.890622564210688, 26.728170831998185, 25.38206325595577, 25.472571055715278, 24.953002666433648, 23.283833450327307, 23.404006593550235, 23.161665218571812, -2.2489141672849655, -2.551683261990547, -2.431001663208008, 28.968361942718417, 28.522783155242593, 28.922779625902564, 22.032087221741676, 22.594261839985847, 22.51621175557375, 24.38985851655403, 24.702264099071414, 24.84952284085253, 18.525860450540975, 18.18398768206437, 18.325452749927834, 24.0564309284091, 24.1909521704074, 23.809817530214787, 24.939683362841606, 24.570656329393387, 25.150197468698025, 21.38522206991911, 21.47913309931755, 21.722642865031958, 19.452702345947415, 19.496981816987187, 19.512723217407853, 23.554848209023476, 23.455667942762375, 23.371854797005653, 22.594289933641747, 22.90174987663825, 23.339679679212466, 19.76453028495112, 19.7512720512847, 19.811391382167727, 27.598192114382982, 27.054734751582146, 27.538246009498835, 24.792893310387925, 25.288483738278345, 25.022863527139023, 22.87971921513477, 23.204496486733348, 23.263744490842015, 17.318586726983384, 17.620446515580014, 17.887828267489866, 28.111975540717438, 28.87545858820279, 28.97585800926511, 26.263514923552663, 26.379268447558076, 26.59395814749101, 25.898674450814724, 25.745502434670925, 25.8991347104311, 16.423619356006384, 16.365776475518942, 16.392262022942305, 29.56212390959263, 29.488996852189302, 29.521065585315228, 26.073086713751152, 26.134339315195874, 26.32321350773175, 12.33970621724923, 13.128196859111384, 12.70869219799836, 20.10076889333625, 19.938458879788712, 19.85346971576412, 16.079974273840577, 16.27905166397491, 15.8502452323834, 12.606893400351197, 12.685739821443946, 12.660605436811835, 20.469086604813725, 20.420459533731133, 20.680972474316746, 24.894885659217834, 25.275046220980585, 25.246894290670753, 21.969882895549134, 22.01221598622699, 21.76794932534297, 21.520921525855854, 21.388430272539452, 20.96773726244767, 23.4334275300304, 23.29650206367174, 23.40394517282644, 20.125138110481203, 19.66558464616537, 19.320910170674324, 15.09344557672739, 15.04113207012415, 15.308959934860468, 15.52073085680604, 15.244745686650276, 15.533938352018595, 16.864349534114197, 18.065327889596418, 16.451638480027512, 26.00949890911579, 26.46662900224328, 26.500571398064494, 20.61515691752234, 20.422608489791543, 20.54407202700773, 27.482086988786847, 27.020037333170563, 26.24085948864618, 20.9422733609875, 20.949385200937584, 21.24658773404856, 21.728975276152283, 22.352982467661292, 22.241586583356053, 23.432224030296, 23.621319803098828, 23.74055554221073, 22.081567550698907, 21.97344701612988, 21.840395795802266, 24.905035079456866, 24.666543684899807, 24.045234367251396, 22.123971472183854, 23.416009138027817, 23.567515986661107, 20.907740031679467, 21.355420776953295, 21.275605864201978, 23.804079813261822, 24.00465352212389, 24.155374809478715, 28.289578358332307, 28.019798050324113, 28.28651091704765, 30.263643282155186, 30.700899204743706, 29.965383763114602, 17.00836632152398, 17.05144952734311, 17.30015557010968, 31.734021104872227, 31.79764299094677, 32.32356828718912, 15.631695178647831, 15.698050459225968, 15.157474254568413, 18.271404765546322, 18.673694375902414, 18.75425608828664, 6.465193641682461, 6.506515772392348, 6.503123467167214, 20.607288931806877, 20.65410465498765, 20.4562041213115, 29.2382450873653, 29.111424359182507, 29.711691151062638, 28.301500238478184, 28.47715451195836, 27.887995436787605, 8.876624703407288, 9.223789004608989, 8.888239189982414, 22.977766428142786, 22.48182864487171, 23.147703626658767, 23.53429114942749, 23.560995604222015, 23.397766710569456, 20.113811381161213, 19.984721280634403, 20.10051731020212, 20.484028716882065, 20.51400366922219, 20.546788459022835, 22.633862557510525, 23.164528558651597, 22.70687053600946, 13.394340060651302, 13.386913508176804, 13.19096115231514, 24.80601121733585, 25.133881681288273, 24.808325516680867, 25.582110111912087, 25.011673991878823, 25.647195254762963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1562842210735432, "mean_inference_ms": 0.7127568893789648, "mean_action_processing_ms": 0.10065683919998193, "mean_env_wait_ms": 0.8184412404737591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 959400, "timesteps_this_iter": 0, "agent_timesteps_total": 2878200, "timers": {"sample_time_ms": 20099.416, "sample_throughput": 477.327, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3041.918, "learn_throughput": 3153.931, "update_time_ms": 8.748}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3260432751849295e-10, "cur_lr": 0.0005, "total_loss": 6.998616278171539, "policy_loss": -0.00020466260265949998, "vf_loss": 7.135594010353088, "vf_explained_var": 0.04150272160768509, "kl": 0.0034307492316169347, "entropy": 13.677344560623169, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 959400, "num_agent_steps_sampled": 2878200, "num_steps_trained": 959400, "num_agent_steps_trained": 2878200, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 102.91943831834942, "episode_reward_min": -303.0640307366848, "episode_reward_mean": 4.1664947930490515, "episode_len_mean": 273.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.84403935074806}, "policy_reward_max": {"shared_policy": 34.60106084588915}, "policy_reward_mean": {"shared_policy": 1.388831597683017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.91943831834942, -303.0640307366848, 65.63928993977605, 73.2087967097759, 66.91004199464804, -217.05818469822407, 34.63134807953611, 79.95765679422766, 72.1043411232531, 66.4162504058331], "episode_lengths": [300, 41, 300, 300, 300, 292, 300, 300, 300, 300], "policy_shared_policy_reward": [34.60106084588915, 34.502168111503124, 33.816209360957146, -97.2608452886343, -108.84403935074806, -96.95914609730244, 21.801732820769146, 22.167615196978048, 21.669941922028855, 24.302199641863496, 24.504120173553616, 24.402476894358784, 22.617971173099548, 21.7411618878444, 22.550908933704093, -80.95025515556335, -68.59577676653862, -67.5121527761221, 11.579983498901129, 11.237470418214798, 11.813894162420183, 26.51052639633417, 26.673527777194977, 26.77360262069851, 24.085214838385582, 24.148044485598803, 23.871081799268723, 22.138583990434796, 22.368089691425354, 21.909576723972947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1443669818443083, "mean_inference_ms": 0.7337229069742044, "mean_action_processing_ms": 0.0988348128282529, "mean_env_wait_ms": 0.7978477334992828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 3987, "training_iteration": 100, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-17-19", "timestamp": 1706192239, "time_this_iter_s": 23.311516046524048, "time_total_s": 2039.5727071762085, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA00460310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2039.5727071762085, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 7.036363636363637, "ram_util_percent": 50.130303030303025}}
{"episode_reward_max": 107.30103153269737, "episode_reward_min": -251.80324708111584, "episode_reward_mean": 58.50634379638599, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -94.67969099680583}, "policy_reward_max": {"shared_policy": 36.08202428401758}, "policy_reward_mean": {"shared_policy": 19.502114598795323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.13444718276877, 75.8076369781047, 69.84950526244936, -7.2315990924835205, 86.41392472386357, 67.14256081730127, 73.94164545647797, 55.03530088253318, 72.05720062903129, 74.66053716093302, 64.58699803426862, 58.462407380342455, 70.3823709487915, 68.83571948949246, 59.32719371840355, 82.19117287546396, 75.10424057580529, 69.34796019271013, 52.82686151005326, 85.96329213818534, 79.23674151860175, 77.54331159591675, 49.18165785446763, 88.57218634709716, 78.53063953667878, 38.176595274358974, 59.892697488889084, 48.20927117019889, 37.95323865860698, 61.570518612861605, 75.41682617086917, 65.7500482071191, 63.87708906084298, 70.13387476652858, 59.1116329273209, 45.44353758171201, 46.29941489547491, 51.38131590373813, 78.97669930942357, 61.58183743432161, 80.74298381060359, 63.138246295973644, 66.32354432716963, 70.79409937560555, 65.89541036263105, 73.61681313160807, 69.10749659687278, 63.53876667283474, 71.96410814486443, 84.59588732570407, 90.9299262500135, 51.35997141897677, 95.85523238300811, 46.48721989244221, 55.699355229735374, 19.474832881242023, 61.71759770810603, 88.06136059761045, 84.66665018722415, 26.98865289799869, 68.60729869967327, 70.49305346421896, 60.19904997199774, 61.54482084512709, 68.50526165217158, 39.972214721143246, 74.74821841530499, 76.24097935855387, 73.94283851236102, 37.87618601322171, 24.063132874667616, 73.890839304775, 62.06444891169667, 20.753928563557537, 31.88496132194996, 69.52984594553709, 48.834624227136345, -7.2549595385790155, 63.72974677570163, 64.02795899799092, 107.30103153269737, 63.32119677215813, 73.52082405239344, -251.80324708111584, 67.14832545071839, 29.838593065738664, 61.71523212268946, 37.900066826492534, 57.93547290749848, 76.32730874791741, 53.57879460602997, 72.45512567646801, 2.398843992501469, 44.645882241427884, 73.63538877293468, 53.44085580855608, 92.55496028065679, 46.12748706899583, 57.262621596455574, 45.03849948942661], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.515653786559895, 26.890622564210688, 26.728170831998185, 25.38206325595577, 25.472571055715278, 24.953002666433648, 23.283833450327307, 23.404006593550235, 23.161665218571812, -2.2489141672849655, -2.551683261990547, -2.431001663208008, 28.968361942718417, 28.522783155242593, 28.922779625902564, 22.032087221741676, 22.594261839985847, 22.51621175557375, 24.38985851655403, 24.702264099071414, 24.84952284085253, 18.525860450540975, 18.18398768206437, 18.325452749927834, 24.0564309284091, 24.1909521704074, 23.809817530214787, 24.939683362841606, 24.570656329393387, 25.150197468698025, 21.38522206991911, 21.47913309931755, 21.722642865031958, 19.452702345947415, 19.496981816987187, 19.512723217407853, 23.554848209023476, 23.455667942762375, 23.371854797005653, 22.594289933641747, 22.90174987663825, 23.339679679212466, 19.76453028495112, 19.7512720512847, 19.811391382167727, 27.598192114382982, 27.054734751582146, 27.538246009498835, 24.792893310387925, 25.288483738278345, 25.022863527139023, 22.87971921513477, 23.204496486733348, 23.263744490842015, 17.318586726983384, 17.620446515580014, 17.887828267489866, 28.111975540717438, 28.87545858820279, 28.97585800926511, 26.263514923552663, 26.379268447558076, 26.59395814749101, 25.898674450814724, 25.745502434670925, 25.8991347104311, 16.423619356006384, 16.365776475518942, 16.392262022942305, 29.56212390959263, 29.488996852189302, 29.521065585315228, 26.073086713751152, 26.134339315195874, 26.32321350773175, 12.33970621724923, 13.128196859111384, 12.70869219799836, 20.10076889333625, 19.938458879788712, 19.85346971576412, 16.079974273840577, 16.27905166397491, 15.8502452323834, 12.606893400351197, 12.685739821443946, 12.660605436811835, 20.469086604813725, 20.420459533731133, 20.680972474316746, 24.894885659217834, 25.275046220980585, 25.246894290670753, 21.969882895549134, 22.01221598622699, 21.76794932534297, 21.520921525855854, 21.388430272539452, 20.96773726244767, 23.4334275300304, 23.29650206367174, 23.40394517282644, 20.125138110481203, 19.66558464616537, 19.320910170674324, 15.09344557672739, 15.04113207012415, 15.308959934860468, 15.52073085680604, 15.244745686650276, 15.533938352018595, 16.864349534114197, 18.065327889596418, 16.451638480027512, 26.00949890911579, 26.46662900224328, 26.500571398064494, 20.61515691752234, 20.422608489791543, 20.54407202700773, 27.482086988786847, 27.020037333170563, 26.24085948864618, 20.9422733609875, 20.949385200937584, 21.24658773404856, 21.728975276152283, 22.352982467661292, 22.241586583356053, 23.432224030296, 23.621319803098828, 23.74055554221073, 22.081567550698907, 21.97344701612988, 21.840395795802266, 24.905035079456866, 24.666543684899807, 24.045234367251396, 22.123971472183854, 23.416009138027817, 23.567515986661107, 20.907740031679467, 21.355420776953295, 21.275605864201978, 23.804079813261822, 24.00465352212389, 24.155374809478715, 28.289578358332307, 28.019798050324113, 28.28651091704765, 30.263643282155186, 30.700899204743706, 29.965383763114602, 17.00836632152398, 17.05144952734311, 17.30015557010968, 31.734021104872227, 31.79764299094677, 32.32356828718912, 15.631695178647831, 15.698050459225968, 15.157474254568413, 18.271404765546322, 18.673694375902414, 18.75425608828664, 6.465193641682461, 6.506515772392348, 6.503123467167214, 20.607288931806877, 20.65410465498765, 20.4562041213115, 29.2382450873653, 29.111424359182507, 29.711691151062638, 28.301500238478184, 28.47715451195836, 27.887995436787605, 8.876624703407288, 9.223789004608989, 8.888239189982414, 22.977766428142786, 22.48182864487171, 23.147703626658767, 23.53429114942749, 23.560995604222015, 23.397766710569456, 20.113811381161213, 19.984721280634403, 20.10051731020212, 20.484028716882065, 20.51400366922219, 20.546788459022835, 22.633862557510525, 23.164528558651597, 22.70687053600946, 13.394340060651302, 13.386913508176804, 13.19096115231514, 24.80601121733585, 25.133881681288273, 24.808325516680867, 25.582110111912087, 25.011673991878823, 25.647195254762963, 24.74651703486839, 24.578507448236138, 24.617814029256493, 12.461506629983575, 12.704776654640824, 12.709902728597314, 8.015066380302102, 8.041795822481305, 8.00627067188421, 24.571684192866087, 24.782249130308628, 24.536905981600285, 20.54503932595253, 20.960210543125868, 20.559199042618275, 6.661437133947999, 7.4294358060384695, 6.6630556235710685, 10.562178805470467, 10.59485399723053, 10.727928519248962, 23.64948493987322, 23.331064000725746, 22.549297004938126, 16.075588102142007, 16.371612204859645, 16.387423920134694, -2.639686194558948, -2.2089771827062066, -2.406296161313861, 21.1868960460027, 21.111052972575024, 21.431797757123903, 21.06646606822808, 21.432153630380824, 21.529339299382016, 35.67431339373191, 36.08202428401758, 35.54469385494788, 21.249395584066704, 20.4652984937032, 21.606502694388226, 24.44174688309431, 24.476333782076836, 24.60274338722229, -94.67969099680583, -79.12042374412219, -78.00313234018783, 21.830589686830834, 22.713844300558165, 22.60389146332939, 9.813908768196896, 10.049454030891255, 9.975230266650513, 20.18168632189432, 20.834315868715436, 20.699229932079703, 12.588280626883105, 12.644273993869618, 12.667512205739811, 19.48646999709308, 19.492530960589647, 18.95647194981575, 25.05369807779789, 25.637226656079292, 25.63638401404023, 17.924387016644076, 17.863563661773995, 17.790843927611903, 23.949046716094017, 24.05483542382717, 24.451243536546826, 0.9862688134113853, 1.0989494013289516, 0.313625777761132, 14.779263769586876, 15.174687576790646, 14.691930895050362, 24.580579292029142, 24.468963652849197, 24.585845828056335, 18.073922958225012, 17.57770276069641, 17.789230089634657, 30.797652165095002, 30.96708075205484, 30.790227363506943, 15.708497626706958, 15.273404963314533, 15.145584478974342, 19.052236191928387, 19.110549576580524, 19.099835827946663, 14.692222237586975, 15.19661508873105, 15.149662163108587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15615760417271227, "mean_inference_ms": 0.7123543902222906, "mean_action_processing_ms": 0.1005935132446747, "mean_env_wait_ms": 0.8180894132135017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 968994, "timesteps_this_iter": 0, "agent_timesteps_total": 2906982, "timers": {"sample_time_ms": 20426.718, "sample_throughput": 469.679, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3014.93, "learn_throughput": 3182.163, "update_time_ms": 8.799}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.630216375924647e-11, "cur_lr": 0.0005, "total_loss": 62.104756355285645, "policy_loss": -0.00151451341653841, "vf_loss": 62.24079084396362, "vf_explained_var": 0.049555063247680664, "kl": 0.006610545955611696, "entropy": 13.45188021659851, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 968994, "num_agent_steps_sampled": 2906982, "num_steps_trained": 968994, "num_agent_steps_trained": 2906982, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4019, "training_iteration": 101, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-17-39", "timestamp": 1706192259, "time_this_iter_s": 19.596725463867188, "time_total_s": 2059.1694326400757, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA00460940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2059.1694326400757, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 11.24074074074074, "ram_util_percent": 48.6962962962963}}
{"episode_reward_max": 107.30103153269737, "episode_reward_min": -251.80324708111584, "episode_reward_mean": 57.96764264979749, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -94.67969099680583}, "policy_reward_max": {"shared_policy": 36.08202428401758}, "policy_reward_mean": {"shared_policy": 19.32254754993249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.13387476652858, 59.1116329273209, 45.44353758171201, 46.29941489547491, 51.38131590373813, 78.97669930942357, 61.58183743432161, 80.74298381060359, 63.138246295973644, 66.32354432716963, 70.79409937560555, 65.89541036263105, 73.61681313160807, 69.10749659687278, 63.53876667283474, 71.96410814486443, 84.59588732570407, 90.9299262500135, 51.35997141897677, 95.85523238300811, 46.48721989244221, 55.699355229735374, 19.474832881242023, 61.71759770810603, 88.06136059761045, 84.66665018722415, 26.98865289799869, 68.60729869967327, 70.49305346421896, 60.19904997199774, 61.54482084512709, 68.50526165217158, 39.972214721143246, 74.74821841530499, 76.24097935855387, 73.94283851236102, 37.87618601322171, 24.063132874667616, 73.890839304775, 62.06444891169667, 20.753928563557537, 31.88496132194996, 69.52984594553709, 48.834624227136345, -7.2549595385790155, 63.72974677570163, 64.02795899799092, 107.30103153269737, 63.32119677215813, 73.52082405239344, -251.80324708111584, 67.14832545071839, 29.838593065738664, 61.71523212268946, 37.900066826492534, 57.93547290749848, 76.32730874791741, 53.57879460602997, 72.45512567646801, 2.398843992501469, 44.645882241427884, 73.63538877293468, 53.44085580855608, 92.55496028065679, 46.12748706899583, 57.262621596455574, 45.03849948942661, 86.8922289730981, 66.10925676487383, 88.858987390995, 65.60210776794702, 45.94555044255682, 32.30434446036814, 76.66422727145255, 74.06180364638566, 53.97838921844959, 61.73181830905375, 68.57262390851972, 54.29432835895565, 81.44385446608064, 55.267464332282515, 62.801280505955205, 60.32687954604626, 74.86198535934088, 64.80122338980436, 66.70827304385601, 46.24827087204902, 59.91938810143617, 50.800746679306, 61.37554744631052, 34.07636182173155, 71.79453863203526, 69.93656770884989, 58.797132410109015, 97.65596648305652, 67.24901865050194, 56.500737575814114, 62.479472545790486, 59.46725560352206, 67.35245201562064], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.4334275300304, 23.29650206367174, 23.40394517282644, 20.125138110481203, 19.66558464616537, 19.320910170674324, 15.09344557672739, 15.04113207012415, 15.308959934860468, 15.52073085680604, 15.244745686650276, 15.533938352018595, 16.864349534114197, 18.065327889596418, 16.451638480027512, 26.00949890911579, 26.46662900224328, 26.500571398064494, 20.61515691752234, 20.422608489791543, 20.54407202700773, 27.482086988786847, 27.020037333170563, 26.24085948864618, 20.9422733609875, 20.949385200937584, 21.24658773404856, 21.728975276152283, 22.352982467661292, 22.241586583356053, 23.432224030296, 23.621319803098828, 23.74055554221073, 22.081567550698907, 21.97344701612988, 21.840395795802266, 24.905035079456866, 24.666543684899807, 24.045234367251396, 22.123971472183854, 23.416009138027817, 23.567515986661107, 20.907740031679467, 21.355420776953295, 21.275605864201978, 23.804079813261822, 24.00465352212389, 24.155374809478715, 28.289578358332307, 28.019798050324113, 28.28651091704765, 30.263643282155186, 30.700899204743706, 29.965383763114602, 17.00836632152398, 17.05144952734311, 17.30015557010968, 31.734021104872227, 31.79764299094677, 32.32356828718912, 15.631695178647831, 15.698050459225968, 15.157474254568413, 18.271404765546322, 18.673694375902414, 18.75425608828664, 6.465193641682461, 6.506515772392348, 6.503123467167214, 20.607288931806877, 20.65410465498765, 20.4562041213115, 29.2382450873653, 29.111424359182507, 29.711691151062638, 28.301500238478184, 28.47715451195836, 27.887995436787605, 8.876624703407288, 9.223789004608989, 8.888239189982414, 22.977766428142786, 22.48182864487171, 23.147703626658767, 23.53429114942749, 23.560995604222015, 23.397766710569456, 20.113811381161213, 19.984721280634403, 20.10051731020212, 20.484028716882065, 20.51400366922219, 20.546788459022835, 22.633862557510525, 23.164528558651597, 22.70687053600946, 13.394340060651302, 13.386913508176804, 13.19096115231514, 24.80601121733585, 25.133881681288273, 24.808325516680867, 25.582110111912087, 25.011673991878823, 25.647195254762963, 24.74651703486839, 24.578507448236138, 24.617814029256493, 12.461506629983575, 12.704776654640824, 12.709902728597314, 8.015066380302102, 8.041795822481305, 8.00627067188421, 24.571684192866087, 24.782249130308628, 24.536905981600285, 20.54503932595253, 20.960210543125868, 20.559199042618275, 6.661437133947999, 7.4294358060384695, 6.6630556235710685, 10.562178805470467, 10.59485399723053, 10.727928519248962, 23.64948493987322, 23.331064000725746, 22.549297004938126, 16.075588102142007, 16.371612204859645, 16.387423920134694, -2.639686194558948, -2.2089771827062066, -2.406296161313861, 21.1868960460027, 21.111052972575024, 21.431797757123903, 21.06646606822808, 21.432153630380824, 21.529339299382016, 35.67431339373191, 36.08202428401758, 35.54469385494788, 21.249395584066704, 20.4652984937032, 21.606502694388226, 24.44174688309431, 24.476333782076836, 24.60274338722229, -94.67969099680583, -79.12042374412219, -78.00313234018783, 21.830589686830834, 22.713844300558165, 22.60389146332939, 9.813908768196896, 10.049454030891255, 9.975230266650513, 20.18168632189432, 20.834315868715436, 20.699229932079703, 12.588280626883105, 12.644273993869618, 12.667512205739811, 19.48646999709308, 19.492530960589647, 18.95647194981575, 25.05369807779789, 25.637226656079292, 25.63638401404023, 17.924387016644076, 17.863563661773995, 17.790843927611903, 23.949046716094017, 24.05483542382717, 24.451243536546826, 0.9862688134113853, 1.0989494013289516, 0.313625777761132, 14.779263769586876, 15.174687576790646, 14.691930895050362, 24.580579292029142, 24.468963652849197, 24.585845828056335, 18.073922958225012, 17.57770276069641, 17.789230089634657, 30.797652165095002, 30.96708075205484, 30.790227363506943, 15.708497626706958, 15.273404963314533, 15.145584478974342, 19.052236191928387, 19.110549576580524, 19.099835827946663, 14.692222237586975, 15.19661508873105, 15.149662163108587, 28.906053610146046, 28.92427709698677, 29.061898265965283, 22.03233354787031, 21.82467461625734, 22.252248600746185, 29.839024503404886, 29.785415918255836, 29.234546969334275, 22.311297339387238, 21.5555519759655, 21.73525845259428, 15.480460423665733, 14.938285040358693, 15.526804978532397, 10.620759819944695, 10.869046991070107, 10.81453764935334, 25.67570652998984, 25.535748854279518, 25.45277188718319, 24.30682339270909, 24.867158611615494, 24.88782164206107, 17.803366363048553, 18.273505188524723, 17.901517666876316, 20.483056927720696, 20.772754416490585, 20.47600696484247, 22.84660344074169, 22.854376072684914, 22.871644395093114, 18.184039123977215, 18.29267025149116, 17.81761898348728, 27.23042484621206, 26.630148629347474, 27.583280990521104, 18.230967248479516, 18.44474388907352, 18.591753194729478, 20.52918245395024, 21.490227070947483, 20.78187098105748, 20.134842665866017, 19.978120308369398, 20.21391657181084, 24.804609457651765, 24.753704297045857, 25.303671604643256, 21.813959442079067, 21.660522893071175, 21.32674105465412, 22.277248549585536, 22.094893643011645, 22.33613085125883, 15.604368014571563, 15.164333348472908, 15.479569509004548, 20.06775485134372, 19.848927634457738, 20.00270561563471, 16.821849743525178, 16.979517495880515, 16.99937943990031, 20.35613453760743, 20.484754543751478, 20.53465836495161, 11.321996830403805, 11.455706415465102, 11.298658575862646, 23.980248894542456, 24.01658146455884, 23.79770827293396, 23.62149242808421, 22.90240318079789, 23.412672099967793, 19.10261849562326, 19.653711306552083, 20.04080260793367, 32.7933624840031, 32.8871326415489, 31.975471357504517, 22.45977750296393, 22.568510475258023, 22.220730672279984, 18.622231667240456, 19.038912623499826, 18.839593285073832, 20.91719238460064, 20.606664814054966, 20.95561534713488, 20.07350428029895, 19.84913393855095, 19.544617384672165, 22.754108804704927, 22.084229936202362, 22.514113274713353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15609912279604016, "mean_inference_ms": 0.7120572098939015, "mean_action_processing_ms": 0.1005825780528154, "mean_env_wait_ms": 0.817738075385035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 978588, "timesteps_this_iter": 0, "agent_timesteps_total": 2935764, "timers": {"sample_time_ms": 20277.644, "sample_throughput": 473.132, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3014.503, "learn_throughput": 3182.614, "update_time_ms": 8.766}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.630216375924647e-11, "cur_lr": 0.0005, "total_loss": 6.123117029666901, "policy_loss": 0.00041372988291321633, "vf_loss": 6.259044647216797, "vf_explained_var": 0.055449068546295166, "kl": 0.005940401315590061, "entropy": 13.634156227111816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 978588, "num_agent_steps_sampled": 2935764, "num_steps_trained": 978588, "num_agent_steps_trained": 2935764, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4052, "training_iteration": 102, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-17-59", "timestamp": 1706192279, "time_this_iter_s": 19.535229682922363, "time_total_s": 2078.704662322998, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2078.704662322998, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 9.25, "ram_util_percent": 47.83214285714286}}
{"episode_reward_max": 110.5679259672761, "episode_reward_min": -251.80324708111584, "episode_reward_mean": 58.203127435734494, "episode_len_mean": 299.93, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -94.67969099680583}, "policy_reward_max": {"shared_policy": 36.99616989865899}, "policy_reward_mean": {"shared_policy": 19.40104247857816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.50526165217158, 39.972214721143246, 74.74821841530499, 76.24097935855387, 73.94283851236102, 37.87618601322171, 24.063132874667616, 73.890839304775, 62.06444891169667, 20.753928563557537, 31.88496132194996, 69.52984594553709, 48.834624227136345, -7.2549595385790155, 63.72974677570163, 64.02795899799092, 107.30103153269737, 63.32119677215813, 73.52082405239344, -251.80324708111584, 67.14832545071839, 29.838593065738664, 61.71523212268946, 37.900066826492534, 57.93547290749848, 76.32730874791741, 53.57879460602997, 72.45512567646801, 2.398843992501469, 44.645882241427884, 73.63538877293468, 53.44085580855608, 92.55496028065679, 46.12748706899583, 57.262621596455574, 45.03849948942661, 86.8922289730981, 66.10925676487383, 88.858987390995, 65.60210776794702, 45.94555044255682, 32.30434446036814, 76.66422727145255, 74.06180364638566, 53.97838921844959, 61.73181830905375, 68.57262390851972, 54.29432835895565, 81.44385446608064, 55.267464332282515, 62.801280505955205, 60.32687954604626, 74.86198535934088, 64.80122338980436, 66.70827304385601, 46.24827087204902, 59.91938810143617, 50.800746679306, 61.37554744631052, 34.07636182173155, 71.79453863203526, 69.93656770884989, 58.797132410109015, 97.65596648305652, 67.24901865050194, 56.500737575814114, 62.479472545790486, 59.46725560352206, 67.35245201562064, 75.69321253523228, 29.281313609331818, 74.21428379788995, 88.61523689329624, 65.10147758433595, 9.3961848579347, 46.457781806588144, 81.65220568235962, 65.3295451682061, 75.39784165471792, 80.16039836034179, 82.8614343423396, 64.61010715365408, 60.42931009596211, 61.14167764782903, 80.34707393497229, 69.11215611733496, 72.37710728496312, 64.26692326925695, 50.53456842154263, 74.76961499452588, 72.72516651451586, 36.00761755928396, 63.78427448868749, 54.9020720347762, 78.58783188462255, 75.29423438804224, 70.75766068685333, 61.93749620066953, 31.965434946119757, 110.5679259672761], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 293, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.633862557510525, 23.164528558651597, 22.70687053600946, 13.394340060651302, 13.386913508176804, 13.19096115231514, 24.80601121733585, 25.133881681288273, 24.808325516680867, 25.582110111912087, 25.011673991878823, 25.647195254762963, 24.74651703486839, 24.578507448236138, 24.617814029256493, 12.461506629983575, 12.704776654640824, 12.709902728597314, 8.015066380302102, 8.041795822481305, 8.00627067188421, 24.571684192866087, 24.782249130308628, 24.536905981600285, 20.54503932595253, 20.960210543125868, 20.559199042618275, 6.661437133947999, 7.4294358060384695, 6.6630556235710685, 10.562178805470467, 10.59485399723053, 10.727928519248962, 23.64948493987322, 23.331064000725746, 22.549297004938126, 16.075588102142007, 16.371612204859645, 16.387423920134694, -2.639686194558948, -2.2089771827062066, -2.406296161313861, 21.1868960460027, 21.111052972575024, 21.431797757123903, 21.06646606822808, 21.432153630380824, 21.529339299382016, 35.67431339373191, 36.08202428401758, 35.54469385494788, 21.249395584066704, 20.4652984937032, 21.606502694388226, 24.44174688309431, 24.476333782076836, 24.60274338722229, -94.67969099680583, -79.12042374412219, -78.00313234018783, 21.830589686830834, 22.713844300558165, 22.60389146332939, 9.813908768196896, 10.049454030891255, 9.975230266650513, 20.18168632189432, 20.834315868715436, 20.699229932079703, 12.588280626883105, 12.644273993869618, 12.667512205739811, 19.48646999709308, 19.492530960589647, 18.95647194981575, 25.05369807779789, 25.637226656079292, 25.63638401404023, 17.924387016644076, 17.863563661773995, 17.790843927611903, 23.949046716094017, 24.05483542382717, 24.451243536546826, 0.9862688134113853, 1.0989494013289516, 0.313625777761132, 14.779263769586876, 15.174687576790646, 14.691930895050362, 24.580579292029142, 24.468963652849197, 24.585845828056335, 18.073922958225012, 17.57770276069641, 17.789230089634657, 30.797652165095002, 30.96708075205484, 30.790227363506943, 15.708497626706958, 15.273404963314533, 15.145584478974342, 19.052236191928387, 19.110549576580524, 19.099835827946663, 14.692222237586975, 15.19661508873105, 15.149662163108587, 28.906053610146046, 28.92427709698677, 29.061898265965283, 22.03233354787031, 21.82467461625734, 22.252248600746185, 29.839024503404886, 29.785415918255836, 29.234546969334275, 22.311297339387238, 21.5555519759655, 21.73525845259428, 15.480460423665733, 14.938285040358693, 15.526804978532397, 10.620759819944695, 10.869046991070107, 10.81453764935334, 25.67570652998984, 25.535748854279518, 25.45277188718319, 24.30682339270909, 24.867158611615494, 24.88782164206107, 17.803366363048553, 18.273505188524723, 17.901517666876316, 20.483056927720696, 20.772754416490585, 20.47600696484247, 22.84660344074169, 22.854376072684914, 22.871644395093114, 18.184039123977215, 18.29267025149116, 17.81761898348728, 27.23042484621206, 26.630148629347474, 27.583280990521104, 18.230967248479516, 18.44474388907352, 18.591753194729478, 20.52918245395024, 21.490227070947483, 20.78187098105748, 20.134842665866017, 19.978120308369398, 20.21391657181084, 24.804609457651765, 24.753704297045857, 25.303671604643256, 21.813959442079067, 21.660522893071175, 21.32674105465412, 22.277248549585536, 22.094893643011645, 22.33613085125883, 15.604368014571563, 15.164333348472908, 15.479569509004548, 20.06775485134372, 19.848927634457738, 20.00270561563471, 16.821849743525178, 16.979517495880515, 16.99937943990031, 20.35613453760743, 20.484754543751478, 20.53465836495161, 11.321996830403805, 11.455706415465102, 11.298658575862646, 23.980248894542456, 24.01658146455884, 23.79770827293396, 23.62149242808421, 22.90240318079789, 23.412672099967793, 19.10261849562326, 19.653711306552083, 20.04080260793367, 32.7933624840031, 32.8871326415489, 31.975471357504517, 22.45977750296393, 22.568510475258023, 22.220730672279984, 18.622231667240456, 19.038912623499826, 18.839593285073832, 20.91719238460064, 20.606664814054966, 20.95561534713488, 20.07350428029895, 19.84913393855095, 19.544617384672165, 22.754108804704927, 22.084229936202362, 22.514113274713353, 25.360172065595776, 25.27259851867953, 25.06044195095697, 9.765860396126897, 9.882742776225001, 9.63271043697992, 24.847263604402542, 24.128367215394974, 25.238652978092432, 29.42424166202545, 29.676014997065067, 29.514980234205723, 22.058106577489525, 21.145019352436066, 21.898351654410362, 3.103646961351231, 3.136628912140921, 3.155908984442547, 15.601270625988633, 15.486529188851506, 15.369981991748006, 26.948260766764477, 27.196817127366856, 27.50712778822829, 21.636584475636482, 21.99832363985479, 21.694637052714825, 25.47971398383379, 25.58326129615307, 24.334866374731064, 26.64227658510208, 26.788491565734148, 26.729630209505558, 27.740951195980102, 27.636694616327674, 27.48378853003183, 21.561926585932568, 21.732850951453045, 21.31532961626847, 19.87106319765249, 20.282497382878006, 20.275749515431613, 20.21325098971525, 20.571844751636178, 20.3565819064776, 26.856212131679058, 26.57387837767601, 26.916983425617218, 22.860265262424946, 23.15576178021729, 23.096129074692726, 24.318631652121738, 24.294565699373678, 23.7639099334677, 21.736935747787356, 21.22440066933632, 21.305586852133274, 16.630337310334042, 16.803753932317093, 17.100477178891495, 25.08842177192369, 24.687789450089127, 24.993403772513062, 24.076170345147446, 24.2540167470773, 24.394979422291115, 11.793856104214981, 12.379367822160319, 11.834393632908657, 21.50416490683952, 21.208865764240414, 21.071243817607552, 17.78398609658082, 18.758829673131302, 18.359256265064076, 26.04631499449411, 26.283506910006196, 26.25800998012224, 25.244875722099096, 25.052216734737158, 24.997141931205988, 23.604242620368794, 23.352431771655873, 23.80098629482866, 20.865314345030725, 20.362753505508095, 20.709428350130707, 10.696625145773083, 10.390867138902337, 10.877942661444337, 36.83909631147981, 36.99616989865899, 36.7326597571373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15600956444840333, "mean_inference_ms": 0.7116877451740684, "mean_action_processing_ms": 0.10051785321488245, "mean_env_wait_ms": 0.8173542923955373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 988182, "timesteps_this_iter": 0, "agent_timesteps_total": 2964546, "timers": {"sample_time_ms": 20226.677, "sample_throughput": 474.324, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3019.185, "learn_throughput": 3177.678, "update_time_ms": 8.573}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.630216375924647e-11, "cur_lr": 0.0005, "total_loss": 6.6346776485443115, "policy_loss": 0.00019283001759073937, "vf_loss": 6.770623028278351, "vf_explained_var": 0.05385261029005051, "kl": 0.004347024863951805, "entropy": 13.613827347755432, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 988182, "num_agent_steps_sampled": 2964546, "num_steps_trained": 988182, "num_agent_steps_trained": 2964546, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4083, "training_iteration": 103, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-18-18", "timestamp": 1706192298, "time_this_iter_s": 19.1721293926239, "time_total_s": 2097.876791715622, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004600D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2097.876791715622, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 7.151851851851851, "ram_util_percent": 47.9962962962963}}
{"episode_reward_max": 110.5679259672761, "episode_reward_min": 9.3961848579347, "episode_reward_mean": 63.9644048447907, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": 3.103646961351231}, "policy_reward_max": {"shared_policy": 36.99616989865899}, "policy_reward_mean": {"shared_policy": 21.321468281596893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.12748706899583, 57.262621596455574, 45.03849948942661, 86.8922289730981, 66.10925676487383, 88.858987390995, 65.60210776794702, 45.94555044255682, 32.30434446036814, 76.66422727145255, 74.06180364638566, 53.97838921844959, 61.73181830905375, 68.57262390851972, 54.29432835895565, 81.44385446608064, 55.267464332282515, 62.801280505955205, 60.32687954604626, 74.86198535934088, 64.80122338980436, 66.70827304385601, 46.24827087204902, 59.91938810143617, 50.800746679306, 61.37554744631052, 34.07636182173155, 71.79453863203526, 69.93656770884989, 58.797132410109015, 97.65596648305652, 67.24901865050194, 56.500737575814114, 62.479472545790486, 59.46725560352206, 67.35245201562064, 75.69321253523228, 29.281313609331818, 74.21428379788995, 88.61523689329624, 65.10147758433595, 9.3961848579347, 46.457781806588144, 81.65220568235962, 65.3295451682061, 75.39784165471792, 80.16039836034179, 82.8614343423396, 64.61010715365408, 60.42931009596211, 61.14167764782903, 80.34707393497229, 69.11215611733496, 72.37710728496312, 64.26692326925695, 50.53456842154263, 74.76961499452588, 72.72516651451586, 36.00761755928396, 63.78427448868749, 54.9020720347762, 78.58783188462255, 75.29423438804224, 70.75766068685333, 61.93749620066953, 31.965434946119757, 110.5679259672761, 41.27237283438444, 66.14673803001642, 73.56979233585295, 70.1025451943278, 69.73309703730047, 39.422351583838434, 82.81352408835664, 68.37656923383474, 67.88548411708325, 71.85606627818196, 55.52179000154136, 83.35055931098758, 58.58359114453194, 76.67003682069479, 36.71890258509664, 88.66964789479968, 83.82087059598415, 79.21977761015293, 61.42003692477007, 24.552322372794137, 68.57970898039638, 68.73600811883806, 63.82665556482971, 68.04784374963492, 56.58393443352543, 59.11027241684495, 76.82549485936761, 47.016150916926534, 57.922406516969176, 59.456172758713365, 54.39968198537825, 92.73256164463236, 41.909654797986136], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.708497626706958, 15.273404963314533, 15.145584478974342, 19.052236191928387, 19.110549576580524, 19.099835827946663, 14.692222237586975, 15.19661508873105, 15.149662163108587, 28.906053610146046, 28.92427709698677, 29.061898265965283, 22.03233354787031, 21.82467461625734, 22.252248600746185, 29.839024503404886, 29.785415918255836, 29.234546969334275, 22.311297339387238, 21.5555519759655, 21.73525845259428, 15.480460423665733, 14.938285040358693, 15.526804978532397, 10.620759819944695, 10.869046991070107, 10.81453764935334, 25.67570652998984, 25.535748854279518, 25.45277188718319, 24.30682339270909, 24.867158611615494, 24.88782164206107, 17.803366363048553, 18.273505188524723, 17.901517666876316, 20.483056927720696, 20.772754416490585, 20.47600696484247, 22.84660344074169, 22.854376072684914, 22.871644395093114, 18.184039123977215, 18.29267025149116, 17.81761898348728, 27.23042484621206, 26.630148629347474, 27.583280990521104, 18.230967248479516, 18.44474388907352, 18.591753194729478, 20.52918245395024, 21.490227070947483, 20.78187098105748, 20.134842665866017, 19.978120308369398, 20.21391657181084, 24.804609457651765, 24.753704297045857, 25.303671604643256, 21.813959442079067, 21.660522893071175, 21.32674105465412, 22.277248549585536, 22.094893643011645, 22.33613085125883, 15.604368014571563, 15.164333348472908, 15.479569509004548, 20.06775485134372, 19.848927634457738, 20.00270561563471, 16.821849743525178, 16.979517495880515, 16.99937943990031, 20.35613453760743, 20.484754543751478, 20.53465836495161, 11.321996830403805, 11.455706415465102, 11.298658575862646, 23.980248894542456, 24.01658146455884, 23.79770827293396, 23.62149242808421, 22.90240318079789, 23.412672099967793, 19.10261849562326, 19.653711306552083, 20.04080260793367, 32.7933624840031, 32.8871326415489, 31.975471357504517, 22.45977750296393, 22.568510475258023, 22.220730672279984, 18.622231667240456, 19.038912623499826, 18.839593285073832, 20.91719238460064, 20.606664814054966, 20.95561534713488, 20.07350428029895, 19.84913393855095, 19.544617384672165, 22.754108804704927, 22.084229936202362, 22.514113274713353, 25.360172065595776, 25.27259851867953, 25.06044195095697, 9.765860396126897, 9.882742776225001, 9.63271043697992, 24.847263604402542, 24.128367215394974, 25.238652978092432, 29.42424166202545, 29.676014997065067, 29.514980234205723, 22.058106577489525, 21.145019352436066, 21.898351654410362, 3.103646961351231, 3.136628912140921, 3.155908984442547, 15.601270625988633, 15.486529188851506, 15.369981991748006, 26.948260766764477, 27.196817127366856, 27.50712778822829, 21.636584475636482, 21.99832363985479, 21.694637052714825, 25.47971398383379, 25.58326129615307, 24.334866374731064, 26.64227658510208, 26.788491565734148, 26.729630209505558, 27.740951195980102, 27.636694616327674, 27.48378853003183, 21.561926585932568, 21.732850951453045, 21.31532961626847, 19.87106319765249, 20.282497382878006, 20.275749515431613, 20.21325098971525, 20.571844751636178, 20.3565819064776, 26.856212131679058, 26.57387837767601, 26.916983425617218, 22.860265262424946, 23.15576178021729, 23.096129074692726, 24.318631652121738, 24.294565699373678, 23.7639099334677, 21.736935747787356, 21.22440066933632, 21.305586852133274, 16.630337310334042, 16.803753932317093, 17.100477178891495, 25.08842177192369, 24.687789450089127, 24.993403772513062, 24.076170345147446, 24.2540167470773, 24.394979422291115, 11.793856104214981, 12.379367822160319, 11.834393632908657, 21.50416490683952, 21.208865764240414, 21.071243817607552, 17.78398609658082, 18.758829673131302, 18.359256265064076, 26.04631499449411, 26.283506910006196, 26.25800998012224, 25.244875722099096, 25.052216734737158, 24.997141931205988, 23.604242620368794, 23.352431771655873, 23.80098629482866, 20.865314345030725, 20.362753505508095, 20.709428350130707, 10.696625145773083, 10.390867138902337, 10.877942661444337, 36.83909631147981, 36.99616989865899, 36.7326597571373, 13.587226957082748, 13.848777428269386, 13.836368449032307, 22.11871039867401, 22.076606571674347, 21.951421059668064, 24.272091085712105, 24.486984493831784, 24.810716756309063, 23.38353760043779, 23.26049144814411, 23.458516145745904, 23.411924617365003, 23.055275447666645, 23.26589697226882, 11.973210255304963, 13.49857425192991, 13.950567076603562, 27.63489867374301, 27.509172566235065, 27.66945284837857, 22.46803091466427, 23.004267547279596, 22.90427077189088, 22.907394266687334, 22.642842669039965, 22.335247181355953, 23.79961349566777, 24.046229962569967, 24.010222819944218, 18.769045071055487, 17.781881382067994, 18.97086354841788, 27.559889671703175, 27.835068130244807, 27.955601509039596, 19.582138285661728, 19.39170218134919, 19.60975067752102, 25.545679831256464, 25.645142129932836, 25.47921485950549, 12.426883766738072, 12.187628631790474, 12.104390186568097, 29.454983952144772, 29.612456443409116, 29.602207499245793, 27.67187575747569, 28.183116432589784, 27.965878405918673, 26.58317012960711, 26.31129779169956, 26.32530968884626, 20.142133379975945, 20.676107079178706, 20.601796465615422, 8.056839173038796, 8.15550549825032, 8.33997770150502, 22.64456422378619, 22.995254214232162, 22.939890542378023, 22.58035760124524, 22.960987163086727, 23.19466335450609, 21.04703690111637, 21.399768359959126, 21.37985030375421, 22.574258618056774, 22.439107730984688, 23.03447740059346, 18.988115408457816, 19.03499115887098, 18.560827866196632, 19.676298049588993, 19.576745962103203, 19.857228405152753, 25.897992681711912, 25.874789990484715, 25.052712187170982, 15.570671709875256, 15.830910687955708, 15.61456851909557, 19.43306980157891, 19.154904591540486, 19.33443212384978, 19.5152270719409, 19.915483884513378, 20.025461802259088, 17.918323551615075, 18.28710739811261, 18.194251035650566, 31.22921287066613, 31.05442816143234, 30.448920612533882, 14.241741537426904, 13.900574972232178, 13.767338288327053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15593145059146188, "mean_inference_ms": 0.7113367222405202, "mean_action_processing_ms": 0.10048843597080526, "mean_env_wait_ms": 0.8169454403141947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 997776, "timesteps_this_iter": 0, "agent_timesteps_total": 2993328, "timers": {"sample_time_ms": 20225.272, "sample_throughput": 474.357, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3028.869, "learn_throughput": 3167.519, "update_time_ms": 8.575}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.315108187962324e-11, "cur_lr": 0.0005, "total_loss": 5.434677720069885, "policy_loss": 0.0006420383544814001, "vf_loss": 5.57006561756134, "vf_explained_var": 0.10874814540147781, "kl": 0.006739684468037205, "entropy": 13.603007435798645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 997776, "num_agent_steps_sampled": 2993328, "num_steps_trained": 997776, "num_agent_steps_trained": 2993328, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4116, "training_iteration": 104, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-18-38", "timestamp": 1706192318, "time_this_iter_s": 19.748183965682983, "time_total_s": 2117.624975681305, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B433A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2117.624975681305, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 8.478571428571428, "ram_util_percent": 48.182142857142864}}
{"episode_reward_max": 110.5679259672761, "episode_reward_min": -320.60110899060965, "episode_reward_mean": 59.70250241927104, "episode_len_mean": 298.62, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -110.25898110866547}, "policy_reward_max": {"shared_policy": 36.99616989865899}, "policy_reward_mean": {"shared_policy": 19.90083413975701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.24901865050194, 56.500737575814114, 62.479472545790486, 59.46725560352206, 67.35245201562064, 75.69321253523228, 29.281313609331818, 74.21428379788995, 88.61523689329624, 65.10147758433595, 9.3961848579347, 46.457781806588144, 81.65220568235962, 65.3295451682061, 75.39784165471792, 80.16039836034179, 82.8614343423396, 64.61010715365408, 60.42931009596211, 61.14167764782903, 80.34707393497229, 69.11215611733496, 72.37710728496312, 64.26692326925695, 50.53456842154263, 74.76961499452588, 72.72516651451586, 36.00761755928396, 63.78427448868749, 54.9020720347762, 78.58783188462255, 75.29423438804224, 70.75766068685333, 61.93749620066953, 31.965434946119757, 110.5679259672761, 41.27237283438444, 66.14673803001642, 73.56979233585295, 70.1025451943278, 69.73309703730047, 39.422351583838434, 82.81352408835664, 68.37656923383474, 67.88548411708325, 71.85606627818196, 55.52179000154136, 83.35055931098758, 58.58359114453194, 76.67003682069479, 36.71890258509664, 88.66964789479968, 83.82087059598415, 79.21977761015293, 61.42003692477007, 24.552322372794137, 68.57970898039638, 68.73600811883806, 63.82665556482971, 68.04784374963492, 56.58393443352543, 59.11027241684495, 76.82549485936761, 47.016150916926534, 57.922406516969176, 59.456172758713365, 54.39968198537825, 92.73256164463236, 41.909654797986136, 70.2080004289746, 72.33556180074808, 82.96414770791304, 87.30107355862854, 3.458112772554145, 66.30086279846726, 82.76136274915186, 55.667390731861815, -8.903339002281456, 6.01527456380424, 77.07436119765042, -320.60110899060965, 84.14909251779315, 60.09219515882431, 74.03993981704114, 71.16307492926715, 38.29035183042288, 69.22559708659537, 37.86435541883108, 72.53396314755079, 78.5888773400802, 84.27593071013688, 56.9089577309787, 63.073827311396585, 66.68035093042997, 102.34147731692065, 54.10831096023318, 32.876253890804946, 55.70211012102662, 70.9334991183132, 66.63964726030827], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 162, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.45977750296393, 22.568510475258023, 22.220730672279984, 18.622231667240456, 19.038912623499826, 18.839593285073832, 20.91719238460064, 20.606664814054966, 20.95561534713488, 20.07350428029895, 19.84913393855095, 19.544617384672165, 22.754108804704927, 22.084229936202362, 22.514113274713353, 25.360172065595776, 25.27259851867953, 25.06044195095697, 9.765860396126897, 9.882742776225001, 9.63271043697992, 24.847263604402542, 24.128367215394974, 25.238652978092432, 29.42424166202545, 29.676014997065067, 29.514980234205723, 22.058106577489525, 21.145019352436066, 21.898351654410362, 3.103646961351231, 3.136628912140921, 3.155908984442547, 15.601270625988633, 15.486529188851506, 15.369981991748006, 26.948260766764477, 27.196817127366856, 27.50712778822829, 21.636584475636482, 21.99832363985479, 21.694637052714825, 25.47971398383379, 25.58326129615307, 24.334866374731064, 26.64227658510208, 26.788491565734148, 26.729630209505558, 27.740951195980102, 27.636694616327674, 27.48378853003183, 21.561926585932568, 21.732850951453045, 21.31532961626847, 19.87106319765249, 20.282497382878006, 20.275749515431613, 20.21325098971525, 20.571844751636178, 20.3565819064776, 26.856212131679058, 26.57387837767601, 26.916983425617218, 22.860265262424946, 23.15576178021729, 23.096129074692726, 24.318631652121738, 24.294565699373678, 23.7639099334677, 21.736935747787356, 21.22440066933632, 21.305586852133274, 16.630337310334042, 16.803753932317093, 17.100477178891495, 25.08842177192369, 24.687789450089127, 24.993403772513062, 24.076170345147446, 24.2540167470773, 24.394979422291115, 11.793856104214981, 12.379367822160319, 11.834393632908657, 21.50416490683952, 21.208865764240414, 21.071243817607552, 17.78398609658082, 18.758829673131302, 18.359256265064076, 26.04631499449411, 26.283506910006196, 26.25800998012224, 25.244875722099096, 25.052216734737158, 24.997141931205988, 23.604242620368794, 23.352431771655873, 23.80098629482866, 20.865314345030725, 20.362753505508095, 20.709428350130707, 10.696625145773083, 10.390867138902337, 10.877942661444337, 36.83909631147981, 36.99616989865899, 36.7326597571373, 13.587226957082748, 13.848777428269386, 13.836368449032307, 22.11871039867401, 22.076606571674347, 21.951421059668064, 24.272091085712105, 24.486984493831784, 24.810716756309063, 23.38353760043779, 23.26049144814411, 23.458516145745904, 23.411924617365003, 23.055275447666645, 23.26589697226882, 11.973210255304963, 13.49857425192991, 13.950567076603562, 27.63489867374301, 27.509172566235065, 27.66945284837857, 22.46803091466427, 23.004267547279596, 22.90427077189088, 22.907394266687334, 22.642842669039965, 22.335247181355953, 23.79961349566777, 24.046229962569967, 24.010222819944218, 18.769045071055487, 17.781881382067994, 18.97086354841788, 27.559889671703175, 27.835068130244807, 27.955601509039596, 19.582138285661728, 19.39170218134919, 19.60975067752102, 25.545679831256464, 25.645142129932836, 25.47921485950549, 12.426883766738072, 12.187628631790474, 12.104390186568097, 29.454983952144772, 29.612456443409116, 29.602207499245793, 27.67187575747569, 28.183116432589784, 27.965878405918673, 26.58317012960711, 26.31129779169956, 26.32530968884626, 20.142133379975945, 20.676107079178706, 20.601796465615422, 8.056839173038796, 8.15550549825032, 8.33997770150502, 22.64456422378619, 22.995254214232162, 22.939890542378023, 22.58035760124524, 22.960987163086727, 23.19466335450609, 21.04703690111637, 21.399768359959126, 21.37985030375421, 22.574258618056774, 22.439107730984688, 23.03447740059346, 18.988115408457816, 19.03499115887098, 18.560827866196632, 19.676298049588993, 19.576745962103203, 19.857228405152753, 25.897992681711912, 25.874789990484715, 25.052712187170982, 15.570671709875256, 15.830910687955708, 15.61456851909557, 19.43306980157891, 19.154904591540486, 19.33443212384978, 19.5152270719409, 19.915483884513378, 20.025461802259088, 17.918323551615075, 18.28710739811261, 18.194251035650566, 31.22921287066613, 31.05442816143234, 30.448920612533882, 14.241741537426904, 13.900574972232178, 13.767338288327053, 23.44352367023626, 23.742951812843472, 23.021524945894868, 24.079149740437657, 23.9963658923904, 24.260046167920024, 27.68071576456228, 27.125362450877816, 28.158069492472947, 29.18548287202914, 28.89578742285569, 29.219803263743714, 1.1346662094195636, 1.2903192130227836, 1.0331273501117977, 22.288806001966194, 21.898448300858334, 22.113608495642737, 26.862934331099183, 27.984717946189136, 27.91371047186354, 18.329230673611164, 18.766631008824334, 18.571529049426317, -2.7776435141762192, -2.4371993852158482, -3.6884961028893883, 2.1765975380937164, 2.4480377702663247, 1.3906392554441993, 25.63643705596526, 25.47238693137963, 25.965537210305527, -105.13049387186766, -105.21163401007652, -110.25898110866547, 27.875668632487447, 28.07481192300716, 28.198611962298543, 19.783515100677803, 20.186688117062047, 20.12199194108446, 24.57468907286723, 24.631506120165184, 24.83374462400873, 23.68744798501332, 24.020869606484965, 23.454757337768868, 12.483350217342377, 12.907041266560555, 12.899960346519947, 22.861133985221386, 23.37986796651967, 22.984595134854317, 12.63201133410135, 12.87604312474528, 12.356300959984452, 24.03926597038904, 24.443294956038386, 24.051402221123368, 26.473589422724515, 26.15887903918822, 25.956408878167466, 27.91302365561326, 28.14369612683852, 28.219210927685097, 18.995401597271353, 19.12917649249235, 18.784379641214997, 20.870654714604214, 21.089261985694364, 21.113910611098007, 22.061750705043465, 21.603218654791505, 23.015381570594997, 33.80853882431984, 34.20688611827791, 34.3260523743229, 17.82003931204477, 18.34265127281347, 17.945620375374943, 10.713756017386913, 11.245652738027275, 10.916845135390759, 18.551017993440226, 18.542541905616716, 18.60855022196968, 23.70235723629594, 23.580014865845442, 23.651127016171813, 21.988115794956684, 22.252678833901882, 22.3988526314497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15579334656595817, "mean_inference_ms": 0.7110344462315501, "mean_action_processing_ms": 0.10047281473735868, "mean_env_wait_ms": 0.8165672766426115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1007370, "timesteps_this_iter": 0, "agent_timesteps_total": 3022110, "timers": {"sample_time_ms": 20041.925, "sample_throughput": 478.697, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3018.491, "learn_throughput": 3178.41, "update_time_ms": 8.574}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.315108187962324e-11, "cur_lr": 0.0005, "total_loss": 70.76158809661865, "policy_loss": 0.002454462459770018, "vf_loss": 70.89485549926758, "vf_explained_var": 0.022084005177021027, "kl": 0.04640554613446867, "entropy": 13.572184562683105, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1007370, "num_agent_steps_sampled": 3022110, "num_steps_trained": 1007370, "num_agent_steps_trained": 3022110, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4147, "training_iteration": 105, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-18-57", "timestamp": 1706192337, "time_this_iter_s": 18.968774795532227, "time_total_s": 2136.593750476837, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B264C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2136.593750476837, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 10.033333333333333, "ram_util_percent": 48.13703703703704}}
{"episode_reward_max": 110.5679259672761, "episode_reward_min": -320.60110899060965, "episode_reward_mean": 60.828469148590955, "episode_len_mean": 298.62, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -110.25898110866547}, "policy_reward_max": {"shared_policy": 36.99616989865899}, "policy_reward_mean": {"shared_policy": 20.276156382863647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.965434946119757, 110.5679259672761, 41.27237283438444, 66.14673803001642, 73.56979233585295, 70.1025451943278, 69.73309703730047, 39.422351583838434, 82.81352408835664, 68.37656923383474, 67.88548411708325, 71.85606627818196, 55.52179000154136, 83.35055931098758, 58.58359114453194, 76.67003682069479, 36.71890258509664, 88.66964789479968, 83.82087059598415, 79.21977761015293, 61.42003692477007, 24.552322372794137, 68.57970898039638, 68.73600811883806, 63.82665556482971, 68.04784374963492, 56.58393443352543, 59.11027241684495, 76.82549485936761, 47.016150916926534, 57.922406516969176, 59.456172758713365, 54.39968198537825, 92.73256164463236, 41.909654797986136, 70.2080004289746, 72.33556180074808, 82.96414770791304, 87.30107355862854, 3.458112772554145, 66.30086279846726, 82.76136274915186, 55.667390731861815, -8.903339002281456, 6.01527456380424, 77.07436119765042, -320.60110899060965, 84.14909251779315, 60.09219515882431, 74.03993981704114, 71.16307492926715, 38.29035183042288, 69.22559708659537, 37.86435541883108, 72.53396314755079, 78.5888773400802, 84.27593071013688, 56.9089577309787, 63.073827311396585, 66.68035093042997, 102.34147731692065, 54.10831096023318, 32.876253890804946, 55.70211012102662, 70.9334991183132, 66.63964726030827, 77.77886669570577, 63.90624383762767, 67.74395288527012, 88.14767103455961, 70.8430893830955, 76.0913381204009, 31.083884667605147, 61.37623784691094, 53.8346204534173, 71.72608890011905, 81.44341876916586, 61.247686535119996, 94.99805512279272, 64.28052008897063, 77.00923039391635, 55.23470376431942, 82.52689910586923, 32.592437848448725, 72.49374371767043, 71.0508579984307, 46.73625834006813, 96.36920097842811, 70.64929455937818, 58.42944697290656, 54.14989015087485, 61.13066456280647, 63.44919929280877, 38.62177845090626, 90.27935701981185, 83.66569056361912, 68.30629078950732, 71.86441496387123, 83.39476871024814, 68.93561576865612], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 162, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.696625145773083, 10.390867138902337, 10.877942661444337, 36.83909631147981, 36.99616989865899, 36.7326597571373, 13.587226957082748, 13.848777428269386, 13.836368449032307, 22.11871039867401, 22.076606571674347, 21.951421059668064, 24.272091085712105, 24.486984493831784, 24.810716756309063, 23.38353760043779, 23.26049144814411, 23.458516145745904, 23.411924617365003, 23.055275447666645, 23.26589697226882, 11.973210255304963, 13.49857425192991, 13.950567076603562, 27.63489867374301, 27.509172566235065, 27.66945284837857, 22.46803091466427, 23.004267547279596, 22.90427077189088, 22.907394266687334, 22.642842669039965, 22.335247181355953, 23.79961349566777, 24.046229962569967, 24.010222819944218, 18.769045071055487, 17.781881382067994, 18.97086354841788, 27.559889671703175, 27.835068130244807, 27.955601509039596, 19.582138285661728, 19.39170218134919, 19.60975067752102, 25.545679831256464, 25.645142129932836, 25.47921485950549, 12.426883766738072, 12.187628631790474, 12.104390186568097, 29.454983952144772, 29.612456443409116, 29.602207499245793, 27.67187575747569, 28.183116432589784, 27.965878405918673, 26.58317012960711, 26.31129779169956, 26.32530968884626, 20.142133379975945, 20.676107079178706, 20.601796465615422, 8.056839173038796, 8.15550549825032, 8.33997770150502, 22.64456422378619, 22.995254214232162, 22.939890542378023, 22.58035760124524, 22.960987163086727, 23.19466335450609, 21.04703690111637, 21.399768359959126, 21.37985030375421, 22.574258618056774, 22.439107730984688, 23.03447740059346, 18.988115408457816, 19.03499115887098, 18.560827866196632, 19.676298049588993, 19.576745962103203, 19.857228405152753, 25.897992681711912, 25.874789990484715, 25.052712187170982, 15.570671709875256, 15.830910687955708, 15.61456851909557, 19.43306980157891, 19.154904591540486, 19.33443212384978, 19.5152270719409, 19.915483884513378, 20.025461802259088, 17.918323551615075, 18.28710739811261, 18.194251035650566, 31.22921287066613, 31.05442816143234, 30.448920612533882, 14.241741537426904, 13.900574972232178, 13.767338288327053, 23.44352367023626, 23.742951812843472, 23.021524945894868, 24.079149740437657, 23.9963658923904, 24.260046167920024, 27.68071576456228, 27.125362450877816, 28.158069492472947, 29.18548287202914, 28.89578742285569, 29.219803263743714, 1.1346662094195636, 1.2903192130227836, 1.0331273501117977, 22.288806001966194, 21.898448300858334, 22.113608495642737, 26.862934331099183, 27.984717946189136, 27.91371047186354, 18.329230673611164, 18.766631008824334, 18.571529049426317, -2.7776435141762192, -2.4371993852158482, -3.6884961028893883, 2.1765975380937164, 2.4480377702663247, 1.3906392554441993, 25.63643705596526, 25.47238693137963, 25.965537210305527, -105.13049387186766, -105.21163401007652, -110.25898110866547, 27.875668632487447, 28.07481192300716, 28.198611962298543, 19.783515100677803, 20.186688117062047, 20.12199194108446, 24.57468907286723, 24.631506120165184, 24.83374462400873, 23.68744798501332, 24.020869606484965, 23.454757337768868, 12.483350217342377, 12.907041266560555, 12.899960346519947, 22.861133985221386, 23.37986796651967, 22.984595134854317, 12.63201133410135, 12.87604312474528, 12.356300959984452, 24.03926597038904, 24.443294956038386, 24.051402221123368, 26.473589422724515, 26.15887903918822, 25.956408878167466, 27.91302365561326, 28.14369612683852, 28.219210927685097, 18.995401597271353, 19.12917649249235, 18.784379641214997, 20.870654714604214, 21.089261985694364, 21.113910611098007, 22.061750705043465, 21.603218654791505, 23.015381570594997, 33.80853882431984, 34.20688611827791, 34.3260523743229, 17.82003931204477, 18.34265127281347, 17.945620375374943, 10.713756017386913, 11.245652738027275, 10.916845135390759, 18.551017993440226, 18.542541905616716, 18.60855022196968, 23.70235723629594, 23.580014865845442, 23.651127016171813, 21.988115794956684, 22.252678833901882, 22.3988526314497, 26.059440756837517, 26.248955962403357, 25.470469976464898, 21.046366567413003, 21.21008540193239, 21.64979186828228, 22.317130222916603, 22.86667901277542, 22.560143649578094, 29.002312660217285, 29.635266145691276, 29.510092228651047, 23.791511993855238, 23.37472489476204, 23.676852494478226, 25.54628685861826, 25.125322088599205, 25.41972917318344, 10.460884583493069, 10.316233367969588, 10.30676671614249, 20.439005610843495, 20.455102552970246, 20.4821296830972, 17.409449517726898, 18.736426047980785, 17.688744887709618, 24.162402936567858, 23.590572496255234, 23.97311346729596, 27.37225449395676, 26.984072250624493, 27.087092024584607, 20.259641786416367, 20.54172270496686, 20.44632204373677, 31.238970950245857, 31.86741002649069, 31.891674146056175, 21.233398693303258, 21.54661752531925, 21.500503870348126, 25.626724687715367, 25.799166308095053, 25.583339398105934, 18.463814292103052, 18.276598636060953, 18.494290836155415, 27.191835194826126, 27.789456634782255, 27.545607276260853, 11.163362259666116, 10.673891971508652, 10.755183617273957, 24.191107143958405, 23.99215067674716, 24.310485896964863, 23.719651898990065, 23.7458624827365, 23.585343616704137, 15.732615381168813, 15.659044655660779, 15.344598303238541, 32.29290122662981, 31.95779312898715, 32.118506622811154, 23.932006970513612, 23.005348429083824, 23.71193915978074, 19.609808700780064, 19.593630510071904, 19.226007762054593, 18.13947107642889, 17.83219449222088, 18.178224582225084, 20.534679380555943, 19.613638420899704, 20.982346761350826, 21.240040622651577, 20.862786024808884, 21.34637264534831, 12.798692372937992, 12.777519312997654, 13.045566764970616, 29.836580981810883, 30.159444851179913, 30.28333118682106, 27.841742557783917, 27.975598906477288, 27.848349099357918, 22.528836717208222, 22.61200341333945, 23.165450658959642, 24.26624911030133, 24.06797308598955, 23.530192767580346, 27.65681871275106, 27.816822874049336, 27.921127123447746, 22.862118129928902, 23.137121080731347, 22.93637655799587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1556200775833405, "mean_inference_ms": 0.7104728512378999, "mean_action_processing_ms": 0.10040776557366271, "mean_env_wait_ms": 0.8159694970403276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1016964, "timesteps_this_iter": 0, "agent_timesteps_total": 3050892, "timers": {"sample_time_ms": 19951.785, "sample_throughput": 480.859, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3010.794, "learn_throughput": 3186.535, "update_time_ms": 8.478}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9726622819434855e-11, "cur_lr": 0.0005, "total_loss": 6.419111013412476, "policy_loss": 0.0022529194691929266, "vf_loss": 6.553293585777283, "vf_explained_var": 0.09800402820110321, "kl": 0.00975490667055667, "entropy": 13.643588423728943, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1016964, "num_agent_steps_sampled": 3050892, "num_steps_trained": 1016964, "num_agent_steps_trained": 3050892, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4181, "training_iteration": 106, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-19-15", "timestamp": 1706192355, "time_this_iter_s": 18.41695213317871, "time_total_s": 2155.010702610016, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2155.010702610016, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 5.980769230769231, "ram_util_percent": 48.07692307692308}}
{"episode_reward_max": 111.32999755442141, "episode_reward_min": -320.60110899060965, "episode_reward_mean": 61.809396771377216, "episode_len_mean": 298.62, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -110.25898110866547}, "policy_reward_max": {"shared_policy": 37.438303766151265}, "policy_reward_mean": {"shared_policy": 20.603132257125733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.922406516969176, 59.456172758713365, 54.39968198537825, 92.73256164463236, 41.909654797986136, 70.2080004289746, 72.33556180074808, 82.96414770791304, 87.30107355862854, 3.458112772554145, 66.30086279846726, 82.76136274915186, 55.667390731861815, -8.903339002281456, 6.01527456380424, 77.07436119765042, -320.60110899060965, 84.14909251779315, 60.09219515882431, 74.03993981704114, 71.16307492926715, 38.29035183042288, 69.22559708659537, 37.86435541883108, 72.53396314755079, 78.5888773400802, 84.27593071013688, 56.9089577309787, 63.073827311396585, 66.68035093042997, 102.34147731692065, 54.10831096023318, 32.876253890804946, 55.70211012102662, 70.9334991183132, 66.63964726030827, 77.77886669570577, 63.90624383762767, 67.74395288527012, 88.14767103455961, 70.8430893830955, 76.0913381204009, 31.083884667605147, 61.37623784691094, 53.8346204534173, 71.72608890011905, 81.44341876916586, 61.247686535119996, 94.99805512279272, 64.28052008897063, 77.00923039391635, 55.23470376431942, 82.52689910586923, 32.592437848448725, 72.49374371767043, 71.0508579984307, 46.73625834006813, 96.36920097842811, 70.64929455937818, 58.42944697290656, 54.14989015087485, 61.13066456280647, 63.44919929280877, 38.62177845090626, 90.27935701981185, 83.66569056361912, 68.30629078950732, 71.86441496387123, 83.39476871024814, 68.93561576865612, 63.55692360550165, 66.05090829730031, 86.06023971410467, 71.15566009655593, 75.7217231299728, 71.36626470088956, -2.510938987135887, 86.67204866744576, 39.099473202135414, 56.79341333732006, 64.38461282849309, 73.20766088739035, 53.33877957449292, 72.92001045495272, 82.00940866768359, 65.00477532297371, 103.60313388705251, 38.847403123974786, 14.852365456521497, 64.198037173599, 78.23620017245409, 75.16935237124561, 80.99443788453934, 77.7832392938435, 77.44058265723285, 86.88710299506782, 111.32999755442141, 55.65766051597892, 82.75256779789922, 76.47522384300828], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 162, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.43306980157891, 19.154904591540486, 19.33443212384978, 19.5152270719409, 19.915483884513378, 20.025461802259088, 17.918323551615075, 18.28710739811261, 18.194251035650566, 31.22921287066613, 31.05442816143234, 30.448920612533882, 14.241741537426904, 13.900574972232178, 13.767338288327053, 23.44352367023626, 23.742951812843472, 23.021524945894868, 24.079149740437657, 23.9963658923904, 24.260046167920024, 27.68071576456228, 27.125362450877816, 28.158069492472947, 29.18548287202914, 28.89578742285569, 29.219803263743714, 1.1346662094195636, 1.2903192130227836, 1.0331273501117977, 22.288806001966194, 21.898448300858334, 22.113608495642737, 26.862934331099183, 27.984717946189136, 27.91371047186354, 18.329230673611164, 18.766631008824334, 18.571529049426317, -2.7776435141762192, -2.4371993852158482, -3.6884961028893883, 2.1765975380937164, 2.4480377702663247, 1.3906392554441993, 25.63643705596526, 25.47238693137963, 25.965537210305527, -105.13049387186766, -105.21163401007652, -110.25898110866547, 27.875668632487447, 28.07481192300716, 28.198611962298543, 19.783515100677803, 20.186688117062047, 20.12199194108446, 24.57468907286723, 24.631506120165184, 24.83374462400873, 23.68744798501332, 24.020869606484965, 23.454757337768868, 12.483350217342377, 12.907041266560555, 12.899960346519947, 22.861133985221386, 23.37986796651967, 22.984595134854317, 12.63201133410135, 12.87604312474528, 12.356300959984452, 24.03926597038904, 24.443294956038386, 24.051402221123368, 26.473589422724515, 26.15887903918822, 25.956408878167466, 27.91302365561326, 28.14369612683852, 28.219210927685097, 18.995401597271353, 19.12917649249235, 18.784379641214997, 20.870654714604214, 21.089261985694364, 21.113910611098007, 22.061750705043465, 21.603218654791505, 23.015381570594997, 33.80853882431984, 34.20688611827791, 34.3260523743229, 17.82003931204477, 18.34265127281347, 17.945620375374943, 10.713756017386913, 11.245652738027275, 10.916845135390759, 18.551017993440226, 18.542541905616716, 18.60855022196968, 23.70235723629594, 23.580014865845442, 23.651127016171813, 21.988115794956684, 22.252678833901882, 22.3988526314497, 26.059440756837517, 26.248955962403357, 25.470469976464898, 21.046366567413003, 21.21008540193239, 21.64979186828228, 22.317130222916603, 22.86667901277542, 22.560143649578094, 29.002312660217285, 29.635266145691276, 29.510092228651047, 23.791511993855238, 23.37472489476204, 23.676852494478226, 25.54628685861826, 25.125322088599205, 25.41972917318344, 10.460884583493069, 10.316233367969588, 10.30676671614249, 20.439005610843495, 20.455102552970246, 20.4821296830972, 17.409449517726898, 18.736426047980785, 17.688744887709618, 24.162402936567858, 23.590572496255234, 23.97311346729596, 27.37225449395676, 26.984072250624493, 27.087092024584607, 20.259641786416367, 20.54172270496686, 20.44632204373677, 31.238970950245857, 31.86741002649069, 31.891674146056175, 21.233398693303258, 21.54661752531925, 21.500503870348126, 25.626724687715367, 25.799166308095053, 25.583339398105934, 18.463814292103052, 18.276598636060953, 18.494290836155415, 27.191835194826126, 27.789456634782255, 27.545607276260853, 11.163362259666116, 10.673891971508652, 10.755183617273957, 24.191107143958405, 23.99215067674716, 24.310485896964863, 23.719651898990065, 23.7458624827365, 23.585343616704137, 15.732615381168813, 15.659044655660779, 15.344598303238541, 32.29290122662981, 31.95779312898715, 32.118506622811154, 23.932006970513612, 23.005348429083824, 23.71193915978074, 19.609808700780064, 19.593630510071904, 19.226007762054593, 18.13947107642889, 17.83219449222088, 18.178224582225084, 20.534679380555943, 19.613638420899704, 20.982346761350826, 21.240040622651577, 20.862786024808884, 21.34637264534831, 12.798692372937992, 12.777519312997654, 13.045566764970616, 29.836580981810883, 30.159444851179913, 30.28333118682106, 27.841742557783917, 27.975598906477288, 27.848349099357918, 22.528836717208222, 22.61200341333945, 23.165450658959642, 24.26624911030133, 24.06797308598955, 23.530192767580346, 27.65681871275106, 27.816822874049336, 27.921127123447746, 22.862118129928902, 23.137121080731347, 22.93637655799587, 21.26026937738061, 21.02646019309759, 21.27019403502345, 22.19670259455839, 21.82030939559141, 22.033896307150513, 28.467245769997433, 28.756700556104377, 28.836293388002858, 23.917539933075503, 23.404144843419388, 23.833975320061043, 25.424120373403028, 25.013459672530487, 25.284143084039286, 23.562681684891373, 24.029588448504597, 23.773994567493588, -0.9049829989671707, -0.7381634935736656, -0.8677924945950508, 28.815226578464106, 28.783158031602696, 29.073664057378963, 13.446679124142975, 13.296893119812012, 12.355900958180428, 19.188959545145423, 18.65659054617086, 18.947863246003777, 21.57879831145206, 21.92973384509483, 20.876080671946198, 24.344656477371842, 24.593189461777598, 24.269814948240906, 17.76389734322825, 17.970731203366682, 17.604151027897984, 24.368995115160942, 24.530987463891506, 24.02002787590027, 27.200258885820702, 27.244822223981217, 27.56432755788167, 21.762471852203205, 21.454401445885495, 21.787902024885014, 34.63205336655179, 34.33432356516519, 34.63675695533553, 12.906726253529385, 12.877438952525452, 13.063237917919949, 5.132049029072121, 4.881485295792416, 4.83883113165696, 21.670070555061102, 21.412756130099297, 21.115210488438606, 26.249234824130923, 25.85326900581518, 26.13369634250799, 24.818899278839424, 25.09060016026099, 25.259852932145193, 26.99801784257093, 26.8864391768972, 27.109980865071208, 25.918951486547783, 25.561436121662453, 26.302851685633257, 25.906984484444052, 25.701943556467683, 25.831654616321117, 29.197631010164812, 28.689597134788826, 28.999874850114182, 37.438303766151265, 36.675760125120476, 37.21593366314967, 18.708112339799598, 18.62526548778017, 18.32428268839915, 27.5778751472632, 27.937235126892716, 27.237457523743302, 25.355505608022213, 25.672976095229387, 25.44674213975668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1554748696746948, "mean_inference_ms": 0.7100479899336007, "mean_action_processing_ms": 0.10039697414188943, "mean_env_wait_ms": 0.8154922140784678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1026558, "timesteps_this_iter": 0, "agent_timesteps_total": 3079674, "timers": {"sample_time_ms": 19840.641, "sample_throughput": 483.553, "load_time_ms": 0.3, "load_throughput": 31964534.575, "learn_time_ms": 3006.656, "learn_throughput": 3190.92, "update_time_ms": 8.377}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9726622819434855e-11, "cur_lr": 0.0005, "total_loss": 8.352687954902649, "policy_loss": -0.00021588145967732508, "vf_loss": 8.490290641784668, "vf_explained_var": 0.07449682801961899, "kl": 0.010470281035077501, "entropy": 13.738668203353882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1026558, "num_agent_steps_sampled": 3079674, "num_steps_trained": 1026558, "num_agent_steps_trained": 3079674, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4211, "training_iteration": 107, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-19-33", "timestamp": 1706192373, "time_this_iter_s": 18.38306760787964, "time_total_s": 2173.3937702178955, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205FCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2173.3937702178955, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 5.961538461538462, "ram_util_percent": 48.11538461538461}}
{"episode_reward_max": 111.32999755442141, "episode_reward_min": -2.510938987135887, "episode_reward_mean": 69.02477898015131, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -0.9049829989671707}, "policy_reward_max": {"shared_policy": 37.438303766151265}, "policy_reward_mean": {"shared_policy": 23.00825966005043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.70211012102662, 70.9334991183132, 66.63964726030827, 77.77886669570577, 63.90624383762767, 67.74395288527012, 88.14767103455961, 70.8430893830955, 76.0913381204009, 31.083884667605147, 61.37623784691094, 53.8346204534173, 71.72608890011905, 81.44341876916586, 61.247686535119996, 94.99805512279272, 64.28052008897063, 77.00923039391635, 55.23470376431942, 82.52689910586923, 32.592437848448725, 72.49374371767043, 71.0508579984307, 46.73625834006813, 96.36920097842811, 70.64929455937818, 58.42944697290656, 54.14989015087485, 61.13066456280647, 63.44919929280877, 38.62177845090626, 90.27935701981185, 83.66569056361912, 68.30629078950732, 71.86441496387123, 83.39476871024814, 68.93561576865612, 63.55692360550165, 66.05090829730031, 86.06023971410467, 71.15566009655593, 75.7217231299728, 71.36626470088956, -2.510938987135887, 86.67204866744576, 39.099473202135414, 56.79341333732006, 64.38461282849309, 73.20766088739035, 53.33877957449292, 72.92001045495272, 82.00940866768359, 65.00477532297371, 103.60313388705251, 38.847403123974786, 14.852365456521497, 64.198037173599, 78.23620017245409, 75.16935237124561, 80.99443788453934, 77.7832392938435, 77.44058265723285, 86.88710299506782, 111.32999755442141, 55.65766051597892, 82.75256779789922, 76.47522384300828, 88.14518035948275, 69.50031182356179, 47.1060260683298, 77.27364436537026, 72.46906251471952, 97.01474244892594, 51.196312472224236, 86.18219966255128, 70.38423388078806, 58.33470053970812, 38.49282568693161, 65.38644555956125, 71.1424628634704, 79.68614630401133, 65.02953303977847, 61.79663379117845, 79.84369978867468, 70.65966872125863, 86.93792862258849, 71.50017592683432, 75.40064566070214, 70.05438488349316, 73.42302390537222, 69.34443584550169, 77.24818296614103, 87.20709374919534, 51.265342995524406, 74.60155682265757, 67.08743340522051, 63.39930947963147, 89.0997572094202, 64.86445865035057, 77.67539498209952], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.551017993440226, 18.542541905616716, 18.60855022196968, 23.70235723629594, 23.580014865845442, 23.651127016171813, 21.988115794956684, 22.252678833901882, 22.3988526314497, 26.059440756837517, 26.248955962403357, 25.470469976464898, 21.046366567413003, 21.21008540193239, 21.64979186828228, 22.317130222916603, 22.86667901277542, 22.560143649578094, 29.002312660217285, 29.635266145691276, 29.510092228651047, 23.791511993855238, 23.37472489476204, 23.676852494478226, 25.54628685861826, 25.125322088599205, 25.41972917318344, 10.460884583493069, 10.316233367969588, 10.30676671614249, 20.439005610843495, 20.455102552970246, 20.4821296830972, 17.409449517726898, 18.736426047980785, 17.688744887709618, 24.162402936567858, 23.590572496255234, 23.97311346729596, 27.37225449395676, 26.984072250624493, 27.087092024584607, 20.259641786416367, 20.54172270496686, 20.44632204373677, 31.238970950245857, 31.86741002649069, 31.891674146056175, 21.233398693303258, 21.54661752531925, 21.500503870348126, 25.626724687715367, 25.799166308095053, 25.583339398105934, 18.463814292103052, 18.276598636060953, 18.494290836155415, 27.191835194826126, 27.789456634782255, 27.545607276260853, 11.163362259666116, 10.673891971508652, 10.755183617273957, 24.191107143958405, 23.99215067674716, 24.310485896964863, 23.719651898990065, 23.7458624827365, 23.585343616704137, 15.732615381168813, 15.659044655660779, 15.344598303238541, 32.29290122662981, 31.95779312898715, 32.118506622811154, 23.932006970513612, 23.005348429083824, 23.71193915978074, 19.609808700780064, 19.593630510071904, 19.226007762054593, 18.13947107642889, 17.83219449222088, 18.178224582225084, 20.534679380555943, 19.613638420899704, 20.982346761350826, 21.240040622651577, 20.862786024808884, 21.34637264534831, 12.798692372937992, 12.777519312997654, 13.045566764970616, 29.836580981810883, 30.159444851179913, 30.28333118682106, 27.841742557783917, 27.975598906477288, 27.848349099357918, 22.528836717208222, 22.61200341333945, 23.165450658959642, 24.26624911030133, 24.06797308598955, 23.530192767580346, 27.65681871275106, 27.816822874049336, 27.921127123447746, 22.862118129928902, 23.137121080731347, 22.93637655799587, 21.26026937738061, 21.02646019309759, 21.27019403502345, 22.19670259455839, 21.82030939559141, 22.033896307150513, 28.467245769997433, 28.756700556104377, 28.836293388002858, 23.917539933075503, 23.404144843419388, 23.833975320061043, 25.424120373403028, 25.013459672530487, 25.284143084039286, 23.562681684891373, 24.029588448504597, 23.773994567493588, -0.9049829989671707, -0.7381634935736656, -0.8677924945950508, 28.815226578464106, 28.783158031602696, 29.073664057378963, 13.446679124142975, 13.296893119812012, 12.355900958180428, 19.188959545145423, 18.65659054617086, 18.947863246003777, 21.57879831145206, 21.92973384509483, 20.876080671946198, 24.344656477371842, 24.593189461777598, 24.269814948240906, 17.76389734322825, 17.970731203366682, 17.604151027897984, 24.368995115160942, 24.530987463891506, 24.02002787590027, 27.200258885820702, 27.244822223981217, 27.56432755788167, 21.762471852203205, 21.454401445885495, 21.787902024885014, 34.63205336655179, 34.33432356516519, 34.63675695533553, 12.906726253529385, 12.877438952525452, 13.063237917919949, 5.132049029072121, 4.881485295792416, 4.83883113165696, 21.670070555061102, 21.412756130099297, 21.115210488438606, 26.249234824130923, 25.85326900581518, 26.13369634250799, 24.818899278839424, 25.09060016026099, 25.259852932145193, 26.99801784257093, 26.8864391768972, 27.109980865071208, 25.918951486547783, 25.561436121662453, 26.302851685633257, 25.906984484444052, 25.701943556467683, 25.831654616321117, 29.197631010164812, 28.689597134788826, 28.999874850114182, 37.438303766151265, 36.675760125120476, 37.21593366314967, 18.708112339799598, 18.62526548778017, 18.32428268839915, 27.5778751472632, 27.937235126892716, 27.237457523743302, 25.355505608022213, 25.672976095229387, 25.44674213975668, 29.268346582849816, 29.42531470706065, 29.451519069572285, 22.966092817485332, 23.302522340789437, 23.231696665287018, 15.904922296603516, 15.63376597811778, 15.567337793608502, 25.687395734091595, 25.65441372742255, 25.931834903856114, 24.22000317523876, 23.723242829243333, 24.525816510237433, 32.13127871106067, 32.379569123188645, 32.503894614676625, 17.131195731461048, 17.064183458685875, 17.000933282077312, 28.85856820642948, 29.023205092176795, 28.300426363945007, 23.52570632720986, 23.36724471549192, 23.491282838086278, 19.483445662384227, 19.399787498017147, 19.45146737930675, 12.943488478660583, 12.817022919654846, 12.73231428861618, 21.846001856029034, 21.641468703746796, 21.898974999785423, 23.520258898536355, 23.9513318776541, 23.670872087279946, 26.255484794576958, 26.722381201883152, 26.70828030755122, 21.568599939346313, 22.087053935974836, 21.37387916445732, 20.814928227414683, 20.427043942113713, 20.554661621650055, 26.728176193932683, 26.448029371599347, 26.667494223142654, 23.32296237846215, 23.696090285976723, 23.640616056819752, 29.117750744024903, 28.69079466412464, 29.129383214438946, 23.78017997244993, 24.045225641379744, 23.674770313004643, 24.98895313590765, 25.058622136712074, 25.353070388082415, 23.739674552033335, 23.727327617506177, 22.587382713953644, 24.907912021890894, 24.31795325378576, 24.197158629695565, 23.280968330490083, 23.08425340304771, 22.9792141119639, 25.65747883170843, 25.512019023299217, 26.07868511113338, 29.230144131928682, 29.037472806870937, 28.939476810395718, 17.008322916924953, 16.970604687929153, 17.2864153906703, 25.14012938862045, 25.16024875019987, 24.30117868383725, 22.596622988581657, 22.110860779881477, 22.379949636757374, 20.862487857540444, 21.11574590702851, 21.421075715062514, 29.900651656091213, 29.62710228562355, 29.57200326770544, 21.529503658413887, 21.825630858540535, 21.50932413339615, 25.667798360188797, 26.207011704643563, 25.80058491726716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15528847399196344, "mean_inference_ms": 0.7092004569922874, "mean_action_processing_ms": 0.10028532719350934, "mean_env_wait_ms": 0.8147839204188857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1036152, "timesteps_this_iter": 0, "agent_timesteps_total": 3108456, "timers": {"sample_time_ms": 19662.729, "sample_throughput": 487.928, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3006.33, "learn_throughput": 3191.266, "update_time_ms": 8.278}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9726622819434855e-11, "cur_lr": 0.0005, "total_loss": 5.775658130645752, "policy_loss": 0.00742972756243776, "vf_loss": 5.904849410057068, "vf_explained_var": 0.042580172419548035, "kl": 0.05089334526578354, "entropy": 13.662096738815308, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1036152, "num_agent_steps_sampled": 3108456, "num_steps_trained": 1036152, "num_agent_steps_trained": 3108456, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4244, "training_iteration": 108, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-19-52", "timestamp": 1706192392, "time_this_iter_s": 18.820165872573853, "time_total_s": 2192.2139360904694, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2192.2139360904694, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 7.800000000000001, "ram_util_percent": 48.16923076923077}}
{"episode_reward_max": 111.32999755442141, "episode_reward_min": -2.510938987135887, "episode_reward_mean": 67.40150231423904, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -0.9049829989671707}, "policy_reward_max": {"shared_policy": 37.438303766151265}, "policy_reward_mean": {"shared_policy": 22.467167438079674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.66569056361912, 68.30629078950732, 71.86441496387123, 83.39476871024814, 68.93561576865612, 63.55692360550165, 66.05090829730031, 86.06023971410467, 71.15566009655593, 75.7217231299728, 71.36626470088956, -2.510938987135887, 86.67204866744576, 39.099473202135414, 56.79341333732006, 64.38461282849309, 73.20766088739035, 53.33877957449292, 72.92001045495272, 82.00940866768359, 65.00477532297371, 103.60313388705251, 38.847403123974786, 14.852365456521497, 64.198037173599, 78.23620017245409, 75.16935237124561, 80.99443788453934, 77.7832392938435, 77.44058265723285, 86.88710299506782, 111.32999755442141, 55.65766051597892, 82.75256779789922, 76.47522384300828, 88.14518035948275, 69.50031182356179, 47.1060260683298, 77.27364436537026, 72.46906251471952, 97.01474244892594, 51.196312472224236, 86.18219966255128, 70.38423388078806, 58.33470053970812, 38.49282568693161, 65.38644555956125, 71.1424628634704, 79.68614630401133, 65.02953303977847, 61.79663379117845, 79.84369978867468, 70.65966872125863, 86.93792862258849, 71.50017592683432, 75.40064566070214, 70.05438488349316, 73.42302390537222, 69.34443584550169, 77.24818296614103, 87.20709374919534, 51.265342995524406, 74.60155682265757, 67.08743340522051, 63.39930947963147, 89.0997572094202, 64.86445865035057, 77.67539498209952, 60.79327495023607, 50.10597895272076, 75.63467181846497, 63.953653789591016, 60.35367524123285, 61.04977082833648, 59.04482711665332, 48.189936985261724, 51.64529718086122, 53.80306565947829, 83.4644876644015, 67.25827743858098, 47.24348342791198, 77.80938680656253, 64.76513342850376, 50.709462795406566, 48.66018676012753, 58.921700824052095, 43.56049218890254, 79.02562499139455, 60.92649046541189, 83.43416570127009, 89.56654988974333, 48.101062751491554, 67.19224438909441, 58.34955970570445, 71.84074468165635, 67.41583523899317, 41.729145273566246, 46.38790452852842, 64.90525535121557, 60.330880580469966], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.841742557783917, 27.975598906477288, 27.848349099357918, 22.528836717208222, 22.61200341333945, 23.165450658959642, 24.26624911030133, 24.06797308598955, 23.530192767580346, 27.65681871275106, 27.816822874049336, 27.921127123447746, 22.862118129928902, 23.137121080731347, 22.93637655799587, 21.26026937738061, 21.02646019309759, 21.27019403502345, 22.19670259455839, 21.82030939559141, 22.033896307150513, 28.467245769997433, 28.756700556104377, 28.836293388002858, 23.917539933075503, 23.404144843419388, 23.833975320061043, 25.424120373403028, 25.013459672530487, 25.284143084039286, 23.562681684891373, 24.029588448504597, 23.773994567493588, -0.9049829989671707, -0.7381634935736656, -0.8677924945950508, 28.815226578464106, 28.783158031602696, 29.073664057378963, 13.446679124142975, 13.296893119812012, 12.355900958180428, 19.188959545145423, 18.65659054617086, 18.947863246003777, 21.57879831145206, 21.92973384509483, 20.876080671946198, 24.344656477371842, 24.593189461777598, 24.269814948240906, 17.76389734322825, 17.970731203366682, 17.604151027897984, 24.368995115160942, 24.530987463891506, 24.02002787590027, 27.200258885820702, 27.244822223981217, 27.56432755788167, 21.762471852203205, 21.454401445885495, 21.787902024885014, 34.63205336655179, 34.33432356516519, 34.63675695533553, 12.906726253529385, 12.877438952525452, 13.063237917919949, 5.132049029072121, 4.881485295792416, 4.83883113165696, 21.670070555061102, 21.412756130099297, 21.115210488438606, 26.249234824130923, 25.85326900581518, 26.13369634250799, 24.818899278839424, 25.09060016026099, 25.259852932145193, 26.99801784257093, 26.8864391768972, 27.109980865071208, 25.918951486547783, 25.561436121662453, 26.302851685633257, 25.906984484444052, 25.701943556467683, 25.831654616321117, 29.197631010164812, 28.689597134788826, 28.999874850114182, 37.438303766151265, 36.675760125120476, 37.21593366314967, 18.708112339799598, 18.62526548778017, 18.32428268839915, 27.5778751472632, 27.937235126892716, 27.237457523743302, 25.355505608022213, 25.672976095229387, 25.44674213975668, 29.268346582849816, 29.42531470706065, 29.451519069572285, 22.966092817485332, 23.302522340789437, 23.231696665287018, 15.904922296603516, 15.63376597811778, 15.567337793608502, 25.687395734091595, 25.65441372742255, 25.931834903856114, 24.22000317523876, 23.723242829243333, 24.525816510237433, 32.13127871106067, 32.379569123188645, 32.503894614676625, 17.131195731461048, 17.064183458685875, 17.000933282077312, 28.85856820642948, 29.023205092176795, 28.300426363945007, 23.52570632720986, 23.36724471549192, 23.491282838086278, 19.483445662384227, 19.399787498017147, 19.45146737930675, 12.943488478660583, 12.817022919654846, 12.73231428861618, 21.846001856029034, 21.641468703746796, 21.898974999785423, 23.520258898536355, 23.9513318776541, 23.670872087279946, 26.255484794576958, 26.722381201883152, 26.70828030755122, 21.568599939346313, 22.087053935974836, 21.37387916445732, 20.814928227414683, 20.427043942113713, 20.554661621650055, 26.728176193932683, 26.448029371599347, 26.667494223142654, 23.32296237846215, 23.696090285976723, 23.640616056819752, 29.117750744024903, 28.69079466412464, 29.129383214438946, 23.78017997244993, 24.045225641379744, 23.674770313004643, 24.98895313590765, 25.058622136712074, 25.353070388082415, 23.739674552033335, 23.727327617506177, 22.587382713953644, 24.907912021890894, 24.31795325378576, 24.197158629695565, 23.280968330490083, 23.08425340304771, 22.9792141119639, 25.65747883170843, 25.512019023299217, 26.07868511113338, 29.230144131928682, 29.037472806870937, 28.939476810395718, 17.008322916924953, 16.970604687929153, 17.2864153906703, 25.14012938862045, 25.16024875019987, 24.30117868383725, 22.596622988581657, 22.110860779881477, 22.379949636757374, 20.862487857540444, 21.11574590702851, 21.421075715062514, 29.900651656091213, 29.62710228562355, 29.57200326770544, 21.529503658413887, 21.825630858540535, 21.50932413339615, 25.667798360188797, 26.207011704643563, 25.80058491726716, 20.185388827075556, 20.29164870952566, 20.316237413634852, 16.49117798358202, 16.69316378235817, 16.921637186780572, 25.073372217516095, 25.31271584207812, 25.24858375887075, 21.336020237921417, 21.305197914751858, 21.31243563691774, 20.099923402071, 20.32531137263868, 19.92844046652317, 20.543991204351187, 20.271877355873585, 20.233902268111706, 19.434197463095188, 19.805095886811614, 19.80553376674652, 15.70723708470662, 16.330636089978114, 16.15206381057699, 17.239996963491038, 17.295320858558014, 17.10997935881217, 17.92815987889965, 17.74455442031224, 18.130351360266403, 27.81440898279348, 27.76207215587297, 27.88800652573505, 22.58397616942723, 22.221788321932152, 22.452512947221592, 15.687670753647879, 15.705405948062733, 15.85040672620137, 25.935637300213173, 25.95510074992974, 25.918648756419614, 21.32510557025671, 21.828629667987116, 21.611398190259933, 16.882803556819752, 16.792726447184876, 17.033932791401938, 16.34711655726035, 16.296001960833863, 16.017068242033318, 19.94279609248042, 19.832273192703724, 19.14663153886795, 15.047699995261297, 13.613671789566666, 14.89912040407458, 26.5937060896928, 26.10575461635986, 26.32616428534189, 20.584707991142437, 20.03547904888788, 20.30630342538157, 27.537428384025887, 27.96049617355068, 27.936241143693522, 29.74376303702593, 29.780950486660004, 30.041836366057396, 16.023080185055733, 16.252796284039505, 15.825186282396317, 22.024144798517227, 22.634474870748818, 22.533624719828367, 19.330372788012028, 19.377715304493904, 19.64147161319852, 23.68741165598233, 23.80003984769185, 24.353293177982167, 22.40719984471798, 22.4387449324131, 22.569890461862087, 14.0183325111866, 13.85246068239212, 13.858352079987526, 15.818130640933902, 15.382155279318482, 15.18761860827604, 21.034048462907464, 21.86334369952479, 22.00786318878332, 20.187451668083668, 19.926909185945988, 20.21651972644031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15516051476188664, "mean_inference_ms": 0.7087165437127748, "mean_action_processing_ms": 0.10023313821809346, "mean_env_wait_ms": 0.8142055789139784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1045746, "timesteps_this_iter": 0, "agent_timesteps_total": 3137238, "timers": {"sample_time_ms": 19487.445, "sample_throughput": 492.317, "load_time_ms": 0.201, "load_throughput": 47847981.66, "learn_time_ms": 3001.462, "learn_throughput": 3196.442, "update_time_ms": 8.278}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.458993422915228e-11, "cur_lr": 0.0005, "total_loss": 6.440952181816101, "policy_loss": 0.0033335345711726916, "vf_loss": 6.577586352825165, "vf_explained_var": 0.04615464061498642, "kl": 0.02305380886551601, "entropy": 13.996775388717651, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1045746, "num_agent_steps_sampled": 3137238, "num_steps_trained": 1045746, "num_agent_steps_trained": 3137238, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4276, "training_iteration": 109, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-20-11", "timestamp": 1706192411, "time_this_iter_s": 18.517959117889404, "time_total_s": 2210.7318952083588, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B26B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2210.7318952083588, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 8.085185185185185, "ram_util_percent": 48.22222222222223}}
{"episode_reward_max": 111.32999755442141, "episode_reward_min": -4.194926477968707, "episode_reward_mean": 66.46253030067717, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -1.480026433865234}, "policy_reward_max": {"shared_policy": 37.438303766151265}, "policy_reward_mean": {"shared_policy": 22.154176766892387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.32999755442141, 55.65766051597892, 82.75256779789922, 76.47522384300828, 88.14518035948275, 69.50031182356179, 47.1060260683298, 77.27364436537026, 72.46906251471952, 97.01474244892594, 51.196312472224236, 86.18219966255128, 70.38423388078806, 58.33470053970812, 38.49282568693161, 65.38644555956125, 71.1424628634704, 79.68614630401133, 65.02953303977847, 61.79663379117845, 79.84369978867468, 70.65966872125863, 86.93792862258849, 71.50017592683432, 75.40064566070214, 70.05438488349316, 73.42302390537222, 69.34443584550169, 77.24818296614103, 87.20709374919534, 51.265342995524406, 74.60155682265757, 67.08743340522051, 63.39930947963147, 89.0997572094202, 64.86445865035057, 77.67539498209952, 60.79327495023607, 50.10597895272076, 75.63467181846497, 63.953653789591016, 60.35367524123285, 61.04977082833648, 59.04482711665332, 48.189936985261724, 51.64529718086122, 53.80306565947829, 83.4644876644015, 67.25827743858098, 47.24348342791198, 77.80938680656253, 64.76513342850376, 50.709462795406566, 48.66018676012753, 58.921700824052095, 43.56049218890254, 79.02562499139455, 60.92649046541189, 83.43416570127009, 89.56654988974333, 48.101062751491554, 67.19224438909441, 58.34955970570445, 71.84074468165635, 67.41583523899317, 41.729145273566246, 46.38790452852842, 64.90525535121557, 60.330880580469966, 88.90852913539857, 69.78603567485696, 84.08904393389821, 67.68432229757306, 59.38696409761903, 37.00712159182876, 66.04881918802855, 60.44807520695031, 60.4213834814727, 78.55892280396073, 56.378739435225725, 61.76955279102546, 72.79260416777103, 82.11563723161815, 79.33409030735493, 37.393859788775444, -4.194926477968707, 104.93392997514454, 66.71152819693086, 77.7830602545291, 54.56628142669797, 48.44856641814113, 74.51880967617033, 51.032398754730806, 14.79897869750856, 65.21619826555249, 82.24042815528809, 75.09826971963047, 72.89233392477034, 75.4099356178194, 83.53290421701965], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [37.438303766151265, 36.675760125120476, 37.21593366314967, 18.708112339799598, 18.62526548778017, 18.32428268839915, 27.5778751472632, 27.937235126892716, 27.237457523743302, 25.355505608022213, 25.672976095229387, 25.44674213975668, 29.268346582849816, 29.42531470706065, 29.451519069572285, 22.966092817485332, 23.302522340789437, 23.231696665287018, 15.904922296603516, 15.63376597811778, 15.567337793608502, 25.687395734091595, 25.65441372742255, 25.931834903856114, 24.22000317523876, 23.723242829243333, 24.525816510237433, 32.13127871106067, 32.379569123188645, 32.503894614676625, 17.131195731461048, 17.064183458685875, 17.000933282077312, 28.85856820642948, 29.023205092176795, 28.300426363945007, 23.52570632720986, 23.36724471549192, 23.491282838086278, 19.483445662384227, 19.399787498017147, 19.45146737930675, 12.943488478660583, 12.817022919654846, 12.73231428861618, 21.846001856029034, 21.641468703746796, 21.898974999785423, 23.520258898536355, 23.9513318776541, 23.670872087279946, 26.255484794576958, 26.722381201883152, 26.70828030755122, 21.568599939346313, 22.087053935974836, 21.37387916445732, 20.814928227414683, 20.427043942113713, 20.554661621650055, 26.728176193932683, 26.448029371599347, 26.667494223142654, 23.32296237846215, 23.696090285976723, 23.640616056819752, 29.117750744024903, 28.69079466412464, 29.129383214438946, 23.78017997244993, 24.045225641379744, 23.674770313004643, 24.98895313590765, 25.058622136712074, 25.353070388082415, 23.739674552033335, 23.727327617506177, 22.587382713953644, 24.907912021890894, 24.31795325378576, 24.197158629695565, 23.280968330490083, 23.08425340304771, 22.9792141119639, 25.65747883170843, 25.512019023299217, 26.07868511113338, 29.230144131928682, 29.037472806870937, 28.939476810395718, 17.008322916924953, 16.970604687929153, 17.2864153906703, 25.14012938862045, 25.16024875019987, 24.30117868383725, 22.596622988581657, 22.110860779881477, 22.379949636757374, 20.862487857540444, 21.11574590702851, 21.421075715062514, 29.900651656091213, 29.62710228562355, 29.57200326770544, 21.529503658413887, 21.825630858540535, 21.50932413339615, 25.667798360188797, 26.207011704643563, 25.80058491726716, 20.185388827075556, 20.29164870952566, 20.316237413634852, 16.49117798358202, 16.69316378235817, 16.921637186780572, 25.073372217516095, 25.31271584207812, 25.24858375887075, 21.336020237921417, 21.305197914751858, 21.31243563691774, 20.099923402071, 20.32531137263868, 19.92844046652317, 20.543991204351187, 20.271877355873585, 20.233902268111706, 19.434197463095188, 19.805095886811614, 19.80553376674652, 15.70723708470662, 16.330636089978114, 16.15206381057699, 17.239996963491038, 17.295320858558014, 17.10997935881217, 17.92815987889965, 17.74455442031224, 18.130351360266403, 27.81440898279348, 27.76207215587297, 27.88800652573505, 22.58397616942723, 22.221788321932152, 22.452512947221592, 15.687670753647879, 15.705405948062733, 15.85040672620137, 25.935637300213173, 25.95510074992974, 25.918648756419614, 21.32510557025671, 21.828629667987116, 21.611398190259933, 16.882803556819752, 16.792726447184876, 17.033932791401938, 16.34711655726035, 16.296001960833863, 16.017068242033318, 19.94279609248042, 19.832273192703724, 19.14663153886795, 15.047699995261297, 13.613671789566666, 14.89912040407458, 26.5937060896928, 26.10575461635986, 26.32616428534189, 20.584707991142437, 20.03547904888788, 20.30630342538157, 27.537428384025887, 27.96049617355068, 27.936241143693522, 29.74376303702593, 29.780950486660004, 30.041836366057396, 16.023080185055733, 16.252796284039505, 15.825186282396317, 22.024144798517227, 22.634474870748818, 22.533624719828367, 19.330372788012028, 19.377715304493904, 19.64147161319852, 23.68741165598233, 23.80003984769185, 24.353293177982167, 22.40719984471798, 22.4387449324131, 22.569890461862087, 14.0183325111866, 13.85246068239212, 13.858352079987526, 15.818130640933902, 15.382155279318482, 15.18761860827604, 21.034048462907464, 21.86334369952479, 22.00786318878332, 20.187451668083668, 19.926909185945988, 20.21651972644031, 29.24393007159233, 29.9158713882789, 29.748727675527334, 22.982348968585327, 23.60125351006475, 23.202433196206883, 27.316699534654617, 28.435087729245424, 28.33725666999817, 22.525506901244313, 22.530610511700303, 22.628204884628445, 19.726974713305623, 19.782458926240594, 19.877530458072812, 12.463736653327942, 11.970527663826942, 12.57285727467388, 22.273834853122622, 21.997816304365784, 21.77716803054014, 19.892839640378952, 20.374510986730456, 20.1807245798409, 20.5678383099536, 20.314118939141423, 19.53942623237768, 26.22658911099036, 26.247700270575777, 26.08463342239459, 19.098617743700743, 18.81054139882326, 18.46958029270172, 20.39732753733793, 20.277962083617837, 21.094263170069695, 24.079005687187106, 24.35050344017023, 24.363095040413697, 27.385729675491646, 27.459218086053923, 27.270689470072583, 26.293620973825455, 26.4671910405159, 26.573278293013573, 12.488860368728638, 12.531233385205269, 12.373766034841537, -1.3088830585281102, -1.4060169855753628, -1.480026433865234, 35.04390628884235, 34.526161084572465, 35.36386260172972, 21.918818990389497, 22.43893493215242, 22.35377427438894, 25.91683695216973, 26.050698302065328, 25.815525000294045, 18.481497760862112, 17.74329075217247, 18.341492913663387, 16.273351788520813, 15.691449448466301, 16.483765181154013, 24.89235023160775, 24.916306940217808, 24.710152504344777, 16.76680791874726, 17.1994462305059, 17.066144605477646, 4.859305912007883, 4.956247912098959, 4.983424873401717, 21.819055813054234, 21.71195278565088, 21.68518966684738, 27.663453567152217, 27.345120181639984, 27.231854406495884, 25.45517300193508, 25.021915984650448, 24.621180733044937, 24.140880165000752, 24.386700746913746, 24.364753012855843, 24.34025142590204, 25.515534693996102, 25.55414949792126, 28.02634296255806, 27.994589249293, 27.511972005168587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15496816190439242, "mean_inference_ms": 0.7080287725610249, "mean_action_processing_ms": 0.10013470261886517, "mean_env_wait_ms": 0.8136064669072528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1055340, "timesteps_this_iter": 0, "agent_timesteps_total": 3166020, "timers": {"sample_time_ms": 19479.373, "sample_throughput": 492.521, "load_time_ms": 0.1, "load_throughput": 96107362.255, "learn_time_ms": 3006.865, "learn_throughput": 3190.698, "update_time_ms": 8.627}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1188490134372843e-10, "cur_lr": 0.0005, "total_loss": 6.166899621486664, "policy_loss": 0.0002974507741577703, "vf_loss": 6.307058751583099, "vf_explained_var": 0.1610211506485939, "kl": 0.004909631534390084, "entropy": 14.04567301273346, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1055340, "num_agent_steps_sampled": 3166020, "num_steps_trained": 1055340, "num_agent_steps_trained": 3166020, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4307, "training_iteration": 110, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-20-29", "timestamp": 1706192429, "time_this_iter_s": 18.661213874816895, "time_total_s": 2229.3931090831757, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2229.3931090831757, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 6.300000000000001, "ram_util_percent": 48.3076923076923}}
{"episode_reward_max": 111.95931003987786, "episode_reward_min": -4.194926477968707, "episode_reward_mean": 63.68565480656398, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -1.480026433865234}, "policy_reward_max": {"shared_policy": 37.42197660605112}, "policy_reward_mean": {"shared_policy": 21.228551602187988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.0997572094202, 64.86445865035057, 77.67539498209952, 60.79327495023607, 50.10597895272076, 75.63467181846497, 63.953653789591016, 60.35367524123285, 61.04977082833648, 59.04482711665332, 48.189936985261724, 51.64529718086122, 53.80306565947829, 83.4644876644015, 67.25827743858098, 47.24348342791198, 77.80938680656253, 64.76513342850376, 50.709462795406566, 48.66018676012753, 58.921700824052095, 43.56049218890254, 79.02562499139455, 60.92649046541189, 83.43416570127009, 89.56654988974333, 48.101062751491554, 67.19224438909441, 58.34955970570445, 71.84074468165635, 67.41583523899317, 41.729145273566246, 46.38790452852842, 64.90525535121557, 60.330880580469966, 88.90852913539857, 69.78603567485696, 84.08904393389821, 67.68432229757306, 59.38696409761903, 37.00712159182876, 66.04881918802855, 60.44807520695031, 60.4213834814727, 78.55892280396073, 56.378739435225725, 61.76955279102546, 72.79260416777103, 82.11563723161815, 79.33409030735493, 37.393859788775444, -4.194926477968707, 104.93392997514454, 66.71152819693086, 77.7830602545291, 54.56628142669797, 48.44856641814113, 74.51880967617033, 51.032398754730806, 14.79897869750856, 65.21619826555249, 82.24042815528809, 75.09826971963047, 72.89233392477034, 75.4099356178194, 83.53290421701965, 81.04980834200978, 62.82958110980687, 60.00496139470485, 55.19649761822073, 95.32637539319693, 91.59268294647333, 111.95931003987786, 73.71774749085307, 49.55362631916067, 79.43785477429628, 65.07160108350215, 53.1514231399633, 37.70411786995825, 83.7312982068397, 79.36982647702098, 18.181084774434552, 54.61484103649852, 71.09187005460262, 43.558169499039636, 63.27262589521706, 86.82469480484721, 51.38445751741526, 42.08972738683224, 38.29642566293478, 77.54736903519367, 76.96295412816104, 70.88296529650687, 67.25191404577343, 55.998092185705886, 68.42772820591925, 83.14693988300859, 38.09056952595711, 58.052161842584596, 20.269941466860473], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [29.900651656091213, 29.62710228562355, 29.57200326770544, 21.529503658413887, 21.825630858540535, 21.50932413339615, 25.667798360188797, 26.207011704643563, 25.80058491726716, 20.185388827075556, 20.29164870952566, 20.316237413634852, 16.49117798358202, 16.69316378235817, 16.921637186780572, 25.073372217516095, 25.31271584207812, 25.24858375887075, 21.336020237921417, 21.305197914751858, 21.31243563691774, 20.099923402071, 20.32531137263868, 19.92844046652317, 20.543991204351187, 20.271877355873585, 20.233902268111706, 19.434197463095188, 19.805095886811614, 19.80553376674652, 15.70723708470662, 16.330636089978114, 16.15206381057699, 17.239996963491038, 17.295320858558014, 17.10997935881217, 17.92815987889965, 17.74455442031224, 18.130351360266403, 27.81440898279348, 27.76207215587297, 27.88800652573505, 22.58397616942723, 22.221788321932152, 22.452512947221592, 15.687670753647879, 15.705405948062733, 15.85040672620137, 25.935637300213173, 25.95510074992974, 25.918648756419614, 21.32510557025671, 21.828629667987116, 21.611398190259933, 16.882803556819752, 16.792726447184876, 17.033932791401938, 16.34711655726035, 16.296001960833863, 16.017068242033318, 19.94279609248042, 19.832273192703724, 19.14663153886795, 15.047699995261297, 13.613671789566666, 14.89912040407458, 26.5937060896928, 26.10575461635986, 26.32616428534189, 20.584707991142437, 20.03547904888788, 20.30630342538157, 27.537428384025887, 27.96049617355068, 27.936241143693522, 29.74376303702593, 29.780950486660004, 30.041836366057396, 16.023080185055733, 16.252796284039505, 15.825186282396317, 22.024144798517227, 22.634474870748818, 22.533624719828367, 19.330372788012028, 19.377715304493904, 19.64147161319852, 23.68741165598233, 23.80003984769185, 24.353293177982167, 22.40719984471798, 22.4387449324131, 22.569890461862087, 14.0183325111866, 13.85246068239212, 13.858352079987526, 15.818130640933902, 15.382155279318482, 15.18761860827604, 21.034048462907464, 21.86334369952479, 22.00786318878332, 20.187451668083668, 19.926909185945988, 20.21651972644031, 29.24393007159233, 29.9158713882789, 29.748727675527334, 22.982348968585327, 23.60125351006475, 23.202433196206883, 27.316699534654617, 28.435087729245424, 28.33725666999817, 22.525506901244313, 22.530610511700303, 22.628204884628445, 19.726974713305623, 19.782458926240594, 19.877530458072812, 12.463736653327942, 11.970527663826942, 12.57285727467388, 22.273834853122622, 21.997816304365784, 21.77716803054014, 19.892839640378952, 20.374510986730456, 20.1807245798409, 20.5678383099536, 20.314118939141423, 19.53942623237768, 26.22658911099036, 26.247700270575777, 26.08463342239459, 19.098617743700743, 18.81054139882326, 18.46958029270172, 20.39732753733793, 20.277962083617837, 21.094263170069695, 24.079005687187106, 24.35050344017023, 24.363095040413697, 27.385729675491646, 27.459218086053923, 27.270689470072583, 26.293620973825455, 26.4671910405159, 26.573278293013573, 12.488860368728638, 12.531233385205269, 12.373766034841537, -1.3088830585281102, -1.4060169855753628, -1.480026433865234, 35.04390628884235, 34.526161084572465, 35.36386260172972, 21.918818990389497, 22.43893493215242, 22.35377427438894, 25.91683695216973, 26.050698302065328, 25.815525000294045, 18.481497760862112, 17.74329075217247, 18.341492913663387, 16.273351788520813, 15.691449448466301, 16.483765181154013, 24.89235023160775, 24.916306940217808, 24.710152504344777, 16.76680791874726, 17.1994462305059, 17.066144605477646, 4.859305912007883, 4.956247912098959, 4.983424873401717, 21.819055813054234, 21.71195278565088, 21.68518966684738, 27.663453567152217, 27.345120181639984, 27.231854406495884, 25.45517300193508, 25.021915984650448, 24.621180733044937, 24.140880165000752, 24.386700746913746, 24.364753012855843, 24.34025142590204, 25.515534693996102, 25.55414949792126, 28.02634296255806, 27.994589249293, 27.511972005168587, 26.90067668259144, 27.050001591444016, 27.09913006797433, 20.69834993282953, 21.28219496520856, 20.849036211768777, 20.106687923582882, 19.847707292685897, 20.05056617843607, 18.59735997424771, 18.327497844894722, 18.2716397990783, 32.19516281348963, 31.94100723912318, 31.190205340584114, 30.296600396434457, 30.46395895133415, 30.832123598704726, 37.42197660605112, 37.14399648706117, 37.39333694676557, 24.394305035471916, 24.66250390186906, 24.660938553512096, 16.436513946702078, 16.499175890659288, 16.617936481799305, 26.328009478747845, 26.48801412433386, 26.62183117121458, 21.507508906225354, 21.91156051370004, 21.652531663576752, 17.950295152608305, 17.533117026090622, 17.668010961264372, 12.442312608162553, 12.703129429991037, 12.558675831804663, 27.99236917480205, 27.881943111618355, 27.85698592041929, 26.284915193915367, 26.60969987884164, 26.475211404263973, 5.997480255862072, 6.222995323439434, 5.9606091951330455, 18.40757959584394, 18.02843556801477, 18.178825872639806, 23.627099439501762, 23.66233140975237, 23.80243920534849, 14.557031010588005, 14.497022544344262, 14.504115944107369, 20.729129627346992, 21.097247391939163, 21.446248875930905, 28.796453813711793, 28.739822472135216, 29.288418519000203, 17.05303321282068, 17.149270890901477, 17.1821534136931, 13.538611859083176, 14.10560480505228, 14.445510722696781, 13.02630864828825, 12.739135667681694, 12.530981346964836, 25.85553532714644, 25.575998688737542, 26.115835019309685, 25.360694656769425, 25.738777330766112, 25.863482140625507, 23.46225394805272, 23.67528487866123, 23.745426469792918, 22.272726347049073, 22.92917656557013, 22.05001113315423, 18.48223103334506, 18.66969449569781, 18.846166656663016, 22.748544854422406, 22.635442246993378, 23.043741104503468, 27.667454065134123, 27.657981303830937, 27.821504514043525, 12.809940166771412, 12.850740812718868, 12.429888546466827, 19.3456430931886, 19.346484785278633, 19.360033964117363, 7.221784713678062, 6.843472138047218, 6.204684615135193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15483564685062906, "mean_inference_ms": 0.7074784424792466, "mean_action_processing_ms": 0.10013817932642198, "mean_env_wait_ms": 0.812980448631053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1064934, "timesteps_this_iter": 0, "agent_timesteps_total": 3194802, "timers": {"sample_time_ms": 18936.732, "sample_throughput": 506.634, "load_time_ms": 0.1, "load_throughput": 96107362.255, "learn_time_ms": 3000.702, "learn_throughput": 3197.252, "update_time_ms": 8.479}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.594245067186421e-11, "cur_lr": 0.0005, "total_loss": 6.250695466995239, "policy_loss": 0.00044118529185091515, "vf_loss": 6.392321884632111, "vf_explained_var": 0.08968055248260498, "kl": 0.006132326496449854, "entropy": 14.206781268119812, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1064934, "num_agent_steps_sampled": 3194802, "num_steps_trained": 1064934, "num_agent_steps_trained": 3194802, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4341, "training_iteration": 111, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-20-48", "timestamp": 1706192448, "time_this_iter_s": 18.736984729766846, "time_total_s": 2248.1300938129425, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2248.1300938129425, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 7.496153846153845, "ram_util_percent": 48.29615384615385}}
{"episode_reward_max": 111.95931003987786, "episode_reward_min": -4.194926477968707, "episode_reward_mean": 64.0629344394122, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -1.480026433865234}, "policy_reward_max": {"shared_policy": 37.42197660605112}, "policy_reward_mean": {"shared_policy": 21.35431147980406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.41583523899317, 41.729145273566246, 46.38790452852842, 64.90525535121557, 60.330880580469966, 88.90852913539857, 69.78603567485696, 84.08904393389821, 67.68432229757306, 59.38696409761903, 37.00712159182876, 66.04881918802855, 60.44807520695031, 60.4213834814727, 78.55892280396073, 56.378739435225725, 61.76955279102546, 72.79260416777103, 82.11563723161815, 79.33409030735493, 37.393859788775444, -4.194926477968707, 104.93392997514454, 66.71152819693086, 77.7830602545291, 54.56628142669797, 48.44856641814113, 74.51880967617033, 51.032398754730806, 14.79897869750856, 65.21619826555249, 82.24042815528809, 75.09826971963047, 72.89233392477034, 75.4099356178194, 83.53290421701965, 81.04980834200978, 62.82958110980687, 60.00496139470485, 55.19649761822073, 95.32637539319693, 91.59268294647333, 111.95931003987786, 73.71774749085307, 49.55362631916067, 79.43785477429628, 65.07160108350215, 53.1514231399633, 37.70411786995825, 83.7312982068397, 79.36982647702098, 18.181084774434552, 54.61484103649852, 71.09187005460262, 43.558169499039636, 63.27262589521706, 86.82469480484721, 51.38445751741526, 42.08972738683224, 38.29642566293478, 77.54736903519367, 76.96295412816104, 70.88296529650687, 67.25191404577343, 55.998092185705886, 68.42772820591925, 83.14693988300859, 38.09056952595711, 58.052161842584596, 20.269941466860473, 57.9745756165357, 54.17356253042817, 56.645346961915465, 49.63323040679097, 62.92679896368642, 31.671542875468703, 89.51720206765457, 52.27158344676715, 65.54031572025269, 45.55411419272423, 78.03163060918448, 64.01491281762718, 82.87233966472559, 56.23878489062187, 73.285193990916, 74.1482915468514, 84.69810277968644, 61.389187934808405, 60.678453540895106, 55.75145979598162, 81.63240559771657, 94.51368518173695, 60.80971888918427, 83.44234304875135, 62.9181957580149, 61.723472042009206, 65.90421467274425, 62.73867879807946, 69.19699902366844, 54.874437194317565], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.40719984471798, 22.4387449324131, 22.569890461862087, 14.0183325111866, 13.85246068239212, 13.858352079987526, 15.818130640933902, 15.382155279318482, 15.18761860827604, 21.034048462907464, 21.86334369952479, 22.00786318878332, 20.187451668083668, 19.926909185945988, 20.21651972644031, 29.24393007159233, 29.9158713882789, 29.748727675527334, 22.982348968585327, 23.60125351006475, 23.202433196206883, 27.316699534654617, 28.435087729245424, 28.33725666999817, 22.525506901244313, 22.530610511700303, 22.628204884628445, 19.726974713305623, 19.782458926240594, 19.877530458072812, 12.463736653327942, 11.970527663826942, 12.57285727467388, 22.273834853122622, 21.997816304365784, 21.77716803054014, 19.892839640378952, 20.374510986730456, 20.1807245798409, 20.5678383099536, 20.314118939141423, 19.53942623237768, 26.22658911099036, 26.247700270575777, 26.08463342239459, 19.098617743700743, 18.81054139882326, 18.46958029270172, 20.39732753733793, 20.277962083617837, 21.094263170069695, 24.079005687187106, 24.35050344017023, 24.363095040413697, 27.385729675491646, 27.459218086053923, 27.270689470072583, 26.293620973825455, 26.4671910405159, 26.573278293013573, 12.488860368728638, 12.531233385205269, 12.373766034841537, -1.3088830585281102, -1.4060169855753628, -1.480026433865234, 35.04390628884235, 34.526161084572465, 35.36386260172972, 21.918818990389497, 22.43893493215242, 22.35377427438894, 25.91683695216973, 26.050698302065328, 25.815525000294045, 18.481497760862112, 17.74329075217247, 18.341492913663387, 16.273351788520813, 15.691449448466301, 16.483765181154013, 24.89235023160775, 24.916306940217808, 24.710152504344777, 16.76680791874726, 17.1994462305059, 17.066144605477646, 4.859305912007883, 4.956247912098959, 4.983424873401717, 21.819055813054234, 21.71195278565088, 21.68518966684738, 27.663453567152217, 27.345120181639984, 27.231854406495884, 25.45517300193508, 25.021915984650448, 24.621180733044937, 24.140880165000752, 24.386700746913746, 24.364753012855843, 24.34025142590204, 25.515534693996102, 25.55414949792126, 28.02634296255806, 27.994589249293, 27.511972005168587, 26.90067668259144, 27.050001591444016, 27.09913006797433, 20.69834993282953, 21.28219496520856, 20.849036211768777, 20.106687923582882, 19.847707292685897, 20.05056617843607, 18.59735997424771, 18.327497844894722, 18.2716397990783, 32.19516281348963, 31.94100723912318, 31.190205340584114, 30.296600396434457, 30.46395895133415, 30.832123598704726, 37.42197660605112, 37.14399648706117, 37.39333694676557, 24.394305035471916, 24.66250390186906, 24.660938553512096, 16.436513946702078, 16.499175890659288, 16.617936481799305, 26.328009478747845, 26.48801412433386, 26.62183117121458, 21.507508906225354, 21.91156051370004, 21.652531663576752, 17.950295152608305, 17.533117026090622, 17.668010961264372, 12.442312608162553, 12.703129429991037, 12.558675831804663, 27.99236917480205, 27.881943111618355, 27.85698592041929, 26.284915193915367, 26.60969987884164, 26.475211404263973, 5.997480255862072, 6.222995323439434, 5.9606091951330455, 18.40757959584394, 18.02843556801477, 18.178825872639806, 23.627099439501762, 23.66233140975237, 23.80243920534849, 14.557031010588005, 14.497022544344262, 14.504115944107369, 20.729129627346992, 21.097247391939163, 21.446248875930905, 28.796453813711793, 28.739822472135216, 29.288418519000203, 17.05303321282068, 17.149270890901477, 17.1821534136931, 13.538611859083176, 14.10560480505228, 14.445510722696781, 13.02630864828825, 12.739135667681694, 12.530981346964836, 25.85553532714644, 25.575998688737542, 26.115835019309685, 25.360694656769425, 25.738777330766112, 25.863482140625507, 23.46225394805272, 23.67528487866123, 23.745426469792918, 22.272726347049073, 22.92917656557013, 22.05001113315423, 18.48223103334506, 18.66969449569781, 18.846166656663016, 22.748544854422406, 22.635442246993378, 23.043741104503468, 27.667454065134123, 27.657981303830937, 27.821504514043525, 12.809940166771412, 12.850740812718868, 12.429888546466827, 19.3456430931886, 19.346484785278633, 19.360033964117363, 7.221784713678062, 6.843472138047218, 6.204684615135193, 19.380129395673663, 19.05400792757669, 19.540438293285348, 17.895427502691746, 18.003991328179836, 18.27414369955659, 18.811488303045422, 19.053910079101712, 18.77994857976833, 16.491213530302048, 16.855977658182383, 16.28603921830654, 21.081379701771453, 21.02734719372043, 20.81807206819454, 10.583556721607835, 10.456118712822587, 10.631867441038281, 29.948822717027113, 29.834402039026216, 29.733977311601237, 17.52667741958672, 17.527315051915735, 17.2175909752647, 21.631701163947582, 22.157352360896766, 21.751262195408344, 15.288239166140556, 15.437691330909729, 14.828183695673943, 25.987241740028054, 25.853763471047074, 26.190625398109347, 20.956608985861138, 21.568128426869706, 21.490175404896334, 27.225395128130913, 27.82972491835244, 27.817219618242234, 18.844092826048524, 18.866501993189246, 18.528190071384103, 24.650365383674696, 24.421559934814766, 24.213268672426537, 24.687332458794117, 24.70211958885193, 24.75883949920535, 28.38215284918745, 28.338000187029436, 27.97794974346955, 20.78732476166138, 20.524088415006787, 20.077774758140237, 20.27738578307131, 19.996620925764233, 20.404446832059563, 18.512149425844342, 18.714061407993228, 18.525248962144047, 26.791596606373787, 27.399159863591194, 27.44164912775159, 31.517797335982323, 31.49595484137535, 31.499933004379272, 20.205133921156317, 20.432064678209514, 20.172520289818436, 27.728498846292496, 27.74673008173704, 27.967114120721817, 20.529098590215042, 20.794663955767945, 21.594433212031916, 20.772166312361747, 20.54508793602386, 20.406217793623597, 21.864602240423352, 22.000598991910607, 22.039013440410287, 20.92444362367192, 20.892660974214465, 20.921574200193078, 22.751670638720185, 23.185335826749593, 23.25999255819866, 18.153709565599755, 18.30416092773278, 18.41656670098503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15466427192344231, "mean_inference_ms": 0.7070311099400415, "mean_action_processing_ms": 0.10007516938151044, "mean_env_wait_ms": 0.8125921118623869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1074528, "timesteps_this_iter": 0, "agent_timesteps_total": 3223584, "timers": {"sample_time_ms": 18880.981, "sample_throughput": 508.13, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2997.327, "learn_throughput": 3200.852, "update_time_ms": 8.467}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.594245067186421e-11, "cur_lr": 0.0005, "total_loss": 6.051412999629974, "policy_loss": 0.002571414074488576, "vf_loss": 6.194920480251312, "vf_explained_var": 0.06487464904785156, "kl": 0.011978154594704908, "entropy": 14.607878804206848, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1074528, "num_agent_steps_sampled": 3223584, "num_steps_trained": 1074528, "num_agent_steps_trained": 3223584, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4371, "training_iteration": 112, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-21-07", "timestamp": 1706192467, "time_this_iter_s": 19.043932914733887, "time_total_s": 2267.1740267276764, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2267.1740267276764, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 8.755555555555555, "ram_util_percent": 48.31481481481481}}
{"episode_reward_max": 111.95931003987786, "episode_reward_min": 18.181084774434552, "episode_reward_mean": 67.05227770783821, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": 5.9606091951330455}, "policy_reward_max": {"shared_policy": 37.42197660605112}, "policy_reward_mean": {"shared_policy": 22.350759235946068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.4099356178194, 83.53290421701965, 81.04980834200978, 62.82958110980687, 60.00496139470485, 55.19649761822073, 95.32637539319693, 91.59268294647333, 111.95931003987786, 73.71774749085307, 49.55362631916067, 79.43785477429628, 65.07160108350215, 53.1514231399633, 37.70411786995825, 83.7312982068397, 79.36982647702098, 18.181084774434552, 54.61484103649852, 71.09187005460262, 43.558169499039636, 63.27262589521706, 86.82469480484721, 51.38445751741526, 42.08972738683224, 38.29642566293478, 77.54736903519367, 76.96295412816104, 70.88296529650687, 67.25191404577343, 55.998092185705886, 68.42772820591925, 83.14693988300859, 38.09056952595711, 58.052161842584596, 20.269941466860473, 57.9745756165357, 54.17356253042817, 56.645346961915465, 49.63323040679097, 62.92679896368642, 31.671542875468703, 89.51720206765457, 52.27158344676715, 65.54031572025269, 45.55411419272423, 78.03163060918448, 64.01491281762718, 82.87233966472559, 56.23878489062187, 73.285193990916, 74.1482915468514, 84.69810277968644, 61.389187934808405, 60.678453540895106, 55.75145979598162, 81.63240559771657, 94.51368518173695, 60.80971888918427, 83.44234304875135, 62.9181957580149, 61.723472042009206, 65.90421467274425, 62.73867879807946, 69.19699902366844, 54.874437194317565, 84.86540927737951, 96.01630213321187, 63.9418685361743, 91.86799804493783, 68.24145829584448, 52.57028714939952, 66.61828471068293, 82.18156892061234, 70.04931067768482, 49.07046857848762, 69.08350575529036, 86.66072864830494, 60.646102366968975, 63.11144215939564, 107.83030548319219, 75.67386061325666, 53.55436810618265, 52.82072767056525, 76.29170901700851, 82.69401691108942, 72.79495701193808, 91.64658160321414, 78.82019364647566, 93.99936358258128, 61.157137773931, 54.73351253569125, 86.17618075758217, 49.28262265026568, 63.13407984049989, 71.61912484001365, 80.22970537841317, 58.886721353977904, 79.34725577197969, 30.25574613362548], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.34025142590204, 25.515534693996102, 25.55414949792126, 28.02634296255806, 27.994589249293, 27.511972005168587, 26.90067668259144, 27.050001591444016, 27.09913006797433, 20.69834993282953, 21.28219496520856, 20.849036211768777, 20.106687923582882, 19.847707292685897, 20.05056617843607, 18.59735997424771, 18.327497844894722, 18.2716397990783, 32.19516281348963, 31.94100723912318, 31.190205340584114, 30.296600396434457, 30.46395895133415, 30.832123598704726, 37.42197660605112, 37.14399648706117, 37.39333694676557, 24.394305035471916, 24.66250390186906, 24.660938553512096, 16.436513946702078, 16.499175890659288, 16.617936481799305, 26.328009478747845, 26.48801412433386, 26.62183117121458, 21.507508906225354, 21.91156051370004, 21.652531663576752, 17.950295152608305, 17.533117026090622, 17.668010961264372, 12.442312608162553, 12.703129429991037, 12.558675831804663, 27.99236917480205, 27.881943111618355, 27.85698592041929, 26.284915193915367, 26.60969987884164, 26.475211404263973, 5.997480255862072, 6.222995323439434, 5.9606091951330455, 18.40757959584394, 18.02843556801477, 18.178825872639806, 23.627099439501762, 23.66233140975237, 23.80243920534849, 14.557031010588005, 14.497022544344262, 14.504115944107369, 20.729129627346992, 21.097247391939163, 21.446248875930905, 28.796453813711793, 28.739822472135216, 29.288418519000203, 17.05303321282068, 17.149270890901477, 17.1821534136931, 13.538611859083176, 14.10560480505228, 14.445510722696781, 13.02630864828825, 12.739135667681694, 12.530981346964836, 25.85553532714644, 25.575998688737542, 26.115835019309685, 25.360694656769425, 25.738777330766112, 25.863482140625507, 23.46225394805272, 23.67528487866123, 23.745426469792918, 22.272726347049073, 22.92917656557013, 22.05001113315423, 18.48223103334506, 18.66969449569781, 18.846166656663016, 22.748544854422406, 22.635442246993378, 23.043741104503468, 27.667454065134123, 27.657981303830937, 27.821504514043525, 12.809940166771412, 12.850740812718868, 12.429888546466827, 19.3456430931886, 19.346484785278633, 19.360033964117363, 7.221784713678062, 6.843472138047218, 6.204684615135193, 19.380129395673663, 19.05400792757669, 19.540438293285348, 17.895427502691746, 18.003991328179836, 18.27414369955659, 18.811488303045422, 19.053910079101712, 18.77994857976833, 16.491213530302048, 16.855977658182383, 16.28603921830654, 21.081379701771453, 21.02734719372043, 20.81807206819454, 10.583556721607835, 10.456118712822587, 10.631867441038281, 29.948822717027113, 29.834402039026216, 29.733977311601237, 17.52667741958672, 17.527315051915735, 17.2175909752647, 21.631701163947582, 22.157352360896766, 21.751262195408344, 15.288239166140556, 15.437691330909729, 14.828183695673943, 25.987241740028054, 25.853763471047074, 26.190625398109347, 20.956608985861138, 21.568128426869706, 21.490175404896334, 27.225395128130913, 27.82972491835244, 27.817219618242234, 18.844092826048524, 18.866501993189246, 18.528190071384103, 24.650365383674696, 24.421559934814766, 24.213268672426537, 24.687332458794117, 24.70211958885193, 24.75883949920535, 28.38215284918745, 28.338000187029436, 27.97794974346955, 20.78732476166138, 20.524088415006787, 20.077774758140237, 20.27738578307131, 19.996620925764233, 20.404446832059563, 18.512149425844342, 18.714061407993228, 18.525248962144047, 26.791596606373787, 27.399159863591194, 27.44164912775159, 31.517797335982323, 31.49595484137535, 31.499933004379272, 20.205133921156317, 20.432064678209514, 20.172520289818436, 27.728498846292496, 27.74673008173704, 27.967114120721817, 20.529098590215042, 20.794663955767945, 21.594433212031916, 20.772166312361747, 20.54508793602386, 20.406217793623597, 21.864602240423352, 22.000598991910607, 22.039013440410287, 20.92444362367192, 20.892660974214465, 20.921574200193078, 22.751670638720185, 23.185335826749593, 23.25999255819866, 18.153709565599755, 18.30416092773278, 18.41656670098503, 28.305215410888195, 28.36049711704254, 28.199696749448776, 32.306459868559614, 32.070233300328255, 31.639608964323997, 21.318842977285385, 21.297600775957108, 21.325424782931805, 30.779111580302313, 30.447008935113743, 30.64187752952178, 22.73638208334644, 22.888398006868854, 22.616678205629185, 17.334252431988716, 17.374624222517014, 17.86141049489379, 22.389001295901835, 22.035932302474976, 22.193351112306118, 27.098343804478645, 27.442403979599476, 27.640821136534214, 23.114456358055264, 23.48565891912827, 23.44919540050128, 16.478271098186568, 16.270135944088295, 16.322061536212757, 22.77496602634588, 23.044680433968693, 23.263859294975788, 28.97502852231264, 28.907880648970604, 28.777819477021694, 20.13215249528487, 20.300843074296907, 20.213106797387198, 21.214544082215667, 20.802569920818, 21.094328156361968, 35.73370001961787, 36.07178544377287, 36.02482001980145, 25.164710054794938, 25.069409454862267, 25.43974110359946, 17.858380950366453, 17.74605755259593, 17.94992960322027, 17.78241684474051, 17.525186210870743, 17.513124614953995, 25.1499146024386, 25.702370478461177, 25.43942393610874, 27.623113863170147, 27.534374430775642, 27.53652861714363, 24.178586428364113, 24.237288323541478, 24.37908226003249, 30.682711040601134, 30.625862039625645, 30.338008522987366, 26.28244562198718, 26.52709969443579, 26.01064833005269, 31.135987877845764, 31.574324142187834, 31.289051562547684, 20.131541932622582, 20.56536569694677, 20.460230144361645, 17.97502966721852, 18.451444787283734, 18.307038081188992, 28.539136980970696, 28.74109897514184, 28.89594480146964, 16.661808756490544, 16.182853137453392, 16.437960756321743, 21.1455211554033, 20.88944351052244, 21.099115174574152, 24.195788707273692, 23.249408225218446, 24.173927907521517, 26.916425871352345, 26.561291264990956, 26.75198824206987, 19.415166941781834, 19.7986077380677, 19.67294667412837, 26.369194336235523, 26.361600928008556, 26.61646050773561, 9.572925368944794, 10.471115248898656, 10.211705515782029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450628732561364, "mean_inference_ms": 0.7063586538526802, "mean_action_processing_ms": 0.10003901043277313, "mean_env_wait_ms": 0.8120011380161205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1084122, "timesteps_this_iter": 0, "agent_timesteps_total": 3252366, "timers": {"sample_time_ms": 18815.331, "sample_throughput": 509.903, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2979.256, "learn_throughput": 3220.267, "update_time_ms": 8.16}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.594245067186421e-11, "cur_lr": 0.0005, "total_loss": 6.776295363903046, "policy_loss": 0.005241360804529749, "vf_loss": 6.915112376213074, "vf_explained_var": 0.07907245308160782, "kl": 0.035044365213409596, "entropy": 14.405842900276184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1084122, "num_agent_steps_sampled": 3252366, "num_steps_trained": 1084122, "num_agent_steps_trained": 3252366, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4405, "training_iteration": 113, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-21-26", "timestamp": 1706192486, "time_this_iter_s": 18.366084098815918, "time_total_s": 2285.5401108264923, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B844C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2285.5401108264923, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 6.7423076923076914, "ram_util_percent": 48.43076923076923}}
{"episode_reward_max": 107.83030548319219, "episode_reward_min": 20.269941466860473, "episode_reward_mean": 67.15801080352044, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 6.204684615135193}, "policy_reward_max": {"shared_policy": 36.07178544377287}, "policy_reward_mean": {"shared_policy": 22.386003601173478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.998092185705886, 68.42772820591925, 83.14693988300859, 38.09056952595711, 58.052161842584596, 20.269941466860473, 57.9745756165357, 54.17356253042817, 56.645346961915465, 49.63323040679097, 62.92679896368642, 31.671542875468703, 89.51720206765457, 52.27158344676715, 65.54031572025269, 45.55411419272423, 78.03163060918448, 64.01491281762718, 82.87233966472559, 56.23878489062187, 73.285193990916, 74.1482915468514, 84.69810277968644, 61.389187934808405, 60.678453540895106, 55.75145979598162, 81.63240559771657, 94.51368518173695, 60.80971888918427, 83.44234304875135, 62.9181957580149, 61.723472042009206, 65.90421467274425, 62.73867879807946, 69.19699902366844, 54.874437194317565, 84.86540927737951, 96.01630213321187, 63.9418685361743, 91.86799804493783, 68.24145829584448, 52.57028714939952, 66.61828471068293, 82.18156892061234, 70.04931067768482, 49.07046857848762, 69.08350575529036, 86.66072864830494, 60.646102366968975, 63.11144215939564, 107.83030548319219, 75.67386061325666, 53.55436810618265, 52.82072767056525, 76.29170901700851, 82.69401691108942, 72.79495701193808, 91.64658160321414, 78.82019364647566, 93.99936358258128, 61.157137773931, 54.73351253569125, 86.17618075758217, 49.28262265026568, 63.13407984049989, 71.61912484001365, 80.22970537841317, 58.886721353977904, 79.34725577197969, 30.25574613362548, 44.51981811970471, 64.91428614826873, 42.34429746679962, 37.248040914535494, 86.14743107929824, 79.27560843527316, 61.25612712930885, 74.63415125757456, 74.35722484253344, 43.580937261460335, 78.22119117015971, 59.79891559481621, 90.46380346897057, 37.88472263887523, 90.79026429355145, 66.17029188200829, 64.24737874418497, 84.41979334782808, 83.27813016623259, 77.70803738059476, 67.89093812182544, 82.21367452759294, 47.99779779464005, 71.99786343052982, 71.21630400232968, 58.011521124746636, 58.28194375336167, 77.32936344388871, 45.016363963484736, 89.9557392420247], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.48223103334506, 18.66969449569781, 18.846166656663016, 22.748544854422406, 22.635442246993378, 23.043741104503468, 27.667454065134123, 27.657981303830937, 27.821504514043525, 12.809940166771412, 12.850740812718868, 12.429888546466827, 19.3456430931886, 19.346484785278633, 19.360033964117363, 7.221784713678062, 6.843472138047218, 6.204684615135193, 19.380129395673663, 19.05400792757669, 19.540438293285348, 17.895427502691746, 18.003991328179836, 18.27414369955659, 18.811488303045422, 19.053910079101712, 18.77994857976833, 16.491213530302048, 16.855977658182383, 16.28603921830654, 21.081379701771453, 21.02734719372043, 20.81807206819454, 10.583556721607835, 10.456118712822587, 10.631867441038281, 29.948822717027113, 29.834402039026216, 29.733977311601237, 17.52667741958672, 17.527315051915735, 17.2175909752647, 21.631701163947582, 22.157352360896766, 21.751262195408344, 15.288239166140556, 15.437691330909729, 14.828183695673943, 25.987241740028054, 25.853763471047074, 26.190625398109347, 20.956608985861138, 21.568128426869706, 21.490175404896334, 27.225395128130913, 27.82972491835244, 27.817219618242234, 18.844092826048524, 18.866501993189246, 18.528190071384103, 24.650365383674696, 24.421559934814766, 24.213268672426537, 24.687332458794117, 24.70211958885193, 24.75883949920535, 28.38215284918745, 28.338000187029436, 27.97794974346955, 20.78732476166138, 20.524088415006787, 20.077774758140237, 20.27738578307131, 19.996620925764233, 20.404446832059563, 18.512149425844342, 18.714061407993228, 18.525248962144047, 26.791596606373787, 27.399159863591194, 27.44164912775159, 31.517797335982323, 31.49595484137535, 31.499933004379272, 20.205133921156317, 20.432064678209514, 20.172520289818436, 27.728498846292496, 27.74673008173704, 27.967114120721817, 20.529098590215042, 20.794663955767945, 21.594433212031916, 20.772166312361747, 20.54508793602386, 20.406217793623597, 21.864602240423352, 22.000598991910607, 22.039013440410287, 20.92444362367192, 20.892660974214465, 20.921574200193078, 22.751670638720185, 23.185335826749593, 23.25999255819866, 18.153709565599755, 18.30416092773278, 18.41656670098503, 28.305215410888195, 28.36049711704254, 28.199696749448776, 32.306459868559614, 32.070233300328255, 31.639608964323997, 21.318842977285385, 21.297600775957108, 21.325424782931805, 30.779111580302313, 30.447008935113743, 30.64187752952178, 22.73638208334644, 22.888398006868854, 22.616678205629185, 17.334252431988716, 17.374624222517014, 17.86141049489379, 22.389001295901835, 22.035932302474976, 22.193351112306118, 27.098343804478645, 27.442403979599476, 27.640821136534214, 23.114456358055264, 23.48565891912827, 23.44919540050128, 16.478271098186568, 16.270135944088295, 16.322061536212757, 22.77496602634588, 23.044680433968693, 23.263859294975788, 28.97502852231264, 28.907880648970604, 28.777819477021694, 20.13215249528487, 20.300843074296907, 20.213106797387198, 21.214544082215667, 20.802569920818, 21.094328156361968, 35.73370001961787, 36.07178544377287, 36.02482001980145, 25.164710054794938, 25.069409454862267, 25.43974110359946, 17.858380950366453, 17.74605755259593, 17.94992960322027, 17.78241684474051, 17.525186210870743, 17.513124614953995, 25.1499146024386, 25.702370478461177, 25.43942393610874, 27.623113863170147, 27.534374430775642, 27.53652861714363, 24.178586428364113, 24.237288323541478, 24.37908226003249, 30.682711040601134, 30.625862039625645, 30.338008522987366, 26.28244562198718, 26.52709969443579, 26.01064833005269, 31.135987877845764, 31.574324142187834, 31.289051562547684, 20.131541932622582, 20.56536569694677, 20.460230144361645, 17.97502966721852, 18.451444787283734, 18.307038081188992, 28.539136980970696, 28.74109897514184, 28.89594480146964, 16.661808756490544, 16.182853137453392, 16.437960756321743, 21.1455211554033, 20.88944351052244, 21.099115174574152, 24.195788707273692, 23.249408225218446, 24.173927907521517, 26.916425871352345, 26.561291264990956, 26.75198824206987, 19.415166941781834, 19.7986077380677, 19.67294667412837, 26.369194336235523, 26.361600928008556, 26.61646050773561, 9.572925368944794, 10.471115248898656, 10.211705515782029, 14.988092814882592, 14.597470944126442, 14.934254360695675, 21.921740595716983, 21.49389900267124, 21.498646549880505, 14.290642771869898, 13.702318981289864, 14.351335713639855, 12.396385046343, 12.436862486104161, 12.414793382088334, 28.80356929575403, 28.638871175547436, 28.704990607996777, 26.441275489826992, 26.467475717266396, 26.366857228179768, 20.765435306044907, 20.08284444610277, 20.407847377161175, 25.09672135859728, 24.52532996237278, 25.0120999366045, 24.77442781130472, 24.621783817807824, 24.961013213420898, 14.480460052688912, 14.79123198248756, 14.309245226283863, 26.224862591673926, 25.772283387680844, 26.224045190804944, 19.991280034184456, 19.826486974954605, 19.981148585677147, 29.972799104948834, 29.9825892796119, 30.508415084409833, 12.748253559072808, 12.538696014632777, 12.597773065169648, 30.18848192691803, 30.54161374270916, 30.060168623924255, 21.76008532444635, 22.21437911192575, 22.195827445636183, 21.253937482833862, 21.656119413673878, 21.33732184767723, 27.67318733533223, 28.561334312272564, 28.185271700223282, 27.851161405444145, 28.040601171553135, 27.386367589235306, 25.71199570596218, 26.16186233283952, 25.83417934179306, 22.623071779807404, 22.55637392153342, 22.711492420484618, 27.71488765099396, 27.31731866796811, 27.181468208630875, 15.82456063230832, 15.905295347174004, 16.267941815157727, 24.089575355251625, 23.650570308168724, 24.25771776710947, 23.937647345165402, 24.16954140427211, 23.109115252892167, 19.092892994483307, 19.586071620540068, 19.33255650972326, 19.400544884304196, 19.54143119106689, 19.339967677990586, 26.066734729645148, 25.510583882530526, 25.752044831713036, 15.213504480818898, 15.214293124775082, 14.588566357890755, 29.69252600272496, 29.896298599739865, 30.36691463955988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15433024762587638, "mean_inference_ms": 0.7059587408711988, "mean_action_processing_ms": 0.09999082872637594, "mean_env_wait_ms": 0.8116439455913751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1093716, "timesteps_this_iter": 0, "agent_timesteps_total": 3281148, "timers": {"sample_time_ms": 18696.107, "sample_throughput": 513.155, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2944.655, "learn_throughput": 3258.107, "update_time_ms": 8.159}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.391367600779632e-11, "cur_lr": 0.0005, "total_loss": 6.320618689060211, "policy_loss": 0.001779901234683412, "vf_loss": 6.464338600635529, "vf_explained_var": 0.06927167624235153, "kl": 0.012076343060632874, "entropy": 14.549982070922852, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1093716, "num_agent_steps_sampled": 3281148, "num_steps_trained": 1093716, "num_agent_steps_trained": 3281148, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4435, "training_iteration": 114, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-21-44", "timestamp": 1706192504, "time_this_iter_s": 18.394943714141846, "time_total_s": 2303.935054540634, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA00460940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2303.935054540634, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 6.984615384615386, "ram_util_percent": 48.48846153846154}}
{"episode_reward_max": 107.83030548319219, "episode_reward_min": -5.4657126870006465, "episode_reward_mean": 67.3924850501609, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -1.925604666272804}, "policy_reward_max": {"shared_policy": 36.07178544377287}, "policy_reward_mean": {"shared_policy": 22.464161683386962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.19699902366844, 54.874437194317565, 84.86540927737951, 96.01630213321187, 63.9418685361743, 91.86799804493783, 68.24145829584448, 52.57028714939952, 66.61828471068293, 82.18156892061234, 70.04931067768482, 49.07046857848762, 69.08350575529036, 86.66072864830494, 60.646102366968975, 63.11144215939564, 107.83030548319219, 75.67386061325666, 53.55436810618265, 52.82072767056525, 76.29170901700851, 82.69401691108942, 72.79495701193808, 91.64658160321414, 78.82019364647566, 93.99936358258128, 61.157137773931, 54.73351253569125, 86.17618075758217, 49.28262265026568, 63.13407984049989, 71.61912484001365, 80.22970537841317, 58.886721353977904, 79.34725577197969, 30.25574613362548, 44.51981811970471, 64.91428614826873, 42.34429746679962, 37.248040914535494, 86.14743107929824, 79.27560843527316, 61.25612712930885, 74.63415125757456, 74.35722484253344, 43.580937261460335, 78.22119117015971, 59.79891559481621, 90.46380346897057, 37.88472263887523, 90.79026429355145, 66.17029188200829, 64.24737874418497, 84.41979334782808, 83.27813016623259, 77.70803738059476, 67.89093812182544, 82.21367452759294, 47.99779779464005, 71.99786343052982, 71.21630400232968, 58.011521124746636, 58.28194375336167, 77.32936344388871, 45.016363963484736, 89.9557392420247, 71.39075081981719, 80.79095115885136, 74.72408436611292, 61.13747162651269, 80.68354663625357, 86.14962938986716, 71.28973034024239, 52.864481188356876, -5.4657126870006465, 75.87890258431433, 75.44942570105194, 78.52664939872919, 45.57499160617587, 38.56135188043115, 84.63046178594229, 75.91458404064176, 57.873237435705946, 79.7610141970217, 54.0288064330816, 34.29894591122864, 66.50513527914882, 51.00673810020089, 25.735920636914642, 69.92121648043391, 66.66292213648558, 66.88875641301271, 69.34141553565858, 89.3599592577666, 75.5810944214463, 56.191902942955466, 89.52361085079608, 59.45970681868491, 61.20631716027856, 56.68420226871967], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.751670638720185, 23.185335826749593, 23.25999255819866, 18.153709565599755, 18.30416092773278, 18.41656670098503, 28.305215410888195, 28.36049711704254, 28.199696749448776, 32.306459868559614, 32.070233300328255, 31.639608964323997, 21.318842977285385, 21.297600775957108, 21.325424782931805, 30.779111580302313, 30.447008935113743, 30.64187752952178, 22.73638208334644, 22.888398006868854, 22.616678205629185, 17.334252431988716, 17.374624222517014, 17.86141049489379, 22.389001295901835, 22.035932302474976, 22.193351112306118, 27.098343804478645, 27.442403979599476, 27.640821136534214, 23.114456358055264, 23.48565891912827, 23.44919540050128, 16.478271098186568, 16.270135944088295, 16.322061536212757, 22.77496602634588, 23.044680433968693, 23.263859294975788, 28.97502852231264, 28.907880648970604, 28.777819477021694, 20.13215249528487, 20.300843074296907, 20.213106797387198, 21.214544082215667, 20.802569920818, 21.094328156361968, 35.73370001961787, 36.07178544377287, 36.02482001980145, 25.164710054794938, 25.069409454862267, 25.43974110359946, 17.858380950366453, 17.74605755259593, 17.94992960322027, 17.78241684474051, 17.525186210870743, 17.513124614953995, 25.1499146024386, 25.702370478461177, 25.43942393610874, 27.623113863170147, 27.534374430775642, 27.53652861714363, 24.178586428364113, 24.237288323541478, 24.37908226003249, 30.682711040601134, 30.625862039625645, 30.338008522987366, 26.28244562198718, 26.52709969443579, 26.01064833005269, 31.135987877845764, 31.574324142187834, 31.289051562547684, 20.131541932622582, 20.56536569694677, 20.460230144361645, 17.97502966721852, 18.451444787283734, 18.307038081188992, 28.539136980970696, 28.74109897514184, 28.89594480146964, 16.661808756490544, 16.182853137453392, 16.437960756321743, 21.1455211554033, 20.88944351052244, 21.099115174574152, 24.195788707273692, 23.249408225218446, 24.173927907521517, 26.916425871352345, 26.561291264990956, 26.75198824206987, 19.415166941781834, 19.7986077380677, 19.67294667412837, 26.369194336235523, 26.361600928008556, 26.61646050773561, 9.572925368944794, 10.471115248898656, 10.211705515782029, 14.988092814882592, 14.597470944126442, 14.934254360695675, 21.921740595716983, 21.49389900267124, 21.498646549880505, 14.290642771869898, 13.702318981289864, 14.351335713639855, 12.396385046343, 12.436862486104161, 12.414793382088334, 28.80356929575403, 28.638871175547436, 28.704990607996777, 26.441275489826992, 26.467475717266396, 26.366857228179768, 20.765435306044907, 20.08284444610277, 20.407847377161175, 25.09672135859728, 24.52532996237278, 25.0120999366045, 24.77442781130472, 24.621783817807824, 24.961013213420898, 14.480460052688912, 14.79123198248756, 14.309245226283863, 26.224862591673926, 25.772283387680844, 26.224045190804944, 19.991280034184456, 19.826486974954605, 19.981148585677147, 29.972799104948834, 29.9825892796119, 30.508415084409833, 12.748253559072808, 12.538696014632777, 12.597773065169648, 30.18848192691803, 30.54161374270916, 30.060168623924255, 21.76008532444635, 22.21437911192575, 22.195827445636183, 21.253937482833862, 21.656119413673878, 21.33732184767723, 27.67318733533223, 28.561334312272564, 28.185271700223282, 27.851161405444145, 28.040601171553135, 27.386367589235306, 25.71199570596218, 26.16186233283952, 25.83417934179306, 22.623071779807404, 22.55637392153342, 22.711492420484618, 27.71488765099396, 27.31731866796811, 27.181468208630875, 15.82456063230832, 15.905295347174004, 16.267941815157727, 24.089575355251625, 23.650570308168724, 24.25771776710947, 23.937647345165402, 24.16954140427211, 23.109115252892167, 19.092892994483307, 19.586071620540068, 19.33255650972326, 19.400544884304196, 19.54143119106689, 19.339967677990586, 26.066734729645148, 25.510583882530526, 25.752044831713036, 15.213504480818898, 15.214293124775082, 14.588566357890755, 29.69252600272496, 29.896298599739865, 30.36691463955988, 23.818240076303482, 23.62598890811205, 23.946521835401654, 27.001784319678933, 27.159429794798285, 26.62973704437414, 24.79086663077274, 24.79365389297405, 25.13956384236613, 20.244180766244725, 20.267439429958657, 20.62585143030931, 26.9081587443749, 26.83384050677219, 26.941547385106475, 28.91141572284201, 28.85343155140677, 28.38478211561838, 23.8512576892972, 23.977579303085804, 23.460893347859383, 17.714478515088558, 17.156228452920914, 17.993774220347404, -1.820365867267057, -1.925604666272804, -1.7197421534607855, 24.904458319147423, 25.557592586924628, 25.41685167824228, 24.99770913024743, 25.289335322876767, 25.16238124792774, 26.11036381622155, 26.459266263370708, 25.957019319136933, 14.65019544462362, 15.539060755322367, 15.385735406229884, 13.03997169683376, 12.894297423462064, 12.627082760135323, 28.214558357993752, 28.14790270725885, 28.268000720689685, 25.05355259279409, 25.390294695893914, 25.47073675195375, 19.47137623870124, 19.30761481945713, 19.094246377547577, 26.803572366634995, 25.965893829862267, 26.991548000524432, 17.795233915249497, 18.41785032550493, 17.815722192327172, 11.473357511063412, 11.258476433654621, 11.567111966510609, 21.995484307408333, 22.35805617645383, 22.151594795286655, 17.086968559771776, 17.265696793794632, 16.654072746634483, 8.445359813670308, 8.848692947688193, 8.441867875556142, 23.101526523629815, 23.297695020834595, 23.521994935969502, 22.195493258535862, 22.188937939703465, 22.27849093824625, 22.125471437970788, 22.42745555813113, 22.335829416910798, 22.894628276427582, 23.203410529841975, 23.243376729389027, 29.716712154448032, 29.7383186891675, 29.904928414151073, 25.09153156975904, 25.199462617437035, 25.290100234250218, 18.975787150363118, 18.542109640936047, 18.6740061516563, 30.048621751988918, 29.789792987207562, 29.685196111599595, 19.873817930618912, 20.050805867339164, 19.53508302072683, 20.30464728921652, 20.466802414506674, 20.434867456555367, 19.115280352532864, 18.963956378400326, 18.604965537786484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413508736846177, "mean_inference_ms": 0.7052323045992729, "mean_action_processing_ms": 0.09994526860360622, "mean_env_wait_ms": 0.8109694619936292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1103310, "timesteps_this_iter": 0, "agent_timesteps_total": 3309930, "timers": {"sample_time_ms": 18647.707, "sample_throughput": 514.487, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2952.581, "learn_throughput": 3249.361, "update_time_ms": 8.258}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.391367600779632e-11, "cur_lr": 0.0005, "total_loss": 6.41113018989563, "policy_loss": 0.00010084920535069486, "vf_loss": 6.555382966995239, "vf_explained_var": 0.12018990516662598, "kl": 0.00584840329263233, "entropy": 14.43534803390503, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1103310, "num_agent_steps_sampled": 3309930, "num_steps_trained": 1103310, "num_agent_steps_trained": 3309930, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4469, "training_iteration": 115, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-22-03", "timestamp": 1706192523, "time_this_iter_s": 18.9085111618042, "time_total_s": 2322.8435657024384, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175CF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2322.8435657024384, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 9.648148148148149, "ram_util_percent": 48.47037037037036}}
{"episode_reward_max": 94.59167831414376, "episode_reward_min": -264.9885465875268, "episode_reward_mean": 61.035810338926964, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -96.42259375254314}, "policy_reward_max": {"shared_policy": 31.577320678081975}, "policy_reward_mean": {"shared_policy": 20.34527011297565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.13407984049989, 71.61912484001365, 80.22970537841317, 58.886721353977904, 79.34725577197969, 30.25574613362548, 44.51981811970471, 64.91428614826873, 42.34429746679962, 37.248040914535494, 86.14743107929824, 79.27560843527316, 61.25612712930885, 74.63415125757456, 74.35722484253344, 43.580937261460335, 78.22119117015971, 59.79891559481621, 90.46380346897057, 37.88472263887523, 90.79026429355145, 66.17029188200829, 64.24737874418497, 84.41979334782808, 83.27813016623259, 77.70803738059476, 67.89093812182544, 82.21367452759294, 47.99779779464005, 71.99786343052982, 71.21630400232968, 58.011521124746636, 58.28194375336167, 77.32936344388871, 45.016363963484736, 89.9557392420247, 71.39075081981719, 80.79095115885136, 74.72408436611292, 61.13747162651269, 80.68354663625357, 86.14962938986716, 71.28973034024239, 52.864481188356876, -5.4657126870006465, 75.87890258431433, 75.44942570105194, 78.52664939872919, 45.57499160617587, 38.56135188043115, 84.63046178594229, 75.91458404064176, 57.873237435705946, 79.7610141970217, 54.0288064330816, 34.29894591122864, 66.50513527914882, 51.00673810020089, 25.735920636914642, 69.92121648043391, 66.66292213648558, 66.88875641301271, 69.34141553565858, 89.3599592577666, 75.5810944214463, 56.191902942955466, 89.52361085079608, 59.45970681868491, 61.20631716027856, 56.68420226871967, 60.55572151392697, 64.33196872286497, 78.82265892252325, -264.9885465875268, 80.67360559059306, 57.439418093184926, 68.38054099399595, 35.508309084922075, 20.043059144169092, 64.32221735466734, 11.45551969483492, 85.59654603898525, 49.00570561736819, 78.71222145482896, 63.5710875727236, 58.67912794649601, 68.95296053588389, 61.96317927353084, 57.754878364503384, 41.14982774108647, 70.67350806458852, 58.18491191137579, 40.99677122756836, 80.99859609827396, 49.36425410956143, 94.59167831414376, 82.16254223627035, 54.012639973312616, 71.48898216336966, 86.40034653991458], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.1455211554033, 20.88944351052244, 21.099115174574152, 24.195788707273692, 23.249408225218446, 24.173927907521517, 26.916425871352345, 26.561291264990956, 26.75198824206987, 19.415166941781834, 19.7986077380677, 19.67294667412837, 26.369194336235523, 26.361600928008556, 26.61646050773561, 9.572925368944794, 10.471115248898656, 10.211705515782029, 14.988092814882592, 14.597470944126442, 14.934254360695675, 21.921740595716983, 21.49389900267124, 21.498646549880505, 14.290642771869898, 13.702318981289864, 14.351335713639855, 12.396385046343, 12.436862486104161, 12.414793382088334, 28.80356929575403, 28.638871175547436, 28.704990607996777, 26.441275489826992, 26.467475717266396, 26.366857228179768, 20.765435306044907, 20.08284444610277, 20.407847377161175, 25.09672135859728, 24.52532996237278, 25.0120999366045, 24.77442781130472, 24.621783817807824, 24.961013213420898, 14.480460052688912, 14.79123198248756, 14.309245226283863, 26.224862591673926, 25.772283387680844, 26.224045190804944, 19.991280034184456, 19.826486974954605, 19.981148585677147, 29.972799104948834, 29.9825892796119, 30.508415084409833, 12.748253559072808, 12.538696014632777, 12.597773065169648, 30.18848192691803, 30.54161374270916, 30.060168623924255, 21.76008532444635, 22.21437911192575, 22.195827445636183, 21.253937482833862, 21.656119413673878, 21.33732184767723, 27.67318733533223, 28.561334312272564, 28.185271700223282, 27.851161405444145, 28.040601171553135, 27.386367589235306, 25.71199570596218, 26.16186233283952, 25.83417934179306, 22.623071779807404, 22.55637392153342, 22.711492420484618, 27.71488765099396, 27.31731866796811, 27.181468208630875, 15.82456063230832, 15.905295347174004, 16.267941815157727, 24.089575355251625, 23.650570308168724, 24.25771776710947, 23.937647345165402, 24.16954140427211, 23.109115252892167, 19.092892994483307, 19.586071620540068, 19.33255650972326, 19.400544884304196, 19.54143119106689, 19.339967677990586, 26.066734729645148, 25.510583882530526, 25.752044831713036, 15.213504480818898, 15.214293124775082, 14.588566357890755, 29.69252600272496, 29.896298599739865, 30.36691463955988, 23.818240076303482, 23.62598890811205, 23.946521835401654, 27.001784319678933, 27.159429794798285, 26.62973704437414, 24.79086663077274, 24.79365389297405, 25.13956384236613, 20.244180766244725, 20.267439429958657, 20.62585143030931, 26.9081587443749, 26.83384050677219, 26.941547385106475, 28.91141572284201, 28.85343155140677, 28.38478211561838, 23.8512576892972, 23.977579303085804, 23.460893347859383, 17.714478515088558, 17.156228452920914, 17.993774220347404, -1.820365867267057, -1.925604666272804, -1.7197421534607855, 24.904458319147423, 25.557592586924628, 25.41685167824228, 24.99770913024743, 25.289335322876767, 25.16238124792774, 26.11036381622155, 26.459266263370708, 25.957019319136933, 14.65019544462362, 15.539060755322367, 15.385735406229884, 13.03997169683376, 12.894297423462064, 12.627082760135323, 28.214558357993752, 28.14790270725885, 28.268000720689685, 25.05355259279409, 25.390294695893914, 25.47073675195375, 19.47137623870124, 19.30761481945713, 19.094246377547577, 26.803572366634995, 25.965893829862267, 26.991548000524432, 17.795233915249497, 18.41785032550493, 17.815722192327172, 11.473357511063412, 11.258476433654621, 11.567111966510609, 21.995484307408333, 22.35805617645383, 22.151594795286655, 17.086968559771776, 17.265696793794632, 16.654072746634483, 8.445359813670308, 8.848692947688193, 8.441867875556142, 23.101526523629815, 23.297695020834595, 23.521994935969502, 22.195493258535862, 22.188937939703465, 22.27849093824625, 22.125471437970788, 22.42745555813113, 22.335829416910798, 22.894628276427582, 23.203410529841975, 23.243376729389027, 29.716712154448032, 29.7383186891675, 29.904928414151073, 25.09153156975904, 25.199462617437035, 25.290100234250218, 18.975787150363118, 18.542109640936047, 18.6740061516563, 30.048621751988918, 29.789792987207562, 29.685196111599595, 19.873817930618912, 20.050805867339164, 19.53508302072683, 20.30464728921652, 20.466802414506674, 20.434867456555367, 19.115280352532864, 18.963956378400326, 18.604965537786484, 20.19575148572524, 20.20512483765681, 20.15484519054492, 21.17185841252406, 21.413381462295845, 21.746728848045066, 25.906147380669907, 26.339824256797627, 26.576687285055712, -96.42259375254314, -84.97009874383609, -83.59585409114759, 26.385102858146027, 27.215769772262618, 27.07273296018441, 18.995846663912133, 18.814186831315354, 19.62938459795744, 22.77122876544793, 22.722214990605906, 22.887097237942115, 11.820213690400124, 11.869523774832487, 11.818571619689465, 6.652900770306587, 6.603041857481003, 6.787116516381502, 21.57692678521076, 21.03466388086477, 21.710626688591816, 3.6707796255747382, 3.780374387900025, 4.004365681360156, 28.42346417158842, 28.824601270258427, 28.348480597138405, 16.489622740695864, 16.533850281188876, 15.982232595483453, 26.52492294584711, 26.10443730403979, 26.082861204942063, 21.241490891824157, 21.26741289595762, 21.062183784941823, 19.674770332872868, 19.418003357946873, 19.58635425567627, 23.019805555542305, 23.07462890197833, 22.858526078363255, 20.78199990838766, 20.828079467639327, 20.353099897503853, 19.688897989690304, 19.62497904896736, 18.44100132584572, 13.822446544965103, 13.71817298730214, 13.609208208819226, 22.96500975390275, 23.9007672156052, 23.80773109508057, 19.386832152182848, 19.43251234634468, 19.365567412848264, 13.651986959079892, 13.640515337387711, 13.704268931100756, 26.895518022278935, 27.01299192259708, 27.090086153397948, 16.54472769175966, 16.303497617443398, 16.51602880035837, 31.577320678081975, 31.54288156485805, 31.47147607120374, 27.254263716439397, 27.650562092584238, 27.25771642724672, 17.993622541427612, 18.232120227068663, 17.78689720481634, 23.854832097887993, 23.87453292310238, 23.759617142379284, 28.818129303554684, 28.810335698227078, 28.771881538132817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400325373172596, "mean_inference_ms": 0.7049053721771983, "mean_action_processing_ms": 0.0999558812988621, "mean_env_wait_ms": 0.8105436338414723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1112904, "timesteps_this_iter": 0, "agent_timesteps_total": 3338712, "timers": {"sample_time_ms": 18654.505, "sample_throughput": 514.299, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2955.999, "learn_throughput": 3245.603, "update_time_ms": 8.26}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.391367600779632e-11, "cur_lr": 0.0005, "total_loss": 57.436837673187256, "policy_loss": -0.0010461238279203533, "vf_loss": 57.58548069000244, "vf_explained_var": 0.0401635617017746, "kl": 0.00952690484717199, "entropy": 14.759686827659607, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1112904, "num_agent_steps_sampled": 3338712, "num_steps_trained": 1112904, "num_agent_steps_trained": 3338712, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4499, "training_iteration": 116, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-22-22", "timestamp": 1706192542, "time_this_iter_s": 18.42427897453308, "time_total_s": 2341.2678446769714, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B22AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2341.2678446769714, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 6.553846153846154, "ram_util_percent": 48.55384615384616}}
{"episode_reward_max": 94.59167831414376, "episode_reward_min": -264.9885465875268, "episode_reward_mean": 60.95764535984315, "episode_len_mean": 298.39, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -96.42259375254314}, "policy_reward_max": {"shared_policy": 31.577320678081975}, "policy_reward_mean": {"shared_policy": 20.319215119947714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.016363963484736, 89.9557392420247, 71.39075081981719, 80.79095115885136, 74.72408436611292, 61.13747162651269, 80.68354663625357, 86.14962938986716, 71.28973034024239, 52.864481188356876, -5.4657126870006465, 75.87890258431433, 75.44942570105194, 78.52664939872919, 45.57499160617587, 38.56135188043115, 84.63046178594229, 75.91458404064176, 57.873237435705946, 79.7610141970217, 54.0288064330816, 34.29894591122864, 66.50513527914882, 51.00673810020089, 25.735920636914642, 69.92121648043391, 66.66292213648558, 66.88875641301271, 69.34141553565858, 89.3599592577666, 75.5810944214463, 56.191902942955466, 89.52361085079608, 59.45970681868491, 61.20631716027856, 56.68420226871967, 60.55572151392697, 64.33196872286497, 78.82265892252325, -264.9885465875268, 80.67360559059306, 57.439418093184926, 68.38054099399595, 35.508309084922075, 20.043059144169092, 64.32221735466734, 11.45551969483492, 85.59654603898525, 49.00570561736819, 78.71222145482896, 63.5710875727236, 58.67912794649601, 68.95296053588389, 61.96317927353084, 57.754878364503384, 41.14982774108647, 70.67350806458852, 58.18491191137579, 40.99677122756836, 80.99859609827396, 49.36425410956143, 94.59167831414376, 82.16254223627035, 54.012639973312616, 71.48898216336966, 86.40034653991458, 48.91860556975007, 82.00608107447623, 58.9986608973704, 68.19956604763864, 69.50244741141796, 25.164199389517307, 66.25656910985707, 90.55497555062173, 73.29503747075795, 67.98873004922643, 80.13783765584228, 78.37721335981041, 63.11941136419773, 59.25987060274929, 68.52093354612587, 64.47940149530768, 60.285252783447476, 67.28614793345332, 81.14780573267488, 74.54037406848508, 77.90686700865626, 81.63747357577083, 59.7312558387639, 45.94209299236533, 56.71969136595726, 81.6183703765273, 85.26384567003697, 66.20122032053769, 61.3580253049731, 86.13590098544954, 73.16322086099535, 56.277668257709564, 15.682618971914039, 56.178620308637605], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.213504480818898, 15.214293124775082, 14.588566357890755, 29.69252600272496, 29.896298599739865, 30.36691463955988, 23.818240076303482, 23.62598890811205, 23.946521835401654, 27.001784319678933, 27.159429794798285, 26.62973704437414, 24.79086663077274, 24.79365389297405, 25.13956384236613, 20.244180766244725, 20.267439429958657, 20.62585143030931, 26.9081587443749, 26.83384050677219, 26.941547385106475, 28.91141572284201, 28.85343155140677, 28.38478211561838, 23.8512576892972, 23.977579303085804, 23.460893347859383, 17.714478515088558, 17.156228452920914, 17.993774220347404, -1.820365867267057, -1.925604666272804, -1.7197421534607855, 24.904458319147423, 25.557592586924628, 25.41685167824228, 24.99770913024743, 25.289335322876767, 25.16238124792774, 26.11036381622155, 26.459266263370708, 25.957019319136933, 14.65019544462362, 15.539060755322367, 15.385735406229884, 13.03997169683376, 12.894297423462064, 12.627082760135323, 28.214558357993752, 28.14790270725885, 28.268000720689685, 25.05355259279409, 25.390294695893914, 25.47073675195375, 19.47137623870124, 19.30761481945713, 19.094246377547577, 26.803572366634995, 25.965893829862267, 26.991548000524432, 17.795233915249497, 18.41785032550493, 17.815722192327172, 11.473357511063412, 11.258476433654621, 11.567111966510609, 21.995484307408333, 22.35805617645383, 22.151594795286655, 17.086968559771776, 17.265696793794632, 16.654072746634483, 8.445359813670308, 8.848692947688193, 8.441867875556142, 23.101526523629815, 23.297695020834595, 23.521994935969502, 22.195493258535862, 22.188937939703465, 22.27849093824625, 22.125471437970788, 22.42745555813113, 22.335829416910798, 22.894628276427582, 23.203410529841975, 23.243376729389027, 29.716712154448032, 29.7383186891675, 29.904928414151073, 25.09153156975904, 25.199462617437035, 25.290100234250218, 18.975787150363118, 18.542109640936047, 18.6740061516563, 30.048621751988918, 29.789792987207562, 29.685196111599595, 19.873817930618912, 20.050805867339164, 19.53508302072683, 20.30464728921652, 20.466802414506674, 20.434867456555367, 19.115280352532864, 18.963956378400326, 18.604965537786484, 20.19575148572524, 20.20512483765681, 20.15484519054492, 21.17185841252406, 21.413381462295845, 21.746728848045066, 25.906147380669907, 26.339824256797627, 26.576687285055712, -96.42259375254314, -84.97009874383609, -83.59585409114759, 26.385102858146027, 27.215769772262618, 27.07273296018441, 18.995846663912133, 18.814186831315354, 19.62938459795744, 22.77122876544793, 22.722214990605906, 22.887097237942115, 11.820213690400124, 11.869523774832487, 11.818571619689465, 6.652900770306587, 6.603041857481003, 6.787116516381502, 21.57692678521076, 21.03466388086477, 21.710626688591816, 3.6707796255747382, 3.780374387900025, 4.004365681360156, 28.42346417158842, 28.824601270258427, 28.348480597138405, 16.489622740695864, 16.533850281188876, 15.982232595483453, 26.52492294584711, 26.10443730403979, 26.082861204942063, 21.241490891824157, 21.26741289595762, 21.062183784941823, 19.674770332872868, 19.418003357946873, 19.58635425567627, 23.019805555542305, 23.07462890197833, 22.858526078363255, 20.78199990838766, 20.828079467639327, 20.353099897503853, 19.688897989690304, 19.62497904896736, 18.44100132584572, 13.822446544965103, 13.71817298730214, 13.609208208819226, 22.96500975390275, 23.9007672156052, 23.80773109508057, 19.386832152182848, 19.43251234634468, 19.365567412848264, 13.651986959079892, 13.640515337387711, 13.704268931100756, 26.895518022278935, 27.01299192259708, 27.090086153397948, 16.54472769175966, 16.303497617443398, 16.51602880035837, 31.577320678081975, 31.54288156485805, 31.47147607120374, 27.254263716439397, 27.650562092584238, 27.25771642724672, 17.993622541427612, 18.232120227068663, 17.78689720481634, 23.854832097887993, 23.87453292310238, 23.759617142379284, 28.818129303554684, 28.810335698227078, 28.771881538132817, 16.03397859632969, 16.531172771006823, 16.35345420241356, 27.853136916955307, 27.091318552692726, 27.061625604828194, 19.589941094319016, 19.44515437136093, 19.963565431690455, 22.90633127217491, 22.814866845806435, 22.478367929657296, 23.363226607441902, 22.95812188833952, 23.18109891563654, 8.509532487019897, 8.154230363667011, 8.5004365388304, 22.126828496654824, 22.140631032486752, 21.989109580715493, 29.920400095482663, 30.254553848256663, 30.38002160688241, 24.49243964751561, 24.37667206053932, 24.425925762703017, 22.612144019454718, 22.61224579438567, 22.764340235386044, 26.504123191038758, 26.645560840765626, 26.988153624037892, 26.28839906398207, 26.077836580574512, 26.01097771525383, 21.24165380001068, 20.90647605806589, 20.97128150612116, 19.947830035351217, 19.6494420170784, 19.66259855031967, 23.04757109781106, 22.70734130342801, 22.766021144886807, 21.347185917198658, 21.5968395806849, 21.535375997424126, 19.938471535841614, 20.236402502904326, 20.110378744701535, 22.477323807775974, 22.306969039142132, 22.501855086535215, 27.040207474802926, 27.100915862557784, 27.006682395314172, 25.03695385400593, 24.530175666014344, 24.973244548464805, 25.934454042464495, 25.873043321073055, 26.099369645118713, 25.052337567011506, 28.49281224856773, 28.09232376019159, 19.800950691103935, 20.210756072890945, 19.71954907476902, 15.14611870298782, 15.455523713181407, 15.340450576196105, 18.67587973177433, 18.715532913804054, 19.328278720378876, 27.412604962786034, 26.91523929437001, 27.29052611937125, 28.281208399683237, 28.51090774592012, 28.471729524433613, 21.759956419467926, 22.32699661143124, 22.11426728963852, 20.426764900485665, 20.487238282958657, 20.444022121528775, 28.816610933591917, 28.65955666204293, 28.65973338981469, 24.28890210017562, 24.30327060073614, 24.571048160083592, 18.27643636862436, 19.109620303070784, 18.89161158601442, 5.018875723083809, 5.646382154275969, 5.017361094554261, 18.42542154093583, 18.71276495357354, 19.040433814128235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384278513534574, "mean_inference_ms": 0.7041510872728367, "mean_action_processing_ms": 0.09991039704500833, "mean_env_wait_ms": 0.8098391243077149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1122498, "timesteps_this_iter": 0, "agent_timesteps_total": 3367494, "timers": {"sample_time_ms": 18670.397, "sample_throughput": 513.862, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2964.856, "learn_throughput": 3235.908, "update_time_ms": 8.267}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.391367600779632e-11, "cur_lr": 0.0005, "total_loss": 7.064026415348053, "policy_loss": -2.9538015575203413e-05, "vf_loss": 7.209188997745514, "vf_explained_var": 0.0899764820933342, "kl": 0.004398361081418383, "entropy": 14.513275027275085, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1122498, "num_agent_steps_sampled": 3367494, "num_steps_trained": 1122498, "num_agent_steps_trained": 3367494, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4533, "training_iteration": 117, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-22-40", "timestamp": 1706192560, "time_this_iter_s": 18.595144748687744, "time_total_s": 2359.862989425659, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175CC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2359.862989425659, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 6.007692307692306, "ram_util_percent": 48.64615384615384}}
{"episode_reward_max": 94.59167831414376, "episode_reward_min": -264.9885465875268, "episode_reward_mean": 56.027235864020106, "episode_len_mean": 297.94, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -96.42259375254314}, "policy_reward_max": {"shared_policy": 31.577320678081975}, "policy_reward_mean": {"shared_policy": 18.6757452880067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.191902942955466, 89.52361085079608, 59.45970681868491, 61.20631716027856, 56.68420226871967, 60.55572151392697, 64.33196872286497, 78.82265892252325, -264.9885465875268, 80.67360559059306, 57.439418093184926, 68.38054099399595, 35.508309084922075, 20.043059144169092, 64.32221735466734, 11.45551969483492, 85.59654603898525, 49.00570561736819, 78.71222145482896, 63.5710875727236, 58.67912794649601, 68.95296053588389, 61.96317927353084, 57.754878364503384, 41.14982774108647, 70.67350806458852, 58.18491191137579, 40.99677122756836, 80.99859609827396, 49.36425410956143, 94.59167831414376, 82.16254223627035, 54.012639973312616, 71.48898216336966, 86.40034653991458, 48.91860556975007, 82.00608107447623, 58.9986608973704, 68.19956604763864, 69.50244741141796, 25.164199389517307, 66.25656910985707, 90.55497555062173, 73.29503747075795, 67.98873004922643, 80.13783765584228, 78.37721335981041, 63.11941136419773, 59.25987060274929, 68.52093354612587, 64.47940149530768, 60.285252783447476, 67.28614793345332, 81.14780573267488, 74.54037406848508, 77.90686700865626, 81.63747357577083, 59.7312558387639, 45.94209299236533, 56.71969136595726, 81.6183703765273, 85.26384567003697, 66.20122032053769, 61.3580253049731, 86.13590098544954, 73.16322086099535, 56.277668257709564, 15.682618971914039, 56.178620308637605, 6.3073050715028955, 47.479437805712195, 19.50921827787532, 26.939010418951497, 21.45893279835579, 91.81723154993232, 52.33468712493777, 44.83016145974398, 82.6998075582087, 73.87297654896972, 67.13748037815093, 57.25641914177683, 71.93003297224638, 67.8468899466097, 25.908473186194882, 57.498055558651686, 64.47502301633355, 59.23674361407757, 31.1352364681661, 75.77183066681025, -243.34552690386772, 74.31884603574869, 63.193731967126936, 92.111143656075, 53.15884510288012, 53.11357142776251, 87.7244877833873, 76.9012576639652, 78.43783307075498, 60.91979040950534, 55.018681921064825], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 139, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 255, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.975787150363118, 18.542109640936047, 18.6740061516563, 30.048621751988918, 29.789792987207562, 29.685196111599595, 19.873817930618912, 20.050805867339164, 19.53508302072683, 20.30464728921652, 20.466802414506674, 20.434867456555367, 19.115280352532864, 18.963956378400326, 18.604965537786484, 20.19575148572524, 20.20512483765681, 20.15484519054492, 21.17185841252406, 21.413381462295845, 21.746728848045066, 25.906147380669907, 26.339824256797627, 26.576687285055712, -96.42259375254314, -84.97009874383609, -83.59585409114759, 26.385102858146027, 27.215769772262618, 27.07273296018441, 18.995846663912133, 18.814186831315354, 19.62938459795744, 22.77122876544793, 22.722214990605906, 22.887097237942115, 11.820213690400124, 11.869523774832487, 11.818571619689465, 6.652900770306587, 6.603041857481003, 6.787116516381502, 21.57692678521076, 21.03466388086477, 21.710626688591816, 3.6707796255747382, 3.780374387900025, 4.004365681360156, 28.42346417158842, 28.824601270258427, 28.348480597138405, 16.489622740695864, 16.533850281188876, 15.982232595483453, 26.52492294584711, 26.10443730403979, 26.082861204942063, 21.241490891824157, 21.26741289595762, 21.062183784941823, 19.674770332872868, 19.418003357946873, 19.58635425567627, 23.019805555542305, 23.07462890197833, 22.858526078363255, 20.78199990838766, 20.828079467639327, 20.353099897503853, 19.688897989690304, 19.62497904896736, 18.44100132584572, 13.822446544965103, 13.71817298730214, 13.609208208819226, 22.96500975390275, 23.9007672156052, 23.80773109508057, 19.386832152182848, 19.43251234634468, 19.365567412848264, 13.651986959079892, 13.640515337387711, 13.704268931100756, 26.895518022278935, 27.01299192259708, 27.090086153397948, 16.54472769175966, 16.303497617443398, 16.51602880035837, 31.577320678081975, 31.54288156485805, 31.47147607120374, 27.254263716439397, 27.650562092584238, 27.25771642724672, 17.993622541427612, 18.232120227068663, 17.78689720481634, 23.854832097887993, 23.87453292310238, 23.759617142379284, 28.818129303554684, 28.810335698227078, 28.771881538132817, 16.03397859632969, 16.531172771006823, 16.35345420241356, 27.853136916955307, 27.091318552692726, 27.061625604828194, 19.589941094319016, 19.44515437136093, 19.963565431690455, 22.90633127217491, 22.814866845806435, 22.478367929657296, 23.363226607441902, 22.95812188833952, 23.18109891563654, 8.509532487019897, 8.154230363667011, 8.5004365388304, 22.126828496654824, 22.140631032486752, 21.989109580715493, 29.920400095482663, 30.254553848256663, 30.38002160688241, 24.49243964751561, 24.37667206053932, 24.425925762703017, 22.612144019454718, 22.61224579438567, 22.764340235386044, 26.504123191038758, 26.645560840765626, 26.988153624037892, 26.28839906398207, 26.077836580574512, 26.01097771525383, 21.24165380001068, 20.90647605806589, 20.97128150612116, 19.947830035351217, 19.6494420170784, 19.66259855031967, 23.04757109781106, 22.70734130342801, 22.766021144886807, 21.347185917198658, 21.5968395806849, 21.535375997424126, 19.938471535841614, 20.236402502904326, 20.110378744701535, 22.477323807775974, 22.306969039142132, 22.501855086535215, 27.040207474802926, 27.100915862557784, 27.006682395314172, 25.03695385400593, 24.530175666014344, 24.973244548464805, 25.934454042464495, 25.873043321073055, 26.099369645118713, 25.052337567011506, 28.49281224856773, 28.09232376019159, 19.800950691103935, 20.210756072890945, 19.71954907476902, 15.14611870298782, 15.455523713181407, 15.340450576196105, 18.67587973177433, 18.715532913804054, 19.328278720378876, 27.412604962786034, 26.91523929437001, 27.29052611937125, 28.281208399683237, 28.51090774592012, 28.471729524433613, 21.759956419467926, 22.32699661143124, 22.11426728963852, 20.426764900485665, 20.487238282958657, 20.444022121528775, 28.816610933591917, 28.65955666204293, 28.65973338981469, 24.28890210017562, 24.30327060073614, 24.571048160083592, 18.27643636862436, 19.109620303070784, 18.89161158601442, 5.018875723083809, 5.646382154275969, 5.017361094554261, 18.42542154093583, 18.71276495357354, 19.040433814128235, 2.4699716555575435, 1.4990853617588584, 2.3382480541864936, 15.793029526869446, 16.15371589610973, 15.532692382733018, 6.530811735739306, 6.595801718377814, 6.3826048237582, 8.728140239914254, 9.103616514553622, 9.107253664483622, 7.1533258582154815, 7.223653881500155, 7.081953058640153, 30.617452570547655, 30.87134953624384, 30.32842944314082, 17.425597667694092, 17.204010471701622, 17.70507898554206, 14.832794360816479, 14.985289361327887, 15.012077737599611, 27.337884664535522, 27.505355536937714, 27.856567356735468, 24.80970765898624, 24.86473962167898, 24.198529268304497, 22.641154018541172, 21.71011870106061, 22.786207658549145, 19.01948372522989, 19.11258363785842, 19.12435177868852, 23.129178057114274, 24.37454431752363, 24.426310597608477, 22.421773033837468, 22.74806849161783, 22.67704842115441, 8.56882095833619, 8.722360735138253, 8.61729149272044, 18.893627807497978, 19.373918812721968, 19.23050893843174, 21.723892743388802, 21.740587706367165, 21.010542566577584, 20.198742628097534, 18.929021537303925, 20.10897944867611, 10.344514292975262, 10.70468547319372, 10.086036701997116, 25.414662913108856, 25.41851255359748, 24.93865520010391, -81.4502764493227, -80.98912477493286, -80.90612567961216, 24.879640645037085, 24.688670511047036, 24.75053487966457, 20.81371633460124, 21.24088945340675, 21.139126179118946, 30.680690743029118, 30.914501547813416, 30.515951365232468, 17.976470989330352, 17.44761652002731, 17.73475759352246, 17.681455731391907, 17.83060074597597, 17.60151495039463, 29.25180783867836, 29.2416966650635, 29.230983279645443, 25.383883426586777, 25.66595000276962, 25.8514242346088, 25.942367921272904, 26.24935272211829, 26.246112427363784, 20.07673659423986, 20.469249981145055, 20.373803834120423, 18.300387027362973, 18.212608012060315, 18.505686881641537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373385843992207, "mean_inference_ms": 0.703823657772764, "mean_action_processing_ms": 0.09991529254950209, "mean_env_wait_ms": 0.8094697906866224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1132092, "timesteps_this_iter": 0, "agent_timesteps_total": 3396276, "timers": {"sample_time_ms": 18774.433, "sample_throughput": 511.014, "load_time_ms": 0.196, "load_throughput": 48894474.576, "learn_time_ms": 2977.625, "learn_throughput": 3222.031, "update_time_ms": 8.466}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.195683800389816e-11, "cur_lr": 0.0005, "total_loss": 41.7855544090271, "policy_loss": 0.0004123137682111033, "vf_loss": 41.933566093444824, "vf_explained_var": 0.031124673783779144, "kl": 0.011973617365749823, "entropy": 14.842492818832397, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1132092, "num_agent_steps_sampled": 3396276, "num_steps_trained": 1132092, "num_agent_steps_trained": 3396276, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4564, "training_iteration": 118, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-23-00", "timestamp": 1706192580, "time_this_iter_s": 19.902541875839233, "time_total_s": 2379.7655313014984, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBDAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2379.7655313014984, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 10.844827586206897, "ram_util_percent": 49.1896551724138}}
{"episode_reward_max": 92.111143656075, "episode_reward_min": -243.34552690386772, "episode_reward_mean": 60.13674719556053, "episode_len_mean": 299.55, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -81.4502764493227}, "policy_reward_max": {"shared_policy": 30.914501547813416}, "policy_reward_mean": {"shared_policy": 20.045582398520175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.012639973312616, 71.48898216336966, 86.40034653991458, 48.91860556975007, 82.00608107447623, 58.9986608973704, 68.19956604763864, 69.50244741141796, 25.164199389517307, 66.25656910985707, 90.55497555062173, 73.29503747075795, 67.98873004922643, 80.13783765584228, 78.37721335981041, 63.11941136419773, 59.25987060274929, 68.52093354612587, 64.47940149530768, 60.285252783447476, 67.28614793345332, 81.14780573267488, 74.54037406848508, 77.90686700865626, 81.63747357577083, 59.7312558387639, 45.94209299236533, 56.71969136595726, 81.6183703765273, 85.26384567003697, 66.20122032053769, 61.3580253049731, 86.13590098544954, 73.16322086099535, 56.277668257709564, 15.682618971914039, 56.178620308637605, 6.3073050715028955, 47.479437805712195, 19.50921827787532, 26.939010418951497, 21.45893279835579, 91.81723154993232, 52.33468712493777, 44.83016145974398, 82.6998075582087, 73.87297654896972, 67.13748037815093, 57.25641914177683, 71.93003297224638, 67.8468899466097, 25.908473186194882, 57.498055558651686, 64.47502301633355, 59.23674361407757, 31.1352364681661, 75.77183066681025, -243.34552690386772, 74.31884603574869, 63.193731967126936, 92.111143656075, 53.15884510288012, 53.11357142776251, 87.7244877833873, 76.9012576639652, 78.43783307075498, 60.91979040950534, 55.018681921064825, 61.58498432114719, 62.836048913188264, 57.6094131019199, 39.364365607500076, 84.8630408840254, 60.438199571333826, 30.730837270617457, 53.52450903505084, 73.5956879481673, 65.12196744047105, 66.8827053308487, 69.46648713760075, 70.6485352516174, 43.85362207144496, 77.17349447682498, 54.37141856440576, 83.42166537884623, 57.56820693053305, 38.86582984868434, 86.89738562330604, 51.80703394114968, 51.32246435433625, 68.79947834834455, 74.030226374045, 89.62383006513119, 81.23272571898997, 44.45967517420648, 68.0182159207761, 56.40532647166401, 68.15246245544404, 82.10610460862517, 78.14319409057495], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 255, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.993622541427612, 18.232120227068663, 17.78689720481634, 23.854832097887993, 23.87453292310238, 23.759617142379284, 28.818129303554684, 28.810335698227078, 28.771881538132817, 16.03397859632969, 16.531172771006823, 16.35345420241356, 27.853136916955307, 27.091318552692726, 27.061625604828194, 19.589941094319016, 19.44515437136093, 19.963565431690455, 22.90633127217491, 22.814866845806435, 22.478367929657296, 23.363226607441902, 22.95812188833952, 23.18109891563654, 8.509532487019897, 8.154230363667011, 8.5004365388304, 22.126828496654824, 22.140631032486752, 21.989109580715493, 29.920400095482663, 30.254553848256663, 30.38002160688241, 24.49243964751561, 24.37667206053932, 24.425925762703017, 22.612144019454718, 22.61224579438567, 22.764340235386044, 26.504123191038758, 26.645560840765626, 26.988153624037892, 26.28839906398207, 26.077836580574512, 26.01097771525383, 21.24165380001068, 20.90647605806589, 20.97128150612116, 19.947830035351217, 19.6494420170784, 19.66259855031967, 23.04757109781106, 22.70734130342801, 22.766021144886807, 21.347185917198658, 21.5968395806849, 21.535375997424126, 19.938471535841614, 20.236402502904326, 20.110378744701535, 22.477323807775974, 22.306969039142132, 22.501855086535215, 27.040207474802926, 27.100915862557784, 27.006682395314172, 25.03695385400593, 24.530175666014344, 24.973244548464805, 25.934454042464495, 25.873043321073055, 26.099369645118713, 25.052337567011506, 28.49281224856773, 28.09232376019159, 19.800950691103935, 20.210756072890945, 19.71954907476902, 15.14611870298782, 15.455523713181407, 15.340450576196105, 18.67587973177433, 18.715532913804054, 19.328278720378876, 27.412604962786034, 26.91523929437001, 27.29052611937125, 28.281208399683237, 28.51090774592012, 28.471729524433613, 21.759956419467926, 22.32699661143124, 22.11426728963852, 20.426764900485665, 20.487238282958657, 20.444022121528775, 28.816610933591917, 28.65955666204293, 28.65973338981469, 24.28890210017562, 24.30327060073614, 24.571048160083592, 18.27643636862436, 19.109620303070784, 18.89161158601442, 5.018875723083809, 5.646382154275969, 5.017361094554261, 18.42542154093583, 18.71276495357354, 19.040433814128235, 2.4699716555575435, 1.4990853617588584, 2.3382480541864936, 15.793029526869446, 16.15371589610973, 15.532692382733018, 6.530811735739306, 6.595801718377814, 6.3826048237582, 8.728140239914254, 9.103616514553622, 9.107253664483622, 7.1533258582154815, 7.223653881500155, 7.081953058640153, 30.617452570547655, 30.87134953624384, 30.32842944314082, 17.425597667694092, 17.204010471701622, 17.70507898554206, 14.832794360816479, 14.985289361327887, 15.012077737599611, 27.337884664535522, 27.505355536937714, 27.856567356735468, 24.80970765898624, 24.86473962167898, 24.198529268304497, 22.641154018541172, 21.71011870106061, 22.786207658549145, 19.01948372522989, 19.11258363785842, 19.12435177868852, 23.129178057114274, 24.37454431752363, 24.426310597608477, 22.421773033837468, 22.74806849161783, 22.67704842115441, 8.56882095833619, 8.722360735138253, 8.61729149272044, 18.893627807497978, 19.373918812721968, 19.23050893843174, 21.723892743388802, 21.740587706367165, 21.010542566577584, 20.198742628097534, 18.929021537303925, 20.10897944867611, 10.344514292975262, 10.70468547319372, 10.086036701997116, 25.414662913108856, 25.41851255359748, 24.93865520010391, -81.4502764493227, -80.98912477493286, -80.90612567961216, 24.879640645037085, 24.688670511047036, 24.75053487966457, 20.81371633460124, 21.24088945340675, 21.139126179118946, 30.680690743029118, 30.914501547813416, 30.515951365232468, 17.976470989330352, 17.44761652002731, 17.73475759352246, 17.681455731391907, 17.83060074597597, 17.60151495039463, 29.25180783867836, 29.2416966650635, 29.230983279645443, 25.383883426586777, 25.66595000276962, 25.8514242346088, 25.942367921272904, 26.24935272211829, 26.246112427363784, 20.07673659423986, 20.469249981145055, 20.373803834120423, 18.300387027362973, 18.212608012060315, 18.505686881641537, 20.650800966269642, 20.662364414039374, 20.271818940838173, 20.783997913201645, 21.219598533896104, 20.832452466090515, 19.242482816490025, 19.10041947166124, 19.266510813768633, 13.186550080776215, 13.09572958946228, 13.082085937261581, 27.83138681948185, 28.435370109975338, 28.596283954568207, 19.928590267896652, 20.030041322112083, 20.47956798132509, 10.220343391100556, 10.387384253243596, 10.123109626273305, 17.90272396678725, 17.73206430176893, 17.889720766494662, 24.403448196748883, 24.529308694104344, 24.66293105731407, 21.625791773200035, 21.582312233746052, 21.913863433524966, 21.550789952278137, 22.696877505630255, 22.635037872940302, 23.374118552232773, 22.98788050065437, 23.10448808471361, 23.14078457156816, 23.849708861360938, 23.658041818688304, 14.573522480825574, 14.480082253615052, 14.800017337004334, 25.9376565379401, 25.565201510985688, 25.670636427899197, 18.169353990233503, 18.172471298312303, 18.029593275859952, 28.161944136954844, 28.04918732494116, 27.210533916950226, 19.370210327208042, 18.726187244057655, 19.471809359267354, 13.251804809706897, 12.616207490364701, 12.997817548612744, 29.0667356364429, 28.802938759326935, 29.0277112275362, 16.203026125828416, 17.864013376335294, 17.739994438985974, 17.215814617772892, 16.83116293450196, 17.275486802061394, 23.033217096080378, 22.9253692527612, 22.840891999502972, 24.828395507608846, 24.76258750011523, 24.439243366320923, 29.940959975123405, 29.70926859974861, 29.97360149025917, 26.93540884554386, 27.108144419267774, 27.189172454178333, 14.808078152438, 14.961328381051615, 14.690268640716866, 22.604714243362338, 22.667753093565494, 22.74574858384827, 18.571515016257763, 19.045037602074444, 18.788773853331804, 22.544579938054085, 22.997849042527378, 22.610033474862576, 27.184642300009727, 27.610158164054155, 27.31130414456129, 26.025883610049874, 26.03521255652109, 26.08209792400399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371861320400693, "mean_inference_ms": 0.7036304407074228, "mean_action_processing_ms": 0.09990161504784, "mean_env_wait_ms": 0.8093356794858281, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1141686, "timesteps_this_iter": 0, "agent_timesteps_total": 3425058, "timers": {"sample_time_ms": 19055.758, "sample_throughput": 503.47, "load_time_ms": 0.096, "load_throughput": 99530429.325, "learn_time_ms": 3015.555, "learn_throughput": 3181.504, "update_time_ms": 8.566}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.195683800389816e-11, "cur_lr": 0.0005, "total_loss": 5.5693307518959045, "policy_loss": -0.0009724798925104805, "vf_loss": 5.717500269412994, "vf_explained_var": 0.08030954003334045, "kl": 0.004579968466882608, "entropy": 14.71969473361969, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1141686, "num_agent_steps_sampled": 3425058, "num_steps_trained": 1141686, "num_agent_steps_trained": 3425058, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4596, "training_iteration": 119, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-23-22", "timestamp": 1706192602, "time_this_iter_s": 21.583033800125122, "time_total_s": 2401.3485651016235, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2401.3485651016235, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 15.043333333333333, "ram_util_percent": 49.45666666666668}}
{"episode_reward_max": 92.111143656075, "episode_reward_min": -243.34552690386772, "episode_reward_mean": 60.385484343319185, "episode_len_mean": 299.55, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -81.4502764493227}, "policy_reward_max": {"shared_policy": 30.914501547813416}, "policy_reward_mean": {"shared_policy": 20.12849478110639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.16322086099535, 56.277668257709564, 15.682618971914039, 56.178620308637605, 6.3073050715028955, 47.479437805712195, 19.50921827787532, 26.939010418951497, 21.45893279835579, 91.81723154993232, 52.33468712493777, 44.83016145974398, 82.6998075582087, 73.87297654896972, 67.13748037815093, 57.25641914177683, 71.93003297224638, 67.8468899466097, 25.908473186194882, 57.498055558651686, 64.47502301633355, 59.23674361407757, 31.1352364681661, 75.77183066681025, -243.34552690386772, 74.31884603574869, 63.193731967126936, 92.111143656075, 53.15884510288012, 53.11357142776251, 87.7244877833873, 76.9012576639652, 78.43783307075498, 60.91979040950534, 55.018681921064825, 61.58498432114719, 62.836048913188264, 57.6094131019199, 39.364365607500076, 84.8630408840254, 60.438199571333826, 30.730837270617457, 53.52450903505084, 73.5956879481673, 65.12196744047105, 66.8827053308487, 69.46648713760075, 70.6485352516174, 43.85362207144496, 77.17349447682498, 54.37141856440576, 83.42166537884623, 57.56820693053305, 38.86582984868434, 86.89738562330604, 51.80703394114968, 51.32246435433625, 68.79947834834455, 74.030226374045, 89.62383006513119, 81.23272571898997, 44.45967517420648, 68.0182159207761, 56.40532647166401, 68.15246245544404, 82.10610460862517, 78.14319409057495, 36.937545272521646, 75.72444781847295, 86.4990942524746, 56.33938986808059, 42.50896110013126, 72.7113166153431, 69.25491271167992, 74.74402680993079, 72.11146594583987, 86.8848887607455, 87.30214268714188, 63.79427618347107, 81.64916189946233, 68.75987046188675, 70.52235214225948, 32.74096325226125, 89.31159923039374, 78.4660222828388, 78.72813350707293, 87.3436936624348, 64.07826754264534, 63.35219181329009, 90.28499894589186, 42.74946304457262, 72.10854457123786, 61.340992085635634, 64.58251343294978, 67.47463701199739, 61.776044033467755, 52.60125208925453, 73.75728796422479, 76.49986565578727, 84.38922534883022], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 255, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.28890210017562, 24.30327060073614, 24.571048160083592, 18.27643636862436, 19.109620303070784, 18.89161158601442, 5.018875723083809, 5.646382154275969, 5.017361094554261, 18.42542154093583, 18.71276495357354, 19.040433814128235, 2.4699716555575435, 1.4990853617588584, 2.3382480541864936, 15.793029526869446, 16.15371589610973, 15.532692382733018, 6.530811735739306, 6.595801718377814, 6.3826048237582, 8.728140239914254, 9.103616514553622, 9.107253664483622, 7.1533258582154815, 7.223653881500155, 7.081953058640153, 30.617452570547655, 30.87134953624384, 30.32842944314082, 17.425597667694092, 17.204010471701622, 17.70507898554206, 14.832794360816479, 14.985289361327887, 15.012077737599611, 27.337884664535522, 27.505355536937714, 27.856567356735468, 24.80970765898624, 24.86473962167898, 24.198529268304497, 22.641154018541172, 21.71011870106061, 22.786207658549145, 19.01948372522989, 19.11258363785842, 19.12435177868852, 23.129178057114274, 24.37454431752363, 24.426310597608477, 22.421773033837468, 22.74806849161783, 22.67704842115441, 8.56882095833619, 8.722360735138253, 8.61729149272044, 18.893627807497978, 19.373918812721968, 19.23050893843174, 21.723892743388802, 21.740587706367165, 21.010542566577584, 20.198742628097534, 18.929021537303925, 20.10897944867611, 10.344514292975262, 10.70468547319372, 10.086036701997116, 25.414662913108856, 25.41851255359748, 24.93865520010391, -81.4502764493227, -80.98912477493286, -80.90612567961216, 24.879640645037085, 24.688670511047036, 24.75053487966457, 20.81371633460124, 21.24088945340675, 21.139126179118946, 30.680690743029118, 30.914501547813416, 30.515951365232468, 17.976470989330352, 17.44761652002731, 17.73475759352246, 17.681455731391907, 17.83060074597597, 17.60151495039463, 29.25180783867836, 29.2416966650635, 29.230983279645443, 25.383883426586777, 25.66595000276962, 25.8514242346088, 25.942367921272904, 26.24935272211829, 26.246112427363784, 20.07673659423986, 20.469249981145055, 20.373803834120423, 18.300387027362973, 18.212608012060315, 18.505686881641537, 20.650800966269642, 20.662364414039374, 20.271818940838173, 20.783997913201645, 21.219598533896104, 20.832452466090515, 19.242482816490025, 19.10041947166124, 19.266510813768633, 13.186550080776215, 13.09572958946228, 13.082085937261581, 27.83138681948185, 28.435370109975338, 28.596283954568207, 19.928590267896652, 20.030041322112083, 20.47956798132509, 10.220343391100556, 10.387384253243596, 10.123109626273305, 17.90272396678725, 17.73206430176893, 17.889720766494662, 24.403448196748883, 24.529308694104344, 24.66293105731407, 21.625791773200035, 21.582312233746052, 21.913863433524966, 21.550789952278137, 22.696877505630255, 22.635037872940302, 23.374118552232773, 22.98788050065437, 23.10448808471361, 23.14078457156816, 23.849708861360938, 23.658041818688304, 14.573522480825574, 14.480082253615052, 14.800017337004334, 25.9376565379401, 25.565201510985688, 25.670636427899197, 18.169353990233503, 18.172471298312303, 18.029593275859952, 28.161944136954844, 28.04918732494116, 27.210533916950226, 19.370210327208042, 18.726187244057655, 19.471809359267354, 13.251804809706897, 12.616207490364701, 12.997817548612744, 29.0667356364429, 28.802938759326935, 29.0277112275362, 16.203026125828416, 17.864013376335294, 17.739994438985974, 17.215814617772892, 16.83116293450196, 17.275486802061394, 23.033217096080378, 22.9253692527612, 22.840891999502972, 24.828395507608846, 24.76258750011523, 24.439243366320923, 29.940959975123405, 29.70926859974861, 29.97360149025917, 26.93540884554386, 27.108144419267774, 27.189172454178333, 14.808078152438, 14.961328381051615, 14.690268640716866, 22.604714243362338, 22.667753093565494, 22.74574858384827, 18.571515016257763, 19.045037602074444, 18.788773853331804, 22.544579938054085, 22.997849042527378, 22.610033474862576, 27.184642300009727, 27.610158164054155, 27.31130414456129, 26.025883610049874, 26.03521255652109, 26.08209792400399, 12.11836955199638, 12.560610754104943, 12.258564966420323, 25.26605240131417, 25.033223191897065, 25.42517222526172, 28.907892083749175, 28.5889490544796, 29.002253114245832, 18.735372635225445, 18.67505012700954, 18.9289671058456, 14.571928316106394, 13.826700215538338, 14.110332568486527, 24.26591408997774, 23.83962133526802, 24.605781190097332, 23.201752086480454, 23.138753963013485, 22.914406662185982, 25.044599672158554, 24.748099644978836, 24.951327492793396, 23.76239479084809, 24.36896350731452, 23.980107647677258, 29.057409622396023, 29.075515892977506, 28.751963245371968, 28.76880421241124, 29.261991185446576, 29.271347289284066, 21.48988422316809, 21.049298134942845, 21.255093825360134, 26.968362485369042, 27.583523034428552, 27.097276379664734, 22.9936198964715, 22.54711788892746, 23.21913267648779, 23.61939685791731, 23.359219919890165, 23.543735364452004, 10.973179899776966, 10.838031033674866, 10.92975231880942, 29.31876220802465, 29.908682993302733, 30.084154029066354, 26.23332944015661, 26.247233080367238, 25.985459762314946, 26.2025256305933, 25.98491734266281, 26.540690533816814, 29.10744796444972, 29.032128406067685, 29.2041172919174, 21.341430079191923, 21.129831410944462, 21.60700605250895, 21.181557616839797, 21.2291725638012, 20.941461632649094, 29.994248874485493, 30.13998282700777, 30.150767244398594, 13.947747111320496, 14.499764606822282, 14.301951326429844, 23.827871469159916, 24.28682639006486, 23.99384671201308, 20.188578481475503, 20.66612448791662, 20.486289116243512, 21.757469665259123, 21.532678738236427, 21.29236502945423, 22.459895854194954, 22.66387218267967, 22.350868975122765, 20.652975899477795, 20.555054930349186, 20.568013203640774, 17.734613658549875, 17.67549010242024, 17.191148328284413, 24.457232924799115, 24.515971737603337, 24.784083301822335, 25.363292557497815, 25.477705684800938, 25.658867413488522, 28.38629039376974, 27.870571225881577, 28.132363729178905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537291142411915, "mean_inference_ms": 0.7037532134950782, "mean_action_processing_ms": 0.09994871700188643, "mean_env_wait_ms": 0.8094868294213876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1151280, "timesteps_this_iter": 0, "agent_timesteps_total": 3453840, "timers": {"sample_time_ms": 19245.694, "sample_throughput": 498.501, "load_time_ms": 0.196, "load_throughput": 48852922.88, "learn_time_ms": 3043.933, "learn_throughput": 3151.843, "update_time_ms": 8.165}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.097841900194908e-11, "cur_lr": 0.0005, "total_loss": 6.445262014865875, "policy_loss": -0.00019982827865794306, "vf_loss": 6.5927170515060425, "vf_explained_var": 0.07969832420349121, "kl": 0.005341741605830136, "entropy": 14.725512504577637, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1151280, "num_agent_steps_sampled": 3453840, "num_steps_trained": 1151280, "num_agent_steps_trained": 3453840, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4629, "training_iteration": 120, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-23-42", "timestamp": 1706192622, "time_this_iter_s": 20.458723545074463, "time_total_s": 2421.807288646698, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175CB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2421.807288646698, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 14.127586206896549, "ram_util_percent": 49.44482758620689}}
{"episode_reward_max": 105.95623175054786, "episode_reward_min": -239.76959723234177, "episode_reward_mean": 64.11690512672881, "episode_len_mean": 299.82, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -80.03257071971893}, "policy_reward_max": {"shared_policy": 35.52075512210527}, "policy_reward_mean": {"shared_policy": 21.3723017089096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.9012576639652, 78.43783307075498, 60.91979040950534, 55.018681921064825, 61.58498432114719, 62.836048913188264, 57.6094131019199, 39.364365607500076, 84.8630408840254, 60.438199571333826, 30.730837270617457, 53.52450903505084, 73.5956879481673, 65.12196744047105, 66.8827053308487, 69.46648713760075, 70.6485352516174, 43.85362207144496, 77.17349447682498, 54.37141856440576, 83.42166537884623, 57.56820693053305, 38.86582984868434, 86.89738562330604, 51.80703394114968, 51.32246435433625, 68.79947834834455, 74.030226374045, 89.62383006513119, 81.23272571898997, 44.45967517420648, 68.0182159207761, 56.40532647166401, 68.15246245544404, 82.10610460862517, 78.14319409057495, 36.937545272521646, 75.72444781847295, 86.4990942524746, 56.33938986808059, 42.50896110013126, 72.7113166153431, 69.25491271167992, 74.74402680993079, 72.11146594583987, 86.8848887607455, 87.30214268714188, 63.79427618347107, 81.64916189946233, 68.75987046188675, 70.52235214225948, 32.74096325226125, 89.31159923039374, 78.4660222828388, 78.72813350707293, 87.3436936624348, 64.07826754264534, 63.35219181329009, 90.28499894589186, 42.74946304457262, 72.10854457123786, 61.340992085635634, 64.58251343294978, 67.47463701199739, 61.776044033467755, 52.60125208925453, 73.75728796422479, 76.49986565578727, 84.38922534883022, -22.238773766905098, -239.76959723234177, 93.70659305900334, 80.38138236850497, 84.53909080475566, 58.70107232779263, 72.27034929767248, 77.62978234514594, 71.58152034692466, 47.69385712593791, 47.899338845163555, 70.53937220177612, 70.71041140332817, 67.42782511562108, 52.3696567597799, 88.26179008002508, 67.9498496837914, 61.79526606947181, 84.99912303313613, 74.39536862447858, 60.69794049859047, 87.94804628565905, 73.32868667785075, 56.72356100380421, 72.27998468838629, 82.91819875314829, 105.95623175054786, 58.977151375263915, 62.63113828003404, 75.70303671061993, 52.15700485557316], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 282, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.383883426586777, 25.66595000276962, 25.8514242346088, 25.942367921272904, 26.24935272211829, 26.246112427363784, 20.07673659423986, 20.469249981145055, 20.373803834120423, 18.300387027362973, 18.212608012060315, 18.505686881641537, 20.650800966269642, 20.662364414039374, 20.271818940838173, 20.783997913201645, 21.219598533896104, 20.832452466090515, 19.242482816490025, 19.10041947166124, 19.266510813768633, 13.186550080776215, 13.09572958946228, 13.082085937261581, 27.83138681948185, 28.435370109975338, 28.596283954568207, 19.928590267896652, 20.030041322112083, 20.47956798132509, 10.220343391100556, 10.387384253243596, 10.123109626273305, 17.90272396678725, 17.73206430176893, 17.889720766494662, 24.403448196748883, 24.529308694104344, 24.66293105731407, 21.625791773200035, 21.582312233746052, 21.913863433524966, 21.550789952278137, 22.696877505630255, 22.635037872940302, 23.374118552232773, 22.98788050065437, 23.10448808471361, 23.14078457156816, 23.849708861360938, 23.658041818688304, 14.573522480825574, 14.480082253615052, 14.800017337004334, 25.9376565379401, 25.565201510985688, 25.670636427899197, 18.169353990233503, 18.172471298312303, 18.029593275859952, 28.161944136954844, 28.04918732494116, 27.210533916950226, 19.370210327208042, 18.726187244057655, 19.471809359267354, 13.251804809706897, 12.616207490364701, 12.997817548612744, 29.0667356364429, 28.802938759326935, 29.0277112275362, 16.203026125828416, 17.864013376335294, 17.739994438985974, 17.215814617772892, 16.83116293450196, 17.275486802061394, 23.033217096080378, 22.9253692527612, 22.840891999502972, 24.828395507608846, 24.76258750011523, 24.439243366320923, 29.940959975123405, 29.70926859974861, 29.97360149025917, 26.93540884554386, 27.108144419267774, 27.189172454178333, 14.808078152438, 14.961328381051615, 14.690268640716866, 22.604714243362338, 22.667753093565494, 22.74574858384827, 18.571515016257763, 19.045037602074444, 18.788773853331804, 22.544579938054085, 22.997849042527378, 22.610033474862576, 27.184642300009727, 27.610158164054155, 27.31130414456129, 26.025883610049874, 26.03521255652109, 26.08209792400399, 12.11836955199638, 12.560610754104943, 12.258564966420323, 25.26605240131417, 25.033223191897065, 25.42517222526172, 28.907892083749175, 28.5889490544796, 29.002253114245832, 18.735372635225445, 18.67505012700954, 18.9289671058456, 14.571928316106394, 13.826700215538338, 14.110332568486527, 24.26591408997774, 23.83962133526802, 24.605781190097332, 23.201752086480454, 23.138753963013485, 22.914406662185982, 25.044599672158554, 24.748099644978836, 24.951327492793396, 23.76239479084809, 24.36896350731452, 23.980107647677258, 29.057409622396023, 29.075515892977506, 28.751963245371968, 28.76880421241124, 29.261991185446576, 29.271347289284066, 21.48988422316809, 21.049298134942845, 21.255093825360134, 26.968362485369042, 27.583523034428552, 27.097276379664734, 22.9936198964715, 22.54711788892746, 23.21913267648779, 23.61939685791731, 23.359219919890165, 23.543735364452004, 10.973179899776966, 10.838031033674866, 10.92975231880942, 29.31876220802465, 29.908682993302733, 30.084154029066354, 26.23332944015661, 26.247233080367238, 25.985459762314946, 26.2025256305933, 25.98491734266281, 26.540690533816814, 29.10744796444972, 29.032128406067685, 29.2041172919174, 21.341430079191923, 21.129831410944462, 21.60700605250895, 21.181557616839797, 21.2291725638012, 20.941461632649094, 29.994248874485493, 30.13998282700777, 30.150767244398594, 13.947747111320496, 14.499764606822282, 14.301951326429844, 23.827871469159916, 24.28682639006486, 23.99384671201308, 20.188578481475503, 20.66612448791662, 20.486289116243512, 21.757469665259123, 21.532678738236427, 21.29236502945423, 22.459895854194954, 22.66387218267967, 22.350868975122765, 20.652975899477795, 20.555054930349186, 20.568013203640774, 17.734613658549875, 17.67549010242024, 17.191148328284413, 24.457232924799115, 24.515971737603337, 24.784083301822335, 25.363292557497815, 25.477705684800938, 25.658867413488522, 28.38629039376974, 27.870571225881577, 28.132363729178905, -7.367935673644155, -7.39864266415438, -7.472195429106563, -79.95541105419397, -79.78161545842886, -80.03257071971893, 31.495322210093335, 30.979688723882035, 31.23158212502797, 26.864666963616997, 26.85608825335899, 26.660627151528985, 28.026504168907792, 28.298079955081135, 28.214506680766732, 19.69071678568919, 19.668508132298783, 19.341847409804657, 24.21843798706928, 24.461669138322264, 23.590242172280938, 25.76926915347576, 25.588464498519897, 26.272048693150282, 23.371316701173782, 24.02890043705702, 24.181303208693862, 15.735003570715577, 15.818704063693673, 16.14014949152866, 16.063856488714606, 16.14396198342243, 15.69152037302652, 23.69966010850233, 23.50354968508084, 23.336162408192948, 23.443044056495026, 23.41114555050929, 23.85622179632385, 22.34869624425967, 22.514210631450013, 22.564918239911393, 17.35330604761839, 17.73540377197787, 17.28094694018364, 29.305915412803486, 29.60275975183079, 29.353114915390805, 22.879943940788507, 22.74096444249153, 22.32894130051136, 20.689719947675854, 20.557139510909707, 20.548406610886246, 28.142145544290543, 28.481801122426987, 28.3751763664186, 24.52354547381401, 24.807701230049133, 25.064121920615435, 19.988499477505684, 20.34915440529585, 20.360286615788937, 28.773405010501534, 29.539427774647862, 29.63521350050965, 24.68239366232106, 24.175215947131306, 24.471077068398387, 18.79400673508644, 19.351852044463158, 18.577702224254608, 24.29348445745805, 23.727489824096352, 24.25901040683189, 27.459796677033097, 27.649542997280747, 27.808859078834445, 35.52075512210527, 35.07819309333959, 35.357283535102994, 19.77173315112789, 19.60729196419318, 19.598126259942845, 20.556712279717118, 21.15489626179138, 20.91952973852554, 25.239316076040268, 25.358947552740574, 25.104773081839085, 17.58784371366103, 17.5722575088342, 16.996903633077935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382420576990133, "mean_inference_ms": 0.7040028611843515, "mean_action_processing_ms": 0.0999811779897049, "mean_env_wait_ms": 0.8097714799263105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1160874, "timesteps_this_iter": 0, "agent_timesteps_total": 3482622, "timers": {"sample_time_ms": 19484.769, "sample_throughput": 492.385, "load_time_ms": 0.296, "load_throughput": 32360396.121, "learn_time_ms": 3084.865, "learn_throughput": 3110.022, "update_time_ms": 8.261}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.097841900194908e-11, "cur_lr": 0.0005, "total_loss": 66.07178688049316, "policy_loss": 0.00047706809169656417, "vf_loss": 66.2189998626709, "vf_explained_var": 0.02285553514957428, "kl": 0.00813384656811368, "entropy": 14.7690349817276, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1160874, "num_agent_steps_sampled": 3482622, "num_steps_trained": 1160874, "num_agent_steps_trained": 3482622, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4660, "training_iteration": 121, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-24-04", "timestamp": 1706192644, "time_this_iter_s": 21.24341654777527, "time_total_s": 2443.0507051944733, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2443.0507051944733, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 16.999999999999996, "ram_util_percent": 49.513333333333335}}
{"episode_reward_max": 105.95623175054786, "episode_reward_min": -239.76959723234177, "episode_reward_mean": 66.94327711340448, "episode_len_mean": 299.82, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -80.03257071971893}, "policy_reward_max": {"shared_policy": 35.52075512210527}, "policy_reward_mean": {"shared_policy": 22.314425704468153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.10610460862517, 78.14319409057495, 36.937545272521646, 75.72444781847295, 86.4990942524746, 56.33938986808059, 42.50896110013126, 72.7113166153431, 69.25491271167992, 74.74402680993079, 72.11146594583987, 86.8848887607455, 87.30214268714188, 63.79427618347107, 81.64916189946233, 68.75987046188675, 70.52235214225948, 32.74096325226125, 89.31159923039374, 78.4660222828388, 78.72813350707293, 87.3436936624348, 64.07826754264534, 63.35219181329009, 90.28499894589186, 42.74946304457262, 72.10854457123786, 61.340992085635634, 64.58251343294978, 67.47463701199739, 61.776044033467755, 52.60125208925453, 73.75728796422479, 76.49986565578727, 84.38922534883022, -22.238773766905098, -239.76959723234177, 93.70659305900334, 80.38138236850497, 84.53909080475566, 58.70107232779263, 72.27034929767248, 77.62978234514594, 71.58152034692466, 47.69385712593791, 47.899338845163555, 70.53937220177612, 70.71041140332817, 67.42782511562108, 52.3696567597799, 88.26179008002508, 67.9498496837914, 61.79526606947181, 84.99912303313613, 74.39536862447858, 60.69794049859047, 87.94804628565905, 73.32868667785075, 56.72356100380421, 72.27998468838629, 82.91819875314829, 105.95623175054786, 58.977151375263915, 62.63113828003404, 75.70303671061993, 52.15700485557316, 71.45558228716254, 83.65529239363966, 80.57284053601325, 87.49700073152778, 85.42358087748286, 79.55266796424985, 68.09082576632497, 64.87579403817654, 67.56381289102134, 79.33375693671404, 86.8110444508493, 77.29201067611575, 83.84644612483679, 64.82086241245268, 70.85714732296762, 49.20486121624707, 66.77614507358518, 71.51043353229758, 73.91360774729401, 47.94427370652555, 65.04995094612238, 68.37843312136826, 64.84373544063419, 81.9088924899697, 91.02004963532089, 88.9051807299256, 91.23773724026977, 78.4372857492417, 69.80970827676356, -4.917525179684191, 90.43386578187346, 62.14376384764907, 81.8368601463735, 56.49868035316466], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 282, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.184642300009727, 27.610158164054155, 27.31130414456129, 26.025883610049874, 26.03521255652109, 26.08209792400399, 12.11836955199638, 12.560610754104943, 12.258564966420323, 25.26605240131417, 25.033223191897065, 25.42517222526172, 28.907892083749175, 28.5889490544796, 29.002253114245832, 18.735372635225445, 18.67505012700954, 18.9289671058456, 14.571928316106394, 13.826700215538338, 14.110332568486527, 24.26591408997774, 23.83962133526802, 24.605781190097332, 23.201752086480454, 23.138753963013485, 22.914406662185982, 25.044599672158554, 24.748099644978836, 24.951327492793396, 23.76239479084809, 24.36896350731452, 23.980107647677258, 29.057409622396023, 29.075515892977506, 28.751963245371968, 28.76880421241124, 29.261991185446576, 29.271347289284066, 21.48988422316809, 21.049298134942845, 21.255093825360134, 26.968362485369042, 27.583523034428552, 27.097276379664734, 22.9936198964715, 22.54711788892746, 23.21913267648779, 23.61939685791731, 23.359219919890165, 23.543735364452004, 10.973179899776966, 10.838031033674866, 10.92975231880942, 29.31876220802465, 29.908682993302733, 30.084154029066354, 26.23332944015661, 26.247233080367238, 25.985459762314946, 26.2025256305933, 25.98491734266281, 26.540690533816814, 29.10744796444972, 29.032128406067685, 29.2041172919174, 21.341430079191923, 21.129831410944462, 21.60700605250895, 21.181557616839797, 21.2291725638012, 20.941461632649094, 29.994248874485493, 30.13998282700777, 30.150767244398594, 13.947747111320496, 14.499764606822282, 14.301951326429844, 23.827871469159916, 24.28682639006486, 23.99384671201308, 20.188578481475503, 20.66612448791662, 20.486289116243512, 21.757469665259123, 21.532678738236427, 21.29236502945423, 22.459895854194954, 22.66387218267967, 22.350868975122765, 20.652975899477795, 20.555054930349186, 20.568013203640774, 17.734613658549875, 17.67549010242024, 17.191148328284413, 24.457232924799115, 24.515971737603337, 24.784083301822335, 25.363292557497815, 25.477705684800938, 25.658867413488522, 28.38629039376974, 27.870571225881577, 28.132363729178905, -7.367935673644155, -7.39864266415438, -7.472195429106563, -79.95541105419397, -79.78161545842886, -80.03257071971893, 31.495322210093335, 30.979688723882035, 31.23158212502797, 26.864666963616997, 26.85608825335899, 26.660627151528985, 28.026504168907792, 28.298079955081135, 28.214506680766732, 19.69071678568919, 19.668508132298783, 19.341847409804657, 24.21843798706928, 24.461669138322264, 23.590242172280938, 25.76926915347576, 25.588464498519897, 26.272048693150282, 23.371316701173782, 24.02890043705702, 24.181303208693862, 15.735003570715577, 15.818704063693673, 16.14014949152866, 16.063856488714606, 16.14396198342243, 15.69152037302652, 23.69966010850233, 23.50354968508084, 23.336162408192948, 23.443044056495026, 23.41114555050929, 23.85622179632385, 22.34869624425967, 22.514210631450013, 22.564918239911393, 17.35330604761839, 17.73540377197787, 17.28094694018364, 29.305915412803486, 29.60275975183079, 29.353114915390805, 22.879943940788507, 22.74096444249153, 22.32894130051136, 20.689719947675854, 20.557139510909707, 20.548406610886246, 28.142145544290543, 28.481801122426987, 28.3751763664186, 24.52354547381401, 24.807701230049133, 25.064121920615435, 19.988499477505684, 20.34915440529585, 20.360286615788937, 28.773405010501534, 29.539427774647862, 29.63521350050965, 24.68239366232106, 24.175215947131306, 24.471077068398387, 18.79400673508644, 19.351852044463158, 18.577702224254608, 24.29348445745805, 23.727489824096352, 24.25901040683189, 27.459796677033097, 27.649542997280747, 27.808859078834445, 35.52075512210527, 35.07819309333959, 35.357283535102994, 19.77173315112789, 19.60729196419318, 19.598126259942845, 20.556712279717118, 21.15489626179138, 20.91952973852554, 25.239316076040268, 25.358947552740574, 25.104773081839085, 17.58784371366103, 17.5722575088342, 16.996903633077935, 23.29112522304058, 23.985251486301422, 24.17920557782054, 27.858220386008412, 27.881342741350323, 27.91572926628092, 26.68094927817583, 26.868422351777554, 27.02346890605986, 29.32892038176456, 29.062137144307286, 29.10594320545593, 28.370734373728425, 28.60939252624908, 28.443453977505357, 25.862705379724503, 26.66671373695135, 27.023248847573996, 21.800783554712922, 23.108941855529935, 23.181100356082112, 21.763135462999344, 21.80106808245182, 21.311590492725372, 22.62790201852718, 22.284124741951615, 22.651786130542547, 26.417005257060126, 26.318576549490288, 26.598175130163625, 28.55022831261158, 29.150343373417854, 29.11047276481986, 26.044421929866076, 25.544336929917336, 25.70325181633234, 27.525840391715363, 28.132376390819744, 28.188229342301682, 21.706357200940445, 21.47174933304389, 21.64275587846835, 24.045809075857193, 23.79422844077149, 23.017109806338937, 16.30063235511382, 16.474565004309014, 16.429663856824234, 22.20574540893236, 22.25841172846654, 22.311987936186284, 23.819304815183074, 23.745501990119607, 23.945626726994902, 23.97366765141487, 25.013368331827223, 24.926571764051914, 16.08321902652581, 16.089255356540278, 15.771799323459462, 21.673074445376784, 21.7397358889381, 21.637140611807496, 22.70769254366556, 22.666349756220967, 23.004390821481735, 21.846188343130052, 21.573004446923733, 21.424542650580406, 27.02075823644796, 27.396978619197995, 27.491155634323746, 30.15050672491391, 30.682739191999033, 30.186803718407944, 29.717118466893822, 29.473457957307488, 29.714604305724293, 30.251941343148545, 30.38912083705266, 30.596675060068563, 26.170337622364357, 26.35865025532742, 25.90829787154992, 23.45253768004477, 23.249312318861485, 23.107858277857304, -1.8439872985084946, -1.294660237928241, -1.778877643247455, 30.1230249106884, 30.113321013748646, 30.19751985743642, 21.030297274390847, 20.681665721038968, 20.431800852219254, 27.43559045841296, 26.91067339976628, 27.490596288194254, 19.16158378620942, 18.65801491340001, 18.67908165355523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539065615408568, "mean_inference_ms": 0.704272118490702, "mean_action_processing_ms": 0.10001925140019008, "mean_env_wait_ms": 0.8100511440963595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1170468, "timesteps_this_iter": 0, "agent_timesteps_total": 3511404, "timers": {"sample_time_ms": 19765.344, "sample_throughput": 485.395, "load_time_ms": 0.2, "load_throughput": 47950610.791, "learn_time_ms": 3119.732, "learn_throughput": 3075.264, "update_time_ms": 8.708}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.097841900194908e-11, "cur_lr": 0.0005, "total_loss": 6.693052113056183, "policy_loss": 0.0021470327369929043, "vf_loss": 6.837038040161133, "vf_explained_var": 0.15407824516296387, "kl": 0.008845075877782261, "entropy": 14.613298058509827, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1170468, "num_agent_steps_sampled": 3511404, "num_steps_trained": 1170468, "num_agent_steps_trained": 3511404, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4694, "training_iteration": 122, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-24-25", "timestamp": 1706192665, "time_this_iter_s": 21.73738956451416, "time_total_s": 2464.7880947589874, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02064430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2464.7880947589874, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 14.416666666666664, "ram_util_percent": 49.54333333333333}}
{"episode_reward_max": 118.92870333604515, "episode_reward_min": -239.76959723234177, "episode_reward_mean": 67.5234428917084, "episode_len_mean": 299.82, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -80.03257071971893}, "policy_reward_max": {"shared_policy": 39.73227653838694}, "policy_reward_mean": {"shared_policy": 22.507814297236127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.47463701199739, 61.776044033467755, 52.60125208925453, 73.75728796422479, 76.49986565578727, 84.38922534883022, -22.238773766905098, -239.76959723234177, 93.70659305900334, 80.38138236850497, 84.53909080475566, 58.70107232779263, 72.27034929767248, 77.62978234514594, 71.58152034692466, 47.69385712593791, 47.899338845163555, 70.53937220177612, 70.71041140332817, 67.42782511562108, 52.3696567597799, 88.26179008002508, 67.9498496837914, 61.79526606947181, 84.99912303313613, 74.39536862447858, 60.69794049859047, 87.94804628565905, 73.32868667785075, 56.72356100380421, 72.27998468838629, 82.91819875314829, 105.95623175054786, 58.977151375263915, 62.63113828003404, 75.70303671061993, 52.15700485557316, 71.45558228716254, 83.65529239363966, 80.57284053601325, 87.49700073152778, 85.42358087748286, 79.55266796424985, 68.09082576632497, 64.87579403817654, 67.56381289102134, 79.33375693671404, 86.8110444508493, 77.29201067611575, 83.84644612483679, 64.82086241245268, 70.85714732296762, 49.20486121624707, 66.77614507358518, 71.51043353229758, 73.91360774729401, 47.94427370652555, 65.04995094612238, 68.37843312136826, 64.84373544063419, 81.9088924899697, 91.02004963532089, 88.9051807299256, 91.23773724026977, 78.4372857492417, 69.80970827676356, -4.917525179684191, 90.43386578187346, 62.14376384764907, 81.8368601463735, 56.49868035316466, 89.70423496514557, 46.34700905531645, 82.10017524007706, 96.27093688491729, 80.03181941155343, 65.10058430209753, 100.44373026490209, 65.57627169042826, 63.3263350315392, 74.31131952628493, 63.84359500557183, 7.360776506364317, 91.27540141344069, 76.34496958181262, 84.14904770813882, 62.93847224116324, 68.15247482992706, 118.92870333604515, 55.86807470209895, 87.72477288544175, 48.42066129297018, 71.64529640600084, 73.50548783317208, 70.9593841359019, 63.50489384587851, 85.23711374402046, 55.55028823018071, 86.92345628514886, 53.5518260747194], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 282, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.459895854194954, 22.66387218267967, 22.350868975122765, 20.652975899477795, 20.555054930349186, 20.568013203640774, 17.734613658549875, 17.67549010242024, 17.191148328284413, 24.457232924799115, 24.515971737603337, 24.784083301822335, 25.363292557497815, 25.477705684800938, 25.658867413488522, 28.38629039376974, 27.870571225881577, 28.132363729178905, -7.367935673644155, -7.39864266415438, -7.472195429106563, -79.95541105419397, -79.78161545842886, -80.03257071971893, 31.495322210093335, 30.979688723882035, 31.23158212502797, 26.864666963616997, 26.85608825335899, 26.660627151528985, 28.026504168907792, 28.298079955081135, 28.214506680766732, 19.69071678568919, 19.668508132298783, 19.341847409804657, 24.21843798706928, 24.461669138322264, 23.590242172280938, 25.76926915347576, 25.588464498519897, 26.272048693150282, 23.371316701173782, 24.02890043705702, 24.181303208693862, 15.735003570715577, 15.818704063693673, 16.14014949152866, 16.063856488714606, 16.14396198342243, 15.69152037302652, 23.69966010850233, 23.50354968508084, 23.336162408192948, 23.443044056495026, 23.41114555050929, 23.85622179632385, 22.34869624425967, 22.514210631450013, 22.564918239911393, 17.35330604761839, 17.73540377197787, 17.28094694018364, 29.305915412803486, 29.60275975183079, 29.353114915390805, 22.879943940788507, 22.74096444249153, 22.32894130051136, 20.689719947675854, 20.557139510909707, 20.548406610886246, 28.142145544290543, 28.481801122426987, 28.3751763664186, 24.52354547381401, 24.807701230049133, 25.064121920615435, 19.988499477505684, 20.34915440529585, 20.360286615788937, 28.773405010501534, 29.539427774647862, 29.63521350050965, 24.68239366232106, 24.175215947131306, 24.471077068398387, 18.79400673508644, 19.351852044463158, 18.577702224254608, 24.29348445745805, 23.727489824096352, 24.25901040683189, 27.459796677033097, 27.649542997280747, 27.808859078834445, 35.52075512210527, 35.07819309333959, 35.357283535102994, 19.77173315112789, 19.60729196419318, 19.598126259942845, 20.556712279717118, 21.15489626179138, 20.91952973852554, 25.239316076040268, 25.358947552740574, 25.104773081839085, 17.58784371366103, 17.5722575088342, 16.996903633077935, 23.29112522304058, 23.985251486301422, 24.17920557782054, 27.858220386008412, 27.881342741350323, 27.91572926628092, 26.68094927817583, 26.868422351777554, 27.02346890605986, 29.32892038176456, 29.062137144307286, 29.10594320545593, 28.370734373728425, 28.60939252624908, 28.443453977505357, 25.862705379724503, 26.66671373695135, 27.023248847573996, 21.800783554712922, 23.108941855529935, 23.181100356082112, 21.763135462999344, 21.80106808245182, 21.311590492725372, 22.62790201852718, 22.284124741951615, 22.651786130542547, 26.417005257060126, 26.318576549490288, 26.598175130163625, 28.55022831261158, 29.150343373417854, 29.11047276481986, 26.044421929866076, 25.544336929917336, 25.70325181633234, 27.525840391715363, 28.132376390819744, 28.188229342301682, 21.706357200940445, 21.47174933304389, 21.64275587846835, 24.045809075857193, 23.79422844077149, 23.017109806338937, 16.30063235511382, 16.474565004309014, 16.429663856824234, 22.20574540893236, 22.25841172846654, 22.311987936186284, 23.819304815183074, 23.745501990119607, 23.945626726994902, 23.97366765141487, 25.013368331827223, 24.926571764051914, 16.08321902652581, 16.089255356540278, 15.771799323459462, 21.673074445376784, 21.7397358889381, 21.637140611807496, 22.70769254366556, 22.666349756220967, 23.004390821481735, 21.846188343130052, 21.573004446923733, 21.424542650580406, 27.02075823644796, 27.396978619197995, 27.491155634323746, 30.15050672491391, 30.682739191999033, 30.186803718407944, 29.717118466893822, 29.473457957307488, 29.714604305724293, 30.251941343148545, 30.38912083705266, 30.596675060068563, 26.170337622364357, 26.35865025532742, 25.90829787154992, 23.45253768004477, 23.249312318861485, 23.107858277857304, -1.8439872985084946, -1.294660237928241, -1.778877643247455, 30.1230249106884, 30.113321013748646, 30.19751985743642, 21.030297274390847, 20.681665721038968, 20.431800852219254, 27.43559045841296, 26.91067339976628, 27.490596288194254, 19.16158378620942, 18.65801491340001, 18.67908165355523, 30.08496943612893, 29.695170556505516, 29.924094972511128, 15.303032286465168, 15.321129597723484, 15.722847171127796, 27.690934216914073, 27.164037329455212, 27.24520369370778, 32.60987149520466, 31.936191538969666, 31.724873850742966, 26.551731516917542, 26.9549379631256, 26.525149931510285, 21.51761137942472, 21.77228375400105, 21.810689168671757, 33.45092765490213, 33.559489915768296, 33.43331269423166, 21.97684808820486, 21.737283870577812, 21.862139731645584, 21.03228435665369, 20.96353356540203, 21.33051710948348, 24.847186248749495, 24.662727512419224, 24.801405765116215, 21.19706120093663, 21.617584598561123, 21.028949206074074, 2.4483634258309905, 2.4384744937221114, 2.473938586811215, 30.37935610239704, 30.482539044072226, 30.413506266971424, 25.277384914457798, 25.42677864804864, 25.640806019306183, 28.000171173363924, 28.075290497392416, 28.073586037382483, 20.81833230455716, 21.050701794524983, 21.069438142081097, 22.344561512271554, 22.75222014139095, 23.055693176264555, 39.501797400414944, 39.69462939724326, 39.73227653838694, 18.6032799364378, 18.629150578131274, 18.635644187529877, 29.481165411571652, 29.159018623332173, 29.084588850537926, 16.2316779717803, 16.279657438397408, 15.909325882792473, 23.903441486259297, 23.630161826809243, 24.1116930929323, 24.60984716191888, 24.26506742835045, 24.630573242902756, 23.898041891554982, 23.463454777995736, 23.59788746635118, 21.267726881119103, 21.257860435793788, 20.979306528965623, 28.35927565395832, 28.383246928453445, 28.494591161608696, 18.253745923439652, 18.67032382885614, 18.62621847788492, 29.041617047041655, 29.02307763695717, 28.858761601150036, 17.761173288027436, 17.984424049655587, 17.806228737036378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391969621422152, "mean_inference_ms": 0.704534328520899, "mean_action_processing_ms": 0.10005934736753776, "mean_env_wait_ms": 0.810376543634699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1180062, "timesteps_this_iter": 0, "agent_timesteps_total": 3540186, "timers": {"sample_time_ms": 19923.771, "sample_throughput": 481.535, "load_time_ms": 0.2, "load_throughput": 47950610.791, "learn_time_ms": 3128.428, "learn_throughput": 3066.716, "update_time_ms": 9.106}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.097841900194908e-11, "cur_lr": 0.0005, "total_loss": 7.313876688480377, "policy_loss": 0.006792519892978799, "vf_loss": 7.454245924949646, "vf_explained_var": 0.16571956127882004, "kl": 0.36299326550232025, "entropy": 14.716184616088867, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1180062, "num_agent_steps_sampled": 3540186, "num_steps_trained": 1180062, "num_agent_steps_trained": 3540186, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4723, "training_iteration": 123, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-24-45", "timestamp": 1706192685, "time_this_iter_s": 19.686318397521973, "time_total_s": 2484.4744131565094, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0045F550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2484.4744131565094, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 15.13928571428571, "ram_util_percent": 49.36785714285713}}
{"episode_reward_max": 118.92870333604515, "episode_reward_min": -4.917525179684191, "episode_reward_mean": 69.29361247081077, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -1.8439872985084946}, "policy_reward_max": {"shared_policy": 39.73227653838694}, "policy_reward_mean": {"shared_policy": 23.097870823603582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.70303671061993, 52.15700485557316, 71.45558228716254, 83.65529239363966, 80.57284053601325, 87.49700073152778, 85.42358087748286, 79.55266796424985, 68.09082576632497, 64.87579403817654, 67.56381289102134, 79.33375693671404, 86.8110444508493, 77.29201067611575, 83.84644612483679, 64.82086241245268, 70.85714732296762, 49.20486121624707, 66.77614507358518, 71.51043353229758, 73.91360774729401, 47.94427370652555, 65.04995094612238, 68.37843312136826, 64.84373544063419, 81.9088924899697, 91.02004963532089, 88.9051807299256, 91.23773724026977, 78.4372857492417, 69.80970827676356, -4.917525179684191, 90.43386578187346, 62.14376384764907, 81.8368601463735, 56.49868035316466, 89.70423496514557, 46.34700905531645, 82.10017524007706, 96.27093688491729, 80.03181941155343, 65.10058430209753, 100.44373026490209, 65.57627169042826, 63.3263350315392, 74.31131952628493, 63.84359500557183, 7.360776506364317, 91.27540141344069, 76.34496958181262, 84.14904770813882, 62.93847224116324, 68.15247482992706, 118.92870333604515, 55.86807470209895, 87.72477288544175, 48.42066129297018, 71.64529640600084, 73.50548783317208, 70.9593841359019, 63.50489384587851, 85.23711374402046, 55.55028823018071, 86.92345628514886, 53.5518260747194, 17.274206010624738, 49.07523998245597, 56.734250489622355, 38.39608250372112, 61.4424974559806, 54.9519077828154, 73.93697547458578, 53.40069974586366, 93.32467904640359, 30.820708639919744, 67.20626420900224, 92.49608583003283, 55.31503154337406, 97.15770643949506, 76.8131618304178, 75.94150508940218, 22.86330373585224, 87.97679246868937, 72.14753276109693, 86.53030404867604, 69.09274483297483, 63.66880988329646, 82.90000834316015, 60.702661346644135, 61.96260555367914, 79.19376690126953, 60.92072888463734, 74.53363602608442, 64.34397750720382, 58.948189878836246, 81.62164286524057, 71.85901855677365, 58.830115735530825, 57.96633540093897, 55.47031101584432], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.239316076040268, 25.358947552740574, 25.104773081839085, 17.58784371366103, 17.5722575088342, 16.996903633077935, 23.29112522304058, 23.985251486301422, 24.17920557782054, 27.858220386008412, 27.881342741350323, 27.91572926628092, 26.68094927817583, 26.868422351777554, 27.02346890605986, 29.32892038176456, 29.062137144307286, 29.10594320545593, 28.370734373728425, 28.60939252624908, 28.443453977505357, 25.862705379724503, 26.66671373695135, 27.023248847573996, 21.800783554712922, 23.108941855529935, 23.181100356082112, 21.763135462999344, 21.80106808245182, 21.311590492725372, 22.62790201852718, 22.284124741951615, 22.651786130542547, 26.417005257060126, 26.318576549490288, 26.598175130163625, 28.55022831261158, 29.150343373417854, 29.11047276481986, 26.044421929866076, 25.544336929917336, 25.70325181633234, 27.525840391715363, 28.132376390819744, 28.188229342301682, 21.706357200940445, 21.47174933304389, 21.64275587846835, 24.045809075857193, 23.79422844077149, 23.017109806338937, 16.30063235511382, 16.474565004309014, 16.429663856824234, 22.20574540893236, 22.25841172846654, 22.311987936186284, 23.819304815183074, 23.745501990119607, 23.945626726994902, 23.97366765141487, 25.013368331827223, 24.926571764051914, 16.08321902652581, 16.089255356540278, 15.771799323459462, 21.673074445376784, 21.7397358889381, 21.637140611807496, 22.70769254366556, 22.666349756220967, 23.004390821481735, 21.846188343130052, 21.573004446923733, 21.424542650580406, 27.02075823644796, 27.396978619197995, 27.491155634323746, 30.15050672491391, 30.682739191999033, 30.186803718407944, 29.717118466893822, 29.473457957307488, 29.714604305724293, 30.251941343148545, 30.38912083705266, 30.596675060068563, 26.170337622364357, 26.35865025532742, 25.90829787154992, 23.45253768004477, 23.249312318861485, 23.107858277857304, -1.8439872985084946, -1.294660237928241, -1.778877643247455, 30.1230249106884, 30.113321013748646, 30.19751985743642, 21.030297274390847, 20.681665721038968, 20.431800852219254, 27.43559045841296, 26.91067339976628, 27.490596288194254, 19.16158378620942, 18.65801491340001, 18.67908165355523, 30.08496943612893, 29.695170556505516, 29.924094972511128, 15.303032286465168, 15.321129597723484, 15.722847171127796, 27.690934216914073, 27.164037329455212, 27.24520369370778, 32.60987149520466, 31.936191538969666, 31.724873850742966, 26.551731516917542, 26.9549379631256, 26.525149931510285, 21.51761137942472, 21.77228375400105, 21.810689168671757, 33.45092765490213, 33.559489915768296, 33.43331269423166, 21.97684808820486, 21.737283870577812, 21.862139731645584, 21.03228435665369, 20.96353356540203, 21.33051710948348, 24.847186248749495, 24.662727512419224, 24.801405765116215, 21.19706120093663, 21.617584598561123, 21.028949206074074, 2.4483634258309905, 2.4384744937221114, 2.473938586811215, 30.37935610239704, 30.482539044072226, 30.413506266971424, 25.277384914457798, 25.42677864804864, 25.640806019306183, 28.000171173363924, 28.075290497392416, 28.073586037382483, 20.81833230455716, 21.050701794524983, 21.069438142081097, 22.344561512271554, 22.75222014139095, 23.055693176264555, 39.501797400414944, 39.69462939724326, 39.73227653838694, 18.6032799364378, 18.629150578131274, 18.635644187529877, 29.481165411571652, 29.159018623332173, 29.084588850537926, 16.2316779717803, 16.279657438397408, 15.909325882792473, 23.903441486259297, 23.630161826809243, 24.1116930929323, 24.60984716191888, 24.26506742835045, 24.630573242902756, 23.898041891554982, 23.463454777995736, 23.59788746635118, 21.267726881119103, 21.257860435793788, 20.979306528965623, 28.35927565395832, 28.383246928453445, 28.494591161608696, 18.253745923439652, 18.67032382885614, 18.62621847788492, 29.041617047041655, 29.02307763695717, 28.858761601150036, 17.761173288027436, 17.984424049655587, 17.806228737036378, 5.87307393240431, 5.906720651934535, 5.494411426285893, 16.20595356822014, 16.584742557257414, 16.284543856978416, 18.58322185277939, 18.991191692650318, 19.159836944192648, 12.808493882417679, 12.573543958365917, 13.014044662937522, 20.5586570786933, 20.597613237953425, 20.286227139333874, 18.475057068280876, 18.38748576119542, 18.0893649533391, 24.340749502182007, 24.422264516353607, 25.173961456050165, 17.46836784233649, 17.973976041500762, 17.95835586202641, 31.007838192085416, 31.453160593441368, 30.863680260876805, 9.770823155840233, 10.434392688175038, 10.615492795904473, 22.14033157130082, 22.76407229279478, 22.301860344906643, 30.765638262033463, 31.01028325408697, 30.72016431391239, 18.60907916724682, 18.507020220160484, 18.19893215596676, 32.305995936195046, 32.468723768989236, 32.38298673431078, 25.679824780983225, 25.577895012994603, 25.55544203643997, 25.31396211807926, 25.492574849476412, 25.134968121846512, 7.480745196342468, 7.662057049572468, 7.7205014899373055, 29.221071687837437, 29.41034351320316, 29.34537726764877, 24.064184832076222, 24.217577310899884, 23.86577061812082, 28.613751769065857, 28.956039467360824, 28.960512812249362, 22.943218196431786, 23.12670570126889, 23.022820935274154, 21.34270608300963, 21.060647534827382, 21.26545626545945, 27.78611132502556, 27.77680491656065, 27.337092101573944, 20.399796309570462, 19.949429425100476, 20.353435611973197, 20.73954527794072, 20.639988985533506, 20.583071290204913, 26.420708103726298, 26.259322772423417, 26.51373602511981, 20.117813905080155, 20.179485862453774, 20.623429117103413, 24.501529067754745, 25.29148145765066, 24.740625500679016, 21.360517129302025, 21.405178256332874, 21.57828212156892, 19.284298951427132, 19.860902056718857, 19.802988870690257, 27.231925666332245, 26.945089489221573, 27.444627709686756, 23.58924665053685, 24.13275823493798, 24.137013671298817, 19.614256004492432, 19.594873188684375, 19.620986542354018, 19.14878124495347, 19.422408660252884, 19.39514549573262, 18.04752033452192, 18.687914044285804, 18.734876637036592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15392533663047928, "mean_inference_ms": 0.704558933935607, "mean_action_processing_ms": 0.10008848503811024, "mean_env_wait_ms": 0.8103751113979923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1189656, "timesteps_this_iter": 0, "agent_timesteps_total": 3568968, "timers": {"sample_time_ms": 20026.58, "sample_throughput": 479.063, "load_time_ms": 0.2, "load_throughput": 47950610.791, "learn_time_ms": 3145.013, "learn_throughput": 3050.544, "update_time_ms": 9.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.146762850292362e-11, "cur_lr": 0.0005, "total_loss": 6.510833203792572, "policy_loss": 0.00017350863742695774, "vf_loss": 6.6582255363464355, "vf_explained_var": 0.10191811621189117, "kl": 0.006839237699919701, "entropy": 14.756583333015442, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1189656, "num_agent_steps_sampled": 3568968, "num_steps_trained": 1189656, "num_agent_steps_trained": 3568968, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4758, "training_iteration": 124, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-25-05", "timestamp": 1706192705, "time_this_iter_s": 19.49502420425415, "time_total_s": 2503.9694373607635, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BADD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2503.9694373607635, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 9.460714285714287, "ram_util_percent": 49.13928571428573}}
{"episode_reward_max": 118.92870333604515, "episode_reward_min": -4.917525179684191, "episode_reward_mean": 69.31262340819026, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"shared_policy": -1.8439872985084946}, "policy_reward_max": {"shared_policy": 39.73227653838694}, "policy_reward_mean": {"shared_policy": 23.104207802730084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.23773724026977, 78.4372857492417, 69.80970827676356, -4.917525179684191, 90.43386578187346, 62.14376384764907, 81.8368601463735, 56.49868035316466, 89.70423496514557, 46.34700905531645, 82.10017524007706, 96.27093688491729, 80.03181941155343, 65.10058430209753, 100.44373026490209, 65.57627169042826, 63.3263350315392, 74.31131952628493, 63.84359500557183, 7.360776506364317, 91.27540141344069, 76.34496958181262, 84.14904770813882, 62.93847224116324, 68.15247482992706, 118.92870333604515, 55.86807470209895, 87.72477288544175, 48.42066129297018, 71.64529640600084, 73.50548783317208, 70.9593841359019, 63.50489384587851, 85.23711374402046, 55.55028823018071, 86.92345628514886, 53.5518260747194, 17.274206010624738, 49.07523998245597, 56.734250489622355, 38.39608250372112, 61.4424974559806, 54.9519077828154, 73.93697547458578, 53.40069974586366, 93.32467904640359, 30.820708639919744, 67.20626420900224, 92.49608583003283, 55.31503154337406, 97.15770643949506, 76.8131618304178, 75.94150508940218, 22.86330373585224, 87.97679246868937, 72.14753276109693, 86.53030404867604, 69.09274483297483, 63.66880988329646, 82.90000834316015, 60.702661346644135, 61.96260555367914, 79.19376690126953, 60.92072888463734, 74.53363602608442, 64.34397750720382, 58.948189878836246, 81.62164286524057, 71.85901855677365, 58.830115735530825, 57.96633540093897, 55.47031101584432, 67.26838558167216, 63.48822721466421, 72.74155454710123, 113.44294290058313, 98.12152102589604, 79.73217232432215, 74.90295349061489, 82.53035043179989, 71.3378108534962, 58.06374657154082, 46.94496637955308, 78.24279002845286, 52.97791484557089, 37.702136063948274, 84.88452468812464, 63.506859689019606, 72.70005220547317, 49.4438939541578, 67.79267009161413, 94.27721279114483, 80.10513845458625, 70.09778198137062, 89.48827680549584, 77.04374800622462, 69.52653530985117, 82.23967443406579, 78.83618858456609, 73.42533509805799], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.251941343148545, 30.38912083705266, 30.596675060068563, 26.170337622364357, 26.35865025532742, 25.90829787154992, 23.45253768004477, 23.249312318861485, 23.107858277857304, -1.8439872985084946, -1.294660237928241, -1.778877643247455, 30.1230249106884, 30.113321013748646, 30.19751985743642, 21.030297274390847, 20.681665721038968, 20.431800852219254, 27.43559045841296, 26.91067339976628, 27.490596288194254, 19.16158378620942, 18.65801491340001, 18.67908165355523, 30.08496943612893, 29.695170556505516, 29.924094972511128, 15.303032286465168, 15.321129597723484, 15.722847171127796, 27.690934216914073, 27.164037329455212, 27.24520369370778, 32.60987149520466, 31.936191538969666, 31.724873850742966, 26.551731516917542, 26.9549379631256, 26.525149931510285, 21.51761137942472, 21.77228375400105, 21.810689168671757, 33.45092765490213, 33.559489915768296, 33.43331269423166, 21.97684808820486, 21.737283870577812, 21.862139731645584, 21.03228435665369, 20.96353356540203, 21.33051710948348, 24.847186248749495, 24.662727512419224, 24.801405765116215, 21.19706120093663, 21.617584598561123, 21.028949206074074, 2.4483634258309905, 2.4384744937221114, 2.473938586811215, 30.37935610239704, 30.482539044072226, 30.413506266971424, 25.277384914457798, 25.42677864804864, 25.640806019306183, 28.000171173363924, 28.075290497392416, 28.073586037382483, 20.81833230455716, 21.050701794524983, 21.069438142081097, 22.344561512271554, 22.75222014139095, 23.055693176264555, 39.501797400414944, 39.69462939724326, 39.73227653838694, 18.6032799364378, 18.629150578131274, 18.635644187529877, 29.481165411571652, 29.159018623332173, 29.084588850537926, 16.2316779717803, 16.279657438397408, 15.909325882792473, 23.903441486259297, 23.630161826809243, 24.1116930929323, 24.60984716191888, 24.26506742835045, 24.630573242902756, 23.898041891554982, 23.463454777995736, 23.59788746635118, 21.267726881119103, 21.257860435793788, 20.979306528965623, 28.35927565395832, 28.383246928453445, 28.494591161608696, 18.253745923439652, 18.67032382885614, 18.62621847788492, 29.041617047041655, 29.02307763695717, 28.858761601150036, 17.761173288027436, 17.984424049655587, 17.806228737036378, 5.87307393240431, 5.906720651934535, 5.494411426285893, 16.20595356822014, 16.584742557257414, 16.284543856978416, 18.58322185277939, 18.991191692650318, 19.159836944192648, 12.808493882417679, 12.573543958365917, 13.014044662937522, 20.5586570786933, 20.597613237953425, 20.286227139333874, 18.475057068280876, 18.38748576119542, 18.0893649533391, 24.340749502182007, 24.422264516353607, 25.173961456050165, 17.46836784233649, 17.973976041500762, 17.95835586202641, 31.007838192085416, 31.453160593441368, 30.863680260876805, 9.770823155840233, 10.434392688175038, 10.615492795904473, 22.14033157130082, 22.76407229279478, 22.301860344906643, 30.765638262033463, 31.01028325408697, 30.72016431391239, 18.60907916724682, 18.507020220160484, 18.19893215596676, 32.305995936195046, 32.468723768989236, 32.38298673431078, 25.679824780983225, 25.577895012994603, 25.55544203643997, 25.31396211807926, 25.492574849476412, 25.134968121846512, 7.480745196342468, 7.662057049572468, 7.7205014899373055, 29.221071687837437, 29.41034351320316, 29.34537726764877, 24.064184832076222, 24.217577310899884, 23.86577061812082, 28.613751769065857, 28.956039467360824, 28.960512812249362, 22.943218196431786, 23.12670570126889, 23.022820935274154, 21.34270608300963, 21.060647534827382, 21.26545626545945, 27.78611132502556, 27.77680491656065, 27.337092101573944, 20.399796309570462, 19.949429425100476, 20.353435611973197, 20.73954527794072, 20.639988985533506, 20.583071290204913, 26.420708103726298, 26.259322772423417, 26.51373602511981, 20.117813905080155, 20.179485862453774, 20.623429117103413, 24.501529067754745, 25.29148145765066, 24.740625500679016, 21.360517129302025, 21.405178256332874, 21.57828212156892, 19.284298951427132, 19.860902056718857, 19.802988870690257, 27.231925666332245, 26.945089489221573, 27.444627709686756, 23.58924665053685, 24.13275823493798, 24.137013671298817, 19.614256004492432, 19.594873188684375, 19.620986542354018, 19.14878124495347, 19.422408660252884, 19.39514549573262, 18.04752033452192, 18.687914044285804, 18.734876637036592, 22.23107163856426, 22.662699120740086, 22.374614822367818, 21.112659720083073, 21.046200466652706, 21.329367027928427, 24.18938525641957, 24.242607994625956, 24.309561296055705, 37.72808815663059, 37.87216083457072, 37.84269390938182, 32.196725259224564, 32.71996061007181, 33.20483515659967, 26.98060345773895, 25.499753197034195, 27.251815669549003, 24.81771920621395, 25.005233891308308, 25.080000393092632, 27.51179489865899, 27.327901884913445, 27.690653648227453, 23.455005764961243, 23.697185806930065, 24.185619281604886, 19.37726717193921, 19.480506626268223, 19.205972773333386, 15.777683347463608, 15.319208964705467, 15.848074067384005, 25.946147640546158, 26.054682073493794, 26.241960314412907, 17.353787610928208, 18.10316036703685, 17.520966867605836, 12.657230377197266, 12.878490502014756, 12.166415184736252, 28.396616530915097, 28.34153729428847, 28.146370862921074, 21.559448983830706, 21.186961514254406, 20.760449190934494, 24.157555525501564, 24.45094759886463, 24.091549081106976, 16.51338371137777, 16.591478163997323, 16.339032078782708, 22.311545699834824, 22.860387979075313, 22.62073641270399, 31.52448460583885, 31.17818022270997, 31.574547962596014, 26.499225613971547, 26.852156860133007, 26.7537559804817, 23.015770109991223, 23.511011915902287, 23.570999955477106, 29.453799426555634, 29.85832881182432, 30.176148567115888, 25.602613312502697, 25.942697299023465, 25.498437394698456, 23.118700496852398, 23.13063133507967, 23.2772034779191, 27.51058333615461, 26.999816755453736, 27.729274342457444, 26.532404779146106, 26.437028146038443, 25.86675565938154, 24.150824576616287, 24.55885834246874, 24.71565217897296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538447754516166, "mean_inference_ms": 0.7046804324228261, "mean_action_processing_ms": 0.10010567682687464, "mean_env_wait_ms": 0.8104004584473091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1199250, "timesteps_this_iter": 0, "agent_timesteps_total": 3597750, "timers": {"sample_time_ms": 20186.77, "sample_throughput": 475.262, "load_time_ms": 0.3, "load_throughput": 31972153.644, "learn_time_ms": 3137.285, "learn_throughput": 3058.058, "update_time_ms": 9.802}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.146762850292362e-11, "cur_lr": 0.0005, "total_loss": 6.266908347606659, "policy_loss": 1.4408603131510489e-05, "vf_loss": 6.417254328727722, "vf_explained_var": 0.08628414571285248, "kl": 0.0040512641718952825, "entropy": 15.036028504371643, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1199250, "num_agent_steps_sampled": 3597750, "num_steps_trained": 1199250, "num_agent_steps_trained": 3597750, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4786, "training_iteration": 125, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-25-25", "timestamp": 1706192725, "time_this_iter_s": 20.269955158233643, "time_total_s": 2524.239392518997, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA016263A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2524.239392518997, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 9.367857142857144, "ram_util_percent": 49.246428571428574}}
{"episode_reward_max": 113.44294290058313, "episode_reward_min": -308.0089808367193, "episode_reward_mean": 64.91184111382667, "episode_len_mean": 297.78, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -111.77472358942032}, "policy_reward_max": {"shared_policy": 37.87216083457072}, "policy_reward_mean": {"shared_policy": 21.63728037127555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.5518260747194, 17.274206010624738, 49.07523998245597, 56.734250489622355, 38.39608250372112, 61.4424974559806, 54.9519077828154, 73.93697547458578, 53.40069974586366, 93.32467904640359, 30.820708639919744, 67.20626420900224, 92.49608583003283, 55.31503154337406, 97.15770643949506, 76.8131618304178, 75.94150508940218, 22.86330373585224, 87.97679246868937, 72.14753276109693, 86.53030404867604, 69.09274483297483, 63.66880988329646, 82.90000834316015, 60.702661346644135, 61.96260555367914, 79.19376690126953, 60.92072888463734, 74.53363602608442, 64.34397750720382, 58.948189878836246, 81.62164286524057, 71.85901855677365, 58.830115735530825, 57.96633540093897, 55.47031101584432, 67.26838558167216, 63.48822721466421, 72.74155454710123, 113.44294290058313, 98.12152102589604, 79.73217232432215, 74.90295349061489, 82.53035043179989, 71.3378108534962, 58.06374657154082, 46.94496637955308, 78.24279002845286, 52.97791484557089, 37.702136063948274, 84.88452468812464, 63.506859689019606, 72.70005220547317, 49.4438939541578, 67.79267009161413, 94.27721279114483, 80.10513845458625, 70.09778198137062, 89.48827680549584, 77.04374800622462, 69.52653530985117, 82.23967443406579, 78.83618858456609, 73.42533509805799, 61.54776128556114, 74.92472544312474, 84.31416388973591, -308.0089808367193, 86.61924971081315, 39.340081147849546, 43.19229424744843, 108.12323263846338, 70.3623972740024, 73.95730675803496, 66.88143164943904, 79.71288863010702, 76.02810538746414, 76.85553939081726, 73.06909986585379, 53.95148164406419, 71.13255816511807, 79.23190200887619, 84.83127400651571, 66.85245363414285, 9.265884056687327, 89.25404219701886, 90.70488797500727, 61.35510821547359, 33.10154534131287, 83.1297506103292, 79.3426656005904, 70.98457552393664, 79.7811359213665, 56.854390442371354, 92.40372119843957, 31.849673226475716, 60.901984579861136, 83.37980807013808, 63.71177604608238, 72.00751818902789], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 78, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.761173288027436, 17.984424049655587, 17.806228737036378, 5.87307393240431, 5.906720651934535, 5.494411426285893, 16.20595356822014, 16.584742557257414, 16.284543856978416, 18.58322185277939, 18.991191692650318, 19.159836944192648, 12.808493882417679, 12.573543958365917, 13.014044662937522, 20.5586570786933, 20.597613237953425, 20.286227139333874, 18.475057068280876, 18.38748576119542, 18.0893649533391, 24.340749502182007, 24.422264516353607, 25.173961456050165, 17.46836784233649, 17.973976041500762, 17.95835586202641, 31.007838192085416, 31.453160593441368, 30.863680260876805, 9.770823155840233, 10.434392688175038, 10.615492795904473, 22.14033157130082, 22.76407229279478, 22.301860344906643, 30.765638262033463, 31.01028325408697, 30.72016431391239, 18.60907916724682, 18.507020220160484, 18.19893215596676, 32.305995936195046, 32.468723768989236, 32.38298673431078, 25.679824780983225, 25.577895012994603, 25.55544203643997, 25.31396211807926, 25.492574849476412, 25.134968121846512, 7.480745196342468, 7.662057049572468, 7.7205014899373055, 29.221071687837437, 29.41034351320316, 29.34537726764877, 24.064184832076222, 24.217577310899884, 23.86577061812082, 28.613751769065857, 28.956039467360824, 28.960512812249362, 22.943218196431786, 23.12670570126889, 23.022820935274154, 21.34270608300963, 21.060647534827382, 21.26545626545945, 27.78611132502556, 27.77680491656065, 27.337092101573944, 20.399796309570462, 19.949429425100476, 20.353435611973197, 20.73954527794072, 20.639988985533506, 20.583071290204913, 26.420708103726298, 26.259322772423417, 26.51373602511981, 20.117813905080155, 20.179485862453774, 20.623429117103413, 24.501529067754745, 25.29148145765066, 24.740625500679016, 21.360517129302025, 21.405178256332874, 21.57828212156892, 19.284298951427132, 19.860902056718857, 19.802988870690257, 27.231925666332245, 26.945089489221573, 27.444627709686756, 23.58924665053685, 24.13275823493798, 24.137013671298817, 19.614256004492432, 19.594873188684375, 19.620986542354018, 19.14878124495347, 19.422408660252884, 19.39514549573262, 18.04752033452192, 18.687914044285804, 18.734876637036592, 22.23107163856426, 22.662699120740086, 22.374614822367818, 21.112659720083073, 21.046200466652706, 21.329367027928427, 24.18938525641957, 24.242607994625956, 24.309561296055705, 37.72808815663059, 37.87216083457072, 37.84269390938182, 32.196725259224564, 32.71996061007181, 33.20483515659967, 26.98060345773895, 25.499753197034195, 27.251815669549003, 24.81771920621395, 25.005233891308308, 25.080000393092632, 27.51179489865899, 27.327901884913445, 27.690653648227453, 23.455005764961243, 23.697185806930065, 24.185619281604886, 19.37726717193921, 19.480506626268223, 19.205972773333386, 15.777683347463608, 15.319208964705467, 15.848074067384005, 25.946147640546158, 26.054682073493794, 26.241960314412907, 17.353787610928208, 18.10316036703685, 17.520966867605836, 12.657230377197266, 12.878490502014756, 12.166415184736252, 28.396616530915097, 28.34153729428847, 28.146370862921074, 21.559448983830706, 21.186961514254406, 20.760449190934494, 24.157555525501564, 24.45094759886463, 24.091549081106976, 16.51338371137777, 16.591478163997323, 16.339032078782708, 22.311545699834824, 22.860387979075313, 22.62073641270399, 31.52448460583885, 31.17818022270997, 31.574547962596014, 26.499225613971547, 26.852156860133007, 26.7537559804817, 23.015770109991223, 23.511011915902287, 23.570999955477106, 29.453799426555634, 29.85832881182432, 30.176148567115888, 25.602613312502697, 25.942697299023465, 25.498437394698456, 23.118700496852398, 23.13063133507967, 23.2772034779191, 27.51058333615461, 26.999816755453736, 27.729274342457444, 26.532404779146106, 26.437028146038443, 25.86675565938154, 24.150824576616287, 24.55885834246874, 24.71565217897296, 20.176759034395218, 20.814707474666648, 20.55629477649927, 24.992240729431302, 25.170523064831883, 24.761961648861558, 28.152506085733563, 28.082277639458567, 28.079380164543778, -111.77472358942032, -98.00414391234517, -98.23011333495378, 29.044360312943653, 28.837100276102618, 28.73778912176688, 13.17115745445092, 13.002608632047966, 13.166315061350659, 14.580670249958828, 14.33080582817395, 14.280818169315651, 35.84282234311104, 35.96987433731556, 36.31053595803678, 23.333101520935685, 23.262727620700986, 23.766568132365734, 24.708413080157086, 24.71312603571762, 24.535767642160252, 22.18956082314253, 22.09483090043068, 22.59703992586583, 26.619119788209588, 26.345925400654465, 26.747843441242964, 24.807437802354485, 25.657648355389625, 25.563019229720027, 25.68807617450753, 25.30132396767536, 25.86613924863437, 24.16437239944935, 24.54167877882719, 24.363048687577248, 18.2009006626904, 17.946381211280823, 17.804199770092964, 23.808400907243282, 23.545278223852307, 23.77887903402248, 26.39389743780096, 26.46966450599332, 26.36834006508191, 28.319020378092915, 28.246349240342767, 28.26590438808003, 22.36573181549707, 22.098914640645177, 22.3878071780006, 2.9584453466037814, 3.1476326171929543, 3.159806092890591, 29.707086734473705, 29.799484718590975, 29.74747074395418, 30.252107499788195, 30.07157842318216, 30.38120205203691, 20.533127211034298, 20.87151091452688, 19.950470089912415, 11.294783891489104, 11.496954576422766, 10.309806873401001, 27.58573843290408, 27.591889222462967, 27.95212295496215, 26.73916737021257, 26.141469245155648, 26.462028985222176, 23.370456015070275, 23.918356672181588, 23.69576283668478, 26.543090039243296, 26.72753741809477, 26.510508464028433, 19.01903626074393, 19.017860782643154, 18.81749339898427, 30.6668092260758, 30.92800115669766, 30.80891081566611, 10.214204087853432, 10.919930346310139, 10.715538792312145, 20.156811739007622, 20.355856495598943, 20.38931634525457, 27.774556146313742, 27.927445422237113, 27.677806501587227, 19.899740129709244, 22.26874561421573, 21.543290302157402, 23.570105989774063, 24.39404544172187, 24.043366757531956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538686412327434, "mean_inference_ms": 0.7044829859405481, "mean_action_processing_ms": 0.1001180288760214, "mean_env_wait_ms": 0.8100176312807815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1208844, "timesteps_this_iter": 0, "agent_timesteps_total": 3626532, "timers": {"sample_time_ms": 20242.092, "sample_throughput": 473.963, "load_time_ms": 0.3, "load_throughput": 31972153.644, "learn_time_ms": 3139.931, "learn_throughput": 3055.482, "update_time_ms": 9.803}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.573381425146181e-11, "cur_lr": 0.0005, "total_loss": 52.415377140045166, "policy_loss": -0.0006447227730679295, "vf_loss": 52.56552219390869, "vf_explained_var": 0.09698748588562012, "kl": 0.011807125585791754, "entropy": 14.950318813323975, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1208844, "num_agent_steps_sampled": 3626532, "num_steps_trained": 1208844, "num_agent_steps_trained": 3626532, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4822, "training_iteration": 126, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-25-44", "timestamp": 1706192744, "time_this_iter_s": 19.085843563079834, "time_total_s": 2543.325236082077, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0158A3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2543.325236082077, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 7.044444444444444, "ram_util_percent": 49.2074074074074}}
{"episode_reward_max": 113.44294290058313, "episode_reward_min": -308.0089808367193, "episode_reward_mean": 58.42869181888731, "episode_len_mean": 294.22, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -111.77472358942032}, "policy_reward_max": {"shared_policy": 37.87216083457072}, "policy_reward_mean": {"shared_policy": 19.476230606295765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.85901855677365, 58.830115735530825, 57.96633540093897, 55.47031101584432, 67.26838558167216, 63.48822721466421, 72.74155454710123, 113.44294290058313, 98.12152102589604, 79.73217232432215, 74.90295349061489, 82.53035043179989, 71.3378108534962, 58.06374657154082, 46.94496637955308, 78.24279002845286, 52.97791484557089, 37.702136063948274, 84.88452468812464, 63.506859689019606, 72.70005220547317, 49.4438939541578, 67.79267009161413, 94.27721279114483, 80.10513845458625, 70.09778198137062, 89.48827680549584, 77.04374800622462, 69.52653530985117, 82.23967443406579, 78.83618858456609, 73.42533509805799, 61.54776128556114, 74.92472544312474, 84.31416388973591, -308.0089808367193, 86.61924971081315, 39.340081147849546, 43.19229424744843, 108.12323263846338, 70.3623972740024, 73.95730675803496, 66.88143164943904, 79.71288863010702, 76.02810538746414, 76.85553939081726, 73.06909986585379, 53.95148164406419, 71.13255816511807, 79.23190200887619, 84.83127400651571, 66.85245363414285, 9.265884056687327, 89.25404219701886, 90.70488797500727, 61.35510821547359, 33.10154534131287, 83.1297506103292, 79.3426656005904, 70.98457552393664, 79.7811359213665, 56.854390442371354, 92.40372119843957, 31.849673226475716, 60.901984579861136, 83.37980807013808, 63.71177604608238, 72.00751818902789, 22.922057264484437, 74.1858984036371, 53.26614700863135, -272.8902136827819, 83.72097973525523, 83.92556827352382, 67.3371996283531, 76.43233094830066, 34.961703419685364, 69.75080416351554, 63.71240012813357, 62.730057919397936, 66.68413029611108, 71.43466064333914, 70.88291278295216, -268.1613171361387, 88.32345210015772, 46.37010844424364, 40.18819813430309, 74.3753714680206, 79.51541355252265, 48.13052843697366, 79.25328923854977, 67.50322412326932, 53.555787783116074, 71.75763558689505, 50.448060460388646, 46.48826737073247, 73.25992148369548, 87.2987368032336, 64.90971167013049, 94.65757723920976], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 78, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 157, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.58924665053685, 24.13275823493798, 24.137013671298817, 19.614256004492432, 19.594873188684375, 19.620986542354018, 19.14878124495347, 19.422408660252884, 19.39514549573262, 18.04752033452192, 18.687914044285804, 18.734876637036592, 22.23107163856426, 22.662699120740086, 22.374614822367818, 21.112659720083073, 21.046200466652706, 21.329367027928427, 24.18938525641957, 24.242607994625956, 24.309561296055705, 37.72808815663059, 37.87216083457072, 37.84269390938182, 32.196725259224564, 32.71996061007181, 33.20483515659967, 26.98060345773895, 25.499753197034195, 27.251815669549003, 24.81771920621395, 25.005233891308308, 25.080000393092632, 27.51179489865899, 27.327901884913445, 27.690653648227453, 23.455005764961243, 23.697185806930065, 24.185619281604886, 19.37726717193921, 19.480506626268223, 19.205972773333386, 15.777683347463608, 15.319208964705467, 15.848074067384005, 25.946147640546158, 26.054682073493794, 26.241960314412907, 17.353787610928208, 18.10316036703685, 17.520966867605836, 12.657230377197266, 12.878490502014756, 12.166415184736252, 28.396616530915097, 28.34153729428847, 28.146370862921074, 21.559448983830706, 21.186961514254406, 20.760449190934494, 24.157555525501564, 24.45094759886463, 24.091549081106976, 16.51338371137777, 16.591478163997323, 16.339032078782708, 22.311545699834824, 22.860387979075313, 22.62073641270399, 31.52448460583885, 31.17818022270997, 31.574547962596014, 26.499225613971547, 26.852156860133007, 26.7537559804817, 23.015770109991223, 23.511011915902287, 23.570999955477106, 29.453799426555634, 29.85832881182432, 30.176148567115888, 25.602613312502697, 25.942697299023465, 25.498437394698456, 23.118700496852398, 23.13063133507967, 23.2772034779191, 27.51058333615461, 26.999816755453736, 27.729274342457444, 26.532404779146106, 26.437028146038443, 25.86675565938154, 24.150824576616287, 24.55885834246874, 24.71565217897296, 20.176759034395218, 20.814707474666648, 20.55629477649927, 24.992240729431302, 25.170523064831883, 24.761961648861558, 28.152506085733563, 28.082277639458567, 28.079380164543778, -111.77472358942032, -98.00414391234517, -98.23011333495378, 29.044360312943653, 28.837100276102618, 28.73778912176688, 13.17115745445092, 13.002608632047966, 13.166315061350659, 14.580670249958828, 14.33080582817395, 14.280818169315651, 35.84282234311104, 35.96987433731556, 36.31053595803678, 23.333101520935685, 23.262727620700986, 23.766568132365734, 24.708413080157086, 24.71312603571762, 24.535767642160252, 22.18956082314253, 22.09483090043068, 22.59703992586583, 26.619119788209588, 26.345925400654465, 26.747843441242964, 24.807437802354485, 25.657648355389625, 25.563019229720027, 25.68807617450753, 25.30132396767536, 25.86613924863437, 24.16437239944935, 24.54167877882719, 24.363048687577248, 18.2009006626904, 17.946381211280823, 17.804199770092964, 23.808400907243282, 23.545278223852307, 23.77887903402248, 26.39389743780096, 26.46966450599332, 26.36834006508191, 28.319020378092915, 28.246349240342767, 28.26590438808003, 22.36573181549707, 22.098914640645177, 22.3878071780006, 2.9584453466037814, 3.1476326171929543, 3.159806092890591, 29.707086734473705, 29.799484718590975, 29.74747074395418, 30.252107499788195, 30.07157842318216, 30.38120205203691, 20.533127211034298, 20.87151091452688, 19.950470089912415, 11.294783891489104, 11.496954576422766, 10.309806873401001, 27.58573843290408, 27.591889222462967, 27.95212295496215, 26.73916737021257, 26.141469245155648, 26.462028985222176, 23.370456015070275, 23.918356672181588, 23.69576283668478, 26.543090039243296, 26.72753741809477, 26.510508464028433, 19.01903626074393, 19.017860782643154, 18.81749339898427, 30.6668092260758, 30.92800115669766, 30.80891081566611, 10.214204087853432, 10.919930346310139, 10.715538792312145, 20.156811739007622, 20.355856495598943, 20.38931634525457, 27.774556146313742, 27.927445422237113, 27.677806501587227, 19.899740129709244, 22.26874561421573, 21.543290302157402, 23.570105989774063, 24.39404544172187, 24.043366757531956, 7.396893362204224, 7.74047506103912, 7.784688841241092, 24.446441193421677, 25.085789330614105, 24.653667879601315, 17.94849994328493, 17.46662064890066, 17.851026416445762, -96.01713490486145, -88.38543060747907, -88.48764817044139, 27.924370625366763, 28.016281620909766, 27.7803274889787, 27.439975798130035, 28.20860667526722, 28.276985800126567, 22.260792699952916, 22.43231400599082, 22.64409292240937, 25.04120983183384, 25.733659169636667, 25.657461946830153, 11.550953574478626, 11.798502318561077, 11.61224752664566, 23.270566540459782, 23.36171332995096, 23.118524293104798, 21.227987964327127, 21.302793288292975, 21.181618875513465, 20.97666672741373, 20.971137735371784, 20.782253456612423, 22.46142156297961, 22.321905790517718, 21.90080294261375, 23.493030225237206, 23.8580640827616, 24.083566335340336, 23.319304334620625, 23.801251687730343, 23.762356760601193, -99.195871591568, -84.5536761507392, -84.41176939383149, 29.095433106025055, 29.683555730928973, 29.544463263203696, 15.622674754510314, 15.517999144891888, 15.229434544841439, 13.466198533773422, 13.249333627521992, 13.472665973007679, 24.47207721322775, 24.937419950962067, 24.965874303830788, 26.289355774720505, 26.862758492430046, 26.363299285372094, 16.27884931365648, 15.695913578073174, 16.15576554524401, 26.573315556161106, 26.441099857911468, 26.238873824477196, 22.81797168031335, 22.319118559360504, 22.366133883595467, 17.927060207972914, 17.617479401330144, 18.011248173813016, 23.807058326900005, 23.67445047199726, 24.276126787997782, 16.376141314705208, 16.989928544809416, 17.081990600874022, 15.556198531218485, 15.401225617776305, 15.530843221737683, 24.456043678025395, 24.38569330299893, 24.418184502671153, 29.1663818831245, 29.29876785973707, 28.833587060372025, 21.55600082874298, 21.81341363862157, 21.54029720276594, 31.357848192254693, 31.73971415582733, 31.560014891127736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538273723785122, "mean_inference_ms": 0.7043539206466133, "mean_action_processing_ms": 0.10016259259616046, "mean_env_wait_ms": 0.80979221284654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1218438, "timesteps_this_iter": 0, "agent_timesteps_total": 3655314, "timers": {"sample_time_ms": 20283.54, "sample_throughput": 472.994, "load_time_ms": 0.3, "load_throughput": 31972153.644, "learn_time_ms": 3131.004, "learn_throughput": 3064.193, "update_time_ms": 9.949}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.573381425146181e-11, "cur_lr": 0.0005, "total_loss": 96.58868503570557, "policy_loss": -0.0006866431893792768, "vf_loss": 96.74052047729492, "vf_explained_var": 0.07535871863365173, "kl": 0.009738385823033057, "entropy": 15.114806532859802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1218438, "num_agent_steps_sampled": 3655314, "num_steps_trained": 1218438, "num_agent_steps_trained": 3655314, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4854, "training_iteration": 127, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-26-03", "timestamp": 1706192763, "time_this_iter_s": 18.89924454689026, "time_total_s": 2562.2244806289673, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01790B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2562.2244806289673, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 9.27037037037037, "ram_util_percent": 49.22222222222223}}
{"episode_reward_max": 108.12323263846338, "episode_reward_min": -308.0089808367193, "episode_reward_mean": 57.579207880867756, "episode_len_mean": 294.22, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -111.77472358942032}, "policy_reward_max": {"shared_policy": 36.31053595803678}, "policy_reward_mean": {"shared_policy": 19.19306929362258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.54776128556114, 74.92472544312474, 84.31416388973591, -308.0089808367193, 86.61924971081315, 39.340081147849546, 43.19229424744843, 108.12323263846338, 70.3623972740024, 73.95730675803496, 66.88143164943904, 79.71288863010702, 76.02810538746414, 76.85553939081726, 73.06909986585379, 53.95148164406419, 71.13255816511807, 79.23190200887619, 84.83127400651571, 66.85245363414285, 9.265884056687327, 89.25404219701886, 90.70488797500727, 61.35510821547359, 33.10154534131287, 83.1297506103292, 79.3426656005904, 70.98457552393664, 79.7811359213665, 56.854390442371354, 92.40372119843957, 31.849673226475716, 60.901984579861136, 83.37980807013808, 63.71177604608238, 72.00751818902789, 22.922057264484437, 74.1858984036371, 53.26614700863135, -272.8902136827819, 83.72097973525523, 83.92556827352382, 67.3371996283531, 76.43233094830066, 34.961703419685364, 69.75080416351554, 63.71240012813357, 62.730057919397936, 66.68413029611108, 71.43466064333914, 70.88291278295216, -268.1613171361387, 88.32345210015772, 46.37010844424364, 40.18819813430309, 74.3753714680206, 79.51541355252265, 48.13052843697366, 79.25328923854977, 67.50322412326932, 53.555787783116074, 71.75763558689505, 50.448060460388646, 46.48826737073247, 73.25992148369548, 87.2987368032336, 64.90971167013049, 94.65757723920976, 92.0746120526455, 86.18918222188948, 53.809554258361445, 68.894747313112, 73.03876099735496, 64.77992490236645, 71.48319671256468, 61.03332788078113, 34.234637390822144, 69.54569922154768, 89.80784210562703, 74.11990389414132, 25.21278466656804, 71.27741885930297, 74.38931302912533, 71.34801617823541, 82.26063375920056, 81.63658460974692, 78.39834888465701, 63.99793725088236, 68.10728316567838, 16.578489556908593, 54.121245319023714, 84.12553836009464, 76.61555072665215, 66.72113318322225, 54.259078645613045, 78.62849225848912, 85.80418495228514, 103.47903319867325, 59.15155971236524, 74.91873599216342], "episode_lengths": [300, 300, 300, 78, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 157, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.176759034395218, 20.814707474666648, 20.55629477649927, 24.992240729431302, 25.170523064831883, 24.761961648861558, 28.152506085733563, 28.082277639458567, 28.079380164543778, -111.77472358942032, -98.00414391234517, -98.23011333495378, 29.044360312943653, 28.837100276102618, 28.73778912176688, 13.17115745445092, 13.002608632047966, 13.166315061350659, 14.580670249958828, 14.33080582817395, 14.280818169315651, 35.84282234311104, 35.96987433731556, 36.31053595803678, 23.333101520935685, 23.262727620700986, 23.766568132365734, 24.708413080157086, 24.71312603571762, 24.535767642160252, 22.18956082314253, 22.09483090043068, 22.59703992586583, 26.619119788209588, 26.345925400654465, 26.747843441242964, 24.807437802354485, 25.657648355389625, 25.563019229720027, 25.68807617450753, 25.30132396767536, 25.86613924863437, 24.16437239944935, 24.54167877882719, 24.363048687577248, 18.2009006626904, 17.946381211280823, 17.804199770092964, 23.808400907243282, 23.545278223852307, 23.77887903402248, 26.39389743780096, 26.46966450599332, 26.36834006508191, 28.319020378092915, 28.246349240342767, 28.26590438808003, 22.36573181549707, 22.098914640645177, 22.3878071780006, 2.9584453466037814, 3.1476326171929543, 3.159806092890591, 29.707086734473705, 29.799484718590975, 29.74747074395418, 30.252107499788195, 30.07157842318216, 30.38120205203691, 20.533127211034298, 20.87151091452688, 19.950470089912415, 11.294783891489104, 11.496954576422766, 10.309806873401001, 27.58573843290408, 27.591889222462967, 27.95212295496215, 26.73916737021257, 26.141469245155648, 26.462028985222176, 23.370456015070275, 23.918356672181588, 23.69576283668478, 26.543090039243296, 26.72753741809477, 26.510508464028433, 19.01903626074393, 19.017860782643154, 18.81749339898427, 30.6668092260758, 30.92800115669766, 30.80891081566611, 10.214204087853432, 10.919930346310139, 10.715538792312145, 20.156811739007622, 20.355856495598943, 20.38931634525457, 27.774556146313742, 27.927445422237113, 27.677806501587227, 19.899740129709244, 22.26874561421573, 21.543290302157402, 23.570105989774063, 24.39404544172187, 24.043366757531956, 7.396893362204224, 7.74047506103912, 7.784688841241092, 24.446441193421677, 25.085789330614105, 24.653667879601315, 17.94849994328493, 17.46662064890066, 17.851026416445762, -96.01713490486145, -88.38543060747907, -88.48764817044139, 27.924370625366763, 28.016281620909766, 27.7803274889787, 27.439975798130035, 28.20860667526722, 28.276985800126567, 22.260792699952916, 22.43231400599082, 22.64409292240937, 25.04120983183384, 25.733659169636667, 25.657461946830153, 11.550953574478626, 11.798502318561077, 11.61224752664566, 23.270566540459782, 23.36171332995096, 23.118524293104798, 21.227987964327127, 21.302793288292975, 21.181618875513465, 20.97666672741373, 20.971137735371784, 20.782253456612423, 22.46142156297961, 22.321905790517718, 21.90080294261375, 23.493030225237206, 23.8580640827616, 24.083566335340336, 23.319304334620625, 23.801251687730343, 23.762356760601193, -99.195871591568, -84.5536761507392, -84.41176939383149, 29.095433106025055, 29.683555730928973, 29.544463263203696, 15.622674754510314, 15.517999144891888, 15.229434544841439, 13.466198533773422, 13.249333627521992, 13.472665973007679, 24.47207721322775, 24.937419950962067, 24.965874303830788, 26.289355774720505, 26.862758492430046, 26.363299285372094, 16.27884931365648, 15.695913578073174, 16.15576554524401, 26.573315556161106, 26.441099857911468, 26.238873824477196, 22.81797168031335, 22.319118559360504, 22.366133883595467, 17.927060207972914, 17.617479401330144, 18.011248173813016, 23.807058326900005, 23.67445047199726, 24.276126787997782, 16.376141314705208, 16.989928544809416, 17.081990600874022, 15.556198531218485, 15.401225617776305, 15.530843221737683, 24.456043678025395, 24.38569330299893, 24.418184502671153, 29.1663818831245, 29.29876785973707, 28.833587060372025, 21.55600082874298, 21.81341363862157, 21.54029720276594, 31.357848192254693, 31.73971415582733, 31.560014891127736, 30.477125058571488, 30.856134517273546, 30.741352476800472, 28.65906226386626, 28.66614895810683, 28.86397099991639, 17.942405705650643, 17.422475655873612, 18.44467289683719, 22.851206717391804, 23.0529266235729, 22.9906139721473, 24.26491258541742, 24.49696687857309, 24.276881533364445, 21.69530528659621, 21.237774128715188, 21.84684548705505, 23.256083384156227, 24.231288618873805, 23.995824709534645, 20.483651880950973, 20.122791570921734, 20.426884428908423, 11.49670900652805, 11.763797624657542, 10.974130759636552, 22.730285753806427, 23.424542544254408, 23.390870923486844, 29.721634621421487, 30.295005189875752, 29.791202294329793, 24.6608050391078, 24.702358715236187, 24.75674013979733, 8.223015956580639, 8.642141830176115, 8.347626879811287, 23.79004573325315, 23.61225006977716, 23.875123056272656, 24.721780620515347, 24.914988676086068, 24.752543732523918, 23.810738436877728, 24.063744572922587, 23.473533168435097, 27.200079714258507, 27.500944291551903, 27.55960975339015, 27.215040420492485, 27.27642061312993, 27.145123576124504, 25.841729318102196, 26.391995608185724, 26.16462395836909, 21.379945966104657, 21.67223725343743, 20.94575403134027, 22.75768070295453, 22.4149379581213, 22.93466450460255, 5.6364210372169765, 5.410605823000267, 5.531462696691349, 18.02797643964489, 17.919382383426026, 18.1738864959528, 27.711953793962792, 28.202987707530454, 28.21059685860139, 25.91888115555048, 25.29945646226406, 25.397213108837605, 22.330738366891936, 22.49734294864659, 21.893051867683724, 18.19499285146594, 17.762423671782017, 18.301662122365087, 26.028292444845036, 26.22726671894391, 26.372933094700173, 28.76938041066751, 28.479517586529255, 28.555286955088377, 34.75214190703505, 34.60597044477859, 34.120920846859605, 19.345588127772004, 19.9119540794442, 19.894017505149037, 24.86474345624447, 25.047413643449545, 25.006578892469406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537399385886043, "mean_inference_ms": 0.7039800637679159, "mean_action_processing_ms": 0.10008662194430404, "mean_env_wait_ms": 0.8093879132748921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1228032, "timesteps_this_iter": 0, "agent_timesteps_total": 3684096, "timers": {"sample_time_ms": 20205.205, "sample_throughput": 474.828, "load_time_ms": 0.3, "load_throughput": 31972153.644, "learn_time_ms": 3111.866, "learn_throughput": 3083.038, "update_time_ms": 9.851}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.573381425146181e-11, "cur_lr": 0.0005, "total_loss": 8.049150049686432, "policy_loss": -0.00016105122928511406, "vf_loss": 8.20000547170639, "vf_explained_var": 0.14370210468769073, "kl": 0.004475578360319395, "entropy": 15.069448828697205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1228032, "num_agent_steps_sampled": 3684096, "num_steps_trained": 1228032, "num_agent_steps_trained": 3684096, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4886, "training_iteration": 128, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-26-22", "timestamp": 1706192782, "time_this_iter_s": 19.012531042099, "time_total_s": 2581.2370116710663, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2581.2370116710663, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 9.648148148148149, "ram_util_percent": 49.1037037037037}}
{"episode_reward_max": 108.27480766549705, "episode_reward_min": -272.8902136827819, "episode_reward_mean": 61.97603773773997, "episode_len_mean": 296.44, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -99.195871591568}, "policy_reward_max": {"shared_policy": 36.32858159517248}, "policy_reward_mean": {"shared_policy": 20.65867924591332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.901984579861136, 83.37980807013808, 63.71177604608238, 72.00751818902789, 22.922057264484437, 74.1858984036371, 53.26614700863135, -272.8902136827819, 83.72097973525523, 83.92556827352382, 67.3371996283531, 76.43233094830066, 34.961703419685364, 69.75080416351554, 63.71240012813357, 62.730057919397936, 66.68413029611108, 71.43466064333914, 70.88291278295216, -268.1613171361387, 88.32345210015772, 46.37010844424364, 40.18819813430309, 74.3753714680206, 79.51541355252265, 48.13052843697366, 79.25328923854977, 67.50322412326932, 53.555787783116074, 71.75763558689505, 50.448060460388646, 46.48826737073247, 73.25992148369548, 87.2987368032336, 64.90971167013049, 94.65757723920976, 92.0746120526455, 86.18918222188948, 53.809554258361445, 68.894747313112, 73.03876099735496, 64.77992490236645, 71.48319671256468, 61.03332788078113, 34.234637390822144, 69.54569922154768, 89.80784210562703, 74.11990389414132, 25.21278466656804, 71.27741885930297, 74.38931302912533, 71.34801617823541, 82.26063375920056, 81.63658460974692, 78.39834888465701, 63.99793725088236, 68.10728316567838, 16.578489556908593, 54.121245319023714, 84.12553836009464, 76.61555072665215, 66.72113318322225, 54.259078645613045, 78.62849225848912, 85.80418495228514, 103.47903319867325, 59.15155971236524, 74.91873599216342, 50.773000719200354, 56.27340854168867, 85.62142483144996, 42.685887368861586, 83.58098703622815, 71.05864433944224, 82.18361976929009, 71.77643298590554, 72.20574119221418, 79.69879885204136, 17.155554942786665, 66.10258012264964, 73.41737035661936, 89.51735012605786, 77.0564499355387, 56.06288265064356, 83.25288515165445, 72.6922378204763, 65.65418987721202, 75.68379440717399, 91.51882447488606, 108.27480766549705, 64.1804456859827, 65.39945339102997, 64.64742356911302, 70.79944980330765, 72.66883867140858, 84.52395216561852, 83.90025986451653, 77.73578318208455, 59.66705932840702, 64.85979310795663], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 157, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 87, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.156811739007622, 20.355856495598943, 20.38931634525457, 27.774556146313742, 27.927445422237113, 27.677806501587227, 19.899740129709244, 22.26874561421573, 21.543290302157402, 23.570105989774063, 24.39404544172187, 24.043366757531956, 7.396893362204224, 7.74047506103912, 7.784688841241092, 24.446441193421677, 25.085789330614105, 24.653667879601315, 17.94849994328493, 17.46662064890066, 17.851026416445762, -96.01713490486145, -88.38543060747907, -88.48764817044139, 27.924370625366763, 28.016281620909766, 27.7803274889787, 27.439975798130035, 28.20860667526722, 28.276985800126567, 22.260792699952916, 22.43231400599082, 22.64409292240937, 25.04120983183384, 25.733659169636667, 25.657461946830153, 11.550953574478626, 11.798502318561077, 11.61224752664566, 23.270566540459782, 23.36171332995096, 23.118524293104798, 21.227987964327127, 21.302793288292975, 21.181618875513465, 20.97666672741373, 20.971137735371784, 20.782253456612423, 22.46142156297961, 22.321905790517718, 21.90080294261375, 23.493030225237206, 23.8580640827616, 24.083566335340336, 23.319304334620625, 23.801251687730343, 23.762356760601193, -99.195871591568, -84.5536761507392, -84.41176939383149, 29.095433106025055, 29.683555730928973, 29.544463263203696, 15.622674754510314, 15.517999144891888, 15.229434544841439, 13.466198533773422, 13.249333627521992, 13.472665973007679, 24.47207721322775, 24.937419950962067, 24.965874303830788, 26.289355774720505, 26.862758492430046, 26.363299285372094, 16.27884931365648, 15.695913578073174, 16.15576554524401, 26.573315556161106, 26.441099857911468, 26.238873824477196, 22.81797168031335, 22.319118559360504, 22.366133883595467, 17.927060207972914, 17.617479401330144, 18.011248173813016, 23.807058326900005, 23.67445047199726, 24.276126787997782, 16.376141314705208, 16.989928544809416, 17.081990600874022, 15.556198531218485, 15.401225617776305, 15.530843221737683, 24.456043678025395, 24.38569330299893, 24.418184502671153, 29.1663818831245, 29.29876785973707, 28.833587060372025, 21.55600082874298, 21.81341363862157, 21.54029720276594, 31.357848192254693, 31.73971415582733, 31.560014891127736, 30.477125058571488, 30.856134517273546, 30.741352476800472, 28.65906226386626, 28.66614895810683, 28.86397099991639, 17.942405705650643, 17.422475655873612, 18.44467289683719, 22.851206717391804, 23.0529266235729, 22.9906139721473, 24.26491258541742, 24.49696687857309, 24.276881533364445, 21.69530528659621, 21.237774128715188, 21.84684548705505, 23.256083384156227, 24.231288618873805, 23.995824709534645, 20.483651880950973, 20.122791570921734, 20.426884428908423, 11.49670900652805, 11.763797624657542, 10.974130759636552, 22.730285753806427, 23.424542544254408, 23.390870923486844, 29.721634621421487, 30.295005189875752, 29.791202294329793, 24.6608050391078, 24.702358715236187, 24.75674013979733, 8.223015956580639, 8.642141830176115, 8.347626879811287, 23.79004573325315, 23.61225006977716, 23.875123056272656, 24.721780620515347, 24.914988676086068, 24.752543732523918, 23.810738436877728, 24.063744572922587, 23.473533168435097, 27.200079714258507, 27.500944291551903, 27.55960975339015, 27.215040420492485, 27.27642061312993, 27.145123576124504, 25.841729318102196, 26.391995608185724, 26.16462395836909, 21.379945966104657, 21.67223725343743, 20.94575403134027, 22.75768070295453, 22.4149379581213, 22.93466450460255, 5.6364210372169765, 5.410605823000267, 5.531462696691349, 18.02797643964489, 17.919382383426026, 18.1738864959528, 27.711953793962792, 28.202987707530454, 28.21059685860139, 25.91888115555048, 25.29945646226406, 25.397213108837605, 22.330738366891936, 22.49734294864659, 21.893051867683724, 18.19499285146594, 17.762423671782017, 18.301662122365087, 26.028292444845036, 26.22726671894391, 26.372933094700173, 28.76938041066751, 28.479517586529255, 28.555286955088377, 34.75214190703505, 34.60597044477859, 34.120920846859605, 19.345588127772004, 19.9119540794442, 19.894017505149037, 24.86474345624447, 25.047413643449545, 25.006578892469406, 17.031476348638535, 17.171987073670607, 16.569537296891212, 18.508502575258404, 18.92495063218908, 18.839955334241182, 28.021198148528725, 28.83106247584024, 28.76916420708099, 13.872908353805542, 14.56386428559199, 14.249114729464054, 27.845661128560693, 27.950625131527573, 27.784700776139886, 23.57026683290799, 23.76579677810271, 23.722580728431538, 27.38725843653083, 27.59008683077991, 27.20627450197935, 23.584467132886246, 24.230787288242325, 23.961178564776972, 23.98398194958766, 24.32696711303045, 23.89479212959607, 26.354964785277843, 26.762411640956998, 26.581422425806522, 5.949442851046712, 5.8674792746702735, 5.33863281706968, 22.329357164601475, 21.89454139272371, 21.878681565324456, 24.59090929478407, 24.253444969654083, 24.573016092181206, 29.39190101623535, 30.024363294243813, 30.1010858155787, 25.772557504940778, 25.771312572294846, 25.51257985830307, 18.496213460961968, 18.97774767006436, 18.58892151961723, 27.682120519379765, 27.952583170185477, 27.61818146208921, 24.193977113813162, 24.21881937980652, 24.279441326856613, 21.96206797907749, 21.719108606378228, 21.973013291756303, 25.090036138892174, 25.174765333533287, 25.41899293474853, 30.377121850848198, 30.897539289668202, 30.24416333436966, 36.137161557873085, 35.809064512451485, 36.32858159517248, 21.424705788493156, 21.549572490155697, 21.20616740733385, 21.53085609525442, 21.942629363096785, 21.92596793267876, 21.63322601467371, 21.720817890018225, 21.29337966442108, 23.234188556671143, 23.76547161489725, 23.79978963173926, 23.885107924540833, 24.3542737973233, 24.429456949544445, 28.219592891012624, 28.110072066386536, 28.194287208219365, 27.795773836473614, 27.82631767789522, 28.278168350147695, 25.92710992445548, 25.967946780224636, 25.84072647740443, 19.884660596648843, 19.896768144021422, 19.885630587736756, 21.492144880195454, 21.917628669490412, 21.450019558270768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15367896706757386, "mean_inference_ms": 0.7038377126110064, "mean_action_processing_ms": 0.10014947577904035, "mean_env_wait_ms": 0.8092595936949546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1237626, "timesteps_this_iter": 0, "agent_timesteps_total": 3712878, "timers": {"sample_time_ms": 20088.684, "sample_throughput": 477.582, "load_time_ms": 0.4, "load_throughput": 23988168.451, "learn_time_ms": 3083.485, "learn_throughput": 3111.414, "update_time_ms": 9.651}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.866907125730905e-12, "cur_lr": 0.0005, "total_loss": 7.144748032093048, "policy_loss": -0.0002434537671656134, "vf_loss": 7.298264265060425, "vf_explained_var": 0.11689285188913345, "kl": 0.00390725856432396, "entropy": 15.327294826507568, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1237626, "num_agent_steps_sampled": 3712878, "num_steps_trained": 1237626, "num_agent_steps_trained": 3712878, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4918, "training_iteration": 129, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-26-42", "timestamp": 1706192802, "time_this_iter_s": 20.323761224746704, "time_total_s": 2601.560772895813, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B00A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2601.560772895813, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 8.506896551724138, "ram_util_percent": 48.83103448275862}}
{"episode_reward_max": 120.75712535344061, "episode_reward_min": -4.051847644150257, "episode_reward_mean": 70.16582996780402, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -1.411212980747223}, "policy_reward_max": {"shared_policy": 40.41722152630487}, "policy_reward_mean": {"shared_policy": 23.388609989268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.25992148369548, 87.2987368032336, 64.90971167013049, 94.65757723920976, 92.0746120526455, 86.18918222188948, 53.809554258361445, 68.894747313112, 73.03876099735496, 64.77992490236645, 71.48319671256468, 61.03332788078113, 34.234637390822144, 69.54569922154768, 89.80784210562703, 74.11990389414132, 25.21278466656804, 71.27741885930297, 74.38931302912533, 71.34801617823541, 82.26063375920056, 81.63658460974692, 78.39834888465701, 63.99793725088236, 68.10728316567838, 16.578489556908593, 54.121245319023714, 84.12553836009464, 76.61555072665215, 66.72113318322225, 54.259078645613045, 78.62849225848912, 85.80418495228514, 103.47903319867325, 59.15155971236524, 74.91873599216342, 50.773000719200354, 56.27340854168867, 85.62142483144996, 42.685887368861586, 83.58098703622815, 71.05864433944224, 82.18361976929009, 71.77643298590554, 72.20574119221418, 79.69879885204136, 17.155554942786665, 66.10258012264964, 73.41737035661936, 89.51735012605786, 77.0564499355387, 56.06288265064356, 83.25288515165445, 72.6922378204763, 65.65418987721202, 75.68379440717399, 91.51882447488606, 108.27480766549705, 64.1804456859827, 65.39945339102997, 64.64742356911302, 70.79944980330765, 72.66883867140858, 84.52395216561852, 83.90025986451653, 77.73578318208455, 59.66705932840702, 64.85979310795663, 120.75712535344061, 89.78425802476701, -4.051847644150257, 109.92755497619507, 18.717961005866528, 55.331046731211245, 61.832416281104074, 49.40425910800694, 65.92069351673125, 73.06626636418511, 68.9756313189864, 58.734469927847385, 63.9782331250608, 73.42196859419343, 53.27652716822922, 92.72091615572572, 75.40158858150242, 83.70038899034259, 75.46200332976878, 76.34645978361368, 77.27200224250555, 68.42066918080673, 61.503865312784896, 30.672447154298425, 76.9890693966299, 75.47809213399886, 63.46531639993189, 74.54222064185885, 84.04225670173763, 66.66206287033853, 83.57748252898453, 80.45156113058326], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.456043678025395, 24.38569330299893, 24.418184502671153, 29.1663818831245, 29.29876785973707, 28.833587060372025, 21.55600082874298, 21.81341363862157, 21.54029720276594, 31.357848192254693, 31.73971415582733, 31.560014891127736, 30.477125058571488, 30.856134517273546, 30.741352476800472, 28.65906226386626, 28.66614895810683, 28.86397099991639, 17.942405705650643, 17.422475655873612, 18.44467289683719, 22.851206717391804, 23.0529266235729, 22.9906139721473, 24.26491258541742, 24.49696687857309, 24.276881533364445, 21.69530528659621, 21.237774128715188, 21.84684548705505, 23.256083384156227, 24.231288618873805, 23.995824709534645, 20.483651880950973, 20.122791570921734, 20.426884428908423, 11.49670900652805, 11.763797624657542, 10.974130759636552, 22.730285753806427, 23.424542544254408, 23.390870923486844, 29.721634621421487, 30.295005189875752, 29.791202294329793, 24.6608050391078, 24.702358715236187, 24.75674013979733, 8.223015956580639, 8.642141830176115, 8.347626879811287, 23.79004573325315, 23.61225006977716, 23.875123056272656, 24.721780620515347, 24.914988676086068, 24.752543732523918, 23.810738436877728, 24.063744572922587, 23.473533168435097, 27.200079714258507, 27.500944291551903, 27.55960975339015, 27.215040420492485, 27.27642061312993, 27.145123576124504, 25.841729318102196, 26.391995608185724, 26.16462395836909, 21.379945966104657, 21.67223725343743, 20.94575403134027, 22.75768070295453, 22.4149379581213, 22.93466450460255, 5.6364210372169765, 5.410605823000267, 5.531462696691349, 18.02797643964489, 17.919382383426026, 18.1738864959528, 27.711953793962792, 28.202987707530454, 28.21059685860139, 25.91888115555048, 25.29945646226406, 25.397213108837605, 22.330738366891936, 22.49734294864659, 21.893051867683724, 18.19499285146594, 17.762423671782017, 18.301662122365087, 26.028292444845036, 26.22726671894391, 26.372933094700173, 28.76938041066751, 28.479517586529255, 28.555286955088377, 34.75214190703505, 34.60597044477859, 34.120920846859605, 19.345588127772004, 19.9119540794442, 19.894017505149037, 24.86474345624447, 25.047413643449545, 25.006578892469406, 17.031476348638535, 17.171987073670607, 16.569537296891212, 18.508502575258404, 18.92495063218908, 18.839955334241182, 28.021198148528725, 28.83106247584024, 28.76916420708099, 13.872908353805542, 14.56386428559199, 14.249114729464054, 27.845661128560693, 27.950625131527573, 27.784700776139886, 23.57026683290799, 23.76579677810271, 23.722580728431538, 27.38725843653083, 27.59008683077991, 27.20627450197935, 23.584467132886246, 24.230787288242325, 23.961178564776972, 23.98398194958766, 24.32696711303045, 23.89479212959607, 26.354964785277843, 26.762411640956998, 26.581422425806522, 5.949442851046712, 5.8674792746702735, 5.33863281706968, 22.329357164601475, 21.89454139272371, 21.878681565324456, 24.59090929478407, 24.253444969654083, 24.573016092181206, 29.39190101623535, 30.024363294243813, 30.1010858155787, 25.772557504940778, 25.771312572294846, 25.51257985830307, 18.496213460961968, 18.97774767006436, 18.58892151961723, 27.682120519379765, 27.952583170185477, 27.61818146208921, 24.193977113813162, 24.21881937980652, 24.279441326856613, 21.96206797907749, 21.719108606378228, 21.973013291756303, 25.090036138892174, 25.174765333533287, 25.41899293474853, 30.377121850848198, 30.897539289668202, 30.24416333436966, 36.137161557873085, 35.809064512451485, 36.32858159517248, 21.424705788493156, 21.549572490155697, 21.20616740733385, 21.53085609525442, 21.942629363096785, 21.92596793267876, 21.63322601467371, 21.720817890018225, 21.29337966442108, 23.234188556671143, 23.76547161489725, 23.79978963173926, 23.885107924540833, 24.3542737973233, 24.429456949544445, 28.219592891012624, 28.110072066386536, 28.194287208219365, 27.795773836473614, 27.82631767789522, 28.278168350147695, 25.92710992445548, 25.967946780224636, 25.84072647740443, 19.884660596648843, 19.896768144021422, 19.885630587736756, 21.492144880195454, 21.917628669490412, 21.450019558270768, 39.945062215129525, 40.41722152630487, 40.39484161200622, 30.091190526882798, 29.559034595886857, 30.134032901997358, -1.411212980747223, -1.3793863728642464, -1.2612482905387878, 36.41505968074003, 36.615109148124844, 36.897386147330195, 6.482570081949234, 6.183701179921627, 6.0516897439956665, 18.51460525020957, 18.068244114518166, 18.74819736648351, 20.576100212832287, 20.55869301160176, 20.697623056670025, 16.811031707872942, 16.765306153645113, 15.827921246488884, 22.033020076652363, 22.01153118660052, 21.876142253478363, 24.357273715237767, 24.11841558913389, 24.590577059813455, 23.10503689696391, 22.919986267884568, 22.950608154137925, 19.445949777960777, 19.844952769577503, 19.443567380309105, 21.499765779823065, 21.36566510796547, 21.112802237272263, 24.084647844235093, 24.450612167517335, 24.886708582441003, 17.615574091672897, 17.996331403031945, 17.66462167352438, 30.86777228116989, 30.79932986944914, 31.053814005106688, 25.160194137444094, 25.18446384494503, 25.0569305991133, 28.124499837557465, 27.819180669883877, 27.756708482901246, 25.15597603842616, 25.199665470048785, 25.10636182129383, 25.636562526226044, 24.960913851857185, 25.748983405530453, 25.75343395024538, 25.684450067579746, 25.834118224680424, 22.726274073123932, 22.388234227895737, 23.306160879787058, 20.592712872972086, 20.243669544657067, 20.667482895155743, 9.6947370916605, 10.545175483450294, 10.432534579187632, 25.197506333390862, 26.128079388911516, 25.663483674327523, 25.045600359638527, 25.12268004318078, 25.30981173117955, 21.293019128342465, 20.85618171592553, 21.3161155556639, 24.879631186525017, 24.513039300839097, 25.149550154494733, 27.72210123141606, 28.059504256894186, 28.26065121342738, 22.018711904684693, 22.057562733689934, 22.585788231963903, 28.20759892960389, 28.077328992386654, 27.29255460699399, 26.910159858564526, 27.081622863809258, 26.459778408209473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15360988837194053, "mean_inference_ms": 0.7036447474171672, "mean_action_processing_ms": 0.1000957300267501, "mean_env_wait_ms": 0.8090675350194855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1247220, "timesteps_this_iter": 0, "agent_timesteps_total": 3741660, "timers": {"sample_time_ms": 19990.163, "sample_throughput": 479.936, "load_time_ms": 0.3, "load_throughput": 31984860.167, "learn_time_ms": 3071.621, "learn_throughput": 3123.432, "update_time_ms": 9.751}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.933453562865452e-12, "cur_lr": 0.0005, "total_loss": 7.414373099803925, "policy_loss": -0.0005580534539251225, "vf_loss": 7.56730443239212, "vf_explained_var": 0.2151978462934494, "kl": 0.004566541145505452, "entropy": 15.23728883266449, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1247220, "num_agent_steps_sampled": 3741660, "num_steps_trained": 1247220, "num_agent_steps_trained": 3741660, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4950, "training_iteration": 130, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-27-02", "timestamp": 1706192822, "time_this_iter_s": 19.641705751419067, "time_total_s": 2621.202478647232, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02078E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2621.202478647232, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 8.27037037037037, "ram_util_percent": 49.585185185185175}}
{"episode_reward_max": 120.75712535344061, "episode_reward_min": -18.359766412526398, "episode_reward_mean": 69.3680723462056, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -6.3089174826939995}, "policy_reward_max": {"shared_policy": 40.41722152630487}, "policy_reward_mean": {"shared_policy": 23.122690782068524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.80418495228514, 103.47903319867325, 59.15155971236524, 74.91873599216342, 50.773000719200354, 56.27340854168867, 85.62142483144996, 42.685887368861586, 83.58098703622815, 71.05864433944224, 82.18361976929009, 71.77643298590554, 72.20574119221418, 79.69879885204136, 17.155554942786665, 66.10258012264964, 73.41737035661936, 89.51735012605786, 77.0564499355387, 56.06288265064356, 83.25288515165445, 72.6922378204763, 65.65418987721202, 75.68379440717399, 91.51882447488606, 108.27480766549705, 64.1804456859827, 65.39945339102997, 64.64742356911302, 70.79944980330765, 72.66883867140858, 84.52395216561852, 83.90025986451653, 77.73578318208455, 59.66705932840702, 64.85979310795663, 120.75712535344061, 89.78425802476701, -4.051847644150257, 109.92755497619507, 18.717961005866528, 55.331046731211245, 61.832416281104074, 49.40425910800694, 65.92069351673125, 73.06626636418511, 68.9756313189864, 58.734469927847385, 63.9782331250608, 73.42196859419343, 53.27652716822922, 92.72091615572572, 75.40158858150242, 83.70038899034259, 75.46200332976878, 76.34645978361368, 77.27200224250555, 68.42066918080673, 61.503865312784896, 30.672447154298425, 76.9890693966299, 75.47809213399886, 63.46531639993189, 74.54222064185885, 84.04225670173763, 66.66206287033853, 83.57748252898453, 80.45156113058326, 62.38908699899912, 68.80268407240509, 57.89570957794783, 92.611924495548, 70.75340548343955, 58.273303023539455, 82.4874810092151, -18.359766412526398, 68.15042027831078, 76.54548776336011, 73.7882977691479, -4.250097211450367, 85.49492370709777, 63.7329298108816, 73.42215103283522, 73.88576626032591, 92.75550828641279, 67.42871967493556, 61.544405311346026, 67.0925742778927, 69.16789403930306, 96.1618156209588, 87.63121269643305, 70.72247358039021, 60.29877174086866, 52.680316112004206, 80.76937615126369, 69.46920031309126, 73.50308280065656, 78.20520619302988, 64.46150928456335, 49.5236486988142], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.76938041066751, 28.479517586529255, 28.555286955088377, 34.75214190703505, 34.60597044477859, 34.120920846859605, 19.345588127772004, 19.9119540794442, 19.894017505149037, 24.86474345624447, 25.047413643449545, 25.006578892469406, 17.031476348638535, 17.171987073670607, 16.569537296891212, 18.508502575258404, 18.92495063218908, 18.839955334241182, 28.021198148528725, 28.83106247584024, 28.76916420708099, 13.872908353805542, 14.56386428559199, 14.249114729464054, 27.845661128560693, 27.950625131527573, 27.784700776139886, 23.57026683290799, 23.76579677810271, 23.722580728431538, 27.38725843653083, 27.59008683077991, 27.20627450197935, 23.584467132886246, 24.230787288242325, 23.961178564776972, 23.98398194958766, 24.32696711303045, 23.89479212959607, 26.354964785277843, 26.762411640956998, 26.581422425806522, 5.949442851046712, 5.8674792746702735, 5.33863281706968, 22.329357164601475, 21.89454139272371, 21.878681565324456, 24.59090929478407, 24.253444969654083, 24.573016092181206, 29.39190101623535, 30.024363294243813, 30.1010858155787, 25.772557504940778, 25.771312572294846, 25.51257985830307, 18.496213460961968, 18.97774767006436, 18.58892151961723, 27.682120519379765, 27.952583170185477, 27.61818146208921, 24.193977113813162, 24.21881937980652, 24.279441326856613, 21.96206797907749, 21.719108606378228, 21.973013291756303, 25.090036138892174, 25.174765333533287, 25.41899293474853, 30.377121850848198, 30.897539289668202, 30.24416333436966, 36.137161557873085, 35.809064512451485, 36.32858159517248, 21.424705788493156, 21.549572490155697, 21.20616740733385, 21.53085609525442, 21.942629363096785, 21.92596793267876, 21.63322601467371, 21.720817890018225, 21.29337966442108, 23.234188556671143, 23.76547161489725, 23.79978963173926, 23.885107924540833, 24.3542737973233, 24.429456949544445, 28.219592891012624, 28.110072066386536, 28.194287208219365, 27.795773836473614, 27.82631767789522, 28.278168350147695, 25.92710992445548, 25.967946780224636, 25.84072647740443, 19.884660596648843, 19.896768144021422, 19.885630587736756, 21.492144880195454, 21.917628669490412, 21.450019558270768, 39.945062215129525, 40.41722152630487, 40.39484161200622, 30.091190526882798, 29.559034595886857, 30.134032901997358, -1.411212980747223, -1.3793863728642464, -1.2612482905387878, 36.41505968074003, 36.615109148124844, 36.897386147330195, 6.482570081949234, 6.183701179921627, 6.0516897439956665, 18.51460525020957, 18.068244114518166, 18.74819736648351, 20.576100212832287, 20.55869301160176, 20.697623056670025, 16.811031707872942, 16.765306153645113, 15.827921246488884, 22.033020076652363, 22.01153118660052, 21.876142253478363, 24.357273715237767, 24.11841558913389, 24.590577059813455, 23.10503689696391, 22.919986267884568, 22.950608154137925, 19.445949777960777, 19.844952769577503, 19.443567380309105, 21.499765779823065, 21.36566510796547, 21.112802237272263, 24.084647844235093, 24.450612167517335, 24.886708582441003, 17.615574091672897, 17.996331403031945, 17.66462167352438, 30.86777228116989, 30.79932986944914, 31.053814005106688, 25.160194137444094, 25.18446384494503, 25.0569305991133, 28.124499837557465, 27.819180669883877, 27.756708482901246, 25.15597603842616, 25.199665470048785, 25.10636182129383, 25.636562526226044, 24.960913851857185, 25.748983405530453, 25.75343395024538, 25.684450067579746, 25.834118224680424, 22.726274073123932, 22.388234227895737, 23.306160879787058, 20.592712872972086, 20.243669544657067, 20.667482895155743, 9.6947370916605, 10.545175483450294, 10.432534579187632, 25.197506333390862, 26.128079388911516, 25.663483674327523, 25.045600359638527, 25.12268004318078, 25.30981173117955, 21.293019128342465, 20.85618171592553, 21.3161155556639, 24.879631186525017, 24.513039300839097, 25.149550154494733, 27.72210123141606, 28.059504256894186, 28.26065121342738, 22.018711904684693, 22.057562733689934, 22.585788231963903, 28.20759892960389, 28.077328992386654, 27.29255460699399, 26.910159858564526, 27.081622863809258, 26.459778408209473, 20.843696132302284, 20.814142994582653, 20.73124787211418, 22.732797784109906, 22.970903941740588, 23.098982346554592, 19.149628202120454, 19.32257269943753, 19.423508676389844, 30.235754509766892, 31.306060270716742, 31.070109715064362, 23.526378040512398, 23.29650691648324, 23.930520526443914, 19.647921742560953, 19.148733536402375, 19.476647744576127, 27.37288103004296, 27.80550769095619, 27.30909228821595, -6.3089174826939995, -6.163857621451228, -5.88699130838117, 22.25733283162117, 22.961880212649703, 22.931207234039903, 25.345267641047627, 25.67856311487654, 25.521657007435948, 24.751034155953676, 24.680898066610098, 24.35636554658413, -1.5512721215685303, -1.20871698235473, -1.4901081075271065, 28.160766780376434, 28.99597528204322, 28.338181644678116, 21.30685821299751, 21.119294819732502, 21.306776778151587, 24.3570165062944, 24.60023711497584, 24.464897411564976, 24.806769028306007, 24.792664296925068, 24.286332935094833, 30.693581407268837, 31.105107183412954, 30.956819695731, 22.761857038130984, 22.278289943933487, 22.388572692871094, 20.550359802941472, 20.22383978466192, 20.770205723742635, 22.092525844772652, 22.336211649080113, 22.66383678403993, 23.47267523035407, 23.47682026773691, 22.218398541212082, 31.9494206905365, 32.06522640585899, 32.14716852456331, 29.30207436283429, 29.333645453055695, 28.99549288054307, 23.74388663098216, 23.613394983112812, 23.365191966295242, 20.09126493210593, 20.224530757094414, 19.982976051668317, 17.401843932767704, 17.599513004844383, 17.67895917439212, 27.20589210341373, 26.931259642044694, 26.63222440580526, 23.043545973797634, 23.152450961371258, 23.27320337792237, 24.573307011276484, 24.31491869688034, 24.614857092499733, 25.9920611679554, 26.31241538375616, 25.90072964131832, 21.190956604977444, 21.744976455656186, 21.52557622392972, 16.4904588026305, 16.56447831386079, 16.46871158232291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15364853602369044, "mean_inference_ms": 0.7037861774118371, "mean_action_processing_ms": 0.100140429501398, "mean_env_wait_ms": 0.8089849993077124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1256814, "timesteps_this_iter": 0, "agent_timesteps_total": 3770442, "timers": {"sample_time_ms": 19876.397, "sample_throughput": 482.683, "load_time_ms": 0.2, "load_throughput": 48002090.631, "learn_time_ms": 3030.948, "learn_throughput": 3165.347, "update_time_ms": 9.658}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.966726781432726e-12, "cur_lr": 0.0005, "total_loss": 7.286531388759613, "policy_loss": 0.0007397555910044762, "vf_loss": 7.440143942832947, "vf_explained_var": 0.028452590107917786, "kl": 0.008436389849708929, "entropy": 15.435264229774475, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1256814, "num_agent_steps_sampled": 3770442, "num_steps_trained": 1256814, "num_agent_steps_trained": 3770442, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4982, "training_iteration": 131, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-27-22", "timestamp": 1706192842, "time_this_iter_s": 19.829086780548096, "time_total_s": 2641.03156542778, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B001F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2641.03156542778, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 8.275, "ram_util_percent": 49.725}}
{"episode_reward_max": 120.75712535344061, "episode_reward_min": -18.359766412526398, "episode_reward_mean": 66.02171131703479, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -6.3089174826939995}, "policy_reward_max": {"shared_policy": 40.41722152630487}, "policy_reward_mean": {"shared_policy": 22.007237105678257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.52395216561852, 83.90025986451653, 77.73578318208455, 59.66705932840702, 64.85979310795663, 120.75712535344061, 89.78425802476701, -4.051847644150257, 109.92755497619507, 18.717961005866528, 55.331046731211245, 61.832416281104074, 49.40425910800694, 65.92069351673125, 73.06626636418511, 68.9756313189864, 58.734469927847385, 63.9782331250608, 73.42196859419343, 53.27652716822922, 92.72091615572572, 75.40158858150242, 83.70038899034259, 75.46200332976878, 76.34645978361368, 77.27200224250555, 68.42066918080673, 61.503865312784896, 30.672447154298425, 76.9890693966299, 75.47809213399886, 63.46531639993189, 74.54222064185885, 84.04225670173763, 66.66206287033853, 83.57748252898453, 80.45156113058326, 62.38908699899912, 68.80268407240509, 57.89570957794783, 92.611924495548, 70.75340548343955, 58.273303023539455, 82.4874810092151, -18.359766412526398, 68.15042027831078, 76.54548776336011, 73.7882977691479, -4.250097211450367, 85.49492370709777, 63.7329298108816, 73.42215103283522, 73.88576626032591, 92.75550828641279, 67.42871967493556, 61.544405311346026, 67.0925742778927, 69.16789403930306, 96.1618156209588, 87.63121269643305, 70.72247358039021, 60.29877174086866, 52.680316112004206, 80.76937615126369, 69.46920031309126, 73.50308280065656, 78.20520619302988, 64.46150928456335, 49.5236486988142, 43.206229731440516, 102.69067391753197, 13.642108812928171, 79.06636602059007, 80.08913072012362, 81.47769530117509, 65.8959709741175, 86.27158719766884, 59.79683805303648, 67.32587001752107, 63.14312879741192, 36.39920757268554, 77.08757775556293, 45.69860789924857, 66.30223916843532, 11.248832874000072, 62.0482110385783, 58.17552841082215, 70.55991611693752, 68.32127775344995, 35.333604081999496, 75.99268348515031, 44.54446825757621, 70.9020822122693, 63.372667899355264, 54.878117992542656, 33.76333190128207, 74.3898528702557, 71.59066424053161, 69.18242247775197, 66.2630016747862], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.219592891012624, 28.110072066386536, 28.194287208219365, 27.795773836473614, 27.82631767789522, 28.278168350147695, 25.92710992445548, 25.967946780224636, 25.84072647740443, 19.884660596648843, 19.896768144021422, 19.885630587736756, 21.492144880195454, 21.917628669490412, 21.450019558270768, 39.945062215129525, 40.41722152630487, 40.39484161200622, 30.091190526882798, 29.559034595886857, 30.134032901997358, -1.411212980747223, -1.3793863728642464, -1.2612482905387878, 36.41505968074003, 36.615109148124844, 36.897386147330195, 6.482570081949234, 6.183701179921627, 6.0516897439956665, 18.51460525020957, 18.068244114518166, 18.74819736648351, 20.576100212832287, 20.55869301160176, 20.697623056670025, 16.811031707872942, 16.765306153645113, 15.827921246488884, 22.033020076652363, 22.01153118660052, 21.876142253478363, 24.357273715237767, 24.11841558913389, 24.590577059813455, 23.10503689696391, 22.919986267884568, 22.950608154137925, 19.445949777960777, 19.844952769577503, 19.443567380309105, 21.499765779823065, 21.36566510796547, 21.112802237272263, 24.084647844235093, 24.450612167517335, 24.886708582441003, 17.615574091672897, 17.996331403031945, 17.66462167352438, 30.86777228116989, 30.79932986944914, 31.053814005106688, 25.160194137444094, 25.18446384494503, 25.0569305991133, 28.124499837557465, 27.819180669883877, 27.756708482901246, 25.15597603842616, 25.199665470048785, 25.10636182129383, 25.636562526226044, 24.960913851857185, 25.748983405530453, 25.75343395024538, 25.684450067579746, 25.834118224680424, 22.726274073123932, 22.388234227895737, 23.306160879787058, 20.592712872972086, 20.243669544657067, 20.667482895155743, 9.6947370916605, 10.545175483450294, 10.432534579187632, 25.197506333390862, 26.128079388911516, 25.663483674327523, 25.045600359638527, 25.12268004318078, 25.30981173117955, 21.293019128342465, 20.85618171592553, 21.3161155556639, 24.879631186525017, 24.513039300839097, 25.149550154494733, 27.72210123141606, 28.059504256894186, 28.26065121342738, 22.018711904684693, 22.057562733689934, 22.585788231963903, 28.20759892960389, 28.077328992386654, 27.29255460699399, 26.910159858564526, 27.081622863809258, 26.459778408209473, 20.843696132302284, 20.814142994582653, 20.73124787211418, 22.732797784109906, 22.970903941740588, 23.098982346554592, 19.149628202120454, 19.32257269943753, 19.423508676389844, 30.235754509766892, 31.306060270716742, 31.070109715064362, 23.526378040512398, 23.29650691648324, 23.930520526443914, 19.647921742560953, 19.148733536402375, 19.476647744576127, 27.37288103004296, 27.80550769095619, 27.30909228821595, -6.3089174826939995, -6.163857621451228, -5.88699130838117, 22.25733283162117, 22.961880212649703, 22.931207234039903, 25.345267641047627, 25.67856311487654, 25.521657007435948, 24.751034155953676, 24.680898066610098, 24.35636554658413, -1.5512721215685303, -1.20871698235473, -1.4901081075271065, 28.160766780376434, 28.99597528204322, 28.338181644678116, 21.30685821299751, 21.119294819732502, 21.306776778151587, 24.3570165062944, 24.60023711497584, 24.464897411564976, 24.806769028306007, 24.792664296925068, 24.286332935094833, 30.693581407268837, 31.105107183412954, 30.956819695731, 22.761857038130984, 22.278289943933487, 22.388572692871094, 20.550359802941472, 20.22383978466192, 20.770205723742635, 22.092525844772652, 22.336211649080113, 22.66383678403993, 23.47267523035407, 23.47682026773691, 22.218398541212082, 31.9494206905365, 32.06522640585899, 32.14716852456331, 29.30207436283429, 29.333645453055695, 28.99549288054307, 23.74388663098216, 23.613394983112812, 23.365191966295242, 20.09126493210593, 20.224530757094414, 19.982976051668317, 17.401843932767704, 17.599513004844383, 17.67895917439212, 27.20589210341373, 26.931259642044694, 26.63222440580526, 23.043545973797634, 23.152450961371258, 23.27320337792237, 24.573307011276484, 24.31491869688034, 24.614857092499733, 25.9920611679554, 26.31241538375616, 25.90072964131832, 21.190956604977444, 21.744976455656186, 21.52557622392972, 16.4904588026305, 16.56447831386079, 16.46871158232291, 14.518569024900586, 14.348024415473134, 14.339636291066796, 34.283706564456224, 34.04935251921415, 34.35761483386159, 4.532946894566209, 4.598288151125104, 4.510873767236859, 26.39944826811552, 26.365156393498182, 26.301761358976364, 26.45684757332006, 26.533058817187936, 27.099224329615623, 27.187697666386754, 27.05712106327215, 27.232876571516186, 21.486325179537133, 22.34290287767847, 22.0667429169019, 28.75909383160372, 28.698490557571247, 28.814002808493868, 19.90927716344595, 19.84933767095208, 20.03822321863845, 22.41777544220288, 22.478503341165677, 22.42959123415251, 21.022147327661514, 21.330026403069496, 20.790955066680908, 12.169223281865314, 12.273415024004251, 11.956569266815976, 25.461694459120423, 25.744173201421887, 25.881710095020622, 15.05831445256868, 15.505675027767808, 15.134618418912083, 22.28612208118041, 21.524672855933503, 22.49144423132141, 3.624797198921442, 3.8529318999499083, 3.771103775128722, 20.749645818024874, 20.94506798358634, 20.353497236967087, 19.497554056346416, 19.4785624332726, 19.199411921203136, 23.20924027760823, 23.48557888468106, 23.865096954648223, 22.789655386159808, 22.712252980719, 22.81936938657114, 12.179100324244544, 11.728814159830407, 11.425689597924546, 25.321074238667876, 25.229111983130366, 25.442497263352067, 14.626338635881737, 14.940981907149151, 14.977147714545325, 23.645205050706863, 23.644791208207607, 23.612085953354836, 21.120418618122727, 21.35245740475753, 20.899791876475007, 18.03951622794071, 18.50876289761314, 18.32983886698881, 11.527540842071176, 11.532678799703717, 10.70311225950718, 24.96326340300341, 24.881471227233604, 24.54511824001868, 23.632126813133553, 23.89580639948447, 24.062731027913586, 23.2022020034492, 22.78436191380024, 23.19585856050253, 21.90580744047959, 22.033696768184498, 22.323497466122106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535859710366883, "mean_inference_ms": 0.7035820576177609, "mean_action_processing_ms": 0.10007314362147303, "mean_env_wait_ms": 0.808776026503426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1266408, "timesteps_this_iter": 0, "agent_timesteps_total": 3799224, "timers": {"sample_time_ms": 19615.321, "sample_throughput": 489.107, "load_time_ms": 0.2, "load_throughput": 48002090.631, "learn_time_ms": 2989.853, "learn_throughput": 3208.854, "update_time_ms": 9.258}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.966726781432726e-12, "cur_lr": 0.0005, "total_loss": 7.049907088279724, "policy_loss": 0.0012217235186436914, "vf_loss": 7.204180896282196, "vf_explained_var": 0.14581989496946335, "kl": 0.008037988853367033, "entropy": 15.549536108970642, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1266408, "num_agent_steps_sampled": 3799224, "num_steps_trained": 1266408, "num_agent_steps_trained": 3799224, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5013, "training_iteration": 132, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-27-41", "timestamp": 1706192861, "time_this_iter_s": 19.176278591156006, "time_total_s": 2660.207844018936, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2660.207844018936, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 9.922222222222224, "ram_util_percent": 49.54814814814816}}
{"episode_reward_max": 102.69067391753197, "episode_reward_min": -18.359766412526398, "episode_reward_mean": 65.93072065120272, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -6.3089174826939995}, "policy_reward_max": {"shared_policy": 34.35761483386159}, "policy_reward_mean": {"shared_policy": 21.976906883734234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.57748252898453, 80.45156113058326, 62.38908699899912, 68.80268407240509, 57.89570957794783, 92.611924495548, 70.75340548343955, 58.273303023539455, 82.4874810092151, -18.359766412526398, 68.15042027831078, 76.54548776336011, 73.7882977691479, -4.250097211450367, 85.49492370709777, 63.7329298108816, 73.42215103283522, 73.88576626032591, 92.75550828641279, 67.42871967493556, 61.544405311346026, 67.0925742778927, 69.16789403930306, 96.1618156209588, 87.63121269643305, 70.72247358039021, 60.29877174086866, 52.680316112004206, 80.76937615126369, 69.46920031309126, 73.50308280065656, 78.20520619302988, 64.46150928456335, 49.5236486988142, 43.206229731440516, 102.69067391753197, 13.642108812928171, 79.06636602059007, 80.08913072012362, 81.47769530117509, 65.8959709741175, 86.27158719766884, 59.79683805303648, 67.32587001752107, 63.14312879741192, 36.39920757268554, 77.08757775556293, 45.69860789924857, 66.30223916843532, 11.248832874000072, 62.0482110385783, 58.17552841082215, 70.55991611693752, 68.32127775344995, 35.333604081999496, 75.99268348515031, 44.54446825757621, 70.9020822122693, 63.372667899355264, 54.878117992542656, 33.76333190128207, 74.3898528702557, 71.59066424053161, 69.18242247775197, 66.2630016747862, 75.7075180923566, 37.25861309841274, 76.31698025017977, 49.82194805145261, 86.84103369712828, 81.06317367777226, 83.21801023185253, 74.69612332992253, 61.675390269141616, 67.3498688302934, 77.00261159241197, 89.77551365457475, 73.41607214510438, 90.0413073678501, 72.94756278558631, 52.59497338812798, 72.23937632888556, 86.82522298023103, 49.7948905415833, 71.6081902096048, 55.151402965188, 59.031506277620764, 50.34184199944136, 87.60532364249228, 88.60567785287276, 70.33748181536792, 87.61820088699457, 30.83558624982834, 78.54789036139846, 55.21038015186787, 66.95924692973492, 82.74166408926249, 44.2909095659852, 53.018562965095015, 62.85364751727319], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.20759892960389, 28.077328992386654, 27.29255460699399, 26.910159858564526, 27.081622863809258, 26.459778408209473, 20.843696132302284, 20.814142994582653, 20.73124787211418, 22.732797784109906, 22.970903941740588, 23.098982346554592, 19.149628202120454, 19.32257269943753, 19.423508676389844, 30.235754509766892, 31.306060270716742, 31.070109715064362, 23.526378040512398, 23.29650691648324, 23.930520526443914, 19.647921742560953, 19.148733536402375, 19.476647744576127, 27.37288103004296, 27.80550769095619, 27.30909228821595, -6.3089174826939995, -6.163857621451228, -5.88699130838117, 22.25733283162117, 22.961880212649703, 22.931207234039903, 25.345267641047627, 25.67856311487654, 25.521657007435948, 24.751034155953676, 24.680898066610098, 24.35636554658413, -1.5512721215685303, -1.20871698235473, -1.4901081075271065, 28.160766780376434, 28.99597528204322, 28.338181644678116, 21.30685821299751, 21.119294819732502, 21.306776778151587, 24.3570165062944, 24.60023711497584, 24.464897411564976, 24.806769028306007, 24.792664296925068, 24.286332935094833, 30.693581407268837, 31.105107183412954, 30.956819695731, 22.761857038130984, 22.278289943933487, 22.388572692871094, 20.550359802941472, 20.22383978466192, 20.770205723742635, 22.092525844772652, 22.336211649080113, 22.66383678403993, 23.47267523035407, 23.47682026773691, 22.218398541212082, 31.9494206905365, 32.06522640585899, 32.14716852456331, 29.30207436283429, 29.333645453055695, 28.99549288054307, 23.74388663098216, 23.613394983112812, 23.365191966295242, 20.09126493210593, 20.224530757094414, 19.982976051668317, 17.401843932767704, 17.599513004844383, 17.67895917439212, 27.20589210341373, 26.931259642044694, 26.63222440580526, 23.043545973797634, 23.152450961371258, 23.27320337792237, 24.573307011276484, 24.31491869688034, 24.614857092499733, 25.9920611679554, 26.31241538375616, 25.90072964131832, 21.190956604977444, 21.744976455656186, 21.52557622392972, 16.4904588026305, 16.56447831386079, 16.46871158232291, 14.518569024900586, 14.348024415473134, 14.339636291066796, 34.283706564456224, 34.04935251921415, 34.35761483386159, 4.532946894566209, 4.598288151125104, 4.510873767236859, 26.39944826811552, 26.365156393498182, 26.301761358976364, 26.45684757332006, 26.533058817187936, 27.099224329615623, 27.187697666386754, 27.05712106327215, 27.232876571516186, 21.486325179537133, 22.34290287767847, 22.0667429169019, 28.75909383160372, 28.698490557571247, 28.814002808493868, 19.90927716344595, 19.84933767095208, 20.03822321863845, 22.41777544220288, 22.478503341165677, 22.42959123415251, 21.022147327661514, 21.330026403069496, 20.790955066680908, 12.169223281865314, 12.273415024004251, 11.956569266815976, 25.461694459120423, 25.744173201421887, 25.881710095020622, 15.05831445256868, 15.505675027767808, 15.134618418912083, 22.28612208118041, 21.524672855933503, 22.49144423132141, 3.624797198921442, 3.8529318999499083, 3.771103775128722, 20.749645818024874, 20.94506798358634, 20.353497236967087, 19.497554056346416, 19.4785624332726, 19.199411921203136, 23.20924027760823, 23.48557888468106, 23.865096954648223, 22.789655386159808, 22.712252980719, 22.81936938657114, 12.179100324244544, 11.728814159830407, 11.425689597924546, 25.321074238667876, 25.229111983130366, 25.442497263352067, 14.626338635881737, 14.940981907149151, 14.977147714545325, 23.645205050706863, 23.644791208207607, 23.612085953354836, 21.120418618122727, 21.35245740475753, 20.899791876475007, 18.03951622794071, 18.50876289761314, 18.32983886698881, 11.527540842071176, 11.532678799703717, 10.70311225950718, 24.96326340300341, 24.881471227233604, 24.54511824001868, 23.632126813133553, 23.89580639948447, 24.062731027913586, 23.2022020034492, 22.78436191380024, 23.19585856050253, 21.90580744047959, 22.033696768184498, 22.323497466122106, 25.17495849231878, 25.41407591259727, 25.118483687440545, 12.58713287239273, 12.461133701105908, 12.210346524914101, 25.26997647434473, 25.29481413960457, 25.75218963623047, 16.519800181190163, 16.542308422426373, 16.75983944783607, 29.06060570230086, 28.546468665202454, 29.233959329624966, 26.770393843452126, 27.018772116551787, 27.27400771776834, 27.61509980261326, 27.818091578781605, 27.78481885045767, 24.837598750988633, 24.791944983104855, 25.06657959582904, 20.338231715063245, 20.614075892294437, 20.723082661783934, 22.442784832169608, 22.34104538460572, 22.566038613518074, 25.81482160339752, 25.524735445777566, 25.663054543236882, 30.097496448084712, 29.86109061539173, 29.81692659109831, 24.31318776557842, 24.575076083342225, 24.527808296183736, 29.990643637254834, 29.97937714867294, 30.071286581922323, 24.212545643250138, 24.06746022651592, 24.667556915820256, 17.38220204412937, 18.017528953962028, 17.195242390036583, 24.2169017419219, 23.950233317911625, 24.07224126905203, 28.7911523108681, 28.86617101480563, 29.167899654557303, 16.34549654275179, 16.749802745878696, 16.699591252952814, 23.752340476959944, 23.943070595152676, 23.91277913749218, 17.77198416988054, 18.43592708806196, 18.9434917072455, 19.485067049662263, 19.681025887529046, 19.865413340429456, 16.583158830801636, 16.803766238192708, 16.954916930447013, 29.138565820952252, 29.07821015765269, 29.388547663887337, 29.730685387272388, 29.25257558375597, 29.6224168818444, 23.518816096087292, 23.42609779288371, 23.39256792639692, 29.232490229109914, 29.170355395103485, 29.215355262781173, 10.487293794751167, 10.572099581360817, 9.776192873716354, 26.139749713242054, 26.291436698287725, 26.11670394986868, 18.415601789951324, 18.388554394245148, 18.406223967671394, 22.084636400143296, 22.644972792516143, 22.22963773707548, 27.539082560688257, 27.545169834047556, 27.657411694526672, 14.51772128045559, 14.858064714819193, 14.91512357071042, 16.99491388599077, 17.73231245080629, 18.291336628297955, 20.467322786649063, 21.327412936448425, 21.0589117941757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15357662709814304, "mean_inference_ms": 0.7034730130238823, "mean_action_processing_ms": 0.1000367738014274, "mean_env_wait_ms": 0.8084842085317117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1276002, "timesteps_this_iter": 0, "agent_timesteps_total": 3828006, "timers": {"sample_time_ms": 19532.897, "sample_throughput": 491.171, "load_time_ms": 0.2, "load_throughput": 48002090.631, "learn_time_ms": 2988.759, "learn_throughput": 3210.028, "update_time_ms": 8.958}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.966726781432726e-12, "cur_lr": 0.0005, "total_loss": 6.318581402301788, "policy_loss": 0.0016375218687008364, "vf_loss": 6.473104238510132, "vf_explained_var": 0.12008458375930786, "kl": 0.008194061345616763, "entropy": 15.616025805473328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1276002, "num_agent_steps_sampled": 3828006, "num_steps_trained": 1276002, "num_agent_steps_trained": 3828006, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5048, "training_iteration": 133, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-28-00", "timestamp": 1706192880, "time_this_iter_s": 19.265012979507446, "time_total_s": 2679.4728569984436, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004C9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2679.4728569984436, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 8.557142857142857, "ram_util_percent": 49.68928571428573}}
{"episode_reward_max": 102.69067391753197, "episode_reward_min": -275.0404435880482, "episode_reward_mean": 63.69160935811524, "episode_len_mean": 299.22, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -95.8536137243112}, "policy_reward_max": {"shared_policy": 34.35761483386159}, "policy_reward_mean": {"shared_policy": 21.230536452705074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.46920031309126, 73.50308280065656, 78.20520619302988, 64.46150928456335, 49.5236486988142, 43.206229731440516, 102.69067391753197, 13.642108812928171, 79.06636602059007, 80.08913072012362, 81.47769530117509, 65.8959709741175, 86.27158719766884, 59.79683805303648, 67.32587001752107, 63.14312879741192, 36.39920757268554, 77.08757775556293, 45.69860789924857, 66.30223916843532, 11.248832874000072, 62.0482110385783, 58.17552841082215, 70.55991611693752, 68.32127775344995, 35.333604081999496, 75.99268348515031, 44.54446825757621, 70.9020822122693, 63.372667899355264, 54.878117992542656, 33.76333190128207, 74.3898528702557, 71.59066424053161, 69.18242247775197, 66.2630016747862, 75.7075180923566, 37.25861309841274, 76.31698025017977, 49.82194805145261, 86.84103369712828, 81.06317367777226, 83.21801023185253, 74.69612332992253, 61.675390269141616, 67.3498688302934, 77.00261159241197, 89.77551365457475, 73.41607214510438, 90.0413073678501, 72.94756278558631, 52.59497338812798, 72.23937632888556, 86.82522298023103, 49.7948905415833, 71.6081902096048, 55.151402965188, 59.031506277620764, 50.34184199944136, 87.60532364249228, 88.60567785287276, 70.33748181536792, 87.61820088699457, 30.83558624982834, 78.54789036139846, 55.21038015186787, 66.95924692973492, 82.74166408926249, 44.2909095659852, 53.018562965095015, 62.85364751727319, 63.846643347293124, 86.29822422098366, 68.05648928135632, 96.40170954540369, 62.74669283255935, 55.68870434910056, 65.85243981331585, 70.19643164612351, 82.21349100768565, 85.10799461230634, 76.80447653494772, 61.5063405036926, 60.973456382751436, -275.0404435880482, 79.859020922333, 92.93667213246226, 58.59996953606604, 85.43493421748279, 95.26131270080802, 79.84973618807271, 65.08378360792993, 48.400016533676535, 67.91609140112995, 77.66177440900356, 64.51616686105261, 86.18909201957283, 70.23555696383117, 51.74048877507448, 47.65742274373767], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.043545973797634, 23.152450961371258, 23.27320337792237, 24.573307011276484, 24.31491869688034, 24.614857092499733, 25.9920611679554, 26.31241538375616, 25.90072964131832, 21.190956604977444, 21.744976455656186, 21.52557622392972, 16.4904588026305, 16.56447831386079, 16.46871158232291, 14.518569024900586, 14.348024415473134, 14.339636291066796, 34.283706564456224, 34.04935251921415, 34.35761483386159, 4.532946894566209, 4.598288151125104, 4.510873767236859, 26.39944826811552, 26.365156393498182, 26.301761358976364, 26.45684757332006, 26.533058817187936, 27.099224329615623, 27.187697666386754, 27.05712106327215, 27.232876571516186, 21.486325179537133, 22.34290287767847, 22.0667429169019, 28.75909383160372, 28.698490557571247, 28.814002808493868, 19.90927716344595, 19.84933767095208, 20.03822321863845, 22.41777544220288, 22.478503341165677, 22.42959123415251, 21.022147327661514, 21.330026403069496, 20.790955066680908, 12.169223281865314, 12.273415024004251, 11.956569266815976, 25.461694459120423, 25.744173201421887, 25.881710095020622, 15.05831445256868, 15.505675027767808, 15.134618418912083, 22.28612208118041, 21.524672855933503, 22.49144423132141, 3.624797198921442, 3.8529318999499083, 3.771103775128722, 20.749645818024874, 20.94506798358634, 20.353497236967087, 19.497554056346416, 19.4785624332726, 19.199411921203136, 23.20924027760823, 23.48557888468106, 23.865096954648223, 22.789655386159808, 22.712252980719, 22.81936938657114, 12.179100324244544, 11.728814159830407, 11.425689597924546, 25.321074238667876, 25.229111983130366, 25.442497263352067, 14.626338635881737, 14.940981907149151, 14.977147714545325, 23.645205050706863, 23.644791208207607, 23.612085953354836, 21.120418618122727, 21.35245740475753, 20.899791876475007, 18.03951622794071, 18.50876289761314, 18.32983886698881, 11.527540842071176, 11.532678799703717, 10.70311225950718, 24.96326340300341, 24.881471227233604, 24.54511824001868, 23.632126813133553, 23.89580639948447, 24.062731027913586, 23.2022020034492, 22.78436191380024, 23.19585856050253, 21.90580744047959, 22.033696768184498, 22.323497466122106, 25.17495849231878, 25.41407591259727, 25.118483687440545, 12.58713287239273, 12.461133701105908, 12.210346524914101, 25.26997647434473, 25.29481413960457, 25.75218963623047, 16.519800181190163, 16.542308422426373, 16.75983944783607, 29.06060570230086, 28.546468665202454, 29.233959329624966, 26.770393843452126, 27.018772116551787, 27.27400771776834, 27.61509980261326, 27.818091578781605, 27.78481885045767, 24.837598750988633, 24.791944983104855, 25.06657959582904, 20.338231715063245, 20.614075892294437, 20.723082661783934, 22.442784832169608, 22.34104538460572, 22.566038613518074, 25.81482160339752, 25.524735445777566, 25.663054543236882, 30.097496448084712, 29.86109061539173, 29.81692659109831, 24.31318776557842, 24.575076083342225, 24.527808296183736, 29.990643637254834, 29.97937714867294, 30.071286581922323, 24.212545643250138, 24.06746022651592, 24.667556915820256, 17.38220204412937, 18.017528953962028, 17.195242390036583, 24.2169017419219, 23.950233317911625, 24.07224126905203, 28.7911523108681, 28.86617101480563, 29.167899654557303, 16.34549654275179, 16.749802745878696, 16.699591252952814, 23.752340476959944, 23.943070595152676, 23.91277913749218, 17.77198416988054, 18.43592708806196, 18.9434917072455, 19.485067049662263, 19.681025887529046, 19.865413340429456, 16.583158830801636, 16.803766238192708, 16.954916930447013, 29.138565820952252, 29.07821015765269, 29.388547663887337, 29.730685387272388, 29.25257558375597, 29.6224168818444, 23.518816096087292, 23.42609779288371, 23.39256792639692, 29.232490229109914, 29.170355395103485, 29.215355262781173, 10.487293794751167, 10.572099581360817, 9.776192873716354, 26.139749713242054, 26.291436698287725, 26.11670394986868, 18.415601789951324, 18.388554394245148, 18.406223967671394, 22.084636400143296, 22.644972792516143, 22.22963773707548, 27.539082560688257, 27.545169834047556, 27.657411694526672, 14.51772128045559, 14.858064714819193, 14.91512357071042, 16.99491388599077, 17.73231245080629, 18.291336628297955, 20.467322786649063, 21.327412936448425, 21.0589117941757, 21.322126259406403, 21.462643334021166, 21.061873753865555, 28.649979087213666, 28.626165392498166, 29.022079741271824, 21.3854699631532, 23.496075240274266, 23.174944077928856, 32.148028458158166, 32.26312038923302, 31.9905606980125, 20.923604503273964, 21.218311678618193, 20.60477665066719, 18.661816506336123, 18.327342490355164, 18.699545352409274, 21.815949281056717, 21.974476122607783, 22.062014409651354, 22.327598949273423, 23.817807679375008, 24.051025017475084, 27.7164330681165, 26.665500362714127, 27.83155757685502, 28.24969546621044, 28.383023494233683, 28.47527565186222, 25.449790636698395, 25.651744137207658, 25.70294176104167, 20.49786082158485, 20.132168183724076, 20.87631149838367, 20.51999808351198, 20.24359409759441, 20.209864201645047, -95.8536137243112, -94.71020277341208, -84.47662709032497, 26.61816218495369, 26.486926838755608, 26.753931898623705, 30.95431363582611, 31.274281930178404, 30.70807656645775, 19.63873344038923, 19.416464013357952, 19.544772082318858, 28.54999705528219, 28.4295700614651, 28.4553671007355, 32.12905922780433, 31.542691121498734, 31.589562351504952, 26.689847603905946, 26.60812446475029, 26.551764119416475, 21.662616675098732, 21.809980535258845, 21.611186397572354, 15.557650089263916, 16.45868810499087, 16.38367833942175, 22.872048274924353, 22.758674037953213, 22.28536908825238, 25.55743944644928, 25.931232392787933, 26.173102569766343, 21.65883030016751, 21.356359930088118, 21.500976630796984, 28.6223511720697, 28.569112117091805, 28.99762873041132, 23.50567167749007, 23.163290118177727, 23.566595168163374, 17.496762447059155, 17.56697668135166, 16.676749646663666, 16.00411086777845, 15.961626465121896, 15.691685410837323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15352382255425964, "mean_inference_ms": 0.7032554063183002, "mean_action_processing_ms": 0.1000275776194446, "mean_env_wait_ms": 0.8082305477361829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1285596, "timesteps_this_iter": 0, "agent_timesteps_total": 3856788, "timers": {"sample_time_ms": 19469.077, "sample_throughput": 492.781, "load_time_ms": 0.2, "load_throughput": 48002090.631, "learn_time_ms": 2991.526, "learn_throughput": 3207.059, "update_time_ms": 8.916}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.966726781432726e-12, "cur_lr": 0.0005, "total_loss": 58.34819269180298, "policy_loss": -3.946263776910541e-05, "vf_loss": 58.507009506225586, "vf_explained_var": 0.15679456293582916, "kl": 0.009056982759117883, "entropy": 15.877960801124573, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1285596, "num_agent_steps_sampled": 3856788, "num_steps_trained": 1285596, "num_agent_steps_trained": 3856788, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5077, "training_iteration": 134, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-28-19", "timestamp": 1706192899, "time_this_iter_s": 18.899914026260376, "time_total_s": 2698.372771024704, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41C649D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2698.372771024704, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 6.5576923076923075, "ram_util_percent": 49.69615384615385}}
{"episode_reward_max": 96.40170954540369, "episode_reward_min": -275.0404435880482, "episode_reward_mean": 65.2466430593183, "episode_len_mean": 299.22, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -95.8536137243112}, "policy_reward_max": {"shared_policy": 32.26312038923302}, "policy_reward_mean": {"shared_policy": 21.74888101977276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.18242247775197, 66.2630016747862, 75.7075180923566, 37.25861309841274, 76.31698025017977, 49.82194805145261, 86.84103369712828, 81.06317367777226, 83.21801023185253, 74.69612332992253, 61.675390269141616, 67.3498688302934, 77.00261159241197, 89.77551365457475, 73.41607214510438, 90.0413073678501, 72.94756278558631, 52.59497338812798, 72.23937632888556, 86.82522298023103, 49.7948905415833, 71.6081902096048, 55.151402965188, 59.031506277620764, 50.34184199944136, 87.60532364249228, 88.60567785287276, 70.33748181536792, 87.61820088699457, 30.83558624982834, 78.54789036139846, 55.21038015186787, 66.95924692973492, 82.74166408926249, 44.2909095659852, 53.018562965095015, 62.85364751727319, 63.846643347293124, 86.29822422098366, 68.05648928135632, 96.40170954540369, 62.74669283255935, 55.68870434910056, 65.85243981331585, 70.19643164612351, 82.21349100768565, 85.10799461230634, 76.80447653494772, 61.5063405036926, 60.973456382751436, -275.0404435880482, 79.859020922333, 92.93667213246226, 58.59996953606604, 85.43493421748279, 95.26131270080802, 79.84973618807271, 65.08378360792993, 48.400016533676535, 67.91609140112995, 77.66177440900356, 64.51616686105261, 86.18909201957283, 70.23555696383117, 51.74048877507448, 47.65742274373767, 87.336245149374, 55.56958559155463, 63.8182431718451, 71.52293696999547, 77.83878116682169, 67.39948868378995, 75.7653752788901, 66.94148084521292, 59.63799595832823, 88.89246153086421, 88.82004329003391, 37.75313901156187, 60.66005523223427, 65.99516513198614, 89.01382001303134, 83.04102056846023, 29.671680733561487, 89.75302822235969, 71.87577788345514, 72.44945085048673, 64.89672560989854, 28.075688301585615, 53.610007375478716, 78.9358909409493, 57.74322853656486, 68.18033108953385, 73.91847059875724, 53.60230404231697, 34.48470013681799, 62.82418406009673, 89.65937378909437, 72.0154383499175, 34.3662138043437, 77.81215656548736], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.2022020034492, 22.78436191380024, 23.19585856050253, 21.90580744047959, 22.033696768184498, 22.323497466122106, 25.17495849231878, 25.41407591259727, 25.118483687440545, 12.58713287239273, 12.461133701105908, 12.210346524914101, 25.26997647434473, 25.29481413960457, 25.75218963623047, 16.519800181190163, 16.542308422426373, 16.75983944783607, 29.06060570230086, 28.546468665202454, 29.233959329624966, 26.770393843452126, 27.018772116551787, 27.27400771776834, 27.61509980261326, 27.818091578781605, 27.78481885045767, 24.837598750988633, 24.791944983104855, 25.06657959582904, 20.338231715063245, 20.614075892294437, 20.723082661783934, 22.442784832169608, 22.34104538460572, 22.566038613518074, 25.81482160339752, 25.524735445777566, 25.663054543236882, 30.097496448084712, 29.86109061539173, 29.81692659109831, 24.31318776557842, 24.575076083342225, 24.527808296183736, 29.990643637254834, 29.97937714867294, 30.071286581922323, 24.212545643250138, 24.06746022651592, 24.667556915820256, 17.38220204412937, 18.017528953962028, 17.195242390036583, 24.2169017419219, 23.950233317911625, 24.07224126905203, 28.7911523108681, 28.86617101480563, 29.167899654557303, 16.34549654275179, 16.749802745878696, 16.699591252952814, 23.752340476959944, 23.943070595152676, 23.91277913749218, 17.77198416988054, 18.43592708806196, 18.9434917072455, 19.485067049662263, 19.681025887529046, 19.865413340429456, 16.583158830801636, 16.803766238192708, 16.954916930447013, 29.138565820952252, 29.07821015765269, 29.388547663887337, 29.730685387272388, 29.25257558375597, 29.6224168818444, 23.518816096087292, 23.42609779288371, 23.39256792639692, 29.232490229109914, 29.170355395103485, 29.215355262781173, 10.487293794751167, 10.572099581360817, 9.776192873716354, 26.139749713242054, 26.291436698287725, 26.11670394986868, 18.415601789951324, 18.388554394245148, 18.406223967671394, 22.084636400143296, 22.644972792516143, 22.22963773707548, 27.539082560688257, 27.545169834047556, 27.657411694526672, 14.51772128045559, 14.858064714819193, 14.91512357071042, 16.99491388599077, 17.73231245080629, 18.291336628297955, 20.467322786649063, 21.327412936448425, 21.0589117941757, 21.322126259406403, 21.462643334021166, 21.061873753865555, 28.649979087213666, 28.626165392498166, 29.022079741271824, 21.3854699631532, 23.496075240274266, 23.174944077928856, 32.148028458158166, 32.26312038923302, 31.9905606980125, 20.923604503273964, 21.218311678618193, 20.60477665066719, 18.661816506336123, 18.327342490355164, 18.699545352409274, 21.815949281056717, 21.974476122607783, 22.062014409651354, 22.327598949273423, 23.817807679375008, 24.051025017475084, 27.7164330681165, 26.665500362714127, 27.83155757685502, 28.24969546621044, 28.383023494233683, 28.47527565186222, 25.449790636698395, 25.651744137207658, 25.70294176104167, 20.49786082158485, 20.132168183724076, 20.87631149838367, 20.51999808351198, 20.24359409759441, 20.209864201645047, -95.8536137243112, -94.71020277341208, -84.47662709032497, 26.61816218495369, 26.486926838755608, 26.753931898623705, 30.95431363582611, 31.274281930178404, 30.70807656645775, 19.63873344038923, 19.416464013357952, 19.544772082318858, 28.54999705528219, 28.4295700614651, 28.4553671007355, 32.12905922780433, 31.542691121498734, 31.589562351504952, 26.689847603905946, 26.60812446475029, 26.551764119416475, 21.662616675098732, 21.809980535258845, 21.611186397572354, 15.557650089263916, 16.45868810499087, 16.38367833942175, 22.872048274924353, 22.758674037953213, 22.28536908825238, 25.55743944644928, 25.931232392787933, 26.173102569766343, 21.65883030016751, 21.356359930088118, 21.500976630796984, 28.6223511720697, 28.569112117091805, 28.99762873041132, 23.50567167749007, 23.163290118177727, 23.566595168163374, 17.496762447059155, 17.56697668135166, 16.676749646663666, 16.00411086777845, 15.961626465121896, 15.691685410837323, 29.0220172231396, 29.180135195453957, 29.134092730780438, 18.435434771080807, 18.611580615242318, 18.522570205231503, 21.275298902764916, 21.190199945122004, 21.352744323958177, 23.71953489879766, 23.924572343627602, 23.878829727570206, 26.013149155924708, 26.108234415451676, 25.717397595445306, 22.47108858575423, 22.281951052447155, 22.646449045588568, 25.466426036010176, 25.384123644481093, 24.914825598398835, 22.231488210459545, 22.31841331471999, 22.391579320033387, 19.685912777980164, 19.5353935410579, 20.41668963929017, 29.595556812981755, 29.693155544499547, 29.60374917338291, 29.86428510087231, 29.527213263014943, 29.428544926146657, 12.69543693214655, 12.35985678434372, 12.697845295071602, 20.034698913494736, 20.255568488190562, 20.369787830548972, 21.724605046212673, 22.04627777263522, 22.224282313138247, 30.016126670564205, 29.238456050554902, 29.75923729191223, 27.384892836213112, 27.78034132346511, 27.875786408782005, 9.553775573770196, 10.422702739636094, 9.695202420155198, 29.95250726832697, 29.9526944408814, 29.84782651315132, 24.05971865666409, 23.79519846787055, 24.020860758920506, 24.431629930312425, 24.439531326914818, 23.578289593259484, 21.90611958752075, 21.94139257321754, 21.04921344916025, 9.643463081680238, 9.02800290286541, 9.404222317039967, 17.924362825850636, 17.91331950078407, 17.77232504884401, 26.409156573315457, 26.50271447313328, 26.02401989450057, 19.503279600758106, 19.188161753118038, 19.051787182688713, 22.47983583559592, 22.787408412744597, 22.913086841193333, 24.42516532043615, 24.541267829636723, 24.952037448684365, 17.320313543081284, 18.204223514534533, 18.077766984701157, 11.389060225337744, 11.620615315623581, 11.475024595856667, 20.798514505227402, 20.871310924490288, 21.154358630379036, 29.693771456678704, 29.914915231366948, 30.050687101048723, 24.17076874213913, 23.74708520869413, 24.09758439908424, 11.285572265585259, 11.628139350175232, 11.45250218858321, 26.40232032785812, 24.770578543345124, 26.63925769428411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15345984120485345, "mean_inference_ms": 0.7030480154426394, "mean_action_processing_ms": 0.10001085866409833, "mean_env_wait_ms": 0.8079018508825105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1295190, "timesteps_this_iter": 0, "agent_timesteps_total": 3885570, "timers": {"sample_time_ms": 19432.576, "sample_throughput": 493.707, "load_time_ms": 0.1, "load_throughput": 96061476.667, "learn_time_ms": 3013.754, "learn_throughput": 3183.405, "update_time_ms": 8.314}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.966726781432726e-12, "cur_lr": 0.0005, "total_loss": 6.665207743644714, "policy_loss": -0.0005134639485464554, "vf_loss": 6.820979118347168, "vf_explained_var": 0.06554858386516571, "kl": 0.0049966787193734055, "entropy": 15.525796890258789, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1295190, "num_agent_steps_sampled": 3885570, "num_steps_trained": 1295190, "num_agent_steps_trained": 3885570, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5111, "training_iteration": 135, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-28-39", "timestamp": 1706192919, "time_this_iter_s": 20.093987703323364, "time_total_s": 2718.4667587280273, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A101F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2718.4667587280273, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 11.168965517241379, "ram_util_percent": 49.98620689655172}}
{"episode_reward_max": 101.80544141680001, "episode_reward_min": -299.5747686419636, "episode_reward_mean": 60.364968807794504, "episode_len_mean": 296.7, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -106.74995487431686}, "policy_reward_max": {"shared_policy": 34.10558567692836}, "policy_reward_mean": {"shared_policy": 20.12165626926483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.21038015186787, 66.95924692973492, 82.74166408926249, 44.2909095659852, 53.018562965095015, 62.85364751727319, 63.846643347293124, 86.29822422098366, 68.05648928135632, 96.40170954540369, 62.74669283255935, 55.68870434910056, 65.85243981331585, 70.19643164612351, 82.21349100768565, 85.10799461230634, 76.80447653494772, 61.5063405036926, 60.973456382751436, -275.0404435880482, 79.859020922333, 92.93667213246226, 58.59996953606604, 85.43493421748279, 95.26131270080802, 79.84973618807271, 65.08378360792993, 48.400016533676535, 67.91609140112995, 77.66177440900356, 64.51616686105261, 86.18909201957283, 70.23555696383117, 51.74048877507448, 47.65742274373767, 87.336245149374, 55.56958559155463, 63.8182431718451, 71.52293696999547, 77.83878116682169, 67.39948868378995, 75.7653752788901, 66.94148084521292, 59.63799595832823, 88.89246153086421, 88.82004329003391, 37.75313901156187, 60.66005523223427, 65.99516513198614, 89.01382001303134, 83.04102056846023, 29.671680733561487, 89.75302822235969, 71.87577788345514, 72.44945085048673, 64.89672560989854, 28.075688301585615, 53.610007375478716, 78.9358909409493, 57.74322853656486, 68.18033108953385, 73.91847059875724, 53.60230404231697, 34.48470013681799, 62.82418406009673, 89.65937378909437, 72.0154383499175, 34.3662138043437, 77.81215656548736, 68.12511605396865, 93.43797871470451, 84.26416379213332, 52.779445331543684, 45.03743853233753, 101.80544141680001, 79.37678389251232, 54.244004664011285, 81.43593379855155, 74.69301732629538, 68.4739441052079, 75.91615682095286, 62.8295026673004, 41.81963301077482, 32.03729100152849, 38.363857578486204, 85.16576329432426, -299.5747686419636, 45.30271082930264, 73.14043844654223, 5.913082469254704, 97.09731283597647, 49.49813029915093, 68.68689395859835, 81.38010451570153, 91.78196121007203, 74.26960541587322, 67.68173654656854, 84.5101366061717, 81.35362028703092, 24.700854794122264], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.415601789951324, 18.388554394245148, 18.406223967671394, 22.084636400143296, 22.644972792516143, 22.22963773707548, 27.539082560688257, 27.545169834047556, 27.657411694526672, 14.51772128045559, 14.858064714819193, 14.91512357071042, 16.99491388599077, 17.73231245080629, 18.291336628297955, 20.467322786649063, 21.327412936448425, 21.0589117941757, 21.322126259406403, 21.462643334021166, 21.061873753865555, 28.649979087213666, 28.626165392498166, 29.022079741271824, 21.3854699631532, 23.496075240274266, 23.174944077928856, 32.148028458158166, 32.26312038923302, 31.9905606980125, 20.923604503273964, 21.218311678618193, 20.60477665066719, 18.661816506336123, 18.327342490355164, 18.699545352409274, 21.815949281056717, 21.974476122607783, 22.062014409651354, 22.327598949273423, 23.817807679375008, 24.051025017475084, 27.7164330681165, 26.665500362714127, 27.83155757685502, 28.24969546621044, 28.383023494233683, 28.47527565186222, 25.449790636698395, 25.651744137207658, 25.70294176104167, 20.49786082158485, 20.132168183724076, 20.87631149838367, 20.51999808351198, 20.24359409759441, 20.209864201645047, -95.8536137243112, -94.71020277341208, -84.47662709032497, 26.61816218495369, 26.486926838755608, 26.753931898623705, 30.95431363582611, 31.274281930178404, 30.70807656645775, 19.63873344038923, 19.416464013357952, 19.544772082318858, 28.54999705528219, 28.4295700614651, 28.4553671007355, 32.12905922780433, 31.542691121498734, 31.589562351504952, 26.689847603905946, 26.60812446475029, 26.551764119416475, 21.662616675098732, 21.809980535258845, 21.611186397572354, 15.557650089263916, 16.45868810499087, 16.38367833942175, 22.872048274924353, 22.758674037953213, 22.28536908825238, 25.55743944644928, 25.931232392787933, 26.173102569766343, 21.65883030016751, 21.356359930088118, 21.500976630796984, 28.6223511720697, 28.569112117091805, 28.99762873041132, 23.50567167749007, 23.163290118177727, 23.566595168163374, 17.496762447059155, 17.56697668135166, 16.676749646663666, 16.00411086777845, 15.961626465121896, 15.691685410837323, 29.0220172231396, 29.180135195453957, 29.134092730780438, 18.435434771080807, 18.611580615242318, 18.522570205231503, 21.275298902764916, 21.190199945122004, 21.352744323958177, 23.71953489879766, 23.924572343627602, 23.878829727570206, 26.013149155924708, 26.108234415451676, 25.717397595445306, 22.47108858575423, 22.281951052447155, 22.646449045588568, 25.466426036010176, 25.384123644481093, 24.914825598398835, 22.231488210459545, 22.31841331471999, 22.391579320033387, 19.685912777980164, 19.5353935410579, 20.41668963929017, 29.595556812981755, 29.693155544499547, 29.60374917338291, 29.86428510087231, 29.527213263014943, 29.428544926146657, 12.69543693214655, 12.35985678434372, 12.697845295071602, 20.034698913494736, 20.255568488190562, 20.369787830548972, 21.724605046212673, 22.04627777263522, 22.224282313138247, 30.016126670564205, 29.238456050554902, 29.75923729191223, 27.384892836213112, 27.78034132346511, 27.875786408782005, 9.553775573770196, 10.422702739636094, 9.695202420155198, 29.95250726832697, 29.9526944408814, 29.84782651315132, 24.05971865666409, 23.79519846787055, 24.020860758920506, 24.431629930312425, 24.439531326914818, 23.578289593259484, 21.90611958752075, 21.94139257321754, 21.04921344916025, 9.643463081680238, 9.02800290286541, 9.404222317039967, 17.924362825850636, 17.91331950078407, 17.77232504884401, 26.409156573315457, 26.50271447313328, 26.02401989450057, 19.503279600758106, 19.188161753118038, 19.051787182688713, 22.47983583559592, 22.787408412744597, 22.913086841193333, 24.42516532043615, 24.541267829636723, 24.952037448684365, 17.320313543081284, 18.204223514534533, 18.077766984701157, 11.389060225337744, 11.620615315623581, 11.475024595856667, 20.798514505227402, 20.871310924490288, 21.154358630379036, 29.693771456678704, 29.914915231366948, 30.050687101048723, 24.17076874213913, 23.74708520869413, 24.09758439908424, 11.285572265585259, 11.628139350175232, 11.45250218858321, 26.40232032785812, 24.770578543345124, 26.63925769428411, 22.36335877080758, 23.139540159453944, 22.62221712370713, 31.18983670324087, 30.942006215453148, 31.306135796010494, 27.997903441389397, 28.231104676922158, 28.035155673821762, 18.363885786384344, 17.77998648583889, 16.63557305932045, 14.947324068595961, 14.95775333543618, 15.13236112830539, 33.74375661214192, 34.10558567692836, 33.95609912772973, 26.5442506223917, 26.616000458598137, 26.216532811522484, 18.04212661584218, 17.96039542307456, 18.241482625094548, 26.817033891876534, 27.090549175937966, 27.528350730737046, 24.923681288957596, 24.799201868474483, 24.970134168863297, 22.76555863519509, 23.05083819975455, 22.657547270258263, 25.192830840746552, 25.59929625938335, 25.12402972082296, 20.70168513804674, 21.187977916561067, 20.939839612692595, 13.791477459172398, 13.9671850974361, 14.060970454166323, 10.2582779576381, 10.568702598412827, 11.21031044547756, 12.386205032467842, 13.076981626451015, 12.900670919567347, 28.219674823184803, 28.334783797462777, 28.611304673676685, -95.93581757384042, -106.74995487431686, -96.88899619380634, 14.992891142765671, 15.11603510255614, 15.193784583980829, 24.41476963095677, 24.37861991797884, 24.347048897606626, 1.9241011316577499, 1.9273154611388748, 2.061665876458079, 32.45163745557268, 32.015645181139305, 32.63003019926448, 16.613487487037972, 16.533176039656, 16.35146677245696, 22.63605325917402, 22.911568018297345, 23.139272681126982, 26.869515776634216, 27.03764222562313, 27.472946513444185, 30.365875152250126, 30.766522095849112, 30.649563961972788, 24.82265658428271, 24.52197953810294, 24.924969293487564, 22.048176060120255, 22.719936853895575, 22.913623632552714, 28.349318801114947, 27.833633961776883, 28.32718384327987, 27.216582787533596, 26.972319339712456, 27.16471815978487, 8.050043513377503, 8.265504674365118, 8.385306606379643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15341330852226442, "mean_inference_ms": 0.7030229227811408, "mean_action_processing_ms": 0.10001850096444212, "mean_env_wait_ms": 0.8077728322290559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1304784, "timesteps_this_iter": 0, "agent_timesteps_total": 3914352, "timers": {"sample_time_ms": 19485.007, "sample_throughput": 492.379, "load_time_ms": 0.1, "load_throughput": 96061476.667, "learn_time_ms": 3052.953, "learn_throughput": 3142.531, "update_time_ms": 8.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 43.26384925842285, "policy_loss": -0.0006459605759927545, "vf_loss": 43.42374849319458, "vf_explained_var": 0.054792582988739014, "kl": 0.0075673780813484545, "entropy": 15.925270795822144, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1304784, "num_agent_steps_sampled": 3914352, "num_steps_trained": 1304784, "num_agent_steps_trained": 3914352, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5142, "training_iteration": 136, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-28-59", "timestamp": 1706192939, "time_this_iter_s": 19.794695615768433, "time_total_s": 2738.261454343796, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2738.261454343796, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 7.139285714285714, "ram_util_percent": 50.40357142857143}}
{"episode_reward_max": 101.80544141680001, "episode_reward_min": -299.5747686419636, "episode_reward_mean": 53.12869100221723, "episode_len_mean": 294.44, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -106.74995487431686}, "policy_reward_max": {"shared_policy": 34.10558567692836}, "policy_reward_mean": {"shared_policy": 17.70956366740574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.65742274373767, 87.336245149374, 55.56958559155463, 63.8182431718451, 71.52293696999547, 77.83878116682169, 67.39948868378995, 75.7653752788901, 66.94148084521292, 59.63799595832823, 88.89246153086421, 88.82004329003391, 37.75313901156187, 60.66005523223427, 65.99516513198614, 89.01382001303134, 83.04102056846023, 29.671680733561487, 89.75302822235969, 71.87577788345514, 72.44945085048673, 64.89672560989854, 28.075688301585615, 53.610007375478716, 78.9358909409493, 57.74322853656486, 68.18033108953385, 73.91847059875724, 53.60230404231697, 34.48470013681799, 62.82418406009673, 89.65937378909437, 72.0154383499175, 34.3662138043437, 77.81215656548736, 68.12511605396865, 93.43797871470451, 84.26416379213332, 52.779445331543684, 45.03743853233753, 101.80544141680001, 79.37678389251232, 54.244004664011285, 81.43593379855155, 74.69301732629538, 68.4739441052079, 75.91615682095286, 62.8295026673004, 41.81963301077482, 32.03729100152849, 38.363857578486204, 85.16576329432426, -299.5747686419636, 45.30271082930264, 73.14043844654223, 5.913082469254704, 97.09731283597647, 49.49813029915093, 68.68689395859835, 81.38010451570153, 91.78196121007203, 74.26960541587322, 67.68173654656854, 84.5101366061717, 81.35362028703092, 24.700854794122264, 33.45236938819289, 67.94821093417704, 63.349003595765666, 75.40350139513612, 21.86050545424223, 65.6683591697365, 46.052492305636406, 68.65434751659629, 99.3594279810786, 53.820000015199184, 57.44936142861842, 89.87124535441399, 76.71950947493312, 68.61113008111715, 60.135201599448905, 82.32719452213495, 46.875847816467285, 75.39747262001038, 5.906758088618503, 88.76654593273997, 51.335616387426825, 39.401093024760456, 71.55733418720772, -1.01504323258996, 99.75077959895133, 66.63940377719697, 62.08180856332183, 50.707449786365004, -260.60606345534325, -276.6937578469515, 56.12591110728681, 31.96888303756711, 48.13711079000494, 38.764887019991875], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 179, 117, 300, 300, 300, 300], "policy_shared_policy_reward": [16.00411086777845, 15.961626465121896, 15.691685410837323, 29.0220172231396, 29.180135195453957, 29.134092730780438, 18.435434771080807, 18.611580615242318, 18.522570205231503, 21.275298902764916, 21.190199945122004, 21.352744323958177, 23.71953489879766, 23.924572343627602, 23.878829727570206, 26.013149155924708, 26.108234415451676, 25.717397595445306, 22.47108858575423, 22.281951052447155, 22.646449045588568, 25.466426036010176, 25.384123644481093, 24.914825598398835, 22.231488210459545, 22.31841331471999, 22.391579320033387, 19.685912777980164, 19.5353935410579, 20.41668963929017, 29.595556812981755, 29.693155544499547, 29.60374917338291, 29.86428510087231, 29.527213263014943, 29.428544926146657, 12.69543693214655, 12.35985678434372, 12.697845295071602, 20.034698913494736, 20.255568488190562, 20.369787830548972, 21.724605046212673, 22.04627777263522, 22.224282313138247, 30.016126670564205, 29.238456050554902, 29.75923729191223, 27.384892836213112, 27.78034132346511, 27.875786408782005, 9.553775573770196, 10.422702739636094, 9.695202420155198, 29.95250726832697, 29.9526944408814, 29.84782651315132, 24.05971865666409, 23.79519846787055, 24.020860758920506, 24.431629930312425, 24.439531326914818, 23.578289593259484, 21.90611958752075, 21.94139257321754, 21.04921344916025, 9.643463081680238, 9.02800290286541, 9.404222317039967, 17.924362825850636, 17.91331950078407, 17.77232504884401, 26.409156573315457, 26.50271447313328, 26.02401989450057, 19.503279600758106, 19.188161753118038, 19.051787182688713, 22.47983583559592, 22.787408412744597, 22.913086841193333, 24.42516532043615, 24.541267829636723, 24.952037448684365, 17.320313543081284, 18.204223514534533, 18.077766984701157, 11.389060225337744, 11.620615315623581, 11.475024595856667, 20.798514505227402, 20.871310924490288, 21.154358630379036, 29.693771456678704, 29.914915231366948, 30.050687101048723, 24.17076874213913, 23.74708520869413, 24.09758439908424, 11.285572265585259, 11.628139350175232, 11.45250218858321, 26.40232032785812, 24.770578543345124, 26.63925769428411, 22.36335877080758, 23.139540159453944, 22.62221712370713, 31.18983670324087, 30.942006215453148, 31.306135796010494, 27.997903441389397, 28.231104676922158, 28.035155673821762, 18.363885786384344, 17.77998648583889, 16.63557305932045, 14.947324068595961, 14.95775333543618, 15.13236112830539, 33.74375661214192, 34.10558567692836, 33.95609912772973, 26.5442506223917, 26.616000458598137, 26.216532811522484, 18.04212661584218, 17.96039542307456, 18.241482625094548, 26.817033891876534, 27.090549175937966, 27.528350730737046, 24.923681288957596, 24.799201868474483, 24.970134168863297, 22.76555863519509, 23.05083819975455, 22.657547270258263, 25.192830840746552, 25.59929625938335, 25.12402972082296, 20.70168513804674, 21.187977916561067, 20.939839612692595, 13.791477459172398, 13.9671850974361, 14.060970454166323, 10.2582779576381, 10.568702598412827, 11.21031044547756, 12.386205032467842, 13.076981626451015, 12.900670919567347, 28.219674823184803, 28.334783797462777, 28.611304673676685, -95.93581757384042, -106.74995487431686, -96.88899619380634, 14.992891142765671, 15.11603510255614, 15.193784583980829, 24.41476963095677, 24.37861991797884, 24.347048897606626, 1.9241011316577499, 1.9273154611388748, 2.061665876458079, 32.45163745557268, 32.015645181139305, 32.63003019926448, 16.613487487037972, 16.533176039656, 16.35146677245696, 22.63605325917402, 22.911568018297345, 23.139272681126982, 26.869515776634216, 27.03764222562313, 27.472946513444185, 30.365875152250126, 30.766522095849112, 30.649563961972788, 24.82265658428271, 24.52197953810294, 24.924969293487564, 22.048176060120255, 22.719936853895575, 22.913623632552714, 28.349318801114947, 27.833633961776883, 28.32718384327987, 27.216582787533596, 26.972319339712456, 27.16471815978487, 8.050043513377503, 8.265504674365118, 8.385306606379643, 11.386728405952454, 11.606441464275122, 10.459199517965317, 22.436810463666916, 22.471990913152695, 23.03940955735743, 21.132941765089825, 20.84750447173913, 21.368557358936712, 25.12266567721963, 25.08831537142396, 25.19252034649253, 7.015270181000233, 7.404025299474597, 7.4412099737674, 21.83266083523631, 21.83687099069357, 21.998827343806624, 15.459749415516853, 15.317211836576462, 15.27553105354309, 23.064770030478627, 22.737808043758065, 22.851769442359597, 33.040911267201096, 33.081713924805314, 33.236802789072186, 17.514297410845757, 18.186817288398743, 18.118885315954685, 18.997782607873276, 19.0301128377517, 19.42146598299344, 30.158148728311062, 29.796912133693695, 29.91618449240923, 25.616019542018563, 25.52393967906633, 25.579550253848225, 22.838393952697515, 22.885632812976837, 22.8871033154428, 20.154451744010046, 19.974451397856072, 20.006298457582787, 27.7495155626287, 26.784365852673844, 27.7933131068324, 15.477463819086552, 15.756842393428087, 15.641541603952646, 25.320638597011566, 25.128362357616425, 24.948471665382385, 2.1224162740011963, 1.985985209544495, 1.7983566050728115, 29.272550866007805, 29.830164965242147, 29.66383010149002, 17.13823353747526, 17.274657952288777, 16.92272489766279, 13.149177218476922, 12.978793169061333, 13.273122637222201, 23.56098015854755, 24.108853442051128, 23.887500586609036, -0.6497023105621338, 0.03239355608820915, -0.39773447811603546, 32.7648730178674, 33.31039670606454, 33.67550987501939, 22.237949344019086, 22.4943767680476, 21.907077665130288, 20.671420998871326, 20.545592986047268, 20.864794578403234, 16.765857147673756, 16.97820500905314, 16.963387629638106, -97.64218946297964, -81.60465096433958, -81.35922302802405, -103.29525291919708, -86.79905358701944, -86.59945134073496, 18.839671408757567, 18.56845597922802, 18.717783719301224, 10.954172159234673, 10.832487786809594, 10.182223091522843, 16.015214574833706, 15.883832116921738, 16.238064098249495, 12.876247346401215, 12.927453696727753, 12.961185976862907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15334117906894193, "mean_inference_ms": 0.7028326094905393, "mean_action_processing_ms": 0.09994638412534215, "mean_env_wait_ms": 0.8075372917066609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1314378, "timesteps_this_iter": 0, "agent_timesteps_total": 3943134, "timers": {"sample_time_ms": 19636.12, "sample_throughput": 488.589, "load_time_ms": 0.1, "load_throughput": 96061476.667, "learn_time_ms": 3081.171, "learn_throughput": 3113.752, "update_time_ms": 8.361}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 103.36244869232178, "policy_loss": -0.0008220128731653009, "vf_loss": 103.51872253417969, "vf_explained_var": 0.09522918611764908, "kl": 0.013860889739780596, "entropy": 15.545392751693726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1314378, "num_agent_steps_sampled": 3943134, "num_steps_trained": 1314378, "num_agent_steps_trained": 3943134, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5176, "training_iteration": 137, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-29-20", "timestamp": 1706192960, "time_this_iter_s": 20.293492078781128, "time_total_s": 2758.554946422577, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01626CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2758.554946422577, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 9.760714285714286, "ram_util_percent": 51.528571428571425}}
{"episode_reward_max": 102.73081160709259, "episode_reward_min": -299.5747686419636, "episode_reward_mean": 48.79581179069996, "episode_len_mean": 291.92, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -106.74995487431686}, "policy_reward_max": {"shared_policy": 34.49987910563746}, "policy_reward_mean": {"shared_policy": 16.265270596899978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.3662138043437, 77.81215656548736, 68.12511605396865, 93.43797871470451, 84.26416379213332, 52.779445331543684, 45.03743853233753, 101.80544141680001, 79.37678389251232, 54.244004664011285, 81.43593379855155, 74.69301732629538, 68.4739441052079, 75.91615682095286, 62.8295026673004, 41.81963301077482, 32.03729100152849, 38.363857578486204, 85.16576329432426, -299.5747686419636, 45.30271082930264, 73.14043844654223, 5.913082469254704, 97.09731283597647, 49.49813029915093, 68.68689395859835, 81.38010451570153, 91.78196121007203, 74.26960541587322, 67.68173654656854, 84.5101366061717, 81.35362028703092, 24.700854794122264, 33.45236938819289, 67.94821093417704, 63.349003595765666, 75.40350139513612, 21.86050545424223, 65.6683591697365, 46.052492305636406, 68.65434751659629, 99.3594279810786, 53.820000015199184, 57.44936142861842, 89.87124535441399, 76.71950947493312, 68.61113008111715, 60.135201599448905, 82.32719452213495, 46.875847816467285, 75.39747262001038, 5.906758088618503, 88.76654593273997, 51.335616387426825, 39.401093024760456, 71.55733418720772, -1.01504323258996, 99.75077959895133, 66.63940377719697, 62.08180856332183, 50.707449786365004, -260.60606345534325, -276.6937578469515, 56.12591110728681, 31.96888303756711, 48.13711079000494, 38.764887019991875, 85.85717935115099, 87.45930976606903, -299.17808678373694, 67.38633569236845, 25.750290379393817, 59.06050346046683, 69.33643304556607, 21.08421944081782, 54.91558721056208, 78.76510748825964, 93.6024486273527, 65.01244453480467, 72.81408539600669, 82.1395163796842, 58.57668773457408, 70.35280449641867, 22.620447851717444, 81.00326539203523, 74.17195318732409, 63.83911935612559, 62.69913361221552, 47.152143590152235, 53.12842854857445, 102.73081160709259, 39.513422172516556, 72.43349186051636, 83.41472444357349, 58.71525586646749, 57.44977339357136, 76.10111081972717, 71.46318889455867, 50.61882957536724, 46.08165331557393], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 179, 117, 300, 300, 300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.285572265585259, 11.628139350175232, 11.45250218858321, 26.40232032785812, 24.770578543345124, 26.63925769428411, 22.36335877080758, 23.139540159453944, 22.62221712370713, 31.18983670324087, 30.942006215453148, 31.306135796010494, 27.997903441389397, 28.231104676922158, 28.035155673821762, 18.363885786384344, 17.77998648583889, 16.63557305932045, 14.947324068595961, 14.95775333543618, 15.13236112830539, 33.74375661214192, 34.10558567692836, 33.95609912772973, 26.5442506223917, 26.616000458598137, 26.216532811522484, 18.04212661584218, 17.96039542307456, 18.241482625094548, 26.817033891876534, 27.090549175937966, 27.528350730737046, 24.923681288957596, 24.799201868474483, 24.970134168863297, 22.76555863519509, 23.05083819975455, 22.657547270258263, 25.192830840746552, 25.59929625938335, 25.12402972082296, 20.70168513804674, 21.187977916561067, 20.939839612692595, 13.791477459172398, 13.9671850974361, 14.060970454166323, 10.2582779576381, 10.568702598412827, 11.21031044547756, 12.386205032467842, 13.076981626451015, 12.900670919567347, 28.219674823184803, 28.334783797462777, 28.611304673676685, -95.93581757384042, -106.74995487431686, -96.88899619380634, 14.992891142765671, 15.11603510255614, 15.193784583980829, 24.41476963095677, 24.37861991797884, 24.347048897606626, 1.9241011316577499, 1.9273154611388748, 2.061665876458079, 32.45163745557268, 32.015645181139305, 32.63003019926448, 16.613487487037972, 16.533176039656, 16.35146677245696, 22.63605325917402, 22.911568018297345, 23.139272681126982, 26.869515776634216, 27.03764222562313, 27.472946513444185, 30.365875152250126, 30.766522095849112, 30.649563961972788, 24.82265658428271, 24.52197953810294, 24.924969293487564, 22.048176060120255, 22.719936853895575, 22.913623632552714, 28.349318801114947, 27.833633961776883, 28.32718384327987, 27.216582787533596, 26.972319339712456, 27.16471815978487, 8.050043513377503, 8.265504674365118, 8.385306606379643, 11.386728405952454, 11.606441464275122, 10.459199517965317, 22.436810463666916, 22.471990913152695, 23.03940955735743, 21.132941765089825, 20.84750447173913, 21.368557358936712, 25.12266567721963, 25.08831537142396, 25.19252034649253, 7.015270181000233, 7.404025299474597, 7.4412099737674, 21.83266083523631, 21.83687099069357, 21.998827343806624, 15.459749415516853, 15.317211836576462, 15.27553105354309, 23.064770030478627, 22.737808043758065, 22.851769442359597, 33.040911267201096, 33.081713924805314, 33.236802789072186, 17.514297410845757, 18.186817288398743, 18.118885315954685, 18.997782607873276, 19.0301128377517, 19.42146598299344, 30.158148728311062, 29.796912133693695, 29.91618449240923, 25.616019542018563, 25.52393967906633, 25.579550253848225, 22.838393952697515, 22.885632812976837, 22.8871033154428, 20.154451744010046, 19.974451397856072, 20.006298457582787, 27.7495155626287, 26.784365852673844, 27.7933131068324, 15.477463819086552, 15.756842393428087, 15.641541603952646, 25.320638597011566, 25.128362357616425, 24.948471665382385, 2.1224162740011963, 1.985985209544495, 1.7983566050728115, 29.272550866007805, 29.830164965242147, 29.66383010149002, 17.13823353747526, 17.274657952288777, 16.92272489766279, 13.149177218476922, 12.978793169061333, 13.273122637222201, 23.56098015854755, 24.108853442051128, 23.887500586609036, -0.6497023105621338, 0.03239355608820915, -0.39773447811603546, 32.7648730178674, 33.31039670606454, 33.67550987501939, 22.237949344019086, 22.4943767680476, 21.907077665130288, 20.671420998871326, 20.545592986047268, 20.864794578403234, 16.765857147673756, 16.97820500905314, 16.963387629638106, -97.64218946297964, -81.60465096433958, -81.35922302802405, -103.29525291919708, -86.79905358701944, -86.59945134073496, 18.839671408757567, 18.56845597922802, 18.717783719301224, 10.954172159234673, 10.832487786809594, 10.182223091522843, 16.015214574833706, 15.883832116921738, 16.238064098249495, 12.876247346401215, 12.927453696727753, 12.961185976862907, 28.068402260541916, 28.53554494678974, 29.253232143819332, 29.162518153587968, 28.95747627566257, 29.339315336818487, -104.60643780231476, -97.36128334701061, -97.21036563441157, 22.4186456091702, 22.711145806126297, 22.256544277071953, 8.5887318595002, 8.705909536375344, 8.455648983518273, 19.74113532404104, 19.65551848585406, 19.663849650571734, 23.16400433828433, 23.037730631728962, 23.134698075552777, 7.1564571311076435, 6.987644632657364, 6.940117677052811, 18.573031888809055, 18.211296647787094, 18.13125867396593, 26.39136303278306, 26.28684219966331, 26.08690225581327, 31.081442584594086, 31.045098354419068, 31.475907688339547, 21.85660052811727, 21.4740589261055, 21.681785080581903, 24.78021734890838, 23.578919996817902, 24.454948050280407, 27.23663905014594, 27.39576832701762, 27.507109002520636, 16.67066341638565, 20.74882073700428, 21.15720358118415, 23.401838983719543, 23.43644413662453, 23.514521376074597, 8.03994772831598, 7.615917044381291, 6.964583079020173, 27.21551401292284, 27.0672336940964, 26.72051768501599, 24.68202232693632, 24.739312630457178, 24.750618229930595, 20.950967520475388, 21.388659588992596, 21.49949224665761, 20.92417399957776, 20.822237446904182, 20.952722165733576, 15.754191795984894, 15.625993343691022, 15.771958450476319, 17.760556407272816, 17.678268153220415, 17.689603988081217, 33.84933007756868, 34.38160242388645, 34.49987910563746, 13.211873507748038, 13.004484752813966, 13.297063911954552, 24.082036671539143, 23.977525403102234, 24.373929785874978, 27.97569496169065, 27.594849814971283, 27.844179666911558, 19.307339034974575, 19.571193151175976, 19.836723680316936, 19.64359290649493, 19.052360763152436, 18.753819723923996, 25.518698220451668, 24.81853124996026, 25.76388134931524, 23.172243336836488, 24.206132496862352, 24.08481306085983, 16.60734840730825, 16.819158392647893, 17.1923227754111, 15.333213552832603, 15.170630671083927, 15.5778090916574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15342690152857477, "mean_inference_ms": 0.7030938784557244, "mean_action_processing_ms": 0.09999490174448486, "mean_env_wait_ms": 0.8075522343890948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1323972, "timesteps_this_iter": 0, "agent_timesteps_total": 3971916, "timers": {"sample_time_ms": 19871.665, "sample_throughput": 482.798, "load_time_ms": 0.1, "load_throughput": 96061476.667, "learn_time_ms": 3132.783, "learn_throughput": 3062.453, "update_time_ms": 8.459}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 45.76473140716553, "policy_loss": -0.0010060679436874054, "vf_loss": 45.924500942230225, "vf_explained_var": -0.017660215497016907, "kl": 0.007636917176770829, "entropy": 15.876055002212524, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1323972, "num_agent_steps_sampled": 3971916, "num_steps_trained": 1323972, "num_agent_steps_trained": 3971916, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5209, "training_iteration": 138, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-29-41", "timestamp": 1706192981, "time_this_iter_s": 21.602811813354492, "time_total_s": 2780.1577582359314, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2780.1577582359314, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 9.635483870967743, "ram_util_percent": 51.87419354838709}}
{"episode_reward_max": 107.97295098751783, "episode_reward_min": -299.17808678373694, "episode_reward_mean": 46.99762392687786, "episode_len_mean": 291.59, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -104.60643780231476}, "policy_reward_max": {"shared_policy": 36.2162706926465}, "policy_reward_mean": {"shared_policy": 15.665874642292614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.45236938819289, 67.94821093417704, 63.349003595765666, 75.40350139513612, 21.86050545424223, 65.6683591697365, 46.052492305636406, 68.65434751659629, 99.3594279810786, 53.820000015199184, 57.44936142861842, 89.87124535441399, 76.71950947493312, 68.61113008111715, 60.135201599448905, 82.32719452213495, 46.875847816467285, 75.39747262001038, 5.906758088618503, 88.76654593273997, 51.335616387426825, 39.401093024760456, 71.55733418720772, -1.01504323258996, 99.75077959895133, 66.63940377719697, 62.08180856332183, 50.707449786365004, -260.60606345534325, -276.6937578469515, 56.12591110728681, 31.96888303756711, 48.13711079000494, 38.764887019991875, 85.85717935115099, 87.45930976606903, -299.17808678373694, 67.38633569236845, 25.750290379393817, 59.06050346046683, 69.33643304556607, 21.08421944081782, 54.91558721056208, 78.76510748825964, 93.6024486273527, 65.01244453480467, 72.81408539600669, 82.1395163796842, 58.57668773457408, 70.35280449641867, 22.620447851717444, 81.00326539203523, 74.17195318732409, 63.83911935612559, 62.69913361221552, 47.152143590152235, 53.12842854857445, 102.73081160709259, 39.513422172516556, 72.43349186051636, 83.41472444357349, 58.71525586646749, 57.44977339357136, 76.10111081972717, 71.46318889455867, 50.61882957536724, 46.08165331557393, 74.92139894980934, 74.53420739248394, -266.13979436457157, 83.97838228195904, 83.963972132653, 85.94821344688533, 74.72656013816594, 25.920818369835587, 90.14397201780228, 56.045439168810816, 57.99757219338787, 79.12462278176096, 72.71926481649277, 68.3469719579443, 23.835078559815884, 57.93796314997597, 85.16620817407964, -263.9447278268635, 74.24901164323092, 61.511311374604674, 94.89559829700735, 56.48273678123951, 65.06416728720066, 107.97295098751783, 24.20318027213213, 83.56477993726729, 54.53393550962208, 44.86646661814302, 65.50745321437716, 59.66705150902271, 89.68030909309162, 78.75739372614768, 91.7244059704244], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 179, 117, 300, 300, 300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 116, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.386728405952454, 11.606441464275122, 10.459199517965317, 22.436810463666916, 22.471990913152695, 23.03940955735743, 21.132941765089825, 20.84750447173913, 21.368557358936712, 25.12266567721963, 25.08831537142396, 25.19252034649253, 7.015270181000233, 7.404025299474597, 7.4412099737674, 21.83266083523631, 21.83687099069357, 21.998827343806624, 15.459749415516853, 15.317211836576462, 15.27553105354309, 23.064770030478627, 22.737808043758065, 22.851769442359597, 33.040911267201096, 33.081713924805314, 33.236802789072186, 17.514297410845757, 18.186817288398743, 18.118885315954685, 18.997782607873276, 19.0301128377517, 19.42146598299344, 30.158148728311062, 29.796912133693695, 29.91618449240923, 25.616019542018563, 25.52393967906633, 25.579550253848225, 22.838393952697515, 22.885632812976837, 22.8871033154428, 20.154451744010046, 19.974451397856072, 20.006298457582787, 27.7495155626287, 26.784365852673844, 27.7933131068324, 15.477463819086552, 15.756842393428087, 15.641541603952646, 25.320638597011566, 25.128362357616425, 24.948471665382385, 2.1224162740011963, 1.985985209544495, 1.7983566050728115, 29.272550866007805, 29.830164965242147, 29.66383010149002, 17.13823353747526, 17.274657952288777, 16.92272489766279, 13.149177218476922, 12.978793169061333, 13.273122637222201, 23.56098015854755, 24.108853442051128, 23.887500586609036, -0.6497023105621338, 0.03239355608820915, -0.39773447811603546, 32.7648730178674, 33.31039670606454, 33.67550987501939, 22.237949344019086, 22.4943767680476, 21.907077665130288, 20.671420998871326, 20.545592986047268, 20.864794578403234, 16.765857147673756, 16.97820500905314, 16.963387629638106, -97.64218946297964, -81.60465096433958, -81.35922302802405, -103.29525291919708, -86.79905358701944, -86.59945134073496, 18.839671408757567, 18.56845597922802, 18.717783719301224, 10.954172159234673, 10.832487786809594, 10.182223091522843, 16.015214574833706, 15.883832116921738, 16.238064098249495, 12.876247346401215, 12.927453696727753, 12.961185976862907, 28.068402260541916, 28.53554494678974, 29.253232143819332, 29.162518153587968, 28.95747627566257, 29.339315336818487, -104.60643780231476, -97.36128334701061, -97.21036563441157, 22.4186456091702, 22.711145806126297, 22.256544277071953, 8.5887318595002, 8.705909536375344, 8.455648983518273, 19.74113532404104, 19.65551848585406, 19.663849650571734, 23.16400433828433, 23.037730631728962, 23.134698075552777, 7.1564571311076435, 6.987644632657364, 6.940117677052811, 18.573031888809055, 18.211296647787094, 18.13125867396593, 26.39136303278306, 26.28684219966331, 26.08690225581327, 31.081442584594086, 31.045098354419068, 31.475907688339547, 21.85660052811727, 21.4740589261055, 21.681785080581903, 24.78021734890838, 23.578919996817902, 24.454948050280407, 27.23663905014594, 27.39576832701762, 27.507109002520636, 16.67066341638565, 20.74882073700428, 21.15720358118415, 23.401838983719543, 23.43644413662453, 23.514521376074597, 8.03994772831598, 7.615917044381291, 6.964583079020173, 27.21551401292284, 27.0672336940964, 26.72051768501599, 24.68202232693632, 24.739312630457178, 24.750618229930595, 20.950967520475388, 21.388659588992596, 21.49949224665761, 20.92417399957776, 20.822237446904182, 20.952722165733576, 15.754191795984894, 15.625993343691022, 15.771958450476319, 17.760556407272816, 17.678268153220415, 17.689603988081217, 33.84933007756868, 34.38160242388645, 34.49987910563746, 13.211873507748038, 13.004484752813966, 13.297063911954552, 24.082036671539143, 23.977525403102234, 24.373929785874978, 27.97569496169065, 27.594849814971283, 27.844179666911558, 19.307339034974575, 19.571193151175976, 19.836723680316936, 19.64359290649493, 19.052360763152436, 18.753819723923996, 25.518698220451668, 24.81853124996026, 25.76388134931524, 23.172243336836488, 24.206132496862352, 24.08481306085983, 16.60734840730825, 16.819158392647893, 17.1923227754111, 15.333213552832603, 15.170630671083927, 15.5778090916574, 24.85705333451429, 25.17617779939124, 24.888167815903813, 24.54146110018094, 24.946186072503522, 25.046560219799474, -100.05376517772675, -82.8936130553484, -83.19241613149643, 28.142134760816887, 27.886144061883286, 27.95010345925887, 27.838024474680424, 28.03189603239298, 28.094051625579596, 28.762521674235657, 28.824820914616183, 28.360870858033493, 25.097338204582528, 24.583001529177025, 25.046220404406384, 8.649623877058417, 8.66799705537656, 8.60319743740061, 30.0908435297509, 30.299531856862203, 29.753596631189183, 18.94189993540445, 18.74012293914953, 18.363416294256837, 19.2125135945777, 19.35882297406593, 19.426235624744237, 26.413403753812105, 26.405152659552783, 26.306066368396074, 24.115923563639313, 24.305038056025893, 24.29830319682756, 23.170048558774084, 22.639449561635644, 22.537473837534577, 8.25389502197504, 7.290277570486069, 8.290905967354774, 19.48455623708044, 19.451349243832126, 19.002057669063404, 28.305071545143917, 28.67096749072273, 28.190169138212994, -97.34363889694214, -83.40092352032661, -83.20016540959477, 24.465553298592567, 24.84849701076746, 24.934961333870888, 20.527771982053906, 20.345013598601014, 20.638525793949754, 31.605962483833224, 31.57483451689282, 31.71480129628131, 18.617897249758244, 18.884515289217234, 18.980324242264032, 21.74327791358033, 21.784000309805066, 21.536889063815266, 36.068799152970314, 35.687881141901016, 36.2162706926465, 8.136409829060227, 8.531350223968417, 7.535420219103486, 27.782455307741955, 27.843726647396878, 27.938597982128456, 18.359008069460586, 18.31514666912456, 17.859780771036938, 15.595261669717729, 14.289441496133804, 14.981763452291489, 21.85058574192226, 21.915343748405576, 21.74152372404933, 19.819984436035156, 19.862767606973648, 19.98429946601391, 30.02765682370712, 30.035340488733098, 29.617311780651406, 26.2315943862001, 25.91660704712072, 26.60919229282686, 30.543246900041893, 30.485924815138176, 30.69523425524433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15343221269650936, "mean_inference_ms": 0.7031283827863527, "mean_action_processing_ms": 0.09999325374484286, "mean_env_wait_ms": 0.8074982737690095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1333566, "timesteps_this_iter": 0, "agent_timesteps_total": 4000698, "timers": {"sample_time_ms": 19818.472, "sample_throughput": 484.094, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3141.113, "learn_throughput": 3054.332, "update_time_ms": 8.753}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 95.9615068435669, "policy_loss": -0.00029987374892948004, "vf_loss": 96.12095832824707, "vf_explained_var": 0.16354576498270035, "kl": 0.008582940383550093, "entropy": 15.915183424949646, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1333566, "num_agent_steps_sampled": 4000698, "num_steps_trained": 1333566, "num_agent_steps_trained": 4000698, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5242, "training_iteration": 139, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-30-01", "timestamp": 1706193001, "time_this_iter_s": 19.358564138412476, "time_total_s": 2799.516322374344, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BD6820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2799.516322374344, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 7.707407407407407, "ram_util_percent": 52.425925925925924}}
{"episode_reward_max": 107.97295098751783, "episode_reward_min": -299.17808678373694, "episode_reward_mean": 50.95367242503743, "episode_len_mean": 293.81, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -104.60643780231476}, "policy_reward_max": {"shared_policy": 36.2162706926465}, "policy_reward_mean": {"shared_policy": 16.984557475012473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.13711079000494, 38.764887019991875, 85.85717935115099, 87.45930976606903, -299.17808678373694, 67.38633569236845, 25.750290379393817, 59.06050346046683, 69.33643304556607, 21.08421944081782, 54.91558721056208, 78.76510748825964, 93.6024486273527, 65.01244453480467, 72.81408539600669, 82.1395163796842, 58.57668773457408, 70.35280449641867, 22.620447851717444, 81.00326539203523, 74.17195318732409, 63.83911935612559, 62.69913361221552, 47.152143590152235, 53.12842854857445, 102.73081160709259, 39.513422172516556, 72.43349186051636, 83.41472444357349, 58.71525586646749, 57.44977339357136, 76.10111081972717, 71.46318889455867, 50.61882957536724, 46.08165331557393, 74.92139894980934, 74.53420739248394, -266.13979436457157, 83.97838228195904, 83.963972132653, 85.94821344688533, 74.72656013816594, 25.920818369835587, 90.14397201780228, 56.045439168810816, 57.99757219338787, 79.12462278176096, 72.71926481649277, 68.3469719579443, 23.835078559815884, 57.93796314997597, 85.16620817407964, -263.9447278268635, 74.24901164323092, 61.511311374604674, 94.89559829700735, 56.48273678123951, 65.06416728720066, 107.97295098751783, 24.20318027213213, 83.56477993726729, 54.53393550962208, 44.86646661814302, 65.50745321437716, 59.66705150902271, 89.68030909309162, 78.75739372614768, 91.7244059704244, 19.73064307030289, 39.181475594639764, 69.05739885149522, 69.99969719722867, 56.62604174390435, 78.94833331182596, 56.24210975226012, 62.502325229346724, 89.20018452778459, 84.66655234573408, 54.68664961028844, 77.59441665560004, -248.2418924625963, 51.23285260796544, 88.5801833383739, 72.4486860577017, 52.5665887109935, 80.52036632470116, 93.93221251294014, 63.79392454773186, 59.6548389866948, 55.402066010981784, 9.99689536541699, 4.348990984261022, 88.23412144184113, 68.09149900078772, 62.27651749551296, 75.19718489795922, 61.1118754148483, 40.65053172875193, -4.528415638720645, 100.78189420886335], "episode_lengths": [300, 300, 300, 300, 48, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 116, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.015214574833706, 15.883832116921738, 16.238064098249495, 12.876247346401215, 12.927453696727753, 12.961185976862907, 28.068402260541916, 28.53554494678974, 29.253232143819332, 29.162518153587968, 28.95747627566257, 29.339315336818487, -104.60643780231476, -97.36128334701061, -97.21036563441157, 22.4186456091702, 22.711145806126297, 22.256544277071953, 8.5887318595002, 8.705909536375344, 8.455648983518273, 19.74113532404104, 19.65551848585406, 19.663849650571734, 23.16400433828433, 23.037730631728962, 23.134698075552777, 7.1564571311076435, 6.987644632657364, 6.940117677052811, 18.573031888809055, 18.211296647787094, 18.13125867396593, 26.39136303278306, 26.28684219966331, 26.08690225581327, 31.081442584594086, 31.045098354419068, 31.475907688339547, 21.85660052811727, 21.4740589261055, 21.681785080581903, 24.78021734890838, 23.578919996817902, 24.454948050280407, 27.23663905014594, 27.39576832701762, 27.507109002520636, 16.67066341638565, 20.74882073700428, 21.15720358118415, 23.401838983719543, 23.43644413662453, 23.514521376074597, 8.03994772831598, 7.615917044381291, 6.964583079020173, 27.21551401292284, 27.0672336940964, 26.72051768501599, 24.68202232693632, 24.739312630457178, 24.750618229930595, 20.950967520475388, 21.388659588992596, 21.49949224665761, 20.92417399957776, 20.822237446904182, 20.952722165733576, 15.754191795984894, 15.625993343691022, 15.771958450476319, 17.760556407272816, 17.678268153220415, 17.689603988081217, 33.84933007756868, 34.38160242388645, 34.49987910563746, 13.211873507748038, 13.004484752813966, 13.297063911954552, 24.082036671539143, 23.977525403102234, 24.373929785874978, 27.97569496169065, 27.594849814971283, 27.844179666911558, 19.307339034974575, 19.571193151175976, 19.836723680316936, 19.64359290649493, 19.052360763152436, 18.753819723923996, 25.518698220451668, 24.81853124996026, 25.76388134931524, 23.172243336836488, 24.206132496862352, 24.08481306085983, 16.60734840730825, 16.819158392647893, 17.1923227754111, 15.333213552832603, 15.170630671083927, 15.5778090916574, 24.85705333451429, 25.17617779939124, 24.888167815903813, 24.54146110018094, 24.946186072503522, 25.046560219799474, -100.05376517772675, -82.8936130553484, -83.19241613149643, 28.142134760816887, 27.886144061883286, 27.95010345925887, 27.838024474680424, 28.03189603239298, 28.094051625579596, 28.762521674235657, 28.824820914616183, 28.360870858033493, 25.097338204582528, 24.583001529177025, 25.046220404406384, 8.649623877058417, 8.66799705537656, 8.60319743740061, 30.0908435297509, 30.299531856862203, 29.753596631189183, 18.94189993540445, 18.74012293914953, 18.363416294256837, 19.2125135945777, 19.35882297406593, 19.426235624744237, 26.413403753812105, 26.405152659552783, 26.306066368396074, 24.115923563639313, 24.305038056025893, 24.29830319682756, 23.170048558774084, 22.639449561635644, 22.537473837534577, 8.25389502197504, 7.290277570486069, 8.290905967354774, 19.48455623708044, 19.451349243832126, 19.002057669063404, 28.305071545143917, 28.67096749072273, 28.190169138212994, -97.34363889694214, -83.40092352032661, -83.20016540959477, 24.465553298592567, 24.84849701076746, 24.934961333870888, 20.527771982053906, 20.345013598601014, 20.638525793949754, 31.605962483833224, 31.57483451689282, 31.71480129628131, 18.617897249758244, 18.884515289217234, 18.980324242264032, 21.74327791358033, 21.784000309805066, 21.536889063815266, 36.068799152970314, 35.687881141901016, 36.2162706926465, 8.136409829060227, 8.531350223968417, 7.535420219103486, 27.782455307741955, 27.843726647396878, 27.938597982128456, 18.359008069460586, 18.31514666912456, 17.859780771036938, 15.595261669717729, 14.289441496133804, 14.981763452291489, 21.85058574192226, 21.915343748405576, 21.74152372404933, 19.819984436035156, 19.862767606973648, 19.98429946601391, 30.02765682370712, 30.035340488733098, 29.617311780651406, 26.2315943862001, 25.91660704712072, 26.60919229282686, 30.543246900041893, 30.485924815138176, 30.69523425524433, 6.420789306362465, 6.6469798063238414, 6.662873957616583, 13.181022403140858, 12.945775424440697, 13.054677767058209, 23.277373325855777, 22.661300008495644, 23.1187255171438, 23.497434329241514, 23.165430292487144, 23.33683257550001, 18.59064871072769, 18.965197816491127, 19.070195216685534, 26.199987317124993, 26.315997178355843, 26.432348816345126, 18.588516953090817, 18.927049258413405, 18.726543540755898, 20.639535541335732, 20.886367465058953, 20.97642222295204, 29.2983039021492, 29.95164117962122, 29.950239446014166, 28.780610506267593, 28.512391106535986, 27.373550732930497, 17.591411724686623, 18.51276359707117, 18.582474288530648, 25.63565370688835, 25.920705842475087, 26.038057106236607, -93.21335343519847, -77.58018670479457, -77.44835232260327, 17.18590839082995, 17.337174436698348, 16.709769780437142, 29.09127527475357, 29.68490669131279, 29.80400137230754, 23.959292739629745, 24.272745994850993, 24.21664732322097, 16.864288369814545, 17.67228368173042, 18.030016659448535, 26.571293016274765, 26.95939766413842, 26.98967564428797, 31.4912676240007, 30.88323814670244, 31.557706742237002, 21.146136318643883, 21.264999975760773, 21.382788253327206, 19.816654344399765, 19.85918766011794, 19.978996982177094, 18.542882443716124, 18.360999037822083, 18.498184529443577, 3.445174397279814, 3.4890674812098297, 3.0626534869273456, 1.4244999339183124, 1.2241132532556804, 1.7003777970870289, 28.90988762676716, 29.677413191646338, 29.64682062342763, 22.787827388693884, 22.692861059059695, 22.610810553034142, 20.707710325717926, 20.826296858489513, 20.742510311305523, 25.300494653483227, 24.74637258549531, 25.150317658980683, 16.714450399080903, 22.24054708952704, 22.156877926240355, 13.444035897652299, 13.758564322876424, 13.447931508223206, -1.5464171034594472, -1.5894574498136933, -1.3925410854475047, 33.27262408534685, 33.570357407132775, 33.938912716383726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15343250194723104, "mean_inference_ms": 0.7031967315811464, "mean_action_processing_ms": 0.10006276469002033, "mean_env_wait_ms": 0.8074468208650876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1343160, "timesteps_this_iter": 0, "agent_timesteps_total": 4029480, "timers": {"sample_time_ms": 19795.275, "sample_throughput": 484.661, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3121.549, "learn_throughput": 3073.474, "update_time_ms": 8.652}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 47.38368558883667, "policy_loss": -0.0008439900211669182, "vf_loss": 47.542842864990234, "vf_explained_var": 0.14853249490261078, "kl": 0.008405323722600489, "entropy": 15.831324100494385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1343160, "num_agent_steps_sampled": 4029480, "num_steps_trained": 1343160, "num_agent_steps_trained": 4029480, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5274, "training_iteration": 140, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-30-20", "timestamp": 1706193020, "time_this_iter_s": 19.1237690448761, "time_total_s": 2818.64009141922, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B81E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2818.64009141922, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 8.322222222222223, "ram_util_percent": 52.166666666666664}}
{"episode_reward_max": 107.97295098751783, "episode_reward_min": -292.8617440164089, "episode_reward_mean": 42.75425049654797, "episode_len_mean": 294.34, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -108.06470155715942}, "policy_reward_max": {"shared_policy": 36.2162706926465}, "policy_reward_mean": {"shared_policy": 14.251416832182652}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.08165331557393, 74.92139894980934, 74.53420739248394, -266.13979436457157, 83.97838228195904, 83.963972132653, 85.94821344688533, 74.72656013816594, 25.920818369835587, 90.14397201780228, 56.045439168810816, 57.99757219338787, 79.12462278176096, 72.71926481649277, 68.3469719579443, 23.835078559815884, 57.93796314997597, 85.16620817407964, -263.9447278268635, 74.24901164323092, 61.511311374604674, 94.89559829700735, 56.48273678123951, 65.06416728720066, 107.97295098751783, 24.20318027213213, 83.56477993726729, 54.53393550962208, 44.86646661814302, 65.50745321437716, 59.66705150902271, 89.68030909309162, 78.75739372614768, 91.7244059704244, 19.73064307030289, 39.181475594639764, 69.05739885149522, 69.99969719722867, 56.62604174390435, 78.94833331182596, 56.24210975226012, 62.502325229346724, 89.20018452778459, 84.66655234573408, 54.68664961028844, 77.59441665560004, -248.2418924625963, 51.23285260796544, 88.5801833383739, 72.4486860577017, 52.5665887109935, 80.52036632470116, 93.93221251294014, 63.79392454773186, 59.6548389866948, 55.402066010981784, 9.99689536541699, 4.348990984261022, 88.23412144184113, 68.09149900078772, 62.27651749551296, 75.19718489795922, 61.1118754148483, 40.65053172875193, -4.528415638720645, 100.78189420886335, 51.60468528326601, 81.84777199290691, 66.32150015281513, 80.97656209208068, 59.804089061915874, 54.433754093945, -217.13173148408532, -292.8617440164089, 30.32593074813485, -225.70498825609684, 75.9849707186222, 54.45553971081971, 56.28607449214904, 9.777805607765913, 65.07541500777005, 59.99059700220823, 49.88753470312804, 76.35186894610524, 72.37402092292902, 37.65256573352961, 30.780181981623144, 23.093614697456346, 37.85076464153826, 20.17311616335064, 66.37495460361241, 76.83553599566221, 60.35859799827446, 62.14636776223779, 69.61416010186075, 57.33387560211122, 70.81786817312238, 20.6781627051532, 63.059324324131, 70.38102408871055], "episode_lengths": [300, 300, 300, 116, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 199, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 282, 143, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.333213552832603, 15.170630671083927, 15.5778090916574, 24.85705333451429, 25.17617779939124, 24.888167815903813, 24.54146110018094, 24.946186072503522, 25.046560219799474, -100.05376517772675, -82.8936130553484, -83.19241613149643, 28.142134760816887, 27.886144061883286, 27.95010345925887, 27.838024474680424, 28.03189603239298, 28.094051625579596, 28.762521674235657, 28.824820914616183, 28.360870858033493, 25.097338204582528, 24.583001529177025, 25.046220404406384, 8.649623877058417, 8.66799705537656, 8.60319743740061, 30.0908435297509, 30.299531856862203, 29.753596631189183, 18.94189993540445, 18.74012293914953, 18.363416294256837, 19.2125135945777, 19.35882297406593, 19.426235624744237, 26.413403753812105, 26.405152659552783, 26.306066368396074, 24.115923563639313, 24.305038056025893, 24.29830319682756, 23.170048558774084, 22.639449561635644, 22.537473837534577, 8.25389502197504, 7.290277570486069, 8.290905967354774, 19.48455623708044, 19.451349243832126, 19.002057669063404, 28.305071545143917, 28.67096749072273, 28.190169138212994, -97.34363889694214, -83.40092352032661, -83.20016540959477, 24.465553298592567, 24.84849701076746, 24.934961333870888, 20.527771982053906, 20.345013598601014, 20.638525793949754, 31.605962483833224, 31.57483451689282, 31.71480129628131, 18.617897249758244, 18.884515289217234, 18.980324242264032, 21.74327791358033, 21.784000309805066, 21.536889063815266, 36.068799152970314, 35.687881141901016, 36.2162706926465, 8.136409829060227, 8.531350223968417, 7.535420219103486, 27.782455307741955, 27.843726647396878, 27.938597982128456, 18.359008069460586, 18.31514666912456, 17.859780771036938, 15.595261669717729, 14.289441496133804, 14.981763452291489, 21.85058574192226, 21.915343748405576, 21.74152372404933, 19.819984436035156, 19.862767606973648, 19.98429946601391, 30.02765682370712, 30.035340488733098, 29.617311780651406, 26.2315943862001, 25.91660704712072, 26.60919229282686, 30.543246900041893, 30.485924815138176, 30.69523425524433, 6.420789306362465, 6.6469798063238414, 6.662873957616583, 13.181022403140858, 12.945775424440697, 13.054677767058209, 23.277373325855777, 22.661300008495644, 23.1187255171438, 23.497434329241514, 23.165430292487144, 23.33683257550001, 18.59064871072769, 18.965197816491127, 19.070195216685534, 26.199987317124993, 26.315997178355843, 26.432348816345126, 18.588516953090817, 18.927049258413405, 18.726543540755898, 20.639535541335732, 20.886367465058953, 20.97642222295204, 29.2983039021492, 29.95164117962122, 29.950239446014166, 28.780610506267593, 28.512391106535986, 27.373550732930497, 17.591411724686623, 18.51276359707117, 18.582474288530648, 25.63565370688835, 25.920705842475087, 26.038057106236607, -93.21335343519847, -77.58018670479457, -77.44835232260327, 17.18590839082995, 17.337174436698348, 16.709769780437142, 29.09127527475357, 29.68490669131279, 29.80400137230754, 23.959292739629745, 24.272745994850993, 24.21664732322097, 16.864288369814545, 17.67228368173042, 18.030016659448535, 26.571293016274765, 26.95939766413842, 26.98967564428797, 31.4912676240007, 30.88323814670244, 31.557706742237002, 21.146136318643883, 21.264999975760773, 21.382788253327206, 19.816654344399765, 19.85918766011794, 19.978996982177094, 18.542882443716124, 18.360999037822083, 18.498184529443577, 3.445174397279814, 3.4890674812098297, 3.0626534869273456, 1.4244999339183124, 1.2241132532556804, 1.7003777970870289, 28.90988762676716, 29.677413191646338, 29.64682062342763, 22.787827388693884, 22.692861059059695, 22.610810553034142, 20.707710325717926, 20.826296858489513, 20.742510311305523, 25.300494653483227, 24.74637258549531, 25.150317658980683, 16.714450399080903, 22.24054708952704, 22.156877926240355, 13.444035897652299, 13.758564322876424, 13.447931508223206, -1.5464171034594472, -1.5894574498136933, -1.3925410854475047, 33.27262408534685, 33.570357407132775, 33.938912716383726, 17.27116284519434, 17.388369544409215, 16.945152893662453, 26.792272751530007, 27.44515038405855, 27.610348857318357, 22.014029942452908, 22.043359860777855, 22.26411034958437, 26.99922868112722, 27.301747967178613, 26.67558544377485, 19.80427237600088, 19.904946893453598, 20.094869792461395, 18.029711397985608, 18.512590716282517, 17.891451979676873, -83.6607225338618, -67.15555005768935, -66.31545889253418, -108.06470155715942, -92.3442455753684, -92.45279688388109, 10.111396864056587, 10.105740811675787, 10.108793072402477, -79.73782090346019, -73.27212637166183, -72.69504098097484, 25.310135823984936, 25.181579669316605, 25.493255225320652, 18.334234324594334, 18.140018065770462, 17.98128732045491, 18.560717334349945, 18.90595421226074, 18.819402945538357, 2.8258489966392517, 3.431022061035037, 3.5209345500916243, 21.65010067572196, 21.941757713754967, 21.48355661829312, 20.07690818607807, 19.933467634022236, 19.980221182107925, 16.6198687851429, 16.35607486963272, 16.91159104835242, 25.453369855880737, 25.563303526490927, 25.335195563733578, 24.031179415682942, 24.239965266237647, 24.10287624100843, 12.472633217771843, 12.613163056162492, 12.566769459595278, 10.338762732843549, 10.034748906890542, 10.406670341889054, 7.558504258592919, 7.60952404638131, 7.925586392482117, 12.136646166443825, 12.83760192990303, 12.876516545191407, 6.9007832929492, 6.221838295459747, 7.050494574941695, 21.96907343467076, 21.85475433369477, 22.551126835246876, 25.656226366758347, 25.611677780747414, 25.567631848156452, 20.127667902658374, 19.947472574810178, 20.28345752080591, 20.55439940840006, 20.68753230571747, 20.90443604812026, 23.39051980649431, 22.749043722947434, 23.474596572419003, 19.269570412114263, 19.046286057680845, 19.018019132316113, 23.428352693716676, 23.64308502028385, 23.746430459121854, 6.615627395610005, 6.998931008080632, 7.063604301462561, 20.924234700699643, 20.966254019488886, 21.16883560394247, 23.191997855901718, 23.681163173168898, 23.50786305963993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533169881870553, "mean_inference_ms": 0.7028504764436838, "mean_action_processing_ms": 0.10001108774919099, "mean_env_wait_ms": 0.8071369003330675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1352754, "timesteps_this_iter": 0, "agent_timesteps_total": 4058262, "timers": {"sample_time_ms": 19700.584, "sample_throughput": 486.991, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3118.738, "learn_throughput": 3076.245, "update_time_ms": 8.546}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 121.43274402618408, "policy_loss": -0.0005806917113057308, "vf_loss": 121.59338665008545, "vf_explained_var": 0.2699482962489128, "kl": 0.007322344434418855, "entropy": 16.00634765625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1352754, "num_agent_steps_sampled": 4058262, "num_steps_trained": 1352754, "num_agent_steps_trained": 4058262, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5308, "training_iteration": 141, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-30-39", "timestamp": 1706193039, "time_this_iter_s": 19.046021461486816, "time_total_s": 2837.686112880707, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BD6DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2837.686112880707, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 9.014814814814814, "ram_util_percent": 51.944444444444436}}
{"episode_reward_max": 100.78189420886335, "episode_reward_min": -292.8617440164089, "episode_reward_mean": 43.90365405552517, "episode_len_mean": 296.61, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -108.06470155715942}, "policy_reward_max": {"shared_policy": 33.938912716383726}, "policy_reward_mean": {"shared_policy": 14.634551351841722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.68030909309162, 78.75739372614768, 91.7244059704244, 19.73064307030289, 39.181475594639764, 69.05739885149522, 69.99969719722867, 56.62604174390435, 78.94833331182596, 56.24210975226012, 62.502325229346724, 89.20018452778459, 84.66655234573408, 54.68664961028844, 77.59441665560004, -248.2418924625963, 51.23285260796544, 88.5801833383739, 72.4486860577017, 52.5665887109935, 80.52036632470116, 93.93221251294014, 63.79392454773186, 59.6548389866948, 55.402066010981784, 9.99689536541699, 4.348990984261022, 88.23412144184113, 68.09149900078772, 62.27651749551296, 75.19718489795922, 61.1118754148483, 40.65053172875193, -4.528415638720645, 100.78189420886335, 51.60468528326601, 81.84777199290691, 66.32150015281513, 80.97656209208068, 59.804089061915874, 54.433754093945, -217.13173148408532, -292.8617440164089, 30.32593074813485, -225.70498825609684, 75.9849707186222, 54.45553971081971, 56.28607449214904, 9.777805607765913, 65.07541500777005, 59.99059700220823, 49.88753470312804, 76.35186894610524, 72.37402092292902, 37.65256573352961, 30.780181981623144, 23.093614697456346, 37.85076464153826, 20.17311616335064, 66.37495460361241, 76.83553599566221, 60.35859799827446, 62.14636776223779, 69.61416010186075, 57.33387560211122, 70.81786817312238, 20.6781627051532, 63.059324324131, 70.38102408871055, 72.85517555475235, 61.326815363019676, 76.8473641555756, -251.4776177667082, 73.1790178014198, 44.78195731341839, 71.07507438119498, 78.47511046193539, 29.638023965060682, 48.88814572431144, 77.42886583582731, 50.51507334411144, 30.45063788071272, 81.81095973588525, 26.77859060373156, 50.884953390806885, 17.39545550197363, 50.580169067034134, 72.21006041951475, 74.07526214793324, 57.7360275965184, 40.71894687041639, 68.6353041883558, 17.683131605386706, 73.66563759103882, 83.06322439759968, 82.84568219631907, 71.70968610793349, 56.03959046304223, 88.81393082067369, 40.13651926629245], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 282, 143, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 242, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.02765682370712, 30.035340488733098, 29.617311780651406, 26.2315943862001, 25.91660704712072, 26.60919229282686, 30.543246900041893, 30.485924815138176, 30.69523425524433, 6.420789306362465, 6.6469798063238414, 6.662873957616583, 13.181022403140858, 12.945775424440697, 13.054677767058209, 23.277373325855777, 22.661300008495644, 23.1187255171438, 23.497434329241514, 23.165430292487144, 23.33683257550001, 18.59064871072769, 18.965197816491127, 19.070195216685534, 26.199987317124993, 26.315997178355843, 26.432348816345126, 18.588516953090817, 18.927049258413405, 18.726543540755898, 20.639535541335732, 20.886367465058953, 20.97642222295204, 29.2983039021492, 29.95164117962122, 29.950239446014166, 28.780610506267593, 28.512391106535986, 27.373550732930497, 17.591411724686623, 18.51276359707117, 18.582474288530648, 25.63565370688835, 25.920705842475087, 26.038057106236607, -93.21335343519847, -77.58018670479457, -77.44835232260327, 17.18590839082995, 17.337174436698348, 16.709769780437142, 29.09127527475357, 29.68490669131279, 29.80400137230754, 23.959292739629745, 24.272745994850993, 24.21664732322097, 16.864288369814545, 17.67228368173042, 18.030016659448535, 26.571293016274765, 26.95939766413842, 26.98967564428797, 31.4912676240007, 30.88323814670244, 31.557706742237002, 21.146136318643883, 21.264999975760773, 21.382788253327206, 19.816654344399765, 19.85918766011794, 19.978996982177094, 18.542882443716124, 18.360999037822083, 18.498184529443577, 3.445174397279814, 3.4890674812098297, 3.0626534869273456, 1.4244999339183124, 1.2241132532556804, 1.7003777970870289, 28.90988762676716, 29.677413191646338, 29.64682062342763, 22.787827388693884, 22.692861059059695, 22.610810553034142, 20.707710325717926, 20.826296858489513, 20.742510311305523, 25.300494653483227, 24.74637258549531, 25.150317658980683, 16.714450399080903, 22.24054708952704, 22.156877926240355, 13.444035897652299, 13.758564322876424, 13.447931508223206, -1.5464171034594472, -1.5894574498136933, -1.3925410854475047, 33.27262408534685, 33.570357407132775, 33.938912716383726, 17.27116284519434, 17.388369544409215, 16.945152893662453, 26.792272751530007, 27.44515038405855, 27.610348857318357, 22.014029942452908, 22.043359860777855, 22.26411034958437, 26.99922868112722, 27.301747967178613, 26.67558544377485, 19.80427237600088, 19.904946893453598, 20.094869792461395, 18.029711397985608, 18.512590716282517, 17.891451979676873, -83.6607225338618, -67.15555005768935, -66.31545889253418, -108.06470155715942, -92.3442455753684, -92.45279688388109, 10.111396864056587, 10.105740811675787, 10.108793072402477, -79.73782090346019, -73.27212637166183, -72.69504098097484, 25.310135823984936, 25.181579669316605, 25.493255225320652, 18.334234324594334, 18.140018065770462, 17.98128732045491, 18.560717334349945, 18.90595421226074, 18.819402945538357, 2.8258489966392517, 3.431022061035037, 3.5209345500916243, 21.65010067572196, 21.941757713754967, 21.48355661829312, 20.07690818607807, 19.933467634022236, 19.980221182107925, 16.6198687851429, 16.35607486963272, 16.91159104835242, 25.453369855880737, 25.563303526490927, 25.335195563733578, 24.031179415682942, 24.239965266237647, 24.10287624100843, 12.472633217771843, 12.613163056162492, 12.566769459595278, 10.338762732843549, 10.034748906890542, 10.406670341889054, 7.558504258592919, 7.60952404638131, 7.925586392482117, 12.136646166443825, 12.83760192990303, 12.876516545191407, 6.9007832929492, 6.221838295459747, 7.050494574941695, 21.96907343467076, 21.85475433369477, 22.551126835246876, 25.656226366758347, 25.611677780747414, 25.567631848156452, 20.127667902658374, 19.947472574810178, 20.28345752080591, 20.55439940840006, 20.68753230571747, 20.90443604812026, 23.39051980649431, 22.749043722947434, 23.474596572419003, 19.269570412114263, 19.046286057680845, 19.018019132316113, 23.428352693716676, 23.64308502028385, 23.746430459121854, 6.615627395610005, 6.998931008080632, 7.063604301462561, 20.924234700699643, 20.966254019488886, 21.16883560394247, 23.191997855901718, 23.681163173168898, 23.50786305963993, 24.155777484178543, 24.623723678290844, 24.075674392282963, 20.60435479755202, 20.460221285621316, 20.26223927984634, 25.660429189602525, 25.899584584558994, 25.287350381414086, -92.56871946652731, -79.73332822819552, -79.17557007198533, 24.52602552835984, 24.474514849173516, 24.17847742388645, 14.849442109465599, 15.248247101902962, 14.684268102049828, 23.402170846859605, 23.80044440800944, 23.872459126325936, 26.092009549339608, 25.92803322275479, 26.455067689840988, 9.975534314910561, 10.233899253110081, 9.42859039704004, 16.207177872459084, 16.447911356265337, 16.23305649558702, 25.717908553779125, 25.67947991192341, 26.031477370124776, 17.053982451558113, 17.223584860563278, 16.23750603199005, 10.001811782519013, 10.293646945307643, 10.155179152886063, 27.388997965802744, 26.92851250370343, 27.493449266379073, 8.777823598434523, 8.982395801072315, 9.01837120422472, 16.867402645448834, 16.87925990919271, 17.13829083616534, 6.015847995877266, 6.0863156244158745, 5.293291881680489, 16.642741238077477, 16.637617920835808, 17.29980990812085, 24.134348462025315, 24.201749589915067, 23.873962367574364, 24.98505786433816, 23.98576071858406, 25.104443565011024, 18.902462780475616, 19.448067409917712, 19.38549740612507, 13.752287366737917, 13.57002781828244, 13.39663168539603, 23.017875580117106, 22.902651205658913, 22.714777402579784, 6.049648890892655, 5.825068386892468, 5.808414327601582, 24.4620078181227, 24.606125324692883, 24.597504448223233, 27.724238631625965, 27.50383738180001, 27.835148384173706, 27.677446874479443, 27.561064446965844, 27.607170874873788, 23.950566022346408, 23.815878412375838, 23.943241673211247, 18.775409931937844, 18.490395496288926, 18.77378503481546, 29.250812759002045, 29.809384891142443, 29.753733170529202, 13.828453777357936, 13.304411724209785, 13.003653764724731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532588664938603, "mean_inference_ms": 0.7026583538750083, "mean_action_processing_ms": 0.10002509426764576, "mean_env_wait_ms": 0.8068927502850002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1362348, "timesteps_this_iter": 0, "agent_timesteps_total": 4087044, "timers": {"sample_time_ms": 19678.332, "sample_throughput": 487.541, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3120.043, "learn_throughput": 3074.958, "update_time_ms": 8.547}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 53.64104223251343, "policy_loss": -0.0009342950390109905, "vf_loss": 53.80266714096069, "vf_explained_var": 0.18045053631067276, "kl": 0.005051131476856943, "entropy": 16.06915771961212, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1362348, "num_agent_steps_sampled": 4087044, "num_steps_trained": 1362348, "num_agent_steps_trained": 4087044, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5339, "training_iteration": 142, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-30-58", "timestamp": 1706193058, "time_this_iter_s": 18.9627685546875, "time_total_s": 2856.6488814353943, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03552820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2856.6488814353943, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 8.748148148148148, "ram_util_percent": 51.974074074074075}}
{"episode_reward_max": 100.78189420886335, "episode_reward_min": -292.8617440164089, "episode_reward_mean": 42.62879564946502, "episode_len_mean": 297.24, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -108.06470155715942}, "policy_reward_max": {"shared_policy": 33.938912716383726}, "policy_reward_mean": {"shared_policy": 14.20959854982167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.65053172875193, -4.528415638720645, 100.78189420886335, 51.60468528326601, 81.84777199290691, 66.32150015281513, 80.97656209208068, 59.804089061915874, 54.433754093945, -217.13173148408532, -292.8617440164089, 30.32593074813485, -225.70498825609684, 75.9849707186222, 54.45553971081971, 56.28607449214904, 9.777805607765913, 65.07541500777005, 59.99059700220823, 49.88753470312804, 76.35186894610524, 72.37402092292902, 37.65256573352961, 30.780181981623144, 23.093614697456346, 37.85076464153826, 20.17311616335064, 66.37495460361241, 76.83553599566221, 60.35859799827446, 62.14636776223779, 69.61416010186075, 57.33387560211122, 70.81786817312238, 20.6781627051532, 63.059324324131, 70.38102408871055, 72.85517555475235, 61.326815363019676, 76.8473641555756, -251.4776177667082, 73.1790178014198, 44.78195731341839, 71.07507438119498, 78.47511046193539, 29.638023965060682, 48.88814572431144, 77.42886583582731, 50.51507334411144, 30.45063788071272, 81.81095973588525, 26.77859060373156, 50.884953390806885, 17.39545550197363, 50.580169067034134, 72.21006041951475, 74.07526214793324, 57.7360275965184, 40.71894687041639, 68.6353041883558, 17.683131605386706, 73.66563759103882, 83.06322439759968, 82.84568219631907, 71.70968610793349, 56.03959046304223, 88.81393082067369, 40.13651926629245, 29.669207695871563, 60.81391062773764, 59.87665344029662, 59.27314784750341, 72.17090264707804, 69.13147792778908, 68.69682304561138, 76.15778051223604, 86.60519378259778, 74.71558389067647, 52.52614367753266, 59.46230363100764, 79.2250499833899, 52.63024870399384, 75.10927904397248, 84.37333272770046, 35.03857387043534, 49.85179783124477, 55.958416946232305, 15.663334161043167, 62.13445199280976, 36.14771637320517, 58.110126566141815, 75.49949042499064, 43.09064729698001, 72.44410324422641, 69.37877888325599, 30.076390961185083, 55.05688463384284, 69.11019103229044, -237.47984307631853, 79.74090698361394], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 282, 143, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 242, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 281, 300], "policy_shared_policy_reward": [13.444035897652299, 13.758564322876424, 13.447931508223206, -1.5464171034594472, -1.5894574498136933, -1.3925410854475047, 33.27262408534685, 33.570357407132775, 33.938912716383726, 17.27116284519434, 17.388369544409215, 16.945152893662453, 26.792272751530007, 27.44515038405855, 27.610348857318357, 22.014029942452908, 22.043359860777855, 22.26411034958437, 26.99922868112722, 27.301747967178613, 26.67558544377485, 19.80427237600088, 19.904946893453598, 20.094869792461395, 18.029711397985608, 18.512590716282517, 17.891451979676873, -83.6607225338618, -67.15555005768935, -66.31545889253418, -108.06470155715942, -92.3442455753684, -92.45279688388109, 10.111396864056587, 10.105740811675787, 10.108793072402477, -79.73782090346019, -73.27212637166183, -72.69504098097484, 25.310135823984936, 25.181579669316605, 25.493255225320652, 18.334234324594334, 18.140018065770462, 17.98128732045491, 18.560717334349945, 18.90595421226074, 18.819402945538357, 2.8258489966392517, 3.431022061035037, 3.5209345500916243, 21.65010067572196, 21.941757713754967, 21.48355661829312, 20.07690818607807, 19.933467634022236, 19.980221182107925, 16.6198687851429, 16.35607486963272, 16.91159104835242, 25.453369855880737, 25.563303526490927, 25.335195563733578, 24.031179415682942, 24.239965266237647, 24.10287624100843, 12.472633217771843, 12.613163056162492, 12.566769459595278, 10.338762732843549, 10.034748906890542, 10.406670341889054, 7.558504258592919, 7.60952404638131, 7.925586392482117, 12.136646166443825, 12.83760192990303, 12.876516545191407, 6.9007832929492, 6.221838295459747, 7.050494574941695, 21.96907343467076, 21.85475433369477, 22.551126835246876, 25.656226366758347, 25.611677780747414, 25.567631848156452, 20.127667902658374, 19.947472574810178, 20.28345752080591, 20.55439940840006, 20.68753230571747, 20.90443604812026, 23.39051980649431, 22.749043722947434, 23.474596572419003, 19.269570412114263, 19.046286057680845, 19.018019132316113, 23.428352693716676, 23.64308502028385, 23.746430459121854, 6.615627395610005, 6.998931008080632, 7.063604301462561, 20.924234700699643, 20.966254019488886, 21.16883560394247, 23.191997855901718, 23.681163173168898, 23.50786305963993, 24.155777484178543, 24.623723678290844, 24.075674392282963, 20.60435479755202, 20.460221285621316, 20.26223927984634, 25.660429189602525, 25.899584584558994, 25.287350381414086, -92.56871946652731, -79.73332822819552, -79.17557007198533, 24.52602552835984, 24.474514849173516, 24.17847742388645, 14.849442109465599, 15.248247101902962, 14.684268102049828, 23.402170846859605, 23.80044440800944, 23.872459126325936, 26.092009549339608, 25.92803322275479, 26.455067689840988, 9.975534314910561, 10.233899253110081, 9.42859039704004, 16.207177872459084, 16.447911356265337, 16.23305649558702, 25.717908553779125, 25.67947991192341, 26.031477370124776, 17.053982451558113, 17.223584860563278, 16.23750603199005, 10.001811782519013, 10.293646945307643, 10.155179152886063, 27.388997965802744, 26.92851250370343, 27.493449266379073, 8.777823598434523, 8.982395801072315, 9.01837120422472, 16.867402645448834, 16.87925990919271, 17.13829083616534, 6.015847995877266, 6.0863156244158745, 5.293291881680489, 16.642741238077477, 16.637617920835808, 17.29980990812085, 24.134348462025315, 24.201749589915067, 23.873962367574364, 24.98505786433816, 23.98576071858406, 25.104443565011024, 18.902462780475616, 19.448067409917712, 19.38549740612507, 13.752287366737917, 13.57002781828244, 13.39663168539603, 23.017875580117106, 22.902651205658913, 22.714777402579784, 6.049648890892655, 5.825068386892468, 5.808414327601582, 24.4620078181227, 24.606125324692883, 24.597504448223233, 27.724238631625965, 27.50383738180001, 27.835148384173706, 27.677446874479443, 27.561064446965844, 27.607170874873788, 23.950566022346408, 23.815878412375838, 23.943241673211247, 18.775409931937844, 18.490395496288926, 18.77378503481546, 29.250812759002045, 29.809384891142443, 29.753733170529202, 13.828453777357936, 13.304411724209785, 13.003653764724731, 9.9902928272883, 9.442500586311013, 10.23641428227225, 20.079885333776474, 20.227123856544495, 20.506901437416673, 20.055436107019574, 19.446631992856652, 20.374585340420396, 20.171833784629897, 19.913831820090607, 19.187482242782906, 24.042041875422, 24.07803376764059, 24.050827004015446, 23.19291511115928, 23.181546316792563, 22.757016499837235, 22.648388408124447, 23.149016983807087, 22.899417653679848, 25.292830934127167, 25.37925745484729, 25.485692123261586, 28.96787852048874, 28.349640369415283, 29.287674892693758, 25.096179659167916, 24.62516989807287, 24.994234333435685, 17.355276768406227, 17.553046879669026, 17.617820029457405, 19.732345851759106, 19.839709798494965, 19.89024798075357, 26.17166268577178, 26.470786472161606, 26.58260082545651, 17.52512779583533, 17.157074516018227, 17.948046392140284, 24.413427611192063, 25.48634362717469, 25.209507805605725, 28.077590962251023, 28.337723979105547, 27.958017786343888, 11.90793639918168, 11.068301637967423, 12.062335833286241, 16.911631711758673, 16.765761483460665, 16.17440463602543, 18.664366615315274, 18.857076962788895, 18.436973368128136, 5.324219338595867, 5.313504211604595, 5.025610610842705, 20.710223862280444, 20.737161622693137, 20.687066507836178, 12.023189549644783, 12.124072273572281, 12.000454549988106, 19.634129657099635, 19.249580586949975, 19.226416322092206, 25.147868519028023, 24.854329501589135, 25.497292404373482, 14.502675258864954, 14.113515769441918, 14.474456268673137, 23.792132427295044, 24.34719816021, 24.30477265672137, 23.278848795841128, 22.685870404044778, 23.414059683370084, 10.046544571717575, 9.985399090995386, 10.044447298472122, 18.686383135461554, 18.08548844357331, 18.285013054807976, 22.806703080733612, 23.439196949203804, 22.864291002353028, -88.99352176984152, -74.40665948142609, -74.07966182505092, 26.750078621009976, 26.615990745524556, 26.374837617079407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316626135452763, "mean_inference_ms": 0.7023315048626236, "mean_action_processing_ms": 0.09998451428226211, "mean_env_wait_ms": 0.8066030944331746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1371942, "timesteps_this_iter": 0, "agent_timesteps_total": 4115826, "timers": {"sample_time_ms": 19657.708, "sample_throughput": 488.053, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3120.51, "learn_throughput": 3074.497, "update_time_ms": 8.647}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 53.46158027648926, "policy_loss": -0.0005918346237358124, "vf_loss": 53.62208127975464, "vf_explained_var": 0.12140234559774399, "kl": 0.007263134364824057, "entropy": 15.990983128547668, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1371942, "num_agent_steps_sampled": 4115826, "num_steps_trained": 1371942, "num_agent_steps_trained": 4115826, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5371, "training_iteration": 143, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-31-17", "timestamp": 1706193077, "time_this_iter_s": 19.053564310073853, "time_total_s": 2875.702445745468, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2875.702445745468, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 7.474074074074075, "ram_util_percent": 52.1888888888889}}
{"episode_reward_max": 108.36347387125713, "episode_reward_min": -251.4776177667082, "episode_reward_mean": 47.06510946143869, "episode_len_mean": 298.59, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -92.56871946652731}, "policy_reward_max": {"shared_policy": 36.221453704095126}, "policy_reward_mean": {"shared_policy": 15.68836982047956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.61416010186075, 57.33387560211122, 70.81786817312238, 20.6781627051532, 63.059324324131, 70.38102408871055, 72.85517555475235, 61.326815363019676, 76.8473641555756, -251.4776177667082, 73.1790178014198, 44.78195731341839, 71.07507438119498, 78.47511046193539, 29.638023965060682, 48.88814572431144, 77.42886583582731, 50.51507334411144, 30.45063788071272, 81.81095973588525, 26.77859060373156, 50.884953390806885, 17.39545550197363, 50.580169067034134, 72.21006041951475, 74.07526214793324, 57.7360275965184, 40.71894687041639, 68.6353041883558, 17.683131605386706, 73.66563759103882, 83.06322439759968, 82.84568219631907, 71.70968610793349, 56.03959046304223, 88.81393082067369, 40.13651926629245, 29.669207695871563, 60.81391062773764, 59.87665344029662, 59.27314784750341, 72.17090264707804, 69.13147792778908, 68.69682304561138, 76.15778051223604, 86.60519378259778, 74.71558389067647, 52.52614367753266, 59.46230363100764, 79.2250499833899, 52.63024870399384, 75.10927904397248, 84.37333272770046, 35.03857387043534, 49.85179783124477, 55.958416946232305, 15.663334161043167, 62.13445199280976, 36.14771637320517, 58.110126566141815, 75.49949042499064, 43.09064729698001, 72.44410324422641, 69.37877888325599, 30.076390961185083, 55.05688463384284, 69.11019103229044, -237.47984307631853, 79.74090698361394, 53.91202553268519, 66.62533220648766, 64.6615610560402, 46.320736296474934, 47.14539977163075, 37.12295208126304, 52.951309253927306, 62.16640561819075, 64.6082365810871, 69.41295468434691, 60.89148930460213, 81.82848994061351, 52.794358782470226, -218.5527150183916, 49.98202896118164, 71.700958058238, -207.78360377252105, 22.15174538642168, 59.18780948966739, 108.36347387125713, 68.07447269931434, 67.05035217851399, 34.345075979828806, 13.259509301278712, 62.60201704315841, 48.85263342037797, 58.02012993767856, 69.57768237590788, 54.27318902267142, 58.61608251091093, 25.438655298203216], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 242, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 263, 300, 300, 273, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.39051980649431, 22.749043722947434, 23.474596572419003, 19.269570412114263, 19.046286057680845, 19.018019132316113, 23.428352693716676, 23.64308502028385, 23.746430459121854, 6.615627395610005, 6.998931008080632, 7.063604301462561, 20.924234700699643, 20.966254019488886, 21.16883560394247, 23.191997855901718, 23.681163173168898, 23.50786305963993, 24.155777484178543, 24.623723678290844, 24.075674392282963, 20.60435479755202, 20.460221285621316, 20.26223927984634, 25.660429189602525, 25.899584584558994, 25.287350381414086, -92.56871946652731, -79.73332822819552, -79.17557007198533, 24.52602552835984, 24.474514849173516, 24.17847742388645, 14.849442109465599, 15.248247101902962, 14.684268102049828, 23.402170846859605, 23.80044440800944, 23.872459126325936, 26.092009549339608, 25.92803322275479, 26.455067689840988, 9.975534314910561, 10.233899253110081, 9.42859039704004, 16.207177872459084, 16.447911356265337, 16.23305649558702, 25.717908553779125, 25.67947991192341, 26.031477370124776, 17.053982451558113, 17.223584860563278, 16.23750603199005, 10.001811782519013, 10.293646945307643, 10.155179152886063, 27.388997965802744, 26.92851250370343, 27.493449266379073, 8.777823598434523, 8.982395801072315, 9.01837120422472, 16.867402645448834, 16.87925990919271, 17.13829083616534, 6.015847995877266, 6.0863156244158745, 5.293291881680489, 16.642741238077477, 16.637617920835808, 17.29980990812085, 24.134348462025315, 24.201749589915067, 23.873962367574364, 24.98505786433816, 23.98576071858406, 25.104443565011024, 18.902462780475616, 19.448067409917712, 19.38549740612507, 13.752287366737917, 13.57002781828244, 13.39663168539603, 23.017875580117106, 22.902651205658913, 22.714777402579784, 6.049648890892655, 5.825068386892468, 5.808414327601582, 24.4620078181227, 24.606125324692883, 24.597504448223233, 27.724238631625965, 27.50383738180001, 27.835148384173706, 27.677446874479443, 27.561064446965844, 27.607170874873788, 23.950566022346408, 23.815878412375838, 23.943241673211247, 18.775409931937844, 18.490395496288926, 18.77378503481546, 29.250812759002045, 29.809384891142443, 29.753733170529202, 13.828453777357936, 13.304411724209785, 13.003653764724731, 9.9902928272883, 9.442500586311013, 10.23641428227225, 20.079885333776474, 20.227123856544495, 20.506901437416673, 20.055436107019574, 19.446631992856652, 20.374585340420396, 20.171833784629897, 19.913831820090607, 19.187482242782906, 24.042041875422, 24.07803376764059, 24.050827004015446, 23.19291511115928, 23.181546316792563, 22.757016499837235, 22.648388408124447, 23.149016983807087, 22.899417653679848, 25.292830934127167, 25.37925745484729, 25.485692123261586, 28.96787852048874, 28.349640369415283, 29.287674892693758, 25.096179659167916, 24.62516989807287, 24.994234333435685, 17.355276768406227, 17.553046879669026, 17.617820029457405, 19.732345851759106, 19.839709798494965, 19.89024798075357, 26.17166268577178, 26.470786472161606, 26.58260082545651, 17.52512779583533, 17.157074516018227, 17.948046392140284, 24.413427611192063, 25.48634362717469, 25.209507805605725, 28.077590962251023, 28.337723979105547, 27.958017786343888, 11.90793639918168, 11.068301637967423, 12.062335833286241, 16.911631711758673, 16.765761483460665, 16.17440463602543, 18.664366615315274, 18.857076962788895, 18.436973368128136, 5.324219338595867, 5.313504211604595, 5.025610610842705, 20.710223862280444, 20.737161622693137, 20.687066507836178, 12.023189549644783, 12.124072273572281, 12.000454549988106, 19.634129657099635, 19.249580586949975, 19.226416322092206, 25.147868519028023, 24.854329501589135, 25.497292404373482, 14.502675258864954, 14.113515769441918, 14.474456268673137, 23.792132427295044, 24.34719816021, 24.30477265672137, 23.278848795841128, 22.685870404044778, 23.414059683370084, 10.046544571717575, 9.985399090995386, 10.044447298472122, 18.686383135461554, 18.08548844357331, 18.285013054807976, 22.806703080733612, 23.439196949203804, 22.864291002353028, -88.99352176984152, -74.40665948142609, -74.07966182505092, 26.750078621009976, 26.615990745524556, 26.374837617079407, 17.828012517342955, 18.05683927020678, 18.027173745135457, 21.652425318956375, 22.3631032705307, 22.60980361700058, 21.257107126216084, 21.651082987586648, 21.753370942237467, 15.50050564110279, 15.644205398857594, 15.17602525651455, 15.6791314681371, 15.727941152950123, 15.738327150543526, 12.382131709406764, 12.378576050202042, 12.36224432165423, 17.991463093863175, 17.165988256533936, 17.793857903530196, 21.320179899533585, 20.227380519111946, 20.61884519954522, 21.72938748945792, 21.28307070334752, 21.59577838828166, 23.639281880110502, 22.974492147564888, 22.799180656671524, 20.64136270185311, 19.893051048119858, 20.357075554629162, 27.326850805431604, 27.045680440962315, 27.45595869421959, 17.682333543896675, 18.02670433372259, 17.08532090485096, -83.3357828060786, -67.83976770440738, -67.37716450790565, 16.644867032766342, 16.5777041092515, 16.7594578191638, 23.882190550367028, 23.915339859823376, 23.903427648047597, -78.26407368977866, -64.59539260466894, -64.92413747807345, 6.652476221323013, 7.76883489638567, 7.730434268712997, 19.68443031112352, 19.63340491677323, 19.869974261770636, 36.078197258214146, 36.063822908947856, 36.221453704095126, 22.828051672627524, 22.676522379120186, 22.56989864756663, 22.398969036837414, 22.37065940101941, 22.280723740657166, 10.603146741787583, 11.757964233557374, 11.98396500448385, 4.095238621036202, 4.743981332673371, 4.420289347569138, 21.05676101706922, 20.985582761466503, 20.55967326462269, 16.238134384155273, 16.370729628950357, 16.24376940727234, 19.375396845241383, 19.097434682150677, 19.5472984102865, 23.093711418410138, 23.199728076656655, 23.28424288084109, 18.078642598663762, 17.985117388268307, 18.209429035739348, 19.840571514330804, 19.531070694327354, 19.24444030225277, 8.467506145437554, 8.525603593637541, 8.44554555912812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15312508117058177, "mean_inference_ms": 0.7023174944678772, "mean_action_processing_ms": 0.09999704632893583, "mean_env_wait_ms": 0.806456498653275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1381536, "timesteps_this_iter": 0, "agent_timesteps_total": 4144608, "timers": {"sample_time_ms": 19724.025, "sample_throughput": 486.412, "load_time_ms": 0.1, "load_throughput": 95878371.637, "learn_time_ms": 3123.175, "learn_throughput": 3071.874, "update_time_ms": 8.595}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 86.01219940185547, "policy_loss": -0.0009168918476585297, "vf_loss": 86.17424011230469, "vf_explained_var": 0.23898938298225403, "kl": 0.006184591002450024, "entropy": 16.11247754096985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1381536, "num_agent_steps_sampled": 4144608, "num_steps_trained": 1381536, "num_agent_steps_trained": 4144608, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5402, "training_iteration": 144, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-31-37", "timestamp": 1706193097, "time_this_iter_s": 19.582379817962646, "time_total_s": 2895.284825563431, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41AA1700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2895.284825563431, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 7.192857142857144, "ram_util_percent": 52.2}}
{"episode_reward_max": 108.36347387125713, "episode_reward_min": -300.4903974719346, "episode_reward_mean": 43.92909451236628, "episode_len_mean": 296.47, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -107.10431471467018}, "policy_reward_max": {"shared_policy": 36.221453704095126}, "policy_reward_mean": {"shared_policy": 14.643031504122089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.03959046304223, 88.81393082067369, 40.13651926629245, 29.669207695871563, 60.81391062773764, 59.87665344029662, 59.27314784750341, 72.17090264707804, 69.13147792778908, 68.69682304561138, 76.15778051223604, 86.60519378259778, 74.71558389067647, 52.52614367753266, 59.46230363100764, 79.2250499833899, 52.63024870399384, 75.10927904397248, 84.37333272770046, 35.03857387043534, 49.85179783124477, 55.958416946232305, 15.663334161043167, 62.13445199280976, 36.14771637320517, 58.110126566141815, 75.49949042499064, 43.09064729698001, 72.44410324422641, 69.37877888325599, 30.076390961185083, 55.05688463384284, 69.11019103229044, -237.47984307631853, 79.74090698361394, 53.91202553268519, 66.62533220648766, 64.6615610560402, 46.320736296474934, 47.14539977163075, 37.12295208126304, 52.951309253927306, 62.16640561819075, 64.6082365810871, 69.41295468434691, 60.89148930460213, 81.82848994061351, 52.794358782470226, -218.5527150183916, 49.98202896118164, 71.700958058238, -207.78360377252105, 22.15174538642168, 59.18780948966739, 108.36347387125713, 68.07447269931434, 67.05035217851399, 34.345075979828806, 13.259509301278712, 62.60201704315841, 48.85263342037797, 58.02012993767856, 69.57768237590788, 54.27318902267142, 58.61608251091093, 25.438655298203216, 37.72928423807022, 89.79030469805, 62.19706660695374, 65.22370213037355, -300.19975926727057, 84.09264631569384, 77.16720009688288, 48.6253558807075, 84.58434679545459, 6.351384865120025, 85.94023297354576, 85.09724051505326, 75.55131372809407, 2.606976102571906, 35.25218872167167, 92.18043899536131, 20.843883544206605, 70.22758822864853, -300.4903974719346, 71.38418852910397, 46.466860669432194, 68.64130600355563, 60.734251063317046, 74.574399150908, 59.40203414484857, 34.32848741114137, 81.00893090851604, 59.03481351584193, 102.98259733850134, 64.93096626829355, 53.12930022925137, 38.204810466617346, 63.15460841730234, 71.31110370904204], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 263, 300, 300, 273, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 41, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 289, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.775409931937844, 18.490395496288926, 18.77378503481546, 29.250812759002045, 29.809384891142443, 29.753733170529202, 13.828453777357936, 13.304411724209785, 13.003653764724731, 9.9902928272883, 9.442500586311013, 10.23641428227225, 20.079885333776474, 20.227123856544495, 20.506901437416673, 20.055436107019574, 19.446631992856652, 20.374585340420396, 20.171833784629897, 19.913831820090607, 19.187482242782906, 24.042041875422, 24.07803376764059, 24.050827004015446, 23.19291511115928, 23.181546316792563, 22.757016499837235, 22.648388408124447, 23.149016983807087, 22.899417653679848, 25.292830934127167, 25.37925745484729, 25.485692123261586, 28.96787852048874, 28.349640369415283, 29.287674892693758, 25.096179659167916, 24.62516989807287, 24.994234333435685, 17.355276768406227, 17.553046879669026, 17.617820029457405, 19.732345851759106, 19.839709798494965, 19.89024798075357, 26.17166268577178, 26.470786472161606, 26.58260082545651, 17.52512779583533, 17.157074516018227, 17.948046392140284, 24.413427611192063, 25.48634362717469, 25.209507805605725, 28.077590962251023, 28.337723979105547, 27.958017786343888, 11.90793639918168, 11.068301637967423, 12.062335833286241, 16.911631711758673, 16.765761483460665, 16.17440463602543, 18.664366615315274, 18.857076962788895, 18.436973368128136, 5.324219338595867, 5.313504211604595, 5.025610610842705, 20.710223862280444, 20.737161622693137, 20.687066507836178, 12.023189549644783, 12.124072273572281, 12.000454549988106, 19.634129657099635, 19.249580586949975, 19.226416322092206, 25.147868519028023, 24.854329501589135, 25.497292404373482, 14.502675258864954, 14.113515769441918, 14.474456268673137, 23.792132427295044, 24.34719816021, 24.30477265672137, 23.278848795841128, 22.685870404044778, 23.414059683370084, 10.046544571717575, 9.985399090995386, 10.044447298472122, 18.686383135461554, 18.08548844357331, 18.285013054807976, 22.806703080733612, 23.439196949203804, 22.864291002353028, -88.99352176984152, -74.40665948142609, -74.07966182505092, 26.750078621009976, 26.615990745524556, 26.374837617079407, 17.828012517342955, 18.05683927020678, 18.027173745135457, 21.652425318956375, 22.3631032705307, 22.60980361700058, 21.257107126216084, 21.651082987586648, 21.753370942237467, 15.50050564110279, 15.644205398857594, 15.17602525651455, 15.6791314681371, 15.727941152950123, 15.738327150543526, 12.382131709406764, 12.378576050202042, 12.36224432165423, 17.991463093863175, 17.165988256533936, 17.793857903530196, 21.320179899533585, 20.227380519111946, 20.61884519954522, 21.72938748945792, 21.28307070334752, 21.59577838828166, 23.639281880110502, 22.974492147564888, 22.799180656671524, 20.64136270185311, 19.893051048119858, 20.357075554629162, 27.326850805431604, 27.045680440962315, 27.45595869421959, 17.682333543896675, 18.02670433372259, 17.08532090485096, -83.3357828060786, -67.83976770440738, -67.37716450790565, 16.644867032766342, 16.5777041092515, 16.7594578191638, 23.882190550367028, 23.915339859823376, 23.903427648047597, -78.26407368977866, -64.59539260466894, -64.92413747807345, 6.652476221323013, 7.76883489638567, 7.730434268712997, 19.68443031112352, 19.63340491677323, 19.869974261770636, 36.078197258214146, 36.063822908947856, 36.221453704095126, 22.828051672627524, 22.676522379120186, 22.56989864756663, 22.398969036837414, 22.37065940101941, 22.280723740657166, 10.603146741787583, 11.757964233557374, 11.98396500448385, 4.095238621036202, 4.743981332673371, 4.420289347569138, 21.05676101706922, 20.985582761466503, 20.55967326462269, 16.238134384155273, 16.370729628950357, 16.24376940727234, 19.375396845241383, 19.097434682150677, 19.5472984102865, 23.093711418410138, 23.199728076656655, 23.28424288084109, 18.078642598663762, 17.985117388268307, 18.209429035739348, 19.840571514330804, 19.531070694327354, 19.24444030225277, 8.467506145437554, 8.525603593637541, 8.44554555912812, 12.286144102613122, 12.64826167250672, 12.79487846295038, 29.953920556853205, 29.941598283747823, 29.894785857448966, 20.609349880367517, 20.785123232752085, 20.802593493834138, 21.48955151935418, 22.17170685793583, 21.562443753083542, -96.41015514731407, -96.68528940528631, -107.10431471467018, 28.189607461293534, 28.198633839686707, 27.7044050147136, 26.01385346148163, 25.628666579723358, 25.52468005567789, 16.745169956237078, 15.474503815174103, 16.405682109296322, 28.206853081161768, 28.110693867007882, 28.266799847284943, 2.189211376632244, 2.20081480840841, 1.9613586800793712, 28.813709078977496, 28.500232140223176, 28.62629175434509, 28.53730472673972, 28.44019128878911, 28.11974449952443, 25.003420973817498, 25.019399637977273, 25.528493116299302, 0.7365279297033851, 0.4940095941225593, 1.3764385787459616, 12.006687831754476, 11.6910655448834, 11.554435345033795, 30.821471401800707, 30.67144639914234, 30.687521194418267, 6.978975036491946, 7.022774578382567, 6.842133929332093, 23.45856754295528, 23.50631414516829, 23.26270654052496, -96.17922625069818, -106.42780017604431, -97.88337104519209, 24.3603849026064, 23.378863538304955, 23.644940088192612, 15.563360785444573, 15.060648282368973, 15.842851601618648, 22.43691953519979, 23.261403345192463, 22.942983123163373, 20.855834395935133, 19.668502440055207, 20.209914227326706, 24.04965528845787, 25.21345829218626, 25.311285570263863, 19.32721484204133, 19.860267897446946, 20.214551405360297, 11.376671793560178, 11.763495581845433, 11.188320035735757, 26.982766800870493, 27.07534731489916, 26.95081679274638, 18.91881741086641, 20.046186237285525, 20.069809867689997, 34.28747008989254, 34.173000822464616, 34.52212642614418, 21.738482041594878, 21.7745172449698, 21.417966981728867, 17.8174215046068, 17.415333544214562, 17.89654518043001, 12.890620894730091, 12.763899277895689, 12.550290293991566, 21.162279992053897, 21.03762628386417, 20.954702141384274, 23.780895772079617, 23.646931166450173, 23.883276770512254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530474639646279, "mean_inference_ms": 0.7020312097398487, "mean_action_processing_ms": 0.09996113083562504, "mean_env_wait_ms": 0.8061853109303904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1391130, "timesteps_this_iter": 0, "agent_timesteps_total": 4173390, "timers": {"sample_time_ms": 19750.857, "sample_throughput": 485.751, "load_time_ms": 0.2, "load_throughput": 47944897.624, "learn_time_ms": 3110.521, "learn_throughput": 3084.37, "update_time_ms": 8.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 111.11869621276855, "policy_loss": -0.001438874162605075, "vf_loss": 111.28097343444824, "vf_explained_var": -0.06309382617473602, "kl": 0.007142699571188978, "entropy": 16.083452224731445, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1391130, "num_agent_steps_sampled": 4173390, "num_steps_trained": 1391130, "num_agent_steps_trained": 4173390, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5436, "training_iteration": 145, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-31-57", "timestamp": 1706193117, "time_this_iter_s": 20.208006620407104, "time_total_s": 2915.492832183838, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01626A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2915.492832183838, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 9.310714285714287, "ram_util_percent": 51.607142857142854}}
{"episode_reward_max": 108.36347387125713, "episode_reward_min": -300.4903974719346, "episode_reward_mean": 44.82759151070494, "episode_len_mean": 296.47, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -107.10431471467018}, "policy_reward_max": {"shared_policy": 36.221453704095126}, "policy_reward_mean": {"shared_policy": 14.94253050356831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.05688463384284, 69.11019103229044, -237.47984307631853, 79.74090698361394, 53.91202553268519, 66.62533220648766, 64.6615610560402, 46.320736296474934, 47.14539977163075, 37.12295208126304, 52.951309253927306, 62.16640561819075, 64.6082365810871, 69.41295468434691, 60.89148930460213, 81.82848994061351, 52.794358782470226, -218.5527150183916, 49.98202896118164, 71.700958058238, -207.78360377252105, 22.15174538642168, 59.18780948966739, 108.36347387125713, 68.07447269931434, 67.05035217851399, 34.345075979828806, 13.259509301278712, 62.60201704315841, 48.85263342037797, 58.02012993767856, 69.57768237590788, 54.27318902267142, 58.61608251091093, 25.438655298203216, 37.72928423807022, 89.79030469805, 62.19706660695374, 65.22370213037355, -300.19975926727057, 84.09264631569384, 77.16720009688288, 48.6253558807075, 84.58434679545459, 6.351384865120025, 85.94023297354576, 85.09724051505326, 75.55131372809407, 2.606976102571906, 35.25218872167167, 92.18043899536131, 20.843883544206605, 70.22758822864853, -300.4903974719346, 71.38418852910397, 46.466860669432194, 68.64130600355563, 60.734251063317046, 74.574399150908, 59.40203414484857, 34.32848741114137, 81.00893090851604, 59.03481351584193, 102.98259733850134, 64.93096626829355, 53.12930022925137, 38.204810466617346, 63.15460841730234, 71.31110370904204, 39.853664904832826, 80.78685733536257, 56.38617590349165, 74.2459508916363, 59.483785614371286, 57.522303298115716, 67.29749790951607, 76.99850278347728, 67.37972098588942, 75.66585271293296, 67.67511110194025, 53.03841766901313, 76.13962436839938, 62.89012168720363, 62.9146591629833, 48.3443682231009, 75.82923959568141, 53.2488846052438, 53.25941451638934, 95.72485952824353, 47.5441169440746, 77.2169280508533, 91.74673599749804, 73.14743342250584, -1.8074638657272146, 73.73125233873725, 87.67554228624793, 72.9429318681359, 51.246480360627174, 19.437407479621456, 41.10423044022171], "episode_lengths": [300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 263, 300, 300, 273, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 41, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 289, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.686383135461554, 18.08548844357331, 18.285013054807976, 22.806703080733612, 23.439196949203804, 22.864291002353028, -88.99352176984152, -74.40665948142609, -74.07966182505092, 26.750078621009976, 26.615990745524556, 26.374837617079407, 17.828012517342955, 18.05683927020678, 18.027173745135457, 21.652425318956375, 22.3631032705307, 22.60980361700058, 21.257107126216084, 21.651082987586648, 21.753370942237467, 15.50050564110279, 15.644205398857594, 15.17602525651455, 15.6791314681371, 15.727941152950123, 15.738327150543526, 12.382131709406764, 12.378576050202042, 12.36224432165423, 17.991463093863175, 17.165988256533936, 17.793857903530196, 21.320179899533585, 20.227380519111946, 20.61884519954522, 21.72938748945792, 21.28307070334752, 21.59577838828166, 23.639281880110502, 22.974492147564888, 22.799180656671524, 20.64136270185311, 19.893051048119858, 20.357075554629162, 27.326850805431604, 27.045680440962315, 27.45595869421959, 17.682333543896675, 18.02670433372259, 17.08532090485096, -83.3357828060786, -67.83976770440738, -67.37716450790565, 16.644867032766342, 16.5777041092515, 16.7594578191638, 23.882190550367028, 23.915339859823376, 23.903427648047597, -78.26407368977866, -64.59539260466894, -64.92413747807345, 6.652476221323013, 7.76883489638567, 7.730434268712997, 19.68443031112352, 19.63340491677323, 19.869974261770636, 36.078197258214146, 36.063822908947856, 36.221453704095126, 22.828051672627524, 22.676522379120186, 22.56989864756663, 22.398969036837414, 22.37065940101941, 22.280723740657166, 10.603146741787583, 11.757964233557374, 11.98396500448385, 4.095238621036202, 4.743981332673371, 4.420289347569138, 21.05676101706922, 20.985582761466503, 20.55967326462269, 16.238134384155273, 16.370729628950357, 16.24376940727234, 19.375396845241383, 19.097434682150677, 19.5472984102865, 23.093711418410138, 23.199728076656655, 23.28424288084109, 18.078642598663762, 17.985117388268307, 18.209429035739348, 19.840571514330804, 19.531070694327354, 19.24444030225277, 8.467506145437554, 8.525603593637541, 8.44554555912812, 12.286144102613122, 12.64826167250672, 12.79487846295038, 29.953920556853205, 29.941598283747823, 29.894785857448966, 20.609349880367517, 20.785123232752085, 20.802593493834138, 21.48955151935418, 22.17170685793583, 21.562443753083542, -96.41015514731407, -96.68528940528631, -107.10431471467018, 28.189607461293534, 28.198633839686707, 27.7044050147136, 26.01385346148163, 25.628666579723358, 25.52468005567789, 16.745169956237078, 15.474503815174103, 16.405682109296322, 28.206853081161768, 28.110693867007882, 28.266799847284943, 2.189211376632244, 2.20081480840841, 1.9613586800793712, 28.813709078977496, 28.500232140223176, 28.62629175434509, 28.53730472673972, 28.44019128878911, 28.11974449952443, 25.003420973817498, 25.019399637977273, 25.528493116299302, 0.7365279297033851, 0.4940095941225593, 1.3764385787459616, 12.006687831754476, 11.6910655448834, 11.554435345033795, 30.821471401800707, 30.67144639914234, 30.687521194418267, 6.978975036491946, 7.022774578382567, 6.842133929332093, 23.45856754295528, 23.50631414516829, 23.26270654052496, -96.17922625069818, -106.42780017604431, -97.88337104519209, 24.3603849026064, 23.378863538304955, 23.644940088192612, 15.563360785444573, 15.060648282368973, 15.842851601618648, 22.43691953519979, 23.261403345192463, 22.942983123163373, 20.855834395935133, 19.668502440055207, 20.209914227326706, 24.04965528845787, 25.21345829218626, 25.311285570263863, 19.32721484204133, 19.860267897446946, 20.214551405360297, 11.376671793560178, 11.763495581845433, 11.188320035735757, 26.982766800870493, 27.07534731489916, 26.95081679274638, 18.91881741086641, 20.046186237285525, 20.069809867689997, 34.28747008989254, 34.173000822464616, 34.52212642614418, 21.738482041594878, 21.7745172449698, 21.417966981728867, 17.8174215046068, 17.415333544214562, 17.89654518043001, 12.890620894730091, 12.763899277895689, 12.550290293991566, 21.162279992053897, 21.03762628386417, 20.954702141384274, 23.780895772079617, 23.646931166450173, 23.883276770512254, 13.442873833080128, 13.277888325353459, 13.132902746399239, 26.843500667562083, 26.904215821375445, 27.039140846425042, 18.915390859047562, 18.488532605270535, 18.98225243917355, 25.068137076062456, 24.74352182199557, 24.43429199357827, 19.259832968314484, 20.166887139280632, 20.05706550677617, 19.125874509414032, 19.03224041809638, 19.364188370605305, 22.461208476374537, 22.416129278639943, 22.420160154501588, 25.719384676466376, 25.788951269040496, 25.490166837970406, 22.621498477955654, 22.39738680173953, 22.360835706194237, 24.73869541784127, 25.425242652495697, 25.50191464259599, 22.628350467110664, 22.498753764356167, 22.548006870473415, 17.768066137408212, 17.692276065548256, 17.57807546605666, 24.744367316365242, 25.72021619975567, 25.67504085227847, 21.01790424653639, 20.814533976217106, 21.057683464450136, 21.300329418852925, 20.461567521095276, 21.152762223035097, 16.155645951628685, 16.046536818146706, 16.14218545332551, 25.00004269679387, 25.447113649298743, 25.382083249588803, 17.954989368095994, 17.760818026959896, 17.533077210187912, 17.583221721152455, 17.905037107566983, 17.771155687669904, 31.48235987623532, 32.15620285583039, 32.08629679617782, 15.677777792016656, 16.058313513795525, 15.808025638262421, 25.964234477219478, 25.48288734753926, 25.76980622609456, 30.35764540731907, 30.781831473112106, 30.60725911706686, 24.28597292055686, 24.437072594960526, 24.424387906988457, -0.7784337451060708, -0.4812374984224732, -0.5477926221986706, 24.640571646392345, 24.991855550557375, 24.09882514178753, 29.031101894875363, 29.54795164238506, 29.09648874898751, 24.3818555685381, 24.211318689088017, 24.349757610509783, 17.240281768143177, 16.77037227153778, 17.235826320946217, 6.478755069275692, 6.748649245438472, 6.210003164907292, 13.92117742200692, 13.259742965300873, 13.92331005291392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530643611921034, "mean_inference_ms": 0.7020445045577898, "mean_action_processing_ms": 0.09997866775112087, "mean_env_wait_ms": 0.8061074661130072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1400724, "timesteps_this_iter": 0, "agent_timesteps_total": 4202172, "timers": {"sample_time_ms": 19707.05, "sample_throughput": 486.831, "load_time_ms": 0.2, "load_throughput": 47944897.624, "learn_time_ms": 3066.914, "learn_throughput": 3128.226, "update_time_ms": 8.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 12.300291299819946, "policy_loss": -0.0004559152720922388, "vf_loss": 12.463141322135925, "vf_explained_var": -0.4727250188589096, "kl": 0.006721733254595077, "entropy": 16.239375352859497, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1400724, "num_agent_steps_sampled": 4202172, "num_steps_trained": 1400724, "num_agent_steps_trained": 4202172, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5467, "training_iteration": 146, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-32-16", "timestamp": 1706193136, "time_this_iter_s": 19.040801525115967, "time_total_s": 2934.533633708954, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2934.533633708954, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 9.170370370370371, "ram_util_percent": 51.52592592592592}}
{"episode_reward_max": 109.85133021185172, "episode_reward_min": -300.9362450223416, "episode_reward_mean": 44.316035894152, "episode_len_mean": 293.03, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -107.10431471467018}, "policy_reward_max": {"shared_policy": 37.03278629590446}, "policy_reward_mean": {"shared_policy": 14.772011964717331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.72928423807022, 89.79030469805, 62.19706660695374, 65.22370213037355, -300.19975926727057, 84.09264631569384, 77.16720009688288, 48.6253558807075, 84.58434679545459, 6.351384865120025, 85.94023297354576, 85.09724051505326, 75.55131372809407, 2.606976102571906, 35.25218872167167, 92.18043899536131, 20.843883544206605, 70.22758822864853, -300.4903974719346, 71.38418852910397, 46.466860669432194, 68.64130600355563, 60.734251063317046, 74.574399150908, 59.40203414484857, 34.32848741114137, 81.00893090851604, 59.03481351584193, 102.98259733850134, 64.93096626829355, 53.12930022925137, 38.204810466617346, 63.15460841730234, 71.31110370904204, 39.853664904832826, 80.78685733536257, 56.38617590349165, 74.2459508916363, 59.483785614371286, 57.522303298115716, 67.29749790951607, 76.99850278347728, 67.37972098588942, 75.66585271293296, 67.67511110194025, 53.03841766901313, 76.13962436839938, 62.89012168720363, 62.9146591629833, 48.3443682231009, 75.82923959568141, 53.2488846052438, 53.25941451638934, 95.72485952824353, 47.5441169440746, 77.2169280508533, 91.74673599749804, 73.14743342250584, -1.8074638657272146, 73.73125233873725, 87.67554228624793, 72.9429318681359, 51.246480360627174, 19.437407479621456, 41.10423044022171, 86.87230411358175, 72.88241337426005, 69.13950456306338, -284.9470367580652, 55.05024403671267, 74.2537109926343, 28.39961602119726, 77.93989930488166, 40.61592477932571, 78.89256054535508, 48.54041043110189, 48.757845558109665, 45.35952903330326, 19.50960298627612, 65.78223994188009, 60.85438648425041, 70.6412441059947, -300.9362450223416, 31.373120762407765, 83.49630781263113, 75.65837571024893, 78.56116216070947, 27.08042684197426, 89.03056648699565, 18.74426280707121, 16.26678310893473, 38.38125450909136, 68.48941664490847, -245.24749037623405, 67.32877952232955, 109.85133021185172, 91.41851083934306, 56.42668640706687, 80.41457680799066, 75.99110102280973], "episode_lengths": [300, 300, 300, 300, 41, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 289, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 145, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 37, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [12.286144102613122, 12.64826167250672, 12.79487846295038, 29.953920556853205, 29.941598283747823, 29.894785857448966, 20.609349880367517, 20.785123232752085, 20.802593493834138, 21.48955151935418, 22.17170685793583, 21.562443753083542, -96.41015514731407, -96.68528940528631, -107.10431471467018, 28.189607461293534, 28.198633839686707, 27.7044050147136, 26.01385346148163, 25.628666579723358, 25.52468005567789, 16.745169956237078, 15.474503815174103, 16.405682109296322, 28.206853081161768, 28.110693867007882, 28.266799847284943, 2.189211376632244, 2.20081480840841, 1.9613586800793712, 28.813709078977496, 28.500232140223176, 28.62629175434509, 28.53730472673972, 28.44019128878911, 28.11974449952443, 25.003420973817498, 25.019399637977273, 25.528493116299302, 0.7365279297033851, 0.4940095941225593, 1.3764385787459616, 12.006687831754476, 11.6910655448834, 11.554435345033795, 30.821471401800707, 30.67144639914234, 30.687521194418267, 6.978975036491946, 7.022774578382567, 6.842133929332093, 23.45856754295528, 23.50631414516829, 23.26270654052496, -96.17922625069818, -106.42780017604431, -97.88337104519209, 24.3603849026064, 23.378863538304955, 23.644940088192612, 15.563360785444573, 15.060648282368973, 15.842851601618648, 22.43691953519979, 23.261403345192463, 22.942983123163373, 20.855834395935133, 19.668502440055207, 20.209914227326706, 24.04965528845787, 25.21345829218626, 25.311285570263863, 19.32721484204133, 19.860267897446946, 20.214551405360297, 11.376671793560178, 11.763495581845433, 11.188320035735757, 26.982766800870493, 27.07534731489916, 26.95081679274638, 18.91881741086641, 20.046186237285525, 20.069809867689997, 34.28747008989254, 34.173000822464616, 34.52212642614418, 21.738482041594878, 21.7745172449698, 21.417966981728867, 17.8174215046068, 17.415333544214562, 17.89654518043001, 12.890620894730091, 12.763899277895689, 12.550290293991566, 21.162279992053897, 21.03762628386417, 20.954702141384274, 23.780895772079617, 23.646931166450173, 23.883276770512254, 13.442873833080128, 13.277888325353459, 13.132902746399239, 26.843500667562083, 26.904215821375445, 27.039140846425042, 18.915390859047562, 18.488532605270535, 18.98225243917355, 25.068137076062456, 24.74352182199557, 24.43429199357827, 19.259832968314484, 20.166887139280632, 20.05706550677617, 19.125874509414032, 19.03224041809638, 19.364188370605305, 22.461208476374537, 22.416129278639943, 22.420160154501588, 25.719384676466376, 25.788951269040496, 25.490166837970406, 22.621498477955654, 22.39738680173953, 22.360835706194237, 24.73869541784127, 25.425242652495697, 25.50191464259599, 22.628350467110664, 22.498753764356167, 22.548006870473415, 17.768066137408212, 17.692276065548256, 17.57807546605666, 24.744367316365242, 25.72021619975567, 25.67504085227847, 21.01790424653639, 20.814533976217106, 21.057683464450136, 21.300329418852925, 20.461567521095276, 21.152762223035097, 16.155645951628685, 16.046536818146706, 16.14218545332551, 25.00004269679387, 25.447113649298743, 25.382083249588803, 17.954989368095994, 17.760818026959896, 17.533077210187912, 17.583221721152455, 17.905037107566983, 17.771155687669904, 31.48235987623532, 32.15620285583039, 32.08629679617782, 15.677777792016656, 16.058313513795525, 15.808025638262421, 25.964234477219478, 25.48288734753926, 25.76980622609456, 30.35764540731907, 30.781831473112106, 30.60725911706686, 24.28597292055686, 24.437072594960526, 24.424387906988457, -0.7784337451060708, -0.4812374984224732, -0.5477926221986706, 24.640571646392345, 24.991855550557375, 24.09882514178753, 29.031101894875363, 29.54795164238506, 29.09648874898751, 24.3818555685381, 24.211318689088017, 24.349757610509783, 17.240281768143177, 16.77037227153778, 17.235826320946217, 6.478755069275692, 6.748649245438472, 6.210003164907292, 13.92117742200692, 13.259742965300873, 13.92331005291392, 28.989676073814422, 28.922825096795947, 28.95980294297138, 24.11839461078246, 24.359327127536133, 24.40469163594146, 23.099837731570005, 22.955176793038845, 23.084490038454533, -103.7859377861023, -90.54370833933353, -90.6173906326294, 17.772150476773575, 18.857976370452278, 18.420117189486817, 25.00282473862171, 24.282906726002693, 24.96797952800989, 9.558250258366257, 8.791063527266175, 10.050302235564828, 25.857435363034398, 26.00503199795881, 26.077431943888456, 13.240265329678849, 13.559898739059761, 13.8157607105871, 25.91836452484131, 26.481969356536865, 26.492226663976908, 15.956921050945908, 16.85344245719412, 15.730046922961861, 16.181005882720143, 16.009869063893944, 16.566970611495577, 15.316641628742218, 14.93466503918171, 15.108222365379333, 6.241429018477589, 6.751286479334027, 6.516887488464505, 22.336496102934078, 22.002251630028084, 21.44349220891793, 19.909779017170266, 20.347306204338864, 20.597301262741283, 23.636026822030544, 23.506647750735283, 23.498569533228874, -99.39800142248473, -98.06834446204206, -103.46989913781485, 10.424508114655808, 10.58568738152583, 10.362925266226128, 27.592563457787037, 28.113670885562897, 27.790073469281197, 25.31252861519654, 25.17293271174033, 25.17291438331206, 25.961569766203553, 26.37139454918602, 26.228197845319897, 8.616376727819443, 9.095532692968845, 9.36851742118597, 29.51769320418437, 29.80268765132253, 29.710185631488756, 5.987120784819126, 6.286567460745573, 6.47057456150651, 5.402351299921662, 5.337561106930167, 5.526870702082903, 12.953926493724182, 12.701016460855797, 12.726311554511383, 22.643891786535576, 22.67953122903903, 23.16599362933387, -91.11132357517879, -77.01586421827476, -77.12030258278052, 22.821921591957405, 21.557035108407334, 22.949822821964815, 36.233070010940224, 36.585473905007035, 37.03278629590446, 30.16193129618962, 30.754461516936615, 30.50211802621682, 18.787325279166296, 18.774321762224034, 18.865039365676537, 26.823529628415898, 26.541468565662697, 27.04957861391206, 25.440188882251576, 25.401015275468424, 25.14989686508973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15301022724130478, "mean_inference_ms": 0.7017519568520341, "mean_action_processing_ms": 0.09993585428503318, "mean_env_wait_ms": 0.805762172086066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1410318, "timesteps_this_iter": 0, "agent_timesteps_total": 4230954, "timers": {"sample_time_ms": 19584.089, "sample_throughput": 489.887, "load_time_ms": 0.299, "load_throughput": 32043440.497, "learn_time_ms": 3036.379, "learn_throughput": 3159.685, "update_time_ms": 8.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 124.2182846069336, "policy_loss": -0.000694353043145024, "vf_loss": 124.38186836242676, "vf_explained_var": 0.1795874685049057, "kl": 0.0071670867039188655, "entropy": 16.288507223129272, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1410318, "num_agent_steps_sampled": 4230954, "num_steps_trained": 1410318, "num_agent_steps_trained": 4230954, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5502, "training_iteration": 147, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-32-35", "timestamp": 1706193155, "time_this_iter_s": 19.195847988128662, "time_total_s": 2953.7294816970825, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41AA15E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2953.7294816970825, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 8.603703703703705, "ram_util_percent": 51.4}}
{"episode_reward_max": 109.85133021185172, "episode_reward_min": -300.9362450223416, "episode_reward_mean": 50.932655679186276, "episode_len_mean": 295.73, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -103.7859377861023}, "policy_reward_max": {"shared_policy": 37.03278629590446}, "policy_reward_mean": {"shared_policy": 16.97755189306209}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.12930022925137, 38.204810466617346, 63.15460841730234, 71.31110370904204, 39.853664904832826, 80.78685733536257, 56.38617590349165, 74.2459508916363, 59.483785614371286, 57.522303298115716, 67.29749790951607, 76.99850278347728, 67.37972098588942, 75.66585271293296, 67.67511110194025, 53.03841766901313, 76.13962436839938, 62.89012168720363, 62.9146591629833, 48.3443682231009, 75.82923959568141, 53.2488846052438, 53.25941451638934, 95.72485952824353, 47.5441169440746, 77.2169280508533, 91.74673599749804, 73.14743342250584, -1.8074638657272146, 73.73125233873725, 87.67554228624793, 72.9429318681359, 51.246480360627174, 19.437407479621456, 41.10423044022171, 86.87230411358175, 72.88241337426005, 69.13950456306338, -284.9470367580652, 55.05024403671267, 74.2537109926343, 28.39961602119726, 77.93989930488166, 40.61592477932571, 78.89256054535508, 48.54041043110189, 48.757845558109665, 45.35952903330326, 19.50960298627612, 65.78223994188009, 60.85438648425041, 70.6412441059947, -300.9362450223416, 31.373120762407765, 83.49630781263113, 75.65837571024893, 78.56116216070947, 27.08042684197426, 89.03056648699565, 18.74426280707121, 16.26678310893473, 38.38125450909136, 68.48941664490847, -245.24749037623405, 67.32877952232955, 109.85133021185172, 91.41851083934306, 56.42668640706687, 80.41457680799066, 75.99110102280973, 88.71437107026577, 7.335659012198434, 60.23119938094166, 47.39579133712684, 84.53395481035113, 71.77636297792196, 65.96389700728466, 73.11157876902143, 67.55681619420645, 68.71933374088258, 40.29888319969176, 91.70780649618243, 60.48925232375041, 98.88071172311899, 79.74893375393003, 79.76867523789403, 81.32900765538213, 83.43683190271258, 64.88815078395419, 52.638652838766575, 28.094686921685934, 34.88156773429364, 30.892981362994732, -32.895135816186695, 63.026348706334815, 62.009027764201164, 62.31148382648826, 65.40278817596844, 64.58002423867583, 61.09216807410118], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 145, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 37, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.8174215046068, 17.415333544214562, 17.89654518043001, 12.890620894730091, 12.763899277895689, 12.550290293991566, 21.162279992053897, 21.03762628386417, 20.954702141384274, 23.780895772079617, 23.646931166450173, 23.883276770512254, 13.442873833080128, 13.277888325353459, 13.132902746399239, 26.843500667562083, 26.904215821375445, 27.039140846425042, 18.915390859047562, 18.488532605270535, 18.98225243917355, 25.068137076062456, 24.74352182199557, 24.43429199357827, 19.259832968314484, 20.166887139280632, 20.05706550677617, 19.125874509414032, 19.03224041809638, 19.364188370605305, 22.461208476374537, 22.416129278639943, 22.420160154501588, 25.719384676466376, 25.788951269040496, 25.490166837970406, 22.621498477955654, 22.39738680173953, 22.360835706194237, 24.73869541784127, 25.425242652495697, 25.50191464259599, 22.628350467110664, 22.498753764356167, 22.548006870473415, 17.768066137408212, 17.692276065548256, 17.57807546605666, 24.744367316365242, 25.72021619975567, 25.67504085227847, 21.01790424653639, 20.814533976217106, 21.057683464450136, 21.300329418852925, 20.461567521095276, 21.152762223035097, 16.155645951628685, 16.046536818146706, 16.14218545332551, 25.00004269679387, 25.447113649298743, 25.382083249588803, 17.954989368095994, 17.760818026959896, 17.533077210187912, 17.583221721152455, 17.905037107566983, 17.771155687669904, 31.48235987623532, 32.15620285583039, 32.08629679617782, 15.677777792016656, 16.058313513795525, 15.808025638262421, 25.964234477219478, 25.48288734753926, 25.76980622609456, 30.35764540731907, 30.781831473112106, 30.60725911706686, 24.28597292055686, 24.437072594960526, 24.424387906988457, -0.7784337451060708, -0.4812374984224732, -0.5477926221986706, 24.640571646392345, 24.991855550557375, 24.09882514178753, 29.031101894875363, 29.54795164238506, 29.09648874898751, 24.3818555685381, 24.211318689088017, 24.349757610509783, 17.240281768143177, 16.77037227153778, 17.235826320946217, 6.478755069275692, 6.748649245438472, 6.210003164907292, 13.92117742200692, 13.259742965300873, 13.92331005291392, 28.989676073814422, 28.922825096795947, 28.95980294297138, 24.11839461078246, 24.359327127536133, 24.40469163594146, 23.099837731570005, 22.955176793038845, 23.084490038454533, -103.7859377861023, -90.54370833933353, -90.6173906326294, 17.772150476773575, 18.857976370452278, 18.420117189486817, 25.00282473862171, 24.282906726002693, 24.96797952800989, 9.558250258366257, 8.791063527266175, 10.050302235564828, 25.857435363034398, 26.00503199795881, 26.077431943888456, 13.240265329678849, 13.559898739059761, 13.8157607105871, 25.91836452484131, 26.481969356536865, 26.492226663976908, 15.956921050945908, 16.85344245719412, 15.730046922961861, 16.181005882720143, 16.009869063893944, 16.566970611495577, 15.316641628742218, 14.93466503918171, 15.108222365379333, 6.241429018477589, 6.751286479334027, 6.516887488464505, 22.336496102934078, 22.002251630028084, 21.44349220891793, 19.909779017170266, 20.347306204338864, 20.597301262741283, 23.636026822030544, 23.506647750735283, 23.498569533228874, -99.39800142248473, -98.06834446204206, -103.46989913781485, 10.424508114655808, 10.58568738152583, 10.362925266226128, 27.592563457787037, 28.113670885562897, 27.790073469281197, 25.31252861519654, 25.17293271174033, 25.17291438331206, 25.961569766203553, 26.37139454918602, 26.228197845319897, 8.616376727819443, 9.095532692968845, 9.36851742118597, 29.51769320418437, 29.80268765132253, 29.710185631488756, 5.987120784819126, 6.286567460745573, 6.47057456150651, 5.402351299921662, 5.337561106930167, 5.526870702082903, 12.953926493724182, 12.701016460855797, 12.726311554511383, 22.643891786535576, 22.67953122903903, 23.16599362933387, -91.11132357517879, -77.01586421827476, -77.12030258278052, 22.821921591957405, 21.557035108407334, 22.949822821964815, 36.233070010940224, 36.585473905007035, 37.03278629590446, 30.16193129618962, 30.754461516936615, 30.50211802621682, 18.787325279166296, 18.774321762224034, 18.865039365676537, 26.823529628415898, 26.541468565662697, 27.04957861391206, 25.440188882251576, 25.401015275468424, 25.14989686508973, 29.54300155490637, 29.704003237187862, 29.46736627817154, 2.574506019552544, 2.4035911535223278, 2.357561839123562, 19.950962762037904, 20.08330466846624, 20.196931950437516, 16.14998986098604, 15.64175124714771, 15.604050228993088, 28.318916480988264, 28.088738821446896, 28.126299507915974, 23.781328916549683, 24.12614856660366, 23.86888549476862, 22.26753263679953, 21.859129341940076, 21.837235028545052, 24.382392019033432, 24.687796703510685, 24.041390046477318, 22.643909617016703, 22.348792138199002, 22.564114438990742, 23.026863527484238, 22.74557825177908, 22.946891961619258, 13.463446383674935, 12.701583762963608, 14.133853053053215, 30.795094245035813, 30.477430092791707, 30.43528215835491, 20.36723399767652, 19.935324043035507, 20.186694283038378, 33.024338031808526, 33.36797648544112, 32.48839720586935, 26.354631550610065, 26.63032579421997, 26.763976409099996, 26.61536108950773, 26.575924197832734, 26.577389950553567, 27.027165884772927, 27.11295824001232, 27.188883530596883, 27.482559487223625, 28.02608058974147, 27.92819182574749, 21.634197859093547, 21.540744677186012, 21.71320824767463, 17.425038911402225, 17.452767103910446, 17.760846823453903, 9.186634868383408, 9.65524734929204, 9.252804704010487, 11.245216593146324, 11.954597207717597, 11.681753933429718, 10.598821010595799, 9.905121649305016, 10.389038703093917, -10.811540835847467, -11.421485503514617, -10.662109476824611, 21.34184892599781, 20.6069000562032, 21.077599724133805, 20.91847236454487, 20.636163011193275, 20.45439238846302, 20.08317843079567, 21.32274767383933, 20.905557721853256, 21.6915342186888, 21.784506419052676, 21.926747538226962, 21.643241085112095, 21.308246962726116, 21.62853619083762, 20.597581497083098, 19.913115079204232, 20.58147149781385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15299363123918341, "mean_inference_ms": 0.7016492563273014, "mean_action_processing_ms": 0.0999489008589837, "mean_env_wait_ms": 0.8057079866970973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1419912, "timesteps_this_iter": 0, "agent_timesteps_total": 4259736, "timers": {"sample_time_ms": 19380.071, "sample_throughput": 495.045, "load_time_ms": 0.299, "load_throughput": 32043440.497, "learn_time_ms": 2984.707, "learn_throughput": 3214.385, "update_time_ms": 8.303}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 13.195544362068176, "policy_loss": 0.00036599237866319356, "vf_loss": 13.359827995300293, "vf_explained_var": -0.33899860084056854, "kl": 0.006662764353897755, "entropy": 16.464930057525635, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1419912, "num_agent_steps_sampled": 4259736, "num_steps_trained": 1419912, "num_agent_steps_trained": 4259736, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5532, "training_iteration": 148, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-32-55", "timestamp": 1706193175, "time_this_iter_s": 19.35599946975708, "time_total_s": 2973.0854811668396, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B811F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2973.0854811668396, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 9.092857142857143, "ram_util_percent": 51.25714285714286}}
{"episode_reward_max": 109.85133021185172, "episode_reward_min": -575.1855376511812, "episode_reward_mean": 37.32163841228451, "episode_len_mean": 293.63, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -201.46808572610223}, "policy_reward_max": {"shared_policy": 37.03278629590446}, "policy_reward_mean": {"shared_policy": 12.440546137428166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.10423044022171, 86.87230411358175, 72.88241337426005, 69.13950456306338, -284.9470367580652, 55.05024403671267, 74.2537109926343, 28.39961602119726, 77.93989930488166, 40.61592477932571, 78.89256054535508, 48.54041043110189, 48.757845558109665, 45.35952903330326, 19.50960298627612, 65.78223994188009, 60.85438648425041, 70.6412441059947, -300.9362450223416, 31.373120762407765, 83.49630781263113, 75.65837571024893, 78.56116216070947, 27.08042684197426, 89.03056648699565, 18.74426280707121, 16.26678310893473, 38.38125450909136, 68.48941664490847, -245.24749037623405, 67.32877952232955, 109.85133021185172, 91.41851083934306, 56.42668640706687, 80.41457680799066, 75.99110102280973, 88.71437107026577, 7.335659012198434, 60.23119938094166, 47.39579133712684, 84.53395481035113, 71.77636297792196, 65.96389700728466, 73.11157876902143, 67.55681619420645, 68.71933374088258, 40.29888319969176, 91.70780649618243, 60.48925232375041, 98.88071172311899, 79.74893375393003, 79.76867523789403, 81.32900765538213, 83.43683190271258, 64.88815078395419, 52.638652838766575, 28.094686921685934, 34.88156773429364, 30.892981362994732, -32.895135816186695, 63.026348706334815, 62.009027764201164, 62.31148382648826, 65.40278817596844, 64.58002423867583, 61.09216807410118, 51.7698476780206, 55.00793426297602, 75.12638168223202, 34.90607032924889, 73.93648632615803, 79.19945618882772, 80.87342643924057, 54.37634364515543, 36.19371603103352, -575.1855376511812, 62.98660109983756, 65.0434234701097, 61.05553792417048, 25.4126637065783, 77.03045073524116, 84.2223143331498, 75.8900013640523, -265.96991983335465, 48.51215532864444, 65.20974214561282, 42.00698119401929, 74.74687687086404, 78.28136805258688, 68.51940335519609, 61.62757484824394, 64.42632371187207, 43.79878296516836, 54.91893525421618, 75.55677259527144, 60.990425836294875, 59.30702894000568, -304.90032760053873, 76.11285716295242, 41.27437542052938], "episode_lengths": [300, 300, 300, 300, 145, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 37, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 239, 300, 300, 300, 300, 300, 300, 300, 189, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 262, 300, 300], "policy_shared_policy_reward": [13.92117742200692, 13.259742965300873, 13.92331005291392, 28.989676073814422, 28.922825096795947, 28.95980294297138, 24.11839461078246, 24.359327127536133, 24.40469163594146, 23.099837731570005, 22.955176793038845, 23.084490038454533, -103.7859377861023, -90.54370833933353, -90.6173906326294, 17.772150476773575, 18.857976370452278, 18.420117189486817, 25.00282473862171, 24.282906726002693, 24.96797952800989, 9.558250258366257, 8.791063527266175, 10.050302235564828, 25.857435363034398, 26.00503199795881, 26.077431943888456, 13.240265329678849, 13.559898739059761, 13.8157607105871, 25.91836452484131, 26.481969356536865, 26.492226663976908, 15.956921050945908, 16.85344245719412, 15.730046922961861, 16.181005882720143, 16.009869063893944, 16.566970611495577, 15.316641628742218, 14.93466503918171, 15.108222365379333, 6.241429018477589, 6.751286479334027, 6.516887488464505, 22.336496102934078, 22.002251630028084, 21.44349220891793, 19.909779017170266, 20.347306204338864, 20.597301262741283, 23.636026822030544, 23.506647750735283, 23.498569533228874, -99.39800142248473, -98.06834446204206, -103.46989913781485, 10.424508114655808, 10.58568738152583, 10.362925266226128, 27.592563457787037, 28.113670885562897, 27.790073469281197, 25.31252861519654, 25.17293271174033, 25.17291438331206, 25.961569766203553, 26.37139454918602, 26.228197845319897, 8.616376727819443, 9.095532692968845, 9.36851742118597, 29.51769320418437, 29.80268765132253, 29.710185631488756, 5.987120784819126, 6.286567460745573, 6.47057456150651, 5.402351299921662, 5.337561106930167, 5.526870702082903, 12.953926493724182, 12.701016460855797, 12.726311554511383, 22.643891786535576, 22.67953122903903, 23.16599362933387, -91.11132357517879, -77.01586421827476, -77.12030258278052, 22.821921591957405, 21.557035108407334, 22.949822821964815, 36.233070010940224, 36.585473905007035, 37.03278629590446, 30.16193129618962, 30.754461516936615, 30.50211802621682, 18.787325279166296, 18.774321762224034, 18.865039365676537, 26.823529628415898, 26.541468565662697, 27.04957861391206, 25.440188882251576, 25.401015275468424, 25.14989686508973, 29.54300155490637, 29.704003237187862, 29.46736627817154, 2.574506019552544, 2.4035911535223278, 2.357561839123562, 19.950962762037904, 20.08330466846624, 20.196931950437516, 16.14998986098604, 15.64175124714771, 15.604050228993088, 28.318916480988264, 28.088738821446896, 28.126299507915974, 23.781328916549683, 24.12614856660366, 23.86888549476862, 22.26753263679953, 21.859129341940076, 21.837235028545052, 24.382392019033432, 24.687796703510685, 24.041390046477318, 22.643909617016703, 22.348792138199002, 22.564114438990742, 23.026863527484238, 22.74557825177908, 22.946891961619258, 13.463446383674935, 12.701583762963608, 14.133853053053215, 30.795094245035813, 30.477430092791707, 30.43528215835491, 20.36723399767652, 19.935324043035507, 20.186694283038378, 33.024338031808526, 33.36797648544112, 32.48839720586935, 26.354631550610065, 26.63032579421997, 26.763976409099996, 26.61536108950773, 26.575924197832734, 26.577389950553567, 27.027165884772927, 27.11295824001232, 27.188883530596883, 27.482559487223625, 28.02608058974147, 27.92819182574749, 21.634197859093547, 21.540744677186012, 21.71320824767463, 17.425038911402225, 17.452767103910446, 17.760846823453903, 9.186634868383408, 9.65524734929204, 9.252804704010487, 11.245216593146324, 11.954597207717597, 11.681753933429718, 10.598821010595799, 9.905121649305016, 10.389038703093917, -10.811540835847467, -11.421485503514617, -10.662109476824611, 21.34184892599781, 20.6069000562032, 21.077599724133805, 20.91847236454487, 20.636163011193275, 20.45439238846302, 20.08317843079567, 21.32274767383933, 20.905557721853256, 21.6915342186888, 21.784506419052676, 21.926747538226962, 21.643241085112095, 21.308246962726116, 21.62853619083762, 20.597581497083098, 19.913115079204232, 20.58147149781385, 17.385337891057134, 17.087385401129723, 17.29712438583374, 18.337241938958556, 18.561560955519468, 18.109131368497998, 24.71273785084486, 25.218206947669387, 25.195436883717775, 11.432015170653656, 11.815930513044194, 11.658124645551041, 24.492613216241196, 25.146889490385846, 24.29698361953099, 26.574727615962416, 26.477212014297635, 26.147516558567673, 26.687224969267845, 26.87936381995678, 27.30683765001595, 18.19751264154911, 17.980091735720634, 18.198739267885685, 11.306792328755051, 12.427846373679728, 12.459077328598738, -201.46808572610223, -186.81838259597623, -186.89906932910287, 20.943514065196112, 21.009356466432408, 21.033730568209037, 21.844703380018473, 21.57714992016554, 21.62157016992569, 20.599194211264447, 20.057584424813584, 20.39875928809245, 8.58398136713852, 8.380838563044861, 8.447843776394919, 25.38464181621869, 25.76400891443093, 25.88180000459154, 27.59962386886278, 28.638474554050987, 27.98421591023603, 25.54385108500719, 25.25363975763321, 25.092510521411896, -97.82318888107936, -84.34964569161336, -83.79708526066194, 15.825416035950184, 16.412274631438777, 16.27446466125548, 21.599921492238835, 22.00728009579082, 21.60254055758317, 14.31464649985233, 13.336799482504517, 14.355535211662442, 24.625812316934258, 24.572013686100632, 25.549050867829152, 26.292679489279777, 26.14671595642963, 25.841972606877476, 22.950517025465757, 23.00568618128696, 22.56320014844337, 20.141398111979157, 20.77192109815465, 20.71425563811013, 21.360711286465317, 21.496468799809605, 21.56914362559715, 14.536205269396305, 14.75962652824819, 14.502951167523861, 17.964834754665688, 18.5507418376704, 18.40335866188009, 24.6424825588862, 25.33207521835962, 25.58221481802562, 19.71467839678128, 20.61128581066926, 20.664461628844336, 19.433297780652836, 19.984136297736157, 19.889594861616686, -105.50276265045008, -104.57633547981581, -94.82122947027287, 25.530145801603794, 25.373259484767914, 25.209451876580715, 13.790609692533806, 13.944250175574169, 13.539515552421406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292867198118987, "mean_inference_ms": 0.7013192043912306, "mean_action_processing_ms": 0.09990820272899262, "mean_env_wait_ms": 0.8053909163697361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1429506, "timesteps_this_iter": 0, "agent_timesteps_total": 4288518, "timers": {"sample_time_ms": 19322.792, "sample_throughput": 496.512, "load_time_ms": 0.299, "load_throughput": 32043440.497, "learn_time_ms": 2976.663, "learn_throughput": 3223.072, "update_time_ms": 8.109}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 276.7909965515137, "policy_loss": -0.0004410322712400383, "vf_loss": 276.95543670654297, "vf_explained_var": 0.19618767499923706, "kl": 0.014104727423037037, "entropy": 16.401675939559937, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1429506, "num_agent_steps_sampled": 4288518, "num_steps_trained": 1429506, "num_agent_steps_trained": 4288518, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5566, "training_iteration": 149, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-33-14", "timestamp": 1706193194, "time_this_iter_s": 19.22546100616455, "time_total_s": 2992.310942173004, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BADD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2992.310942173004, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 8.377777777777778, "ram_util_percent": 51.28518518518518}}
{"episode_reward_max": 98.88071172311899, "episode_reward_min": -575.1855376511812, "episode_reward_mean": 43.05072715337606, "episode_len_mean": 295.83, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -201.46808572610223}, "policy_reward_max": {"shared_policy": 33.36797648544112}, "policy_reward_mean": {"shared_policy": 14.350242384458681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.42668640706687, 80.41457680799066, 75.99110102280973, 88.71437107026577, 7.335659012198434, 60.23119938094166, 47.39579133712684, 84.53395481035113, 71.77636297792196, 65.96389700728466, 73.11157876902143, 67.55681619420645, 68.71933374088258, 40.29888319969176, 91.70780649618243, 60.48925232375041, 98.88071172311899, 79.74893375393003, 79.76867523789403, 81.32900765538213, 83.43683190271258, 64.88815078395419, 52.638652838766575, 28.094686921685934, 34.88156773429364, 30.892981362994732, -32.895135816186695, 63.026348706334815, 62.009027764201164, 62.31148382648826, 65.40278817596844, 64.58002423867583, 61.09216807410118, 51.7698476780206, 55.00793426297602, 75.12638168223202, 34.90607032924889, 73.93648632615803, 79.19945618882772, 80.87342643924057, 54.37634364515543, 36.19371603103352, -575.1855376511812, 62.98660109983756, 65.0434234701097, 61.05553792417048, 25.4126637065783, 77.03045073524116, 84.2223143331498, 75.8900013640523, -265.96991983335465, 48.51215532864444, 65.20974214561282, 42.00698119401929, 74.74687687086404, 78.28136805258688, 68.51940335519609, 61.62757484824394, 64.42632371187207, 43.79878296516836, 54.91893525421618, 75.55677259527144, 60.990425836294875, 59.30702894000568, -304.90032760053873, 76.11285716295242, 41.27437542052938, 59.59756677784023, 74.77180645056069, 84.32104230485854, 37.13378530275074, 93.56159176770598, 54.086853050626814, 72.30157191865145, 3.983266942203045, 91.45018416829406, 60.496825203299494, 35.961268979124725, 59.729379598051295, 9.4230199884623, 22.263556048274012, 33.67923302575943, 75.37593211978674, 84.98619378171861, 71.50778891472143, 52.50976933538914, 53.66521725058553, 88.55376716330647, 33.14489301037973, -285.97392708808184, 51.16984033584593, 68.95045743789524, 55.67920310795306, 45.165820169262574, 78.80842050909996, 52.64265464060007, 12.389426037669168, 66.33822666108605, 57.324115689843865, 67.05531547963618], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 239, 300, 300, 300, 300, 300, 300, 300, 189, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 262, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 93, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.787325279166296, 18.774321762224034, 18.865039365676537, 26.823529628415898, 26.541468565662697, 27.04957861391206, 25.440188882251576, 25.401015275468424, 25.14989686508973, 29.54300155490637, 29.704003237187862, 29.46736627817154, 2.574506019552544, 2.4035911535223278, 2.357561839123562, 19.950962762037904, 20.08330466846624, 20.196931950437516, 16.14998986098604, 15.64175124714771, 15.604050228993088, 28.318916480988264, 28.088738821446896, 28.126299507915974, 23.781328916549683, 24.12614856660366, 23.86888549476862, 22.26753263679953, 21.859129341940076, 21.837235028545052, 24.382392019033432, 24.687796703510685, 24.041390046477318, 22.643909617016703, 22.348792138199002, 22.564114438990742, 23.026863527484238, 22.74557825177908, 22.946891961619258, 13.463446383674935, 12.701583762963608, 14.133853053053215, 30.795094245035813, 30.477430092791707, 30.43528215835491, 20.36723399767652, 19.935324043035507, 20.186694283038378, 33.024338031808526, 33.36797648544112, 32.48839720586935, 26.354631550610065, 26.63032579421997, 26.763976409099996, 26.61536108950773, 26.575924197832734, 26.577389950553567, 27.027165884772927, 27.11295824001232, 27.188883530596883, 27.482559487223625, 28.02608058974147, 27.92819182574749, 21.634197859093547, 21.540744677186012, 21.71320824767463, 17.425038911402225, 17.452767103910446, 17.760846823453903, 9.186634868383408, 9.65524734929204, 9.252804704010487, 11.245216593146324, 11.954597207717597, 11.681753933429718, 10.598821010595799, 9.905121649305016, 10.389038703093917, -10.811540835847467, -11.421485503514617, -10.662109476824611, 21.34184892599781, 20.6069000562032, 21.077599724133805, 20.91847236454487, 20.636163011193275, 20.45439238846302, 20.08317843079567, 21.32274767383933, 20.905557721853256, 21.6915342186888, 21.784506419052676, 21.926747538226962, 21.643241085112095, 21.308246962726116, 21.62853619083762, 20.597581497083098, 19.913115079204232, 20.58147149781385, 17.385337891057134, 17.087385401129723, 17.29712438583374, 18.337241938958556, 18.561560955519468, 18.109131368497998, 24.71273785084486, 25.218206947669387, 25.195436883717775, 11.432015170653656, 11.815930513044194, 11.658124645551041, 24.492613216241196, 25.146889490385846, 24.29698361953099, 26.574727615962416, 26.477212014297635, 26.147516558567673, 26.687224969267845, 26.87936381995678, 27.30683765001595, 18.19751264154911, 17.980091735720634, 18.198739267885685, 11.306792328755051, 12.427846373679728, 12.459077328598738, -201.46808572610223, -186.81838259597623, -186.89906932910287, 20.943514065196112, 21.009356466432408, 21.033730568209037, 21.844703380018473, 21.57714992016554, 21.62157016992569, 20.599194211264447, 20.057584424813584, 20.39875928809245, 8.58398136713852, 8.380838563044861, 8.447843776394919, 25.38464181621869, 25.76400891443093, 25.88180000459154, 27.59962386886278, 28.638474554050987, 27.98421591023603, 25.54385108500719, 25.25363975763321, 25.092510521411896, -97.82318888107936, -84.34964569161336, -83.79708526066194, 15.825416035950184, 16.412274631438777, 16.27446466125548, 21.599921492238835, 22.00728009579082, 21.60254055758317, 14.31464649985233, 13.336799482504517, 14.355535211662442, 24.625812316934258, 24.572013686100632, 25.549050867829152, 26.292679489279777, 26.14671595642963, 25.841972606877476, 22.950517025465757, 23.00568618128696, 22.56320014844337, 20.141398111979157, 20.77192109815465, 20.71425563811013, 21.360711286465317, 21.496468799809605, 21.56914362559715, 14.536205269396305, 14.75962652824819, 14.502951167523861, 17.964834754665688, 18.5507418376704, 18.40335866188009, 24.6424825588862, 25.33207521835962, 25.58221481802562, 19.71467839678128, 20.61128581066926, 20.664461628844336, 19.433297780652836, 19.984136297736157, 19.889594861616686, -105.50276265045008, -104.57633547981581, -94.82122947027287, 25.530145801603794, 25.373259484767914, 25.209451876580715, 13.790609692533806, 13.944250175574169, 13.539515552421406, 19.71810784439245, 19.90706146011749, 19.97239747333029, 25.131187545135617, 25.03117373585701, 24.609445169568062, 28.12889980028072, 27.89693089077869, 28.295211613799125, 12.492295184793562, 12.22724441687265, 12.414245701084525, 30.711586952209473, 31.729994990862906, 31.1200098246336, 18.149583784863353, 17.718399807810783, 18.218869457952678, 24.275633025293544, 24.252529715498284, 23.77340917785962, 1.6598849222064018, 0.6794241666793823, 1.6439578533172607, 30.58794707184036, 30.52717433435221, 30.335062762101487, 20.30996151889363, 20.31391684586802, 19.872946838537842, 11.500604957342148, 12.404430675320327, 12.05623334646225, 19.756665160258606, 19.80871122827132, 20.16400320952137, 3.1180070588985984, 3.34240732404092, 2.962605605522782, 7.467358230302722, 7.261669884125382, 7.534527933845908, 10.43787161509195, 11.661025664458663, 11.580335746208817, 25.02789154648781, 25.15201073139906, 25.196029841899872, 28.89804499410093, 27.73069429397583, 28.357454493641853, 24.168365297994256, 23.834658200542123, 23.50476541618505, 17.50957255065441, 17.605650525540113, 17.394546259194613, 18.282143192986638, 17.015281448761613, 18.367792608837277, 29.388333588838577, 29.88887069001794, 29.27656288444996, 11.193670952071741, 11.323773494533569, 10.627448563774422, -93.18236937373877, -93.3613063544035, -99.43025135993958, 17.2108656403919, 16.681938921411827, 17.277035774042204, 23.133469610475004, 23.041439168155193, 22.77554865926504, 18.503156845768288, 18.35766190787156, 18.81838435431321, 15.177531130922333, 15.02411565308769, 14.96417338525255, 25.51376473903656, 26.51919198036194, 26.775463789701462, 17.869832833607987, 17.98175779295464, 16.791064014037445, 4.197552983959511, 4.478404407699898, 3.7134686460097583, 22.172901871303708, 22.265732603768498, 21.899592186013848, 19.303558624039084, 19.030122483770043, 18.990434582034737, 20.189814825852707, 23.57987731446822, 23.28562333931525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288353311018724, "mean_inference_ms": 0.701163662473063, "mean_action_processing_ms": 0.09991164541760299, "mean_env_wait_ms": 0.8052692305386063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1439100, "timesteps_this_iter": 0, "agent_timesteps_total": 4317300, "timers": {"sample_time_ms": 19326.049, "sample_throughput": 496.428, "load_time_ms": 0.299, "load_throughput": 32043440.497, "learn_time_ms": 3005.682, "learn_throughput": 3191.954, "update_time_ms": 8.509}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 57.52122402191162, "policy_loss": -0.0006289455673174071, "vf_loss": 57.68491315841675, "vf_explained_var": 0.003003329038619995, "kl": 0.005059655799629482, "entropy": 16.306045532226562, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1439100, "num_agent_steps_sampled": 4317300, "num_steps_trained": 1439100, "num_agent_steps_trained": 4317300, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 83.24706286285071, "episode_reward_min": -259.88772250153124, "episode_reward_mean": 21.21525747287086, "episode_len_mean": 298.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -96.0153706073761}, "policy_reward_max": {"shared_policy": 28.488075854567185}, "policy_reward_mean": {"shared_policy": 7.071752490956952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.86888305470346, 83.24706286285071, 18.92168258503078, 47.6467755809426, 64.13926196098325, 71.67944033257663, 45.77135971747339, 66.6487849233672, 21.11704621231182, -259.88772250153124], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 280], "policy_shared_policy_reward": [17.619079762448862, 17.52649312963088, 17.72331016262372, 26.328667928775147, 28.43031907950838, 28.488075854567185, 6.082508226235703, 6.530220729609326, 6.308953629185751, 15.752595576147229, 15.9410652766625, 15.953114728132874, 21.140118579069764, 21.099326128760964, 21.89981725315252, 23.970725193619728, 24.39876070432365, 23.309954434633255, 15.150161758065224, 15.361288161948323, 15.25990979745984, 22.556347685866058, 21.913521319627762, 22.178915917873383, 7.250948521153376, 7.101643172403172, 6.764454518755272, -96.0153706073761, -81.828733606264, -82.04361828789115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14210009974352067, "mean_inference_ms": 0.7319243807351615, "mean_action_processing_ms": 0.09853434393048588, "mean_env_wait_ms": 0.8016175186248283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 5599, "training_iteration": 150, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-33-39", "timestamp": 1706193219, "time_this_iter_s": 24.842117309570312, "time_total_s": 3017.1530594825745, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017903A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3017.1530594825745, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 6.817142857142857, "ram_util_percent": 51.72857142857142}}
{"episode_reward_max": 93.56159176770598, "episode_reward_min": -575.1855376511812, "episode_reward_mean": 25.95784499807995, "episode_len_mean": 292.88, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -201.46808572610223}, "policy_reward_max": {"shared_policy": 31.729994990862906}, "policy_reward_mean": {"shared_policy": 8.652614999359981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.7698476780206, 55.00793426297602, 75.12638168223202, 34.90607032924889, 73.93648632615803, 79.19945618882772, 80.87342643924057, 54.37634364515543, 36.19371603103352, -575.1855376511812, 62.98660109983756, 65.0434234701097, 61.05553792417048, 25.4126637065783, 77.03045073524116, 84.2223143331498, 75.8900013640523, -265.96991983335465, 48.51215532864444, 65.20974214561282, 42.00698119401929, 74.74687687086404, 78.28136805258688, 68.51940335519609, 61.62757484824394, 64.42632371187207, 43.79878296516836, 54.91893525421618, 75.55677259527144, 60.990425836294875, 59.30702894000568, -304.90032760053873, 76.11285716295242, 41.27437542052938, 59.59756677784023, 74.77180645056069, 84.32104230485854, 37.13378530275074, 93.56159176770598, 54.086853050626814, 72.30157191865145, 3.983266942203045, 91.45018416829406, 60.496825203299494, 35.961268979124725, 59.729379598051295, 9.4230199884623, 22.263556048274012, 33.67923302575943, 75.37593211978674, 84.98619378171861, 71.50778891472143, 52.50976933538914, 53.66521725058553, 88.55376716330647, 33.14489301037973, -285.97392708808184, 51.16984033584593, 68.95045743789524, 55.67920310795306, 45.165820169262574, 78.80842050909996, 52.64265464060007, 12.389426037669168, 66.33822666108605, 57.324115689843865, 67.05531547963618, -257.9354420788586, 31.098594004521118, 20.131270362064228, 76.11705041676757, 57.36539814062414, 51.494997300207615, 44.512138057500096, -271.46079171076417, -297.4409663230181, 27.751025643199668, 36.39749097824097, 50.43764239177108, 11.222080552019165, 59.27140041720121, 61.259477045387015, 60.5838787406683, 69.9953976292163, 52.88863906264304, 21.64787068963051, 56.50533072184771, 44.32639906927943, 36.53816370479761, -258.5942988321185, 44.374783679842935, 30.305088639259324, 76.18239226192235, -0.2556268386542797, 71.4480509571731, 55.91386946197599, 70.90498488768932, 48.31724826060234, 58.68542123585938, 71.47700138390061], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 239, 300, 300, 300, 300, 300, 300, 300, 189, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 262, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 93, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 220, 300, 300, 300, 300, 300, 300, 174, 220, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.385337891057134, 17.087385401129723, 17.29712438583374, 18.337241938958556, 18.561560955519468, 18.109131368497998, 24.71273785084486, 25.218206947669387, 25.195436883717775, 11.432015170653656, 11.815930513044194, 11.658124645551041, 24.492613216241196, 25.146889490385846, 24.29698361953099, 26.574727615962416, 26.477212014297635, 26.147516558567673, 26.687224969267845, 26.87936381995678, 27.30683765001595, 18.19751264154911, 17.980091735720634, 18.198739267885685, 11.306792328755051, 12.427846373679728, 12.459077328598738, -201.46808572610223, -186.81838259597623, -186.89906932910287, 20.943514065196112, 21.009356466432408, 21.033730568209037, 21.844703380018473, 21.57714992016554, 21.62157016992569, 20.599194211264447, 20.057584424813584, 20.39875928809245, 8.58398136713852, 8.380838563044861, 8.447843776394919, 25.38464181621869, 25.76400891443093, 25.88180000459154, 27.59962386886278, 28.638474554050987, 27.98421591023603, 25.54385108500719, 25.25363975763321, 25.092510521411896, -97.82318888107936, -84.34964569161336, -83.79708526066194, 15.825416035950184, 16.412274631438777, 16.27446466125548, 21.599921492238835, 22.00728009579082, 21.60254055758317, 14.31464649985233, 13.336799482504517, 14.355535211662442, 24.625812316934258, 24.572013686100632, 25.549050867829152, 26.292679489279777, 26.14671595642963, 25.841972606877476, 22.950517025465757, 23.00568618128696, 22.56320014844337, 20.141398111979157, 20.77192109815465, 20.71425563811013, 21.360711286465317, 21.496468799809605, 21.56914362559715, 14.536205269396305, 14.75962652824819, 14.502951167523861, 17.964834754665688, 18.5507418376704, 18.40335866188009, 24.6424825588862, 25.33207521835962, 25.58221481802562, 19.71467839678128, 20.61128581066926, 20.664461628844336, 19.433297780652836, 19.984136297736157, 19.889594861616686, -105.50276265045008, -104.57633547981581, -94.82122947027287, 25.530145801603794, 25.373259484767914, 25.209451876580715, 13.790609692533806, 13.944250175574169, 13.539515552421406, 19.71810784439245, 19.90706146011749, 19.97239747333029, 25.131187545135617, 25.03117373585701, 24.609445169568062, 28.12889980028072, 27.89693089077869, 28.295211613799125, 12.492295184793562, 12.22724441687265, 12.414245701084525, 30.711586952209473, 31.729994990862906, 31.1200098246336, 18.149583784863353, 17.718399807810783, 18.218869457952678, 24.275633025293544, 24.252529715498284, 23.77340917785962, 1.6598849222064018, 0.6794241666793823, 1.6439578533172607, 30.58794707184036, 30.52717433435221, 30.335062762101487, 20.30996151889363, 20.31391684586802, 19.872946838537842, 11.500604957342148, 12.404430675320327, 12.05623334646225, 19.756665160258606, 19.80871122827132, 20.16400320952137, 3.1180070588985984, 3.34240732404092, 2.962605605522782, 7.467358230302722, 7.261669884125382, 7.534527933845908, 10.43787161509195, 11.661025664458663, 11.580335746208817, 25.02789154648781, 25.15201073139906, 25.196029841899872, 28.89804499410093, 27.73069429397583, 28.357454493641853, 24.168365297994256, 23.834658200542123, 23.50476541618505, 17.50957255065441, 17.605650525540113, 17.394546259194613, 18.282143192986638, 17.015281448761613, 18.367792608837277, 29.388333588838577, 29.88887069001794, 29.27656288444996, 11.193670952071741, 11.323773494533569, 10.627448563774422, -93.18236937373877, -93.3613063544035, -99.43025135993958, 17.2108656403919, 16.681938921411827, 17.277035774042204, 23.133469610475004, 23.041439168155193, 22.77554865926504, 18.503156845768288, 18.35766190787156, 18.81838435431321, 15.177531130922333, 15.02411565308769, 14.96417338525255, 25.51376473903656, 26.51919198036194, 26.775463789701462, 17.869832833607987, 17.98175779295464, 16.791064014037445, 4.197552983959511, 4.478404407699898, 3.7134686460097583, 22.172901871303708, 22.265732603768498, 21.899592186013848, 19.303558624039084, 19.030122483770043, 18.990434582034737, 20.189814825852707, 23.57987731446822, 23.28562333931525, -94.53496740261714, -81.31858962650101, -82.08188504974048, 10.240856068829686, 10.586298909892008, 10.271439025799424, 6.511284252007798, 6.574440849324063, 7.045545260732368, 25.60452115784088, 25.4273884097735, 25.08514084915319, 19.115043230975658, 19.139204104120523, 19.111150805527956, 17.22861921042204, 16.732261791825294, 17.53411629796028, 14.970802723119647, 14.91706948975721, 14.624265844623238, -97.8263481259346, -86.70531668886542, -86.92912689596415, -103.34699423114459, -102.48891309897105, -91.60505899290244, 8.839928691585854, 9.552523714800671, 9.358573236813143, 12.403691247105598, 11.761012211441994, 12.232787519693375, 16.99327712878585, 17.07236036658287, 16.37200489640236, 3.7104572405417713, 3.637540084620312, 3.8740832268570813, 19.94675294340898, 19.679155622919396, 19.64549185087283, 20.526504789789513, 20.39430174355705, 20.33867051204045, 19.524067908525467, 20.54402881115675, 20.51578202098608, 23.656576878701642, 23.11274479826291, 23.226075952251747, 17.629677043606833, 17.513398831089333, 17.74556318794687, 7.314521875232458, 7.250322867184877, 7.083025947213173, 19.357694680802524, 18.378910198807716, 18.768725842237473, 14.477151200175285, 14.891044083982706, 14.95820378512144, 12.697001199548438, 11.628993113835648, 12.212169391413525, -96.7541332244873, -81.00965716689825, -80.83050844073296, 15.377167155345276, 14.020098139842347, 14.977518384655312, 10.196931806703404, 10.250572112699345, 9.857584719856575, 25.538081509371594, 25.240708385904625, 25.403602366646126, -0.025732625275850296, -0.037753522396087646, -0.19214069098234177, 23.787387539943055, 24.127071411659315, 23.533592005570725, 18.673426053486764, 18.527348950505257, 18.71309445798397, 23.54802360261479, 23.664882671708853, 23.69207861336568, 15.878877592583493, 16.126898666222885, 16.311472001795963, 19.357400027414158, 19.53258053710063, 19.795440671344593, 23.50003624955812, 24.04477710525194, 23.932188029090554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282946272078118, "mean_inference_ms": 0.7009681225257779, "mean_action_processing_ms": 0.09987703116666527, "mean_env_wait_ms": 0.8050508873940132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1448694, "timesteps_this_iter": 0, "agent_timesteps_total": 4346082, "timers": {"sample_time_ms": 19993.457, "sample_throughput": 479.857, "load_time_ms": 0.299, "load_throughput": 32043440.497, "learn_time_ms": 3025.417, "learn_throughput": 3171.134, "update_time_ms": 8.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 166.20478057861328, "policy_loss": -0.0010140044619881827, "vf_loss": 166.3677921295166, "vf_explained_var": 0.2601018697023392, "kl": 0.006005017829222723, "entropy": 16.199461936950684, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1448694, "num_agent_steps_sampled": 4346082, "num_steps_trained": 1448694, "num_agent_steps_trained": 4346082, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5632, "training_iteration": 151, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-33-59", "timestamp": 1706193239, "time_this_iter_s": 20.315482139587402, "time_total_s": 3037.468541622162, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BADC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3037.468541622162, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 9.344827586206899, "ram_util_percent": 52.35517241379309}}
{"episode_reward_max": 104.38175895810126, "episode_reward_min": -297.4409663230181, "episode_reward_mean": 30.115077308345928, "episode_len_mean": 291.97, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -109.6789935429891}, "policy_reward_max": {"shared_policy": 34.86787756470342}, "policy_reward_mean": {"shared_policy": 10.038359102781973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.27437542052938, 59.59756677784023, 74.77180645056069, 84.32104230485854, 37.13378530275074, 93.56159176770598, 54.086853050626814, 72.30157191865145, 3.983266942203045, 91.45018416829406, 60.496825203299494, 35.961268979124725, 59.729379598051295, 9.4230199884623, 22.263556048274012, 33.67923302575943, 75.37593211978674, 84.98619378171861, 71.50778891472143, 52.50976933538914, 53.66521725058553, 88.55376716330647, 33.14489301037973, -285.97392708808184, 51.16984033584593, 68.95045743789524, 55.67920310795306, 45.165820169262574, 78.80842050909996, 52.64265464060007, 12.389426037669168, 66.33822666108605, 57.324115689843865, 67.05531547963618, -257.9354420788586, 31.098594004521118, 20.131270362064228, 76.11705041676757, 57.36539814062414, 51.494997300207615, 44.512138057500096, -271.46079171076417, -297.4409663230181, 27.751025643199668, 36.39749097824097, 50.43764239177108, 11.222080552019165, 59.27140041720121, 61.259477045387015, 60.5838787406683, 69.9953976292163, 52.88863906264304, 21.64787068963051, 56.50533072184771, 44.32639906927943, 36.53816370479761, -258.5942988321185, 44.374783679842935, 30.305088639259324, 76.18239226192235, -0.2556268386542797, 71.4480509571731, 55.91386946197599, 70.90498488768932, 48.31724826060234, 58.68542123585938, 71.47700138390061, 59.77725472301242, 76.44047633232547, 51.25160791911182, 62.082652132958174, 75.47801810689269, -278.0942725650966, 66.71245852205902, 66.5381973357871, 51.3917797990143, 104.38175895810126, 33.93249478185314, 83.99634335562587, 49.08294903393832, -20.048260565847187, 25.709338447777526, 78.45197339355943, 58.492768675088854, -295.9190572835505, 36.259207006543875, 18.929796136450022, 47.98358650272712, 71.0022621480748, 57.18118349090217, 68.51408066414294, 80.7584196459502, 40.97483681887388, 68.91741967946291, 45.9816911369562, 51.1068720296025, 53.45779797434804, 8.993043884634943, 94.41641881689429, 42.57823238032867], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 93, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 220, 300, 300, 300, 300, 300, 300, 174, 220, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 180, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.790609692533806, 13.944250175574169, 13.539515552421406, 19.71810784439245, 19.90706146011749, 19.97239747333029, 25.131187545135617, 25.03117373585701, 24.609445169568062, 28.12889980028072, 27.89693089077869, 28.295211613799125, 12.492295184793562, 12.22724441687265, 12.414245701084525, 30.711586952209473, 31.729994990862906, 31.1200098246336, 18.149583784863353, 17.718399807810783, 18.218869457952678, 24.275633025293544, 24.252529715498284, 23.77340917785962, 1.6598849222064018, 0.6794241666793823, 1.6439578533172607, 30.58794707184036, 30.52717433435221, 30.335062762101487, 20.30996151889363, 20.31391684586802, 19.872946838537842, 11.500604957342148, 12.404430675320327, 12.05623334646225, 19.756665160258606, 19.80871122827132, 20.16400320952137, 3.1180070588985984, 3.34240732404092, 2.962605605522782, 7.467358230302722, 7.261669884125382, 7.534527933845908, 10.43787161509195, 11.661025664458663, 11.580335746208817, 25.02789154648781, 25.15201073139906, 25.196029841899872, 28.89804499410093, 27.73069429397583, 28.357454493641853, 24.168365297994256, 23.834658200542123, 23.50476541618505, 17.50957255065441, 17.605650525540113, 17.394546259194613, 18.282143192986638, 17.015281448761613, 18.367792608837277, 29.388333588838577, 29.88887069001794, 29.27656288444996, 11.193670952071741, 11.323773494533569, 10.627448563774422, -93.18236937373877, -93.3613063544035, -99.43025135993958, 17.2108656403919, 16.681938921411827, 17.277035774042204, 23.133469610475004, 23.041439168155193, 22.77554865926504, 18.503156845768288, 18.35766190787156, 18.81838435431321, 15.177531130922333, 15.02411565308769, 14.96417338525255, 25.51376473903656, 26.51919198036194, 26.775463789701462, 17.869832833607987, 17.98175779295464, 16.791064014037445, 4.197552983959511, 4.478404407699898, 3.7134686460097583, 22.172901871303708, 22.265732603768498, 21.899592186013848, 19.303558624039084, 19.030122483770043, 18.990434582034737, 20.189814825852707, 23.57987731446822, 23.28562333931525, -94.53496740261714, -81.31858962650101, -82.08188504974048, 10.240856068829686, 10.586298909892008, 10.271439025799424, 6.511284252007798, 6.574440849324063, 7.045545260732368, 25.60452115784088, 25.4273884097735, 25.08514084915319, 19.115043230975658, 19.139204104120523, 19.111150805527956, 17.22861921042204, 16.732261791825294, 17.53411629796028, 14.970802723119647, 14.91706948975721, 14.624265844623238, -97.8263481259346, -86.70531668886542, -86.92912689596415, -103.34699423114459, -102.48891309897105, -91.60505899290244, 8.839928691585854, 9.552523714800671, 9.358573236813143, 12.403691247105598, 11.761012211441994, 12.232787519693375, 16.99327712878585, 17.07236036658287, 16.37200489640236, 3.7104572405417713, 3.637540084620312, 3.8740832268570813, 19.94675294340898, 19.679155622919396, 19.64549185087283, 20.526504789789513, 20.39430174355705, 20.33867051204045, 19.524067908525467, 20.54402881115675, 20.51578202098608, 23.656576878701642, 23.11274479826291, 23.226075952251747, 17.629677043606833, 17.513398831089333, 17.74556318794687, 7.314521875232458, 7.250322867184877, 7.083025947213173, 19.357694680802524, 18.378910198807716, 18.768725842237473, 14.477151200175285, 14.891044083982706, 14.95820378512144, 12.697001199548438, 11.628993113835648, 12.212169391413525, -96.7541332244873, -81.00965716689825, -80.83050844073296, 15.377167155345276, 14.020098139842347, 14.977518384655312, 10.196931806703404, 10.250572112699345, 9.857584719856575, 25.538081509371594, 25.240708385904625, 25.403602366646126, -0.025732625275850296, -0.037753522396087646, -0.19214069098234177, 23.787387539943055, 24.127071411659315, 23.533592005570725, 18.673426053486764, 18.527348950505257, 18.71309445798397, 23.54802360261479, 23.664882671708853, 23.69207861336568, 15.878877592583493, 16.126898666222885, 16.311472001795963, 19.357400027414158, 19.53258053710063, 19.795440671344593, 23.50003624955812, 24.04477710525194, 23.932188029090554, 19.412659133474023, 20.06900033603111, 20.295595253507287, 25.222766061623886, 25.535406821717814, 25.682303448983774, 16.993924329678208, 16.975137355426938, 17.282546234006674, 20.72492975741625, 20.494581907987595, 20.86314046755433, 25.369500733291105, 25.024812278648213, 25.083705094953373, -100.01535397271316, -89.06391915182273, -89.01499944056074, 22.511843078769743, 22.277009397745132, 21.923606045544147, 22.05037821953495, 22.177362413456038, 22.310456702796117, 16.975710491339356, 17.565962268660456, 16.85010703901449, 34.83190360975762, 34.68197778364022, 34.86787756470342, 11.406256151075155, 11.100492397944123, 11.425746232833859, 28.082339100539684, 28.180864218622446, 27.733140036463737, 16.34457521388927, 16.70851824587831, 16.02985557417074, -6.726516736050456, -6.653619566311448, -6.668124263485282, 8.854704336651281, 8.539642120401055, 8.31499199072519, 26.07879478732744, 26.404317433635384, 25.968861172596604, 19.422295692066342, 19.52631607434401, 19.544156908678502, -109.6789935429891, -93.36804600556692, -92.8720177349945, 12.156655319035053, 12.153201099485159, 11.949350588023663, 6.188090581446886, 6.390169319231063, 6.351536235772073, 16.01387974061072, 15.897372357547283, 16.07233440456912, 23.447039484977722, 23.507378421723843, 24.04784424137324, 19.072510873277977, 18.97412774463494, 19.134544872989252, 22.422022009889275, 22.980953539411217, 23.111105114842445, 26.735608398914337, 27.376341668888927, 26.646469578146935, 13.494838148355484, 13.676132641732693, 13.803866028785706, 22.59957990050316, 23.145643457770348, 23.172196321189404, 15.37671785553296, 15.388041359682873, 15.216931921740368, 16.89212122062841, 17.538548382620007, 16.67620242635408, 17.997060673932225, 17.555545488993317, 17.905191811422497, 3.09258050719896, 2.8625427509347503, 3.037920626501233, 31.583472836762667, 31.37750393897295, 31.455442041158676, 13.759992520014436, 14.339243952805788, 14.478995907508448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15282047190766726, "mean_inference_ms": 0.700945967036843, "mean_action_processing_ms": 0.09988935671643916, "mean_env_wait_ms": 0.8049675718294814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1458288, "timesteps_this_iter": 0, "agent_timesteps_total": 4374864, "timers": {"sample_time_ms": 20092.549, "sample_throughput": 477.49, "load_time_ms": 0.399, "load_throughput": 24018235.989, "learn_time_ms": 3033.621, "learn_throughput": 3162.557, "update_time_ms": 8.608}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 90.09145450592041, "policy_loss": -0.0009942136508118704, "vf_loss": 90.25773906707764, "vf_explained_var": 0.23671117424964905, "kl": 0.00602333832670938, "entropy": 16.529003143310547, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1458288, "num_agent_steps_sampled": 4374864, "num_steps_trained": 1458288, "num_agent_steps_trained": 4374864, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5665, "training_iteration": 152, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-34-19", "timestamp": 1706193259, "time_this_iter_s": 19.86943006515503, "time_total_s": 3057.337971687317, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02059040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3057.337971687317, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 9.807142857142859, "ram_util_percent": 53.203571428571436}}
{"episode_reward_max": 104.38175895810126, "episode_reward_min": -297.4409663230181, "episode_reward_mean": 34.16769400564895, "episode_len_mean": 294.04, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -109.6789935429891}, "policy_reward_max": {"shared_policy": 34.86787756470342}, "policy_reward_mean": {"shared_policy": 11.389231335216312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.33822666108605, 57.324115689843865, 67.05531547963618, -257.9354420788586, 31.098594004521118, 20.131270362064228, 76.11705041676757, 57.36539814062414, 51.494997300207615, 44.512138057500096, -271.46079171076417, -297.4409663230181, 27.751025643199668, 36.39749097824097, 50.43764239177108, 11.222080552019165, 59.27140041720121, 61.259477045387015, 60.5838787406683, 69.9953976292163, 52.88863906264304, 21.64787068963051, 56.50533072184771, 44.32639906927943, 36.53816370479761, -258.5942988321185, 44.374783679842935, 30.305088639259324, 76.18239226192235, -0.2556268386542797, 71.4480509571731, 55.91386946197599, 70.90498488768932, 48.31724826060234, 58.68542123585938, 71.47700138390061, 59.77725472301242, 76.44047633232547, 51.25160791911182, 62.082652132958174, 75.47801810689269, -278.0942725650966, 66.71245852205902, 66.5381973357871, 51.3917797990143, 104.38175895810126, 33.93249478185314, 83.99634335562587, 49.08294903393832, -20.048260565847187, 25.709338447777526, 78.45197339355943, 58.492768675088854, -295.9190572835505, 36.259207006543875, 18.929796136450022, 47.98358650272712, 71.0022621480748, 57.18118349090217, 68.51408066414294, 80.7584196459502, 40.97483681887388, 68.91741967946291, 45.9816911369562, 51.1068720296025, 53.45779797434804, 8.993043884634943, 94.41641881689429, 42.57823238032867, 70.613221809268, 51.77790922299026, 65.4392703581834, 55.40693089738487, 18.153614334762068, 50.35201097279784, 46.17751456610857, 57.49170482112095, 57.34370895475146, 53.332289507612586, 78.67065097391605, 71.89095135033129, 43.586024601012454, 90.02588196843863, 84.08611905202268, 28.374945633695432, 80.21660367026925, 65.32799644395708, 46.10835432261227, 89.30375391244885, 24.8708018735051, 35.68755992874503, 42.38158800825475, 66.0854451358318, 19.664211873896406, 56.94560068845749, 95.40263962745667, 66.02496735006568, 70.28748101741076, 31.853147342801094, 64.98955318331718], "episode_lengths": [300, 300, 300, 220, 300, 300, 300, 300, 300, 300, 174, 220, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 291, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 180, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [22.172901871303708, 22.265732603768498, 21.899592186013848, 19.303558624039084, 19.030122483770043, 18.990434582034737, 20.189814825852707, 23.57987731446822, 23.28562333931525, -94.53496740261714, -81.31858962650101, -82.08188504974048, 10.240856068829686, 10.586298909892008, 10.271439025799424, 6.511284252007798, 6.574440849324063, 7.045545260732368, 25.60452115784088, 25.4273884097735, 25.08514084915319, 19.115043230975658, 19.139204104120523, 19.111150805527956, 17.22861921042204, 16.732261791825294, 17.53411629796028, 14.970802723119647, 14.91706948975721, 14.624265844623238, -97.8263481259346, -86.70531668886542, -86.92912689596415, -103.34699423114459, -102.48891309897105, -91.60505899290244, 8.839928691585854, 9.552523714800671, 9.358573236813143, 12.403691247105598, 11.761012211441994, 12.232787519693375, 16.99327712878585, 17.07236036658287, 16.37200489640236, 3.7104572405417713, 3.637540084620312, 3.8740832268570813, 19.94675294340898, 19.679155622919396, 19.64549185087283, 20.526504789789513, 20.39430174355705, 20.33867051204045, 19.524067908525467, 20.54402881115675, 20.51578202098608, 23.656576878701642, 23.11274479826291, 23.226075952251747, 17.629677043606833, 17.513398831089333, 17.74556318794687, 7.314521875232458, 7.250322867184877, 7.083025947213173, 19.357694680802524, 18.378910198807716, 18.768725842237473, 14.477151200175285, 14.891044083982706, 14.95820378512144, 12.697001199548438, 11.628993113835648, 12.212169391413525, -96.7541332244873, -81.00965716689825, -80.83050844073296, 15.377167155345276, 14.020098139842347, 14.977518384655312, 10.196931806703404, 10.250572112699345, 9.857584719856575, 25.538081509371594, 25.240708385904625, 25.403602366646126, -0.025732625275850296, -0.037753522396087646, -0.19214069098234177, 23.787387539943055, 24.127071411659315, 23.533592005570725, 18.673426053486764, 18.527348950505257, 18.71309445798397, 23.54802360261479, 23.664882671708853, 23.69207861336568, 15.878877592583493, 16.126898666222885, 16.311472001795963, 19.357400027414158, 19.53258053710063, 19.795440671344593, 23.50003624955812, 24.04477710525194, 23.932188029090554, 19.412659133474023, 20.06900033603111, 20.295595253507287, 25.222766061623886, 25.535406821717814, 25.682303448983774, 16.993924329678208, 16.975137355426938, 17.282546234006674, 20.72492975741625, 20.494581907987595, 20.86314046755433, 25.369500733291105, 25.024812278648213, 25.083705094953373, -100.01535397271316, -89.06391915182273, -89.01499944056074, 22.511843078769743, 22.277009397745132, 21.923606045544147, 22.05037821953495, 22.177362413456038, 22.310456702796117, 16.975710491339356, 17.565962268660456, 16.85010703901449, 34.83190360975762, 34.68197778364022, 34.86787756470342, 11.406256151075155, 11.100492397944123, 11.425746232833859, 28.082339100539684, 28.180864218622446, 27.733140036463737, 16.34457521388927, 16.70851824587831, 16.02985557417074, -6.726516736050456, -6.653619566311448, -6.668124263485282, 8.854704336651281, 8.539642120401055, 8.31499199072519, 26.07879478732744, 26.404317433635384, 25.968861172596604, 19.422295692066342, 19.52631607434401, 19.544156908678502, -109.6789935429891, -93.36804600556692, -92.8720177349945, 12.156655319035053, 12.153201099485159, 11.949350588023663, 6.188090581446886, 6.390169319231063, 6.351536235772073, 16.01387974061072, 15.897372357547283, 16.07233440456912, 23.447039484977722, 23.507378421723843, 24.04784424137324, 19.072510873277977, 18.97412774463494, 19.134544872989252, 22.422022009889275, 22.980953539411217, 23.111105114842445, 26.735608398914337, 27.376341668888927, 26.646469578146935, 13.494838148355484, 13.676132641732693, 13.803866028785706, 22.59957990050316, 23.145643457770348, 23.172196321189404, 15.37671785553296, 15.388041359682873, 15.216931921740368, 16.89212122062841, 17.538548382620007, 16.67620242635408, 17.997060673932225, 17.555545488993317, 17.905191811422497, 3.09258050719896, 2.8625427509347503, 3.037920626501233, 31.583472836762667, 31.37750393897295, 31.455442041158676, 13.759992520014436, 14.339243952805788, 14.478995907508448, 23.604795567691326, 23.150125488638878, 23.858300752937794, 16.886543070276574, 17.558294494946793, 17.333071657766894, 21.40749757488568, 21.83403891821702, 22.197733865080707, 18.57457647224267, 18.30201981713374, 18.53033460800846, 5.980504343907029, 6.27711300055185, 5.895996990303189, 17.04363930473724, 16.810090536872536, 16.498281131188065, 15.24960272883375, 15.48940385629733, 15.43850798097749, 19.036044389009476, 19.39720883173868, 19.05845160037279, 18.98292791346708, 19.075627515713364, 19.28515352557102, 17.525038205087185, 17.854510627686977, 17.952740674838424, 26.111486241221428, 26.139174833893776, 26.41998989880085, 23.924288039406136, 23.981398341556385, 23.98526496936877, 13.961092015107468, 15.168849178900317, 14.45608340700467, 29.79657782614231, 30.114683866500854, 30.11462027579546, 28.372788467754916, 28.25302107383807, 27.460309510429695, 9.430671191463858, 9.404410828525812, 9.539863613705762, 26.458117589354515, 27.033197674900293, 26.725288406014442, 22.188690931846693, 21.77113552888234, 21.368169983228043, 14.950063561399773, 15.600337756176785, 15.557953005035714, 29.751144888500363, 29.7882582048575, 29.764350819090993, 8.516602506240204, 8.31476430346568, 8.039435063799218, 11.808203034102917, 11.715469606220722, 12.163887288421392, 13.89224137862523, 14.01606712241967, 14.473279507209853, 21.847666079799325, 22.083233433465153, 22.154545622567326, 6.717662195054189, 6.649412636955574, 6.297137041886643, 18.46510550379753, 19.20280348882079, 19.277691695839167, 31.88796242326498, 31.523562610149384, 31.9911145940423, 22.099024849633366, 21.862427117923886, 22.063515382508427, 23.25685089826584, 23.15858794748783, 23.872042171657085, 10.334474310278893, 10.778006516397, 10.740666516125202, 21.266045078635216, 22.011252336204052, 21.712255768477917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280705775739958, "mean_inference_ms": 0.7009985823896236, "mean_action_processing_ms": 0.09992587046134087, "mean_env_wait_ms": 0.8050226386126986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1467882, "timesteps_this_iter": 0, "agent_timesteps_total": 4403646, "timers": {"sample_time_ms": 20117.204, "sample_throughput": 476.905, "load_time_ms": 0.399, "load_throughput": 24018235.989, "learn_time_ms": 3029.68, "learn_throughput": 3166.671, "update_time_ms": 8.601}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 10.981062889099121, "policy_loss": 0.000374200789096113, "vf_loss": 11.147003054618835, "vf_explained_var": -0.2509753704071045, "kl": 0.0067905745238467895, "entropy": 16.63142466545105, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1467882, "num_agent_steps_sampled": 4403646, "num_steps_trained": 1467882, "num_agent_steps_trained": 4403646, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5696, "training_iteration": 153, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-34-38", "timestamp": 1706193278, "time_this_iter_s": 19.174065351486206, "time_total_s": 3076.512037038803, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB8B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3076.512037038803, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 7.981481481481482, "ram_util_percent": 52.8}}
{"episode_reward_max": 104.38175895810126, "episode_reward_min": -309.06455663591623, "episode_reward_mean": 44.35654311340127, "episode_len_mean": 294.89, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -113.62132596969604}, "policy_reward_max": {"shared_policy": 34.86787756470342}, "policy_reward_mean": {"shared_policy": 14.785514371133752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.47700138390061, 59.77725472301242, 76.44047633232547, 51.25160791911182, 62.082652132958174, 75.47801810689269, -278.0942725650966, 66.71245852205902, 66.5381973357871, 51.3917797990143, 104.38175895810126, 33.93249478185314, 83.99634335562587, 49.08294903393832, -20.048260565847187, 25.709338447777526, 78.45197339355943, 58.492768675088854, -295.9190572835505, 36.259207006543875, 18.929796136450022, 47.98358650272712, 71.0022621480748, 57.18118349090217, 68.51408066414294, 80.7584196459502, 40.97483681887388, 68.91741967946291, 45.9816911369562, 51.1068720296025, 53.45779797434804, 8.993043884634943, 94.41641881689429, 42.57823238032867, 70.613221809268, 51.77790922299026, 65.4392703581834, 55.40693089738487, 18.153614334762068, 50.35201097279784, 46.17751456610857, 57.49170482112095, 57.34370895475146, 53.332289507612586, 78.67065097391605, 71.89095135033129, 43.586024601012454, 90.02588196843863, 84.08611905202268, 28.374945633695432, 80.21660367026925, 65.32799644395708, 46.10835432261227, 89.30375391244885, 24.8708018735051, 35.68755992874503, 42.38158800825475, 66.0854451358318, 19.664211873896406, 56.94560068845749, 95.40263962745667, 66.02496735006568, 70.28748101741076, 31.853147342801094, 64.98955318331718, 73.03750804439186, 62.4352571137715, 60.052984863519654, 47.953506562858806, 73.7236521616578, 61.54042610619214, 73.04692700447048, 74.31723570078611, 70.8283610474318, 28.4680231977254, 57.80194304883479, 47.359925121068954, 63.9629582930356, 58.25593342259526, 73.70940464828162, 6.893910594284506, 40.84137523546815, 50.66849366948007, 92.60249314736572, 53.11473019048569, 72.18479676917192, 31.664539612829657, 70.97899970412254, -309.06455663591623, 36.753858752548695, 85.19879938755183, 54.14269930683075, 54.82771188393235, -36.88260339945556, 73.07079015113413, 17.043376527726622, 38.795866832486354, 79.80030716955662, 30.385702514206045, -19.923810616135597], "episode_lengths": [300, 300, 300, 300, 300, 300, 180, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.50003624955812, 24.04477710525194, 23.932188029090554, 19.412659133474023, 20.06900033603111, 20.295595253507287, 25.222766061623886, 25.535406821717814, 25.682303448983774, 16.993924329678208, 16.975137355426938, 17.282546234006674, 20.72492975741625, 20.494581907987595, 20.86314046755433, 25.369500733291105, 25.024812278648213, 25.083705094953373, -100.01535397271316, -89.06391915182273, -89.01499944056074, 22.511843078769743, 22.277009397745132, 21.923606045544147, 22.05037821953495, 22.177362413456038, 22.310456702796117, 16.975710491339356, 17.565962268660456, 16.85010703901449, 34.83190360975762, 34.68197778364022, 34.86787756470342, 11.406256151075155, 11.100492397944123, 11.425746232833859, 28.082339100539684, 28.180864218622446, 27.733140036463737, 16.34457521388927, 16.70851824587831, 16.02985557417074, -6.726516736050456, -6.653619566311448, -6.668124263485282, 8.854704336651281, 8.539642120401055, 8.31499199072519, 26.07879478732744, 26.404317433635384, 25.968861172596604, 19.422295692066342, 19.52631607434401, 19.544156908678502, -109.6789935429891, -93.36804600556692, -92.8720177349945, 12.156655319035053, 12.153201099485159, 11.949350588023663, 6.188090581446886, 6.390169319231063, 6.351536235772073, 16.01387974061072, 15.897372357547283, 16.07233440456912, 23.447039484977722, 23.507378421723843, 24.04784424137324, 19.072510873277977, 18.97412774463494, 19.134544872989252, 22.422022009889275, 22.980953539411217, 23.111105114842445, 26.735608398914337, 27.376341668888927, 26.646469578146935, 13.494838148355484, 13.676132641732693, 13.803866028785706, 22.59957990050316, 23.145643457770348, 23.172196321189404, 15.37671785553296, 15.388041359682873, 15.216931921740368, 16.89212122062841, 17.538548382620007, 16.67620242635408, 17.997060673932225, 17.555545488993317, 17.905191811422497, 3.09258050719896, 2.8625427509347503, 3.037920626501233, 31.583472836762667, 31.37750393897295, 31.455442041158676, 13.759992520014436, 14.339243952805788, 14.478995907508448, 23.604795567691326, 23.150125488638878, 23.858300752937794, 16.886543070276574, 17.558294494946793, 17.333071657766894, 21.40749757488568, 21.83403891821702, 22.197733865080707, 18.57457647224267, 18.30201981713374, 18.53033460800846, 5.980504343907029, 6.27711300055185, 5.895996990303189, 17.04363930473724, 16.810090536872536, 16.498281131188065, 15.24960272883375, 15.48940385629733, 15.43850798097749, 19.036044389009476, 19.39720883173868, 19.05845160037279, 18.98292791346708, 19.075627515713364, 19.28515352557102, 17.525038205087185, 17.854510627686977, 17.952740674838424, 26.111486241221428, 26.139174833893776, 26.41998989880085, 23.924288039406136, 23.981398341556385, 23.98526496936877, 13.961092015107468, 15.168849178900317, 14.45608340700467, 29.79657782614231, 30.114683866500854, 30.11462027579546, 28.372788467754916, 28.25302107383807, 27.460309510429695, 9.430671191463858, 9.404410828525812, 9.539863613705762, 26.458117589354515, 27.033197674900293, 26.725288406014442, 22.188690931846693, 21.77113552888234, 21.368169983228043, 14.950063561399773, 15.600337756176785, 15.557953005035714, 29.751144888500363, 29.7882582048575, 29.764350819090993, 8.516602506240204, 8.31476430346568, 8.039435063799218, 11.808203034102917, 11.715469606220722, 12.163887288421392, 13.89224137862523, 14.01606712241967, 14.473279507209853, 21.847666079799325, 22.083233433465153, 22.154545622567326, 6.717662195054189, 6.649412636955574, 6.297137041886643, 18.46510550379753, 19.20280348882079, 19.277691695839167, 31.88796242326498, 31.523562610149384, 31.9911145940423, 22.099024849633366, 21.862427117923886, 22.063515382508427, 23.25685089826584, 23.15858794748783, 23.872042171657085, 10.334474310278893, 10.778006516397, 10.740666516125202, 21.266045078635216, 22.011252336204052, 21.712255768477917, 24.50760380302866, 23.90356621642907, 24.626338024934128, 20.850451925148562, 20.650305674721793, 20.934499513901144, 20.08536236484845, 19.573644568522766, 20.393977930148438, 15.768800434966877, 16.134181787570313, 16.050524340321616, 24.643830639620617, 24.385601749022797, 24.69421977301438, 20.55212272858867, 20.541443434233457, 20.446859943370015, 24.259502341349915, 24.486309823308446, 24.301114839812115, 24.566642485558987, 24.971727684140205, 24.77886553108692, 23.664345518375427, 23.548507569978625, 23.615507959077746, 9.61135716301699, 9.2010659178098, 9.655600116898611, 19.378012151767805, 19.299635731925562, 19.12429516514142, 15.684307187795639, 15.890240155160427, 15.785377778112888, 20.827252472440392, 21.78327861117819, 21.352427209417016, 19.325384706258774, 19.173453137278557, 19.757095579057932, 24.933665668902293, 24.395582628746823, 24.380156350632504, 2.52365222076574, 2.1896412024895255, 2.1806171710292404, 13.681206442415714, 13.576652202755213, 13.583516590297222, 16.68357904752095, 17.002384418000773, 16.982530203958348, 30.465456838409096, 30.643657738963753, 31.49337856999287, 17.56993910173574, 17.798357269416243, 17.746433819333703, 23.974718565742165, 24.326696603248507, 23.883381600181252, 10.504913727442414, 10.266897926727921, 10.892727958659322, 23.190763384103775, 23.985425546765327, 23.80281077325344, -97.69308074563742, -97.75014992058277, -113.62132596969604, 12.698201827704906, 11.829033002257347, 12.226623922586441, 28.34049992014964, 28.241406453152493, 28.616893014249698, 18.399269323175147, 18.018417184551552, 17.72501279910405, 18.263830568641424, 18.29296563565731, 18.270915679633617, -12.28003077457349, -12.27075007061164, -12.331822554270431, 24.48487472347915, 24.120867751538754, 24.465047676116228, 5.874288479487092, 5.610324653486401, 5.558763394753129, 12.896702330559492, 13.120427456102334, 12.778737045824528, 26.857279755175114, 26.777303211390972, 26.165724202990532, 9.83686703195174, 10.424142873341523, 10.124692608912781, -6.539840422570705, -6.630494002252817, -6.753476191312075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527804153682565, "mean_inference_ms": 0.7008435756971743, "mean_action_processing_ms": 0.0999192796139503, "mean_env_wait_ms": 0.8047586104860364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1477476, "timesteps_this_iter": 0, "agent_timesteps_total": 4432428, "timers": {"sample_time_ms": 20039.236, "sample_throughput": 478.761, "load_time_ms": 0.299, "load_throughput": 32045992.336, "learn_time_ms": 3018.532, "learn_throughput": 3178.367, "update_time_ms": 8.701}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 57.90680170059204, "policy_loss": 0.0010598811343097703, "vf_loss": 58.07358169555664, "vf_explained_var": 0.10800138115882874, "kl": 0.012283808319130174, "entropy": 16.783560514450073, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1477476, "num_agent_steps_sampled": 4432428, "num_steps_trained": 1477476, "num_agent_steps_trained": 4432428, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5731, "training_iteration": 154, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-34-57", "timestamp": 1706193297, "time_this_iter_s": 18.732830286026, "time_total_s": 3095.244867324829, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB8EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3095.244867324829, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 6.476923076923077, "ram_util_percent": 52.81923076923078}}
{"episode_reward_max": 95.40263962745667, "episode_reward_min": -309.06455663591623, "episode_reward_mean": 47.47000680735335, "episode_len_mean": 296.62, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -113.62132596969604}, "policy_reward_max": {"shared_policy": 31.9911145940423}, "policy_reward_mean": {"shared_policy": 15.82333560245111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.993043884634943, 94.41641881689429, 42.57823238032867, 70.613221809268, 51.77790922299026, 65.4392703581834, 55.40693089738487, 18.153614334762068, 50.35201097279784, 46.17751456610857, 57.49170482112095, 57.34370895475146, 53.332289507612586, 78.67065097391605, 71.89095135033129, 43.586024601012454, 90.02588196843863, 84.08611905202268, 28.374945633695432, 80.21660367026925, 65.32799644395708, 46.10835432261227, 89.30375391244885, 24.8708018735051, 35.68755992874503, 42.38158800825475, 66.0854451358318, 19.664211873896406, 56.94560068845749, 95.40263962745667, 66.02496735006568, 70.28748101741076, 31.853147342801094, 64.98955318331718, 73.03750804439186, 62.4352571137715, 60.052984863519654, 47.953506562858806, 73.7236521616578, 61.54042610619214, 73.04692700447048, 74.31723570078611, 70.8283610474318, 28.4680231977254, 57.80194304883479, 47.359925121068954, 63.9629582930356, 58.25593342259526, 73.70940464828162, 6.893910594284506, 40.84137523546815, 50.66849366948007, 92.60249314736572, 53.11473019048569, 72.18479676917192, 31.664539612829657, 70.97899970412254, -309.06455663591623, 36.753858752548695, 85.19879938755183, 54.14269930683075, 54.82771188393235, -36.88260339945556, 73.07079015113413, 17.043376527726622, 38.795866832486354, 79.80030716955662, 30.385702514206045, -19.923810616135597, 49.948511650785804, 31.851033926010118, 70.29889385635033, 84.75866564363241, 25.23451490700245, 70.17771665006875, 67.22825222462414, 70.4250074215233, 30.095395401120186, 40.28726573975288, 65.56968564540145, 58.073377671651514, 43.11631389707324, 50.79140033200382, 46.469131290912614, 53.63623192906378, 5.108868334442363, 66.65546764805913, 58.19492295803501, 50.55773495137689, 42.062158927321406, -254.00776245817542, 71.1187929138541, 82.89749127626416, 38.58670850470661, 71.2741313651204, 63.85761831700802, 55.050436022691414, 51.15951369330287, 67.58821895532309, 45.4833055194467], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 172, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [3.09258050719896, 2.8625427509347503, 3.037920626501233, 31.583472836762667, 31.37750393897295, 31.455442041158676, 13.759992520014436, 14.339243952805788, 14.478995907508448, 23.604795567691326, 23.150125488638878, 23.858300752937794, 16.886543070276574, 17.558294494946793, 17.333071657766894, 21.40749757488568, 21.83403891821702, 22.197733865080707, 18.57457647224267, 18.30201981713374, 18.53033460800846, 5.980504343907029, 6.27711300055185, 5.895996990303189, 17.04363930473724, 16.810090536872536, 16.498281131188065, 15.24960272883375, 15.48940385629733, 15.43850798097749, 19.036044389009476, 19.39720883173868, 19.05845160037279, 18.98292791346708, 19.075627515713364, 19.28515352557102, 17.525038205087185, 17.854510627686977, 17.952740674838424, 26.111486241221428, 26.139174833893776, 26.41998989880085, 23.924288039406136, 23.981398341556385, 23.98526496936877, 13.961092015107468, 15.168849178900317, 14.45608340700467, 29.79657782614231, 30.114683866500854, 30.11462027579546, 28.372788467754916, 28.25302107383807, 27.460309510429695, 9.430671191463858, 9.404410828525812, 9.539863613705762, 26.458117589354515, 27.033197674900293, 26.725288406014442, 22.188690931846693, 21.77113552888234, 21.368169983228043, 14.950063561399773, 15.600337756176785, 15.557953005035714, 29.751144888500363, 29.7882582048575, 29.764350819090993, 8.516602506240204, 8.31476430346568, 8.039435063799218, 11.808203034102917, 11.715469606220722, 12.163887288421392, 13.89224137862523, 14.01606712241967, 14.473279507209853, 21.847666079799325, 22.083233433465153, 22.154545622567326, 6.717662195054189, 6.649412636955574, 6.297137041886643, 18.46510550379753, 19.20280348882079, 19.277691695839167, 31.88796242326498, 31.523562610149384, 31.9911145940423, 22.099024849633366, 21.862427117923886, 22.063515382508427, 23.25685089826584, 23.15858794748783, 23.872042171657085, 10.334474310278893, 10.778006516397, 10.740666516125202, 21.266045078635216, 22.011252336204052, 21.712255768477917, 24.50760380302866, 23.90356621642907, 24.626338024934128, 20.850451925148562, 20.650305674721793, 20.934499513901144, 20.08536236484845, 19.573644568522766, 20.393977930148438, 15.768800434966877, 16.134181787570313, 16.050524340321616, 24.643830639620617, 24.385601749022797, 24.69421977301438, 20.55212272858867, 20.541443434233457, 20.446859943370015, 24.259502341349915, 24.486309823308446, 24.301114839812115, 24.566642485558987, 24.971727684140205, 24.77886553108692, 23.664345518375427, 23.548507569978625, 23.615507959077746, 9.61135716301699, 9.2010659178098, 9.655600116898611, 19.378012151767805, 19.299635731925562, 19.12429516514142, 15.684307187795639, 15.890240155160427, 15.785377778112888, 20.827252472440392, 21.78327861117819, 21.352427209417016, 19.325384706258774, 19.173453137278557, 19.757095579057932, 24.933665668902293, 24.395582628746823, 24.380156350632504, 2.52365222076574, 2.1896412024895255, 2.1806171710292404, 13.681206442415714, 13.576652202755213, 13.583516590297222, 16.68357904752095, 17.002384418000773, 16.982530203958348, 30.465456838409096, 30.643657738963753, 31.49337856999287, 17.56993910173574, 17.798357269416243, 17.746433819333703, 23.974718565742165, 24.326696603248507, 23.883381600181252, 10.504913727442414, 10.266897926727921, 10.892727958659322, 23.190763384103775, 23.985425546765327, 23.80281077325344, -97.69308074563742, -97.75014992058277, -113.62132596969604, 12.698201827704906, 11.829033002257347, 12.226623922586441, 28.34049992014964, 28.241406453152493, 28.616893014249698, 18.399269323175147, 18.018417184551552, 17.72501279910405, 18.263830568641424, 18.29296563565731, 18.270915679633617, -12.28003077457349, -12.27075007061164, -12.331822554270431, 24.48487472347915, 24.120867751538754, 24.465047676116228, 5.874288479487092, 5.610324653486401, 5.558763394753129, 12.896702330559492, 13.120427456102334, 12.778737045824528, 26.857279755175114, 26.777303211390972, 26.165724202990532, 9.83686703195174, 10.424142873341523, 10.124692608912781, -6.539840422570705, -6.630494002252817, -6.753476191312075, 16.427162393927574, 16.917179135605693, 16.604170121252537, 10.497457702954605, 10.574835633238152, 10.77874058981736, 22.38705939054489, 23.811239529401064, 24.100594936404377, 28.308350645005703, 28.170462861657143, 28.279852136969566, 8.66060395538807, 8.83456152677536, 7.73934942483902, 23.436712877204016, 23.265761968990162, 23.475241803874567, 22.561419447263077, 22.675713775058583, 21.991119002302483, 23.50666783253351, 23.708530156562716, 23.20980943242708, 10.066359959542751, 10.074807316064835, 9.9542281255126, 13.070309000710637, 13.632665198335104, 13.584291540707142, 21.799139375487954, 21.882743793229253, 21.887802476684243, 19.04276170829931, 19.22681265572706, 19.803803307625145, 14.452019708851964, 14.14364021519819, 14.520653973023087, 17.02546002840002, 16.69707578172286, 17.06886452188094, 15.500736103703574, 15.569003538539008, 15.399391648670033, 17.42365637918313, 17.95424925287564, 18.258326297005013, 1.7298885447283538, 1.64216125508149, 1.7368185346325191, 22.599498856812716, 21.69120578467846, 22.364763006567955, 19.450214647067085, 19.464452131496117, 19.280256179471806, 17.02612310151258, 17.038624728719384, 16.49298712114492, 14.075421851749212, 14.055359841013939, 13.931377234558255, -93.03455924987793, -79.86100625619292, -81.11219695210457, 23.60602784405151, 23.519039298097283, 23.9937257717053, 27.753886843721062, 27.712011004487664, 27.431593428055436, 13.062263282326356, 12.489773256083325, 13.034671966296926, 23.629808132847145, 23.479565908511475, 24.164757323761776, 21.444863971322775, 21.076078727841377, 21.336675617843866, 18.207062517603234, 18.292701316376522, 18.55067218871166, 17.187840054742992, 17.159781717695296, 16.811891920864582, 22.55900777628024, 22.604196283345416, 22.42501489569743, 15.560207754994423, 14.686338330308587, 15.236759434143693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274959903839214, "mean_inference_ms": 0.7006136714800516, "mean_action_processing_ms": 0.09992828366098185, "mean_env_wait_ms": 0.8046215867647522, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1487070, "timesteps_this_iter": 0, "agent_timesteps_total": 4461210, "timers": {"sample_time_ms": 19928.742, "sample_throughput": 481.415, "load_time_ms": 0.199, "load_throughput": 48128396.814, "learn_time_ms": 3012.06, "learn_throughput": 3185.196, "update_time_ms": 8.594}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 42.9041223526001, "policy_loss": -4.59583799385932e-05, "vf_loss": 43.07455492019653, "vf_explained_var": 0.2630857229232788, "kl": 0.010617215943294747, "entropy": 17.03889012336731, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1487070, "num_agent_steps_sampled": 4461210, "num_steps_trained": 1487070, "num_agent_steps_trained": 4461210, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5762, "training_iteration": 155, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-35-16", "timestamp": 1706193316, "time_this_iter_s": 19.14820170402527, "time_total_s": 3114.3930690288544, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B95EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3114.3930690288544, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 8.150000000000002, "ram_util_percent": 52.74642857142858}}
{"episode_reward_max": 92.60249314736572, "episode_reward_min": -309.06455663591623, "episode_reward_mean": 47.27152909017269, "episode_len_mean": 296.62, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -113.62132596969604}, "policy_reward_max": {"shared_policy": 31.49337856999287}, "policy_reward_mean": {"shared_policy": 15.757176363390894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.853147342801094, 64.98955318331718, 73.03750804439186, 62.4352571137715, 60.052984863519654, 47.953506562858806, 73.7236521616578, 61.54042610619214, 73.04692700447048, 74.31723570078611, 70.8283610474318, 28.4680231977254, 57.80194304883479, 47.359925121068954, 63.9629582930356, 58.25593342259526, 73.70940464828162, 6.893910594284506, 40.84137523546815, 50.66849366948007, 92.60249314736572, 53.11473019048569, 72.18479676917192, 31.664539612829657, 70.97899970412254, -309.06455663591623, 36.753858752548695, 85.19879938755183, 54.14269930683075, 54.82771188393235, -36.88260339945556, 73.07079015113413, 17.043376527726622, 38.795866832486354, 79.80030716955662, 30.385702514206045, -19.923810616135597, 49.948511650785804, 31.851033926010118, 70.29889385635033, 84.75866564363241, 25.23451490700245, 70.17771665006875, 67.22825222462414, 70.4250074215233, 30.095395401120186, 40.28726573975288, 65.56968564540145, 58.073377671651514, 43.11631389707324, 50.79140033200382, 46.469131290912614, 53.63623192906378, 5.108868334442363, 66.65546764805913, 58.19492295803501, 50.55773495137689, 42.062158927321406, -254.00776245817542, 71.1187929138541, 82.89749127626416, 38.58670850470661, 71.2741313651204, 63.85761831700802, 55.050436022691414, 51.15951369330287, 67.58821895532309, 45.4833055194467, 53.17393270134926, 69.4673385042697, 47.75537985563278, 65.50760917551814, 66.24115411937234, 70.05124186724423, 45.431237548589706, 66.06528767570852, 73.395986687392, 65.72405385412273, 57.53000769019124, 50.29224923439324, 75.0315156318247, 67.10200771782547, 53.50950840115544, 54.09025236219165, 47.83454285655168, 48.562738933600485, 73.23845260590315, 70.91136124171315, 8.428653717040987, 78.69489855319259, 21.653493224643157, 55.403164209317765, 70.29311581514776, 68.10397305339572, 13.347360597108477, 69.3804573789239, 38.28235218022019, 51.62108800560233, 71.09359674155709, 39.95166410040109], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 90, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 172, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [10.334474310278893, 10.778006516397, 10.740666516125202, 21.266045078635216, 22.011252336204052, 21.712255768477917, 24.50760380302866, 23.90356621642907, 24.626338024934128, 20.850451925148562, 20.650305674721793, 20.934499513901144, 20.08536236484845, 19.573644568522766, 20.393977930148438, 15.768800434966877, 16.134181787570313, 16.050524340321616, 24.643830639620617, 24.385601749022797, 24.69421977301438, 20.55212272858867, 20.541443434233457, 20.446859943370015, 24.259502341349915, 24.486309823308446, 24.301114839812115, 24.566642485558987, 24.971727684140205, 24.77886553108692, 23.664345518375427, 23.548507569978625, 23.615507959077746, 9.61135716301699, 9.2010659178098, 9.655600116898611, 19.378012151767805, 19.299635731925562, 19.12429516514142, 15.684307187795639, 15.890240155160427, 15.785377778112888, 20.827252472440392, 21.78327861117819, 21.352427209417016, 19.325384706258774, 19.173453137278557, 19.757095579057932, 24.933665668902293, 24.395582628746823, 24.380156350632504, 2.52365222076574, 2.1896412024895255, 2.1806171710292404, 13.681206442415714, 13.576652202755213, 13.583516590297222, 16.68357904752095, 17.002384418000773, 16.982530203958348, 30.465456838409096, 30.643657738963753, 31.49337856999287, 17.56993910173574, 17.798357269416243, 17.746433819333703, 23.974718565742165, 24.326696603248507, 23.883381600181252, 10.504913727442414, 10.266897926727921, 10.892727958659322, 23.190763384103775, 23.985425546765327, 23.80281077325344, -97.69308074563742, -97.75014992058277, -113.62132596969604, 12.698201827704906, 11.829033002257347, 12.226623922586441, 28.34049992014964, 28.241406453152493, 28.616893014249698, 18.399269323175147, 18.018417184551552, 17.72501279910405, 18.263830568641424, 18.29296563565731, 18.270915679633617, -12.28003077457349, -12.27075007061164, -12.331822554270431, 24.48487472347915, 24.120867751538754, 24.465047676116228, 5.874288479487092, 5.610324653486401, 5.558763394753129, 12.896702330559492, 13.120427456102334, 12.778737045824528, 26.857279755175114, 26.777303211390972, 26.165724202990532, 9.83686703195174, 10.424142873341523, 10.124692608912781, -6.539840422570705, -6.630494002252817, -6.753476191312075, 16.427162393927574, 16.917179135605693, 16.604170121252537, 10.497457702954605, 10.574835633238152, 10.77874058981736, 22.38705939054489, 23.811239529401064, 24.100594936404377, 28.308350645005703, 28.170462861657143, 28.279852136969566, 8.66060395538807, 8.83456152677536, 7.73934942483902, 23.436712877204016, 23.265761968990162, 23.475241803874567, 22.561419447263077, 22.675713775058583, 21.991119002302483, 23.50666783253351, 23.708530156562716, 23.20980943242708, 10.066359959542751, 10.074807316064835, 9.9542281255126, 13.070309000710637, 13.632665198335104, 13.584291540707142, 21.799139375487954, 21.882743793229253, 21.887802476684243, 19.04276170829931, 19.22681265572706, 19.803803307625145, 14.452019708851964, 14.14364021519819, 14.520653973023087, 17.02546002840002, 16.69707578172286, 17.06886452188094, 15.500736103703574, 15.569003538539008, 15.399391648670033, 17.42365637918313, 17.95424925287564, 18.258326297005013, 1.7298885447283538, 1.64216125508149, 1.7368185346325191, 22.599498856812716, 21.69120578467846, 22.364763006567955, 19.450214647067085, 19.464452131496117, 19.280256179471806, 17.02612310151258, 17.038624728719384, 16.49298712114492, 14.075421851749212, 14.055359841013939, 13.931377234558255, -93.03455924987793, -79.86100625619292, -81.11219695210457, 23.60602784405151, 23.519039298097283, 23.9937257717053, 27.753886843721062, 27.712011004487664, 27.431593428055436, 13.062263282326356, 12.489773256083325, 13.034671966296926, 23.629808132847145, 23.479565908511475, 24.164757323761776, 21.444863971322775, 21.076078727841377, 21.336675617843866, 18.207062517603234, 18.292701316376522, 18.55067218871166, 17.187840054742992, 17.159781717695296, 16.811891920864582, 22.55900777628024, 22.604196283345416, 22.42501489569743, 15.560207754994423, 14.686338330308587, 15.236759434143693, 17.658033534884453, 17.616284802556038, 17.899614363908768, 22.925979440410927, 23.185191472371415, 23.356167591487363, 15.561168104410172, 16.08330522570759, 16.11090652551502, 21.89679701564212, 21.713068669040993, 21.897743490835026, 21.693631450335175, 22.572534198562295, 21.97498847047487, 23.451441084345177, 22.989208703239754, 23.6105920796593, 14.75716120004654, 15.669581726193428, 15.004494622349739, 21.603494097789124, 22.244156447549656, 22.217637130369738, 24.4846161454916, 24.337102435529232, 24.574268106371164, 22.00735993559161, 21.75136815632382, 21.9653257622073, 18.83508243660131, 19.38849241534868, 19.30643283824125, 16.920908058062196, 16.83615054190159, 16.535190634429455, 25.13874306405583, 24.883740479747445, 25.009032088021428, 22.051915630698204, 22.817215711809695, 22.232876375317574, 17.838067701707274, 17.837586952994258, 17.83385374645391, 18.149324646840483, 18.057556404421717, 17.883371310929448, 16.11228895901391, 15.720635662476212, 16.001618235061557, 15.581778541207314, 16.366608154028654, 16.614352238364518, 24.44490858912468, 24.618919618427753, 24.174624398350716, 23.915955878173307, 23.497077969213322, 23.498327394326523, 2.92300449560085, 2.6033580849567954, 2.902291136483342, 26.32114567855993, 25.916938270131737, 26.45681460450092, 7.153099370499447, 7.600287031692758, 6.900106822450951, 18.202035002410412, 18.790553571176133, 18.41057563573122, 23.541618203744292, 23.401022516191006, 23.35047509521246, 22.444974819819123, 22.752677279214055, 22.906320954362542, 4.218645070989922, 4.137422790129975, 4.99129273598858, 23.033414773643017, 23.28029080480337, 23.066751800477505, 12.717322506010532, 13.09934035781771, 12.465689316391945, 17.52781671533981, 17.116950685779244, 16.976320604483277, 23.438065151373536, 23.867572496334702, 23.787959093848855, 12.978891496857003, 13.570319474053875, 13.402453129490212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526758478453589, "mean_inference_ms": 0.700292425672139, "mean_action_processing_ms": 0.09987566382617492, "mean_env_wait_ms": 0.8042730410305462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1496664, "timesteps_this_iter": 0, "agent_timesteps_total": 4489992, "timers": {"sample_time_ms": 19883.858, "sample_throughput": 482.502, "load_time_ms": 0.199, "load_throughput": 48128396.814, "learn_time_ms": 3011.399, "learn_throughput": 3185.895, "update_time_ms": 8.488}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.83363390716363e-13, "cur_lr": 0.0005, "total_loss": 11.590515494346619, "policy_loss": -0.0003884781827965256, "vf_loss": 11.758941292762756, "vf_explained_var": -0.17908568680286407, "kl": 0.0031672898478568258, "entropy": 16.803741216659546, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1496664, "num_agent_steps_sampled": 4489992, "num_steps_trained": 1496664, "num_agent_steps_trained": 4489992, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5794, "training_iteration": 156, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-35-35", "timestamp": 1706193335, "time_this_iter_s": 18.651288747787476, "time_total_s": 3133.044357776642, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB8B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3133.044357776642, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 8.476923076923079, "ram_util_percent": 52.81923076923078}}
{"episode_reward_max": 88.03519139438866, "episode_reward_min": -254.00776245817542, "episode_reward_mean": 51.27175624904267, "episode_len_mean": 298.72, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -93.03455924987793}, "policy_reward_max": {"shared_policy": 29.663083982964352}, "policy_reward_mean": {"shared_policy": 17.090585416347547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.043376527726622, 38.795866832486354, 79.80030716955662, 30.385702514206045, -19.923810616135597, 49.948511650785804, 31.851033926010118, 70.29889385635033, 84.75866564363241, 25.23451490700245, 70.17771665006875, 67.22825222462414, 70.4250074215233, 30.095395401120186, 40.28726573975288, 65.56968564540145, 58.073377671651514, 43.11631389707324, 50.79140033200382, 46.469131290912614, 53.63623192906378, 5.108868334442363, 66.65546764805913, 58.19492295803501, 50.55773495137689, 42.062158927321406, -254.00776245817542, 71.1187929138541, 82.89749127626416, 38.58670850470661, 71.2741313651204, 63.85761831700802, 55.050436022691414, 51.15951369330287, 67.58821895532309, 45.4833055194467, 53.17393270134926, 69.4673385042697, 47.75537985563278, 65.50760917551814, 66.24115411937234, 70.05124186724423, 45.431237548589706, 66.06528767570852, 73.395986687392, 65.72405385412273, 57.53000769019124, 50.29224923439324, 75.0315156318247, 67.10200771782547, 53.50950840115544, 54.09025236219165, 47.83454285655168, 48.562738933600485, 73.23845260590315, 70.91136124171315, 8.428653717040987, 78.69489855319259, 21.653493224643157, 55.403164209317765, 70.29311581514776, 68.10397305339572, 13.347360597108477, 69.3804573789239, 38.28235218022019, 51.62108800560233, 71.09359674155709, 39.95166410040109, 82.35431321989742, 40.248763509094715, 76.34132035821675, 65.33193920552728, 43.83661724580452, 47.78784210048616, 27.128100984729826, 56.33699271827933, 63.63697042316198, 33.413734536617994, 53.907959901727736, 7.012131296098218, 55.45213610678911, 31.714662354439483, 57.96026073396203, 57.147904455661774, 57.57159083802253, 63.40849630534649, 44.84420833736657, 69.10122980945744, 63.42826880514622, 76.47278493875638, 84.84785395750075, 50.597669636365, 66.61021285690364, 52.32227480411527, 34.460323096252964, 88.03519139438866, 58.864397388882935, 61.42265481501815, 54.28791861794886, 74.46877636760473], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 172, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.874288479487092, 5.610324653486401, 5.558763394753129, 12.896702330559492, 13.120427456102334, 12.778737045824528, 26.857279755175114, 26.777303211390972, 26.165724202990532, 9.83686703195174, 10.424142873341523, 10.124692608912781, -6.539840422570705, -6.630494002252817, -6.753476191312075, 16.427162393927574, 16.917179135605693, 16.604170121252537, 10.497457702954605, 10.574835633238152, 10.77874058981736, 22.38705939054489, 23.811239529401064, 24.100594936404377, 28.308350645005703, 28.170462861657143, 28.279852136969566, 8.66060395538807, 8.83456152677536, 7.73934942483902, 23.436712877204016, 23.265761968990162, 23.475241803874567, 22.561419447263077, 22.675713775058583, 21.991119002302483, 23.50666783253351, 23.708530156562716, 23.20980943242708, 10.066359959542751, 10.074807316064835, 9.9542281255126, 13.070309000710637, 13.632665198335104, 13.584291540707142, 21.799139375487954, 21.882743793229253, 21.887802476684243, 19.04276170829931, 19.22681265572706, 19.803803307625145, 14.452019708851964, 14.14364021519819, 14.520653973023087, 17.02546002840002, 16.69707578172286, 17.06886452188094, 15.500736103703574, 15.569003538539008, 15.399391648670033, 17.42365637918313, 17.95424925287564, 18.258326297005013, 1.7298885447283538, 1.64216125508149, 1.7368185346325191, 22.599498856812716, 21.69120578467846, 22.364763006567955, 19.450214647067085, 19.464452131496117, 19.280256179471806, 17.02612310151258, 17.038624728719384, 16.49298712114492, 14.075421851749212, 14.055359841013939, 13.931377234558255, -93.03455924987793, -79.86100625619292, -81.11219695210457, 23.60602784405151, 23.519039298097283, 23.9937257717053, 27.753886843721062, 27.712011004487664, 27.431593428055436, 13.062263282326356, 12.489773256083325, 13.034671966296926, 23.629808132847145, 23.479565908511475, 24.164757323761776, 21.444863971322775, 21.076078727841377, 21.336675617843866, 18.207062517603234, 18.292701316376522, 18.55067218871166, 17.187840054742992, 17.159781717695296, 16.811891920864582, 22.55900777628024, 22.604196283345416, 22.42501489569743, 15.560207754994423, 14.686338330308587, 15.236759434143693, 17.658033534884453, 17.616284802556038, 17.899614363908768, 22.925979440410927, 23.185191472371415, 23.356167591487363, 15.561168104410172, 16.08330522570759, 16.11090652551502, 21.89679701564212, 21.713068669040993, 21.897743490835026, 21.693631450335175, 22.572534198562295, 21.97498847047487, 23.451441084345177, 22.989208703239754, 23.6105920796593, 14.75716120004654, 15.669581726193428, 15.004494622349739, 21.603494097789124, 22.244156447549656, 22.217637130369738, 24.4846161454916, 24.337102435529232, 24.574268106371164, 22.00735993559161, 21.75136815632382, 21.9653257622073, 18.83508243660131, 19.38849241534868, 19.30643283824125, 16.920908058062196, 16.83615054190159, 16.535190634429455, 25.13874306405583, 24.883740479747445, 25.009032088021428, 22.051915630698204, 22.817215711809695, 22.232876375317574, 17.838067701707274, 17.837586952994258, 17.83385374645391, 18.149324646840483, 18.057556404421717, 17.883371310929448, 16.11228895901391, 15.720635662476212, 16.001618235061557, 15.581778541207314, 16.366608154028654, 16.614352238364518, 24.44490858912468, 24.618919618427753, 24.174624398350716, 23.915955878173307, 23.497077969213322, 23.498327394326523, 2.92300449560085, 2.6033580849567954, 2.902291136483342, 26.32114567855993, 25.916938270131737, 26.45681460450092, 7.153099370499447, 7.600287031692758, 6.900106822450951, 18.202035002410412, 18.790553571176133, 18.41057563573122, 23.541618203744292, 23.401022516191006, 23.35047509521246, 22.444974819819123, 22.752677279214055, 22.906320954362542, 4.218645070989922, 4.137422790129975, 4.99129273598858, 23.033414773643017, 23.28029080480337, 23.066751800477505, 12.717322506010532, 13.09934035781771, 12.465689316391945, 17.52781671533981, 17.116950685779244, 16.976320604483277, 23.438065151373536, 23.867572496334702, 23.787959093848855, 12.978891496857003, 13.570319474053875, 13.402453129490212, 27.308717163900525, 27.267314511040837, 27.77828154495606, 13.569667742587626, 13.114955209195614, 13.564140557311475, 25.86145626318951, 24.68871175249417, 25.791152342533067, 21.59883018831411, 21.69965740541616, 22.033451611797005, 14.816454268526286, 14.484950587153435, 14.535212390124798, 16.472465781494975, 15.287919253110886, 16.0274570658803, 9.246487855911255, 9.364670478738844, 8.516942650079727, 18.730373630921036, 18.461832279960305, 19.144786807397992, 21.1620136462152, 21.292894158512354, 21.18206261843443, 10.330152601003647, 11.700357716530561, 11.383224219083786, 17.894186578691006, 17.635421693325043, 18.378351629711688, 2.3934682731827053, 2.5258032133181842, 2.0928598095973285, 18.794120267033577, 18.24361400306225, 18.414401836693287, 10.530939941604927, 10.491977242132023, 10.691745170702532, 19.203819173077733, 19.296354713539273, 19.460086847345025, 19.161658078432083, 19.257550328969955, 18.728696048259735, 19.145851157605648, 19.339693141169846, 19.086046539247036, 21.19417877867818, 20.909191220998764, 21.305126305669546, 14.890580741067723, 14.99136910339196, 14.962258492906884, 23.131921896710992, 23.157537808874622, 22.811770103871822, 21.09447792172432, 21.05861511081457, 21.275175772607327, 25.16508539021015, 26.021629395429045, 25.28607015311718, 28.34495212432617, 28.352585540133674, 28.150316293040902, 17.001369225482136, 17.071427926576376, 16.524872484306485, 22.236579327533633, 22.360060416782886, 22.013573112587125, 17.106846416989953, 17.705797026554734, 17.50963136057058, 11.363847588499382, 12.056900134620562, 11.039575373133019, 29.074025993545845, 29.663083982964352, 29.298081417878464, 19.671776808798313, 19.360755749046803, 19.83186483103782, 20.587410422662884, 20.3672646904985, 20.467979701856763, 17.993994692961365, 18.03976174692312, 18.254162178064377, 24.1857178658247, 25.15575489588082, 25.127303605899215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15269334905208407, "mean_inference_ms": 0.700299957582158, "mean_action_processing_ms": 0.09988963281126743, "mean_env_wait_ms": 0.8042437436774243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1506258, "timesteps_this_iter": 0, "agent_timesteps_total": 4518774, "timers": {"sample_time_ms": 20121.165, "sample_throughput": 476.811, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3081.496, "learn_throughput": 3113.423, "update_time_ms": 8.648}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.916816953581815e-13, "cur_lr": 0.0005, "total_loss": 6.292016088962555, "policy_loss": 0.00011920104578599933, "vf_loss": 6.462210953235626, "vf_explained_var": 0.06800137460231781, "kl": 0.0040519919714511405, "entropy": 17.031427145004272, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1506258, "num_agent_steps_sampled": 4518774, "num_steps_trained": 1506258, "num_agent_steps_trained": 4518774, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5826, "training_iteration": 157, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-35-57", "timestamp": 1706193357, "time_this_iter_s": 22.281814575195312, "time_total_s": 3155.326172351837, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3155.326172351837, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 9.851612903225806, "ram_util_percent": 53.3}}
{"episode_reward_max": 88.12082969397305, "episode_reward_min": 2.1253251302987195, "episode_reward_mean": 55.660254270314184, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": 0.34055549403031193}, "policy_reward_max": {"shared_policy": 29.663083982964352}, "policy_reward_mean": {"shared_policy": 18.55341809010472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.85761831700802, 55.050436022691414, 51.15951369330287, 67.58821895532309, 45.4833055194467, 53.17393270134926, 69.4673385042697, 47.75537985563278, 65.50760917551814, 66.24115411937234, 70.05124186724423, 45.431237548589706, 66.06528767570852, 73.395986687392, 65.72405385412273, 57.53000769019124, 50.29224923439324, 75.0315156318247, 67.10200771782547, 53.50950840115544, 54.09025236219165, 47.83454285655168, 48.562738933600485, 73.23845260590315, 70.91136124171315, 8.428653717040987, 78.69489855319259, 21.653493224643157, 55.403164209317765, 70.29311581514776, 68.10397305339572, 13.347360597108477, 69.3804573789239, 38.28235218022019, 51.62108800560233, 71.09359674155709, 39.95166410040109, 82.35431321989742, 40.248763509094715, 76.34132035821675, 65.33193920552728, 43.83661724580452, 47.78784210048616, 27.128100984729826, 56.33699271827933, 63.63697042316198, 33.413734536617994, 53.907959901727736, 7.012131296098218, 55.45213610678911, 31.714662354439483, 57.96026073396203, 57.147904455661774, 57.57159083802253, 63.40849630534649, 44.84420833736657, 69.10122980945744, 63.42826880514622, 76.47278493875638, 84.84785395750075, 50.597669636365, 66.61021285690364, 52.32227480411527, 34.460323096252964, 88.03519139438866, 58.864397388882935, 61.42265481501815, 54.28791861794886, 74.46877636760473, 83.0745286969468, 78.64453107863665, 52.297665141522884, 62.64771196618675, 73.43471095710991, 67.03892574924974, 57.62418558821082, 32.26651104912162, 54.33819700404999, 51.718980100005865, 61.48550400137901, 66.27168845012784, 61.273401791157085, 55.33370713889596, 2.1253251302987195, 12.924819747917326, 34.71462736278772, 58.271099543198915, 51.25817982852459, 27.197649076581, 62.57886356860399, 65.55530462786554, 55.644049402326345, 88.12082969397305, 38.10871325060725, 69.33066603168845, 41.12315444834529, 27.121609888970823, 42.53603144735095, 78.4243522491306, 62.87563315220176], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.444863971322775, 21.076078727841377, 21.336675617843866, 18.207062517603234, 18.292701316376522, 18.55067218871166, 17.187840054742992, 17.159781717695296, 16.811891920864582, 22.55900777628024, 22.604196283345416, 22.42501489569743, 15.560207754994423, 14.686338330308587, 15.236759434143693, 17.658033534884453, 17.616284802556038, 17.899614363908768, 22.925979440410927, 23.185191472371415, 23.356167591487363, 15.561168104410172, 16.08330522570759, 16.11090652551502, 21.89679701564212, 21.713068669040993, 21.897743490835026, 21.693631450335175, 22.572534198562295, 21.97498847047487, 23.451441084345177, 22.989208703239754, 23.6105920796593, 14.75716120004654, 15.669581726193428, 15.004494622349739, 21.603494097789124, 22.244156447549656, 22.217637130369738, 24.4846161454916, 24.337102435529232, 24.574268106371164, 22.00735993559161, 21.75136815632382, 21.9653257622073, 18.83508243660131, 19.38849241534868, 19.30643283824125, 16.920908058062196, 16.83615054190159, 16.535190634429455, 25.13874306405583, 24.883740479747445, 25.009032088021428, 22.051915630698204, 22.817215711809695, 22.232876375317574, 17.838067701707274, 17.837586952994258, 17.83385374645391, 18.149324646840483, 18.057556404421717, 17.883371310929448, 16.11228895901391, 15.720635662476212, 16.001618235061557, 15.581778541207314, 16.366608154028654, 16.614352238364518, 24.44490858912468, 24.618919618427753, 24.174624398350716, 23.915955878173307, 23.497077969213322, 23.498327394326523, 2.92300449560085, 2.6033580849567954, 2.902291136483342, 26.32114567855993, 25.916938270131737, 26.45681460450092, 7.153099370499447, 7.600287031692758, 6.900106822450951, 18.202035002410412, 18.790553571176133, 18.41057563573122, 23.541618203744292, 23.401022516191006, 23.35047509521246, 22.444974819819123, 22.752677279214055, 22.906320954362542, 4.218645070989922, 4.137422790129975, 4.99129273598858, 23.033414773643017, 23.28029080480337, 23.066751800477505, 12.717322506010532, 13.09934035781771, 12.465689316391945, 17.52781671533981, 17.116950685779244, 16.976320604483277, 23.438065151373536, 23.867572496334702, 23.787959093848855, 12.978891496857003, 13.570319474053875, 13.402453129490212, 27.308717163900525, 27.267314511040837, 27.77828154495606, 13.569667742587626, 13.114955209195614, 13.564140557311475, 25.86145626318951, 24.68871175249417, 25.791152342533067, 21.59883018831411, 21.69965740541616, 22.033451611797005, 14.816454268526286, 14.484950587153435, 14.535212390124798, 16.472465781494975, 15.287919253110886, 16.0274570658803, 9.246487855911255, 9.364670478738844, 8.516942650079727, 18.730373630921036, 18.461832279960305, 19.144786807397992, 21.1620136462152, 21.292894158512354, 21.18206261843443, 10.330152601003647, 11.700357716530561, 11.383224219083786, 17.894186578691006, 17.635421693325043, 18.378351629711688, 2.3934682731827053, 2.5258032133181842, 2.0928598095973285, 18.794120267033577, 18.24361400306225, 18.414401836693287, 10.530939941604927, 10.491977242132023, 10.691745170702532, 19.203819173077733, 19.296354713539273, 19.460086847345025, 19.161658078432083, 19.257550328969955, 18.728696048259735, 19.145851157605648, 19.339693141169846, 19.086046539247036, 21.19417877867818, 20.909191220998764, 21.305126305669546, 14.890580741067723, 14.99136910339196, 14.962258492906884, 23.131921896710992, 23.157537808874622, 22.811770103871822, 21.09447792172432, 21.05861511081457, 21.275175772607327, 25.16508539021015, 26.021629395429045, 25.28607015311718, 28.34495212432617, 28.352585540133674, 28.150316293040902, 17.001369225482136, 17.071427926576376, 16.524872484306485, 22.236579327533633, 22.360060416782886, 22.013573112587125, 17.106846416989953, 17.705797026554734, 17.50963136057058, 11.363847588499382, 12.056900134620562, 11.039575373133019, 29.074025993545845, 29.663083982964352, 29.298081417878464, 19.671776808798313, 19.360755749046803, 19.83186483103782, 20.587410422662884, 20.3672646904985, 20.467979701856763, 17.993994692961365, 18.03976174692312, 18.254162178064377, 24.1857178658247, 25.15575489588082, 25.127303605899215, 27.782999828457832, 27.15245123207569, 28.139077636413276, 26.0295200496912, 25.994082182645798, 26.62092884629965, 17.496216017752886, 17.516353372484446, 17.285095751285553, 21.208440163483218, 20.721431975563362, 20.717839827140168, 23.972672586639717, 24.65822459136446, 24.803813779105738, 22.817211332110062, 21.950597902139023, 22.271116515000656, 18.80531944334507, 19.26117930561304, 19.55768683925271, 10.769169121980667, 10.513874158263206, 10.983467768877745, 18.408109820137412, 17.924877698222787, 18.00520948568979, 17.26068066060543, 17.267154973000288, 17.191144466400146, 20.339644730091095, 20.560597732663155, 20.585261538624763, 22.25495157018304, 22.002105109393597, 22.014631770551205, 19.758422061800957, 20.58064965903759, 20.934330070318538, 18.11240469167629, 18.615421923498303, 18.605880523721368, 0.9050445233782085, 0.8797251128901991, 0.34055549403031193, 4.727620625557989, 4.500442853818328, 3.6967562685410087, 11.665745869278908, 11.827671460807323, 11.221210032701492, 19.358165400723607, 19.37111426765719, 19.541819874818117, 17.231128334999084, 16.866809770464897, 17.160241723060608, 9.110796494409442, 8.917604513466358, 9.169248068705201, 21.28857935220003, 20.860890060663223, 20.429394155740738, 21.782363058378294, 21.87055179973443, 21.902389769752816, 18.48466355353594, 18.587842620909214, 18.571543227881193, 29.163879742225006, 29.377439980705574, 29.57950997104247, 12.563396200537682, 12.904393535107374, 12.640923514962196, 23.105634551495314, 23.136057060211897, 23.08897441998124, 13.693082095434264, 13.597808243085936, 13.83226410982509, 9.014000492791325, 8.909055265287549, 9.19855413089195, 13.86717417339483, 14.255028451482445, 14.413828822473675, 25.803757682442665, 26.520061818882823, 26.10053274780512, 21.42000047055383, 20.8514123459657, 20.60422033568223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15277523568554124, "mean_inference_ms": 0.700940657726033, "mean_action_processing_ms": 0.09993788318383094, "mean_env_wait_ms": 0.8046324647395461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1515852, "timesteps_this_iter": 0, "agent_timesteps_total": 4547556, "timers": {"sample_time_ms": 20760.305, "sample_throughput": 462.132, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3133.353, "learn_throughput": 3061.896, "update_time_ms": 8.911}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4584084767909077e-13, "cur_lr": 0.0005, "total_loss": 6.6767255663871765, "policy_loss": 0.0015657140247373746, "vf_loss": 6.844224333763123, "vf_explained_var": 0.11347979307174683, "kl": 0.009469850454717408, "entropy": 16.90645980834961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1515852, "num_agent_steps_sampled": 4547556, "num_steps_trained": 1515852, "num_agent_steps_trained": 4547556, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5857, "training_iteration": 158, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-36-23", "timestamp": 1706193383, "time_this_iter_s": 25.56006646156311, "time_total_s": 3180.8862388134003, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B0BAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3180.8862388134003, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 12.277777777777777, "ram_util_percent": 53.85277777777778}}
{"episode_reward_max": 116.75645865045952, "episode_reward_min": -311.18953827768564, "episode_reward_mean": 50.186686395929286, "episode_len_mean": 297.56, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -112.29213456312816}, "policy_reward_max": {"shared_policy": 39.44694735152491}, "policy_reward_mean": {"shared_policy": 16.72889546530976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.62108800560233, 71.09359674155709, 39.95166410040109, 82.35431321989742, 40.248763509094715, 76.34132035821675, 65.33193920552728, 43.83661724580452, 47.78784210048616, 27.128100984729826, 56.33699271827933, 63.63697042316198, 33.413734536617994, 53.907959901727736, 7.012131296098218, 55.45213610678911, 31.714662354439483, 57.96026073396203, 57.147904455661774, 57.57159083802253, 63.40849630534649, 44.84420833736657, 69.10122980945744, 63.42826880514622, 76.47278493875638, 84.84785395750075, 50.597669636365, 66.61021285690364, 52.32227480411527, 34.460323096252964, 88.03519139438866, 58.864397388882935, 61.42265481501815, 54.28791861794886, 74.46877636760473, 83.0745286969468, 78.64453107863665, 52.297665141522884, 62.64771196618675, 73.43471095710991, 67.03892574924974, 57.62418558821082, 32.26651104912162, 54.33819700404999, 51.718980100005865, 61.48550400137901, 66.27168845012784, 61.273401791157085, 55.33370713889596, 2.1253251302987195, 12.924819747917326, 34.71462736278772, 58.271099543198915, 51.25817982852459, 27.197649076581, 62.57886356860399, 65.55530462786554, 55.644049402326345, 88.12082969397305, 38.10871325060725, 69.33066603168845, 41.12315444834529, 27.121609888970823, 42.53603144735095, 78.4243522491306, 62.87563315220176, 73.40247190091759, 68.97539560124278, 56.94902929477392, 26.623687175102532, 54.718998871743665, 45.61953214555976, 75.6840864312835, 56.177491342648835, 24.44218887016177, 84.77744038356467, 62.671063782647224, 58.863725207746, 71.66573693975806, 48.06434806808829, 70.76861811988053, 22.270503796637044, 116.75645865045952, 61.18367468751967, 64.55297471582888, 44.11030215770003, 50.6343142390251, 2.3128973357379436, 34.90551606880035, 52.322085294872494, 52.25523678585887, 43.526848286390305, 37.37250113487242, -311.18953827768564, 62.78540084883571, 24.52032331749794, 22.731497745960922, -11.218191469088197, 71.54839623079168, 59.500616777688236], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 56, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.52781671533981, 17.116950685779244, 16.976320604483277, 23.438065151373536, 23.867572496334702, 23.787959093848855, 12.978891496857003, 13.570319474053875, 13.402453129490212, 27.308717163900525, 27.267314511040837, 27.77828154495606, 13.569667742587626, 13.114955209195614, 13.564140557311475, 25.86145626318951, 24.68871175249417, 25.791152342533067, 21.59883018831411, 21.69965740541616, 22.033451611797005, 14.816454268526286, 14.484950587153435, 14.535212390124798, 16.472465781494975, 15.287919253110886, 16.0274570658803, 9.246487855911255, 9.364670478738844, 8.516942650079727, 18.730373630921036, 18.461832279960305, 19.144786807397992, 21.1620136462152, 21.292894158512354, 21.18206261843443, 10.330152601003647, 11.700357716530561, 11.383224219083786, 17.894186578691006, 17.635421693325043, 18.378351629711688, 2.3934682731827053, 2.5258032133181842, 2.0928598095973285, 18.794120267033577, 18.24361400306225, 18.414401836693287, 10.530939941604927, 10.491977242132023, 10.691745170702532, 19.203819173077733, 19.296354713539273, 19.460086847345025, 19.161658078432083, 19.257550328969955, 18.728696048259735, 19.145851157605648, 19.339693141169846, 19.086046539247036, 21.19417877867818, 20.909191220998764, 21.305126305669546, 14.890580741067723, 14.99136910339196, 14.962258492906884, 23.131921896710992, 23.157537808874622, 22.811770103871822, 21.09447792172432, 21.05861511081457, 21.275175772607327, 25.16508539021015, 26.021629395429045, 25.28607015311718, 28.34495212432617, 28.352585540133674, 28.150316293040902, 17.001369225482136, 17.071427926576376, 16.524872484306485, 22.236579327533633, 22.360060416782886, 22.013573112587125, 17.106846416989953, 17.705797026554734, 17.50963136057058, 11.363847588499382, 12.056900134620562, 11.039575373133019, 29.074025993545845, 29.663083982964352, 29.298081417878464, 19.671776808798313, 19.360755749046803, 19.83186483103782, 20.587410422662884, 20.3672646904985, 20.467979701856763, 17.993994692961365, 18.03976174692312, 18.254162178064377, 24.1857178658247, 25.15575489588082, 25.127303605899215, 27.782999828457832, 27.15245123207569, 28.139077636413276, 26.0295200496912, 25.994082182645798, 26.62092884629965, 17.496216017752886, 17.516353372484446, 17.285095751285553, 21.208440163483218, 20.721431975563362, 20.717839827140168, 23.972672586639717, 24.65822459136446, 24.803813779105738, 22.817211332110062, 21.950597902139023, 22.271116515000656, 18.80531944334507, 19.26117930561304, 19.55768683925271, 10.769169121980667, 10.513874158263206, 10.983467768877745, 18.408109820137412, 17.924877698222787, 18.00520948568979, 17.26068066060543, 17.267154973000288, 17.191144466400146, 20.339644730091095, 20.560597732663155, 20.585261538624763, 22.25495157018304, 22.002105109393597, 22.014631770551205, 19.758422061800957, 20.58064965903759, 20.934330070318538, 18.11240469167629, 18.615421923498303, 18.605880523721368, 0.9050445233782085, 0.8797251128901991, 0.34055549403031193, 4.727620625557989, 4.500442853818328, 3.6967562685410087, 11.665745869278908, 11.827671460807323, 11.221210032701492, 19.358165400723607, 19.37111426765719, 19.541819874818117, 17.231128334999084, 16.866809770464897, 17.160241723060608, 9.110796494409442, 8.917604513466358, 9.169248068705201, 21.28857935220003, 20.860890060663223, 20.429394155740738, 21.782363058378294, 21.87055179973443, 21.902389769752816, 18.48466355353594, 18.587842620909214, 18.571543227881193, 29.163879742225006, 29.377439980705574, 29.57950997104247, 12.563396200537682, 12.904393535107374, 12.640923514962196, 23.105634551495314, 23.136057060211897, 23.08897441998124, 13.693082095434264, 13.597808243085936, 13.83226410982509, 9.014000492791325, 8.909055265287549, 9.19855413089195, 13.86717417339483, 14.255028451482445, 14.413828822473675, 25.803757682442665, 26.520061818882823, 26.10053274780512, 21.42000047055383, 20.8514123459657, 20.60422033568223, 24.216536916792393, 24.641543445177376, 24.54439153894782, 23.009801421314478, 22.87402580305934, 23.091568376868963, 18.7411888812979, 19.160982652877763, 19.046857760598257, 8.68985664844513, 8.992829996161163, 8.94100053049624, 18.18545515214403, 18.256914862742022, 18.276628856857613, 15.12628426651159, 15.07647795478502, 15.41676992426315, 25.653448451776057, 24.7151268273592, 25.315511152148247, 17.806996415058762, 19.037285308043153, 19.33320961954692, 8.040116131305695, 8.212770074605942, 8.189302664250135, 28.111260404189423, 28.20435285692413, 28.461827122451112, 20.928363579014928, 20.58521222571531, 21.157487977916986, 19.874398718277604, 19.188015247384698, 19.8013112420837, 23.36972437798977, 24.08634003251791, 24.209672529250383, 16.096368849277496, 15.96285355091095, 16.005125667899847, 23.62695788095394, 23.30597826341787, 23.83568197550872, 7.51549496253331, 7.591597763200596, 7.163411070903138, 38.873696361978844, 38.435814936955765, 39.44694735152491, 20.643149107694626, 20.74593755044043, 19.794588029384613, 21.316431765755013, 21.458780621488884, 21.777762328584984, 14.326174015800149, 15.095260235170514, 14.68886790672937, 16.96610740323861, 16.558367376526192, 17.1098394592603, 0.9686321653425694, 0.7763731926679611, 0.5678919777274132, 11.475452728569508, 11.913924443884753, 11.516138896346092, 17.923754944155604, 16.781388918558747, 17.616941432158143, 17.14785799384117, 17.577794175595045, 17.529584616422653, 14.39888609945774, 14.518598601222038, 14.609363585710526, 12.057523955901459, 12.67128764217098, 12.643689536799982, -99.33478898058335, -99.56261473397414, -112.29213456312816, 21.1310118958354, 20.457603499293327, 21.19678545370698, 7.846194202701241, 8.567105061064154, 8.107024053732545, 7.281870181361825, 7.774106087783963, 7.675521476815135, -3.8496243581175804, -3.831499218940735, -3.5370678920298815, 24.022112923169814, 23.721638967593506, 23.80464434002836, 19.58298776547113, 20.005576482663542, 19.912052529553563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529907687694747, "mean_inference_ms": 0.7017129271310516, "mean_action_processing_ms": 0.1000292815667856, "mean_env_wait_ms": 0.8052091644508528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1525446, "timesteps_this_iter": 0, "agent_timesteps_total": 4576338, "timers": {"sample_time_ms": 21040.53, "sample_throughput": 455.977, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3156.272, "learn_throughput": 3039.662, "update_time_ms": 8.962}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4584084767909077e-13, "cur_lr": 0.0005, "total_loss": 49.00995635986328, "policy_loss": 0.000573627102233909, "vf_loss": 49.177616596221924, "vf_explained_var": -0.0010136514902114868, "kl": 0.04014616436348149, "entropy": 16.823325872421265, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1525446, "num_agent_steps_sampled": 4576338, "num_steps_trained": 1525446, "num_agent_steps_trained": 4576338, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5891, "training_iteration": 159, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-36-44", "timestamp": 1706193404, "time_this_iter_s": 21.73369598388672, "time_total_s": 3202.619934797287, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3202.619934797287, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 7.4645161290322575, "ram_util_percent": 54.232258064516124}}
{"episode_reward_max": 116.75645865045952, "episode_reward_min": -311.18953827768564, "episode_reward_mean": 51.66932280540917, "episode_len_mean": 297.56, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -112.29213456312816}, "policy_reward_max": {"shared_policy": 39.44694735152491}, "policy_reward_mean": {"shared_policy": 17.22310760180305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.864397388882935, 61.42265481501815, 54.28791861794886, 74.46877636760473, 83.0745286969468, 78.64453107863665, 52.297665141522884, 62.64771196618675, 73.43471095710991, 67.03892574924974, 57.62418558821082, 32.26651104912162, 54.33819700404999, 51.718980100005865, 61.48550400137901, 66.27168845012784, 61.273401791157085, 55.33370713889596, 2.1253251302987195, 12.924819747917326, 34.71462736278772, 58.271099543198915, 51.25817982852459, 27.197649076581, 62.57886356860399, 65.55530462786554, 55.644049402326345, 88.12082969397305, 38.10871325060725, 69.33066603168845, 41.12315444834529, 27.121609888970823, 42.53603144735095, 78.4243522491306, 62.87563315220176, 73.40247190091759, 68.97539560124278, 56.94902929477392, 26.623687175102532, 54.718998871743665, 45.61953214555976, 75.6840864312835, 56.177491342648835, 24.44218887016177, 84.77744038356467, 62.671063782647224, 58.863725207746, 71.66573693975806, 48.06434806808829, 70.76861811988053, 22.270503796637044, 116.75645865045952, 61.18367468751967, 64.55297471582888, 44.11030215770003, 50.6343142390251, 2.3128973357379436, 34.90551606880035, 52.322085294872494, 52.25523678585887, 43.526848286390305, 37.37250113487242, -311.18953827768564, 62.78540084883571, 24.52032331749794, 22.731497745960922, -11.218191469088197, 71.54839623079168, 59.500616777688236, 52.67990392446518, 42.2634519152343, 44.13455673214047, 42.81726700463332, 63.834007730707526, 45.41314423456785, 53.93933775299229, 68.25632413476706, 64.38997983001173, 56.017103193327756, 73.41917668841778, 53.14038237556815, 64.99269785173237, 88.14139851869547, 71.18478865455833, 78.43156994879243, 73.83261629892512, 72.25677053630352, 68.36105676740405, 3.4640717133879377, 76.24239934794602, 84.06868121679871, 59.84381391480564, 71.29864473640916, 22.75219664775065, 66.24491797387597, 62.30008269660172, 64.64664279669522, 54.830803085118504, 58.631598172709346, 60.41235733032224], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 56, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.671776808798313, 19.360755749046803, 19.83186483103782, 20.587410422662884, 20.3672646904985, 20.467979701856763, 17.993994692961365, 18.03976174692312, 18.254162178064377, 24.1857178658247, 25.15575489588082, 25.127303605899215, 27.782999828457832, 27.15245123207569, 28.139077636413276, 26.0295200496912, 25.994082182645798, 26.62092884629965, 17.496216017752886, 17.516353372484446, 17.285095751285553, 21.208440163483218, 20.721431975563362, 20.717839827140168, 23.972672586639717, 24.65822459136446, 24.803813779105738, 22.817211332110062, 21.950597902139023, 22.271116515000656, 18.80531944334507, 19.26117930561304, 19.55768683925271, 10.769169121980667, 10.513874158263206, 10.983467768877745, 18.408109820137412, 17.924877698222787, 18.00520948568979, 17.26068066060543, 17.267154973000288, 17.191144466400146, 20.339644730091095, 20.560597732663155, 20.585261538624763, 22.25495157018304, 22.002105109393597, 22.014631770551205, 19.758422061800957, 20.58064965903759, 20.934330070318538, 18.11240469167629, 18.615421923498303, 18.605880523721368, 0.9050445233782085, 0.8797251128901991, 0.34055549403031193, 4.727620625557989, 4.500442853818328, 3.6967562685410087, 11.665745869278908, 11.827671460807323, 11.221210032701492, 19.358165400723607, 19.37111426765719, 19.541819874818117, 17.231128334999084, 16.866809770464897, 17.160241723060608, 9.110796494409442, 8.917604513466358, 9.169248068705201, 21.28857935220003, 20.860890060663223, 20.429394155740738, 21.782363058378294, 21.87055179973443, 21.902389769752816, 18.48466355353594, 18.587842620909214, 18.571543227881193, 29.163879742225006, 29.377439980705574, 29.57950997104247, 12.563396200537682, 12.904393535107374, 12.640923514962196, 23.105634551495314, 23.136057060211897, 23.08897441998124, 13.693082095434264, 13.597808243085936, 13.83226410982509, 9.014000492791325, 8.909055265287549, 9.19855413089195, 13.86717417339483, 14.255028451482445, 14.413828822473675, 25.803757682442665, 26.520061818882823, 26.10053274780512, 21.42000047055383, 20.8514123459657, 20.60422033568223, 24.216536916792393, 24.641543445177376, 24.54439153894782, 23.009801421314478, 22.87402580305934, 23.091568376868963, 18.7411888812979, 19.160982652877763, 19.046857760598257, 8.68985664844513, 8.992829996161163, 8.94100053049624, 18.18545515214403, 18.256914862742022, 18.276628856857613, 15.12628426651159, 15.07647795478502, 15.41676992426315, 25.653448451776057, 24.7151268273592, 25.315511152148247, 17.806996415058762, 19.037285308043153, 19.33320961954692, 8.040116131305695, 8.212770074605942, 8.189302664250135, 28.111260404189423, 28.20435285692413, 28.461827122451112, 20.928363579014928, 20.58521222571531, 21.157487977916986, 19.874398718277604, 19.188015247384698, 19.8013112420837, 23.36972437798977, 24.08634003251791, 24.209672529250383, 16.096368849277496, 15.96285355091095, 16.005125667899847, 23.62695788095394, 23.30597826341787, 23.83568197550872, 7.51549496253331, 7.591597763200596, 7.163411070903138, 38.873696361978844, 38.435814936955765, 39.44694735152491, 20.643149107694626, 20.74593755044043, 19.794588029384613, 21.316431765755013, 21.458780621488884, 21.777762328584984, 14.326174015800149, 15.095260235170514, 14.68886790672937, 16.96610740323861, 16.558367376526192, 17.1098394592603, 0.9686321653425694, 0.7763731926679611, 0.5678919777274132, 11.475452728569508, 11.913924443884753, 11.516138896346092, 17.923754944155604, 16.781388918558747, 17.616941432158143, 17.14785799384117, 17.577794175595045, 17.529584616422653, 14.39888609945774, 14.518598601222038, 14.609363585710526, 12.057523955901459, 12.67128764217098, 12.643689536799982, -99.33478898058335, -99.56261473397414, -112.29213456312816, 21.1310118958354, 20.457603499293327, 21.19678545370698, 7.846194202701241, 8.567105061064154, 8.107024053732545, 7.281870181361825, 7.774106087783963, 7.675521476815135, -3.8496243581175804, -3.831499218940735, -3.5370678920298815, 24.022112923169814, 23.721638967593506, 23.80464434002836, 19.58298776547113, 20.005576482663542, 19.912052529553563, 17.16343680024147, 17.71584163978696, 17.80062548443675, 14.16487995783487, 14.121238796661288, 13.97733316073814, 14.340956469376877, 14.868612212439373, 14.924988050324217, 14.300163101404905, 14.422926016384736, 14.094177886843681, 20.89985777437687, 21.40608298406005, 21.528066972270608, 15.278874854246766, 15.53435759122172, 14.599911789099366, 17.632817454636097, 18.108817484229803, 18.197702814126387, 22.816860668361187, 22.52100358903408, 22.918459877371788, 21.57565062865615, 21.153001338243484, 21.661327863112092, 18.82919962766269, 18.469283173481614, 18.718620392183453, 24.43377693307896, 24.495973560338214, 24.489426195000604, 17.684469763189554, 17.703757137060165, 17.752155475318432, 21.632882595062256, 21.911094734445214, 21.448720522224903, 29.530401870647125, 29.386685703570635, 29.224310944477708, 23.327846656242997, 23.683900291721017, 24.17304170659432, 25.64137054483095, 26.486373039583356, 26.303826364378125, 24.588548717399433, 24.723621156842754, 24.52044642468293, 24.057409934699535, 24.214544765651226, 23.98481583595276, 22.605280126134545, 22.908990974227578, 22.846785667041928, 1.224646779398114, 1.1640106017390792, 1.0754143322507446, 25.307404874513537, 25.461467393363506, 25.473527080068976, 27.757544820507363, 28.256929181826607, 28.05420721446474, 20.14573161428173, 19.9098016594847, 19.788280641039208, 23.64945367226997, 23.62493176261583, 24.024259301523358, 7.501578452686459, 7.8085899979147655, 7.442028197149426, 22.013773190478474, 22.13956097016731, 22.091583813230187, 20.177458475033433, 21.037249673778803, 21.085374547789485, 21.6272151445349, 21.4592648645242, 21.560162787636116, 18.14159048597017, 18.17641312132278, 18.512799477825553, 19.915925713256, 19.750922556966543, 18.9647499024868, 20.066466490427644, 20.307727838555962, 20.03816300133863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311516385668378, "mean_inference_ms": 0.7025622482664605, "mean_action_processing_ms": 0.10009172416453987, "mean_env_wait_ms": 0.8058327407465906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1535040, "timesteps_this_iter": 0, "agent_timesteps_total": 4605120, "timers": {"sample_time_ms": 21209.936, "sample_throughput": 452.335, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3143.766, "learn_throughput": 3051.754, "update_time_ms": 8.714}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.687612715186362e-13, "cur_lr": 0.0005, "total_loss": 8.264224767684937, "policy_loss": -0.00045757893323017385, "vf_loss": 8.43381005525589, "vf_explained_var": -0.13741809129714966, "kl": 0.00472983870737142, "entropy": 16.912738800048828, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1535040, "num_agent_steps_sampled": 4605120, "num_steps_trained": 1535040, "num_agent_steps_trained": 4605120, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5922, "training_iteration": 160, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-37-05", "timestamp": 1706193425, "time_this_iter_s": 20.871498346328735, "time_total_s": 3223.4914331436157, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419E00D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3223.4914331436157, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 7.643333333333333, "ram_util_percent": 54.27333333333334}}
{"episode_reward_max": 116.75645865045952, "episode_reward_min": -311.18953827768564, "episode_reward_mean": 46.12095905371534, "episode_len_mean": 292.62, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -112.29213456312816}, "policy_reward_max": {"shared_policy": 39.44694735152491}, "policy_reward_mean": {"shared_policy": 15.373653017905108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.87563315220176, 73.40247190091759, 68.97539560124278, 56.94902929477392, 26.623687175102532, 54.718998871743665, 45.61953214555976, 75.6840864312835, 56.177491342648835, 24.44218887016177, 84.77744038356467, 62.671063782647224, 58.863725207746, 71.66573693975806, 48.06434806808829, 70.76861811988053, 22.270503796637044, 116.75645865045952, 61.18367468751967, 64.55297471582888, 44.11030215770003, 50.6343142390251, 2.3128973357379436, 34.90551606880035, 52.322085294872494, 52.25523678585887, 43.526848286390305, 37.37250113487242, -311.18953827768564, 62.78540084883571, 24.52032331749794, 22.731497745960922, -11.218191469088197, 71.54839623079168, 59.500616777688236, 52.67990392446518, 42.2634519152343, 44.13455673214047, 42.81726700463332, 63.834007730707526, 45.41314423456785, 53.93933775299229, 68.25632413476706, 64.38997983001173, 56.017103193327756, 73.41917668841778, 53.14038237556815, 64.99269785173237, 88.14139851869547, 71.18478865455833, 78.43156994879243, 73.83261629892512, 72.25677053630352, 68.36105676740405, 3.4640717133879377, 76.24239934794602, 84.06868121679871, 59.84381391480564, 71.29864473640916, 22.75219664775065, 66.24491797387597, 62.30008269660172, 64.64664279669522, 54.830803085118504, 58.631598172709346, 60.41235733032224, 70.51377526856957, 57.25873234122989, 41.72641062363982, 30.583388522267327, -310.37820644304156, 53.73985447362064, 69.57129183225332, 76.7365481429733, 81.52068258635698, 46.102222905959934, 79.3125187791884, 74.24429299496114, 41.28136098384856, 83.16336886025964, 38.87490767985582, 57.02533863950521, 55.56271813996133, 67.58545542135835, 73.8639046596363, -305.302576251328, 65.2095944955945, 57.837295055389376, 47.30286719650029, 60.87117636576295, 88.681422136724, 46.79143599420786, 66.0719459056854, 57.16800001822412, 62.43508113920686, 26.96543787792325, 69.16130293160676, 66.44353510439394, 55.2386097088456, 53.529201939702034], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 56, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 52, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.42000047055383, 20.8514123459657, 20.60422033568223, 24.216536916792393, 24.641543445177376, 24.54439153894782, 23.009801421314478, 22.87402580305934, 23.091568376868963, 18.7411888812979, 19.160982652877763, 19.046857760598257, 8.68985664844513, 8.992829996161163, 8.94100053049624, 18.18545515214403, 18.256914862742022, 18.276628856857613, 15.12628426651159, 15.07647795478502, 15.41676992426315, 25.653448451776057, 24.7151268273592, 25.315511152148247, 17.806996415058762, 19.037285308043153, 19.33320961954692, 8.040116131305695, 8.212770074605942, 8.189302664250135, 28.111260404189423, 28.20435285692413, 28.461827122451112, 20.928363579014928, 20.58521222571531, 21.157487977916986, 19.874398718277604, 19.188015247384698, 19.8013112420837, 23.36972437798977, 24.08634003251791, 24.209672529250383, 16.096368849277496, 15.96285355091095, 16.005125667899847, 23.62695788095394, 23.30597826341787, 23.83568197550872, 7.51549496253331, 7.591597763200596, 7.163411070903138, 38.873696361978844, 38.435814936955765, 39.44694735152491, 20.643149107694626, 20.74593755044043, 19.794588029384613, 21.316431765755013, 21.458780621488884, 21.777762328584984, 14.326174015800149, 15.095260235170514, 14.68886790672937, 16.96610740323861, 16.558367376526192, 17.1098394592603, 0.9686321653425694, 0.7763731926679611, 0.5678919777274132, 11.475452728569508, 11.913924443884753, 11.516138896346092, 17.923754944155604, 16.781388918558747, 17.616941432158143, 17.14785799384117, 17.577794175595045, 17.529584616422653, 14.39888609945774, 14.518598601222038, 14.609363585710526, 12.057523955901459, 12.67128764217098, 12.643689536799982, -99.33478898058335, -99.56261473397414, -112.29213456312816, 21.1310118958354, 20.457603499293327, 21.19678545370698, 7.846194202701241, 8.567105061064154, 8.107024053732545, 7.281870181361825, 7.774106087783963, 7.675521476815135, -3.8496243581175804, -3.831499218940735, -3.5370678920298815, 24.022112923169814, 23.721638967593506, 23.80464434002836, 19.58298776547113, 20.005576482663542, 19.912052529553563, 17.16343680024147, 17.71584163978696, 17.80062548443675, 14.16487995783487, 14.121238796661288, 13.97733316073814, 14.340956469376877, 14.868612212439373, 14.924988050324217, 14.300163101404905, 14.422926016384736, 14.094177886843681, 20.89985777437687, 21.40608298406005, 21.528066972270608, 15.278874854246766, 15.53435759122172, 14.599911789099366, 17.632817454636097, 18.108817484229803, 18.197702814126387, 22.816860668361187, 22.52100358903408, 22.918459877371788, 21.57565062865615, 21.153001338243484, 21.661327863112092, 18.82919962766269, 18.469283173481614, 18.718620392183453, 24.43377693307896, 24.495973560338214, 24.489426195000604, 17.684469763189554, 17.703757137060165, 17.752155475318432, 21.632882595062256, 21.911094734445214, 21.448720522224903, 29.530401870647125, 29.386685703570635, 29.224310944477708, 23.327846656242997, 23.683900291721017, 24.17304170659432, 25.64137054483095, 26.486373039583356, 26.303826364378125, 24.588548717399433, 24.723621156842754, 24.52044642468293, 24.057409934699535, 24.214544765651226, 23.98481583595276, 22.605280126134545, 22.908990974227578, 22.846785667041928, 1.224646779398114, 1.1640106017390792, 1.0754143322507446, 25.307404874513537, 25.461467393363506, 25.473527080068976, 27.757544820507363, 28.256929181826607, 28.05420721446474, 20.14573161428173, 19.9098016594847, 19.788280641039208, 23.64945367226997, 23.62493176261583, 24.024259301523358, 7.501578452686459, 7.8085899979147655, 7.442028197149426, 22.013773190478474, 22.13956097016731, 22.091583813230187, 20.177458475033433, 21.037249673778803, 21.085374547789485, 21.6272151445349, 21.4592648645242, 21.560162787636116, 18.14159048597017, 18.17641312132278, 18.512799477825553, 19.915925713256, 19.750922556966543, 18.9647499024868, 20.066466490427644, 20.307727838555962, 20.03816300133863, 23.576288978879646, 23.494186551620558, 23.44329973806937, 18.914877543846757, 19.288951153556496, 19.054903643826634, 13.715445794165134, 14.014307077974081, 13.996657751500607, 9.97379072507222, 10.297675249477223, 10.311922547717884, -107.82527911663055, -102.16155904531479, -100.39136828109622, 18.024493736525372, 18.01042754327257, 17.704933193822697, 23.04077011843522, 23.237360346441463, 23.29316136737664, 25.815164712412894, 25.37273872892061, 25.5486447016398, 26.96901572992404, 27.41652446923156, 27.135142387201384, 15.273273151367903, 15.446202069986612, 15.38274768460542, 26.630670260638, 26.485626697540283, 26.196221821010113, 24.82236124947667, 24.78504100255668, 24.63689074292779, 13.872080271442726, 14.0097947170337, 13.399485995372132, 27.446244594951466, 27.86386074808736, 27.85326351722081, 12.880783900618553, 12.955104932188988, 13.039018847048283, 18.608176857233047, 19.10424318164587, 19.31291860062629, 18.661746830369026, 18.390553491810948, 18.51041781778136, 22.220907360315323, 22.766858860850334, 22.59768920019269, 24.854464868394032, 24.5492226978143, 24.46021709342797, -97.00471180677414, -96.4084014967084, -111.88946294784546, 21.991087563335896, 21.203656673431396, 22.01485025882721, 19.263409080604703, 19.2595397333304, 19.314346241454274, 15.552509074409798, 15.889636372526482, 15.860721749564007, 20.148044638335705, 20.306567549705505, 20.41656417772174, 29.965664111077785, 29.8547725379467, 28.86098548769951, 15.924788884818554, 15.309554621577263, 15.557092487812042, 22.0442896063129, 21.977403248349816, 22.05025305102268, 18.999020352959633, 18.882004849612713, 19.286974815651774, 20.663301120201737, 20.86671336988607, 20.90506664911905, 9.298291880637407, 8.821353748440742, 8.8457922488451, 23.481767134120062, 22.205815215905503, 23.47372058158119, 21.909243767460183, 22.31223691751559, 22.22205441941817, 18.47547862802942, 18.290314396222428, 18.472816684593752, 18.050898775458336, 17.728600069880486, 17.749703094363213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15324011464336088, "mean_inference_ms": 0.7028622855270465, "mean_action_processing_ms": 0.10007378229208908, "mean_env_wait_ms": 0.8059733388450909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1544634, "timesteps_this_iter": 0, "agent_timesteps_total": 4633902, "timers": {"sample_time_ms": 20695.08, "sample_throughput": 463.588, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3145.656, "learn_throughput": 3049.92, "update_time_ms": 8.766}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.843806357593181e-13, "cur_lr": 0.0005, "total_loss": 87.73040199279785, "policy_loss": -0.0020468833812392617, "vf_loss": 87.90351295471191, "vf_explained_var": -0.0347277969121933, "kl": 0.020019312651371246, "entropy": 17.106416940689087, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1544634, "num_agent_steps_sampled": 4633902, "num_steps_trained": 1544634, "num_agent_steps_trained": 4633902, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5956, "training_iteration": 161, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-37-26", "timestamp": 1706193446, "time_this_iter_s": 20.623128652572632, "time_total_s": 3244.1145617961884, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41BE9DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3244.1145617961884, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 8.768965517241378, "ram_util_percent": 54.05862068965517}}
{"episode_reward_max": 97.25648274365811, "episode_reward_min": -310.37820644304156, "episode_reward_mean": 48.208901310605505, "episode_len_mean": 295.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -111.88946294784546}, "policy_reward_max": {"shared_policy": 32.67179997855176}, "policy_reward_mean": {"shared_policy": 16.06963377020183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.218191469088197, 71.54839623079168, 59.500616777688236, 52.67990392446518, 42.2634519152343, 44.13455673214047, 42.81726700463332, 63.834007730707526, 45.41314423456785, 53.93933775299229, 68.25632413476706, 64.38997983001173, 56.017103193327756, 73.41917668841778, 53.14038237556815, 64.99269785173237, 88.14139851869547, 71.18478865455833, 78.43156994879243, 73.83261629892512, 72.25677053630352, 68.36105676740405, 3.4640717133879377, 76.24239934794602, 84.06868121679871, 59.84381391480564, 71.29864473640916, 22.75219664775065, 66.24491797387597, 62.30008269660172, 64.64664279669522, 54.830803085118504, 58.631598172709346, 60.41235733032224, 70.51377526856957, 57.25873234122989, 41.72641062363982, 30.583388522267327, -310.37820644304156, 53.73985447362064, 69.57129183225332, 76.7365481429733, 81.52068258635698, 46.102222905959934, 79.3125187791884, 74.24429299496114, 41.28136098384856, 83.16336886025964, 38.87490767985582, 57.02533863950521, 55.56271813996133, 67.58545542135835, 73.8639046596363, -305.302576251328, 65.2095944955945, 57.837295055389376, 47.30286719650029, 60.87117636576295, 88.681422136724, 46.79143599420786, 66.0719459056854, 57.16800001822412, 62.43508113920686, 26.96543787792325, 69.16130293160676, 66.44353510439394, 55.2386097088456, 53.529201939702034, 62.63052769750354, 54.26753688277675, 83.73885902017352, 55.22146843001245, 68.99943576403894, 43.85748301446438, 29.869515256956205, 66.69521125778554, 97.25648274365811, 62.038994776085005, 63.24465940520166, 59.88718069344756, 40.120535492431344, 37.51864057127385, 30.808265810832367, 62.89811998605725, 69.63297235500066, 59.938989298418136, 61.67311829701063, 63.725632055895375, 40.67792852670388, 51.11631722934544, 56.56374299823074, 56.57376836007461, 54.46333332359791, 43.08147893054411, -206.95653556287292, 40.50969797745347, 78.83042520564047, 28.41948743537067, 48.22129680030048, 66.60009973123667], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 52, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 294, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [-3.8496243581175804, -3.831499218940735, -3.5370678920298815, 24.022112923169814, 23.721638967593506, 23.80464434002836, 19.58298776547113, 20.005576482663542, 19.912052529553563, 17.16343680024147, 17.71584163978696, 17.80062548443675, 14.16487995783487, 14.121238796661288, 13.97733316073814, 14.340956469376877, 14.868612212439373, 14.924988050324217, 14.300163101404905, 14.422926016384736, 14.094177886843681, 20.89985777437687, 21.40608298406005, 21.528066972270608, 15.278874854246766, 15.53435759122172, 14.599911789099366, 17.632817454636097, 18.108817484229803, 18.197702814126387, 22.816860668361187, 22.52100358903408, 22.918459877371788, 21.57565062865615, 21.153001338243484, 21.661327863112092, 18.82919962766269, 18.469283173481614, 18.718620392183453, 24.43377693307896, 24.495973560338214, 24.489426195000604, 17.684469763189554, 17.703757137060165, 17.752155475318432, 21.632882595062256, 21.911094734445214, 21.448720522224903, 29.530401870647125, 29.386685703570635, 29.224310944477708, 23.327846656242997, 23.683900291721017, 24.17304170659432, 25.64137054483095, 26.486373039583356, 26.303826364378125, 24.588548717399433, 24.723621156842754, 24.52044642468293, 24.057409934699535, 24.214544765651226, 23.98481583595276, 22.605280126134545, 22.908990974227578, 22.846785667041928, 1.224646779398114, 1.1640106017390792, 1.0754143322507446, 25.307404874513537, 25.461467393363506, 25.473527080068976, 27.757544820507363, 28.256929181826607, 28.05420721446474, 20.14573161428173, 19.9098016594847, 19.788280641039208, 23.64945367226997, 23.62493176261583, 24.024259301523358, 7.501578452686459, 7.8085899979147655, 7.442028197149426, 22.013773190478474, 22.13956097016731, 22.091583813230187, 20.177458475033433, 21.037249673778803, 21.085374547789485, 21.6272151445349, 21.4592648645242, 21.560162787636116, 18.14159048597017, 18.17641312132278, 18.512799477825553, 19.915925713256, 19.750922556966543, 18.9647499024868, 20.066466490427644, 20.307727838555962, 20.03816300133863, 23.576288978879646, 23.494186551620558, 23.44329973806937, 18.914877543846757, 19.288951153556496, 19.054903643826634, 13.715445794165134, 14.014307077974081, 13.996657751500607, 9.97379072507222, 10.297675249477223, 10.311922547717884, -107.82527911663055, -102.16155904531479, -100.39136828109622, 18.024493736525372, 18.01042754327257, 17.704933193822697, 23.04077011843522, 23.237360346441463, 23.29316136737664, 25.815164712412894, 25.37273872892061, 25.5486447016398, 26.96901572992404, 27.41652446923156, 27.135142387201384, 15.273273151367903, 15.446202069986612, 15.38274768460542, 26.630670260638, 26.485626697540283, 26.196221821010113, 24.82236124947667, 24.78504100255668, 24.63689074292779, 13.872080271442726, 14.0097947170337, 13.399485995372132, 27.446244594951466, 27.86386074808736, 27.85326351722081, 12.880783900618553, 12.955104932188988, 13.039018847048283, 18.608176857233047, 19.10424318164587, 19.31291860062629, 18.661746830369026, 18.390553491810948, 18.51041781778136, 22.220907360315323, 22.766858860850334, 22.59768920019269, 24.854464868394032, 24.5492226978143, 24.46021709342797, -97.00471180677414, -96.4084014967084, -111.88946294784546, 21.991087563335896, 21.203656673431396, 22.01485025882721, 19.263409080604703, 19.2595397333304, 19.314346241454274, 15.552509074409798, 15.889636372526482, 15.860721749564007, 20.148044638335705, 20.306567549705505, 20.41656417772174, 29.965664111077785, 29.8547725379467, 28.86098548769951, 15.924788884818554, 15.309554621577263, 15.557092487812042, 22.0442896063129, 21.977403248349816, 22.05025305102268, 18.999020352959633, 18.882004849612713, 19.286974815651774, 20.663301120201737, 20.86671336988607, 20.90506664911905, 9.298291880637407, 8.821353748440742, 8.8457922488451, 23.481767134120062, 22.205815215905503, 23.47372058158119, 21.909243767460183, 22.31223691751559, 22.22205441941817, 18.47547862802942, 18.290314396222428, 18.472816684593752, 18.050898775458336, 17.728600069880486, 17.749703094363213, 20.621498788396508, 20.95265833909312, 21.05637057001391, 18.082786483069256, 17.69075298806031, 18.493997411647186, 28.18778311337033, 27.423798734943063, 28.12727717186013, 18.645953969409064, 18.184323241313294, 18.391191219290093, 23.012697149068117, 22.89255366846919, 23.094184946501628, 14.711804796010256, 14.69314980879426, 14.452528409659863, 10.06759863470991, 10.197577673320964, 9.604338948925331, 22.27071123135586, 22.26895805386205, 22.155541972567633, 32.35023297121127, 32.67179997855176, 32.23444979389508, 20.358741482098893, 20.93174519327779, 20.74850810070832, 20.784387057026223, 21.54708308105667, 20.913189267118767, 20.23451072225967, 19.904660666982323, 19.748009304205567, 13.177877376476914, 13.620467985204101, 13.322190130750329, 12.482830691461757, 12.480106600870684, 12.555703278941408, 9.990583327909306, 10.305435327192143, 10.512247155730918, 21.12687515715757, 20.61654123167196, 21.154703597227723, 23.442313887489334, 23.14599647869666, 23.044661988814667, 19.92664788166681, 20.23738828736046, 19.774953129390866, 20.572295776257903, 20.474493178228528, 20.6263293425242, 21.247687714795262, 21.005195791522652, 21.47274854957746, 13.960216108217224, 13.84286919857064, 12.874843219916016, 16.96890176832676, 16.84144066274166, 17.30597479827702, 18.99531737342477, 19.083390041429084, 18.485035583376884, 18.844460904598236, 19.05590878939256, 18.673398666083813, 18.43503475934267, 18.23682115226984, 17.791477411985397, 14.431015374138951, 14.482311417814344, 14.168152138590813, -79.63583381970724, -63.80331346889338, -63.51738827427229, 12.956217631697655, 13.862326342612505, 13.69115400314331, 26.439219462374837, 25.806824351350457, 26.584381391915173, 9.609968443711594, 9.189849724372223, 9.619669267286852, 16.461586518213153, 15.903790950775146, 15.85591933131218, 22.255700244257838, 22.23296075562635, 22.11143873135248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15326406059638173, "mean_inference_ms": 0.7031610285193852, "mean_action_processing_ms": 0.10011207195832673, "mean_env_wait_ms": 0.8062255493317749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1554228, "timesteps_this_iter": 0, "agent_timesteps_total": 4662684, "timers": {"sample_time_ms": 20743.102, "sample_throughput": 462.515, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3155.778, "learn_throughput": 3040.138, "update_time_ms": 9.073}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7657095363897713e-13, "cur_lr": 0.0005, "total_loss": 38.586710929870605, "policy_loss": -0.00022799791232563926, "vf_loss": 38.75875997543335, "vf_explained_var": 0.27296511083841324, "kl": 0.009375161098678537, "entropy": 17.18228578567505, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1554228, "num_agent_steps_sampled": 4662684, "num_steps_trained": 1554228, "num_agent_steps_trained": 4662684, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5988, "training_iteration": 162, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-37-46", "timestamp": 1706193466, "time_this_iter_s": 20.39963698387146, "time_total_s": 3264.51419878006, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB8E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3264.51419878006, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 7.293103448275861, "ram_util_percent": 53.1896551724138}}
{"episode_reward_max": 97.25648274365811, "episode_reward_min": -310.37820644304156, "episode_reward_mean": 46.59869456969078, "episode_len_mean": 295.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -111.88946294784546}, "policy_reward_max": {"shared_policy": 32.67179997855176}, "policy_reward_mean": {"shared_policy": 15.53289818989692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.51377526856957, 57.25873234122989, 41.72641062363982, 30.583388522267327, -310.37820644304156, 53.73985447362064, 69.57129183225332, 76.7365481429733, 81.52068258635698, 46.102222905959934, 79.3125187791884, 74.24429299496114, 41.28136098384856, 83.16336886025964, 38.87490767985582, 57.02533863950521, 55.56271813996133, 67.58545542135835, 73.8639046596363, -305.302576251328, 65.2095944955945, 57.837295055389376, 47.30286719650029, 60.87117636576295, 88.681422136724, 46.79143599420786, 66.0719459056854, 57.16800001822412, 62.43508113920686, 26.96543787792325, 69.16130293160676, 66.44353510439394, 55.2386097088456, 53.529201939702034, 62.63052769750354, 54.26753688277675, 83.73885902017352, 55.22146843001245, 68.99943576403894, 43.85748301446438, 29.869515256956205, 66.69521125778554, 97.25648274365811, 62.038994776085005, 63.24465940520166, 59.88718069344756, 40.120535492431344, 37.51864057127385, 30.808265810832367, 62.89811998605725, 69.63297235500066, 59.938989298418136, 61.67311829701063, 63.725632055895375, 40.67792852670388, 51.11631722934544, 56.56374299823074, 56.57376836007461, 54.46333332359791, 43.08147893054411, -206.95653556287292, 40.50969797745347, 78.83042520564047, 28.41948743537067, 48.22129680030048, 66.60009973123667, 64.47234559361821, 40.030142111703725, 47.958970464766026, 25.551976758986697, 71.30086470767856, 67.74896769225597, 19.344070480205104, 42.00950603280215, 55.35853584483266, 78.27990410849449, 56.84043652564286, 83.89134573936462, 61.59840273670849, 43.01499905064702, 49.37871635332702, 53.45197849906978, 62.593663597945095, 46.57940968265757, 59.593149363994584, 61.479751735925646, 64.82763934880492, 66.68916403409094, 75.92083991505204, 69.189366503153, 53.856782832182944, 5.55754429101944, 63.47083715070036, 62.78343265631699, 39.41894013644195, 57.095567893236876, 48.42400987073776, 29.64133616257456, 68.55484137125313, 25.144451927393646], "episode_lengths": [300, 300, 300, 300, 52, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 54, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 294, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.576288978879646, 23.494186551620558, 23.44329973806937, 18.914877543846757, 19.288951153556496, 19.054903643826634, 13.715445794165134, 14.014307077974081, 13.996657751500607, 9.97379072507222, 10.297675249477223, 10.311922547717884, -107.82527911663055, -102.16155904531479, -100.39136828109622, 18.024493736525372, 18.01042754327257, 17.704933193822697, 23.04077011843522, 23.237360346441463, 23.29316136737664, 25.815164712412894, 25.37273872892061, 25.5486447016398, 26.96901572992404, 27.41652446923156, 27.135142387201384, 15.273273151367903, 15.446202069986612, 15.38274768460542, 26.630670260638, 26.485626697540283, 26.196221821010113, 24.82236124947667, 24.78504100255668, 24.63689074292779, 13.872080271442726, 14.0097947170337, 13.399485995372132, 27.446244594951466, 27.86386074808736, 27.85326351722081, 12.880783900618553, 12.955104932188988, 13.039018847048283, 18.608176857233047, 19.10424318164587, 19.31291860062629, 18.661746830369026, 18.390553491810948, 18.51041781778136, 22.220907360315323, 22.766858860850334, 22.59768920019269, 24.854464868394032, 24.5492226978143, 24.46021709342797, -97.00471180677414, -96.4084014967084, -111.88946294784546, 21.991087563335896, 21.203656673431396, 22.01485025882721, 19.263409080604703, 19.2595397333304, 19.314346241454274, 15.552509074409798, 15.889636372526482, 15.860721749564007, 20.148044638335705, 20.306567549705505, 20.41656417772174, 29.965664111077785, 29.8547725379467, 28.86098548769951, 15.924788884818554, 15.309554621577263, 15.557092487812042, 22.0442896063129, 21.977403248349816, 22.05025305102268, 18.999020352959633, 18.882004849612713, 19.286974815651774, 20.663301120201737, 20.86671336988607, 20.90506664911905, 9.298291880637407, 8.821353748440742, 8.8457922488451, 23.481767134120062, 22.205815215905503, 23.47372058158119, 21.909243767460183, 22.31223691751559, 22.22205441941817, 18.47547862802942, 18.290314396222428, 18.472816684593752, 18.050898775458336, 17.728600069880486, 17.749703094363213, 20.621498788396508, 20.95265833909312, 21.05637057001391, 18.082786483069256, 17.69075298806031, 18.493997411647186, 28.18778311337033, 27.423798734943063, 28.12727717186013, 18.645953969409064, 18.184323241313294, 18.391191219290093, 23.012697149068117, 22.89255366846919, 23.094184946501628, 14.711804796010256, 14.69314980879426, 14.452528409659863, 10.06759863470991, 10.197577673320964, 9.604338948925331, 22.27071123135586, 22.26895805386205, 22.155541972567633, 32.35023297121127, 32.67179997855176, 32.23444979389508, 20.358741482098893, 20.93174519327779, 20.74850810070832, 20.784387057026223, 21.54708308105667, 20.913189267118767, 20.23451072225967, 19.904660666982323, 19.748009304205567, 13.177877376476914, 13.620467985204101, 13.322190130750329, 12.482830691461757, 12.480106600870684, 12.555703278941408, 9.990583327909306, 10.305435327192143, 10.512247155730918, 21.12687515715757, 20.61654123167196, 21.154703597227723, 23.442313887489334, 23.14599647869666, 23.044661988814667, 19.92664788166681, 20.23738828736046, 19.774953129390866, 20.572295776257903, 20.474493178228528, 20.6263293425242, 21.247687714795262, 21.005195791522652, 21.47274854957746, 13.960216108217224, 13.84286919857064, 12.874843219916016, 16.96890176832676, 16.84144066274166, 17.30597479827702, 18.99531737342477, 19.083390041429084, 18.485035583376884, 18.844460904598236, 19.05590878939256, 18.673398666083813, 18.43503475934267, 18.23682115226984, 17.791477411985397, 14.431015374138951, 14.482311417814344, 14.168152138590813, -79.63583381970724, -63.80331346889338, -63.51738827427229, 12.956217631697655, 13.862326342612505, 13.69115400314331, 26.439219462374837, 25.806824351350457, 26.584381391915173, 9.609968443711594, 9.189849724372223, 9.619669267286852, 16.461586518213153, 15.903790950775146, 15.85591933131218, 22.255700244257838, 22.23296075562635, 22.11143873135248, 21.78571122939077, 21.28682704766591, 21.399807316561535, 13.49446414380023, 13.524444218414516, 13.01123374948898, 16.173396341502666, 16.05061863362789, 15.734955489635468, 8.430244659384087, 8.508621004720524, 8.613111094882086, 23.39745533466339, 24.02411912381649, 23.879290249198675, 22.66547560505569, 22.43669044971466, 22.646801637485623, 6.085804929335907, 6.7118348836277875, 6.54643066724141, 13.868002918859318, 14.113669390169278, 14.027833723773554, 18.32881899923086, 18.72309960797429, 18.306617237627506, 25.598486239711434, 26.246973822514207, 26.43444404626885, 18.919088204701737, 18.889158961673573, 19.032189359267548, 28.28815734386444, 28.10820011794567, 27.494988277554512, 20.36329104254642, 20.477050902942807, 20.758060791219265, 14.200311154127121, 14.871892724186182, 13.942795172333717, 16.724549826545015, 15.940774997075394, 16.713391529706612, 17.897973709429294, 17.735882221410662, 17.818122568229825, 20.952934209878237, 20.596396724383027, 21.044332663683832, 15.398525178432465, 15.338189519941807, 15.842694984283298, 19.939077780892447, 19.682804500063256, 19.97126708303888, 19.443139324585587, 21.053058991829545, 20.983553419510514, 21.26845362285772, 21.797881859044224, 21.761303866902978, 21.981364965438843, 22.624091587029397, 22.083707481622696, 25.14908180882533, 25.278795820971325, 25.492962285255388, 23.33771616080776, 22.959811329841614, 22.891839012503624, 17.640096187591553, 18.127182341180742, 18.08950430341065, 1.931674301624298, 2.0403454154729843, 1.5855245739221573, 21.084223876396806, 21.761342629479856, 20.6252706448237, 21.015991370814533, 20.726121890048177, 21.04131939545428, 13.122974210729197, 12.884800662597016, 13.411165263115734, 18.925751842558384, 19.150450196117163, 19.01936585456133, 16.360325193653495, 15.985057237247617, 16.07862743983665, 9.663323211173207, 10.142886727737874, 9.83512622366348, 22.811779618263245, 22.9830366615206, 22.760025091469288, 8.330760988096387, 8.500296882043273, 8.313394057253987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15329975602217544, "mean_inference_ms": 0.7032520481878788, "mean_action_processing_ms": 0.10007622795800784, "mean_env_wait_ms": 0.8062336614387128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1563822, "timesteps_this_iter": 0, "agent_timesteps_total": 4691466, "timers": {"sample_time_ms": 20881.451, "sample_throughput": 459.451, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3179.538, "learn_throughput": 3017.42, "update_time_ms": 9.03}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7657095363897713e-13, "cur_lr": 0.0005, "total_loss": 5.590791821479797, "policy_loss": -0.00030782446215460446, "vf_loss": 5.761794865131378, "vf_explained_var": 0.13198734819889069, "kl": 0.006711787282496702, "entropy": 17.069531202316284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1563822, "num_agent_steps_sampled": 4691466, "num_steps_trained": 1563822, "num_agent_steps_trained": 4691466, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6022, "training_iteration": 163, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-38-07", "timestamp": 1706193487, "time_this_iter_s": 20.685941457748413, "time_total_s": 3285.2001402378082, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02064EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3285.2001402378082, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 7.241379310344828, "ram_util_percent": 53.08275862068965}}
{"episode_reward_max": 97.25648274365811, "episode_reward_min": -254.48702672123915, "episode_reward_mean": 48.943705567830385, "episode_len_mean": 299.66, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -94.87469144662222}, "policy_reward_max": {"shared_policy": 32.67179997855176}, "policy_reward_mean": {"shared_policy": 16.314568522610127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.96543787792325, 69.16130293160676, 66.44353510439394, 55.2386097088456, 53.529201939702034, 62.63052769750354, 54.26753688277675, 83.73885902017352, 55.22146843001245, 68.99943576403894, 43.85748301446438, 29.869515256956205, 66.69521125778554, 97.25648274365811, 62.038994776085005, 63.24465940520166, 59.88718069344756, 40.120535492431344, 37.51864057127385, 30.808265810832367, 62.89811998605725, 69.63297235500066, 59.938989298418136, 61.67311829701063, 63.725632055895375, 40.67792852670388, 51.11631722934544, 56.56374299823074, 56.57376836007461, 54.46333332359791, 43.08147893054411, -206.95653556287292, 40.50969797745347, 78.83042520564047, 28.41948743537067, 48.22129680030048, 66.60009973123667, 64.47234559361821, 40.030142111703725, 47.958970464766026, 25.551976758986697, 71.30086470767856, 67.74896769225597, 19.344070480205104, 42.00950603280215, 55.35853584483266, 78.27990410849449, 56.84043652564286, 83.89134573936462, 61.59840273670849, 43.01499905064702, 49.37871635332702, 53.45197849906978, 62.593663597945095, 46.57940968265757, 59.593149363994584, 61.479751735925646, 64.82763934880492, 66.68916403409094, 75.92083991505204, 69.189366503153, 53.856782832182944, 5.55754429101944, 63.47083715070036, 62.78343265631699, 39.41894013644195, 57.095567893236876, 48.42400987073776, 29.64133616257456, 68.55484137125313, 25.144451927393646, 59.19714253023264, 67.84649834502488, 18.23772536404431, 46.442551873624296, 52.377925228327484, 38.498387120664106, 55.0117688551545, 40.77967694029209, 62.89358854480088, 55.74327862588689, 58.86877010995519, 19.160004477947922, 37.27618345245716, 55.153672956861556, 63.11832614429292, 64.21567794680594, -254.48702672123915, 53.61065720114857, 33.88522436097263, 56.37203608453271, 71.9570865035057, 68.12914675590581, 79.21386271342632, 77.95632226765154, 42.40164548158643, 46.9680464826524, 81.78543602675197, 63.355874285101876, 53.88641832396385], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 294, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 272, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.298291880637407, 8.821353748440742, 8.8457922488451, 23.481767134120062, 22.205815215905503, 23.47372058158119, 21.909243767460183, 22.31223691751559, 22.22205441941817, 18.47547862802942, 18.290314396222428, 18.472816684593752, 18.050898775458336, 17.728600069880486, 17.749703094363213, 20.621498788396508, 20.95265833909312, 21.05637057001391, 18.082786483069256, 17.69075298806031, 18.493997411647186, 28.18778311337033, 27.423798734943063, 28.12727717186013, 18.645953969409064, 18.184323241313294, 18.391191219290093, 23.012697149068117, 22.89255366846919, 23.094184946501628, 14.711804796010256, 14.69314980879426, 14.452528409659863, 10.06759863470991, 10.197577673320964, 9.604338948925331, 22.27071123135586, 22.26895805386205, 22.155541972567633, 32.35023297121127, 32.67179997855176, 32.23444979389508, 20.358741482098893, 20.93174519327779, 20.74850810070832, 20.784387057026223, 21.54708308105667, 20.913189267118767, 20.23451072225967, 19.904660666982323, 19.748009304205567, 13.177877376476914, 13.620467985204101, 13.322190130750329, 12.482830691461757, 12.480106600870684, 12.555703278941408, 9.990583327909306, 10.305435327192143, 10.512247155730918, 21.12687515715757, 20.61654123167196, 21.154703597227723, 23.442313887489334, 23.14599647869666, 23.044661988814667, 19.92664788166681, 20.23738828736046, 19.774953129390866, 20.572295776257903, 20.474493178228528, 20.6263293425242, 21.247687714795262, 21.005195791522652, 21.47274854957746, 13.960216108217224, 13.84286919857064, 12.874843219916016, 16.96890176832676, 16.84144066274166, 17.30597479827702, 18.99531737342477, 19.083390041429084, 18.485035583376884, 18.844460904598236, 19.05590878939256, 18.673398666083813, 18.43503475934267, 18.23682115226984, 17.791477411985397, 14.431015374138951, 14.482311417814344, 14.168152138590813, -79.63583381970724, -63.80331346889338, -63.51738827427229, 12.956217631697655, 13.862326342612505, 13.69115400314331, 26.439219462374837, 25.806824351350457, 26.584381391915173, 9.609968443711594, 9.189849724372223, 9.619669267286852, 16.461586518213153, 15.903790950775146, 15.85591933131218, 22.255700244257838, 22.23296075562635, 22.11143873135248, 21.78571122939077, 21.28682704766591, 21.399807316561535, 13.49446414380023, 13.524444218414516, 13.01123374948898, 16.173396341502666, 16.05061863362789, 15.734955489635468, 8.430244659384087, 8.508621004720524, 8.613111094882086, 23.39745533466339, 24.02411912381649, 23.879290249198675, 22.66547560505569, 22.43669044971466, 22.646801637485623, 6.085804929335907, 6.7118348836277875, 6.54643066724141, 13.868002918859318, 14.113669390169278, 14.027833723773554, 18.32881899923086, 18.72309960797429, 18.306617237627506, 25.598486239711434, 26.246973822514207, 26.43444404626885, 18.919088204701737, 18.889158961673573, 19.032189359267548, 28.28815734386444, 28.10820011794567, 27.494988277554512, 20.36329104254642, 20.477050902942807, 20.758060791219265, 14.200311154127121, 14.871892724186182, 13.942795172333717, 16.724549826545015, 15.940774997075394, 16.713391529706612, 17.897973709429294, 17.735882221410662, 17.818122568229825, 20.952934209878237, 20.596396724383027, 21.044332663683832, 15.398525178432465, 15.338189519941807, 15.842694984283298, 19.939077780892447, 19.682804500063256, 19.97126708303888, 19.443139324585587, 21.053058991829545, 20.983553419510514, 21.26845362285772, 21.797881859044224, 21.761303866902978, 21.981364965438843, 22.624091587029397, 22.083707481622696, 25.14908180882533, 25.278795820971325, 25.492962285255388, 23.33771616080776, 22.959811329841614, 22.891839012503624, 17.640096187591553, 18.127182341180742, 18.08950430341065, 1.931674301624298, 2.0403454154729843, 1.5855245739221573, 21.084223876396806, 21.761342629479856, 20.6252706448237, 21.015991370814533, 20.726121890048177, 21.04131939545428, 13.122974210729197, 12.884800662597016, 13.411165263115734, 18.925751842558384, 19.150450196117163, 19.01936585456133, 16.360325193653495, 15.985057237247617, 16.07862743983665, 9.663323211173207, 10.142886727737874, 9.83512622366348, 22.811779618263245, 22.9830366615206, 22.760025091469288, 8.330760988096387, 8.500296882043273, 8.313394057253987, 19.355400333801896, 19.82179982463518, 20.019942371795565, 22.824494377709925, 22.6643674261868, 22.35763654112816, 6.153705190867186, 6.163977390155196, 5.920042783021927, 15.517153131465108, 15.444827328125626, 15.480571414033562, 17.520937892297894, 17.62392911190787, 17.23305822412172, 12.674597193797425, 12.806679447491959, 13.017110479374722, 18.01527503629525, 18.418735971053437, 18.577757847805813, 13.677069495121629, 13.90018933142224, 13.202418113748223, 21.050090411677957, 20.921286515891552, 20.92221161723137, 18.514770921319723, 18.655685705598444, 18.57282199896872, 19.86876079874733, 19.993264231054724, 19.006745080153138, 6.371798346439988, 6.089382598797471, 6.698823532710463, 12.61572605992356, 12.238013754288346, 12.422443638245255, 18.47458255663514, 18.056186355650425, 18.62290404457599, 20.857883552710206, 20.993658798436314, 21.266783793146402, 21.16820453604062, 21.539583531518772, 21.507889879246548, -94.87469144662222, -79.98566605647406, -79.62666921814284, 17.873300805687904, 17.655857361853123, 18.081499033607543, 11.079129723211125, 11.231378947695092, 11.574715690066412, 18.907383794585854, 18.552392835418374, 18.91225945452848, 23.88510039448738, 24.03228061646223, 24.039705492556095, 22.760796902080372, 22.43167834480603, 22.936671509019405, 26.545234600702912, 26.434481552491576, 26.234146560231835, 26.41788350542386, 25.796699618299797, 25.741739143927887, 14.26847234989205, 13.837128418187291, 14.296044713507086, 15.858301936338336, 15.725856783489377, 15.383887762824685, 27.600976693133504, 27.09417043129602, 27.090288902322442, 20.524648209412888, 21.54226016749938, 21.28896590818961, 18.145725714663655, 18.148535086462886, 17.59215752283731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15329241457067047, "mean_inference_ms": 0.7035010636147591, "mean_action_processing_ms": 0.10012698896131329, "mean_env_wait_ms": 0.8065360155310003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1573416, "timesteps_this_iter": 0, "agent_timesteps_total": 4720248, "timers": {"sample_time_ms": 21135.922, "sample_throughput": 453.919, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3200.409, "learn_throughput": 2997.742, "update_time_ms": 8.981}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7657095363897713e-13, "cur_lr": 0.0005, "total_loss": 53.916813373565674, "policy_loss": -0.0004766262173889757, "vf_loss": 54.08980178833008, "vf_explained_var": 0.1716550961136818, "kl": 0.007844588253895363, "entropy": 17.251505374908447, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1573416, "num_agent_steps_sampled": 4720248, "num_steps_trained": 1573416, "num_agent_steps_trained": 4720248, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6051, "training_iteration": 164, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-38-28", "timestamp": 1706193508, "time_this_iter_s": 21.24895191192627, "time_total_s": 3306.4490921497345, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA35DC6940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3306.4490921497345, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 7.48, "ram_util_percent": 53.13333333333334}}
{"episode_reward_max": 113.54107311181721, "episode_reward_min": -254.48702672123915, "episode_reward_mean": 50.69200055413529, "episode_len_mean": 298.63, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -94.87469144662222}, "policy_reward_max": {"shared_policy": 38.23401067468026}, "policy_reward_mean": {"shared_policy": 16.897333518045095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.22129680030048, 66.60009973123667, 64.47234559361821, 40.030142111703725, 47.958970464766026, 25.551976758986697, 71.30086470767856, 67.74896769225597, 19.344070480205104, 42.00950603280215, 55.35853584483266, 78.27990410849449, 56.84043652564286, 83.89134573936462, 61.59840273670849, 43.01499905064702, 49.37871635332702, 53.45197849906978, 62.593663597945095, 46.57940968265757, 59.593149363994584, 61.479751735925646, 64.82763934880492, 66.68916403409094, 75.92083991505204, 69.189366503153, 53.856782832182944, 5.55754429101944, 63.47083715070036, 62.78343265631699, 39.41894013644195, 57.095567893236876, 48.42400987073776, 29.64133616257456, 68.55484137125313, 25.144451927393646, 59.19714253023264, 67.84649834502488, 18.23772536404431, 46.442551873624296, 52.377925228327484, 38.498387120664106, 55.0117688551545, 40.77967694029209, 62.89358854480088, 55.74327862588689, 58.86877010995519, 19.160004477947922, 37.27618345245716, 55.153672956861556, 63.11832614429292, 64.21567794680594, -254.48702672123915, 53.61065720114857, 33.88522436097263, 56.37203608453271, 71.9570865035057, 68.12914675590581, 79.21386271342632, 77.95632226765154, 42.40164548158643, 46.9680464826524, 81.78543602675197, 63.355874285101876, 53.88641832396385, 12.701523901894674, 29.322208523750305, 66.16066329926251, 74.83011412248014, 89.4053374030627, 62.01565833389759, 58.04424490756355, 113.54107311181721, -238.44973555579782, 16.69956763647494, 62.83366955444214, 64.07183936983344, 17.389692837372394, 53.46437472011891, 102.83340597944331, 76.85674735903739, 74.40854518418197, 46.367669361643465, 64.98390177637337, 68.63058477640152, 69.98092932999134, 50.08611249178648, 81.28782171756028, 66.02589861676097, 70.60237004980443, 51.58186107594517, 56.37209469266236, 58.80850471928716, 64.90189601480961, 62.480138408020125, 62.75645876117051, 53.169049583375454, 44.1687359511852, 80.50968025811015, 74.62822115235029], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 272, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 191, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.461586518213153, 15.903790950775146, 15.85591933131218, 22.255700244257838, 22.23296075562635, 22.11143873135248, 21.78571122939077, 21.28682704766591, 21.399807316561535, 13.49446414380023, 13.524444218414516, 13.01123374948898, 16.173396341502666, 16.05061863362789, 15.734955489635468, 8.430244659384087, 8.508621004720524, 8.613111094882086, 23.39745533466339, 24.02411912381649, 23.879290249198675, 22.66547560505569, 22.43669044971466, 22.646801637485623, 6.085804929335907, 6.7118348836277875, 6.54643066724141, 13.868002918859318, 14.113669390169278, 14.027833723773554, 18.32881899923086, 18.72309960797429, 18.306617237627506, 25.598486239711434, 26.246973822514207, 26.43444404626885, 18.919088204701737, 18.889158961673573, 19.032189359267548, 28.28815734386444, 28.10820011794567, 27.494988277554512, 20.36329104254642, 20.477050902942807, 20.758060791219265, 14.200311154127121, 14.871892724186182, 13.942795172333717, 16.724549826545015, 15.940774997075394, 16.713391529706612, 17.897973709429294, 17.735882221410662, 17.818122568229825, 20.952934209878237, 20.596396724383027, 21.044332663683832, 15.398525178432465, 15.338189519941807, 15.842694984283298, 19.939077780892447, 19.682804500063256, 19.97126708303888, 19.443139324585587, 21.053058991829545, 20.983553419510514, 21.26845362285772, 21.797881859044224, 21.761303866902978, 21.981364965438843, 22.624091587029397, 22.083707481622696, 25.14908180882533, 25.278795820971325, 25.492962285255388, 23.33771616080776, 22.959811329841614, 22.891839012503624, 17.640096187591553, 18.127182341180742, 18.08950430341065, 1.931674301624298, 2.0403454154729843, 1.5855245739221573, 21.084223876396806, 21.761342629479856, 20.6252706448237, 21.015991370814533, 20.726121890048177, 21.04131939545428, 13.122974210729197, 12.884800662597016, 13.411165263115734, 18.925751842558384, 19.150450196117163, 19.01936585456133, 16.360325193653495, 15.985057237247617, 16.07862743983665, 9.663323211173207, 10.142886727737874, 9.83512622366348, 22.811779618263245, 22.9830366615206, 22.760025091469288, 8.330760988096387, 8.500296882043273, 8.313394057253987, 19.355400333801896, 19.82179982463518, 20.019942371795565, 22.824494377709925, 22.6643674261868, 22.35763654112816, 6.153705190867186, 6.163977390155196, 5.920042783021927, 15.517153131465108, 15.444827328125626, 15.480571414033562, 17.520937892297894, 17.62392911190787, 17.23305822412172, 12.674597193797425, 12.806679447491959, 13.017110479374722, 18.01527503629525, 18.418735971053437, 18.577757847805813, 13.677069495121629, 13.90018933142224, 13.202418113748223, 21.050090411677957, 20.921286515891552, 20.92221161723137, 18.514770921319723, 18.655685705598444, 18.57282199896872, 19.86876079874733, 19.993264231054724, 19.006745080153138, 6.371798346439988, 6.089382598797471, 6.698823532710463, 12.61572605992356, 12.238013754288346, 12.422443638245255, 18.47458255663514, 18.056186355650425, 18.62290404457599, 20.857883552710206, 20.993658798436314, 21.266783793146402, 21.16820453604062, 21.539583531518772, 21.507889879246548, -94.87469144662222, -79.98566605647406, -79.62666921814284, 17.873300805687904, 17.655857361853123, 18.081499033607543, 11.079129723211125, 11.231378947695092, 11.574715690066412, 18.907383794585854, 18.552392835418374, 18.91225945452848, 23.88510039448738, 24.03228061646223, 24.039705492556095, 22.760796902080372, 22.43167834480603, 22.936671509019405, 26.545234600702912, 26.434481552491576, 26.234146560231835, 26.41788350542386, 25.796699618299797, 25.741739143927887, 14.26847234989205, 13.837128418187291, 14.296044713507086, 15.858301936338336, 15.725856783489377, 15.383887762824685, 27.600976693133504, 27.09417043129602, 27.090288902322442, 20.524648209412888, 21.54226016749938, 21.28896590818961, 18.145725714663655, 18.148535086462886, 17.59215752283731, 4.425677058597401, 4.787789180253938, 3.4880576630433353, 9.83042211085558, 9.754159979522228, 9.737626433372498, 22.287093726297215, 21.751918037732437, 22.121651535232857, 24.745606323083237, 25.212625944366053, 24.87188185503085, 29.758958424131066, 30.173399170084537, 29.4729798088471, 20.769245505332947, 20.6437895745039, 20.602623254060745, 18.99680680781603, 19.518368059769273, 19.52907003997825, 37.77005449930826, 38.23401067468026, 37.53700793782869, -74.6727705957989, -88.83651796976726, -74.94044699023168, 5.522435861329228, 5.424794549743325, 5.7523372254023855, 21.0191301430265, 21.052803097913653, 20.761736313501984, 21.402540309975535, 21.41260429347554, 21.256694766382367, 5.305907184878976, 6.007061618069798, 6.07672403442362, 17.760475146273762, 17.628989125291497, 18.074910448553652, 34.411141586645186, 34.148892807463795, 34.27337158533433, 25.68828460325797, 25.715906140704945, 25.45255661507447, 24.953299871335417, 25.158930020329223, 24.296315292517335, 15.546726590643317, 15.10365682343641, 15.717285947563738, 21.437448059519127, 21.70272523661454, 21.843728480239704, 22.857172898948193, 22.954700626432896, 22.81871125102043, 23.29621308296919, 23.385510079562664, 23.299206167459488, 16.83152348548174, 16.41735029220581, 16.83723871409893, 27.27313083906968, 26.9426151116689, 27.072075766821698, 21.926057435572147, 22.069906316697598, 22.029934864491224, 23.728520353635147, 23.304882129033402, 23.568967567135886, 16.74557344118753, 17.514812253105134, 17.321475381652505, 17.826621025800705, 19.21765496581793, 19.327818701043725, 19.56046749651432, 19.42079433053732, 19.827242892235518, 21.650116868317127, 21.81229816377163, 21.439480982720852, 20.396494035919503, 21.15154337075849, 20.932101001342133, 21.08039700984955, 20.542763635516167, 21.13329811580479, 17.358261942863464, 18.09634666889906, 17.71444097161293, 14.868537080163748, 14.412203090886265, 14.887995780135185, 26.77347683658202, 26.82498365019758, 26.91121977133055, 24.927632377793387, 24.690097158153847, 25.01049161640306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15337251198396287, "mean_inference_ms": 0.7036680647645855, "mean_action_processing_ms": 0.10010609293695648, "mean_env_wait_ms": 0.8067012193679617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1583010, "timesteps_this_iter": 0, "agent_timesteps_total": 4749030, "timers": {"sample_time_ms": 21310.3, "sample_throughput": 450.205, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3206.423, "learn_throughput": 2992.12, "update_time_ms": 9.041}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7657095363897713e-13, "cur_lr": 0.0005, "total_loss": 52.65651845932007, "policy_loss": 3.665267879604528e-05, "vf_loss": 52.831289291381836, "vf_explained_var": 0.0900716483592987, "kl": 0.009759670181921948, "entropy": 17.48082709312439, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1583010, "num_agent_steps_sampled": 4749030, "num_steps_trained": 1583010, "num_agent_steps_trained": 4749030, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6086, "training_iteration": 165, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-38-49", "timestamp": 1706193529, "time_this_iter_s": 20.74080801010132, "time_total_s": 3327.189900159836, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3327.189900159836, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 8.969999999999999, "ram_util_percent": 53.23}}
{"episode_reward_max": 113.54107311181721, "episode_reward_min": -309.98641296476126, "episode_reward_mean": 47.30650625200662, "episode_len_mean": 296.32, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -116.19499083360037}, "policy_reward_max": {"shared_policy": 38.23401067468026}, "policy_reward_mean": {"shared_policy": 15.768835417335538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.78343265631699, 39.41894013644195, 57.095567893236876, 48.42400987073776, 29.64133616257456, 68.55484137125313, 25.144451927393646, 59.19714253023264, 67.84649834502488, 18.23772536404431, 46.442551873624296, 52.377925228327484, 38.498387120664106, 55.0117688551545, 40.77967694029209, 62.89358854480088, 55.74327862588689, 58.86877010995519, 19.160004477947922, 37.27618345245716, 55.153672956861556, 63.11832614429292, 64.21567794680594, -254.48702672123915, 53.61065720114857, 33.88522436097263, 56.37203608453271, 71.9570865035057, 68.12914675590581, 79.21386271342632, 77.95632226765154, 42.40164548158643, 46.9680464826524, 81.78543602675197, 63.355874285101876, 53.88641832396385, 12.701523901894674, 29.322208523750305, 66.16066329926251, 74.83011412248014, 89.4053374030627, 62.01565833389759, 58.04424490756355, 113.54107311181721, -238.44973555579782, 16.69956763647494, 62.83366955444214, 64.07183936983344, 17.389692837372394, 53.46437472011891, 102.83340597944331, 76.85674735903739, 74.40854518418197, 46.367669361643465, 64.98390177637337, 68.63058477640152, 69.98092932999134, 50.08611249178648, 81.28782171756028, 66.02589861676097, 70.60237004980443, 51.58186107594517, 56.37209469266236, 58.80850471928716, 64.90189601480961, 62.480138408020125, 62.75645876117051, 53.169049583375454, 44.1687359511852, 80.50968025811015, 74.62822115235029, 48.698434323072405, 71.04074387997387, 53.01726702600716, 56.132277871482046, 54.125030115246744, 44.10011352039871, 46.53339326754211, 43.00678365149088, 68.78052809438665, 85.44085825746878, 71.95098393037915, 32.07468130066988, 67.91853376850483, 65.76045185327528, 49.12868852354585, 52.36969950236379, 63.358499940484734, 57.30020653456447, 62.47551313764414, 56.59688694775103, 65.52537850290535, 56.27471800893545, 54.73991693696007, -309.98641296476126, 50.1842670366168, 50.954857625067206, 43.45308419317004, 42.88479624688625, 62.4210964422673], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 272, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 191, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 69, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.015991370814533, 20.726121890048177, 21.04131939545428, 13.122974210729197, 12.884800662597016, 13.411165263115734, 18.925751842558384, 19.150450196117163, 19.01936585456133, 16.360325193653495, 15.985057237247617, 16.07862743983665, 9.663323211173207, 10.142886727737874, 9.83512622366348, 22.811779618263245, 22.9830366615206, 22.760025091469288, 8.330760988096387, 8.500296882043273, 8.313394057253987, 19.355400333801896, 19.82179982463518, 20.019942371795565, 22.824494377709925, 22.6643674261868, 22.35763654112816, 6.153705190867186, 6.163977390155196, 5.920042783021927, 15.517153131465108, 15.444827328125626, 15.480571414033562, 17.520937892297894, 17.62392911190787, 17.23305822412172, 12.674597193797425, 12.806679447491959, 13.017110479374722, 18.01527503629525, 18.418735971053437, 18.577757847805813, 13.677069495121629, 13.90018933142224, 13.202418113748223, 21.050090411677957, 20.921286515891552, 20.92221161723137, 18.514770921319723, 18.655685705598444, 18.57282199896872, 19.86876079874733, 19.993264231054724, 19.006745080153138, 6.371798346439988, 6.089382598797471, 6.698823532710463, 12.61572605992356, 12.238013754288346, 12.422443638245255, 18.47458255663514, 18.056186355650425, 18.62290404457599, 20.857883552710206, 20.993658798436314, 21.266783793146402, 21.16820453604062, 21.539583531518772, 21.507889879246548, -94.87469144662222, -79.98566605647406, -79.62666921814284, 17.873300805687904, 17.655857361853123, 18.081499033607543, 11.079129723211125, 11.231378947695092, 11.574715690066412, 18.907383794585854, 18.552392835418374, 18.91225945452848, 23.88510039448738, 24.03228061646223, 24.039705492556095, 22.760796902080372, 22.43167834480603, 22.936671509019405, 26.545234600702912, 26.434481552491576, 26.234146560231835, 26.41788350542386, 25.796699618299797, 25.741739143927887, 14.26847234989205, 13.837128418187291, 14.296044713507086, 15.858301936338336, 15.725856783489377, 15.383887762824685, 27.600976693133504, 27.09417043129602, 27.090288902322442, 20.524648209412888, 21.54226016749938, 21.28896590818961, 18.145725714663655, 18.148535086462886, 17.59215752283731, 4.425677058597401, 4.787789180253938, 3.4880576630433353, 9.83042211085558, 9.754159979522228, 9.737626433372498, 22.287093726297215, 21.751918037732437, 22.121651535232857, 24.745606323083237, 25.212625944366053, 24.87188185503085, 29.758958424131066, 30.173399170084537, 29.4729798088471, 20.769245505332947, 20.6437895745039, 20.602623254060745, 18.99680680781603, 19.518368059769273, 19.52907003997825, 37.77005449930826, 38.23401067468026, 37.53700793782869, -74.6727705957989, -88.83651796976726, -74.94044699023168, 5.522435861329228, 5.424794549743325, 5.7523372254023855, 21.0191301430265, 21.052803097913653, 20.761736313501984, 21.402540309975535, 21.41260429347554, 21.256694766382367, 5.305907184878976, 6.007061618069798, 6.07672403442362, 17.760475146273762, 17.628989125291497, 18.074910448553652, 34.411141586645186, 34.148892807463795, 34.27337158533433, 25.68828460325797, 25.715906140704945, 25.45255661507447, 24.953299871335417, 25.158930020329223, 24.296315292517335, 15.546726590643317, 15.10365682343641, 15.717285947563738, 21.437448059519127, 21.70272523661454, 21.843728480239704, 22.857172898948193, 22.954700626432896, 22.81871125102043, 23.29621308296919, 23.385510079562664, 23.299206167459488, 16.83152348548174, 16.41735029220581, 16.83723871409893, 27.27313083906968, 26.9426151116689, 27.072075766821698, 21.926057435572147, 22.069906316697598, 22.029934864491224, 23.728520353635147, 23.304882129033402, 23.568967567135886, 16.74557344118753, 17.514812253105134, 17.321475381652505, 17.826621025800705, 19.21765496581793, 19.327818701043725, 19.56046749651432, 19.42079433053732, 19.827242892235518, 21.650116868317127, 21.81229816377163, 21.439480982720852, 20.396494035919503, 21.15154337075849, 20.932101001342133, 21.08039700984955, 20.542763635516167, 21.13329811580479, 17.358261942863464, 18.09634666889906, 17.71444097161293, 14.868537080163748, 14.412203090886265, 14.887995780135185, 26.77347683658202, 26.82498365019758, 26.91121977133055, 24.927632377793387, 24.690097158153847, 25.01049161640306, 16.18986217180887, 16.11190443734327, 16.396667713920266, 23.528148752947644, 23.668866862853363, 23.843728264172867, 17.88475415979822, 17.33167168994744, 17.8008411762615, 18.80865655435869, 18.737826180333883, 18.58579513678947, 17.998717973629624, 17.86051260928312, 18.265799532334, 14.762682511160762, 14.570089901487023, 14.767341107750923, 15.885487982382372, 15.842644219597176, 14.805261065562561, 14.610869759996604, 14.123054154217243, 14.272859737277031, 22.522414515415818, 22.97996564085284, 23.278147938117996, 28.559636978742972, 28.33050563683112, 28.550715641894683, 24.015566173940897, 24.013510335236788, 23.921907421201468, 10.19776753584543, 11.074200472484023, 10.802713292340428, 22.48438750455776, 22.56307532141605, 22.87107094253102, 21.982151990135506, 21.54545386632283, 22.23284599681695, 16.276215506096676, 16.628916352366403, 16.223556665082768, 17.54950039585431, 17.001882796486214, 17.818316310023263, 20.98854403073588, 21.16061005803445, 21.209345851714403, 19.80722143004337, 17.759145597616822, 19.733839506904275, 21.052461679171145, 20.463065942128495, 20.959985516344503, 18.640204911430672, 19.086947237451866, 18.869734798868492, 21.9930391361316, 21.67893286546071, 21.853406501313046, 18.77270944416523, 18.869995959103107, 18.632012605667114, 18.130456991493702, 18.63395837834105, 17.97550156712532, -96.70220073064169, -97.08922140051922, -116.19499083360037, 16.689286183565855, 16.793713726103306, 16.70126712694764, 17.10140863681832, 16.719782950977475, 17.13366603727141, 14.515906522671372, 14.53736192236343, 14.39981574813524, 13.855543628334999, 14.785771414637566, 14.243481203913689, 20.995539603754878, 20.63628412783146, 20.78927271068096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533956023719077, "mean_inference_ms": 0.7039613850364493, "mean_action_processing_ms": 0.10015892222924476, "mean_env_wait_ms": 0.80692771898275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1592604, "timesteps_this_iter": 0, "agent_timesteps_total": 4777812, "timers": {"sample_time_ms": 21483.723, "sample_throughput": 446.571, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3230.113, "learn_throughput": 2970.175, "update_time_ms": 9.193}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7657095363897713e-13, "cur_lr": 0.0005, "total_loss": 53.62094783782959, "policy_loss": 0.0005359173956218655, "vf_loss": 53.797654151916504, "vf_explained_var": -0.02538314461708069, "kl": 1.253746211529037, "entropy": 17.724157094955444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1592604, "num_agent_steps_sampled": 4777812, "num_steps_trained": 1592604, "num_agent_steps_trained": 4777812, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6115, "training_iteration": 166, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-39-10", "timestamp": 1706193550, "time_this_iter_s": 20.56104803085327, "time_total_s": 3347.750948190689, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3347.750948190689, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 6.665517241379309, "ram_util_percent": 53.272413793103446}}
{"episode_reward_max": 113.54107311181721, "episode_reward_min": -309.98641296476126, "episode_reward_mean": 53.33006049644504, "episode_len_mean": 296.6, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -116.19499083360037}, "policy_reward_max": {"shared_policy": 38.23401067468026}, "policy_reward_mean": {"shared_policy": 17.776686832148346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.88641832396385, 12.701523901894674, 29.322208523750305, 66.16066329926251, 74.83011412248014, 89.4053374030627, 62.01565833389759, 58.04424490756355, 113.54107311181721, -238.44973555579782, 16.69956763647494, 62.83366955444214, 64.07183936983344, 17.389692837372394, 53.46437472011891, 102.83340597944331, 76.85674735903739, 74.40854518418197, 46.367669361643465, 64.98390177637337, 68.63058477640152, 69.98092932999134, 50.08611249178648, 81.28782171756028, 66.02589861676097, 70.60237004980443, 51.58186107594517, 56.37209469266236, 58.80850471928716, 64.90189601480961, 62.480138408020125, 62.75645876117051, 53.169049583375454, 44.1687359511852, 80.50968025811015, 74.62822115235029, 48.698434323072405, 71.04074387997387, 53.01726702600716, 56.132277871482046, 54.125030115246744, 44.10011352039871, 46.53339326754211, 43.00678365149088, 68.78052809438665, 85.44085825746878, 71.95098393037915, 32.07468130066988, 67.91853376850483, 65.76045185327528, 49.12868852354585, 52.36969950236379, 63.358499940484734, 57.30020653456447, 62.47551313764414, 56.59688694775103, 65.52537850290535, 56.27471800893545, 54.73991693696007, -309.98641296476126, 50.1842670366168, 50.954857625067206, 43.45308419317004, 42.88479624688625, 62.4210964422673, 70.41020150482655, 64.03953373432158, 38.48400033265352, 20.819874831475303, 32.04483132995665, 73.51530591025949, 87.1681751720607, 49.82982970029116, 77.90091777872293, 87.41282092407343, 40.702700051944674, 61.22956656571478, 55.703010722994804, 78.53075419645755, 85.34543807152657, 67.17457252927122, 73.89673759043215, 74.87602603621778, 65.40646252408624, 82.46325221471486, 46.40867796540259, 53.62103414908049, 34.22250387631355, 74.71686865389346, 81.54515256360172, 66.67137568257749, 62.62230147887021, 82.88887842744587, 13.024886060506105, 63.06088756769893, 21.337854586541624, 53.440028835087986, 85.34471301361917, 63.60909486375746, 59.919224973767996], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 191, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 69, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.145725714663655, 18.148535086462886, 17.59215752283731, 4.425677058597401, 4.787789180253938, 3.4880576630433353, 9.83042211085558, 9.754159979522228, 9.737626433372498, 22.287093726297215, 21.751918037732437, 22.121651535232857, 24.745606323083237, 25.212625944366053, 24.87188185503085, 29.758958424131066, 30.173399170084537, 29.4729798088471, 20.769245505332947, 20.6437895745039, 20.602623254060745, 18.99680680781603, 19.518368059769273, 19.52907003997825, 37.77005449930826, 38.23401067468026, 37.53700793782869, -74.6727705957989, -88.83651796976726, -74.94044699023168, 5.522435861329228, 5.424794549743325, 5.7523372254023855, 21.0191301430265, 21.052803097913653, 20.761736313501984, 21.402540309975535, 21.41260429347554, 21.256694766382367, 5.305907184878976, 6.007061618069798, 6.07672403442362, 17.760475146273762, 17.628989125291497, 18.074910448553652, 34.411141586645186, 34.148892807463795, 34.27337158533433, 25.68828460325797, 25.715906140704945, 25.45255661507447, 24.953299871335417, 25.158930020329223, 24.296315292517335, 15.546726590643317, 15.10365682343641, 15.717285947563738, 21.437448059519127, 21.70272523661454, 21.843728480239704, 22.857172898948193, 22.954700626432896, 22.81871125102043, 23.29621308296919, 23.385510079562664, 23.299206167459488, 16.83152348548174, 16.41735029220581, 16.83723871409893, 27.27313083906968, 26.9426151116689, 27.072075766821698, 21.926057435572147, 22.069906316697598, 22.029934864491224, 23.728520353635147, 23.304882129033402, 23.568967567135886, 16.74557344118753, 17.514812253105134, 17.321475381652505, 17.826621025800705, 19.21765496581793, 19.327818701043725, 19.56046749651432, 19.42079433053732, 19.827242892235518, 21.650116868317127, 21.81229816377163, 21.439480982720852, 20.396494035919503, 21.15154337075849, 20.932101001342133, 21.08039700984955, 20.542763635516167, 21.13329811580479, 17.358261942863464, 18.09634666889906, 17.71444097161293, 14.868537080163748, 14.412203090886265, 14.887995780135185, 26.77347683658202, 26.82498365019758, 26.91121977133055, 24.927632377793387, 24.690097158153847, 25.01049161640306, 16.18986217180887, 16.11190443734327, 16.396667713920266, 23.528148752947644, 23.668866862853363, 23.843728264172867, 17.88475415979822, 17.33167168994744, 17.8008411762615, 18.80865655435869, 18.737826180333883, 18.58579513678947, 17.998717973629624, 17.86051260928312, 18.265799532334, 14.762682511160762, 14.570089901487023, 14.767341107750923, 15.885487982382372, 15.842644219597176, 14.805261065562561, 14.610869759996604, 14.123054154217243, 14.272859737277031, 22.522414515415818, 22.97996564085284, 23.278147938117996, 28.559636978742972, 28.33050563683112, 28.550715641894683, 24.015566173940897, 24.013510335236788, 23.921907421201468, 10.19776753584543, 11.074200472484023, 10.802713292340428, 22.48438750455776, 22.56307532141605, 22.87107094253102, 21.982151990135506, 21.54545386632283, 22.23284599681695, 16.276215506096676, 16.628916352366403, 16.223556665082768, 17.54950039585431, 17.001882796486214, 17.818316310023263, 20.98854403073588, 21.16061005803445, 21.209345851714403, 19.80722143004337, 17.759145597616822, 19.733839506904275, 21.052461679171145, 20.463065942128495, 20.959985516344503, 18.640204911430672, 19.086947237451866, 18.869734798868492, 21.9930391361316, 21.67893286546071, 21.853406501313046, 18.77270944416523, 18.869995959103107, 18.632012605667114, 18.130456991493702, 18.63395837834105, 17.97550156712532, -96.70220073064169, -97.08922140051922, -116.19499083360037, 16.689286183565855, 16.793713726103306, 16.70126712694764, 17.10140863681832, 16.719782950977475, 17.13366603727141, 14.515906522671372, 14.53736192236343, 14.39981574813524, 13.855543628334999, 14.785771414637566, 14.243481203913689, 20.995539603754878, 20.63628412783146, 20.78927271068096, 23.70980842411518, 23.565338388085365, 23.135054692626, 21.442544994254902, 21.042103742559746, 21.55488499750693, 12.884784176945686, 12.73656165599823, 12.862654499709606, 7.178892253277198, 6.62319380541642, 7.017788772781685, 10.252409636974335, 10.959294507279992, 10.833127185702324, 24.72858553752303, 24.0170556306839, 24.769664742052555, 28.884921031693608, 29.141958537201077, 29.141295603166014, 16.44875457882881, 16.71740847080946, 16.663666650652885, 26.279671036017433, 25.778789070745304, 25.84245767196019, 28.715893055001885, 29.313924411932618, 29.383003457138926, 13.59910426909724, 13.777551176181674, 13.32604460666576, 20.26914144307375, 20.278209321200848, 20.68221580144018, 18.451023057103157, 18.683421045541763, 18.568566620349884, 25.690352772672966, 26.495740749252334, 26.34466067453225, 27.092908968528107, 29.03186672677596, 29.220662376222506, 22.393918255964905, 22.604771968598158, 22.175882304708153, 24.734085471679762, 24.72332415108879, 24.4393279676636, 25.320360582942754, 24.782836164037377, 24.77282928923765, 21.801871549338102, 21.842037070542574, 21.76255390420556, 27.5961056711773, 27.605351944143564, 27.261794599393994, 15.588528280456856, 15.696306367715195, 15.123843317230538, 18.218558906267077, 17.53472627202669, 17.86774897078672, 11.41590854277213, 11.944465610509113, 10.86212972303231, 24.68552130957444, 24.976691508044794, 25.05465583627422, 27.15774904688199, 27.364445903648928, 27.0229576130708, 22.27025753632188, 22.31158690340817, 22.089531242847443, 20.801380924880505, 21.083466392941773, 20.737454161047935, 27.666041178007916, 27.30354357262452, 27.91929367681344, 4.279790587723255, 4.25053308904171, 4.49456238374114, 20.988771530489117, 20.976458365718514, 21.095657671491296, 7.477047438422829, 6.707902173201234, 7.152904974917561, 17.98010831574598, 17.99542002255717, 17.464500496784837, 27.930037652452782, 28.74121437159677, 28.67346098956962, 21.051897789041192, 21.367772929991276, 21.189424144724995, 19.67988210916519, 20.016636449843645, 20.22270641475916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15345813285696824, "mean_inference_ms": 0.7041097900176265, "mean_action_processing_ms": 0.10014585079064937, "mean_env_wait_ms": 0.8069910188601819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1602198, "timesteps_this_iter": 0, "agent_timesteps_total": 4806594, "timers": {"sample_time_ms": 21463.963, "sample_throughput": 446.982, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3179.917, "learn_throughput": 3017.06, "update_time_ms": 9.075}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1485643045846567e-13, "cur_lr": 0.0005, "total_loss": 7.555268704891205, "policy_loss": 0.0014612666794248108, "vf_loss": 7.727932393550873, "vf_explained_var": 0.055479563772678375, "kl": 0.00934794859520752, "entropy": 17.41246485710144, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1602198, "num_agent_steps_sampled": 4806594, "num_steps_trained": 1602198, "num_agent_steps_trained": 4806594, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6150, "training_iteration": 167, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-39-31", "timestamp": 1706193571, "time_this_iter_s": 21.336130142211914, "time_total_s": 3369.087078332901, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03566160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3369.087078332901, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 7.97, "ram_util_percent": 53.55666666666668}}
{"episode_reward_max": 87.41282092407343, "episode_reward_min": -309.98641296476126, "episode_reward_mean": 49.585933044971426, "episode_len_mean": 296.24, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -116.19499083360037}, "policy_reward_max": {"shared_policy": 29.383003457138926}, "policy_reward_mean": {"shared_policy": 16.52864434832381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.169049583375454, 44.1687359511852, 80.50968025811015, 74.62822115235029, 48.698434323072405, 71.04074387997387, 53.01726702600716, 56.132277871482046, 54.125030115246744, 44.10011352039871, 46.53339326754211, 43.00678365149088, 68.78052809438665, 85.44085825746878, 71.95098393037915, 32.07468130066988, 67.91853376850483, 65.76045185327528, 49.12868852354585, 52.36969950236379, 63.358499940484734, 57.30020653456447, 62.47551313764414, 56.59688694775103, 65.52537850290535, 56.27471800893545, 54.73991693696007, -309.98641296476126, 50.1842670366168, 50.954857625067206, 43.45308419317004, 42.88479624688625, 62.4210964422673, 70.41020150482655, 64.03953373432158, 38.48400033265352, 20.819874831475303, 32.04483132995665, 73.51530591025949, 87.1681751720607, 49.82982970029116, 77.90091777872293, 87.41282092407343, 40.702700051944674, 61.22956656571478, 55.703010722994804, 78.53075419645755, 85.34543807152657, 67.17457252927122, 73.89673759043215, 74.87602603621778, 65.40646252408624, 82.46325221471486, 46.40867796540259, 53.62103414908049, 34.22250387631355, 74.71686865389346, 81.54515256360172, 66.67137568257749, 62.62230147887021, 82.88887842744587, 13.024886060506105, 63.06088756769893, 21.337854586541624, 53.440028835087986, 85.34471301361917, 63.60909486375746, 59.919224973767996, 59.94539037346837, 54.903341757133575, 49.93734329822473, 39.455441944301114, 51.58638446032998, 53.532895671785795, 66.5370724154636, 80.55918876011856, 68.53103691223077, 55.23804781259966, 59.369440339505644, 53.81181017728521, -4.255602799355998, 41.760435439646244, 81.19071827363223, 73.61464352160691, -254.96458358317616, 49.860431991517515, 0.2866487130522586, 64.21907781064508, 27.79839549958703, 48.78193692862985, -9.199225916294395, 2.170387327671051, 81.02996552735567, 59.4920307509601, 30.3726096153259, 70.15427657589315, 85.0283171273768, 55.08046079427004, 41.45113977417347, 53.18938836269078], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 69, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 155, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.358261942863464, 18.09634666889906, 17.71444097161293, 14.868537080163748, 14.412203090886265, 14.887995780135185, 26.77347683658202, 26.82498365019758, 26.91121977133055, 24.927632377793387, 24.690097158153847, 25.01049161640306, 16.18986217180887, 16.11190443734327, 16.396667713920266, 23.528148752947644, 23.668866862853363, 23.843728264172867, 17.88475415979822, 17.33167168994744, 17.8008411762615, 18.80865655435869, 18.737826180333883, 18.58579513678947, 17.998717973629624, 17.86051260928312, 18.265799532334, 14.762682511160762, 14.570089901487023, 14.767341107750923, 15.885487982382372, 15.842644219597176, 14.805261065562561, 14.610869759996604, 14.123054154217243, 14.272859737277031, 22.522414515415818, 22.97996564085284, 23.278147938117996, 28.559636978742972, 28.33050563683112, 28.550715641894683, 24.015566173940897, 24.013510335236788, 23.921907421201468, 10.19776753584543, 11.074200472484023, 10.802713292340428, 22.48438750455776, 22.56307532141605, 22.87107094253102, 21.982151990135506, 21.54545386632283, 22.23284599681695, 16.276215506096676, 16.628916352366403, 16.223556665082768, 17.54950039585431, 17.001882796486214, 17.818316310023263, 20.98854403073588, 21.16061005803445, 21.209345851714403, 19.80722143004337, 17.759145597616822, 19.733839506904275, 21.052461679171145, 20.463065942128495, 20.959985516344503, 18.640204911430672, 19.086947237451866, 18.869734798868492, 21.9930391361316, 21.67893286546071, 21.853406501313046, 18.77270944416523, 18.869995959103107, 18.632012605667114, 18.130456991493702, 18.63395837834105, 17.97550156712532, -96.70220073064169, -97.08922140051922, -116.19499083360037, 16.689286183565855, 16.793713726103306, 16.70126712694764, 17.10140863681832, 16.719782950977475, 17.13366603727141, 14.515906522671372, 14.53736192236343, 14.39981574813524, 13.855543628334999, 14.785771414637566, 14.243481203913689, 20.995539603754878, 20.63628412783146, 20.78927271068096, 23.70980842411518, 23.565338388085365, 23.135054692626, 21.442544994254902, 21.042103742559746, 21.55488499750693, 12.884784176945686, 12.73656165599823, 12.862654499709606, 7.178892253277198, 6.62319380541642, 7.017788772781685, 10.252409636974335, 10.959294507279992, 10.833127185702324, 24.72858553752303, 24.0170556306839, 24.769664742052555, 28.884921031693608, 29.141958537201077, 29.141295603166014, 16.44875457882881, 16.71740847080946, 16.663666650652885, 26.279671036017433, 25.778789070745304, 25.84245767196019, 28.715893055001885, 29.313924411932618, 29.383003457138926, 13.59910426909724, 13.777551176181674, 13.32604460666576, 20.26914144307375, 20.278209321200848, 20.68221580144018, 18.451023057103157, 18.683421045541763, 18.568566620349884, 25.690352772672966, 26.495740749252334, 26.34466067453225, 27.092908968528107, 29.03186672677596, 29.220662376222506, 22.393918255964905, 22.604771968598158, 22.175882304708153, 24.734085471679762, 24.72332415108879, 24.4393279676636, 25.320360582942754, 24.782836164037377, 24.77282928923765, 21.801871549338102, 21.842037070542574, 21.76255390420556, 27.5961056711773, 27.605351944143564, 27.261794599393994, 15.588528280456856, 15.696306367715195, 15.123843317230538, 18.218558906267077, 17.53472627202669, 17.86774897078672, 11.41590854277213, 11.944465610509113, 10.86212972303231, 24.68552130957444, 24.976691508044794, 25.05465583627422, 27.15774904688199, 27.364445903648928, 27.0229576130708, 22.27025753632188, 22.31158690340817, 22.089531242847443, 20.801380924880505, 21.083466392941773, 20.737454161047935, 27.666041178007916, 27.30354357262452, 27.91929367681344, 4.279790587723255, 4.25053308904171, 4.49456238374114, 20.988771530489117, 20.976458365718514, 21.095657671491296, 7.477047438422829, 6.707902173201234, 7.152904974917561, 17.98010831574598, 17.99542002255717, 17.464500496784837, 27.930037652452782, 28.74121437159677, 28.67346098956962, 21.051897789041192, 21.367772929991276, 21.189424144724995, 19.67988210916519, 20.016636449843645, 20.22270641475916, 19.950188814351947, 20.056381716082484, 19.93881984303394, 18.24378782014051, 18.4939703537772, 18.165583583215863, 17.10102755459957, 16.203405559062958, 16.632910184562206, 13.211112295587853, 12.908749630053833, 13.335580018659428, 16.654894346992165, 17.403329494098813, 17.528160619239003, 17.574306165178612, 18.039382107517056, 17.919207399090126, 22.118244762221963, 22.211679629671067, 22.207148023570568, 27.044591592624784, 26.399417236447334, 27.11517993104644, 22.76150741800666, 22.86481247935444, 22.904717014869675, 18.280256936947495, 18.56880959045762, 18.388981285194546, 19.93399892623225, 19.974821029851825, 19.46062038342157, 18.06066722919543, 18.05095362088953, 17.70018932720025, -1.26408712069194, -1.719668592015907, -1.271847086648151, 13.526914790272713, 13.744668811559677, 14.488851837813854, 26.603815510869026, 27.333105380646884, 27.253797382116318, 24.489684504767254, 24.489922513564423, 24.63503650327523, -95.75836356480917, -79.57740563650927, -79.62881438185772, 16.772732670108468, 16.80363309631744, 16.284066225091607, 0.46073779215414845, 0.48073071738083684, -0.6548197964827267, 21.40458859006563, 21.5921084533135, 21.222380767265946, 8.870201672116906, 9.668003323177487, 9.260190504292638, 16.259857061008603, 16.280109042922646, 16.241970824698598, -3.3249483431379048, -2.913159027152389, -2.9611185460041014, 0.6443180665373802, 0.8146197870373726, 0.7114494740962982, 27.386699177324772, 27.389850437641144, 26.253415912389755, 19.264113192756966, 20.123295241345957, 20.104622316857174, 10.22498909632364, 10.084711613754422, 10.062908905247838, 23.198284988601998, 23.462184832741812, 23.49380675454934, 27.994798839092255, 28.497170999646187, 28.536347288638353, 18.328293040394783, 18.21298934519291, 18.539178408682346, 13.589735219875962, 13.687384317318589, 14.174020236978919, 17.863090031469852, 17.66294170419374, 17.663356627027184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15353555873502206, "mean_inference_ms": 0.704473359294854, "mean_action_processing_ms": 0.10023178609271902, "mean_env_wait_ms": 0.8072700049505797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1611792, "timesteps_this_iter": 0, "agent_timesteps_total": 4835376, "timers": {"sample_time_ms": 21020.719, "sample_throughput": 456.407, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3150.56, "learn_throughput": 3045.173, "update_time_ms": 9.018}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1485643045846567e-13, "cur_lr": 0.0005, "total_loss": 46.670795917510986, "policy_loss": 0.00024676848100879667, "vf_loss": 46.84670448303223, "vf_explained_var": 0.2260475605726242, "kl": 0.013934375485665538, "entropy": 17.615488290786743, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1611792, "num_agent_steps_sampled": 4835376, "num_steps_trained": 1611792, "num_agent_steps_trained": 4835376, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6182, "training_iteration": 168, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-39-53", "timestamp": 1706193593, "time_this_iter_s": 21.3321635723114, "time_total_s": 3390.4192419052124, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03540DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3390.4192419052124, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 7.26, "ram_util_percent": 53.03999999999999}}
{"episode_reward_max": 87.41282092407343, "episode_reward_min": -254.96458358317616, "episode_reward_mean": 52.344359076960245, "episode_len_mean": 298.55, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -95.75836356480917}, "policy_reward_max": {"shared_policy": 29.383003457138926}, "policy_reward_mean": {"shared_policy": 17.448119692320077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.88479624688625, 62.4210964422673, 70.41020150482655, 64.03953373432158, 38.48400033265352, 20.819874831475303, 32.04483132995665, 73.51530591025949, 87.1681751720607, 49.82982970029116, 77.90091777872293, 87.41282092407343, 40.702700051944674, 61.22956656571478, 55.703010722994804, 78.53075419645755, 85.34543807152657, 67.17457252927122, 73.89673759043215, 74.87602603621778, 65.40646252408624, 82.46325221471486, 46.40867796540259, 53.62103414908049, 34.22250387631355, 74.71686865389346, 81.54515256360172, 66.67137568257749, 62.62230147887021, 82.88887842744587, 13.024886060506105, 63.06088756769893, 21.337854586541624, 53.440028835087986, 85.34471301361917, 63.60909486375746, 59.919224973767996, 59.94539037346837, 54.903341757133575, 49.93734329822473, 39.455441944301114, 51.58638446032998, 53.532895671785795, 66.5370724154636, 80.55918876011856, 68.53103691223077, 55.23804781259966, 59.369440339505644, 53.81181017728521, -4.255602799355998, 41.760435439646244, 81.19071827363223, 73.61464352160691, -254.96458358317616, 49.860431991517515, 0.2866487130522586, 64.21907781064508, 27.79839549958703, 48.78193692862985, -9.199225916294395, 2.170387327671051, 81.02996552735567, 59.4920307509601, 30.3726096153259, 70.15427657589315, 85.0283171273768, 55.08046079427004, 41.45113977417347, 53.18938836269078, 66.7717946358025, 64.81192661449313, 43.350850198417874, -18.48336704820396, 67.91567665897308, 51.60769801866262, 67.97725162701678, 52.10841511934993, 59.46187932789323, 67.18776264600456, -6.9258644431829595, 64.21468615997583, 41.771890219300985, 37.474669650197015, 79.50977349467573, 81.6130481958389, 34.773102144710705, 37.97455869242549, 83.94074434600769, 50.36086628586051, 76.4293243368156, 60.029764314182074, 66.90816785581407, 76.11262321099638, 47.960935179144144, 57.96278781443833, 64.03347396850586, 65.7542219236493, 47.66934064868835, 68.2064099535346, 30.789263179060043], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 155, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.855543628334999, 14.785771414637566, 14.243481203913689, 20.995539603754878, 20.63628412783146, 20.78927271068096, 23.70980842411518, 23.565338388085365, 23.135054692626, 21.442544994254902, 21.042103742559746, 21.55488499750693, 12.884784176945686, 12.73656165599823, 12.862654499709606, 7.178892253277198, 6.62319380541642, 7.017788772781685, 10.252409636974335, 10.959294507279992, 10.833127185702324, 24.72858553752303, 24.0170556306839, 24.769664742052555, 28.884921031693608, 29.141958537201077, 29.141295603166014, 16.44875457882881, 16.71740847080946, 16.663666650652885, 26.279671036017433, 25.778789070745304, 25.84245767196019, 28.715893055001885, 29.313924411932618, 29.383003457138926, 13.59910426909724, 13.777551176181674, 13.32604460666576, 20.26914144307375, 20.278209321200848, 20.68221580144018, 18.451023057103157, 18.683421045541763, 18.568566620349884, 25.690352772672966, 26.495740749252334, 26.34466067453225, 27.092908968528107, 29.03186672677596, 29.220662376222506, 22.393918255964905, 22.604771968598158, 22.175882304708153, 24.734085471679762, 24.72332415108879, 24.4393279676636, 25.320360582942754, 24.782836164037377, 24.77282928923765, 21.801871549338102, 21.842037070542574, 21.76255390420556, 27.5961056711773, 27.605351944143564, 27.261794599393994, 15.588528280456856, 15.696306367715195, 15.123843317230538, 18.218558906267077, 17.53472627202669, 17.86774897078672, 11.41590854277213, 11.944465610509113, 10.86212972303231, 24.68552130957444, 24.976691508044794, 25.05465583627422, 27.15774904688199, 27.364445903648928, 27.0229576130708, 22.27025753632188, 22.31158690340817, 22.089531242847443, 20.801380924880505, 21.083466392941773, 20.737454161047935, 27.666041178007916, 27.30354357262452, 27.91929367681344, 4.279790587723255, 4.25053308904171, 4.49456238374114, 20.988771530489117, 20.976458365718514, 21.095657671491296, 7.477047438422829, 6.707902173201234, 7.152904974917561, 17.98010831574598, 17.99542002255717, 17.464500496784837, 27.930037652452782, 28.74121437159677, 28.67346098956962, 21.051897789041192, 21.367772929991276, 21.189424144724995, 19.67988210916519, 20.016636449843645, 20.22270641475916, 19.950188814351947, 20.056381716082484, 19.93881984303394, 18.24378782014051, 18.4939703537772, 18.165583583215863, 17.10102755459957, 16.203405559062958, 16.632910184562206, 13.211112295587853, 12.908749630053833, 13.335580018659428, 16.654894346992165, 17.403329494098813, 17.528160619239003, 17.574306165178612, 18.039382107517056, 17.919207399090126, 22.118244762221963, 22.211679629671067, 22.207148023570568, 27.044591592624784, 26.399417236447334, 27.11517993104644, 22.76150741800666, 22.86481247935444, 22.904717014869675, 18.280256936947495, 18.56880959045762, 18.388981285194546, 19.93399892623225, 19.974821029851825, 19.46062038342157, 18.06066722919543, 18.05095362088953, 17.70018932720025, -1.26408712069194, -1.719668592015907, -1.271847086648151, 13.526914790272713, 13.744668811559677, 14.488851837813854, 26.603815510869026, 27.333105380646884, 27.253797382116318, 24.489684504767254, 24.489922513564423, 24.63503650327523, -95.75836356480917, -79.57740563650927, -79.62881438185772, 16.772732670108468, 16.80363309631744, 16.284066225091607, 0.46073779215414845, 0.48073071738083684, -0.6548197964827267, 21.40458859006563, 21.5921084533135, 21.222380767265946, 8.870201672116906, 9.668003323177487, 9.260190504292638, 16.259857061008603, 16.280109042922646, 16.241970824698598, -3.3249483431379048, -2.913159027152389, -2.9611185460041014, 0.6443180665373802, 0.8146197870373726, 0.7114494740962982, 27.386699177324772, 27.389850437641144, 26.253415912389755, 19.264113192756966, 20.123295241345957, 20.104622316857174, 10.22498909632364, 10.084711613754422, 10.062908905247838, 23.198284988601998, 23.462184832741812, 23.49380675454934, 27.994798839092255, 28.497170999646187, 28.536347288638353, 18.328293040394783, 18.21298934519291, 18.539178408682346, 13.589735219875962, 13.687384317318589, 14.174020236978919, 17.863090031469852, 17.66294170419374, 17.663356627027184, 18.959278186162308, 24.08286128317316, 23.729655166467026, 21.74983063712716, 21.674358136951923, 21.387737840414047, 14.667822955797106, 14.299049223462731, 14.383978019158036, -6.306705738107368, -6.165660994748279, -6.011000315348312, 22.502464932699993, 22.430646886428192, 22.982564839844898, 17.163148326178387, 17.63651261509706, 16.80803707738717, 22.976316408409417, 22.861383554215223, 22.139551664392144, 17.485941442350537, 17.55139177540937, 17.07108190159002, 19.761909956733376, 19.47884854177633, 20.221120829383523, 21.96797613799572, 22.31420573592186, 22.905580772086978, -2.697151849667236, -2.1786352495352475, -2.050077343980476, 21.572205782867968, 21.360481586307287, 21.28199879080057, 13.678317360579967, 14.142991539090872, 13.950581319630146, 12.345937733848885, 12.49656221022208, 12.63216970612605, 26.547765808800847, 26.222729126612336, 26.739278559262544, 26.625453467170388, 27.3677909101049, 27.61980381856361, 11.340725113948182, 11.951005518746868, 11.481371512015656, 12.67733770608902, 12.845291581004858, 12.451929405331612, 27.88852561016877, 27.871099335451916, 28.181119400387004, 16.842178026835114, 16.41921571890512, 17.099472540120274, 25.13320509592691, 25.70443802063042, 25.591681220258266, 20.50600141255805, 19.34278420607248, 20.180978695551545, 22.374798985819012, 22.099908063809067, 22.43346080618599, 25.17039195199807, 25.50001824771364, 25.442213011284665, 15.736183524131775, 15.986013859510422, 16.238737795501947, 19.386614148815468, 19.08826607962449, 19.48790758599837, 21.136366195976734, 21.37603570893407, 21.521072063595057, 21.858657171328858, 21.979815197487667, 21.91574955483277, 15.92123697573939, 15.7973993855218, 15.950704287427158, 22.619064062833786, 22.85583956539631, 22.731506325304508, 10.332952002218605, 10.178748706976563, 10.277562469864876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15358537487038532, "mean_inference_ms": 0.704740674003242, "mean_action_processing_ms": 0.10022304041263042, "mean_env_wait_ms": 0.8074766363949507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1621386, "timesteps_this_iter": 0, "agent_timesteps_total": 4864158, "timers": {"sample_time_ms": 20967.513, "sample_throughput": 457.565, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3144.64, "learn_throughput": 3050.906, "update_time_ms": 9.024}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1485643045846567e-13, "cur_lr": 0.0005, "total_loss": 7.205406904220581, "policy_loss": 0.0009251302525101757, "vf_loss": 7.380192399024963, "vf_explained_var": 0.03480033576488495, "kl": 0.006754222326238472, "entropy": 17.571035385131836, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1621386, "num_agent_steps_sampled": 4864158, "num_steps_trained": 1621386, "num_agent_steps_trained": 4864158, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6213, "training_iteration": 169, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-40-14", "timestamp": 1706193614, "time_this_iter_s": 21.435014724731445, "time_total_s": 3411.854256629944, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03566AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3411.854256629944, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 8.129032258064516, "ram_util_percent": 53.16129032258065}}
{"episode_reward_max": 85.34471301361917, "episode_reward_min": -254.96458358317616, "episode_reward_mean": 50.77605225937776, "episode_len_mean": 298.55, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -95.75836356480917}, "policy_reward_max": {"shared_policy": 28.74121437159677}, "policy_reward_mean": {"shared_policy": 16.92535075312591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.440028835087986, 85.34471301361917, 63.60909486375746, 59.919224973767996, 59.94539037346837, 54.903341757133575, 49.93734329822473, 39.455441944301114, 51.58638446032998, 53.532895671785795, 66.5370724154636, 80.55918876011856, 68.53103691223077, 55.23804781259966, 59.369440339505644, 53.81181017728521, -4.255602799355998, 41.760435439646244, 81.19071827363223, 73.61464352160691, -254.96458358317616, 49.860431991517515, 0.2866487130522586, 64.21907781064508, 27.79839549958703, 48.78193692862985, -9.199225916294395, 2.170387327671051, 81.02996552735567, 59.4920307509601, 30.3726096153259, 70.15427657589315, 85.0283171273768, 55.08046079427004, 41.45113977417347, 53.18938836269078, 66.7717946358025, 64.81192661449313, 43.350850198417874, -18.48336704820396, 67.91567665897308, 51.60769801866262, 67.97725162701678, 52.10841511934993, 59.46187932789323, 67.18776264600456, -6.9258644431829595, 64.21468615997583, 41.771890219300985, 37.474669650197015, 79.50977349467573, 81.6130481958389, 34.773102144710705, 37.97455869242549, 83.94074434600769, 50.36086628586051, 76.4293243368156, 60.029764314182074, 66.90816785581407, 76.11262321099638, 47.960935179144144, 57.96278781443833, 64.03347396850586, 65.7542219236493, 47.66934064868835, 68.2064099535346, 30.789263179060043, 51.93503852933644, 36.08575423061848, 46.862639501690865, 24.195345778018236, 60.45588806644079, 47.323635920882225, 68.87478557415305, 72.10615594685075, 55.77281439118087, 43.708201254470595, 57.240407541394205, 63.00634860433635, 63.96446247398852, 74.21810663864014, 61.578254815191016, 47.388773076236234, 70.7307443767786, 63.005113273859024, 21.17728264629841, 67.60975781828164, 45.42681748419997, 38.785881727933884, 3.954064231365905, 49.620566271245465, 81.26897685229775, 78.75399318896234, 52.29909955710173, 61.33138119243084, 54.09237602911887, 74.54883688688278, 71.13101541949435, 54.26094520837067, 72.83617915678767], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 155, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.98010831574598, 17.99542002255717, 17.464500496784837, 27.930037652452782, 28.74121437159677, 28.67346098956962, 21.051897789041192, 21.367772929991276, 21.189424144724995, 19.67988210916519, 20.016636449843645, 20.22270641475916, 19.950188814351947, 20.056381716082484, 19.93881984303394, 18.24378782014051, 18.4939703537772, 18.165583583215863, 17.10102755459957, 16.203405559062958, 16.632910184562206, 13.211112295587853, 12.908749630053833, 13.335580018659428, 16.654894346992165, 17.403329494098813, 17.528160619239003, 17.574306165178612, 18.039382107517056, 17.919207399090126, 22.118244762221963, 22.211679629671067, 22.207148023570568, 27.044591592624784, 26.399417236447334, 27.11517993104644, 22.76150741800666, 22.86481247935444, 22.904717014869675, 18.280256936947495, 18.56880959045762, 18.388981285194546, 19.93399892623225, 19.974821029851825, 19.46062038342157, 18.06066722919543, 18.05095362088953, 17.70018932720025, -1.26408712069194, -1.719668592015907, -1.271847086648151, 13.526914790272713, 13.744668811559677, 14.488851837813854, 26.603815510869026, 27.333105380646884, 27.253797382116318, 24.489684504767254, 24.489922513564423, 24.63503650327523, -95.75836356480917, -79.57740563650927, -79.62881438185772, 16.772732670108468, 16.80363309631744, 16.284066225091607, 0.46073779215414845, 0.48073071738083684, -0.6548197964827267, 21.40458859006563, 21.5921084533135, 21.222380767265946, 8.870201672116906, 9.668003323177487, 9.260190504292638, 16.259857061008603, 16.280109042922646, 16.241970824698598, -3.3249483431379048, -2.913159027152389, -2.9611185460041014, 0.6443180665373802, 0.8146197870373726, 0.7114494740962982, 27.386699177324772, 27.389850437641144, 26.253415912389755, 19.264113192756966, 20.123295241345957, 20.104622316857174, 10.22498909632364, 10.084711613754422, 10.062908905247838, 23.198284988601998, 23.462184832741812, 23.49380675454934, 27.994798839092255, 28.497170999646187, 28.536347288638353, 18.328293040394783, 18.21298934519291, 18.539178408682346, 13.589735219875962, 13.687384317318589, 14.174020236978919, 17.863090031469852, 17.66294170419374, 17.663356627027184, 18.959278186162308, 24.08286128317316, 23.729655166467026, 21.74983063712716, 21.674358136951923, 21.387737840414047, 14.667822955797106, 14.299049223462731, 14.383978019158036, -6.306705738107368, -6.165660994748279, -6.011000315348312, 22.502464932699993, 22.430646886428192, 22.982564839844898, 17.163148326178387, 17.63651261509706, 16.80803707738717, 22.976316408409417, 22.861383554215223, 22.139551664392144, 17.485941442350537, 17.55139177540937, 17.07108190159002, 19.761909956733376, 19.47884854177633, 20.221120829383523, 21.96797613799572, 22.31420573592186, 22.905580772086978, -2.697151849667236, -2.1786352495352475, -2.050077343980476, 21.572205782867968, 21.360481586307287, 21.28199879080057, 13.678317360579967, 14.142991539090872, 13.950581319630146, 12.345937733848885, 12.49656221022208, 12.63216970612605, 26.547765808800847, 26.222729126612336, 26.739278559262544, 26.625453467170388, 27.3677909101049, 27.61980381856361, 11.340725113948182, 11.951005518746868, 11.481371512015656, 12.67733770608902, 12.845291581004858, 12.451929405331612, 27.88852561016877, 27.871099335451916, 28.181119400387004, 16.842178026835114, 16.41921571890512, 17.099472540120274, 25.13320509592691, 25.70443802063042, 25.591681220258266, 20.50600141255805, 19.34278420607248, 20.180978695551545, 22.374798985819012, 22.099908063809067, 22.43346080618599, 25.17039195199807, 25.50001824771364, 25.442213011284665, 15.736183524131775, 15.986013859510422, 16.238737795501947, 19.386614148815468, 19.08826607962449, 19.48790758599837, 21.136366195976734, 21.37603570893407, 21.521072063595057, 21.858657171328858, 21.979815197487667, 21.91574955483277, 15.92123697573939, 15.7973993855218, 15.950704287427158, 22.619064062833786, 22.85583956539631, 22.731506325304508, 10.332952002218605, 10.178748706976563, 10.277562469864876, 17.439835791786507, 17.158903454740837, 17.336299282809094, 12.054290935397148, 11.626186609268188, 12.40527668595314, 15.636354342103004, 15.620096057653427, 15.606189101934433, 8.087839052081108, 8.567304719239473, 7.540202006697655, 20.19680793831745, 20.408056056747824, 19.85102407137552, 15.813338480889797, 15.841623045504093, 15.668674394488335, 23.21681080696483, 23.130496603747204, 22.527478163441018, 23.77207804719606, 23.896591181556374, 24.437486718098313, 18.865672692656517, 17.899612307548523, 19.007529390975833, 13.803634698192269, 14.991346058809228, 14.913220497469098, 18.79778134326139, 19.167369889716298, 19.275256308416516, 20.85685938100019, 20.810224855939538, 21.339264367396623, 21.3825849716862, 21.040608202417687, 21.541269299884632, 25.03295952330032, 25.148528813074023, 24.036618302265794, 20.909316969414547, 20.85201557849844, 19.81692226727803, 15.490921338399247, 15.821673472722367, 16.07617826511462, 23.570452388375998, 23.711297754198313, 23.448994234204292, 20.566395163536072, 21.251318264752626, 21.187399845570326, 7.210678152740002, 6.884378299117088, 7.0822261944413185, 22.97847480823596, 22.378491287430123, 22.252791722615555, 15.551395485798508, 14.329640338818223, 15.545781659583241, 12.763361245393753, 12.930609531700611, 13.09191095083952, 1.9180218068261894, 0.6282985707124027, 1.4077438538273128, 16.545959157248333, 16.639885534842804, 16.434721579154328, 27.43909741441408, 26.78598793844381, 27.043891499439866, 26.494218742474914, 25.96810919046402, 26.291665256023407, 17.28391556441784, 17.354416087269783, 17.660767905414104, 20.119498906036213, 20.65667276581128, 20.555209520583347, 17.485673661033303, 18.253542101631552, 18.35316026645401, 24.530669778585434, 25.08658091723919, 24.93158619105816, 23.9761834636641, 23.42415030797322, 23.730681647857025, 18.028539282580212, 17.992363361020878, 18.24004256476958, 24.197262822339923, 24.395179323541612, 24.24373701090613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15365863256684115, "mean_inference_ms": 0.7051093543646597, "mean_action_processing_ms": 0.10026199175006863, "mean_env_wait_ms": 0.807820050687424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1630980, "timesteps_this_iter": 0, "agent_timesteps_total": 4892940, "timers": {"sample_time_ms": 20953.622, "sample_throughput": 457.868, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3140.008, "learn_throughput": 3055.406, "update_time_ms": 9.026}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1485643045846567e-13, "cur_lr": 0.0005, "total_loss": 8.033189237117767, "policy_loss": 0.0033167344412006194, "vf_loss": 8.206649601459503, "vf_explained_var": -0.22097596526145935, "kl": 0.02266595338031868, "entropy": 17.677713632583618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1630980, "num_agent_steps_sampled": 4892940, "num_steps_trained": 1630980, "num_agent_steps_trained": 4892940, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6246, "training_iteration": 170, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-40-35", "timestamp": 1706193635, "time_this_iter_s": 20.742597341537476, "time_total_s": 3432.5968539714813, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B81700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3432.5968539714813, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 10.03448275862069, "ram_util_percent": 53.27241379310346}}
{"episode_reward_max": 85.0283171273768, "episode_reward_min": -18.48336704820396, "episode_reward_mean": 54.63682133896029, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -6.306705738107368}, "policy_reward_max": {"shared_policy": 28.536347288638353}, "policy_reward_mean": {"shared_policy": 18.212273779653422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.0283171273768, 55.08046079427004, 41.45113977417347, 53.18938836269078, 66.7717946358025, 64.81192661449313, 43.350850198417874, -18.48336704820396, 67.91567665897308, 51.60769801866262, 67.97725162701678, 52.10841511934993, 59.46187932789323, 67.18776264600456, -6.9258644431829595, 64.21468615997583, 41.771890219300985, 37.474669650197015, 79.50977349467573, 81.6130481958389, 34.773102144710705, 37.97455869242549, 83.94074434600769, 50.36086628586051, 76.4293243368156, 60.029764314182074, 66.90816785581407, 76.11262321099638, 47.960935179144144, 57.96278781443833, 64.03347396850586, 65.7542219236493, 47.66934064868835, 68.2064099535346, 30.789263179060043, 51.93503852933644, 36.08575423061848, 46.862639501690865, 24.195345778018236, 60.45588806644079, 47.323635920882225, 68.87478557415305, 72.10615594685075, 55.77281439118087, 43.708201254470595, 57.240407541394205, 63.00634860433635, 63.96446247398852, 74.21810663864014, 61.578254815191016, 47.388773076236234, 70.7307443767786, 63.005113273859024, 21.17728264629841, 67.60975781828164, 45.42681748419997, 38.785881727933884, 3.954064231365905, 49.620566271245465, 81.26897685229775, 78.75399318896234, 52.29909955710173, 61.33138119243084, 54.09237602911887, 74.54883688688278, 71.13101541949435, 54.26094520837067, 72.83617915678767, 37.07577730715275, 67.40588861331342, 43.22330596484244, 79.24401459470391, 55.84842265397309, 38.4269143734127, 69.10024144873022, 55.48355128616092, 46.58145089261234, 45.737959630787344, 32.90561173856257, 39.254358112812014, 32.63365159276873, 63.35219812393187, 54.79334458708763, 46.78368941694498, 65.55646219849584, 58.87358919531107, 64.89607056975362, 15.634726732969284, 65.62384778633712, 37.407210897188634, 63.99524392653255, 43.23058932647109, 69.34025445114818, 53.90538602694869, 64.23407676815984, 83.10902446880935, 47.30575281381604, 56.13470619916913, 47.81221621902657, 59.199971325695515], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [27.994798839092255, 28.497170999646187, 28.536347288638353, 18.328293040394783, 18.21298934519291, 18.539178408682346, 13.589735219875962, 13.687384317318589, 14.174020236978919, 17.863090031469852, 17.66294170419374, 17.663356627027184, 18.959278186162308, 24.08286128317316, 23.729655166467026, 21.74983063712716, 21.674358136951923, 21.387737840414047, 14.667822955797106, 14.299049223462731, 14.383978019158036, -6.306705738107368, -6.165660994748279, -6.011000315348312, 22.502464932699993, 22.430646886428192, 22.982564839844898, 17.163148326178387, 17.63651261509706, 16.80803707738717, 22.976316408409417, 22.861383554215223, 22.139551664392144, 17.485941442350537, 17.55139177540937, 17.07108190159002, 19.761909956733376, 19.47884854177633, 20.221120829383523, 21.96797613799572, 22.31420573592186, 22.905580772086978, -2.697151849667236, -2.1786352495352475, -2.050077343980476, 21.572205782867968, 21.360481586307287, 21.28199879080057, 13.678317360579967, 14.142991539090872, 13.950581319630146, 12.345937733848885, 12.49656221022208, 12.63216970612605, 26.547765808800847, 26.222729126612336, 26.739278559262544, 26.625453467170388, 27.3677909101049, 27.61980381856361, 11.340725113948182, 11.951005518746868, 11.481371512015656, 12.67733770608902, 12.845291581004858, 12.451929405331612, 27.88852561016877, 27.871099335451916, 28.181119400387004, 16.842178026835114, 16.41921571890512, 17.099472540120274, 25.13320509592691, 25.70443802063042, 25.591681220258266, 20.50600141255805, 19.34278420607248, 20.180978695551545, 22.374798985819012, 22.099908063809067, 22.43346080618599, 25.17039195199807, 25.50001824771364, 25.442213011284665, 15.736183524131775, 15.986013859510422, 16.238737795501947, 19.386614148815468, 19.08826607962449, 19.48790758599837, 21.136366195976734, 21.37603570893407, 21.521072063595057, 21.858657171328858, 21.979815197487667, 21.91574955483277, 15.92123697573939, 15.7973993855218, 15.950704287427158, 22.619064062833786, 22.85583956539631, 22.731506325304508, 10.332952002218605, 10.178748706976563, 10.277562469864876, 17.439835791786507, 17.158903454740837, 17.336299282809094, 12.054290935397148, 11.626186609268188, 12.40527668595314, 15.636354342103004, 15.620096057653427, 15.606189101934433, 8.087839052081108, 8.567304719239473, 7.540202006697655, 20.19680793831745, 20.408056056747824, 19.85102407137552, 15.813338480889797, 15.841623045504093, 15.668674394488335, 23.21681080696483, 23.130496603747204, 22.527478163441018, 23.77207804719606, 23.896591181556374, 24.437486718098313, 18.865672692656517, 17.899612307548523, 19.007529390975833, 13.803634698192269, 14.991346058809228, 14.913220497469098, 18.79778134326139, 19.167369889716298, 19.275256308416516, 20.85685938100019, 20.810224855939538, 21.339264367396623, 21.3825849716862, 21.040608202417687, 21.541269299884632, 25.03295952330032, 25.148528813074023, 24.036618302265794, 20.909316969414547, 20.85201557849844, 19.81692226727803, 15.490921338399247, 15.821673472722367, 16.07617826511462, 23.570452388375998, 23.711297754198313, 23.448994234204292, 20.566395163536072, 21.251318264752626, 21.187399845570326, 7.210678152740002, 6.884378299117088, 7.0822261944413185, 22.97847480823596, 22.378491287430123, 22.252791722615555, 15.551395485798508, 14.329640338818223, 15.545781659583241, 12.763361245393753, 12.930609531700611, 13.09191095083952, 1.9180218068261894, 0.6282985707124027, 1.4077438538273128, 16.545959157248333, 16.639885534842804, 16.434721579154328, 27.43909741441408, 26.78598793844381, 27.043891499439866, 26.494218742474914, 25.96810919046402, 26.291665256023407, 17.28391556441784, 17.354416087269783, 17.660767905414104, 20.119498906036213, 20.65667276581128, 20.555209520583347, 17.485673661033303, 18.253542101631552, 18.35316026645401, 24.530669778585434, 25.08658091723919, 24.93158619105816, 23.9761834636641, 23.42415030797322, 23.730681647857025, 18.028539282580212, 17.992363361020878, 18.24004256476958, 24.197262822339923, 24.395179323541612, 24.24373701090613, 12.523163542151451, 12.164504140615463, 12.388109624385834, 22.63264200588067, 22.469098800172404, 22.30414780726035, 14.271059401333332, 14.285649500787258, 14.666597062721848, 26.529438704252243, 26.299545377492905, 26.415030512958765, 18.201320086916283, 18.787060276915625, 18.86004229014118, 12.767756885538489, 12.96266255589822, 12.696494931975991, 23.01700187598665, 23.20797711362441, 22.875262459119156, 18.12506745258966, 18.637873909125716, 18.72060992444554, 15.553655607625842, 15.585607953369617, 15.442187331616879, 15.174492994944245, 15.330510760347039, 15.23295587549606, 10.776884992917374, 11.209368509550885, 10.919358236094311, 12.881808827320725, 13.325853819648415, 13.046695465842873, 10.972367716021836, 10.827239528298378, 10.834044348448515, 21.169869517286614, 20.860577588280037, 21.32175101836522, 18.140236362814903, 18.441537842154503, 18.211570382118225, 15.277610436081886, 15.714871488511562, 15.791207492351532, 22.361704016725213, 21.632042507330567, 21.562715674440057, 19.665863938629627, 19.781901851296425, 19.425823405385017, 21.110943774382264, 21.37981794277826, 22.405308852593095, 4.958857409656048, 5.411320701241493, 5.264548622071743, 21.321407606204346, 22.069328048576907, 22.23311213155587, 12.511395052075386, 11.788404643535614, 13.107411201577634, 21.473655565952257, 21.0448526268204, 21.476735733759895, 14.261752769351006, 14.361585184931755, 14.60725137218833, 22.642295638720185, 23.67893656125912, 23.019022251168877, 17.607275053858757, 18.091098994016647, 18.207011979073286, 20.26850939790407, 21.796808848778397, 22.168758521477372, 27.604515013595417, 27.80054297422369, 27.703966480990246, 15.766009921828896, 15.206150496999413, 16.333592394987733, 18.667370634774358, 18.613306912283093, 18.85402865211168, 15.986795217419655, 15.746866712967545, 16.078554288639367, 19.837420009076595, 20.09101352095604, 19.27153779566288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15365765562336578, "mean_inference_ms": 0.705316788051057, "mean_action_processing_ms": 0.10025769856699104, "mean_env_wait_ms": 0.8080297638877496, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1640574, "timesteps_this_iter": 0, "agent_timesteps_total": 4921722, "timers": {"sample_time_ms": 20969.267, "sample_throughput": 457.527, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3129.015, "learn_throughput": 3066.141, "update_time_ms": 9.026}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 5.679608643054962, "policy_loss": 0.0017365650632162888, "vf_loss": 5.854597330093384, "vf_explained_var": -0.012792758643627167, "kl": 0.01207825558984865, "entropy": 17.67254137992859, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1640574, "num_agent_steps_sampled": 4921722, "num_steps_trained": 1640574, "num_agent_steps_trained": 4921722, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6278, "training_iteration": 171, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-40-56", "timestamp": 1706193656, "time_this_iter_s": 20.723172187805176, "time_total_s": 3453.3200261592865, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B54040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3453.3200261592865, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 8.336666666666666, "ram_util_percent": 53.42666666666666}}
{"episode_reward_max": 98.18922255560754, "episode_reward_min": -316.9070963077247, "episode_reward_mean": 46.949120379392845, "episode_len_mean": 297.33, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -116.41165471076965}, "policy_reward_max": {"shared_policy": 32.85171026488145}, "policy_reward_mean": {"shared_policy": 15.649706793130942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.66934064868835, 68.2064099535346, 30.789263179060043, 51.93503852933644, 36.08575423061848, 46.862639501690865, 24.195345778018236, 60.45588806644079, 47.323635920882225, 68.87478557415305, 72.10615594685075, 55.77281439118087, 43.708201254470595, 57.240407541394205, 63.00634860433635, 63.96446247398852, 74.21810663864014, 61.578254815191016, 47.388773076236234, 70.7307443767786, 63.005113273859024, 21.17728264629841, 67.60975781828164, 45.42681748419997, 38.785881727933884, 3.954064231365905, 49.620566271245465, 81.26897685229775, 78.75399318896234, 52.29909955710173, 61.33138119243084, 54.09237602911887, 74.54883688688278, 71.13101541949435, 54.26094520837067, 72.83617915678767, 37.07577730715275, 67.40588861331342, 43.22330596484244, 79.24401459470391, 55.84842265397309, 38.4269143734127, 69.10024144873022, 55.48355128616092, 46.58145089261234, 45.737959630787344, 32.90561173856257, 39.254358112812014, 32.63365159276873, 63.35219812393187, 54.79334458708763, 46.78368941694498, 65.55646219849584, 58.87358919531107, 64.89607056975362, 15.634726732969284, 65.62384778633712, 37.407210897188634, 63.99524392653255, 43.23058932647109, 69.34025445114818, 53.90538602694869, 64.23407676815984, 83.10902446880935, 47.30575281381604, 56.13470619916913, 47.81221621902657, 59.199971325695515, 34.00653717853129, 36.896254822611795, 53.30627869442104, 76.62193332542662, 58.94059391412881, -315.6977189211175, 7.37075822055337, 67.69988430477677, 46.4569438882172, 41.53068364970386, 54.2259673839435, 36.96545486897227, 63.16948050400242, 62.10208450257775, 81.77528710104524, 72.43818405270575, 40.35776232928036, 67.88023222703484, 89.68033598735929, 47.01586814969775, 70.93493487685919, 56.313405958004296, 60.403240356594324, 98.18922255560754, 69.17630299180746, -316.9070963077247, 53.187401620671125, 67.49994386546311, 52.31442797929047, 43.73739219829437, -1.880135141313076, 32.876024112105355], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 258, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 75, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.92123697573939, 15.7973993855218, 15.950704287427158, 22.619064062833786, 22.85583956539631, 22.731506325304508, 10.332952002218605, 10.178748706976563, 10.277562469864876, 17.439835791786507, 17.158903454740837, 17.336299282809094, 12.054290935397148, 11.626186609268188, 12.40527668595314, 15.636354342103004, 15.620096057653427, 15.606189101934433, 8.087839052081108, 8.567304719239473, 7.540202006697655, 20.19680793831745, 20.408056056747824, 19.85102407137552, 15.813338480889797, 15.841623045504093, 15.668674394488335, 23.21681080696483, 23.130496603747204, 22.527478163441018, 23.77207804719606, 23.896591181556374, 24.437486718098313, 18.865672692656517, 17.899612307548523, 19.007529390975833, 13.803634698192269, 14.991346058809228, 14.913220497469098, 18.79778134326139, 19.167369889716298, 19.275256308416516, 20.85685938100019, 20.810224855939538, 21.339264367396623, 21.3825849716862, 21.040608202417687, 21.541269299884632, 25.03295952330032, 25.148528813074023, 24.036618302265794, 20.909316969414547, 20.85201557849844, 19.81692226727803, 15.490921338399247, 15.821673472722367, 16.07617826511462, 23.570452388375998, 23.711297754198313, 23.448994234204292, 20.566395163536072, 21.251318264752626, 21.187399845570326, 7.210678152740002, 6.884378299117088, 7.0822261944413185, 22.97847480823596, 22.378491287430123, 22.252791722615555, 15.551395485798508, 14.329640338818223, 15.545781659583241, 12.763361245393753, 12.930609531700611, 13.09191095083952, 1.9180218068261894, 0.6282985707124027, 1.4077438538273128, 16.545959157248333, 16.639885534842804, 16.434721579154328, 27.43909741441408, 26.78598793844381, 27.043891499439866, 26.494218742474914, 25.96810919046402, 26.291665256023407, 17.28391556441784, 17.354416087269783, 17.660767905414104, 20.119498906036213, 20.65667276581128, 20.555209520583347, 17.485673661033303, 18.253542101631552, 18.35316026645401, 24.530669778585434, 25.08658091723919, 24.93158619105816, 23.9761834636641, 23.42415030797322, 23.730681647857025, 18.028539282580212, 17.992363361020878, 18.24004256476958, 24.197262822339923, 24.395179323541612, 24.24373701090613, 12.523163542151451, 12.164504140615463, 12.388109624385834, 22.63264200588067, 22.469098800172404, 22.30414780726035, 14.271059401333332, 14.285649500787258, 14.666597062721848, 26.529438704252243, 26.299545377492905, 26.415030512958765, 18.201320086916283, 18.787060276915625, 18.86004229014118, 12.767756885538489, 12.96266255589822, 12.696494931975991, 23.01700187598665, 23.20797711362441, 22.875262459119156, 18.12506745258966, 18.637873909125716, 18.72060992444554, 15.553655607625842, 15.585607953369617, 15.442187331616879, 15.174492994944245, 15.330510760347039, 15.23295587549606, 10.776884992917374, 11.209368509550885, 10.919358236094311, 12.881808827320725, 13.325853819648415, 13.046695465842873, 10.972367716021836, 10.827239528298378, 10.834044348448515, 21.169869517286614, 20.860577588280037, 21.32175101836522, 18.140236362814903, 18.441537842154503, 18.211570382118225, 15.277610436081886, 15.714871488511562, 15.791207492351532, 22.361704016725213, 21.632042507330567, 21.562715674440057, 19.665863938629627, 19.781901851296425, 19.425823405385017, 21.110943774382264, 21.37981794277826, 22.405308852593095, 4.958857409656048, 5.411320701241493, 5.264548622071743, 21.321407606204346, 22.069328048576907, 22.23311213155587, 12.511395052075386, 11.788404643535614, 13.107411201577634, 21.473655565952257, 21.0448526268204, 21.476735733759895, 14.261752769351006, 14.361585184931755, 14.60725137218833, 22.642295638720185, 23.67893656125912, 23.019022251168877, 17.607275053858757, 18.091098994016647, 18.207011979073286, 20.26850939790407, 21.796808848778397, 22.168758521477372, 27.604515013595417, 27.80054297422369, 27.703966480990246, 15.766009921828896, 15.206150496999413, 16.333592394987733, 18.667370634774358, 18.613306912283093, 18.85402865211168, 15.986795217419655, 15.746866712967545, 16.078554288639367, 19.837420009076595, 20.09101352095604, 19.27153779566288, 11.703495686873794, 11.7296188659966, 10.573422625660896, 12.239772339661911, 12.189506364365414, 12.46697611858447, 17.844623248403266, 17.947581033532813, 17.51407441248496, 24.54661218325296, 26.08619180500196, 25.989129337171704, 19.88699670477459, 19.703645865122468, 19.349951344231755, -116.41165471076965, -99.54239671956748, -99.74366749078035, 2.142190466324479, 2.544186691443116, 2.684381062785775, 22.843272201096013, 22.563255940874413, 22.293356162806347, 15.507993148018912, 15.70760904749234, 15.241341692705944, 13.69703297317028, 13.997849559411407, 13.835801117122173, 18.19748680945486, 18.055459190160036, 17.973021384328604, 11.756485755244881, 12.613432909051568, 12.595536204675824, 20.73727622628212, 21.05129148811102, 21.380912789609283, 21.03197533885637, 20.265492911140115, 20.80461625258127, 27.034961332877472, 27.281237499167517, 27.459088269000247, 24.26181072586526, 24.23709818379332, 23.93927514304717, 13.35580576707919, 13.507558745642498, 13.494397816558674, 22.62897816176215, 22.649073909657687, 22.602180155615002, 30.070583187043667, 29.69713043421507, 29.91262236610055, 16.01539249966541, 15.580187807480485, 15.420287842551858, 23.633435778319836, 23.477134257555008, 23.824364840984344, 18.51853498071432, 18.919937185011804, 18.87493379227817, 20.041214480996132, 20.2537749633193, 20.10825091227889, 32.49905062963565, 32.85171026488145, 32.83846166109045, 23.075195610523224, 23.189825139939785, 22.911282241344452, -102.1123361736536, -111.25145107135177, -103.54330906271935, 17.695629770557076, 17.575206036368996, 17.916565813745052, 21.94617239634195, 22.803583302224666, 22.750188166896493, 17.022809361418084, 17.515282606085137, 17.77633601178725, 14.679005088905484, 14.772283210108668, 14.28610389928022, -0.23081812262535095, -1.4155452251434326, -0.23377179354429245, 11.038004351158932, 11.201857072611645, 10.636162688334778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371186852371152, "mean_inference_ms": 0.7054318557399423, "mean_action_processing_ms": 0.1002381313263194, "mean_env_wait_ms": 0.8081428099017012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1650168, "timesteps_this_iter": 0, "agent_timesteps_total": 4950504, "timers": {"sample_time_ms": 20942.735, "sample_throughput": 458.106, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3110.381, "learn_throughput": 3084.509, "update_time_ms": 8.819}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 57.308239459991455, "policy_loss": -0.0006580718204302061, "vf_loss": 57.48650074005127, "vf_explained_var": 0.0831260234117508, "kl": 0.007275279262370969, "entropy": 17.76013445854187, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1650168, "num_agent_steps_sampled": 4950504, "num_steps_trained": 1650168, "num_agent_steps_trained": 4950504, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6310, "training_iteration": 172, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-41-16", "timestamp": 1706193676, "time_this_iter_s": 20.088539600372314, "time_total_s": 3473.408565759659, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A101F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3473.408565759659, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 8.571428571428571, "ram_util_percent": 53.55}}
{"episode_reward_max": 98.18922255560754, "episode_reward_min": -316.9070963077247, "episode_reward_mean": 47.48356786729301, "episode_len_mean": 297.33, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -116.41165471076965}, "policy_reward_max": {"shared_policy": 32.85171026488145}, "policy_reward_mean": {"shared_policy": 15.827855955764335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.54883688688278, 71.13101541949435, 54.26094520837067, 72.83617915678767, 37.07577730715275, 67.40588861331342, 43.22330596484244, 79.24401459470391, 55.84842265397309, 38.4269143734127, 69.10024144873022, 55.48355128616092, 46.58145089261234, 45.737959630787344, 32.90561173856257, 39.254358112812014, 32.63365159276873, 63.35219812393187, 54.79334458708763, 46.78368941694498, 65.55646219849584, 58.87358919531107, 64.89607056975362, 15.634726732969284, 65.62384778633712, 37.407210897188634, 63.99524392653255, 43.23058932647109, 69.34025445114818, 53.90538602694869, 64.23407676815984, 83.10902446880935, 47.30575281381604, 56.13470619916913, 47.81221621902657, 59.199971325695515, 34.00653717853129, 36.896254822611795, 53.30627869442104, 76.62193332542662, 58.94059391412881, -315.6977189211175, 7.37075822055337, 67.69988430477677, 46.4569438882172, 41.53068364970386, 54.2259673839435, 36.96545486897227, 63.16948050400242, 62.10208450257775, 81.77528710104524, 72.43818405270575, 40.35776232928036, 67.88023222703484, 89.68033598735929, 47.01586814969775, 70.93493487685919, 56.313405958004296, 60.403240356594324, 98.18922255560754, 69.17630299180746, -316.9070963077247, 53.187401620671125, 67.49994386546311, 52.31442797929047, 43.73739219829437, -1.880135141313076, 32.876024112105355, 59.5398243255913, 42.5573799666017, 56.70893072336909, 7.511049851775155, 44.170421630144105, 41.64661814644933, 50.75451052188872, 53.101110167801366, 44.803000800311565, 74.5134322531521, 71.50861853733659, 96.36027020029721, 70.72484727296977, 68.26798421330749, 66.8655052874237, 52.18513462692499, 5.98567836428991, 75.86821658909318, 64.79464481584728, 60.67634068243204, 94.42159025743602, 72.67739116773008, 65.25247681140897, 40.62807511072606, 54.97682092478496, 46.032757036387906, 63.31018826272337, 64.69248504377902, 61.844988726079436, 84.00751088280228, -16.60878516174853, 23.103411525487886], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 258, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 75, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.530669778585434, 25.08658091723919, 24.93158619105816, 23.9761834636641, 23.42415030797322, 23.730681647857025, 18.028539282580212, 17.992363361020878, 18.24004256476958, 24.197262822339923, 24.395179323541612, 24.24373701090613, 12.523163542151451, 12.164504140615463, 12.388109624385834, 22.63264200588067, 22.469098800172404, 22.30414780726035, 14.271059401333332, 14.285649500787258, 14.666597062721848, 26.529438704252243, 26.299545377492905, 26.415030512958765, 18.201320086916283, 18.787060276915625, 18.86004229014118, 12.767756885538489, 12.96266255589822, 12.696494931975991, 23.01700187598665, 23.20797711362441, 22.875262459119156, 18.12506745258966, 18.637873909125716, 18.72060992444554, 15.553655607625842, 15.585607953369617, 15.442187331616879, 15.174492994944245, 15.330510760347039, 15.23295587549606, 10.776884992917374, 11.209368509550885, 10.919358236094311, 12.881808827320725, 13.325853819648415, 13.046695465842873, 10.972367716021836, 10.827239528298378, 10.834044348448515, 21.169869517286614, 20.860577588280037, 21.32175101836522, 18.140236362814903, 18.441537842154503, 18.211570382118225, 15.277610436081886, 15.714871488511562, 15.791207492351532, 22.361704016725213, 21.632042507330567, 21.562715674440057, 19.665863938629627, 19.781901851296425, 19.425823405385017, 21.110943774382264, 21.37981794277826, 22.405308852593095, 4.958857409656048, 5.411320701241493, 5.264548622071743, 21.321407606204346, 22.069328048576907, 22.23311213155587, 12.511395052075386, 11.788404643535614, 13.107411201577634, 21.473655565952257, 21.0448526268204, 21.476735733759895, 14.261752769351006, 14.361585184931755, 14.60725137218833, 22.642295638720185, 23.67893656125912, 23.019022251168877, 17.607275053858757, 18.091098994016647, 18.207011979073286, 20.26850939790407, 21.796808848778397, 22.168758521477372, 27.604515013595417, 27.80054297422369, 27.703966480990246, 15.766009921828896, 15.206150496999413, 16.333592394987733, 18.667370634774358, 18.613306912283093, 18.85402865211168, 15.986795217419655, 15.746866712967545, 16.078554288639367, 19.837420009076595, 20.09101352095604, 19.27153779566288, 11.703495686873794, 11.7296188659966, 10.573422625660896, 12.239772339661911, 12.189506364365414, 12.46697611858447, 17.844623248403266, 17.947581033532813, 17.51407441248496, 24.54661218325296, 26.08619180500196, 25.989129337171704, 19.88699670477459, 19.703645865122468, 19.349951344231755, -116.41165471076965, -99.54239671956748, -99.74366749078035, 2.142190466324479, 2.544186691443116, 2.684381062785775, 22.843272201096013, 22.563255940874413, 22.293356162806347, 15.507993148018912, 15.70760904749234, 15.241341692705944, 13.69703297317028, 13.997849559411407, 13.835801117122173, 18.19748680945486, 18.055459190160036, 17.973021384328604, 11.756485755244881, 12.613432909051568, 12.595536204675824, 20.73727622628212, 21.05129148811102, 21.380912789609283, 21.03197533885637, 20.265492911140115, 20.80461625258127, 27.034961332877472, 27.281237499167517, 27.459088269000247, 24.26181072586526, 24.23709818379332, 23.93927514304717, 13.35580576707919, 13.507558745642498, 13.494397816558674, 22.62897816176215, 22.649073909657687, 22.602180155615002, 30.070583187043667, 29.69713043421507, 29.91262236610055, 16.01539249966541, 15.580187807480485, 15.420287842551858, 23.633435778319836, 23.477134257555008, 23.824364840984344, 18.51853498071432, 18.919937185011804, 18.87493379227817, 20.041214480996132, 20.2537749633193, 20.10825091227889, 32.49905062963565, 32.85171026488145, 32.83846166109045, 23.075195610523224, 23.189825139939785, 22.911282241344452, -102.1123361736536, -111.25145107135177, -103.54330906271935, 17.695629770557076, 17.575206036368996, 17.916565813745052, 21.94617239634195, 22.803583302224666, 22.750188166896493, 17.022809361418084, 17.515282606085137, 17.77633601178725, 14.679005088905484, 14.772283210108668, 14.28610389928022, -0.23081812262535095, -1.4155452251434326, -0.23377179354429245, 11.038004351158932, 11.201857072611645, 10.636162688334778, 18.548057089249284, 20.317781540254742, 20.67398569608727, 13.994611116747052, 14.264799567560345, 14.297969282294304, 19.18908783296743, 19.182548346618802, 18.33729454378286, 2.55367900182803, 2.7015310799082073, 2.255839770038918, 14.708266173799828, 14.776232456167534, 14.685923000176743, 13.958812192082405, 13.884823717176914, 13.802982237190008, 17.1395392542084, 16.515075658758477, 17.09989560892184, 17.663148333628968, 18.281526294847325, 17.156435539325074, 14.647539518773556, 15.162189826369286, 14.993271455168724, 24.702389451364667, 25.03130106876293, 24.779741733024508, 23.772881031036377, 23.417532742023468, 24.318204764276743, 31.46262867252031, 32.225863876442105, 32.67177765133479, 23.614727937926844, 23.740724468914166, 23.369394866128758, 22.112791885932282, 22.71845621367295, 23.436736113702253, 22.62096628236273, 21.932169298330933, 22.31236970673004, 17.44259212166071, 17.37037841230631, 17.372164092957973, 1.871805494030312, 2.0493561661181303, 2.064516704141468, 25.30035476634899, 25.274620758990437, 25.293241063753754, 21.729322765022516, 21.34992714971304, 21.715394901111722, 19.816550453503922, 20.26793922235568, 20.59185100657244, 31.405932632585362, 31.555938897033528, 31.459718727817133, 23.061202992995575, 24.76283785452445, 24.853350320210055, 21.802170351768524, 21.624148814628512, 21.826157645011932, 12.842088714241982, 13.953810199163854, 13.832176197320223, 18.048927548031003, 18.441118776487798, 18.48677460026616, 15.026886408527687, 15.40115090211232, 15.604719725747898, 21.06055251260598, 21.266099926394716, 20.983535823722676, 21.22833162546158, 21.74170408397913, 21.722449334338307, 20.416842165092618, 20.84678395340839, 20.581362607578427, 27.706461312870175, 28.228082835363836, 28.07296673456827, -6.0264685451984406, -5.6251842230558395, -4.957132393494248, 7.992806534593299, 7.880208983396486, 7.230396007498101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15368139467139494, "mean_inference_ms": 0.7055050853366478, "mean_action_processing_ms": 0.1002481238088037, "mean_env_wait_ms": 0.8081988598676105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1659762, "timesteps_this_iter": 0, "agent_timesteps_total": 4979286, "timers": {"sample_time_ms": 20813.302, "sample_throughput": 460.955, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3093.792, "learn_throughput": 3101.049, "update_time_ms": 8.868}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 7.446109354496002, "policy_loss": -0.0008784336810920834, "vf_loss": 7.6234641671180725, "vf_explained_var": -0.06987448036670685, "kl": 0.005117213164607946, "entropy": 17.647634267807007, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1659762, "num_agent_steps_sampled": 4979286, "num_steps_trained": 1659762, "num_agent_steps_trained": 4979286, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6342, "training_iteration": 173, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-41-35", "timestamp": 1706193695, "time_this_iter_s": 19.41958451271057, "time_total_s": 3492.8281502723694, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004C9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3492.8281502723694, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 9.166666666666666, "ram_util_percent": 53.31851851851852}}
{"episode_reward_max": 98.18922255560754, "episode_reward_min": -316.9070963077247, "episode_reward_mean": 31.45441859012003, "episode_len_mean": 291.22, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -116.41165471076965}, "policy_reward_max": {"shared_policy": 32.85171026488145}, "policy_reward_mean": {"shared_policy": 10.484806196706673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.199971325695515, 34.00653717853129, 36.896254822611795, 53.30627869442104, 76.62193332542662, 58.94059391412881, -315.6977189211175, 7.37075822055337, 67.69988430477677, 46.4569438882172, 41.53068364970386, 54.2259673839435, 36.96545486897227, 63.16948050400242, 62.10208450257775, 81.77528710104524, 72.43818405270575, 40.35776232928036, 67.88023222703484, 89.68033598735929, 47.01586814969775, 70.93493487685919, 56.313405958004296, 60.403240356594324, 98.18922255560754, 69.17630299180746, -316.9070963077247, 53.187401620671125, 67.49994386546311, 52.31442797929047, 43.73739219829437, -1.880135141313076, 32.876024112105355, 59.5398243255913, 42.5573799666017, 56.70893072336909, 7.511049851775155, 44.170421630144105, 41.64661814644933, 50.75451052188872, 53.101110167801366, 44.803000800311565, 74.5134322531521, 71.50861853733659, 96.36027020029721, 70.72484727296977, 68.26798421330749, 66.8655052874237, 52.18513462692499, 5.98567836428991, 75.86821658909318, 64.79464481584728, 60.67634068243204, 94.42159025743602, 72.67739116773008, 65.25247681140897, 40.62807511072606, 54.97682092478496, 46.032757036387906, 63.31018826272337, 64.69248504377902, 61.844988726079436, 84.00751088280228, -16.60878516174853, 23.103411525487886, 56.82432166114447, 76.66928329691291, 65.35350828617811, 52.19771660864352, 7.5249951258301735, 78.99400683376007, -283.3249644115567, 40.62738717719911, -265.89214757457376, 59.659525558352456, 82.27288082800804, -315.9296889342368, -7.884758450090885, 22.05046878941357, 61.012240663170815, 69.85497172363102, 2.692326545715318, 62.31981332600117, 66.03582068346438, 69.80791624262929, 19.22935870266518, 44.886406900361166, 17.15325897373259, 59.58558386191726, 38.254075974225984, -269.1855099722743, 25.567848782986403, 49.88980895280835, 64.6854222975671, 51.775637760758386, 45.59984961152075, 53.45938765723258, 83.16858627647159, 10.084751892834888, 19.751495219767094], "episode_lengths": [300, 300, 300, 300, 300, 300, 258, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 75, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 203, 300, 189, 300, 300, 97, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 100, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.837420009076595, 20.09101352095604, 19.27153779566288, 11.703495686873794, 11.7296188659966, 10.573422625660896, 12.239772339661911, 12.189506364365414, 12.46697611858447, 17.844623248403266, 17.947581033532813, 17.51407441248496, 24.54661218325296, 26.08619180500196, 25.989129337171704, 19.88699670477459, 19.703645865122468, 19.349951344231755, -116.41165471076965, -99.54239671956748, -99.74366749078035, 2.142190466324479, 2.544186691443116, 2.684381062785775, 22.843272201096013, 22.563255940874413, 22.293356162806347, 15.507993148018912, 15.70760904749234, 15.241341692705944, 13.69703297317028, 13.997849559411407, 13.835801117122173, 18.19748680945486, 18.055459190160036, 17.973021384328604, 11.756485755244881, 12.613432909051568, 12.595536204675824, 20.73727622628212, 21.05129148811102, 21.380912789609283, 21.03197533885637, 20.265492911140115, 20.80461625258127, 27.034961332877472, 27.281237499167517, 27.459088269000247, 24.26181072586526, 24.23709818379332, 23.93927514304717, 13.35580576707919, 13.507558745642498, 13.494397816558674, 22.62897816176215, 22.649073909657687, 22.602180155615002, 30.070583187043667, 29.69713043421507, 29.91262236610055, 16.01539249966541, 15.580187807480485, 15.420287842551858, 23.633435778319836, 23.477134257555008, 23.824364840984344, 18.51853498071432, 18.919937185011804, 18.87493379227817, 20.041214480996132, 20.2537749633193, 20.10825091227889, 32.49905062963565, 32.85171026488145, 32.83846166109045, 23.075195610523224, 23.189825139939785, 22.911282241344452, -102.1123361736536, -111.25145107135177, -103.54330906271935, 17.695629770557076, 17.575206036368996, 17.916565813745052, 21.94617239634195, 22.803583302224666, 22.750188166896493, 17.022809361418084, 17.515282606085137, 17.77633601178725, 14.679005088905484, 14.772283210108668, 14.28610389928022, -0.23081812262535095, -1.4155452251434326, -0.23377179354429245, 11.038004351158932, 11.201857072611645, 10.636162688334778, 18.548057089249284, 20.317781540254742, 20.67398569608727, 13.994611116747052, 14.264799567560345, 14.297969282294304, 19.18908783296743, 19.182548346618802, 18.33729454378286, 2.55367900182803, 2.7015310799082073, 2.255839770038918, 14.708266173799828, 14.776232456167534, 14.685923000176743, 13.958812192082405, 13.884823717176914, 13.802982237190008, 17.1395392542084, 16.515075658758477, 17.09989560892184, 17.663148333628968, 18.281526294847325, 17.156435539325074, 14.647539518773556, 15.162189826369286, 14.993271455168724, 24.702389451364667, 25.03130106876293, 24.779741733024508, 23.772881031036377, 23.417532742023468, 24.318204764276743, 31.46262867252031, 32.225863876442105, 32.67177765133479, 23.614727937926844, 23.740724468914166, 23.369394866128758, 22.112791885932282, 22.71845621367295, 23.436736113702253, 22.62096628236273, 21.932169298330933, 22.31236970673004, 17.44259212166071, 17.37037841230631, 17.372164092957973, 1.871805494030312, 2.0493561661181303, 2.064516704141468, 25.30035476634899, 25.274620758990437, 25.293241063753754, 21.729322765022516, 21.34992714971304, 21.715394901111722, 19.816550453503922, 20.26793922235568, 20.59185100657244, 31.405932632585362, 31.555938897033528, 31.459718727817133, 23.061202992995575, 24.76283785452445, 24.853350320210055, 21.802170351768524, 21.624148814628512, 21.826157645011932, 12.842088714241982, 13.953810199163854, 13.832176197320223, 18.048927548031003, 18.441118776487798, 18.48677460026616, 15.026886408527687, 15.40115090211232, 15.604719725747898, 21.06055251260598, 21.266099926394716, 20.983535823722676, 21.22833162546158, 21.74170408397913, 21.722449334338307, 20.416842165092618, 20.84678395340839, 20.581362607578427, 27.706461312870175, 28.228082835363836, 28.07296673456827, -6.0264685451984406, -5.6251842230558395, -4.957132393494248, 7.992806534593299, 7.880208983396486, 7.230396007498101, 18.87834474692741, 18.90148693944016, 19.044489974776894, 25.868931900709867, 25.005420804023743, 25.7949305921793, 21.43021395802498, 22.1430836096406, 21.780210718512535, 17.106934388478592, 17.285736997922257, 17.80504522224267, 2.4830996841192245, 2.5312280878424644, 2.5106673538684845, 26.503560503944755, 26.639279515249655, 25.85116681456566, -91.11906370520592, -100.55501306802034, -91.65088763833046, 12.911888619263962, 13.959507697572306, 13.755990860362843, -96.84620913863182, -84.59987635537982, -84.44606208056211, 20.06025980909665, 20.040180419882134, 19.559085329373673, 27.22097114225228, 27.996178414051727, 27.055731271704033, -102.09367859860262, -111.41815816735229, -102.41785216828188, -2.3807039484381676, -2.494622766971588, -3.0094317346811295, 7.740943865850568, 6.9948775470256805, 7.314647376537323, 20.73644097149372, 20.120401933789253, 20.15539775788784, 23.38152745552361, 23.45051870495081, 23.022925563156605, 0.9879233737786564, 0.7980611224969181, 0.9063420494397434, 20.712109304964542, 21.022832788527012, 20.584871232509613, 22.078893423701317, 22.010089984784514, 21.94683727497855, 22.816817194223404, 23.442784689366817, 23.548314359039068, 5.916275625427559, 6.893927012647808, 6.419156064589814, 14.971080989887312, 14.703995538254574, 15.21133037221928, 5.493059433996677, 5.888074884191155, 5.772124655544758, 20.305849742144346, 19.5671533793211, 19.712580740451813, 12.501086403926209, 12.568274473150566, 13.184715097149208, -94.0872772137324, -87.63441287974517, -87.46381987879674, 8.499073084443808, 8.568599555641413, 8.500176142901182, 16.73262288297215, 16.68145829314986, 16.47572777668634, 21.72529728586474, 21.379576953748852, 21.580548057953507, 17.331532677014664, 17.198707488675907, 17.245397595067814, 15.181580675144986, 15.250028898318604, 15.168240038057164, 18.035407369956374, 17.32844890654087, 18.095531380735338, 27.677109430233628, 27.76209749529758, 27.729379350940377, 3.2805608746906074, 3.4090481021751913, 3.395142915969089, 6.741918910294771, 6.42071970552206, 6.588856603950262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536752860197581, "mean_inference_ms": 0.7053479964012221, "mean_action_processing_ms": 0.10018630755587553, "mean_env_wait_ms": 0.8081294898699841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1669356, "timesteps_this_iter": 0, "agent_timesteps_total": 5008068, "timers": {"sample_time_ms": 20675.063, "sample_throughput": 464.037, "load_time_ms": 0.2, "load_throughput": 47956325.32, "learn_time_ms": 3074.04, "learn_throughput": 3120.974, "update_time_ms": 8.923}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 173.14067268371582, "policy_loss": -0.00047132809554262245, "vf_loss": 173.31946754455566, "vf_explained_var": 0.065901979804039, "kl": 0.010177538206609254, "entropy": 17.83198070526123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1669356, "num_agent_steps_sampled": 5008068, "num_steps_trained": 1669356, "num_agent_steps_trained": 5008068, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6377, "training_iteration": 174, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-41-55", "timestamp": 1706193715, "time_this_iter_s": 19.832313776016235, "time_total_s": 3512.6604640483856, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BB8040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3512.6604640483856, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 8.735714285714288, "ram_util_percent": 53.13214285714287}}
{"episode_reward_max": 96.36027020029721, "episode_reward_min": -315.9296889342368, "episode_reward_mean": 36.72471215156488, "episode_len_mean": 293.89, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -111.41815816735229}, "policy_reward_max": {"shared_policy": 32.67177765133479}, "policy_reward_mean": {"shared_policy": 12.241570717188292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.73739219829437, -1.880135141313076, 32.876024112105355, 59.5398243255913, 42.5573799666017, 56.70893072336909, 7.511049851775155, 44.170421630144105, 41.64661814644933, 50.75451052188872, 53.101110167801366, 44.803000800311565, 74.5134322531521, 71.50861853733659, 96.36027020029721, 70.72484727296977, 68.26798421330749, 66.8655052874237, 52.18513462692499, 5.98567836428991, 75.86821658909318, 64.79464481584728, 60.67634068243204, 94.42159025743602, 72.67739116773008, 65.25247681140897, 40.62807511072606, 54.97682092478496, 46.032757036387906, 63.31018826272337, 64.69248504377902, 61.844988726079436, 84.00751088280228, -16.60878516174853, 23.103411525487886, 56.82432166114447, 76.66928329691291, 65.35350828617811, 52.19771660864352, 7.5249951258301735, 78.99400683376007, -283.3249644115567, 40.62738717719911, -265.89214757457376, 59.659525558352456, 82.27288082800804, -315.9296889342368, -7.884758450090885, 22.05046878941357, 61.012240663170815, 69.85497172363102, 2.692326545715318, 62.31981332600117, 66.03582068346438, 69.80791624262929, 19.22935870266518, 44.886406900361166, 17.15325897373259, 59.58558386191726, 38.254075974225984, -269.1855099722743, 25.567848782986403, 49.88980895280835, 64.6854222975671, 51.775637760758386, 45.59984961152075, 53.45938765723258, 83.16858627647159, 10.084751892834888, 19.751495219767094, 30.643475458025904, 42.75572909414768, 31.67102551460266, 64.3305112570524, 70.23982984945175, 53.45855503762141, 63.129519451409564, 46.4600478224456, 31.194717720150948, 65.39514522254466, 53.03432752192019, 74.58407558919859, 72.26810441352426, 72.09157216083257, 37.817632136866436, 64.35311882942912, 29.239537321031094, 10.733494497835636, 62.900239042937756, 69.1763796135783, 40.02261117473245, 84.09337323298678, 76.69486389309165, 69.65209430304822, 17.851813486777218, 44.94611004553735, 52.34746760502455, 6.595907725393758, 53.35039706528184, 29.05224146414548], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 203, 300, 189, 300, 300, 97, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 100, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [14.679005088905484, 14.772283210108668, 14.28610389928022, -0.23081812262535095, -1.4155452251434326, -0.23377179354429245, 11.038004351158932, 11.201857072611645, 10.636162688334778, 18.548057089249284, 20.317781540254742, 20.67398569608727, 13.994611116747052, 14.264799567560345, 14.297969282294304, 19.18908783296743, 19.182548346618802, 18.33729454378286, 2.55367900182803, 2.7015310799082073, 2.255839770038918, 14.708266173799828, 14.776232456167534, 14.685923000176743, 13.958812192082405, 13.884823717176914, 13.802982237190008, 17.1395392542084, 16.515075658758477, 17.09989560892184, 17.663148333628968, 18.281526294847325, 17.156435539325074, 14.647539518773556, 15.162189826369286, 14.993271455168724, 24.702389451364667, 25.03130106876293, 24.779741733024508, 23.772881031036377, 23.417532742023468, 24.318204764276743, 31.46262867252031, 32.225863876442105, 32.67177765133479, 23.614727937926844, 23.740724468914166, 23.369394866128758, 22.112791885932282, 22.71845621367295, 23.436736113702253, 22.62096628236273, 21.932169298330933, 22.31236970673004, 17.44259212166071, 17.37037841230631, 17.372164092957973, 1.871805494030312, 2.0493561661181303, 2.064516704141468, 25.30035476634899, 25.274620758990437, 25.293241063753754, 21.729322765022516, 21.34992714971304, 21.715394901111722, 19.816550453503922, 20.26793922235568, 20.59185100657244, 31.405932632585362, 31.555938897033528, 31.459718727817133, 23.061202992995575, 24.76283785452445, 24.853350320210055, 21.802170351768524, 21.624148814628512, 21.826157645011932, 12.842088714241982, 13.953810199163854, 13.832176197320223, 18.048927548031003, 18.441118776487798, 18.48677460026616, 15.026886408527687, 15.40115090211232, 15.604719725747898, 21.06055251260598, 21.266099926394716, 20.983535823722676, 21.22833162546158, 21.74170408397913, 21.722449334338307, 20.416842165092618, 20.84678395340839, 20.581362607578427, 27.706461312870175, 28.228082835363836, 28.07296673456827, -6.0264685451984406, -5.6251842230558395, -4.957132393494248, 7.992806534593299, 7.880208983396486, 7.230396007498101, 18.87834474692741, 18.90148693944016, 19.044489974776894, 25.868931900709867, 25.005420804023743, 25.7949305921793, 21.43021395802498, 22.1430836096406, 21.780210718512535, 17.106934388478592, 17.285736997922257, 17.80504522224267, 2.4830996841192245, 2.5312280878424644, 2.5106673538684845, 26.503560503944755, 26.639279515249655, 25.85116681456566, -91.11906370520592, -100.55501306802034, -91.65088763833046, 12.911888619263962, 13.959507697572306, 13.755990860362843, -96.84620913863182, -84.59987635537982, -84.44606208056211, 20.06025980909665, 20.040180419882134, 19.559085329373673, 27.22097114225228, 27.996178414051727, 27.055731271704033, -102.09367859860262, -111.41815816735229, -102.41785216828188, -2.3807039484381676, -2.494622766971588, -3.0094317346811295, 7.740943865850568, 6.9948775470256805, 7.314647376537323, 20.73644097149372, 20.120401933789253, 20.15539775788784, 23.38152745552361, 23.45051870495081, 23.022925563156605, 0.9879233737786564, 0.7980611224969181, 0.9063420494397434, 20.712109304964542, 21.022832788527012, 20.584871232509613, 22.078893423701317, 22.010089984784514, 21.94683727497855, 22.816817194223404, 23.442784689366817, 23.548314359039068, 5.916275625427559, 6.893927012647808, 6.419156064589814, 14.971080989887312, 14.703995538254574, 15.21133037221928, 5.493059433996677, 5.888074884191155, 5.772124655544758, 20.305849742144346, 19.5671533793211, 19.712580740451813, 12.501086403926209, 12.568274473150566, 13.184715097149208, -94.0872772137324, -87.63441287974517, -87.46381987879674, 8.499073084443808, 8.568599555641413, 8.500176142901182, 16.73262288297215, 16.68145829314986, 16.47572777668634, 21.72529728586474, 21.379576953748852, 21.580548057953507, 17.331532677014664, 17.198707488675907, 17.245397595067814, 15.181580675144986, 15.250028898318604, 15.168240038057164, 18.035407369956374, 17.32844890654087, 18.095531380735338, 27.677109430233628, 27.76209749529758, 27.729379350940377, 3.2805608746906074, 3.4090481021751913, 3.395142915969089, 6.741918910294771, 6.42071970552206, 6.588856603950262, 9.513368467489869, 10.618757168451936, 10.5113498220841, 14.445405088365078, 14.26549830287695, 14.044825702905655, 10.446610793471336, 10.55475127696991, 10.669663444161415, 21.065827960769326, 21.778744439283997, 21.48593885699907, 23.08208956072727, 23.622579571480543, 23.53516071724394, 18.086436005774885, 17.608046889305115, 17.76407214254141, 21.149834246685103, 20.95502024640639, 21.02466495831807, 15.909917327264935, 15.91337892288962, 14.636751572291047, 10.456055298447609, 9.896107286214828, 10.84255513548851, 21.750325483580426, 21.979551834364727, 21.665267904599503, 17.535862204929188, 17.82841185977061, 17.67005345722039, 24.89251001800099, 25.08025050458187, 24.61131506661573, 24.021355037887886, 24.51200476226707, 23.7347446133693, 23.653241169949368, 24.25086096146454, 24.187470029418662, 12.57027219360073, 12.630335822080568, 12.617024121185139, 21.607600236932427, 21.50348764906326, 21.242030943433434, 9.52781281620264, 9.86483034864068, 9.846894156187773, 3.6956421937793493, 3.6697205994278193, 3.3681317046284676, 20.960197933018208, 21.08859531581402, 20.85144579410553, 23.238315490384892, 23.047666420539215, 22.890397702654198, 13.689180415123701, 13.202609427273273, 13.130821332335472, 27.5328868329525, 28.466572226490825, 28.093914173543453, 24.971483091513306, 25.375219772259385, 26.34816102931896, 23.043973088264465, 23.334648856311105, 23.273472358472645, 5.469405154387147, 6.27345379597196, 6.108954536418111, 14.834352418780327, 15.329503877088428, 14.782253749668598, 17.461702509472758, 17.436851693938166, 17.448913401613623, 2.459781018396214, 2.1398944755395206, 1.9962322314580234, 18.009981046120316, 17.936950157086045, 17.40346586207548, 9.415333077311516, 9.844301340170205, 9.792607046663761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15360504728961571, "mean_inference_ms": 0.7052668940707862, "mean_action_processing_ms": 0.10021465603237269, "mean_env_wait_ms": 0.8080915449541335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1678950, "timesteps_this_iter": 0, "agent_timesteps_total": 5036850, "timers": {"sample_time_ms": 20527.259, "sample_throughput": 467.379, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3086.4, "learn_throughput": 3108.476, "update_time_ms": 8.869}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 8.930699467658997, "policy_loss": -0.0007596212864822149, "vf_loss": 9.110420227050781, "vf_explained_var": 0.06358455866575241, "kl": 0.006293675164037603, "entropy": 17.8960964679718, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1678950, "num_agent_steps_sampled": 5036850, "num_steps_trained": 1678950, "num_agent_steps_trained": 5036850, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6407, "training_iteration": 175, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-42-15", "timestamp": 1706193735, "time_this_iter_s": 19.586211442947388, "time_total_s": 3532.246675491333, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01790700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3532.246675491333, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 8.967857142857143, "ram_util_percent": 52.62857142857143}}
{"episode_reward_max": 94.22509369254112, "episode_reward_min": -315.9296889342368, "episode_reward_mean": 35.024006735625434, "episode_len_mean": 293.07, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -111.41815816735229}, "policy_reward_max": {"shared_policy": 31.87668116390705}, "policy_reward_mean": {"shared_policy": 11.674668911875147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.82432166114447, 76.66928329691291, 65.35350828617811, 52.19771660864352, 7.5249951258301735, 78.99400683376007, -283.3249644115567, 40.62738717719911, -265.89214757457376, 59.659525558352456, 82.27288082800804, -315.9296889342368, -7.884758450090885, 22.05046878941357, 61.012240663170815, 69.85497172363102, 2.692326545715318, 62.31981332600117, 66.03582068346438, 69.80791624262929, 19.22935870266518, 44.886406900361166, 17.15325897373259, 59.58558386191726, 38.254075974225984, -269.1855099722743, 25.567848782986403, 49.88980895280835, 64.6854222975671, 51.775637760758386, 45.59984961152075, 53.45938765723258, 83.16858627647159, 10.084751892834888, 19.751495219767094, 30.643475458025904, 42.75572909414768, 31.67102551460266, 64.3305112570524, 70.23982984945175, 53.45855503762141, 63.129519451409564, 46.4600478224456, 31.194717720150948, 65.39514522254466, 53.03432752192019, 74.58407558919859, 72.26810441352426, 72.09157216083257, 37.817632136866436, 64.35311882942912, 29.239537321031094, 10.733494497835636, 62.900239042937756, 69.1763796135783, 40.02261117473245, 84.09337323298678, 76.69486389309165, 69.65209430304822, 17.851813486777218, 44.94611004553735, 52.34746760502455, 6.595907725393758, 53.35039706528184, 29.05224146414548, 42.456597379874424, 67.58675800682977, 11.098076049238443, 64.42582622915505, 87.12495278031565, 67.08638312667607, 53.59328650869429, 44.92543064802885, 23.33581274747847, 58.71012383699417, 69.51399057544768, 73.51450811489482, 40.330635780468555, 66.60314456000924, 55.402254618704305, 40.179894486907855, 67.50590569525956, 31.61972553934902, 70.81668167188762, -258.9514402307105, 73.00804551318285, 79.09064951166509, 46.476645781658576, 35.36151743680239, 79.07582454476506, 75.44183260737917, 57.095288770273314, 94.22509369254112, 65.12607396394012, 42.40469283238053, 26.608796607702956, 83.35549065470694, 35.615545976906986, 44.967678979039164, 52.813444141298504], "episode_lengths": [300, 300, 300, 300, 300, 300, 203, 300, 189, 300, 300, 97, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 100, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.87834474692741, 18.90148693944016, 19.044489974776894, 25.868931900709867, 25.005420804023743, 25.7949305921793, 21.43021395802498, 22.1430836096406, 21.780210718512535, 17.106934388478592, 17.285736997922257, 17.80504522224267, 2.4830996841192245, 2.5312280878424644, 2.5106673538684845, 26.503560503944755, 26.639279515249655, 25.85116681456566, -91.11906370520592, -100.55501306802034, -91.65088763833046, 12.911888619263962, 13.959507697572306, 13.755990860362843, -96.84620913863182, -84.59987635537982, -84.44606208056211, 20.06025980909665, 20.040180419882134, 19.559085329373673, 27.22097114225228, 27.996178414051727, 27.055731271704033, -102.09367859860262, -111.41815816735229, -102.41785216828188, -2.3807039484381676, -2.494622766971588, -3.0094317346811295, 7.740943865850568, 6.9948775470256805, 7.314647376537323, 20.73644097149372, 20.120401933789253, 20.15539775788784, 23.38152745552361, 23.45051870495081, 23.022925563156605, 0.9879233737786564, 0.7980611224969181, 0.9063420494397434, 20.712109304964542, 21.022832788527012, 20.584871232509613, 22.078893423701317, 22.010089984784514, 21.94683727497855, 22.816817194223404, 23.442784689366817, 23.548314359039068, 5.916275625427559, 6.893927012647808, 6.419156064589814, 14.971080989887312, 14.703995538254574, 15.21133037221928, 5.493059433996677, 5.888074884191155, 5.772124655544758, 20.305849742144346, 19.5671533793211, 19.712580740451813, 12.501086403926209, 12.568274473150566, 13.184715097149208, -94.0872772137324, -87.63441287974517, -87.46381987879674, 8.499073084443808, 8.568599555641413, 8.500176142901182, 16.73262288297215, 16.68145829314986, 16.47572777668634, 21.72529728586474, 21.379576953748852, 21.580548057953507, 17.331532677014664, 17.198707488675907, 17.245397595067814, 15.181580675144986, 15.250028898318604, 15.168240038057164, 18.035407369956374, 17.32844890654087, 18.095531380735338, 27.677109430233628, 27.76209749529758, 27.729379350940377, 3.2805608746906074, 3.4090481021751913, 3.395142915969089, 6.741918910294771, 6.42071970552206, 6.588856603950262, 9.513368467489869, 10.618757168451936, 10.5113498220841, 14.445405088365078, 14.26549830287695, 14.044825702905655, 10.446610793471336, 10.55475127696991, 10.669663444161415, 21.065827960769326, 21.778744439283997, 21.48593885699907, 23.08208956072727, 23.622579571480543, 23.53516071724394, 18.086436005774885, 17.608046889305115, 17.76407214254141, 21.149834246685103, 20.95502024640639, 21.02466495831807, 15.909917327264935, 15.91337892288962, 14.636751572291047, 10.456055298447609, 9.896107286214828, 10.84255513548851, 21.750325483580426, 21.979551834364727, 21.665267904599503, 17.535862204929188, 17.82841185977061, 17.67005345722039, 24.89251001800099, 25.08025050458187, 24.61131506661573, 24.021355037887886, 24.51200476226707, 23.7347446133693, 23.653241169949368, 24.25086096146454, 24.187470029418662, 12.57027219360073, 12.630335822080568, 12.617024121185139, 21.607600236932427, 21.50348764906326, 21.242030943433434, 9.52781281620264, 9.86483034864068, 9.846894156187773, 3.6956421937793493, 3.6697205994278193, 3.3681317046284676, 20.960197933018208, 21.08859531581402, 20.85144579410553, 23.238315490384892, 23.047666420539215, 22.890397702654198, 13.689180415123701, 13.202609427273273, 13.130821332335472, 27.5328868329525, 28.466572226490825, 28.093914173543453, 24.971483091513306, 25.375219772259385, 26.34816102931896, 23.043973088264465, 23.334648856311105, 23.273472358472645, 5.469405154387147, 6.27345379597196, 6.108954536418111, 14.834352418780327, 15.329503877088428, 14.782253749668598, 17.461702509472758, 17.436851693938166, 17.448913401613623, 2.459781018396214, 2.1398944755395206, 1.9962322314580234, 18.009981046120316, 17.936950157086045, 17.40346586207548, 9.415333077311516, 9.844301340170205, 9.792607046663761, 13.650437017281845, 14.447189074785754, 14.358971287806824, 22.309207782149315, 22.494943231344223, 22.78260699333623, 3.9719065837562084, 3.5089798271656036, 3.6171896383166313, 21.55338919659455, 21.497459066410855, 21.374977966149643, 28.624828100204468, 29.375921042868868, 29.124203637242317, 22.133523543675736, 22.483387385805443, 22.46947219719489, 18.140411907806993, 17.639799267053604, 17.813075333833694, 15.381834149360657, 14.54536521434784, 14.998231284320354, 7.653902453680828, 7.773886454602078, 7.908023839195565, 19.903861705213785, 19.792797278612852, 19.013464853167534, 22.17909660935402, 23.771105425432324, 23.563788540661335, 24.26282266775766, 24.95235575401844, 24.29932969311872, 13.426146077613026, 13.29078787813583, 13.613701824719698, 22.337631087750196, 22.247349739074707, 22.018163733184338, 18.762895380457238, 18.614407954116658, 18.02495128413041, 13.689063824558005, 13.554855433603123, 12.935975228746727, 22.54250943412383, 21.99049848814805, 22.97289777298768, 10.537007302045822, 10.240005403757095, 10.842712833546102, 23.594941561420754, 23.51380242904027, 23.7079376814266, -95.85149820645651, -81.55853209070241, -81.54140993355153, 24.248292947808892, 24.294784533480794, 24.464968031893164, 26.41927895074089, 26.402841386695698, 26.268529174228505, 15.303448562820748, 15.57062063676615, 15.602576582071677, 12.137203462421894, 11.625534802675247, 11.598779171705246, 26.332637436687946, 26.484814246185124, 26.258372861891985, 25.003955760349825, 25.22635016504985, 25.211526681979493, 19.09259548907478, 19.204454082374767, 18.798239198823765, 31.87668116390705, 31.1979159116745, 31.150496616959572, 21.605364496509225, 21.760917904476315, 21.759791562954575, 13.694488048553467, 14.314706228673458, 14.395498555153608, 8.602271546920136, 8.791303281982735, 9.215221778800085, 28.089720649023846, 27.083751042683915, 28.18201896299918, 11.979158117125422, 11.73922764758268, 11.897160212198884, 14.745902347067982, 15.053504074613244, 15.168272557357938, 17.6267516935865, 17.431653062502534, 17.75503938520947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535856705563606, "mean_inference_ms": 0.7051191195393561, "mean_action_processing_ms": 0.100137864533191, "mean_env_wait_ms": 0.8079527913672772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1688544, "timesteps_this_iter": 0, "agent_timesteps_total": 5065632, "timers": {"sample_time_ms": 20518.01, "sample_throughput": 467.589, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3087.055, "learn_throughput": 3107.816, "update_time_ms": 8.817}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 51.58154487609863, "policy_loss": -0.0005191958699868604, "vf_loss": 51.762513160705566, "vf_explained_var": 0.13814394921064377, "kl": 0.012462578015684293, "entropy": 18.04465961456299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1688544, "num_agent_steps_sampled": 5065632, "num_steps_trained": 1688544, "num_agent_steps_trained": 5065632, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6442, "training_iteration": 176, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-42-35", "timestamp": 1706193755, "time_this_iter_s": 20.351587295532227, "time_total_s": 3552.5982627868652, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BAD8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3552.5982627868652, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 9.79310344827586, "ram_util_percent": 52.54137931034484}}
{"episode_reward_max": 98.01372480962888, "episode_reward_min": -295.71358750388026, "episode_reward_mean": 43.78487750337459, "episode_len_mean": 296.91, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -102.78116963307063}, "policy_reward_max": {"shared_policy": 32.81554033680973}, "policy_reward_mean": {"shared_policy": 14.594959167791524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.45938765723258, 83.16858627647159, 10.084751892834888, 19.751495219767094, 30.643475458025904, 42.75572909414768, 31.67102551460266, 64.3305112570524, 70.23982984945175, 53.45855503762141, 63.129519451409564, 46.4600478224456, 31.194717720150948, 65.39514522254466, 53.03432752192019, 74.58407558919859, 72.26810441352426, 72.09157216083257, 37.817632136866436, 64.35311882942912, 29.239537321031094, 10.733494497835636, 62.900239042937756, 69.1763796135783, 40.02261117473245, 84.09337323298678, 76.69486389309165, 69.65209430304822, 17.851813486777218, 44.94611004553735, 52.34746760502455, 6.595907725393758, 53.35039706528184, 29.05224146414548, 42.456597379874424, 67.58675800682977, 11.098076049238443, 64.42582622915505, 87.12495278031565, 67.08638312667607, 53.59328650869429, 44.92543064802885, 23.33581274747847, 58.71012383699417, 69.51399057544768, 73.51450811489482, 40.330635780468555, 66.60314456000924, 55.402254618704305, 40.179894486907855, 67.50590569525956, 31.61972553934902, 70.81668167188762, -258.9514402307105, 73.00804551318285, 79.09064951166509, 46.476645781658576, 35.36151743680239, 79.07582454476506, 75.44183260737917, 57.095288770273314, 94.22509369254112, 65.12607396394012, 42.40469283238053, 26.608796607702956, 83.35549065470694, 35.615545976906986, 44.967678979039164, 52.813444141298504, 66.39939506351946, 56.035565855912836, 54.51391933485863, 61.76850591949187, 48.99229290802032, -295.71358750388026, 59.63568175584078, 61.73990444839001, 64.1487726024352, 28.66606952995059, 24.136247435584636, 13.255191615782664, 40.328250445425496, -279.6619830131531, 6.350631281733513, 70.87064597010612, 76.25553834065792, 39.18555051833391, 86.38377056224272, 59.01714207977055, 65.06297624483705, 22.878634784370632, 98.01372480962888, 67.90813146624714, 74.69282571971415, 55.36889074277133, 56.70770279318093, 53.25236646528356, 73.7951466962695, 49.887160550802946, 64.51937717664984], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 254, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.035407369956374, 17.32844890654087, 18.095531380735338, 27.677109430233628, 27.76209749529758, 27.729379350940377, 3.2805608746906074, 3.4090481021751913, 3.395142915969089, 6.741918910294771, 6.42071970552206, 6.588856603950262, 9.513368467489869, 10.618757168451936, 10.5113498220841, 14.445405088365078, 14.26549830287695, 14.044825702905655, 10.446610793471336, 10.55475127696991, 10.669663444161415, 21.065827960769326, 21.778744439283997, 21.48593885699907, 23.08208956072727, 23.622579571480543, 23.53516071724394, 18.086436005774885, 17.608046889305115, 17.76407214254141, 21.149834246685103, 20.95502024640639, 21.02466495831807, 15.909917327264935, 15.91337892288962, 14.636751572291047, 10.456055298447609, 9.896107286214828, 10.84255513548851, 21.750325483580426, 21.979551834364727, 21.665267904599503, 17.535862204929188, 17.82841185977061, 17.67005345722039, 24.89251001800099, 25.08025050458187, 24.61131506661573, 24.021355037887886, 24.51200476226707, 23.7347446133693, 23.653241169949368, 24.25086096146454, 24.187470029418662, 12.57027219360073, 12.630335822080568, 12.617024121185139, 21.607600236932427, 21.50348764906326, 21.242030943433434, 9.52781281620264, 9.86483034864068, 9.846894156187773, 3.6956421937793493, 3.6697205994278193, 3.3681317046284676, 20.960197933018208, 21.08859531581402, 20.85144579410553, 23.238315490384892, 23.047666420539215, 22.890397702654198, 13.689180415123701, 13.202609427273273, 13.130821332335472, 27.5328868329525, 28.466572226490825, 28.093914173543453, 24.971483091513306, 25.375219772259385, 26.34816102931896, 23.043973088264465, 23.334648856311105, 23.273472358472645, 5.469405154387147, 6.27345379597196, 6.108954536418111, 14.834352418780327, 15.329503877088428, 14.782253749668598, 17.461702509472758, 17.436851693938166, 17.448913401613623, 2.459781018396214, 2.1398944755395206, 1.9962322314580234, 18.009981046120316, 17.936950157086045, 17.40346586207548, 9.415333077311516, 9.844301340170205, 9.792607046663761, 13.650437017281845, 14.447189074785754, 14.358971287806824, 22.309207782149315, 22.494943231344223, 22.78260699333623, 3.9719065837562084, 3.5089798271656036, 3.6171896383166313, 21.55338919659455, 21.497459066410855, 21.374977966149643, 28.624828100204468, 29.375921042868868, 29.124203637242317, 22.133523543675736, 22.483387385805443, 22.46947219719489, 18.140411907806993, 17.639799267053604, 17.813075333833694, 15.381834149360657, 14.54536521434784, 14.998231284320354, 7.653902453680828, 7.773886454602078, 7.908023839195565, 19.903861705213785, 19.792797278612852, 19.013464853167534, 22.17909660935402, 23.771105425432324, 23.563788540661335, 24.26282266775766, 24.95235575401844, 24.29932969311872, 13.426146077613026, 13.29078787813583, 13.613701824719698, 22.337631087750196, 22.247349739074707, 22.018163733184338, 18.762895380457238, 18.614407954116658, 18.02495128413041, 13.689063824558005, 13.554855433603123, 12.935975228746727, 22.54250943412383, 21.99049848814805, 22.97289777298768, 10.537007302045822, 10.240005403757095, 10.842712833546102, 23.594941561420754, 23.51380242904027, 23.7079376814266, -95.85149820645651, -81.55853209070241, -81.54140993355153, 24.248292947808892, 24.294784533480794, 24.464968031893164, 26.41927895074089, 26.402841386695698, 26.268529174228505, 15.303448562820748, 15.57062063676615, 15.602576582071677, 12.137203462421894, 11.625534802675247, 11.598779171705246, 26.332637436687946, 26.484814246185124, 26.258372861891985, 25.003955760349825, 25.22635016504985, 25.211526681979493, 19.09259548907478, 19.204454082374767, 18.798239198823765, 31.87668116390705, 31.1979159116745, 31.150496616959572, 21.605364496509225, 21.760917904476315, 21.759791562954575, 13.694488048553467, 14.314706228673458, 14.395498555153608, 8.602271546920136, 8.791303281982735, 9.215221778800085, 28.089720649023846, 27.083751042683915, 28.18201896299918, 11.979158117125422, 11.73922764758268, 11.897160212198884, 14.745902347067982, 15.053504074613244, 15.168272557357938, 17.6267516935865, 17.431653062502534, 17.75503938520947, 22.11864947279294, 21.897662570079163, 22.383083020647362, 18.770506548384816, 19.13298030725369, 18.13207900027433, 18.144517211864382, 18.151135227332503, 18.218266895661742, 20.563035612925887, 20.68640355928801, 20.519066747277975, 16.159668050706387, 16.30272115394473, 16.5299037033692, -102.64879414439201, -101.95782700181007, -91.10696635767817, 20.09566006064415, 19.47664012014866, 20.06338157504797, 20.480943724513054, 20.512661665678024, 20.74629905819893, 21.42559676244855, 21.580661186482757, 21.142514653503895, 9.086334029833466, 9.566562953094632, 10.013172547022492, 8.395089198524744, 7.660753111044556, 8.080405126015336, 4.062057239313916, 4.647609846976891, 4.545524529491857, 13.597332683702305, 13.593695496519402, 13.137222265203789, -102.78116963307063, -88.39744246999423, -88.48337091008823, 2.085630066692829, 2.1327259223908186, 2.132275292649865, 23.7109394967556, 23.652149386703968, 23.507557086646557, 25.21202180782953, 25.65092137331763, 25.392595159510762, 12.875103257596493, 13.036636240780354, 13.273811019957066, 28.68163000792265, 29.067368812393397, 28.63477174192667, 19.558736999829605, 19.768541996677712, 19.689863083263234, 21.975554396398365, 21.097207978367805, 21.990213870070875, 7.69369822430113, 7.606308911616594, 7.578627648452908, 32.81554033680973, 32.45839165399471, 32.73979281882444, 22.024336233735085, 22.937663178890944, 22.946132053621113, 24.741283458968, 24.936028709014252, 25.0155135517319, 18.125597432255745, 18.51232574135065, 18.73096756916493, 18.887653236587838, 18.853019398947552, 18.96703015764554, 18.01222709263675, 17.666087992489338, 17.57405138015747, 24.423557822902993, 24.823120204110936, 24.54846866925557, 16.173746556043625, 16.839485455304384, 16.873928539454937, 21.45402696232, 22.07018543748805, 20.99516477684179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536007233545288, "mean_inference_ms": 0.7053249459435469, "mean_action_processing_ms": 0.10020134909045054, "mean_env_wait_ms": 0.8080651758171874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1698138, "timesteps_this_iter": 0, "agent_timesteps_total": 5094414, "timers": {"sample_time_ms": 20439.283, "sample_throughput": 469.39, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3076.609, "learn_throughput": 3118.368, "update_time_ms": 8.874}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 76.34021949768066, "policy_loss": -0.0007009498457812846, "vf_loss": 76.52126121520996, "vf_explained_var": 0.2086559534072876, "kl": 0.009380618838176145, "entropy": 18.034069776535034, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1698138, "num_agent_steps_sampled": 5094414, "num_steps_trained": 1698138, "num_agent_steps_trained": 5094414, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6473, "training_iteration": 177, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-42-55", "timestamp": 1706193775, "time_this_iter_s": 20.44153881072998, "time_total_s": 3573.039801597595, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A101F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3573.039801597595, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 7.903448275862069, "ram_util_percent": 52.148275862068964}}
{"episode_reward_max": 98.01372480962888, "episode_reward_min": -295.754496878013, "episode_reward_mean": 37.336658726615134, "episode_len_mean": 294.64, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -103.27429107824962}, "policy_reward_max": {"shared_policy": 32.81554033680973}, "policy_reward_mean": {"shared_policy": 12.445552908871706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.05224146414548, 42.456597379874424, 67.58675800682977, 11.098076049238443, 64.42582622915505, 87.12495278031565, 67.08638312667607, 53.59328650869429, 44.92543064802885, 23.33581274747847, 58.71012383699417, 69.51399057544768, 73.51450811489482, 40.330635780468555, 66.60314456000924, 55.402254618704305, 40.179894486907855, 67.50590569525956, 31.61972553934902, 70.81668167188762, -258.9514402307105, 73.00804551318285, 79.09064951166509, 46.476645781658576, 35.36151743680239, 79.07582454476506, 75.44183260737917, 57.095288770273314, 94.22509369254112, 65.12607396394012, 42.40469283238053, 26.608796607702956, 83.35549065470694, 35.615545976906986, 44.967678979039164, 52.813444141298504, 66.39939506351946, 56.035565855912836, 54.51391933485863, 61.76850591949187, 48.99229290802032, -295.71358750388026, 59.63568175584078, 61.73990444839001, 64.1487726024352, 28.66606952995059, 24.136247435584636, 13.255191615782664, 40.328250445425496, -279.6619830131531, 6.350631281733513, 70.87064597010612, 76.25553834065792, 39.18555051833391, 86.38377056224272, 59.01714207977055, 65.06297624483705, 22.878634784370632, 98.01372480962888, 67.90813146624714, 74.69282571971415, 55.36889074277133, 56.70770279318093, 53.25236646528356, 73.7951466962695, 49.887160550802946, 64.51937717664984, 20.798213746398673, 20.285508342087255, 92.36658507212995, 75.22197211533783, 65.68788305483758, 59.90069799683987, 51.675945512950406, 69.49784495681523, 7.441512376069994, -6.86566094681622, 71.25319193862376, 48.31827364861964, 58.726766898296745, 56.98829056695101, 46.30515455454588, 62.823887158185215, -295.754496878013, 35.18921581655741, 35.26246427744624, 68.54394087940454, 25.878370448946953, -285.59454099461436, 70.54060623049736, 84.70459806919095, 47.80140866339204, 81.03270077705383, -10.78688539564611, 55.10440008249134, 72.8012919165194, 57.774217084050164, 61.12325557693836, 47.13184171169995, 61.49556419905272], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 218, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 254, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 92, 300, 300, 300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [9.415333077311516, 9.844301340170205, 9.792607046663761, 13.650437017281845, 14.447189074785754, 14.358971287806824, 22.309207782149315, 22.494943231344223, 22.78260699333623, 3.9719065837562084, 3.5089798271656036, 3.6171896383166313, 21.55338919659455, 21.497459066410855, 21.374977966149643, 28.624828100204468, 29.375921042868868, 29.124203637242317, 22.133523543675736, 22.483387385805443, 22.46947219719489, 18.140411907806993, 17.639799267053604, 17.813075333833694, 15.381834149360657, 14.54536521434784, 14.998231284320354, 7.653902453680828, 7.773886454602078, 7.908023839195565, 19.903861705213785, 19.792797278612852, 19.013464853167534, 22.17909660935402, 23.771105425432324, 23.563788540661335, 24.26282266775766, 24.95235575401844, 24.29932969311872, 13.426146077613026, 13.29078787813583, 13.613701824719698, 22.337631087750196, 22.247349739074707, 22.018163733184338, 18.762895380457238, 18.614407954116658, 18.02495128413041, 13.689063824558005, 13.554855433603123, 12.935975228746727, 22.54250943412383, 21.99049848814805, 22.97289777298768, 10.537007302045822, 10.240005403757095, 10.842712833546102, 23.594941561420754, 23.51380242904027, 23.7079376814266, -95.85149820645651, -81.55853209070241, -81.54140993355153, 24.248292947808892, 24.294784533480794, 24.464968031893164, 26.41927895074089, 26.402841386695698, 26.268529174228505, 15.303448562820748, 15.57062063676615, 15.602576582071677, 12.137203462421894, 11.625534802675247, 11.598779171705246, 26.332637436687946, 26.484814246185124, 26.258372861891985, 25.003955760349825, 25.22635016504985, 25.211526681979493, 19.09259548907478, 19.204454082374767, 18.798239198823765, 31.87668116390705, 31.1979159116745, 31.150496616959572, 21.605364496509225, 21.760917904476315, 21.759791562954575, 13.694488048553467, 14.314706228673458, 14.395498555153608, 8.602271546920136, 8.791303281982735, 9.215221778800085, 28.089720649023846, 27.083751042683915, 28.18201896299918, 11.979158117125422, 11.73922764758268, 11.897160212198884, 14.745902347067982, 15.053504074613244, 15.168272557357938, 17.6267516935865, 17.431653062502534, 17.75503938520947, 22.11864947279294, 21.897662570079163, 22.383083020647362, 18.770506548384816, 19.13298030725369, 18.13207900027433, 18.144517211864382, 18.151135227332503, 18.218266895661742, 20.563035612925887, 20.68640355928801, 20.519066747277975, 16.159668050706387, 16.30272115394473, 16.5299037033692, -102.64879414439201, -101.95782700181007, -91.10696635767817, 20.09566006064415, 19.47664012014866, 20.06338157504797, 20.480943724513054, 20.512661665678024, 20.74629905819893, 21.42559676244855, 21.580661186482757, 21.142514653503895, 9.086334029833466, 9.566562953094632, 10.013172547022492, 8.395089198524744, 7.660753111044556, 8.080405126015336, 4.062057239313916, 4.647609846976891, 4.545524529491857, 13.597332683702305, 13.593695496519402, 13.137222265203789, -102.78116963307063, -88.39744246999423, -88.48337091008823, 2.085630066692829, 2.1327259223908186, 2.132275292649865, 23.7109394967556, 23.652149386703968, 23.507557086646557, 25.21202180782953, 25.65092137331763, 25.392595159510762, 12.875103257596493, 13.036636240780354, 13.273811019957066, 28.68163000792265, 29.067368812393397, 28.63477174192667, 19.558736999829605, 19.768541996677712, 19.689863083263234, 21.975554396398365, 21.097207978367805, 21.990213870070875, 7.69369822430113, 7.606308911616594, 7.578627648452908, 32.81554033680973, 32.45839165399471, 32.73979281882444, 22.024336233735085, 22.937663178890944, 22.946132053621113, 24.741283458968, 24.936028709014252, 25.0155135517319, 18.125597432255745, 18.51232574135065, 18.73096756916493, 18.887653236587838, 18.853019398947552, 18.96703015764554, 18.01222709263675, 17.666087992489338, 17.57405138015747, 24.423557822902993, 24.823120204110936, 24.54846866925557, 16.173746556043625, 16.839485455304384, 16.873928539454937, 21.45402696232, 22.07018543748805, 20.99516477684179, 6.937544440229729, 6.776467954119042, 7.084201352049902, 6.740525876482323, 6.7712324944635185, 6.773749971141413, 30.927532582854226, 31.03422545579572, 30.404827033480004, 24.905466829737023, 25.465298873682812, 24.851206411918, 21.883363623172045, 21.929652674123645, 21.874866757541895, 19.903473188479737, 19.818762620290116, 20.178462188070014, 17.025770989557103, 17.3093210880955, 17.340853435297802, 23.007606407006577, 23.277261042346552, 23.2129775074621, 2.5165148551265304, 2.7155958587924545, 2.2094016621510093, -1.9716350945333687, -2.7859081725279538, -2.1081176797548977, 23.973451734210045, 23.564132827023656, 23.715607377390057, 16.326689434548214, 15.877523993452385, 16.114060220619038, 19.830668406250567, 19.617238613466412, 19.278859878579766, 19.052930163840443, 18.754567603270203, 19.18079279984036, 15.212154373526573, 15.66599278151989, 15.427007399499416, 20.561852569381387, 21.268346740553767, 20.99368784825006, -103.27429107824962, -96.13936787905793, -96.34083792070548, 11.843987006694078, 11.508143126964569, 11.83708568289876, 11.76908169935146, 11.581964092950017, 11.911418485144765, 22.58420430868864, 22.87162721902132, 23.088109351694584, 8.409231022000313, 9.039161592721939, 8.429977834224701, -93.43355805675189, -93.07237654055159, -99.0886063973109, 23.659662697464228, 23.208917751908302, 23.67202578112483, 28.07755065212646, 28.265009513745696, 28.362037903318793, 16.12268582234779, 16.038220825294644, 15.640502015749604, 27.110871329903603, 27.33866687119007, 26.58316257596016, -3.6735770354668347, -3.7928916017214505, -3.3204167584578244, 18.423424321226776, 18.3796463906765, 18.301329370588064, 24.35415274836123, 24.067286610603333, 24.37985255755484, 19.625790004928902, 18.985720609625176, 19.162706469496086, 20.392759675780923, 20.36884159843126, 20.36165430272618, 15.507006188233689, 15.723315132160977, 15.901520391305283, 20.73157783007869, 20.447804647187382, 20.31618172178665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15357121714870434, "mean_inference_ms": 0.705271039308455, "mean_action_processing_ms": 0.10012707622735757, "mean_env_wait_ms": 0.8080158078582526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1707732, "timesteps_this_iter": 0, "agent_timesteps_total": 5123196, "timers": {"sample_time_ms": 20271.339, "sample_throughput": 473.279, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3057.638, "learn_throughput": 3137.716, "update_time_ms": 8.82}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 103.88062572479248, "policy_loss": -0.0007367705862231233, "vf_loss": 104.06138229370117, "vf_explained_var": 0.09900294244289398, "kl": 0.008413778894750288, "entropy": 18.00245189666748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1707732, "num_agent_steps_sampled": 5123196, "num_steps_trained": 1707732, "num_agent_steps_trained": 5123196, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6506, "training_iteration": 178, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-43-15", "timestamp": 1706193795, "time_this_iter_s": 19.573845386505127, "time_total_s": 3592.6136469841003, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01790CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3592.6136469841003, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 8.033333333333333, "ram_util_percent": 52.17407407407408}}
{"episode_reward_max": 98.01372480962888, "episode_reward_min": -295.754496878013, "episode_reward_mean": 41.31633454886774, "episode_len_mean": 295.46, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -103.27429107824962}, "policy_reward_max": {"shared_policy": 32.81554033680973}, "policy_reward_mean": {"shared_policy": 13.772111516289241}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.35549065470694, 35.615545976906986, 44.967678979039164, 52.813444141298504, 66.39939506351946, 56.035565855912836, 54.51391933485863, 61.76850591949187, 48.99229290802032, -295.71358750388026, 59.63568175584078, 61.73990444839001, 64.1487726024352, 28.66606952995059, 24.136247435584636, 13.255191615782664, 40.328250445425496, -279.6619830131531, 6.350631281733513, 70.87064597010612, 76.25553834065792, 39.18555051833391, 86.38377056224272, 59.01714207977055, 65.06297624483705, 22.878634784370632, 98.01372480962888, 67.90813146624714, 74.69282571971415, 55.36889074277133, 56.70770279318093, 53.25236646528356, 73.7951466962695, 49.887160550802946, 64.51937717664984, 20.798213746398673, 20.285508342087255, 92.36658507212995, 75.22197211533783, 65.68788305483758, 59.90069799683987, 51.675945512950406, 69.49784495681523, 7.441512376069994, -6.86566094681622, 71.25319193862376, 48.31827364861964, 58.726766898296745, 56.98829056695101, 46.30515455454588, 62.823887158185215, -295.754496878013, 35.18921581655741, 35.26246427744624, 68.54394087940454, 25.878370448946953, -285.59454099461436, 70.54060623049736, 84.70459806919095, 47.80140866339204, 81.03270077705383, -10.78688539564611, 55.10440008249134, 72.8012919165194, 57.774217084050164, 61.12325557693836, 47.13184171169995, 61.49556419905272, 58.271592717617736, 74.43125764786961, 72.7493032971397, 76.38870859332381, 44.78317757882175, -3.517984613776221, 75.30419567599893, 85.84109374135731, 49.697277238461524, 60.449536733329296, 68.70775238424538, 50.304669389501186, 59.61438720673321, 58.02518507651982, 54.033427484333515, 77.82305882684885, 48.73051951080558, 87.59685452189296, 67.38173425197598, 79.84648879431188, 75.54391122609377, 52.235459446907015, 63.05158555135128, 58.46704922989011, 43.95267709158361, 27.162912998348475, 69.23362891748545, 65.08900848031041, 58.31295093148944, 49.55377054819837, 55.03259484842417, 13.715047749807113], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 254, 300, 300, 300, 300, 300, 300, 300, 119, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 92, 300, 300, 300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.089720649023846, 27.083751042683915, 28.18201896299918, 11.979158117125422, 11.73922764758268, 11.897160212198884, 14.745902347067982, 15.053504074613244, 15.168272557357938, 17.6267516935865, 17.431653062502534, 17.75503938520947, 22.11864947279294, 21.897662570079163, 22.383083020647362, 18.770506548384816, 19.13298030725369, 18.13207900027433, 18.144517211864382, 18.151135227332503, 18.218266895661742, 20.563035612925887, 20.68640355928801, 20.519066747277975, 16.159668050706387, 16.30272115394473, 16.5299037033692, -102.64879414439201, -101.95782700181007, -91.10696635767817, 20.09566006064415, 19.47664012014866, 20.06338157504797, 20.480943724513054, 20.512661665678024, 20.74629905819893, 21.42559676244855, 21.580661186482757, 21.142514653503895, 9.086334029833466, 9.566562953094632, 10.013172547022492, 8.395089198524744, 7.660753111044556, 8.080405126015336, 4.062057239313916, 4.647609846976891, 4.545524529491857, 13.597332683702305, 13.593695496519402, 13.137222265203789, -102.78116963307063, -88.39744246999423, -88.48337091008823, 2.085630066692829, 2.1327259223908186, 2.132275292649865, 23.7109394967556, 23.652149386703968, 23.507557086646557, 25.21202180782953, 25.65092137331763, 25.392595159510762, 12.875103257596493, 13.036636240780354, 13.273811019957066, 28.68163000792265, 29.067368812393397, 28.63477174192667, 19.558736999829605, 19.768541996677712, 19.689863083263234, 21.975554396398365, 21.097207978367805, 21.990213870070875, 7.69369822430113, 7.606308911616594, 7.578627648452908, 32.81554033680973, 32.45839165399471, 32.73979281882444, 22.024336233735085, 22.937663178890944, 22.946132053621113, 24.741283458968, 24.936028709014252, 25.0155135517319, 18.125597432255745, 18.51232574135065, 18.73096756916493, 18.887653236587838, 18.853019398947552, 18.96703015764554, 18.01222709263675, 17.666087992489338, 17.57405138015747, 24.423557822902993, 24.823120204110936, 24.54846866925557, 16.173746556043625, 16.839485455304384, 16.873928539454937, 21.45402696232, 22.07018543748805, 20.99516477684179, 6.937544440229729, 6.776467954119042, 7.084201352049902, 6.740525876482323, 6.7712324944635185, 6.773749971141413, 30.927532582854226, 31.03422545579572, 30.404827033480004, 24.905466829737023, 25.465298873682812, 24.851206411918, 21.883363623172045, 21.929652674123645, 21.874866757541895, 19.903473188479737, 19.818762620290116, 20.178462188070014, 17.025770989557103, 17.3093210880955, 17.340853435297802, 23.007606407006577, 23.277261042346552, 23.2129775074621, 2.5165148551265304, 2.7155958587924545, 2.2094016621510093, -1.9716350945333687, -2.7859081725279538, -2.1081176797548977, 23.973451734210045, 23.564132827023656, 23.715607377390057, 16.326689434548214, 15.877523993452385, 16.114060220619038, 19.830668406250567, 19.617238613466412, 19.278859878579766, 19.052930163840443, 18.754567603270203, 19.18079279984036, 15.212154373526573, 15.66599278151989, 15.427007399499416, 20.561852569381387, 21.268346740553767, 20.99368784825006, -103.27429107824962, -96.13936787905793, -96.34083792070548, 11.843987006694078, 11.508143126964569, 11.83708568289876, 11.76908169935146, 11.581964092950017, 11.911418485144765, 22.58420430868864, 22.87162721902132, 23.088109351694584, 8.409231022000313, 9.039161592721939, 8.429977834224701, -93.43355805675189, -93.07237654055159, -99.0886063973109, 23.659662697464228, 23.208917751908302, 23.67202578112483, 28.07755065212646, 28.265009513745696, 28.362037903318793, 16.12268582234779, 16.038220825294644, 15.640502015749604, 27.110871329903603, 27.33866687119007, 26.58316257596016, -3.6735770354668347, -3.7928916017214505, -3.3204167584578244, 18.423424321226776, 18.3796463906765, 18.301329370588064, 24.35415274836123, 24.067286610603333, 24.37985255755484, 19.625790004928902, 18.985720609625176, 19.162706469496086, 20.392759675780923, 20.36884159843126, 20.36165430272618, 15.507006188233689, 15.723315132160977, 15.901520391305283, 20.73157783007869, 20.447804647187382, 20.31618172178665, 19.18143369009097, 19.55470835541685, 19.535450672109917, 24.89423242622675, 24.626253525416047, 24.910771696226817, 24.35035789757967, 24.59821537975222, 23.800730019807816, 25.684711587925747, 24.935592477520302, 25.768404527877763, 14.453051204482705, 15.176939147214085, 15.15318722712496, -1.2219202319781033, -1.1758082533876149, -1.120256128410503, 24.73601832985878, 25.270882127806544, 25.297295218333602, 28.038472970326737, 28.880819537987307, 28.92180123304327, 16.44770523657401, 16.432748345037297, 16.816823656850218, 20.053980633616447, 20.110231660306454, 20.285324439406395, 22.619185363252953, 23.19498549153407, 22.89358152945836, 16.9713912239919, 16.820719985912234, 16.51255817959705, 20.08560639371474, 19.617518489559487, 19.911262323458985, 19.333972619536013, 19.339312217819185, 19.35190023916462, 17.892461128532887, 18.101155690848827, 18.0398106649518, 25.989373504494623, 25.913830661525324, 25.919854660828904, 16.009133676687867, 16.191080431143433, 16.530305402974278, 28.89948959648609, 29.337264510802925, 29.36010041460395, 22.608595254520566, 22.595117973784596, 22.178021023670823, 26.251064106822014, 26.703712563961744, 26.891712123528123, 25.133536741137505, 25.16560761630535, 25.244766868650913, 17.013919870058686, 17.27248168985048, 17.94905788699785, 21.374022624144942, 20.64301466445127, 21.034548262755067, 19.67882227897644, 18.989062428474426, 19.79916452243924, 14.978834753856063, 14.393009319901466, 14.58083301782608, 8.803038388490677, 9.179996006190777, 9.17987860366702, 23.342179747919232, 23.13101742292443, 22.760431746641785, 21.89668573687473, 21.317787582675606, 21.874535160760075, 19.746060016254575, 19.82207281390825, 18.744818101326615, 16.29491249471903, 16.687087702099234, 16.57177035138011, 18.35952007273832, 18.08383201311031, 18.589242762575537, 4.37200917055209, 4.826803192923151, 4.516235386331871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15357046082323195, "mean_inference_ms": 0.705401289783194, "mean_action_processing_ms": 0.10016732005663488, "mean_env_wait_ms": 0.8081112982528547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1717326, "timesteps_this_iter": 0, "agent_timesteps_total": 5151978, "timers": {"sample_time_ms": 20132.803, "sample_throughput": 476.536, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3042.946, "learn_throughput": 3152.865, "update_time_ms": 8.757}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 7.94938063621521, "policy_loss": 0.00100077680584576, "vf_loss": 8.130783140659332, "vf_explained_var": -0.0023493692278862, "kl": 0.011990278028244398, "entropy": 18.240302562713623, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1717326, "num_agent_steps_sampled": 5151978, "num_steps_trained": 1717326, "num_agent_steps_trained": 5151978, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6538, "training_iteration": 179, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-43-35", "timestamp": 1706193815, "time_this_iter_s": 20.091718912124634, "time_total_s": 3612.705365896225, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA35DC6940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3612.705365896225, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 10.658620689655175, "ram_util_percent": 52.255172413793105}}
{"episode_reward_max": 92.36658507212995, "episode_reward_min": -295.754496878013, "episode_reward_mean": 46.26815701048108, "episode_len_mean": 297.73, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -103.27429107824962}, "policy_reward_max": {"shared_policy": 31.03422545579572}, "policy_reward_mean": {"shared_policy": 15.422719003493688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.887160550802946, 64.51937717664984, 20.798213746398673, 20.285508342087255, 92.36658507212995, 75.22197211533783, 65.68788305483758, 59.90069799683987, 51.675945512950406, 69.49784495681523, 7.441512376069994, -6.86566094681622, 71.25319193862376, 48.31827364861964, 58.726766898296745, 56.98829056695101, 46.30515455454588, 62.823887158185215, -295.754496878013, 35.18921581655741, 35.26246427744624, 68.54394087940454, 25.878370448946953, -285.59454099461436, 70.54060623049736, 84.70459806919095, 47.80140866339204, 81.03270077705383, -10.78688539564611, 55.10440008249134, 72.8012919165194, 57.774217084050164, 61.12325557693836, 47.13184171169995, 61.49556419905272, 58.271592717617736, 74.43125764786961, 72.7493032971397, 76.38870859332381, 44.78317757882175, -3.517984613776221, 75.30419567599893, 85.84109374135731, 49.697277238461524, 60.449536733329296, 68.70775238424538, 50.304669389501186, 59.61438720673321, 58.02518507651982, 54.033427484333515, 77.82305882684885, 48.73051951080558, 87.59685452189296, 67.38173425197598, 79.84648879431188, 75.54391122609377, 52.235459446907015, 63.05158555135128, 58.46704922989011, 43.95267709158361, 27.162912998348475, 69.23362891748545, 65.08900848031041, 58.31295093148944, 49.55377054819837, 55.03259484842417, 13.715047749807113, 63.2563360738568, 56.077073711901875, 68.69810573011634, 89.79385809227823, 52.65855466946958, 44.91166479140519, 50.64606101810929, 44.95319703151469, 48.61457314249127, 54.6815661974251, 45.356508024036856, 54.862129345536204, 24.680744113400564, 66.38176621776074, 81.61990541155683, 75.01049655303359, 30.382743553956956, 20.831191139295697, 46.73779207281767, 43.39029856771229, 23.413990983739467, 32.73319543898103, 80.17946047335862, 67.09718361124396, 36.289692811667905, 45.23021352477369, 37.20142848836258, 45.68525709304957, 35.34848301857707, 20.84165038354695, 23.38133009150623, 42.837080225348444, 68.138779184781], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 92, 300, 300, 300, 300, 281, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.173746556043625, 16.839485455304384, 16.873928539454937, 21.45402696232, 22.07018543748805, 20.99516477684179, 6.937544440229729, 6.776467954119042, 7.084201352049902, 6.740525876482323, 6.7712324944635185, 6.773749971141413, 30.927532582854226, 31.03422545579572, 30.404827033480004, 24.905466829737023, 25.465298873682812, 24.851206411918, 21.883363623172045, 21.929652674123645, 21.874866757541895, 19.903473188479737, 19.818762620290116, 20.178462188070014, 17.025770989557103, 17.3093210880955, 17.340853435297802, 23.007606407006577, 23.277261042346552, 23.2129775074621, 2.5165148551265304, 2.7155958587924545, 2.2094016621510093, -1.9716350945333687, -2.7859081725279538, -2.1081176797548977, 23.973451734210045, 23.564132827023656, 23.715607377390057, 16.326689434548214, 15.877523993452385, 16.114060220619038, 19.830668406250567, 19.617238613466412, 19.278859878579766, 19.052930163840443, 18.754567603270203, 19.18079279984036, 15.212154373526573, 15.66599278151989, 15.427007399499416, 20.561852569381387, 21.268346740553767, 20.99368784825006, -103.27429107824962, -96.13936787905793, -96.34083792070548, 11.843987006694078, 11.508143126964569, 11.83708568289876, 11.76908169935146, 11.581964092950017, 11.911418485144765, 22.58420430868864, 22.87162721902132, 23.088109351694584, 8.409231022000313, 9.039161592721939, 8.429977834224701, -93.43355805675189, -93.07237654055159, -99.0886063973109, 23.659662697464228, 23.208917751908302, 23.67202578112483, 28.07755065212646, 28.265009513745696, 28.362037903318793, 16.12268582234779, 16.038220825294644, 15.640502015749604, 27.110871329903603, 27.33866687119007, 26.58316257596016, -3.6735770354668347, -3.7928916017214505, -3.3204167584578244, 18.423424321226776, 18.3796463906765, 18.301329370588064, 24.35415274836123, 24.067286610603333, 24.37985255755484, 19.625790004928902, 18.985720609625176, 19.162706469496086, 20.392759675780923, 20.36884159843126, 20.36165430272618, 15.507006188233689, 15.723315132160977, 15.901520391305283, 20.73157783007869, 20.447804647187382, 20.31618172178665, 19.18143369009097, 19.55470835541685, 19.535450672109917, 24.89423242622675, 24.626253525416047, 24.910771696226817, 24.35035789757967, 24.59821537975222, 23.800730019807816, 25.684711587925747, 24.935592477520302, 25.768404527877763, 14.453051204482705, 15.176939147214085, 15.15318722712496, -1.2219202319781033, -1.1758082533876149, -1.120256128410503, 24.73601832985878, 25.270882127806544, 25.297295218333602, 28.038472970326737, 28.880819537987307, 28.92180123304327, 16.44770523657401, 16.432748345037297, 16.816823656850218, 20.053980633616447, 20.110231660306454, 20.285324439406395, 22.619185363252953, 23.19498549153407, 22.89358152945836, 16.9713912239919, 16.820719985912234, 16.51255817959705, 20.08560639371474, 19.617518489559487, 19.911262323458985, 19.333972619536013, 19.339312217819185, 19.35190023916462, 17.892461128532887, 18.101155690848827, 18.0398106649518, 25.989373504494623, 25.913830661525324, 25.919854660828904, 16.009133676687867, 16.191080431143433, 16.530305402974278, 28.89948959648609, 29.337264510802925, 29.36010041460395, 22.608595254520566, 22.595117973784596, 22.178021023670823, 26.251064106822014, 26.703712563961744, 26.891712123528123, 25.133536741137505, 25.16560761630535, 25.244766868650913, 17.013919870058686, 17.27248168985048, 17.94905788699785, 21.374022624144942, 20.64301466445127, 21.034548262755067, 19.67882227897644, 18.989062428474426, 19.79916452243924, 14.978834753856063, 14.393009319901466, 14.58083301782608, 8.803038388490677, 9.179996006190777, 9.17987860366702, 23.342179747919232, 23.13101742292443, 22.760431746641785, 21.89668573687473, 21.317787582675606, 21.874535160760075, 19.746060016254575, 19.82207281390825, 18.744818101326615, 16.29491249471903, 16.687087702099234, 16.57177035138011, 18.35952007273832, 18.08383201311031, 18.589242762575537, 4.37200917055209, 4.826803192923151, 4.516235386331871, 21.106408402323723, 21.478201638441533, 20.671726033091545, 18.618145967523247, 19.011862530062587, 18.44706521431604, 22.814141149322182, 22.81814434627691, 23.065820234517247, 29.650008377929524, 30.053172975157693, 30.09067673919101, 17.49678639074166, 17.359502737720803, 17.802265541007117, 15.258110423882798, 15.197041702767208, 14.45651266475518, 16.998404281834752, 16.96326373020807, 16.684393006066472, 14.81892071167627, 14.82062246153751, 15.31365385830091, 16.00890988608201, 16.238645819326237, 16.36701743708302, 17.776304895679147, 18.45400013277927, 18.45126116896668, 14.528815428415925, 15.39815282324949, 15.429539772371442, 17.465344975392014, 18.628543252746255, 18.768241117397935, 8.241812360783413, 8.168741070975855, 8.270190681641296, 21.756995476782322, 22.309288878925145, 22.315481862053275, 27.677740773186088, 26.21922793984413, 27.72293669852661, 25.075313575565815, 25.513131354004145, 24.42205162346363, 10.270388566966474, 10.258169341211513, 9.85418564577897, 7.226413087919354, 6.800394281744957, 6.804383769631386, 15.815449984123305, 15.038576995333031, 15.883765093361333, 14.405503691484526, 14.481709589560822, 14.503085286666945, 7.619846331576497, 7.981894713516027, 7.812249938646943, 10.959761830667645, 10.77955813954273, 10.993875468770653, 26.390079488356903, 26.95387740184863, 26.835503583153084, 22.433517307043076, 22.576768931001425, 22.086897373199463, 11.800997515519455, 11.944474463661507, 12.544220832486943, 14.873658778766782, 15.034602197508008, 15.3219525484989, 12.344660699367523, 12.581106208730489, 12.275661580264568, 15.206574532513812, 15.29030671374251, 15.18837584679325, 11.956795836488396, 11.570136966804654, 11.82155021528402, 6.593934312462807, 6.99203023314476, 7.255685837939382, 7.760091585417584, 7.994929806639746, 7.626308699448899, 14.315204525987298, 14.381836632887513, 14.140039066473634, 22.5302371357878, 22.912284463954464, 22.696257585038737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15349065457218303, "mean_inference_ms": 0.7052228064964166, "mean_action_processing_ms": 0.10011018321507321, "mean_env_wait_ms": 0.8079573542733456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1726920, "timesteps_this_iter": 0, "agent_timesteps_total": 5180760, "timers": {"sample_time_ms": 20032.644, "sample_throughput": 478.918, "load_time_ms": 0.1, "load_throughput": 95901221.582, "learn_time_ms": 3036.137, "learn_throughput": 3159.936, "update_time_ms": 8.71}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 5.576138257980347, "policy_loss": 0.0012983768107503457, "vf_loss": 5.756801664829254, "vf_explained_var": 0.03622010350227356, "kl": 0.009205020062223766, "entropy": 18.196176528930664, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1726920, "num_agent_steps_sampled": 5180760, "num_steps_trained": 1726920, "num_agent_steps_trained": 5180760, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6571, "training_iteration": 180, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-43-55", "timestamp": 1706193835, "time_this_iter_s": 19.818764209747314, "time_total_s": 3632.5241301059723, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004B9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3632.5241301059723, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 11.035714285714286, "ram_util_percent": 52.32857142857142}}
{"episode_reward_max": 89.79385809227823, "episode_reward_min": -3.517984613776221, "episode_reward_mean": 52.70948665040763, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -1.2219202319781033}, "policy_reward_max": {"shared_policy": 30.09067673919101}, "policy_reward_mean": {"shared_policy": 17.569828883469206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.774217084050164, 61.12325557693836, 47.13184171169995, 61.49556419905272, 58.271592717617736, 74.43125764786961, 72.7493032971397, 76.38870859332381, 44.78317757882175, -3.517984613776221, 75.30419567599893, 85.84109374135731, 49.697277238461524, 60.449536733329296, 68.70775238424538, 50.304669389501186, 59.61438720673321, 58.02518507651982, 54.033427484333515, 77.82305882684885, 48.73051951080558, 87.59685452189296, 67.38173425197598, 79.84648879431188, 75.54391122609377, 52.235459446907015, 63.05158555135128, 58.46704922989011, 43.95267709158361, 27.162912998348475, 69.23362891748545, 65.08900848031041, 58.31295093148944, 49.55377054819837, 55.03259484842417, 13.715047749807113, 63.2563360738568, 56.077073711901875, 68.69810573011634, 89.79385809227823, 52.65855466946958, 44.91166479140519, 50.64606101810929, 44.95319703151469, 48.61457314249127, 54.6815661974251, 45.356508024036856, 54.862129345536204, 24.680744113400564, 66.38176621776074, 81.61990541155683, 75.01049655303359, 30.382743553956956, 20.831191139295697, 46.73779207281767, 43.39029856771229, 23.413990983739467, 32.73319543898103, 80.17946047335862, 67.09718361124396, 36.289692811667905, 45.23021352477369, 37.20142848836258, 45.68525709304957, 35.34848301857707, 20.84165038354695, 23.38133009150623, 42.837080225348444, 68.138779184781, 52.28637402132152, 87.04830214008688, 43.5268012015149, 41.18380373343825, 38.56127099320291, 71.25530087482181, 70.57071199081837, 38.24769369699058, 54.081621274352074, 47.409761944785686, 44.66885785758495, 78.07784355687906, 13.23319930676368, 36.85273073427376, 45.715057052671895, 70.62547538615762, 71.5294084791094, 67.03716436401007, 31.70320962369439, 56.58955189213157, 42.17398027330637, 36.25156589969991, 43.573199279606314, 47.54253272712228, 76.18970584124324, 59.947295140475035, 45.35061013977972, 39.979153133928776, 52.553418177179964, 2.253556701587499, 37.66948516666886], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.625790004928902, 18.985720609625176, 19.162706469496086, 20.392759675780923, 20.36884159843126, 20.36165430272618, 15.507006188233689, 15.723315132160977, 15.901520391305283, 20.73157783007869, 20.447804647187382, 20.31618172178665, 19.18143369009097, 19.55470835541685, 19.535450672109917, 24.89423242622675, 24.626253525416047, 24.910771696226817, 24.35035789757967, 24.59821537975222, 23.800730019807816, 25.684711587925747, 24.935592477520302, 25.768404527877763, 14.453051204482705, 15.176939147214085, 15.15318722712496, -1.2219202319781033, -1.1758082533876149, -1.120256128410503, 24.73601832985878, 25.270882127806544, 25.297295218333602, 28.038472970326737, 28.880819537987307, 28.92180123304327, 16.44770523657401, 16.432748345037297, 16.816823656850218, 20.053980633616447, 20.110231660306454, 20.285324439406395, 22.619185363252953, 23.19498549153407, 22.89358152945836, 16.9713912239919, 16.820719985912234, 16.51255817959705, 20.08560639371474, 19.617518489559487, 19.911262323458985, 19.333972619536013, 19.339312217819185, 19.35190023916462, 17.892461128532887, 18.101155690848827, 18.0398106649518, 25.989373504494623, 25.913830661525324, 25.919854660828904, 16.009133676687867, 16.191080431143433, 16.530305402974278, 28.89948959648609, 29.337264510802925, 29.36010041460395, 22.608595254520566, 22.595117973784596, 22.178021023670823, 26.251064106822014, 26.703712563961744, 26.891712123528123, 25.133536741137505, 25.16560761630535, 25.244766868650913, 17.013919870058686, 17.27248168985048, 17.94905788699785, 21.374022624144942, 20.64301466445127, 21.034548262755067, 19.67882227897644, 18.989062428474426, 19.79916452243924, 14.978834753856063, 14.393009319901466, 14.58083301782608, 8.803038388490677, 9.179996006190777, 9.17987860366702, 23.342179747919232, 23.13101742292443, 22.760431746641785, 21.89668573687473, 21.317787582675606, 21.874535160760075, 19.746060016254575, 19.82207281390825, 18.744818101326615, 16.29491249471903, 16.687087702099234, 16.57177035138011, 18.35952007273832, 18.08383201311031, 18.589242762575537, 4.37200917055209, 4.826803192923151, 4.516235386331871, 21.106408402323723, 21.478201638441533, 20.671726033091545, 18.618145967523247, 19.011862530062587, 18.44706521431604, 22.814141149322182, 22.81814434627691, 23.065820234517247, 29.650008377929524, 30.053172975157693, 30.09067673919101, 17.49678639074166, 17.359502737720803, 17.802265541007117, 15.258110423882798, 15.197041702767208, 14.45651266475518, 16.998404281834752, 16.96326373020807, 16.684393006066472, 14.81892071167627, 14.82062246153751, 15.31365385830091, 16.00890988608201, 16.238645819326237, 16.36701743708302, 17.776304895679147, 18.45400013277927, 18.45126116896668, 14.528815428415925, 15.39815282324949, 15.429539772371442, 17.465344975392014, 18.628543252746255, 18.768241117397935, 8.241812360783413, 8.168741070975855, 8.270190681641296, 21.756995476782322, 22.309288878925145, 22.315481862053275, 27.677740773186088, 26.21922793984413, 27.72293669852661, 25.075313575565815, 25.513131354004145, 24.42205162346363, 10.270388566966474, 10.258169341211513, 9.85418564577897, 7.226413087919354, 6.800394281744957, 6.804383769631386, 15.815449984123305, 15.038576995333031, 15.883765093361333, 14.405503691484526, 14.481709589560822, 14.503085286666945, 7.619846331576497, 7.981894713516027, 7.812249938646943, 10.959761830667645, 10.77955813954273, 10.993875468770653, 26.390079488356903, 26.95387740184863, 26.835503583153084, 22.433517307043076, 22.576768931001425, 22.086897373199463, 11.800997515519455, 11.944474463661507, 12.544220832486943, 14.873658778766782, 15.034602197508008, 15.3219525484989, 12.344660699367523, 12.581106208730489, 12.275661580264568, 15.206574532513812, 15.29030671374251, 15.18837584679325, 11.956795836488396, 11.570136966804654, 11.82155021528402, 6.593934312462807, 6.99203023314476, 7.255685837939382, 7.760091585417584, 7.994929806639746, 7.626308699448899, 14.315204525987298, 14.381836632887513, 14.140039066473634, 22.5302371357878, 22.912284463954464, 22.696257585038737, 17.480130323519305, 17.339441960056618, 17.466801737745598, 28.783833314975098, 29.220957332601145, 29.043511492510632, 14.638301054947078, 14.273104965686798, 14.615395180881023, 14.026009850203991, 13.0511474609375, 14.106646422296762, 12.583852370580033, 13.105130994071558, 12.87228762855132, 23.366987014810235, 24.13533308884749, 23.75298077116409, 23.142766823371247, 24.163167710726455, 23.264777456720665, 12.620801510910184, 12.747073801855237, 12.87981838422516, 18.024062611162663, 18.326999567449093, 17.73055909574032, 15.311353782812745, 15.96718957523504, 16.1312185867379, 14.82176660001278, 15.110633730888367, 14.736457526683807, 26.24867375699492, 26.095736677447945, 25.733433122436196, 3.7218758265177314, 4.745910036067158, 4.76541344417879, 12.206913142154605, 12.41130515250066, 12.234512439618499, 15.209176075955227, 15.352143516143158, 15.15373746057351, 23.121228401859597, 23.760712926586464, 23.743534057711557, 23.591043204069138, 24.12690960802138, 23.81145566701889, 22.25450916836658, 22.603280177960784, 22.179375017682702, 10.674467331419379, 10.403379949430615, 10.625362342844397, 18.52971264719963, 19.112257692962885, 18.94758155196905, 13.7952249199152, 14.088269516825676, 14.290485836565495, 12.021640946467713, 12.359475807597235, 11.870449145634964, 14.650552729765565, 14.763331832985074, 14.159314716855675, 15.648531916240842, 15.840499291817338, 16.0535015190641, 24.98505766193071, 25.48992837468782, 25.714719804624707, 19.97428871318698, 19.906544886529446, 20.06646154075861, 14.911440740029008, 15.204285661379487, 15.234883738371224, 13.003205597400665, 13.194965735077858, 13.780981801450253, 17.863581305059284, 17.43188315878311, 17.25795371333757, 0.7307667260368618, 1.3075788026520314, 0.2152111728986057, 12.686495530108601, 12.798068496088177, 12.184921140472085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15352939478315777, "mean_inference_ms": 0.7053686651729594, "mean_action_processing_ms": 0.10014386125646924, "mean_env_wait_ms": 0.8080526728458214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1736514, "timesteps_this_iter": 0, "agent_timesteps_total": 5209542, "timers": {"sample_time_ms": 19995.0, "sample_throughput": 479.82, "load_time_ms": 0.2, "load_throughput": 47956325.32, "learn_time_ms": 3043.65, "learn_throughput": 3152.136, "update_time_ms": 8.658}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 6.0672144293785095, "policy_loss": 0.0012439509244049907, "vf_loss": 6.249324798583984, "vf_explained_var": 0.21633277088403702, "kl": 0.008198102412579776, "entropy": 18.335442781448364, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1736514, "num_agent_steps_sampled": 5209542, "num_steps_trained": 1736514, "num_agent_steps_trained": 5209542, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6602, "training_iteration": 181, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-44-16", "timestamp": 1706193856, "time_this_iter_s": 20.48111867904663, "time_total_s": 3653.005248785019, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA419D4EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3653.005248785019, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 9.87241379310345, "ram_util_percent": 52.41379310344827}}
{"episode_reward_max": 91.58788266312328, "episode_reward_min": -287.8800907731056, "episode_reward_mean": 46.26209801943215, "episode_len_mean": 297.68, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -100.01432498296103}, "policy_reward_max": {"shared_policy": 30.960595389517636}, "policy_reward_mean": {"shared_policy": 15.420699339810714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.55377054819837, 55.03259484842417, 13.715047749807113, 63.2563360738568, 56.077073711901875, 68.69810573011634, 89.79385809227823, 52.65855466946958, 44.91166479140519, 50.64606101810929, 44.95319703151469, 48.61457314249127, 54.6815661974251, 45.356508024036856, 54.862129345536204, 24.680744113400564, 66.38176621776074, 81.61990541155683, 75.01049655303359, 30.382743553956956, 20.831191139295697, 46.73779207281767, 43.39029856771229, 23.413990983739467, 32.73319543898103, 80.17946047335862, 67.09718361124396, 36.289692811667905, 45.23021352477369, 37.20142848836258, 45.68525709304957, 35.34848301857707, 20.84165038354695, 23.38133009150623, 42.837080225348444, 68.138779184781, 52.28637402132152, 87.04830214008688, 43.5268012015149, 41.18380373343825, 38.56127099320291, 71.25530087482181, 70.57071199081837, 38.24769369699058, 54.081621274352074, 47.409761944785686, 44.66885785758495, 78.07784355687906, 13.23319930676368, 36.85273073427376, 45.715057052671895, 70.62547538615762, 71.5294084791094, 67.03716436401007, 31.70320962369439, 56.58955189213157, 42.17398027330637, 36.25156589969991, 43.573199279606314, 47.54253272712228, 76.18970584124324, 59.947295140475035, 45.35061013977972, 39.979153133928776, 52.553418177179964, 2.253556701587499, 37.66948516666886, 69.81015504710375, 60.24691699072716, 53.165496928617344, 82.43632475938648, 77.1775208376348, 55.156263646669686, -0.7657107114792154, -287.8800907731056, 17.61107772961256, 44.552137376274885, 42.69078119657931, 91.58788266312328, 66.31859701592472, 79.80391564965248, 71.04706468805668, 33.41830027475952, 58.924076184630394, 51.75328222010283, 72.30184123665093, 18.203790656290934, -25.402096452191486, 20.128635068191215, 79.84872922301291, -4.425007872283459, 69.77848821505901, 81.18842759169637, 49.71498838067055, 84.37721348553895, 59.792131671682, 53.42459439113733, 33.88714982569216, 20.970500886440263, 61.454057373106465], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.29491249471903, 16.687087702099234, 16.57177035138011, 18.35952007273832, 18.08383201311031, 18.589242762575537, 4.37200917055209, 4.826803192923151, 4.516235386331871, 21.106408402323723, 21.478201638441533, 20.671726033091545, 18.618145967523247, 19.011862530062587, 18.44706521431604, 22.814141149322182, 22.81814434627691, 23.065820234517247, 29.650008377929524, 30.053172975157693, 30.09067673919101, 17.49678639074166, 17.359502737720803, 17.802265541007117, 15.258110423882798, 15.197041702767208, 14.45651266475518, 16.998404281834752, 16.96326373020807, 16.684393006066472, 14.81892071167627, 14.82062246153751, 15.31365385830091, 16.00890988608201, 16.238645819326237, 16.36701743708302, 17.776304895679147, 18.45400013277927, 18.45126116896668, 14.528815428415925, 15.39815282324949, 15.429539772371442, 17.465344975392014, 18.628543252746255, 18.768241117397935, 8.241812360783413, 8.168741070975855, 8.270190681641296, 21.756995476782322, 22.309288878925145, 22.315481862053275, 27.677740773186088, 26.21922793984413, 27.72293669852661, 25.075313575565815, 25.513131354004145, 24.42205162346363, 10.270388566966474, 10.258169341211513, 9.85418564577897, 7.226413087919354, 6.800394281744957, 6.804383769631386, 15.815449984123305, 15.038576995333031, 15.883765093361333, 14.405503691484526, 14.481709589560822, 14.503085286666945, 7.619846331576497, 7.981894713516027, 7.812249938646943, 10.959761830667645, 10.77955813954273, 10.993875468770653, 26.390079488356903, 26.95387740184863, 26.835503583153084, 22.433517307043076, 22.576768931001425, 22.086897373199463, 11.800997515519455, 11.944474463661507, 12.544220832486943, 14.873658778766782, 15.034602197508008, 15.3219525484989, 12.344660699367523, 12.581106208730489, 12.275661580264568, 15.206574532513812, 15.29030671374251, 15.18837584679325, 11.956795836488396, 11.570136966804654, 11.82155021528402, 6.593934312462807, 6.99203023314476, 7.255685837939382, 7.760091585417584, 7.994929806639746, 7.626308699448899, 14.315204525987298, 14.381836632887513, 14.140039066473634, 22.5302371357878, 22.912284463954464, 22.696257585038737, 17.480130323519305, 17.339441960056618, 17.466801737745598, 28.783833314975098, 29.220957332601145, 29.043511492510632, 14.638301054947078, 14.273104965686798, 14.615395180881023, 14.026009850203991, 13.0511474609375, 14.106646422296762, 12.583852370580033, 13.105130994071558, 12.87228762855132, 23.366987014810235, 24.13533308884749, 23.75298077116409, 23.142766823371247, 24.163167710726455, 23.264777456720665, 12.620801510910184, 12.747073801855237, 12.87981838422516, 18.024062611162663, 18.326999567449093, 17.73055909574032, 15.311353782812745, 15.96718957523504, 16.1312185867379, 14.82176660001278, 15.110633730888367, 14.736457526683807, 26.24867375699492, 26.095736677447945, 25.733433122436196, 3.7218758265177314, 4.745910036067158, 4.76541344417879, 12.206913142154605, 12.41130515250066, 12.234512439618499, 15.209176075955227, 15.352143516143158, 15.15373746057351, 23.121228401859597, 23.760712926586464, 23.743534057711557, 23.591043204069138, 24.12690960802138, 23.81145566701889, 22.25450916836658, 22.603280177960784, 22.179375017682702, 10.674467331419379, 10.403379949430615, 10.625362342844397, 18.52971264719963, 19.112257692962885, 18.94758155196905, 13.7952249199152, 14.088269516825676, 14.290485836565495, 12.021640946467713, 12.359475807597235, 11.870449145634964, 14.650552729765565, 14.763331832985074, 14.159314716855675, 15.648531916240842, 15.840499291817338, 16.0535015190641, 24.98505766193071, 25.48992837468782, 25.714719804624707, 19.97428871318698, 19.906544886529446, 20.06646154075861, 14.911440740029008, 15.204285661379487, 15.234883738371224, 13.003205597400665, 13.194965735077858, 13.780981801450253, 17.863581305059284, 17.43188315878311, 17.25795371333757, 0.7307667260368618, 1.3075788026520314, 0.2152111728986057, 12.686495530108601, 12.798068496088177, 12.184921140472085, 23.175367658336953, 23.420056692635015, 23.21473069613178, 20.215883969018847, 19.9277306596438, 20.10330236206451, 17.779092598085597, 17.768883039553955, 17.61752129097779, 27.59634541068226, 27.337539318948984, 27.502440029755235, 25.689027525484562, 25.907130625098944, 25.581362687051296, 18.075458273291588, 18.846505639143288, 18.23429973423481, -0.07639460762342765, -0.25777608652910544, -0.43154001732668235, -100.01432498296103, -93.76899411280951, -94.09677167733511, 6.273652608195931, 6.541943340251834, 4.795481781164796, 14.783735294515878, 14.91684233599031, 14.851559745768697, 13.496546323100716, 14.652340129638702, 14.54189474383989, 30.010938877860696, 30.960595389517636, 30.61634839574495, 21.904358143607766, 22.476461000430078, 21.93777787188688, 26.630493611097336, 26.519749522209167, 26.653672516345978, 23.883717639992625, 23.44208713869253, 23.721259909371526, 11.092148364832, 11.190616551165775, 11.135535358761743, 19.681607484817505, 19.860555976629257, 19.381912723183632, 17.002593224247292, 16.65635811289151, 18.09433088296403, 24.225289327402905, 23.863340829809502, 24.213211079438523, 6.276081692737833, 5.9019575168689045, 6.025751446684197, -8.709666545192405, -8.19340833711128, -8.499021569887802, 5.91100212931633, 7.104323155246675, 7.11330978362821, 26.645949830611542, 26.623731975754097, 26.57904741664727, -1.4371327757835388, -1.4601330906152725, -1.5277420058846474, 22.86184252301851, 23.48948688308397, 23.427158808956534, 26.988886532684162, 27.285740881537393, 26.913800177474812, 16.716687612235546, 16.282864704728127, 16.715436063706875, 28.282182437678173, 28.237636943658188, 27.857394104202584, 16.57733118534088, 21.38073979318142, 21.8340606931597, 18.068699820588023, 17.608296165863663, 17.747598404685647, 11.35860027869542, 11.411317904790238, 11.117231642206505, 6.897791994114712, 6.997393050541476, 7.075315841784075, 20.509947580595806, 20.65936405708392, 20.28474573542674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15348107905793187, "mean_inference_ms": 0.7052732891609397, "mean_action_processing_ms": 0.10011689663474194, "mean_env_wait_ms": 0.8079732377186002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1746108, "timesteps_this_iter": 0, "agent_timesteps_total": 5238324, "timers": {"sample_time_ms": 19919.998, "sample_throughput": 481.627, "load_time_ms": 0.2, "load_throughput": 47956325.32, "learn_time_ms": 3054.778, "learn_throughput": 3140.653, "update_time_ms": 8.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.222846456876986e-13, "cur_lr": 0.0005, "total_loss": 51.703479290008545, "policy_loss": 0.00044120364978733617, "vf_loss": 51.8857102394104, "vf_explained_var": -0.01813209056854248, "kl": 0.02741596032895282, "entropy": 18.267112493515015, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1746108, "num_agent_steps_sampled": 5238324, "num_steps_trained": 1746108, "num_agent_steps_trained": 5238324, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6635, "training_iteration": 182, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-44-35", "timestamp": 1706193875, "time_this_iter_s": 19.34006667137146, "time_total_s": 3672.3453154563904, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA020768B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3672.3453154563904, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 7.65925925925926, "ram_util_percent": 52.36666666666667}}
{"episode_reward_max": 99.9295488372445, "episode_reward_min": -287.8800907731056, "episode_reward_mean": 45.37237964751896, "episode_len_mean": 295.86, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -100.048970023791}, "policy_reward_max": {"shared_policy": 33.463418049116925}, "policy_reward_mean": {"shared_policy": 15.124126549172985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.34848301857707, 20.84165038354695, 23.38133009150623, 42.837080225348444, 68.138779184781, 52.28637402132152, 87.04830214008688, 43.5268012015149, 41.18380373343825, 38.56127099320291, 71.25530087482181, 70.57071199081837, 38.24769369699058, 54.081621274352074, 47.409761944785686, 44.66885785758495, 78.07784355687906, 13.23319930676368, 36.85273073427376, 45.715057052671895, 70.62547538615762, 71.5294084791094, 67.03716436401007, 31.70320962369439, 56.58955189213157, 42.17398027330637, 36.25156589969991, 43.573199279606314, 47.54253272712228, 76.18970584124324, 59.947295140475035, 45.35061013977972, 39.979153133928776, 52.553418177179964, 2.253556701587499, 37.66948516666886, 69.81015504710375, 60.24691699072716, 53.165496928617344, 82.43632475938648, 77.1775208376348, 55.156263646669686, -0.7657107114792154, -287.8800907731056, 17.61107772961256, 44.552137376274885, 42.69078119657931, 91.58788266312328, 66.31859701592472, 79.80391564965248, 71.04706468805668, 33.41830027475952, 58.924076184630394, 51.75328222010283, 72.30184123665093, 18.203790656290934, -25.402096452191486, 20.128635068191215, 79.84872922301291, -4.425007872283459, 69.77848821505901, 81.18842759169637, 49.71498838067055, 84.37721348553895, 59.792131671682, 53.42459439113733, 33.88714982569216, 20.970500886440263, 61.454057373106465, 54.18272084370254, 53.33205678313969, 48.4290665015578, 84.18692439608273, 12.10587863624093, 46.73511277884245, -269.3461302742362, 72.02570500969885, 54.80969863384959, 37.01452456088737, 61.37324632890521, 99.9295488372445, 48.00153018068522, 21.953613869845867, 76.87963356822726, 91.13154086656868, 74.25420376379043, 54.854435142129645, 78.49056782573462, 20.841608293354483, 52.18726250529288, 40.3939443156123, 79.6949521563947, 44.2588666938245, 92.41102999262509, 59.28513500839469, 77.66460165381429, 51.43354532867667, 70.68350015953183, 54.28049218654631, 17.225747290998683], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.956795836488396, 11.570136966804654, 11.82155021528402, 6.593934312462807, 6.99203023314476, 7.255685837939382, 7.760091585417584, 7.994929806639746, 7.626308699448899, 14.315204525987298, 14.381836632887513, 14.140039066473634, 22.5302371357878, 22.912284463954464, 22.696257585038737, 17.480130323519305, 17.339441960056618, 17.466801737745598, 28.783833314975098, 29.220957332601145, 29.043511492510632, 14.638301054947078, 14.273104965686798, 14.615395180881023, 14.026009850203991, 13.0511474609375, 14.106646422296762, 12.583852370580033, 13.105130994071558, 12.87228762855132, 23.366987014810235, 24.13533308884749, 23.75298077116409, 23.142766823371247, 24.163167710726455, 23.264777456720665, 12.620801510910184, 12.747073801855237, 12.87981838422516, 18.024062611162663, 18.326999567449093, 17.73055909574032, 15.311353782812745, 15.96718957523504, 16.1312185867379, 14.82176660001278, 15.110633730888367, 14.736457526683807, 26.24867375699492, 26.095736677447945, 25.733433122436196, 3.7218758265177314, 4.745910036067158, 4.76541344417879, 12.206913142154605, 12.41130515250066, 12.234512439618499, 15.209176075955227, 15.352143516143158, 15.15373746057351, 23.121228401859597, 23.760712926586464, 23.743534057711557, 23.591043204069138, 24.12690960802138, 23.81145566701889, 22.25450916836658, 22.603280177960784, 22.179375017682702, 10.674467331419379, 10.403379949430615, 10.625362342844397, 18.52971264719963, 19.112257692962885, 18.94758155196905, 13.7952249199152, 14.088269516825676, 14.290485836565495, 12.021640946467713, 12.359475807597235, 11.870449145634964, 14.650552729765565, 14.763331832985074, 14.159314716855675, 15.648531916240842, 15.840499291817338, 16.0535015190641, 24.98505766193071, 25.48992837468782, 25.714719804624707, 19.97428871318698, 19.906544886529446, 20.06646154075861, 14.911440740029008, 15.204285661379487, 15.234883738371224, 13.003205597400665, 13.194965735077858, 13.780981801450253, 17.863581305059284, 17.43188315878311, 17.25795371333757, 0.7307667260368618, 1.3075788026520314, 0.2152111728986057, 12.686495530108601, 12.798068496088177, 12.184921140472085, 23.175367658336953, 23.420056692635015, 23.21473069613178, 20.215883969018847, 19.9277306596438, 20.10330236206451, 17.779092598085597, 17.768883039553955, 17.61752129097779, 27.59634541068226, 27.337539318948984, 27.502440029755235, 25.689027525484562, 25.907130625098944, 25.581362687051296, 18.075458273291588, 18.846505639143288, 18.23429973423481, -0.07639460762342765, -0.25777608652910544, -0.43154001732668235, -100.01432498296103, -93.76899411280951, -94.09677167733511, 6.273652608195931, 6.541943340251834, 4.795481781164796, 14.783735294515878, 14.91684233599031, 14.851559745768697, 13.496546323100716, 14.652340129638702, 14.54189474383989, 30.010938877860696, 30.960595389517636, 30.61634839574495, 21.904358143607766, 22.476461000430078, 21.93777787188688, 26.630493611097336, 26.519749522209167, 26.653672516345978, 23.883717639992625, 23.44208713869253, 23.721259909371526, 11.092148364832, 11.190616551165775, 11.135535358761743, 19.681607484817505, 19.860555976629257, 19.381912723183632, 17.002593224247292, 16.65635811289151, 18.09433088296403, 24.225289327402905, 23.863340829809502, 24.213211079438523, 6.276081692737833, 5.9019575168689045, 6.025751446684197, -8.709666545192405, -8.19340833711128, -8.499021569887802, 5.91100212931633, 7.104323155246675, 7.11330978362821, 26.645949830611542, 26.623731975754097, 26.57904741664727, -1.4371327757835388, -1.4601330906152725, -1.5277420058846474, 22.86184252301851, 23.48948688308397, 23.427158808956534, 26.988886532684162, 27.285740881537393, 26.913800177474812, 16.716687612235546, 16.282864704728127, 16.715436063706875, 28.282182437678173, 28.237636943658188, 27.857394104202584, 16.57733118534088, 21.38073979318142, 21.8340606931597, 18.068699820588023, 17.608296165863663, 17.747598404685647, 11.35860027869542, 11.411317904790238, 11.117231642206505, 6.897791994114712, 6.997393050541476, 7.075315841784075, 20.509947580595806, 20.65936405708392, 20.28474573542674, 18.267555971940354, 17.241973867019013, 18.673191004743174, 17.790555906792477, 17.99979283412297, 17.541708042224244, 16.331343824664742, 16.09146627287069, 16.006256404022366, 28.589169376219303, 27.81853553156057, 27.779219488302857, 3.8315079758564536, 4.359159956375748, 3.9152107040087287, 15.523777268826962, 15.589648447930813, 15.621687062084675, -100.048970023791, -84.62091412643592, -84.6762461240093, 24.195505787928894, 24.202573930223778, 23.62762529154618, 18.412950704495103, 18.42803295205036, 17.96871497730413, 12.224251113831997, 12.258457977324724, 12.531815469730645, 19.41551639636357, 21.0728019097199, 20.88492802282174, 33.23715218653281, 33.463418049116925, 33.22897860159476, 15.80134443193674, 16.194194263778627, 16.005991484969854, 7.291566878557205, 7.451084926724434, 7.210962064564228, 25.5300475458304, 25.44068885842958, 25.908897163967282, 30.112871758639812, 30.521022871136665, 30.497646236792207, 24.873463039286435, 24.927892208099365, 24.45284851640463, 18.053618167837456, 18.720228673269347, 18.080588301022843, 26.25273898988962, 26.108757078647614, 26.12907175719738, 7.044848925123603, 6.865689190725476, 6.931070177505404, 17.653887455662087, 17.647473027308777, 16.885902022322014, 13.46908065428336, 13.792596002419785, 13.132267658909157, 26.514370215435818, 26.478533965845898, 26.70204797511299, 14.193099523584038, 15.066910619537026, 14.998856550703437, 30.950079411889106, 30.606629858414323, 30.85432072232166, 19.38109355668226, 19.766251767675072, 20.137789684037358, 25.63004347185293, 25.66534588734308, 26.36921229461828, 17.514433207611233, 16.366370151440293, 17.552741969625146, 23.902835357934237, 23.383776262402534, 23.39688853919506, 18.04757262518008, 18.26548523207505, 17.96743432929118, 5.82064752032359, 5.952778482188776, 5.452321288486317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15349680452389225, "mean_inference_ms": 0.7054149648901462, "mean_action_processing_ms": 0.10013985875629004, "mean_env_wait_ms": 0.8080389107179999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1755702, "timesteps_this_iter": 0, "agent_timesteps_total": 5267106, "timers": {"sample_time_ms": 19959.629, "sample_throughput": 480.67, "load_time_ms": 0.2, "load_throughput": 47956325.32, "learn_time_ms": 3072.188, "learn_throughput": 3122.855, "update_time_ms": 8.858}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 43.05185079574585, "policy_loss": -0.00030960964515980294, "vf_loss": 43.23500156402588, "vf_explained_var": 0.24994700402021408, "kl": 0.012865016470156141, "entropy": 18.283995866775513, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1755702, "num_agent_steps_sampled": 5267106, "num_steps_trained": 1755702, "num_agent_steps_trained": 5267106, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6666, "training_iteration": 183, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-44-55", "timestamp": 1706193895, "time_this_iter_s": 19.882770538330078, "time_total_s": 3692.2280859947205, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B881F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3692.2280859947205, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 10.174999999999999, "ram_util_percent": 52.36071428571427}}
{"episode_reward_max": 99.9295488372445, "episode_reward_min": -287.8800907731056, "episode_reward_mean": 46.93839301898609, "episode_len_mean": 295.86, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -100.048970023791}, "policy_reward_max": {"shared_policy": 33.463418049116925}, "policy_reward_mean": {"shared_policy": 15.646131006328693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.553418177179964, 2.253556701587499, 37.66948516666886, 69.81015504710375, 60.24691699072716, 53.165496928617344, 82.43632475938648, 77.1775208376348, 55.156263646669686, -0.7657107114792154, -287.8800907731056, 17.61107772961256, 44.552137376274885, 42.69078119657931, 91.58788266312328, 66.31859701592472, 79.80391564965248, 71.04706468805668, 33.41830027475952, 58.924076184630394, 51.75328222010283, 72.30184123665093, 18.203790656290934, -25.402096452191486, 20.128635068191215, 79.84872922301291, -4.425007872283459, 69.77848821505901, 81.18842759169637, 49.71498838067055, 84.37721348553895, 59.792131671682, 53.42459439113733, 33.88714982569216, 20.970500886440263, 61.454057373106465, 54.18272084370254, 53.33205678313969, 48.4290665015578, 84.18692439608273, 12.10587863624093, 46.73511277884245, -269.3461302742362, 72.02570500969885, 54.80969863384959, 37.01452456088737, 61.37324632890521, 99.9295488372445, 48.00153018068522, 21.953613869845867, 76.87963356822726, 91.13154086656868, 74.25420376379043, 54.854435142129645, 78.49056782573462, 20.841608293354483, 52.18726250529288, 40.3939443156123, 79.6949521563947, 44.2588666938245, 92.41102999262509, 59.28513500839469, 77.66460165381429, 51.43354532867667, 70.68350015953183, 54.28049218654631, 17.225747290998683, 51.25400255247948, 71.62790145725009, 1.2063911035656645, 89.88936052192, 41.565034996718154, 57.58927438594401, 55.90698624402283, 50.879116743803024, 64.33601015806198, 57.62482710368931, 42.52231303229928, 28.669483575969906, 68.29930911958215, 38.31912965606897, 32.9880993813276, 74.13566739112136, 70.3835757933557, 57.31660520099102, 84.05064857937393, 56.28988209879026, 5.754639892838867, 57.038737848401055, 54.231250524520874, 51.97254336345938, 68.88061396405101, 19.86806838028133, 70.64934271946548, 22.18238953407854, 79.73887456115332, 68.16031138878316, 75.54781442135571, 68.12354329973459, 61.35909361578523], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 68, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.863581305059284, 17.43188315878311, 17.25795371333757, 0.7307667260368618, 1.3075788026520314, 0.2152111728986057, 12.686495530108601, 12.798068496088177, 12.184921140472085, 23.175367658336953, 23.420056692635015, 23.21473069613178, 20.215883969018847, 19.9277306596438, 20.10330236206451, 17.779092598085597, 17.768883039553955, 17.61752129097779, 27.59634541068226, 27.337539318948984, 27.502440029755235, 25.689027525484562, 25.907130625098944, 25.581362687051296, 18.075458273291588, 18.846505639143288, 18.23429973423481, -0.07639460762342765, -0.25777608652910544, -0.43154001732668235, -100.01432498296103, -93.76899411280951, -94.09677167733511, 6.273652608195931, 6.541943340251834, 4.795481781164796, 14.783735294515878, 14.91684233599031, 14.851559745768697, 13.496546323100716, 14.652340129638702, 14.54189474383989, 30.010938877860696, 30.960595389517636, 30.61634839574495, 21.904358143607766, 22.476461000430078, 21.93777787188688, 26.630493611097336, 26.519749522209167, 26.653672516345978, 23.883717639992625, 23.44208713869253, 23.721259909371526, 11.092148364832, 11.190616551165775, 11.135535358761743, 19.681607484817505, 19.860555976629257, 19.381912723183632, 17.002593224247292, 16.65635811289151, 18.09433088296403, 24.225289327402905, 23.863340829809502, 24.213211079438523, 6.276081692737833, 5.9019575168689045, 6.025751446684197, -8.709666545192405, -8.19340833711128, -8.499021569887802, 5.91100212931633, 7.104323155246675, 7.11330978362821, 26.645949830611542, 26.623731975754097, 26.57904741664727, -1.4371327757835388, -1.4601330906152725, -1.5277420058846474, 22.86184252301851, 23.48948688308397, 23.427158808956534, 26.988886532684162, 27.285740881537393, 26.913800177474812, 16.716687612235546, 16.282864704728127, 16.715436063706875, 28.282182437678173, 28.237636943658188, 27.857394104202584, 16.57733118534088, 21.38073979318142, 21.8340606931597, 18.068699820588023, 17.608296165863663, 17.747598404685647, 11.35860027869542, 11.411317904790238, 11.117231642206505, 6.897791994114712, 6.997393050541476, 7.075315841784075, 20.509947580595806, 20.65936405708392, 20.28474573542674, 18.267555971940354, 17.241973867019013, 18.673191004743174, 17.790555906792477, 17.99979283412297, 17.541708042224244, 16.331343824664742, 16.09146627287069, 16.006256404022366, 28.589169376219303, 27.81853553156057, 27.779219488302857, 3.8315079758564536, 4.359159956375748, 3.9152107040087287, 15.523777268826962, 15.589648447930813, 15.621687062084675, -100.048970023791, -84.62091412643592, -84.6762461240093, 24.195505787928894, 24.202573930223778, 23.62762529154618, 18.412950704495103, 18.42803295205036, 17.96871497730413, 12.224251113831997, 12.258457977324724, 12.531815469730645, 19.41551639636357, 21.0728019097199, 20.88492802282174, 33.23715218653281, 33.463418049116925, 33.22897860159476, 15.80134443193674, 16.194194263778627, 16.005991484969854, 7.291566878557205, 7.451084926724434, 7.210962064564228, 25.5300475458304, 25.44068885842958, 25.908897163967282, 30.112871758639812, 30.521022871136665, 30.497646236792207, 24.873463039286435, 24.927892208099365, 24.45284851640463, 18.053618167837456, 18.720228673269347, 18.080588301022843, 26.25273898988962, 26.108757078647614, 26.12907175719738, 7.044848925123603, 6.865689190725476, 6.931070177505404, 17.653887455662087, 17.647473027308777, 16.885902022322014, 13.46908065428336, 13.792596002419785, 13.132267658909157, 26.514370215435818, 26.478533965845898, 26.70204797511299, 14.193099523584038, 15.066910619537026, 14.998856550703437, 30.950079411889106, 30.606629858414323, 30.85432072232166, 19.38109355668226, 19.766251767675072, 20.137789684037358, 25.63004347185293, 25.66534588734308, 26.36921229461828, 17.514433207611233, 16.366370151440293, 17.552741969625146, 23.902835357934237, 23.383776262402534, 23.39688853919506, 18.04757262518008, 18.26548523207505, 17.96743432929118, 5.82064752032359, 5.952778482188776, 5.452321288486317, 17.087694632510335, 17.233187204847724, 16.93312071512142, 23.653395200769097, 24.013960423568875, 23.960545832912118, 0.716421375672013, 0.14968208471933053, 0.3402876431743209, 29.91671099017063, 29.932889143625886, 30.039760388123483, 13.597615023454026, 14.254924447586134, 13.712495525677994, 19.0251482501626, 19.411842780187726, 19.15228335559368, 18.799315878500536, 18.320610133310154, 18.78706023221214, 17.229006208479404, 16.508058041334152, 17.142052493989468, 21.523937836289406, 21.255094066262245, 21.55697825551033, 19.250874113291502, 19.000540360808372, 19.37341262958944, 14.088571175932884, 14.141613572835922, 14.292128283530474, 9.668013595665485, 9.33305002997318, 9.668419950331241, 22.900283123056084, 22.43150384227434, 22.967522154251725, 12.57494070132573, 13.328744843912617, 12.41544411083062, 11.20937670270601, 11.177663455406815, 10.601059223214776, 24.60262049237886, 24.77009270588556, 24.762954192856938, 23.083287984132767, 23.600854337215424, 23.699433472007513, 19.272209295382098, 18.498794381817177, 19.545601523791746, 28.22711928250888, 28.072486868749053, 27.751042428115994, 18.34600254893303, 19.16670370614156, 18.777175843715668, 1.9190208675960605, 1.9875932220990364, 1.84802580314377, 18.8716440697511, 19.221525867780045, 18.94556791086991, 17.813061505556107, 18.354922600090504, 18.063266418874264, 17.251157606641442, 17.571684568809957, 17.14970118800798, 22.859034419059753, 22.65824879705906, 23.363330747932196, 6.665244609117508, 5.840048104524612, 7.362775666639209, 23.33967790504296, 23.61516647537549, 23.69449833904703, 7.208448730409145, 7.616723536513746, 7.357217267155647, 26.380252900222928, 26.53356163452068, 26.825060026409716, 22.851234902627766, 22.465704083442688, 22.843372402712703, 25.238050041099385, 24.91383597751458, 25.395928402741745, 22.702921349555254, 22.769490461796522, 22.651131488382816, 19.71533565719922, 20.809426195298627, 20.83433176328738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15341645267599507, "mean_inference_ms": 0.7051776345618945, "mean_action_processing_ms": 0.10010223686289849, "mean_env_wait_ms": 0.8078569869928083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1765296, "timesteps_this_iter": 0, "agent_timesteps_total": 5295888, "timers": {"sample_time_ms": 19965.89, "sample_throughput": 480.52, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3066.731, "learn_throughput": 3128.413, "update_time_ms": 8.752}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 5.19981986284256, "policy_loss": 0.0023397033911682907, "vf_loss": 5.379980683326721, "vf_explained_var": 0.244239903986454, "kl": 0.016199872014547687, "entropy": 18.250067234039307, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1765296, "num_agent_steps_sampled": 5295888, "num_steps_trained": 1765296, "num_agent_steps_trained": 5295888, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6699, "training_iteration": 184, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-45-15", "timestamp": 1706193915, "time_this_iter_s": 19.664737462997437, "time_total_s": 3711.892823457718, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01626AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3711.892823457718, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 8.746428571428572, "ram_util_percent": 52.41071428571428}}
{"episode_reward_max": 101.16858611255881, "episode_reward_min": -269.3461302742362, "episode_reward_mean": 50.71243463321471, "episode_len_mean": 298.18, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -100.048970023791}, "policy_reward_max": {"shared_policy": 33.976486581067235}, "policy_reward_mean": {"shared_policy": 16.904144877738236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.970500886440263, 61.454057373106465, 54.18272084370254, 53.33205678313969, 48.4290665015578, 84.18692439608273, 12.10587863624093, 46.73511277884245, -269.3461302742362, 72.02570500969885, 54.80969863384959, 37.01452456088737, 61.37324632890521, 99.9295488372445, 48.00153018068522, 21.953613869845867, 76.87963356822726, 91.13154086656868, 74.25420376379043, 54.854435142129645, 78.49056782573462, 20.841608293354483, 52.18726250529288, 40.3939443156123, 79.6949521563947, 44.2588666938245, 92.41102999262509, 59.28513500839469, 77.66460165381429, 51.43354532867667, 70.68350015953183, 54.28049218654631, 17.225747290998683, 51.25400255247948, 71.62790145725009, 1.2063911035656645, 89.88936052192, 41.565034996718154, 57.58927438594401, 55.90698624402283, 50.879116743803024, 64.33601015806198, 57.62482710368931, 42.52231303229928, 28.669483575969906, 68.29930911958215, 38.31912965606897, 32.9880993813276, 74.13566739112136, 70.3835757933557, 57.31660520099102, 84.05064857937393, 56.28988209879026, 5.754639892838867, 57.038737848401055, 54.231250524520874, 51.97254336345938, 68.88061396405101, 19.86806838028133, 70.64934271946548, 22.18238953407854, 79.73887456115332, 68.16031138878316, 75.54781442135571, 68.12354329973459, 61.35909361578523, 41.94349705800414, 46.20534181222317, 53.288738600909696, 78.0022391527891, 61.67121207248418, 64.31484759785235, 60.06340171396731, 74.21740114688872, 63.38447564095256, 44.08969528600571, 71.18863229919224, 31.2828503102064, 36.011335719376774, 93.1741356886923, 30.952822867780895, 45.62797502242029, 83.58246102929114, 32.25417089031542, 101.16858611255881, 48.3496545990929, 66.54668911918995, 30.31614024564624, 46.29564716666937, 26.24388539418578, 40.86889102961868, 79.54105711355805, 18.397361076436937, 60.67922145500776, 35.38055172609165, 50.145199969410896, 52.03787207789718, 25.57840572576967, 44.53331865556537, -7.584216762334137], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 118, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [6.897791994114712, 6.997393050541476, 7.075315841784075, 20.509947580595806, 20.65936405708392, 20.28474573542674, 18.267555971940354, 17.241973867019013, 18.673191004743174, 17.790555906792477, 17.99979283412297, 17.541708042224244, 16.331343824664742, 16.09146627287069, 16.006256404022366, 28.589169376219303, 27.81853553156057, 27.779219488302857, 3.8315079758564536, 4.359159956375748, 3.9152107040087287, 15.523777268826962, 15.589648447930813, 15.621687062084675, -100.048970023791, -84.62091412643592, -84.6762461240093, 24.195505787928894, 24.202573930223778, 23.62762529154618, 18.412950704495103, 18.42803295205036, 17.96871497730413, 12.224251113831997, 12.258457977324724, 12.531815469730645, 19.41551639636357, 21.0728019097199, 20.88492802282174, 33.23715218653281, 33.463418049116925, 33.22897860159476, 15.80134443193674, 16.194194263778627, 16.005991484969854, 7.291566878557205, 7.451084926724434, 7.210962064564228, 25.5300475458304, 25.44068885842958, 25.908897163967282, 30.112871758639812, 30.521022871136665, 30.497646236792207, 24.873463039286435, 24.927892208099365, 24.45284851640463, 18.053618167837456, 18.720228673269347, 18.080588301022843, 26.25273898988962, 26.108757078647614, 26.12907175719738, 7.044848925123603, 6.865689190725476, 6.931070177505404, 17.653887455662087, 17.647473027308777, 16.885902022322014, 13.46908065428336, 13.792596002419785, 13.132267658909157, 26.514370215435818, 26.478533965845898, 26.70204797511299, 14.193099523584038, 15.066910619537026, 14.998856550703437, 30.950079411889106, 30.606629858414323, 30.85432072232166, 19.38109355668226, 19.766251767675072, 20.137789684037358, 25.63004347185293, 25.66534588734308, 26.36921229461828, 17.514433207611233, 16.366370151440293, 17.552741969625146, 23.902835357934237, 23.383776262402534, 23.39688853919506, 18.04757262518008, 18.26548523207505, 17.96743432929118, 5.82064752032359, 5.952778482188776, 5.452321288486317, 17.087694632510335, 17.233187204847724, 16.93312071512142, 23.653395200769097, 24.013960423568875, 23.960545832912118, 0.716421375672013, 0.14968208471933053, 0.3402876431743209, 29.91671099017063, 29.932889143625886, 30.039760388123483, 13.597615023454026, 14.254924447586134, 13.712495525677994, 19.0251482501626, 19.411842780187726, 19.15228335559368, 18.799315878500536, 18.320610133310154, 18.78706023221214, 17.229006208479404, 16.508058041334152, 17.142052493989468, 21.523937836289406, 21.255094066262245, 21.55697825551033, 19.250874113291502, 19.000540360808372, 19.37341262958944, 14.088571175932884, 14.141613572835922, 14.292128283530474, 9.668013595665485, 9.33305002997318, 9.668419950331241, 22.900283123056084, 22.43150384227434, 22.967522154251725, 12.57494070132573, 13.328744843912617, 12.41544411083062, 11.20937670270601, 11.177663455406815, 10.601059223214776, 24.60262049237886, 24.77009270588556, 24.762954192856938, 23.083287984132767, 23.600854337215424, 23.699433472007513, 19.272209295382098, 18.498794381817177, 19.545601523791746, 28.22711928250888, 28.072486868749053, 27.751042428115994, 18.34600254893303, 19.16670370614156, 18.777175843715668, 1.9190208675960605, 1.9875932220990364, 1.84802580314377, 18.8716440697511, 19.221525867780045, 18.94556791086991, 17.813061505556107, 18.354922600090504, 18.063266418874264, 17.251157606641442, 17.571684568809957, 17.14970118800798, 22.859034419059753, 22.65824879705906, 23.363330747932196, 6.665244609117508, 5.840048104524612, 7.362775666639209, 23.33967790504296, 23.61516647537549, 23.69449833904703, 7.208448730409145, 7.616723536513746, 7.357217267155647, 26.380252900222928, 26.53356163452068, 26.825060026409716, 22.851234902627766, 22.465704083442688, 22.843372402712703, 25.238050041099385, 24.91383597751458, 25.395928402741745, 22.702921349555254, 22.769490461796522, 22.651131488382816, 19.71533565719922, 20.809426195298627, 20.83433176328738, 13.558287724852562, 13.98499782383442, 14.40021150931716, 15.384106094638497, 15.714886150012404, 15.106349567572266, 17.11209626992543, 18.29328654458125, 17.883355786403015, 25.901217517753437, 26.05016956230004, 26.050852072735623, 20.654450111401573, 20.570418053617075, 20.446343907465533, 21.196399442851543, 21.509444564580917, 21.60900359041989, 20.13349000116189, 20.14905985196431, 19.78085186084111, 24.841740404566124, 24.32622631390889, 25.049434428413704, 21.218301004419715, 21.411984434972197, 20.754190201560647, 15.19757795954743, 14.377687181035668, 14.514430145422608, 23.52083972593148, 23.64104102303584, 24.026751550224915, 10.599539910753563, 10.287248228987053, 10.396062170465783, 11.82003843287626, 12.356969385097415, 11.8343279014031, 31.293550613025815, 31.148922494302184, 30.731662581364304, 10.547841204951197, 10.340616623560578, 10.06436503926912, 15.442464428022504, 14.855969801545143, 15.32954079285264, 27.760909770925835, 27.90615127732356, 27.915399981041745, 10.800448918094233, 10.900381711039998, 10.55334026118119, 33.32880444327989, 33.976486581067235, 33.863295088211686, 16.218916073441505, 15.602092415094376, 16.52864611055702, 21.646886522571236, 22.47876703614989, 22.421035560468823, 9.806127965450287, 10.350599836558104, 10.159412443637848, 15.241017326712608, 15.369578957557678, 15.685050882399082, 8.752727270126343, 8.600224018096924, 8.890934105962515, 13.371597796678543, 13.916070035658777, 13.58122319728136, 26.559919822961092, 26.30078037828207, 26.680356912314892, 6.470788077451289, 5.5278648138046265, 6.398708185181022, 20.415564602861792, 20.198331433037907, 20.065325419108063, 11.757262231782079, 11.825823780614883, 11.797465713694692, 16.64826050400734, 16.67156895622611, 16.825370509177446, 17.241057006021336, 17.498290769134954, 17.298524302740887, 8.596737091119081, 8.557466324108333, 8.424202310542256, 14.527486038704708, 15.010601908278957, 14.995230708581701, -2.634604026873916, -2.4295833644767697, -2.520029370983451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534165086676538, "mean_inference_ms": 0.7051256831333512, "mean_action_processing_ms": 0.1000689596302356, "mean_env_wait_ms": 0.8077821737787484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1774890, "timesteps_this_iter": 0, "agent_timesteps_total": 5324670, "timers": {"sample_time_ms": 19953.185, "sample_throughput": 480.825, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3060.199, "learn_throughput": 3135.09, "update_time_ms": 8.853}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 7.352219641208649, "policy_loss": 0.0005046383019018386, "vf_loss": 7.535275638103485, "vf_explained_var": 0.13493738323450089, "kl": 0.007457922620539164, "entropy": 18.35609769821167, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1774890, "num_agent_steps_sampled": 5324670, "num_steps_trained": 1774890, "num_agent_steps_trained": 5324670, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6733, "training_iteration": 185, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-45-34", "timestamp": 1706193934, "time_this_iter_s": 19.449260234832764, "time_total_s": 3731.3420836925507, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03AF43A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3731.3420836925507, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 8.08148148148148, "ram_util_percent": 52.429629629629616}}
{"episode_reward_max": 101.16858611255881, "episode_reward_min": -7.584216762334137, "episode_reward_mean": 53.895747591294345, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -2.634604026873916}, "policy_reward_max": {"shared_policy": 33.976486581067235}, "policy_reward_mean": {"shared_policy": 17.96524919709811}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.68350015953183, 54.28049218654631, 17.225747290998683, 51.25400255247948, 71.62790145725009, 1.2063911035656645, 89.88936052192, 41.565034996718154, 57.58927438594401, 55.90698624402283, 50.879116743803024, 64.33601015806198, 57.62482710368931, 42.52231303229928, 28.669483575969906, 68.29930911958215, 38.31912965606897, 32.9880993813276, 74.13566739112136, 70.3835757933557, 57.31660520099102, 84.05064857937393, 56.28988209879026, 5.754639892838867, 57.038737848401055, 54.231250524520874, 51.97254336345938, 68.88061396405101, 19.86806838028133, 70.64934271946548, 22.18238953407854, 79.73887456115332, 68.16031138878316, 75.54781442135571, 68.12354329973459, 61.35909361578523, 41.94349705800414, 46.20534181222317, 53.288738600909696, 78.0022391527891, 61.67121207248418, 64.31484759785235, 60.06340171396731, 74.21740114688872, 63.38447564095256, 44.08969528600571, 71.18863229919224, 31.2828503102064, 36.011335719376774, 93.1741356886923, 30.952822867780895, 45.62797502242029, 83.58246102929114, 32.25417089031542, 101.16858611255881, 48.3496545990929, 66.54668911918995, 30.31614024564624, 46.29564716666937, 26.24388539418578, 40.86889102961868, 79.54105711355805, 18.397361076436937, 60.67922145500776, 35.38055172609165, 50.145199969410896, 52.03787207789718, 25.57840572576967, 44.53331865556537, -7.584216762334137, 46.52309190481901, 84.28235325217244, 26.832055201753946, 68.16683547478169, 18.386452527716756, 49.21241291426121, 33.09221382439135, 65.36431114561856, 66.40652406029402, 85.07502127066253, 52.50244680047035, 39.41930064652115, 60.687802553176866, 75.44842880964279, 62.55482470989226, 24.27535910904406, 61.887775741517544, 62.33607819490132, 64.65139207616447, 17.376841393765048, 54.89547634962945, 65.79215478524564, 68.67712491122072, 65.72614890709518, 70.31858842074868, 50.921807275968575, 78.20628023892641, 59.71653248369692, 61.080923363566384, 79.45411992073058], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.902835357934237, 23.383776262402534, 23.39688853919506, 18.04757262518008, 18.26548523207505, 17.96743432929118, 5.82064752032359, 5.952778482188776, 5.452321288486317, 17.087694632510335, 17.233187204847724, 16.93312071512142, 23.653395200769097, 24.013960423568875, 23.960545832912118, 0.716421375672013, 0.14968208471933053, 0.3402876431743209, 29.91671099017063, 29.932889143625886, 30.039760388123483, 13.597615023454026, 14.254924447586134, 13.712495525677994, 19.0251482501626, 19.411842780187726, 19.15228335559368, 18.799315878500536, 18.320610133310154, 18.78706023221214, 17.229006208479404, 16.508058041334152, 17.142052493989468, 21.523937836289406, 21.255094066262245, 21.55697825551033, 19.250874113291502, 19.000540360808372, 19.37341262958944, 14.088571175932884, 14.141613572835922, 14.292128283530474, 9.668013595665485, 9.33305002997318, 9.668419950331241, 22.900283123056084, 22.43150384227434, 22.967522154251725, 12.57494070132573, 13.328744843912617, 12.41544411083062, 11.20937670270601, 11.177663455406815, 10.601059223214776, 24.60262049237886, 24.77009270588556, 24.762954192856938, 23.083287984132767, 23.600854337215424, 23.699433472007513, 19.272209295382098, 18.498794381817177, 19.545601523791746, 28.22711928250888, 28.072486868749053, 27.751042428115994, 18.34600254893303, 19.16670370614156, 18.777175843715668, 1.9190208675960605, 1.9875932220990364, 1.84802580314377, 18.8716440697511, 19.221525867780045, 18.94556791086991, 17.813061505556107, 18.354922600090504, 18.063266418874264, 17.251157606641442, 17.571684568809957, 17.14970118800798, 22.859034419059753, 22.65824879705906, 23.363330747932196, 6.665244609117508, 5.840048104524612, 7.362775666639209, 23.33967790504296, 23.61516647537549, 23.69449833904703, 7.208448730409145, 7.616723536513746, 7.357217267155647, 26.380252900222928, 26.53356163452068, 26.825060026409716, 22.851234902627766, 22.465704083442688, 22.843372402712703, 25.238050041099385, 24.91383597751458, 25.395928402741745, 22.702921349555254, 22.769490461796522, 22.651131488382816, 19.71533565719922, 20.809426195298627, 20.83433176328738, 13.558287724852562, 13.98499782383442, 14.40021150931716, 15.384106094638497, 15.714886150012404, 15.106349567572266, 17.11209626992543, 18.29328654458125, 17.883355786403015, 25.901217517753437, 26.05016956230004, 26.050852072735623, 20.654450111401573, 20.570418053617075, 20.446343907465533, 21.196399442851543, 21.509444564580917, 21.60900359041989, 20.13349000116189, 20.14905985196431, 19.78085186084111, 24.841740404566124, 24.32622631390889, 25.049434428413704, 21.218301004419715, 21.411984434972197, 20.754190201560647, 15.19757795954743, 14.377687181035668, 14.514430145422608, 23.52083972593148, 23.64104102303584, 24.026751550224915, 10.599539910753563, 10.287248228987053, 10.396062170465783, 11.82003843287626, 12.356969385097415, 11.8343279014031, 31.293550613025815, 31.148922494302184, 30.731662581364304, 10.547841204951197, 10.340616623560578, 10.06436503926912, 15.442464428022504, 14.855969801545143, 15.32954079285264, 27.760909770925835, 27.90615127732356, 27.915399981041745, 10.800448918094233, 10.900381711039998, 10.55334026118119, 33.32880444327989, 33.976486581067235, 33.863295088211686, 16.218916073441505, 15.602092415094376, 16.52864611055702, 21.646886522571236, 22.47876703614989, 22.421035560468823, 9.806127965450287, 10.350599836558104, 10.159412443637848, 15.241017326712608, 15.369578957557678, 15.685050882399082, 8.752727270126343, 8.600224018096924, 8.890934105962515, 13.371597796678543, 13.916070035658777, 13.58122319728136, 26.559919822961092, 26.30078037828207, 26.680356912314892, 6.470788077451289, 5.5278648138046265, 6.398708185181022, 20.415564602861792, 20.198331433037907, 20.065325419108063, 11.757262231782079, 11.825823780614883, 11.797465713694692, 16.64826050400734, 16.67156895622611, 16.825370509177446, 17.241057006021336, 17.498290769134954, 17.298524302740887, 8.596737091119081, 8.557466324108333, 8.424202310542256, 14.527486038704708, 15.010601908278957, 14.995230708581701, -2.634604026873916, -2.4295833644767697, -2.520029370983451, 15.608933549374342, 15.815568026155233, 15.098590329289436, 27.801937768856675, 28.14562718446055, 28.334788298855216, 9.275613608459622, 9.213233687604458, 8.343207905689866, 22.818219440989196, 22.778112970292568, 22.570503063499928, 6.6093611139804125, 5.743847534060478, 6.033243879675865, 16.098237340648964, 16.41353503366311, 16.700640539949134, 10.945609395702675, 11.626882066329316, 10.51972236235936, 21.83666098676622, 21.661878794431686, 21.865771364420652, 21.081879337628678, 22.616659079988793, 22.707985642676547, 28.450459898759917, 28.535177526374653, 28.089383845527962, 17.937568113207817, 17.073930859565735, 17.4909478276968, 12.717283949255943, 13.348217801190913, 13.353798896074295, 20.30646475901206, 20.244614658256367, 20.13672313590844, 25.326616760343313, 24.85297953337431, 25.26883251592517, 20.872098618497446, 20.73280505960186, 20.949921031792954, 8.46004770075281, 7.308220108350113, 8.507091299941138, 20.62878952920437, 20.148327887058258, 21.110658325254917, 20.632052506009728, 20.996219106639415, 20.707806582252175, 21.207572554548577, 21.827049532284335, 21.61676998933156, 5.742152785261467, 5.7529763927062305, 5.88171221579735, 18.61532647007455, 18.042574500044182, 18.237575379510716, 22.00435983141263, 21.502833013733223, 22.28496194009979, 22.823955381909997, 23.12806386865364, 22.72510566065708, 21.48845251401265, 22.183590361227587, 22.054106031854943, 23.45664422089854, 23.451250019172818, 23.410694180677325, 16.906080483148486, 17.155748844651185, 16.859977948168904, 26.029724687337875, 26.54698821157217, 25.629567340016365, 19.948314761122063, 19.799654332300022, 19.968563390274838, 20.268594716986016, 20.530908798178032, 20.281419848402336, 26.545624685784176, 26.59496745963891, 26.31352777530749]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153397704314926, "mean_inference_ms": 0.7050005282745998, "mean_action_processing_ms": 0.1000702397304224, "mean_env_wait_ms": 0.8076441333106985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1784484, "timesteps_this_iter": 0, "agent_timesteps_total": 5353452, "timers": {"sample_time_ms": 19931.494, "sample_throughput": 481.349, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3054.702, "learn_throughput": 3140.732, "update_time_ms": 8.952}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 5.311574399471283, "policy_loss": 0.00017743716138096666, "vf_loss": 5.498348295688629, "vf_explained_var": 0.2573463171720505, "kl": 0.007546768727792195, "entropy": 18.69511914253235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1784484, "num_agent_steps_sampled": 5353452, "num_steps_trained": 1784484, "num_agent_steps_trained": 5353452, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6763, "training_iteration": 186, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-45-54", "timestamp": 1706193954, "time_this_iter_s": 20.143303632736206, "time_total_s": 3751.485387325287, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3751.485387325287, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 9.799999999999997, "ram_util_percent": 52.86896551724139}}
{"episode_reward_max": 101.16858611255881, "episode_reward_min": -35.253553656861186, "episode_reward_mean": 54.60868482232559, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -12.041995406150818}, "policy_reward_max": {"shared_policy": 33.976486581067235}, "policy_reward_mean": {"shared_policy": 18.20289494077519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.54781442135571, 68.12354329973459, 61.35909361578523, 41.94349705800414, 46.20534181222317, 53.288738600909696, 78.0022391527891, 61.67121207248418, 64.31484759785235, 60.06340171396731, 74.21740114688872, 63.38447564095256, 44.08969528600571, 71.18863229919224, 31.2828503102064, 36.011335719376774, 93.1741356886923, 30.952822867780895, 45.62797502242029, 83.58246102929114, 32.25417089031542, 101.16858611255881, 48.3496545990929, 66.54668911918995, 30.31614024564624, 46.29564716666937, 26.24388539418578, 40.86889102961868, 79.54105711355805, 18.397361076436937, 60.67922145500776, 35.38055172609165, 50.145199969410896, 52.03787207789718, 25.57840572576967, 44.53331865556537, -7.584216762334137, 46.52309190481901, 84.28235325217244, 26.832055201753946, 68.16683547478169, 18.386452527716756, 49.21241291426121, 33.09221382439135, 65.36431114561856, 66.40652406029402, 85.07502127066253, 52.50244680047035, 39.41930064652115, 60.687802553176866, 75.44842880964279, 62.55482470989226, 24.27535910904406, 61.887775741517544, 62.33607819490132, 64.65139207616447, 17.376841393765048, 54.89547634962945, 65.79215478524564, 68.67712491122072, 65.72614890709518, 70.31858842074868, 50.921807275968575, 78.20628023892641, 59.71653248369692, 61.080923363566384, 79.45411992073058, 0.9578211251645996, 79.45282730460166, 59.094532435759874, 59.422873880946995, 67.46957410126922, 62.56165353395045, 38.23294911906123, 78.19093944877385, 62.95210764184591, -35.253553656861186, 81.003891851753, 65.22852046415208, 62.79798073321581, 98.95050136838105, 80.46857881732285, 49.21292035281658, 95.47926735691723, 26.431090198457227, 67.79807018022984, 19.77566460520029, -1.828243325464456, 39.43860259838401, 57.84569065179673, 72.70928861736319, 72.22124694287777, 52.05157841742039, 54.72574277222154, 59.72859304025769, 75.89121114090085, 67.65931554511188, 51.461630038917036, 35.033546920865774, 49.647439789958284], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.238050041099385, 24.91383597751458, 25.395928402741745, 22.702921349555254, 22.769490461796522, 22.651131488382816, 19.71533565719922, 20.809426195298627, 20.83433176328738, 13.558287724852562, 13.98499782383442, 14.40021150931716, 15.384106094638497, 15.714886150012404, 15.106349567572266, 17.11209626992543, 18.29328654458125, 17.883355786403015, 25.901217517753437, 26.05016956230004, 26.050852072735623, 20.654450111401573, 20.570418053617075, 20.446343907465533, 21.196399442851543, 21.509444564580917, 21.60900359041989, 20.13349000116189, 20.14905985196431, 19.78085186084111, 24.841740404566124, 24.32622631390889, 25.049434428413704, 21.218301004419715, 21.411984434972197, 20.754190201560647, 15.19757795954743, 14.377687181035668, 14.514430145422608, 23.52083972593148, 23.64104102303584, 24.026751550224915, 10.599539910753563, 10.287248228987053, 10.396062170465783, 11.82003843287626, 12.356969385097415, 11.8343279014031, 31.293550613025815, 31.148922494302184, 30.731662581364304, 10.547841204951197, 10.340616623560578, 10.06436503926912, 15.442464428022504, 14.855969801545143, 15.32954079285264, 27.760909770925835, 27.90615127732356, 27.915399981041745, 10.800448918094233, 10.900381711039998, 10.55334026118119, 33.32880444327989, 33.976486581067235, 33.863295088211686, 16.218916073441505, 15.602092415094376, 16.52864611055702, 21.646886522571236, 22.47876703614989, 22.421035560468823, 9.806127965450287, 10.350599836558104, 10.159412443637848, 15.241017326712608, 15.369578957557678, 15.685050882399082, 8.752727270126343, 8.600224018096924, 8.890934105962515, 13.371597796678543, 13.916070035658777, 13.58122319728136, 26.559919822961092, 26.30078037828207, 26.680356912314892, 6.470788077451289, 5.5278648138046265, 6.398708185181022, 20.415564602861792, 20.198331433037907, 20.065325419108063, 11.757262231782079, 11.825823780614883, 11.797465713694692, 16.64826050400734, 16.67156895622611, 16.825370509177446, 17.241057006021336, 17.498290769134954, 17.298524302740887, 8.596737091119081, 8.557466324108333, 8.424202310542256, 14.527486038704708, 15.010601908278957, 14.995230708581701, -2.634604026873916, -2.4295833644767697, -2.520029370983451, 15.608933549374342, 15.815568026155233, 15.098590329289436, 27.801937768856675, 28.14562718446055, 28.334788298855216, 9.275613608459622, 9.213233687604458, 8.343207905689866, 22.818219440989196, 22.778112970292568, 22.570503063499928, 6.6093611139804125, 5.743847534060478, 6.033243879675865, 16.098237340648964, 16.41353503366311, 16.700640539949134, 10.945609395702675, 11.626882066329316, 10.51972236235936, 21.83666098676622, 21.661878794431686, 21.865771364420652, 21.081879337628678, 22.616659079988793, 22.707985642676547, 28.450459898759917, 28.535177526374653, 28.089383845527962, 17.937568113207817, 17.073930859565735, 17.4909478276968, 12.717283949255943, 13.348217801190913, 13.353798896074295, 20.30646475901206, 20.244614658256367, 20.13672313590844, 25.326616760343313, 24.85297953337431, 25.26883251592517, 20.872098618497446, 20.73280505960186, 20.949921031792954, 8.46004770075281, 7.308220108350113, 8.507091299941138, 20.62878952920437, 20.148327887058258, 21.110658325254917, 20.632052506009728, 20.996219106639415, 20.707806582252175, 21.207572554548577, 21.827049532284335, 21.61676998933156, 5.742152785261467, 5.7529763927062305, 5.88171221579735, 18.61532647007455, 18.042574500044182, 18.237575379510716, 22.00435983141263, 21.502833013733223, 22.28496194009979, 22.823955381909997, 23.12806386865364, 22.72510566065708, 21.48845251401265, 22.183590361227587, 22.054106031854943, 23.45664422089854, 23.451250019172818, 23.410694180677325, 16.906080483148486, 17.155748844651185, 16.859977948168904, 26.029724687337875, 26.54698821157217, 25.629567340016365, 19.948314761122063, 19.799654332300022, 19.968563390274838, 20.268594716986016, 20.530908798178032, 20.281419848402336, 26.545624685784176, 26.59496745963891, 26.31352777530749, 0.1554325694839065, 0.2790074894825523, 0.5233810661981408, 26.73463489611943, 26.22530262668927, 26.492889781792954, 19.663312601546437, 19.499222132066876, 19.93199770214656, 19.79607321073611, 20.224483379706115, 19.40231729050477, 22.5533719609181, 22.863106342653424, 22.053095797697694, 20.582761704921722, 21.218661876395345, 20.76022995263338, 12.757767278701067, 12.7168622687459, 12.758319571614265, 25.614627247055367, 26.290496197839573, 26.285816003878907, 21.19940151895085, 20.61285040775934, 21.139855715135724, -11.77273514866829, -12.041995406150818, -11.438823102042079, 27.268272150307894, 26.80701268464327, 26.928607016801834, 21.525810485084847, 21.757775483032063, 21.944934496035174, 20.69236959517002, 21.07185549288988, 21.033755645155907, 33.11298407303789, 32.63197737435499, 33.20553992098817, 26.56609047949314, 26.65316839516163, 27.24931994266808, 15.973170965909958, 16.641508292406797, 16.598241094499826, 31.486601213614136, 32.01286819639304, 31.979797946910054, 9.098920871814087, 8.130631496508911, 9.201537830134228, 22.334398709237576, 22.7123695127666, 22.751301958225667, 6.509006924927235, 6.667031187564135, 6.599626492708921, -0.5408585624148543, -0.7864131679137643, -0.5009715951358373, 13.139177759488419, 13.059888159235314, 13.239536679660276, 19.364252587469906, 19.326480756203324, 19.1549573081235, 24.28897873902072, 24.331408104005575, 24.08890177433689, 24.144267298281193, 23.977074705064297, 24.09990493953228, 17.122881323099136, 17.57461278140545, 17.354084312915802, 18.03301095465818, 18.322790446380765, 18.36994137118259, 19.479930207133293, 20.234849575906992, 20.013813257217407, 25.447539065033197, 25.20185175538063, 25.241820320487022, 22.275650074084595, 22.695402839531496, 22.68826263149579, 17.337277601162583, 16.69678598145643, 17.427566456298024, 11.85133695974946, 11.577780157327652, 11.604429803788662, 16.894966552344457, 16.19390148421128, 16.558571753402546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15340413210787276, "mean_inference_ms": 0.7050465274031522, "mean_action_processing_ms": 0.1000892442191872, "mean_env_wait_ms": 0.8076945065828811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1794078, "timesteps_this_iter": 0, "agent_timesteps_total": 5382234, "timers": {"sample_time_ms": 19909.461, "sample_throughput": 481.881, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3056.497, "learn_throughput": 3138.887, "update_time_ms": 8.852}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 7.594972133636475, "policy_loss": -0.00043537682389982457, "vf_loss": 7.784185767173767, "vf_explained_var": 0.25046345591545105, "kl": 0.008651485288612074, "entropy": 18.877840280532837, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1794078, "num_agent_steps_sampled": 5382234, "num_steps_trained": 1794078, "num_agent_steps_trained": 5382234, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6796, "training_iteration": 187, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-46-15", "timestamp": 1706193975, "time_this_iter_s": 20.29149627685547, "time_total_s": 3771.7768836021423, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205C160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3771.7768836021423, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 10.221428571428572, "ram_util_percent": 52.93928571428571}}
{"episode_reward_max": 103.29829374328253, "episode_reward_min": -230.66375140100718, "episode_reward_mean": 52.714899142886864, "episode_len_mean": 299.87, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -77.21660003066063}, "policy_reward_max": {"shared_policy": 35.22380311662951}, "policy_reward_mean": {"shared_policy": 17.571633047628946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.38055172609165, 50.145199969410896, 52.03787207789718, 25.57840572576967, 44.53331865556537, -7.584216762334137, 46.52309190481901, 84.28235325217244, 26.832055201753946, 68.16683547478169, 18.386452527716756, 49.21241291426121, 33.09221382439135, 65.36431114561856, 66.40652406029402, 85.07502127066253, 52.50244680047035, 39.41930064652115, 60.687802553176866, 75.44842880964279, 62.55482470989226, 24.27535910904406, 61.887775741517544, 62.33607819490132, 64.65139207616447, 17.376841393765048, 54.89547634962945, 65.79215478524564, 68.67712491122072, 65.72614890709518, 70.31858842074868, 50.921807275968575, 78.20628023892641, 59.71653248369692, 61.080923363566384, 79.45411992073058, 0.9578211251645996, 79.45282730460166, 59.094532435759874, 59.422873880946995, 67.46957410126922, 62.56165353395045, 38.23294911906123, 78.19093944877385, 62.95210764184591, -35.253553656861186, 81.003891851753, 65.22852046415208, 62.79798073321581, 98.95050136838105, 80.46857881732285, 49.21292035281658, 95.47926735691723, 26.431090198457227, 67.79807018022984, 19.77566460520029, -1.828243325464456, 39.43860259838401, 57.84569065179673, 72.70928861736319, 72.22124694287777, 52.05157841742039, 54.72574277222154, 59.72859304025769, 75.89121114090085, 67.65931554511188, 51.461630038917036, 35.033546920865774, 49.647439789958284, 55.46935335645685, 64.12540009245275, 39.50903585832563, -230.66375140100718, 42.99948092550038, 42.14574873447418, 20.636744407471255, 64.56370896100998, 97.69708389230071, 36.61203519627449, 58.95466900616884, 56.9130347408354, 50.41011288017033, 73.64914042130111, 70.61355871334672, -11.960277329431861, 66.79078919813034, 81.22542779985814, 66.2172726683784, 69.19887273013589, 95.46305364463477, 63.0666657052934, 49.776482939720125, 67.31464489176867, 84.83054516091941, 77.5742182135582, 17.385405330220237, 103.29829374328253, 44.05708150938153, 53.77529723197219, 73.6651213914156], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 287, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [11.757262231782079, 11.825823780614883, 11.797465713694692, 16.64826050400734, 16.67156895622611, 16.825370509177446, 17.241057006021336, 17.498290769134954, 17.298524302740887, 8.596737091119081, 8.557466324108333, 8.424202310542256, 14.527486038704708, 15.010601908278957, 14.995230708581701, -2.634604026873916, -2.4295833644767697, -2.520029370983451, 15.608933549374342, 15.815568026155233, 15.098590329289436, 27.801937768856675, 28.14562718446055, 28.334788298855216, 9.275613608459622, 9.213233687604458, 8.343207905689866, 22.818219440989196, 22.778112970292568, 22.570503063499928, 6.6093611139804125, 5.743847534060478, 6.033243879675865, 16.098237340648964, 16.41353503366311, 16.700640539949134, 10.945609395702675, 11.626882066329316, 10.51972236235936, 21.83666098676622, 21.661878794431686, 21.865771364420652, 21.081879337628678, 22.616659079988793, 22.707985642676547, 28.450459898759917, 28.535177526374653, 28.089383845527962, 17.937568113207817, 17.073930859565735, 17.4909478276968, 12.717283949255943, 13.348217801190913, 13.353798896074295, 20.30646475901206, 20.244614658256367, 20.13672313590844, 25.326616760343313, 24.85297953337431, 25.26883251592517, 20.872098618497446, 20.73280505960186, 20.949921031792954, 8.46004770075281, 7.308220108350113, 8.507091299941138, 20.62878952920437, 20.148327887058258, 21.110658325254917, 20.632052506009728, 20.996219106639415, 20.707806582252175, 21.207572554548577, 21.827049532284335, 21.61676998933156, 5.742152785261467, 5.7529763927062305, 5.88171221579735, 18.61532647007455, 18.042574500044182, 18.237575379510716, 22.00435983141263, 21.502833013733223, 22.28496194009979, 22.823955381909997, 23.12806386865364, 22.72510566065708, 21.48845251401265, 22.183590361227587, 22.054106031854943, 23.45664422089854, 23.451250019172818, 23.410694180677325, 16.906080483148486, 17.155748844651185, 16.859977948168904, 26.029724687337875, 26.54698821157217, 25.629567340016365, 19.948314761122063, 19.799654332300022, 19.968563390274838, 20.268594716986016, 20.530908798178032, 20.281419848402336, 26.545624685784176, 26.59496745963891, 26.31352777530749, 0.1554325694839065, 0.2790074894825523, 0.5233810661981408, 26.73463489611943, 26.22530262668927, 26.492889781792954, 19.663312601546437, 19.499222132066876, 19.93199770214656, 19.79607321073611, 20.224483379706115, 19.40231729050477, 22.5533719609181, 22.863106342653424, 22.053095797697694, 20.582761704921722, 21.218661876395345, 20.76022995263338, 12.757767278701067, 12.7168622687459, 12.758319571614265, 25.614627247055367, 26.290496197839573, 26.285816003878907, 21.19940151895085, 20.61285040775934, 21.139855715135724, -11.77273514866829, -12.041995406150818, -11.438823102042079, 27.268272150307894, 26.80701268464327, 26.928607016801834, 21.525810485084847, 21.757775483032063, 21.944934496035174, 20.69236959517002, 21.07185549288988, 21.033755645155907, 33.11298407303789, 32.63197737435499, 33.20553992098817, 26.56609047949314, 26.65316839516163, 27.24931994266808, 15.973170965909958, 16.641508292406797, 16.598241094499826, 31.486601213614136, 32.01286819639304, 31.979797946910054, 9.098920871814087, 8.130631496508911, 9.201537830134228, 22.334398709237576, 22.7123695127666, 22.751301958225667, 6.509006924927235, 6.667031187564135, 6.599626492708921, -0.5408585624148543, -0.7864131679137643, -0.5009715951358373, 13.139177759488419, 13.059888159235314, 13.239536679660276, 19.364252587469906, 19.326480756203324, 19.1549573081235, 24.28897873902072, 24.331408104005575, 24.08890177433689, 24.144267298281193, 23.977074705064297, 24.09990493953228, 17.122881323099136, 17.57461278140545, 17.354084312915802, 18.03301095465818, 18.322790446380765, 18.36994137118259, 19.479930207133293, 20.234849575906992, 20.013813257217407, 25.447539065033197, 25.20185175538063, 25.241820320487022, 22.275650074084595, 22.695402839531496, 22.68826263149579, 17.337277601162583, 16.69678598145643, 17.427566456298024, 11.85133695974946, 11.577780157327652, 11.604429803788662, 16.894966552344457, 16.19390148421128, 16.558571753402546, 17.991505712270737, 18.847773977613542, 18.63007366657257, 20.51750873525937, 21.718392067899302, 21.88949928929408, 13.816738022180886, 12.662698338429124, 13.029599497715623, -76.75634503364563, -76.69080633670092, -77.21660003066063, 15.026633453865841, 13.461718161900833, 14.511129309733704, 14.140883274376392, 13.984430022537708, 14.020435437560081, 6.675659624238804, 6.914601709072784, 7.046483074159667, 21.63007476180792, 21.6343207731843, 21.29931342601776, 32.28857870151599, 32.70341429797311, 32.70509089281161, 11.937183449665696, 12.3386350745956, 12.336216672013194, 19.58462329953909, 19.65163115784526, 19.718414548784494, 18.7896192173163, 19.274198106179625, 18.849217417339474, 16.77187319596608, 16.54660116632779, 17.09163851787646, 24.857600906242922, 24.449725819130734, 24.341813695927456, 23.56325477734208, 23.325603514909744, 23.724700421094894, -3.5329459662704465, -3.835175777475044, -4.5921555856863705, 22.26886790866652, 22.27518602895239, 22.24673526051143, 27.30165458315362, 27.01500904311736, 26.90876417358716, 22.42140474348949, 21.94550863901773, 21.85035928587118, 22.680013472835213, 23.309166761736066, 23.20969249556461, 31.730317411323384, 32.217322139379874, 31.51541409393151, 20.910067622860268, 20.856520672639206, 21.30007740979393, 16.875280062357575, 16.33662528793016, 16.56457758943239, 22.40133663887778, 22.42171140636006, 22.491596846530825, 28.27511779715617, 27.837057967980698, 28.718369395782545, 25.63636053353548, 25.954247023910284, 25.983610656112432, 5.873543906956911, 6.025313282618299, 5.486548140645027, 35.22380311662951, 33.171581278244645, 34.90290934840837, 14.702343121170998, 14.855612982064486, 14.49912540614605, 17.89133088539043, 17.941136265794427, 17.94283008078733, 24.313759967684746, 24.836748033761978, 24.514613389968872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533740003627095, "mean_inference_ms": 0.7050157441769863, "mean_action_processing_ms": 0.10008875889519443, "mean_env_wait_ms": 0.8076465345048638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1803672, "timesteps_this_iter": 0, "agent_timesteps_total": 5411016, "timers": {"sample_time_ms": 19870.526, "sample_throughput": 482.826, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3074.122, "learn_throughput": 3120.891, "update_time_ms": 8.8}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 61.939361572265625, "policy_loss": 0.0002914508576939978, "vf_loss": 62.12972927093506, "vf_explained_var": 0.021467454731464386, "kl": 0.018070965423577307, "entropy": 19.065654277801514, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1803672, "num_agent_steps_sampled": 5411016, "num_steps_trained": 1803672, "num_agent_steps_trained": 5411016, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6827, "training_iteration": 188, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-46-34", "timestamp": 1706193994, "time_this_iter_s": 19.343274116516113, "time_total_s": 3791.1201577186584, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41BE9D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3791.1201577186584, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 7.582142857142856, "ram_util_percent": 53.06785714285714}}
{"episode_reward_max": 103.29829374328253, "episode_reward_min": -230.66375140100718, "episode_reward_mean": 51.78721614413312, "episode_len_mean": 299.87, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -77.21660003066063}, "policy_reward_max": {"shared_policy": 35.22380311662951}, "policy_reward_mean": {"shared_policy": 17.262405381377704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.080923363566384, 79.45411992073058, 0.9578211251645996, 79.45282730460166, 59.094532435759874, 59.422873880946995, 67.46957410126922, 62.56165353395045, 38.23294911906123, 78.19093944877385, 62.95210764184591, -35.253553656861186, 81.003891851753, 65.22852046415208, 62.79798073321581, 98.95050136838105, 80.46857881732285, 49.21292035281658, 95.47926735691723, 26.431090198457227, 67.79807018022984, 19.77566460520029, -1.828243325464456, 39.43860259838401, 57.84569065179673, 72.70928861736319, 72.22124694287777, 52.05157841742039, 54.72574277222154, 59.72859304025769, 75.89121114090085, 67.65931554511188, 51.461630038917036, 35.033546920865774, 49.647439789958284, 55.46935335645685, 64.12540009245275, 39.50903585832563, -230.66375140100718, 42.99948092550038, 42.14574873447418, 20.636744407471255, 64.56370896100998, 97.69708389230071, 36.61203519627449, 58.95466900616884, 56.9130347408354, 50.41011288017033, 73.64914042130111, 70.61355871334672, -11.960277329431861, 66.79078919813034, 81.22542779985814, 66.2172726683784, 69.19887273013589, 95.46305364463477, 63.0666657052934, 49.776482939720125, 67.31464489176867, 84.83054516091941, 77.5742182135582, 17.385405330220237, 103.29829374328253, 44.05708150938153, 53.77529723197219, 73.6651213914156, 50.84532584901899, 52.87202451750636, 95.89570230990645, 44.506818961352096, 82.21104828920213, 49.58290067687631, 20.42523828893897, 40.67191030830142, 51.00925693660973, 58.18549259565768, 75.88172578811643, 17.1584064811468, 51.63395179808137, 19.522255302930716, 26.5029503852129, 4.222350100055323, 58.762330231256755, 42.166482176631675, 47.011062040925, 70.04629112035035, 26.55751347541809, 69.90882875956594, 57.99625424295661, 56.9853870421648, 66.58590025361624, 44.50570812076327, 68.8345802873373, 52.248504314571605, 49.620451044291244, 48.34334674477577, 69.88728409633039, 33.88183188438413, 55.28360061906277, 26.305751457810402], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 287, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.268594716986016, 20.530908798178032, 20.281419848402336, 26.545624685784176, 26.59496745963891, 26.31352777530749, 0.1554325694839065, 0.2790074894825523, 0.5233810661981408, 26.73463489611943, 26.22530262668927, 26.492889781792954, 19.663312601546437, 19.499222132066876, 19.93199770214656, 19.79607321073611, 20.224483379706115, 19.40231729050477, 22.5533719609181, 22.863106342653424, 22.053095797697694, 20.582761704921722, 21.218661876395345, 20.76022995263338, 12.757767278701067, 12.7168622687459, 12.758319571614265, 25.614627247055367, 26.290496197839573, 26.285816003878907, 21.19940151895085, 20.61285040775934, 21.139855715135724, -11.77273514866829, -12.041995406150818, -11.438823102042079, 27.268272150307894, 26.80701268464327, 26.928607016801834, 21.525810485084847, 21.757775483032063, 21.944934496035174, 20.69236959517002, 21.07185549288988, 21.033755645155907, 33.11298407303789, 32.63197737435499, 33.20553992098817, 26.56609047949314, 26.65316839516163, 27.24931994266808, 15.973170965909958, 16.641508292406797, 16.598241094499826, 31.486601213614136, 32.01286819639304, 31.979797946910054, 9.098920871814087, 8.130631496508911, 9.201537830134228, 22.334398709237576, 22.7123695127666, 22.751301958225667, 6.509006924927235, 6.667031187564135, 6.599626492708921, -0.5408585624148543, -0.7864131679137643, -0.5009715951358373, 13.139177759488419, 13.059888159235314, 13.239536679660276, 19.364252587469906, 19.326480756203324, 19.1549573081235, 24.28897873902072, 24.331408104005575, 24.08890177433689, 24.144267298281193, 23.977074705064297, 24.09990493953228, 17.122881323099136, 17.57461278140545, 17.354084312915802, 18.03301095465818, 18.322790446380765, 18.36994137118259, 19.479930207133293, 20.234849575906992, 20.013813257217407, 25.447539065033197, 25.20185175538063, 25.241820320487022, 22.275650074084595, 22.695402839531496, 22.68826263149579, 17.337277601162583, 16.69678598145643, 17.427566456298024, 11.85133695974946, 11.577780157327652, 11.604429803788662, 16.894966552344457, 16.19390148421128, 16.558571753402546, 17.991505712270737, 18.847773977613542, 18.63007366657257, 20.51750873525937, 21.718392067899302, 21.88949928929408, 13.816738022180886, 12.662698338429124, 13.029599497715623, -76.75634503364563, -76.69080633670092, -77.21660003066063, 15.026633453865841, 13.461718161900833, 14.511129309733704, 14.140883274376392, 13.984430022537708, 14.020435437560081, 6.675659624238804, 6.914601709072784, 7.046483074159667, 21.63007476180792, 21.6343207731843, 21.29931342601776, 32.28857870151599, 32.70341429797311, 32.70509089281161, 11.937183449665696, 12.3386350745956, 12.336216672013194, 19.58462329953909, 19.65163115784526, 19.718414548784494, 18.7896192173163, 19.274198106179625, 18.849217417339474, 16.77187319596608, 16.54660116632779, 17.09163851787646, 24.857600906242922, 24.449725819130734, 24.341813695927456, 23.56325477734208, 23.325603514909744, 23.724700421094894, -3.5329459662704465, -3.835175777475044, -4.5921555856863705, 22.26886790866652, 22.27518602895239, 22.24673526051143, 27.30165458315362, 27.01500904311736, 26.90876417358716, 22.42140474348949, 21.94550863901773, 21.85035928587118, 22.680013472835213, 23.309166761736066, 23.20969249556461, 31.730317411323384, 32.217322139379874, 31.51541409393151, 20.910067622860268, 20.856520672639206, 21.30007740979393, 16.875280062357575, 16.33662528793016, 16.56457758943239, 22.40133663887778, 22.42171140636006, 22.491596846530825, 28.27511779715617, 27.837057967980698, 28.718369395782545, 25.63636053353548, 25.954247023910284, 25.983610656112432, 5.873543906956911, 6.025313282618299, 5.486548140645027, 35.22380311662951, 33.171581278244645, 34.90290934840837, 14.702343121170998, 14.855612982064486, 14.49912540614605, 17.89133088539043, 17.941136265794427, 17.94283008078733, 24.313759967684746, 24.836748033761978, 24.514613389968872, 16.815283343195915, 17.478326878510416, 16.55171562731266, 17.67687824368477, 17.911595206707716, 17.283551067113876, 31.607731888691575, 32.58122784147659, 31.70674257973829, 15.011095122744635, 14.697902609904602, 14.797821228702858, 27.204843203226716, 27.550885134997458, 27.45531995097795, 16.59214336797595, 16.554388538002968, 16.43636877089739, 6.532644311587006, 6.95875836412111, 6.933835613230855, 13.579330655435712, 13.42101405064264, 13.671565602223069, 17.218447142591074, 17.261114307989672, 16.529695486028984, 19.092626596490533, 19.51327223951617, 19.579593759650976, 25.32161161179343, 25.337219069401414, 25.222895106921584, 6.300327365597084, 5.402380039294556, 5.455699076255158, 17.229001889626176, 17.260553310314805, 17.14439659814039, 6.419499658048153, 6.529186602681875, 6.573569042200688, 8.960762336850166, 9.047208070755005, 8.494979977607727, 1.3802722742160114, 1.4688519195963892, 1.3732259062429222, 19.246035690108926, 19.872415505039186, 19.643879036108643, 14.624749497820929, 13.831238766511277, 13.71049391229947, 15.695802154640347, 15.784952151278645, 15.530307735006005, 23.527886119981602, 23.29911734660466, 23.219287653764084, 8.77568170428276, 9.085208401083946, 8.696623370051384, 22.963239406545952, 23.61516145554681, 23.33042789747317, 19.210531095663697, 19.372554811338574, 19.41316833595434, 18.75373636186123, 19.166988849639893, 19.06466183066368, 21.98849720756212, 22.364901791947574, 22.232501254106552, 14.270194823543221, 15.061202252904565, 15.174311044315488, 22.388656422495842, 23.21683720126748, 23.22908666357398, 17.041694243748978, 17.53491150339444, 17.671898567428187, 16.59431718041499, 16.17088485260804, 16.855249011268214, 15.296273440122604, 16.602906681597233, 16.444166623055935, 22.856822212537125, 23.3717326944073, 23.658729189385966, 11.587230416635663, 11.27439126620689, 11.020210201541573, 18.40417854984601, 18.793479497854904, 18.085942571361855, 8.748425751924515, 8.802772019058466, 8.754553686827421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532894818183405, "mean_inference_ms": 0.7047639994963066, "mean_action_processing_ms": 0.1000442969514585, "mean_env_wait_ms": 0.8075203986209002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1813266, "timesteps_this_iter": 0, "agent_timesteps_total": 5439798, "timers": {"sample_time_ms": 19824.561, "sample_throughput": 483.945, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3086.199, "learn_throughput": 3108.678, "update_time_ms": 8.856}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 6.277482569217682, "policy_loss": -0.0004978521789440471, "vf_loss": 6.467310726642609, "vf_explained_var": 0.15702470391988754, "kl": 0.005004707833328629, "entropy": 18.932996034622192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1813266, "num_agent_steps_sampled": 5439798, "num_steps_trained": 1813266, "num_agent_steps_trained": 5439798, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6861, "training_iteration": 189, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-46-54", "timestamp": 1706194014, "time_this_iter_s": 19.578954458236694, "time_total_s": 3810.699112176895, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01790A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3810.699112176895, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 9.755555555555555, "ram_util_percent": 53.9962962962963}}
{"episode_reward_max": 103.29829374328253, "episode_reward_min": -230.66375140100718, "episode_reward_mean": 54.26752429246553, "episode_len_mean": 299.87, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -77.21660003066063}, "policy_reward_max": {"shared_policy": 35.22380311662951}, "policy_reward_mean": {"shared_policy": 18.08917476415517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.72859304025769, 75.89121114090085, 67.65931554511188, 51.461630038917036, 35.033546920865774, 49.647439789958284, 55.46935335645685, 64.12540009245275, 39.50903585832563, -230.66375140100718, 42.99948092550038, 42.14574873447418, 20.636744407471255, 64.56370896100998, 97.69708389230071, 36.61203519627449, 58.95466900616884, 56.9130347408354, 50.41011288017033, 73.64914042130111, 70.61355871334672, -11.960277329431861, 66.79078919813034, 81.22542779985814, 66.2172726683784, 69.19887273013589, 95.46305364463477, 63.0666657052934, 49.776482939720125, 67.31464489176867, 84.83054516091941, 77.5742182135582, 17.385405330220237, 103.29829374328253, 44.05708150938153, 53.77529723197219, 73.6651213914156, 50.84532584901899, 52.87202451750636, 95.89570230990645, 44.506818961352096, 82.21104828920213, 49.58290067687631, 20.42523828893897, 40.67191030830142, 51.00925693660973, 58.18549259565768, 75.88172578811643, 17.1584064811468, 51.63395179808137, 19.522255302930716, 26.5029503852129, 4.222350100055323, 58.762330231256755, 42.166482176631675, 47.011062040925, 70.04629112035035, 26.55751347541809, 69.90882875956594, 57.99625424295661, 56.9853870421648, 66.58590025361624, 44.50570812076327, 68.8345802873373, 52.248504314571605, 49.620451044291244, 48.34334674477577, 69.88728409633039, 33.88183188438413, 55.28360061906277, 26.305751457810402, 80.43260502815247, 58.812128588557215, 63.16069722175597, 48.451964512467384, 55.93193480744958, 55.36995158181523, 51.93883468047714, 46.15732081234454, 85.44192917924374, 87.68051957711577, 71.25855091144331, 77.02068084478377, 57.73992091044782, 53.88903755694626, 68.99150099605319, 72.32559154927729, 69.0256922841072, 59.40302004292607, 46.730523847043514, 82.49633255507794, 46.03200638480483, 62.7121611535549, 71.72745746560393, 76.78256066888568, 73.23591741919518, 67.55074406322089, 30.863088350743055, 64.77405996620652, 70.02124269539489], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 287, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.479930207133293, 20.234849575906992, 20.013813257217407, 25.447539065033197, 25.20185175538063, 25.241820320487022, 22.275650074084595, 22.695402839531496, 22.68826263149579, 17.337277601162583, 16.69678598145643, 17.427566456298024, 11.85133695974946, 11.577780157327652, 11.604429803788662, 16.894966552344457, 16.19390148421128, 16.558571753402546, 17.991505712270737, 18.847773977613542, 18.63007366657257, 20.51750873525937, 21.718392067899302, 21.88949928929408, 13.816738022180886, 12.662698338429124, 13.029599497715623, -76.75634503364563, -76.69080633670092, -77.21660003066063, 15.026633453865841, 13.461718161900833, 14.511129309733704, 14.140883274376392, 13.984430022537708, 14.020435437560081, 6.675659624238804, 6.914601709072784, 7.046483074159667, 21.63007476180792, 21.6343207731843, 21.29931342601776, 32.28857870151599, 32.70341429797311, 32.70509089281161, 11.937183449665696, 12.3386350745956, 12.336216672013194, 19.58462329953909, 19.65163115784526, 19.718414548784494, 18.7896192173163, 19.274198106179625, 18.849217417339474, 16.77187319596608, 16.54660116632779, 17.09163851787646, 24.857600906242922, 24.449725819130734, 24.341813695927456, 23.56325477734208, 23.325603514909744, 23.724700421094894, -3.5329459662704465, -3.835175777475044, -4.5921555856863705, 22.26886790866652, 22.27518602895239, 22.24673526051143, 27.30165458315362, 27.01500904311736, 26.90876417358716, 22.42140474348949, 21.94550863901773, 21.85035928587118, 22.680013472835213, 23.309166761736066, 23.20969249556461, 31.730317411323384, 32.217322139379874, 31.51541409393151, 20.910067622860268, 20.856520672639206, 21.30007740979393, 16.875280062357575, 16.33662528793016, 16.56457758943239, 22.40133663887778, 22.42171140636006, 22.491596846530825, 28.27511779715617, 27.837057967980698, 28.718369395782545, 25.63636053353548, 25.954247023910284, 25.983610656112432, 5.873543906956911, 6.025313282618299, 5.486548140645027, 35.22380311662951, 33.171581278244645, 34.90290934840837, 14.702343121170998, 14.855612982064486, 14.49912540614605, 17.89133088539043, 17.941136265794427, 17.94283008078733, 24.313759967684746, 24.836748033761978, 24.514613389968872, 16.815283343195915, 17.478326878510416, 16.55171562731266, 17.67687824368477, 17.911595206707716, 17.283551067113876, 31.607731888691575, 32.58122784147659, 31.70674257973829, 15.011095122744635, 14.697902609904602, 14.797821228702858, 27.204843203226716, 27.550885134997458, 27.45531995097795, 16.59214336797595, 16.554388538002968, 16.43636877089739, 6.532644311587006, 6.95875836412111, 6.933835613230855, 13.579330655435712, 13.42101405064264, 13.671565602223069, 17.218447142591074, 17.261114307989672, 16.529695486028984, 19.092626596490533, 19.51327223951617, 19.579593759650976, 25.32161161179343, 25.337219069401414, 25.222895106921584, 6.300327365597084, 5.402380039294556, 5.455699076255158, 17.229001889626176, 17.260553310314805, 17.14439659814039, 6.419499658048153, 6.529186602681875, 6.573569042200688, 8.960762336850166, 9.047208070755005, 8.494979977607727, 1.3802722742160114, 1.4688519195963892, 1.3732259062429222, 19.246035690108926, 19.872415505039186, 19.643879036108643, 14.624749497820929, 13.831238766511277, 13.71049391229947, 15.695802154640347, 15.784952151278645, 15.530307735006005, 23.527886119981602, 23.29911734660466, 23.219287653764084, 8.77568170428276, 9.085208401083946, 8.696623370051384, 22.963239406545952, 23.61516145554681, 23.33042789747317, 19.210531095663697, 19.372554811338574, 19.41316833595434, 18.75373636186123, 19.166988849639893, 19.06466183066368, 21.98849720756212, 22.364901791947574, 22.232501254106552, 14.270194823543221, 15.061202252904565, 15.174311044315488, 22.388656422495842, 23.21683720126748, 23.22908666357398, 17.041694243748978, 17.53491150339444, 17.671898567428187, 16.59431718041499, 16.17088485260804, 16.855249011268214, 15.296273440122604, 16.602906681597233, 16.444166623055935, 22.856822212537125, 23.3717326944073, 23.658729189385966, 11.587230416635663, 11.27439126620689, 11.020210201541573, 18.40417854984601, 18.793479497854904, 18.085942571361855, 8.748425751924515, 8.802772019058466, 8.754553686827421, 27.11013524234295, 26.510696098208427, 26.81177368760109, 19.776970143119485, 19.483700724939496, 19.551457720498234, 20.54346015055974, 21.01117705305417, 21.60606001814206, 16.08870393037796, 16.130229871720076, 16.23303071036935, 18.577340207993984, 18.54101922363043, 18.813575375825167, 18.360938193897397, 18.579810553152726, 18.429202834765107, 17.33385331424263, 17.312413759840027, 17.292567606394485, 15.138839979966477, 15.558775824805096, 15.459705007572964, 28.51896594837308, 28.345320388674736, 28.577642842195928, 29.258657842874527, 29.43579552695155, 28.986066207289696, 23.69041409343481, 23.579337000846863, 23.988799817161635, 25.76732662071784, 25.738044684131935, 25.515309539933995, 18.971298826237515, 19.485820965220526, 19.28280111898978, 18.289721471567944, 17.702059273918465, 17.897256811459854, 22.99352242300907, 23.092095150301844, 22.905883422742278, 24.202172083159283, 24.105615613361195, 24.017803852756813, 23.29392875110109, 23.19349682455261, 22.53826670845349, 19.837515898048878, 19.9293715916574, 19.636132553219795, 15.881146848201752, 15.315764233469963, 15.5336127653718, 27.04465268055597, 27.917110131743044, 27.534569742778928, 15.092732598384217, 15.52890215006967, 15.410371636350945, 21.19530102362235, 20.784495157500103, 20.73236497243245, 23.6556085695823, 24.079391531025365, 23.99245736499627, 25.56312784055868, 25.766364666322858, 25.453068162004143, 24.28852668404579, 24.605263475328684, 24.3421272598207, 22.336824948588998, 22.757454791727156, 22.456464322904736, 10.429904013872147, 10.469335075467825, 9.963849261403084, 21.529545019070298, 21.738051528731972, 21.506463418404252, 23.517987795018897, 23.196410228808716, 23.306844671567276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15328687768165478, "mean_inference_ms": 0.7048207100993826, "mean_action_processing_ms": 0.10005063946251472, "mean_env_wait_ms": 0.8074961364717658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1822860, "timesteps_this_iter": 0, "agent_timesteps_total": 5468580, "timers": {"sample_time_ms": 19845.733, "sample_throughput": 483.429, "load_time_ms": 0.2, "load_throughput": 47962041.211, "learn_time_ms": 3111.125, "learn_throughput": 3083.772, "update_time_ms": 8.75}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.334269685315478e-13, "cur_lr": 0.0005, "total_loss": 6.268085420131683, "policy_loss": -3.887563290605467e-05, "vf_loss": 6.4587690234184265, "vf_explained_var": 0.16299941390752792, "kl": 0.00422407392795017, "entropy": 19.064488172531128, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1822860, "num_agent_steps_sampled": 5468580, "num_steps_trained": 1822860, "num_agent_steps_trained": 5468580, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6890, "training_iteration": 190, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-47-14", "timestamp": 1706194034, "time_this_iter_s": 20.160412073135376, "time_total_s": 3830.8595242500305, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205CCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3830.8595242500305, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 10.279310344827586, "ram_util_percent": 54.62758620689655}}
{"episode_reward_max": 99.30341706424952, "episode_reward_min": -318.2689967080951, "episode_reward_mean": 53.3878172815562, "episode_len_mean": 299.35, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -117.81603459517162}, "policy_reward_max": {"shared_policy": 33.462588243186474}, "policy_reward_mean": {"shared_policy": 17.79593909385206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.77529723197219, 73.6651213914156, 50.84532584901899, 52.87202451750636, 95.89570230990645, 44.506818961352096, 82.21104828920213, 49.58290067687631, 20.42523828893897, 40.67191030830142, 51.00925693660973, 58.18549259565768, 75.88172578811643, 17.1584064811468, 51.63395179808137, 19.522255302930716, 26.5029503852129, 4.222350100055323, 58.762330231256755, 42.166482176631675, 47.011062040925, 70.04629112035035, 26.55751347541809, 69.90882875956594, 57.99625424295661, 56.9853870421648, 66.58590025361624, 44.50570812076327, 68.8345802873373, 52.248504314571605, 49.620451044291244, 48.34334674477577, 69.88728409633039, 33.88183188438413, 55.28360061906277, 26.305751457810402, 80.43260502815247, 58.812128588557215, 63.16069722175597, 48.451964512467384, 55.93193480744958, 55.36995158181523, 51.93883468047714, 46.15732081234454, 85.44192917924374, 87.68051957711577, 71.25855091144331, 77.02068084478377, 57.73992091044782, 53.88903755694626, 68.99150099605319, 72.32559154927729, 69.0256922841072, 59.40302004292607, 46.730523847043514, 82.49633255507794, 46.03200638480483, 62.7121611535549, 71.72745746560393, 76.78256066888568, 73.23591741919518, 67.55074406322089, 30.863088350743055, 64.77405996620652, 70.02124269539489, -318.2689967080951, 43.0982106234878, 70.31685701059175, 81.75776152126488, 36.08518584817645, 66.91464718058702, 85.40681765286715, 73.81709231622517, 32.193178750574575, 60.83351241052149, 67.95067742094398, 38.531439147889586, 58.43550983443856, 43.57669704779981, 59.68671742640436, 74.21258354373275, 99.30341706424952, 71.12495251372457, 62.95189666282384, 31.602160140871973, 76.80724038556217, 43.61480627581476, 56.14649697765705, 13.657025668770075, 53.15092931687829, 76.32222802378237, -4.6120744519867, 51.32665305794214, 23.521034084260435, 85.29690494202077, 73.78497403860092, 77.02868740074335, 63.432065866887555, 88.91890888940543, 51.39866949059069], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 235, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.89133088539043, 17.941136265794427, 17.94283008078733, 24.313759967684746, 24.836748033761978, 24.514613389968872, 16.815283343195915, 17.478326878510416, 16.55171562731266, 17.67687824368477, 17.911595206707716, 17.283551067113876, 31.607731888691575, 32.58122784147659, 31.70674257973829, 15.011095122744635, 14.697902609904602, 14.797821228702858, 27.204843203226716, 27.550885134997458, 27.45531995097795, 16.59214336797595, 16.554388538002968, 16.43636877089739, 6.532644311587006, 6.95875836412111, 6.933835613230855, 13.579330655435712, 13.42101405064264, 13.671565602223069, 17.218447142591074, 17.261114307989672, 16.529695486028984, 19.092626596490533, 19.51327223951617, 19.579593759650976, 25.32161161179343, 25.337219069401414, 25.222895106921584, 6.300327365597084, 5.402380039294556, 5.455699076255158, 17.229001889626176, 17.260553310314805, 17.14439659814039, 6.419499658048153, 6.529186602681875, 6.573569042200688, 8.960762336850166, 9.047208070755005, 8.494979977607727, 1.3802722742160114, 1.4688519195963892, 1.3732259062429222, 19.246035690108926, 19.872415505039186, 19.643879036108643, 14.624749497820929, 13.831238766511277, 13.71049391229947, 15.695802154640347, 15.784952151278645, 15.530307735006005, 23.527886119981602, 23.29911734660466, 23.219287653764084, 8.77568170428276, 9.085208401083946, 8.696623370051384, 22.963239406545952, 23.61516145554681, 23.33042789747317, 19.210531095663697, 19.372554811338574, 19.41316833595434, 18.75373636186123, 19.166988849639893, 19.06466183066368, 21.98849720756212, 22.364901791947574, 22.232501254106552, 14.270194823543221, 15.061202252904565, 15.174311044315488, 22.388656422495842, 23.21683720126748, 23.22908666357398, 17.041694243748978, 17.53491150339444, 17.671898567428187, 16.59431718041499, 16.17088485260804, 16.855249011268214, 15.296273440122604, 16.602906681597233, 16.444166623055935, 22.856822212537125, 23.3717326944073, 23.658729189385966, 11.587230416635663, 11.27439126620689, 11.020210201541573, 18.40417854984601, 18.793479497854904, 18.085942571361855, 8.748425751924515, 8.802772019058466, 8.754553686827421, 27.11013524234295, 26.510696098208427, 26.81177368760109, 19.776970143119485, 19.483700724939496, 19.551457720498234, 20.54346015055974, 21.01117705305417, 21.60606001814206, 16.08870393037796, 16.130229871720076, 16.23303071036935, 18.577340207993984, 18.54101922363043, 18.813575375825167, 18.360938193897397, 18.579810553152726, 18.429202834765107, 17.33385331424263, 17.312413759840027, 17.292567606394485, 15.138839979966477, 15.558775824805096, 15.459705007572964, 28.51896594837308, 28.345320388674736, 28.577642842195928, 29.258657842874527, 29.43579552695155, 28.986066207289696, 23.69041409343481, 23.579337000846863, 23.988799817161635, 25.76732662071784, 25.738044684131935, 25.515309539933995, 18.971298826237515, 19.485820965220526, 19.28280111898978, 18.289721471567944, 17.702059273918465, 17.897256811459854, 22.99352242300907, 23.092095150301844, 22.905883422742278, 24.202172083159283, 24.105615613361195, 24.017803852756813, 23.29392875110109, 23.19349682455261, 22.53826670845349, 19.837515898048878, 19.9293715916574, 19.636132553219795, 15.881146848201752, 15.315764233469963, 15.5336127653718, 27.04465268055597, 27.917110131743044, 27.534569742778928, 15.092732598384217, 15.52890215006967, 15.410371636350945, 21.19530102362235, 20.784495157500103, 20.73236497243245, 23.6556085695823, 24.079391531025365, 23.99245736499627, 25.56312784055868, 25.766364666322858, 25.453068162004143, 24.28852668404579, 24.605263475328684, 24.3421272598207, 22.336824948588998, 22.757454791727156, 22.456464322904736, 10.429904013872147, 10.469335075467825, 9.963849261403084, 21.529545019070298, 21.738051528731972, 21.506463418404252, 23.517987795018897, 23.196410228808716, 23.306844671567276, -100.43398443857829, -100.01897767434518, -117.81603459517162, 14.52397398526469, 14.03157019863525, 14.542666439587862, 23.246758031348378, 23.612888793616236, 23.457210185627133, 26.878032247225434, 27.242582524816186, 27.637146749223263, 11.727647791306168, 12.100913553188235, 12.256624503682048, 22.296475710968167, 22.231662588814885, 22.386508880803973, 28.778644653658063, 27.55434889594713, 29.073824103261956, 24.636850060895085, 24.65291205048561, 24.527330204844475, 10.781518888970211, 10.63913421457012, 10.772525647034243, 19.941797522207096, 20.435035941501454, 20.456678946812943, 22.469109177589417, 22.52522836625576, 22.9563398770988, 12.979647601644189, 12.450298155347497, 13.1014933908979, 19.370237916707993, 19.799258310347795, 19.266013607382774, 14.457724464436367, 14.534194224824503, 14.58477835853894, 19.45180432498455, 20.204476999118924, 20.030436102300882, 24.674620692928627, 24.324344759186104, 25.213618091618017, 33.462588243186474, 32.50708290934563, 33.333745911717415, 23.564117707312107, 23.748833134770393, 23.812001671642065, 20.862024200459317, 21.03094313976665, 21.058929322597876, 10.547226975361497, 10.568608651558549, 10.486324513951928, 25.483507355054215, 25.701513839264706, 25.622219191243246, 14.542079774041966, 14.725993910183504, 14.346732591589287, 18.750054630140454, 18.983157126853854, 18.413285220662743, 4.361416459083557, 4.190885037183762, 5.104724172502756, 17.772223549584538, 17.73772523800531, 17.64098052928844, 25.614465893013403, 25.096345245838165, 25.611416884930804, -1.5915814451873302, -1.343080630991608, -1.6774123758077621, 16.8106994430224, 17.576981549073622, 16.938972065846116, 7.418504531184823, 8.224400045971066, 7.878129507104546, 28.694893054664135, 27.628102719783783, 28.973909167572856, 24.354213193058968, 24.5434138327837, 24.887347012758255, 25.597405073543385, 25.488813457389668, 25.9424688698103, 20.765020494659737, 21.67942753185828, 20.987617840369538, 29.657886520028114, 30.06647553574294, 29.194546833634377, 17.363648395985365, 17.452778397127986, 16.58224269747734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532598977581255, "mean_inference_ms": 0.7047230879583839, "mean_action_processing_ms": 0.10003530742608319, "mean_env_wait_ms": 0.8073859134564428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1832454, "timesteps_this_iter": 0, "agent_timesteps_total": 5497362, "timers": {"sample_time_ms": 19874.932, "sample_throughput": 482.719, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3128.903, "learn_throughput": 3066.251, "update_time_ms": 8.75}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.667134842657739e-13, "cur_lr": 0.0005, "total_loss": 57.88859796524048, "policy_loss": -0.0006238326601605282, "vf_loss": 58.07802772521973, "vf_explained_var": 0.16789548844099045, "kl": 0.005089939135688742, "entropy": 18.880838871002197, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1832454, "num_agent_steps_sampled": 5497362, "num_steps_trained": 1832454, "num_agent_steps_trained": 5497362, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6925, "training_iteration": 191, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-47-34", "timestamp": 1706194054, "time_this_iter_s": 20.70639133453369, "time_total_s": 3851.565915584564, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03C494C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3851.565915584564, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 9.468965517241378, "ram_util_percent": 54.86206896551724}}
{"episode_reward_max": 99.30341706424952, "episode_reward_min": -318.2689967080951, "episode_reward_mean": 56.83185783523484, "episode_len_mean": 299.35, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -117.81603459517162}, "policy_reward_max": {"shared_policy": 33.462588243186474}, "policy_reward_mean": {"shared_policy": 18.94395261174494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.248504314571605, 49.620451044291244, 48.34334674477577, 69.88728409633039, 33.88183188438413, 55.28360061906277, 26.305751457810402, 80.43260502815247, 58.812128588557215, 63.16069722175597, 48.451964512467384, 55.93193480744958, 55.36995158181523, 51.93883468047714, 46.15732081234454, 85.44192917924374, 87.68051957711577, 71.25855091144331, 77.02068084478377, 57.73992091044782, 53.88903755694626, 68.99150099605319, 72.32559154927729, 69.0256922841072, 59.40302004292607, 46.730523847043514, 82.49633255507794, 46.03200638480483, 62.7121611535549, 71.72745746560393, 76.78256066888568, 73.23591741919518, 67.55074406322089, 30.863088350743055, 64.77405996620652, 70.02124269539489, -318.2689967080951, 43.0982106234878, 70.31685701059175, 81.75776152126488, 36.08518584817645, 66.91464718058702, 85.40681765286715, 73.81709231622517, 32.193178750574575, 60.83351241052149, 67.95067742094398, 38.531439147889586, 58.43550983443856, 43.57669704779981, 59.68671742640436, 74.21258354373275, 99.30341706424952, 71.12495251372457, 62.95189666282384, 31.602160140871973, 76.80724038556217, 43.61480627581476, 56.14649697765705, 13.657025668770075, 53.15092931687829, 76.32222802378237, -4.6120744519867, 51.32665305794214, 23.521034084260435, 85.29690494202077, 73.78497403860092, 77.02868740074335, 63.432065866887555, 88.91890888940543, 51.39866949059069, 77.71093255653976, 53.80854728817938, 96.43179406784475, 55.65493195317683, 68.46764250099656, 35.29150650941301, 53.477253330871434, 87.17228825390337, 65.04704204900189, 58.554194616153836, 62.297971760854125, 66.65820136852562, 93.41239042580126, 81.88802674412725, 95.46601435542107, 63.230711810290785, 64.04563311953098, 31.796667741611586, 68.57276103645563, 54.070477690547705, 40.98663600534198, 63.12401557911652, 53.26461524516343, 60.560145370662184, 52.43565976014358, 83.19342167675495, 62.6750200949609, 24.1613584011793, 48.87630901858209], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 235, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.041694243748978, 17.53491150339444, 17.671898567428187, 16.59431718041499, 16.17088485260804, 16.855249011268214, 15.296273440122604, 16.602906681597233, 16.444166623055935, 22.856822212537125, 23.3717326944073, 23.658729189385966, 11.587230416635663, 11.27439126620689, 11.020210201541573, 18.40417854984601, 18.793479497854904, 18.085942571361855, 8.748425751924515, 8.802772019058466, 8.754553686827421, 27.11013524234295, 26.510696098208427, 26.81177368760109, 19.776970143119485, 19.483700724939496, 19.551457720498234, 20.54346015055974, 21.01117705305417, 21.60606001814206, 16.08870393037796, 16.130229871720076, 16.23303071036935, 18.577340207993984, 18.54101922363043, 18.813575375825167, 18.360938193897397, 18.579810553152726, 18.429202834765107, 17.33385331424263, 17.312413759840027, 17.292567606394485, 15.138839979966477, 15.558775824805096, 15.459705007572964, 28.51896594837308, 28.345320388674736, 28.577642842195928, 29.258657842874527, 29.43579552695155, 28.986066207289696, 23.69041409343481, 23.579337000846863, 23.988799817161635, 25.76732662071784, 25.738044684131935, 25.515309539933995, 18.971298826237515, 19.485820965220526, 19.28280111898978, 18.289721471567944, 17.702059273918465, 17.897256811459854, 22.99352242300907, 23.092095150301844, 22.905883422742278, 24.202172083159283, 24.105615613361195, 24.017803852756813, 23.29392875110109, 23.19349682455261, 22.53826670845349, 19.837515898048878, 19.9293715916574, 19.636132553219795, 15.881146848201752, 15.315764233469963, 15.5336127653718, 27.04465268055597, 27.917110131743044, 27.534569742778928, 15.092732598384217, 15.52890215006967, 15.410371636350945, 21.19530102362235, 20.784495157500103, 20.73236497243245, 23.6556085695823, 24.079391531025365, 23.99245736499627, 25.56312784055868, 25.766364666322858, 25.453068162004143, 24.28852668404579, 24.605263475328684, 24.3421272598207, 22.336824948588998, 22.757454791727156, 22.456464322904736, 10.429904013872147, 10.469335075467825, 9.963849261403084, 21.529545019070298, 21.738051528731972, 21.506463418404252, 23.517987795018897, 23.196410228808716, 23.306844671567276, -100.43398443857829, -100.01897767434518, -117.81603459517162, 14.52397398526469, 14.03157019863525, 14.542666439587862, 23.246758031348378, 23.612888793616236, 23.457210185627133, 26.878032247225434, 27.242582524816186, 27.637146749223263, 11.727647791306168, 12.100913553188235, 12.256624503682048, 22.296475710968167, 22.231662588814885, 22.386508880803973, 28.778644653658063, 27.55434889594713, 29.073824103261956, 24.636850060895085, 24.65291205048561, 24.527330204844475, 10.781518888970211, 10.63913421457012, 10.772525647034243, 19.941797522207096, 20.435035941501454, 20.456678946812943, 22.469109177589417, 22.52522836625576, 22.9563398770988, 12.979647601644189, 12.450298155347497, 13.1014933908979, 19.370237916707993, 19.799258310347795, 19.266013607382774, 14.457724464436367, 14.534194224824503, 14.58477835853894, 19.45180432498455, 20.204476999118924, 20.030436102300882, 24.674620692928627, 24.324344759186104, 25.213618091618017, 33.462588243186474, 32.50708290934563, 33.333745911717415, 23.564117707312107, 23.748833134770393, 23.812001671642065, 20.862024200459317, 21.03094313976665, 21.058929322597876, 10.547226975361497, 10.568608651558549, 10.486324513951928, 25.483507355054215, 25.701513839264706, 25.622219191243246, 14.542079774041966, 14.725993910183504, 14.346732591589287, 18.750054630140454, 18.983157126853854, 18.413285220662743, 4.361416459083557, 4.190885037183762, 5.104724172502756, 17.772223549584538, 17.73772523800531, 17.64098052928844, 25.614465893013403, 25.096345245838165, 25.611416884930804, -1.5915814451873302, -1.343080630991608, -1.6774123758077621, 16.8106994430224, 17.576981549073622, 16.938972065846116, 7.418504531184823, 8.224400045971066, 7.878129507104546, 28.694893054664135, 27.628102719783783, 28.973909167572856, 24.354213193058968, 24.5434138327837, 24.887347012758255, 25.597405073543385, 25.488813457389668, 25.9424688698103, 20.765020494659737, 21.67942753185828, 20.987617840369538, 29.657886520028114, 30.06647553574294, 29.194546833634377, 17.363648395985365, 17.452778397127986, 16.58224269747734, 25.610332553585366, 25.713134100039795, 26.3874659029146, 18.502328430612877, 17.550096844633416, 17.75612201293309, 32.14789916574955, 32.14176234602928, 32.14213255606592, 17.949768925706536, 18.996976629520447, 18.708186397949845, 22.749100173513085, 23.25115955869356, 22.467382768789918, 12.66263356350828, 11.786165401339531, 10.8427075445652, 17.28015116850534, 18.1812601579974, 18.015842004368693, 28.753379320104912, 29.145038088162735, 29.273870845635727, 21.291461837788418, 21.87386118046318, 21.88171903075029, 20.166666181758046, 19.248985648155212, 19.138542786240578, 20.697705410420895, 20.906030936166644, 20.694235414266586, 22.251519490033388, 22.097449958324432, 22.309231920167804, 31.05671004702647, 31.00334209700425, 31.352338281770542, 27.082145462433488, 27.3568712050716, 27.44901007662216, 31.90800190716982, 31.860011376440525, 31.698001071810722, 21.27150807591775, 20.631430010000855, 21.32777372437218, 20.850191339850426, 21.79367479402572, 21.40176698565483, 10.762416831528142, 10.656088431676224, 10.37816247840722, 22.841156482696533, 22.996190287172794, 22.735414266586304, 18.00784222781658, 17.97373093664646, 18.08890452608466, 14.217811110119015, 13.255391786495835, 13.513433108727128, 20.89399444808562, 21.421198479326748, 20.808822651704148, 17.69491023321946, 18.099401918550328, 17.47030309339364, 20.263487855593354, 20.238130549589783, 20.058526965479047, 17.584143882772565, 17.472682230795414, 17.3788336465756, 27.820783538743854, 27.780785674229264, 27.591852463781834, 21.1789617302517, 21.019347737232835, 20.476710627476365, 8.265635197361306, 7.578397293885544, 8.31732590993245, 16.512326398243502, 16.412506741782025, 15.951475878556565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15328097623680725, "mean_inference_ms": 0.7049870902107156, "mean_action_processing_ms": 0.10007801994230416, "mean_env_wait_ms": 0.8075209443458833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1842048, "timesteps_this_iter": 0, "agent_timesteps_total": 5526144, "timers": {"sample_time_ms": 19941.182, "sample_throughput": 481.115, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3132.452, "learn_throughput": 3062.777, "update_time_ms": 8.751}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.667134842657739e-13, "cur_lr": 0.0005, "total_loss": 6.387143135070801, "policy_loss": 0.0002756202350893133, "vf_loss": 6.58060097694397, "vf_explained_var": 0.09731268137693405, "kl": 0.007365038822515161, "entropy": 19.373348712921143, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1842048, "num_agent_steps_sampled": 5526144, "num_steps_trained": 1842048, "num_agent_steps_trained": 5526144, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6954, "training_iteration": 192, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-47-54", "timestamp": 1706194074, "time_this_iter_s": 19.89478373527527, "time_total_s": 3871.4606993198395, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41BE9700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3871.4606993198395, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 7.878571428571427, "ram_util_percent": 53.528571428571425}}
{"episode_reward_max": 99.30341706424952, "episode_reward_min": -318.2689967080951, "episode_reward_mean": 54.12343270535173, "episode_len_mean": 299.35, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -117.81603459517162}, "policy_reward_max": {"shared_policy": 33.462588243186474}, "policy_reward_mean": {"shared_policy": 18.041144235117237}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.77405996620652, 70.02124269539489, -318.2689967080951, 43.0982106234878, 70.31685701059175, 81.75776152126488, 36.08518584817645, 66.91464718058702, 85.40681765286715, 73.81709231622517, 32.193178750574575, 60.83351241052149, 67.95067742094398, 38.531439147889586, 58.43550983443856, 43.57669704779981, 59.68671742640436, 74.21258354373275, 99.30341706424952, 71.12495251372457, 62.95189666282384, 31.602160140871973, 76.80724038556217, 43.61480627581476, 56.14649697765705, 13.657025668770075, 53.15092931687829, 76.32222802378237, -4.6120744519867, 51.32665305794214, 23.521034084260435, 85.29690494202077, 73.78497403860092, 77.02868740074335, 63.432065866887555, 88.91890888940543, 51.39866949059069, 77.71093255653976, 53.80854728817938, 96.43179406784475, 55.65493195317683, 68.46764250099656, 35.29150650941301, 53.477253330871434, 87.17228825390337, 65.04704204900189, 58.554194616153836, 62.297971760854125, 66.65820136852562, 93.41239042580126, 81.88802674412725, 95.46601435542107, 63.230711810290785, 64.04563311953098, 31.796667741611586, 68.57276103645563, 54.070477690547705, 40.98663600534198, 63.12401557911652, 53.26461524516343, 60.560145370662184, 52.43565976014358, 83.19342167675495, 62.6750200949609, 24.1613584011793, 48.87630901858209, 60.538118550553904, 59.418402440845966, 54.03773798141627, 56.50937025900927, 78.20331963151692, 24.002398636192083, 22.45815487951039, 73.35613318905233, 35.576831810176344, 63.58161523193118, 67.65947751840575, 45.781377200968564, 54.6084952801466, 40.589703232981265, 20.432567927986355, 45.333191974263144, 58.895611211657524, 38.38102994533253, 52.30110534280536, 33.89874534774569, 72.42469111084935, 53.416197091341004, 26.105389788746805, 85.9286674186587, 27.17253563180566, 91.76980504114181, 56.81478667259216, 48.99507208913565, 88.00178575841709, 32.84565527574158, 50.656404878944144, 42.44036934152244, 64.83225777931509, 58.92392469570039], "episode_lengths": [300, 300, 235, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [21.529545019070298, 21.738051528731972, 21.506463418404252, 23.517987795018897, 23.196410228808716, 23.306844671567276, -100.43398443857829, -100.01897767434518, -117.81603459517162, 14.52397398526469, 14.03157019863525, 14.542666439587862, 23.246758031348378, 23.612888793616236, 23.457210185627133, 26.878032247225434, 27.242582524816186, 27.637146749223263, 11.727647791306168, 12.100913553188235, 12.256624503682048, 22.296475710968167, 22.231662588814885, 22.386508880803973, 28.778644653658063, 27.55434889594713, 29.073824103261956, 24.636850060895085, 24.65291205048561, 24.527330204844475, 10.781518888970211, 10.63913421457012, 10.772525647034243, 19.941797522207096, 20.435035941501454, 20.456678946812943, 22.469109177589417, 22.52522836625576, 22.9563398770988, 12.979647601644189, 12.450298155347497, 13.1014933908979, 19.370237916707993, 19.799258310347795, 19.266013607382774, 14.457724464436367, 14.534194224824503, 14.58477835853894, 19.45180432498455, 20.204476999118924, 20.030436102300882, 24.674620692928627, 24.324344759186104, 25.213618091618017, 33.462588243186474, 32.50708290934563, 33.333745911717415, 23.564117707312107, 23.748833134770393, 23.812001671642065, 20.862024200459317, 21.03094313976665, 21.058929322597876, 10.547226975361497, 10.568608651558549, 10.486324513951928, 25.483507355054215, 25.701513839264706, 25.622219191243246, 14.542079774041966, 14.725993910183504, 14.346732591589287, 18.750054630140454, 18.983157126853854, 18.413285220662743, 4.361416459083557, 4.190885037183762, 5.104724172502756, 17.772223549584538, 17.73772523800531, 17.64098052928844, 25.614465893013403, 25.096345245838165, 25.611416884930804, -1.5915814451873302, -1.343080630991608, -1.6774123758077621, 16.8106994430224, 17.576981549073622, 16.938972065846116, 7.418504531184823, 8.224400045971066, 7.878129507104546, 28.694893054664135, 27.628102719783783, 28.973909167572856, 24.354213193058968, 24.5434138327837, 24.887347012758255, 25.597405073543385, 25.488813457389668, 25.9424688698103, 20.765020494659737, 21.67942753185828, 20.987617840369538, 29.657886520028114, 30.06647553574294, 29.194546833634377, 17.363648395985365, 17.452778397127986, 16.58224269747734, 25.610332553585366, 25.713134100039795, 26.3874659029146, 18.502328430612877, 17.550096844633416, 17.75612201293309, 32.14789916574955, 32.14176234602928, 32.14213255606592, 17.949768925706536, 18.996976629520447, 18.708186397949845, 22.749100173513085, 23.25115955869356, 22.467382768789918, 12.66263356350828, 11.786165401339531, 10.8427075445652, 17.28015116850534, 18.1812601579974, 18.015842004368693, 28.753379320104912, 29.145038088162735, 29.273870845635727, 21.291461837788418, 21.87386118046318, 21.88171903075029, 20.166666181758046, 19.248985648155212, 19.138542786240578, 20.697705410420895, 20.906030936166644, 20.694235414266586, 22.251519490033388, 22.097449958324432, 22.309231920167804, 31.05671004702647, 31.00334209700425, 31.352338281770542, 27.082145462433488, 27.3568712050716, 27.44901007662216, 31.90800190716982, 31.860011376440525, 31.698001071810722, 21.27150807591775, 20.631430010000855, 21.32777372437218, 20.850191339850426, 21.79367479402572, 21.40176698565483, 10.762416831528142, 10.656088431676224, 10.37816247840722, 22.841156482696533, 22.996190287172794, 22.735414266586304, 18.00784222781658, 17.97373093664646, 18.08890452608466, 14.217811110119015, 13.255391786495835, 13.513433108727128, 20.89399444808562, 21.421198479326748, 20.808822651704148, 17.69491023321946, 18.099401918550328, 17.47030309339364, 20.263487855593354, 20.238130549589783, 20.058526965479047, 17.584143882772565, 17.472682230795414, 17.3788336465756, 27.820783538743854, 27.780785674229264, 27.591852463781834, 21.1789617302517, 21.019347737232835, 20.476710627476365, 8.265635197361306, 7.578397293885544, 8.31732590993245, 16.512326398243502, 16.412506741782025, 15.951475878556565, 19.970693384607628, 20.12276144822438, 20.444663717721895, 20.13477898389101, 19.435167640447617, 19.84845581650734, 18.006361362834767, 18.095552901116505, 17.935823717465, 18.796951329956443, 18.878295553537697, 18.834123375515134, 26.168927830954388, 26.037414764364556, 25.996977036197976, 8.1572969481349, 7.824199669063091, 8.020902018994093, 7.1417494316895755, 7.679155786832169, 7.637249660988644, 24.230238904555634, 24.573876929779843, 24.552017354716853, 12.070435645679623, 11.804976786176354, 11.701419378320367, 20.713189403216035, 21.694097119073064, 21.174328709642083, 22.336600815256432, 22.37253764768441, 22.95033905546491, 15.009562402963638, 15.740674545057118, 15.031140252947807, 18.577138274908066, 18.44124072790146, 17.590116277337074, 13.159395530819893, 13.265123888850212, 14.16518381331116, 6.631113270918519, 7.127941063294799, 6.673513593773038, 15.070017165193946, 15.364186447909248, 14.898988361159951, 19.18302120268345, 20.05323802679777, 19.659351982176304, 12.528195011119038, 12.97109611813599, 12.881738816077501, 17.49145809809366, 17.656588333348424, 17.153058911363274, 11.444152131366224, 11.292664090792329, 11.161929125587136, 24.364052097002656, 24.354019890228898, 23.7066191236178, 17.829484795530632, 17.6085358907779, 17.97817640503247, 8.607966567079217, 8.675624097386986, 8.821799124280602, 28.260317633549363, 28.381027470032365, 29.287322315076977, 8.912621200084686, 9.44025382772088, 8.819660604000092, 30.617027707397938, 30.50101140141487, 30.651765932329, 19.33339713513851, 18.57380150258541, 18.90758803486824, 16.114513486623764, 16.498025007545948, 16.382533594965935, 29.52435269656901, 29.030039002497986, 29.44739405935009, 10.89407843848069, 11.20804833209452, 10.743528505166367, 16.770575956751898, 16.94884757728626, 16.936981344905988, 14.394429390629128, 14.214000561585024, 13.831939389308289, 21.325403834382683, 21.69328489402929, 21.813569050903112, 19.691167188187435, 19.36340746780236, 19.869350039710596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15323255697146781, "mean_inference_ms": 0.704809425931338, "mean_action_processing_ms": 0.10002741822813956, "mean_env_wait_ms": 0.8073894094447034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1851642, "timesteps_this_iter": 0, "agent_timesteps_total": 5554926, "timers": {"sample_time_ms": 19967.901, "sample_throughput": 480.471, "load_time_ms": 0.192, "load_throughput": 49839178.321, "learn_time_ms": 3121.98, "learn_throughput": 3073.05, "update_time_ms": 8.35}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.667134842657739e-13, "cur_lr": 0.0005, "total_loss": 5.910772442817688, "policy_loss": 0.0015792210054497158, "vf_loss": 6.10099196434021, "vf_explained_var": 0.11207561939954758, "kl": 0.01201335906842476, "entropy": 19.17985725402832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1851642, "num_agent_steps_sampled": 5554926, "num_steps_trained": 1851642, "num_agent_steps_trained": 5554926, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6988, "training_iteration": 193, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-48-14", "timestamp": 1706194094, "time_this_iter_s": 20.00698947906494, "time_total_s": 3891.4676887989044, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BA04C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3891.4676887989044, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 8.789285714285715, "ram_util_percent": 53.52499999999999}}
{"episode_reward_max": 96.43179406784475, "episode_reward_min": -3.511510415002718, "episode_reward_mean": 56.49972804614517, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -1.3000493521491734}, "policy_reward_max": {"shared_policy": 32.14789916574955}, "policy_reward_mean": {"shared_policy": 18.833242682048386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.78497403860092, 77.02868740074335, 63.432065866887555, 88.91890888940543, 51.39866949059069, 77.71093255653976, 53.80854728817938, 96.43179406784475, 55.65493195317683, 68.46764250099656, 35.29150650941301, 53.477253330871434, 87.17228825390337, 65.04704204900189, 58.554194616153836, 62.297971760854125, 66.65820136852562, 93.41239042580126, 81.88802674412725, 95.46601435542107, 63.230711810290785, 64.04563311953098, 31.796667741611586, 68.57276103645563, 54.070477690547705, 40.98663600534198, 63.12401557911652, 53.26461524516343, 60.560145370662184, 52.43565976014358, 83.19342167675495, 62.6750200949609, 24.1613584011793, 48.87630901858209, 60.538118550553904, 59.418402440845966, 54.03773798141627, 56.50937025900927, 78.20331963151692, 24.002398636192083, 22.45815487951039, 73.35613318905233, 35.576831810176344, 63.58161523193118, 67.65947751840575, 45.781377200968564, 54.6084952801466, 40.589703232981265, 20.432567927986355, 45.333191974263144, 58.895611211657524, 38.38102994533253, 52.30110534280536, 33.89874534774569, 72.42469111084935, 53.416197091341004, 26.105389788746805, 85.9286674186587, 27.17253563180566, 91.76980504114181, 56.81478667259216, 48.99507208913565, 88.00178575841709, 32.84565527574158, 50.656404878944144, 42.44036934152244, 64.83225777931509, 58.92392469570039, 69.7456280873157, 55.48412670288232, 59.60695643723011, 61.70095394551751, 78.72340872138737, 44.01550221070646, 24.230115436017513, 75.09956191852686, 32.36072924733162, 52.59707379061726, 76.4181308224797, 65.15807712450624, 64.23726670606993, 41.80427069962025, 53.421051114797564, 81.75881385733372, 39.5980442147702, 55.524473905563354, 54.512733604758964, 62.27040679007767, 70.86853798851371, 37.15212101861832, 70.15582609176634, -3.511510415002718, 55.546510539948926, 58.8370150141418, 26.327012725174427, 70.22689252253622, 61.6082015354186, 20.754778314381838, 53.24756053881718, 17.706127218902097], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [24.354213193058968, 24.5434138327837, 24.887347012758255, 25.597405073543385, 25.488813457389668, 25.9424688698103, 20.765020494659737, 21.67942753185828, 20.987617840369538, 29.657886520028114, 30.06647553574294, 29.194546833634377, 17.363648395985365, 17.452778397127986, 16.58224269747734, 25.610332553585366, 25.713134100039795, 26.3874659029146, 18.502328430612877, 17.550096844633416, 17.75612201293309, 32.14789916574955, 32.14176234602928, 32.14213255606592, 17.949768925706536, 18.996976629520447, 18.708186397949845, 22.749100173513085, 23.25115955869356, 22.467382768789918, 12.66263356350828, 11.786165401339531, 10.8427075445652, 17.28015116850534, 18.1812601579974, 18.015842004368693, 28.753379320104912, 29.145038088162735, 29.273870845635727, 21.291461837788418, 21.87386118046318, 21.88171903075029, 20.166666181758046, 19.248985648155212, 19.138542786240578, 20.697705410420895, 20.906030936166644, 20.694235414266586, 22.251519490033388, 22.097449958324432, 22.309231920167804, 31.05671004702647, 31.00334209700425, 31.352338281770542, 27.082145462433488, 27.3568712050716, 27.44901007662216, 31.90800190716982, 31.860011376440525, 31.698001071810722, 21.27150807591775, 20.631430010000855, 21.32777372437218, 20.850191339850426, 21.79367479402572, 21.40176698565483, 10.762416831528142, 10.656088431676224, 10.37816247840722, 22.841156482696533, 22.996190287172794, 22.735414266586304, 18.00784222781658, 17.97373093664646, 18.08890452608466, 14.217811110119015, 13.255391786495835, 13.513433108727128, 20.89399444808562, 21.421198479326748, 20.808822651704148, 17.69491023321946, 18.099401918550328, 17.47030309339364, 20.263487855593354, 20.238130549589783, 20.058526965479047, 17.584143882772565, 17.472682230795414, 17.3788336465756, 27.820783538743854, 27.780785674229264, 27.591852463781834, 21.1789617302517, 21.019347737232835, 20.476710627476365, 8.265635197361306, 7.578397293885544, 8.31732590993245, 16.512326398243502, 16.412506741782025, 15.951475878556565, 19.970693384607628, 20.12276144822438, 20.444663717721895, 20.13477898389101, 19.435167640447617, 19.84845581650734, 18.006361362834767, 18.095552901116505, 17.935823717465, 18.796951329956443, 18.878295553537697, 18.834123375515134, 26.168927830954388, 26.037414764364556, 25.996977036197976, 8.1572969481349, 7.824199669063091, 8.020902018994093, 7.1417494316895755, 7.679155786832169, 7.637249660988644, 24.230238904555634, 24.573876929779843, 24.552017354716853, 12.070435645679623, 11.804976786176354, 11.701419378320367, 20.713189403216035, 21.694097119073064, 21.174328709642083, 22.336600815256432, 22.37253764768441, 22.95033905546491, 15.009562402963638, 15.740674545057118, 15.031140252947807, 18.577138274908066, 18.44124072790146, 17.590116277337074, 13.159395530819893, 13.265123888850212, 14.16518381331116, 6.631113270918519, 7.127941063294799, 6.673513593773038, 15.070017165193946, 15.364186447909248, 14.898988361159951, 19.18302120268345, 20.05323802679777, 19.659351982176304, 12.528195011119038, 12.97109611813599, 12.881738816077501, 17.49145809809366, 17.656588333348424, 17.153058911363274, 11.444152131366224, 11.292664090792329, 11.161929125587136, 24.364052097002656, 24.354019890228898, 23.7066191236178, 17.829484795530632, 17.6085358907779, 17.97817640503247, 8.607966567079217, 8.675624097386986, 8.821799124280602, 28.260317633549363, 28.381027470032365, 29.287322315076977, 8.912621200084686, 9.44025382772088, 8.819660604000092, 30.617027707397938, 30.50101140141487, 30.651765932329, 19.33339713513851, 18.57380150258541, 18.90758803486824, 16.114513486623764, 16.498025007545948, 16.382533594965935, 29.52435269656901, 29.030039002497986, 29.44739405935009, 10.89407843848069, 11.20804833209452, 10.743528505166367, 16.770575956751898, 16.94884757728626, 16.936981344905988, 14.394429390629128, 14.214000561585024, 13.831939389308289, 21.325403834382683, 21.69328489402929, 21.813569050903112, 19.691167188187435, 19.36340746780236, 19.869350039710596, 23.283381653328732, 23.491475682550416, 22.970770751436547, 18.30095964918533, 18.691962398278207, 18.491204655418784, 19.826084315776825, 19.99575564265251, 19.785116478800774, 20.685505504409463, 20.20555348197618, 20.809894959131867, 26.075126489003495, 26.35289929558833, 26.295382936795548, 14.44283842047055, 15.054369912793234, 14.518293877442673, 7.159510672092438, 8.470698546618223, 8.599906217306852, 24.884233231345803, 25.4073899971942, 24.807938689986855, 11.016539946198463, 10.811140403151512, 10.533048897981644, 17.330899606148392, 17.622887175219745, 17.64328700924912, 25.62784533823529, 25.076838860909135, 25.713446623335273, 21.84349874034524, 21.658082008361816, 21.65649637579918, 20.775220781564713, 21.424583360552788, 22.03746256395243, 13.706072479486465, 13.961170338094234, 14.137027882039547, 17.77499585847059, 18.145966226855904, 17.50008902947107, 27.29893854873565, 27.249471935754016, 27.210403372844056, 13.40999941714108, 13.26843012496829, 12.919614672660828, 18.486917704343796, 18.545830637216568, 18.49172556400299, 18.62957255666454, 18.22038147350152, 17.662779574592903, 20.687097152074173, 20.706608695288494, 20.876700942715004, 23.591767966747284, 24.084124144166708, 23.192645877599716, 12.117174642781407, 12.347609216968209, 12.6873371588687, 23.102471490701035, 23.929146264990166, 23.124208336075142, -1.213494392732784, -0.9979666701207606, -1.3000493521491734, 18.48258054008086, 18.54334132870038, 18.520588671167687, 19.99026196077466, 19.697064645588398, 19.14968840777874, 8.635754033923149, 8.525588929653168, 9.16566976159811, 23.278447531163692, 23.804530098102987, 23.14391489326954, 20.33907315383354, 20.640120065460593, 20.62900831612447, 6.939198587089777, 6.9364716373384, 6.879108089953661, 17.426454817255333, 17.762060818572834, 18.059044902989015, 5.93207013358672, 5.782741797467068, 5.991315287848309]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532239310755338, "mean_inference_ms": 0.7049443546776157, "mean_action_processing_ms": 0.10004574261341023, "mean_env_wait_ms": 0.8075510750528443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1861236, "timesteps_this_iter": 0, "agent_timesteps_total": 5583708, "timers": {"sample_time_ms": 20051.319, "sample_throughput": 478.472, "load_time_ms": 0.299, "load_throughput": 32130431.632, "learn_time_ms": 3127.783, "learn_throughput": 3067.349, "update_time_ms": 8.349}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.667134842657739e-13, "cur_lr": 0.0005, "total_loss": 4.498966574668884, "policy_loss": 0.0016458117614798762, "vf_loss": 4.691680550575256, "vf_explained_var": 0.2894517406821251, "kl": 0.013704944402335212, "entropy": 19.435951232910156, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1861236, "num_agent_steps_sampled": 5583708, "num_steps_trained": 1861236, "num_agent_steps_trained": 5583708, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7020, "training_iteration": 194, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-48-35", "timestamp": 1706194115, "time_this_iter_s": 20.66290044784546, "time_total_s": 3912.13058924675, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3912.13058924675, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 9.76206896551724, "ram_util_percent": 53.610344827586204}}
{"episode_reward_max": 91.76980504114181, "episode_reward_min": -315.695025280118, "episode_reward_mean": 47.92244633670226, "episode_len_mean": 298.59, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -111.84421001374722}, "policy_reward_max": {"shared_policy": 30.651765932329}, "policy_reward_mean": {"shared_policy": 15.97414877890075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.1613584011793, 48.87630901858209, 60.538118550553904, 59.418402440845966, 54.03773798141627, 56.50937025900927, 78.20331963151692, 24.002398636192083, 22.45815487951039, 73.35613318905233, 35.576831810176344, 63.58161523193118, 67.65947751840575, 45.781377200968564, 54.6084952801466, 40.589703232981265, 20.432567927986355, 45.333191974263144, 58.895611211657524, 38.38102994533253, 52.30110534280536, 33.89874534774569, 72.42469111084935, 53.416197091341004, 26.105389788746805, 85.9286674186587, 27.17253563180566, 91.76980504114181, 56.81478667259216, 48.99507208913565, 88.00178575841709, 32.84565527574158, 50.656404878944144, 42.44036934152244, 64.83225777931509, 58.92392469570039, 69.7456280873157, 55.48412670288232, 59.60695643723011, 61.70095394551751, 78.72340872138737, 44.01550221070646, 24.230115436017513, 75.09956191852686, 32.36072924733162, 52.59707379061726, 76.4181308224797, 65.15807712450624, 64.23726670606993, 41.80427069962025, 53.421051114797564, 81.75881385733372, 39.5980442147702, 55.524473905563354, 54.512733604758964, 62.27040679007767, 70.86853798851371, 37.15212101861832, 70.15582609176634, -3.511510415002718, 55.546510539948926, 58.8370150141418, 26.327012725174427, 70.22689252253622, 61.6082015354186, 20.754778314381838, 53.24756053881718, 17.706127218902097, 55.90520587534411, 63.07849552482365, 33.909943230450125, 48.32328983768819, 65.72486950922755, 74.81915354356168, 44.373183537274585, 64.1642124727368, 66.82510723173615, 62.90068129263818, 30.179581537842722, 88.94573218515141, 19.9879740141332, 48.23327131755647, 64.38121794164178, 46.1734254732728, 18.349975011777104, 10.604260958731174, -315.695025280118, 66.87845436483622, 52.922093342989655, 66.90936540439724, 28.991866994649143, 2.52945831418036, 23.73302187025547, 29.213698010891676, 85.24719843268392, 66.98184335231778, 63.6838250355795, 49.60273286141454, 72.04067094033233, 46.21085351333021], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 159, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [8.265635197361306, 7.578397293885544, 8.31732590993245, 16.512326398243502, 16.412506741782025, 15.951475878556565, 19.970693384607628, 20.12276144822438, 20.444663717721895, 20.13477898389101, 19.435167640447617, 19.84845581650734, 18.006361362834767, 18.095552901116505, 17.935823717465, 18.796951329956443, 18.878295553537697, 18.834123375515134, 26.168927830954388, 26.037414764364556, 25.996977036197976, 8.1572969481349, 7.824199669063091, 8.020902018994093, 7.1417494316895755, 7.679155786832169, 7.637249660988644, 24.230238904555634, 24.573876929779843, 24.552017354716853, 12.070435645679623, 11.804976786176354, 11.701419378320367, 20.713189403216035, 21.694097119073064, 21.174328709642083, 22.336600815256432, 22.37253764768441, 22.95033905546491, 15.009562402963638, 15.740674545057118, 15.031140252947807, 18.577138274908066, 18.44124072790146, 17.590116277337074, 13.159395530819893, 13.265123888850212, 14.16518381331116, 6.631113270918519, 7.127941063294799, 6.673513593773038, 15.070017165193946, 15.364186447909248, 14.898988361159951, 19.18302120268345, 20.05323802679777, 19.659351982176304, 12.528195011119038, 12.97109611813599, 12.881738816077501, 17.49145809809366, 17.656588333348424, 17.153058911363274, 11.444152131366224, 11.292664090792329, 11.161929125587136, 24.364052097002656, 24.354019890228898, 23.7066191236178, 17.829484795530632, 17.6085358907779, 17.97817640503247, 8.607966567079217, 8.675624097386986, 8.821799124280602, 28.260317633549363, 28.381027470032365, 29.287322315076977, 8.912621200084686, 9.44025382772088, 8.819660604000092, 30.617027707397938, 30.50101140141487, 30.651765932329, 19.33339713513851, 18.57380150258541, 18.90758803486824, 16.114513486623764, 16.498025007545948, 16.382533594965935, 29.52435269656901, 29.030039002497986, 29.44739405935009, 10.89407843848069, 11.20804833209452, 10.743528505166367, 16.770575956751898, 16.94884757728626, 16.936981344905988, 14.394429390629128, 14.214000561585024, 13.831939389308289, 21.325403834382683, 21.69328489402929, 21.813569050903112, 19.691167188187435, 19.36340746780236, 19.869350039710596, 23.283381653328732, 23.491475682550416, 22.970770751436547, 18.30095964918533, 18.691962398278207, 18.491204655418784, 19.826084315776825, 19.99575564265251, 19.785116478800774, 20.685505504409463, 20.20555348197618, 20.809894959131867, 26.075126489003495, 26.35289929558833, 26.295382936795548, 14.44283842047055, 15.054369912793234, 14.518293877442673, 7.159510672092438, 8.470698546618223, 8.599906217306852, 24.884233231345803, 25.4073899971942, 24.807938689986855, 11.016539946198463, 10.811140403151512, 10.533048897981644, 17.330899606148392, 17.622887175219745, 17.64328700924912, 25.62784533823529, 25.076838860909135, 25.713446623335273, 21.84349874034524, 21.658082008361816, 21.65649637579918, 20.775220781564713, 21.424583360552788, 22.03746256395243, 13.706072479486465, 13.961170338094234, 14.137027882039547, 17.77499585847059, 18.145966226855904, 17.50008902947107, 27.29893854873565, 27.249471935754016, 27.210403372844056, 13.40999941714108, 13.26843012496829, 12.919614672660828, 18.486917704343796, 18.545830637216568, 18.49172556400299, 18.62957255666454, 18.22038147350152, 17.662779574592903, 20.687097152074173, 20.706608695288494, 20.876700942715004, 23.591767966747284, 24.084124144166708, 23.192645877599716, 12.117174642781407, 12.347609216968209, 12.6873371588687, 23.102471490701035, 23.929146264990166, 23.124208336075142, -1.213494392732784, -0.9979666701207606, -1.3000493521491734, 18.48258054008086, 18.54334132870038, 18.520588671167687, 19.99026196077466, 19.697064645588398, 19.14968840777874, 8.635754033923149, 8.525588929653168, 9.16566976159811, 23.278447531163692, 23.804530098102987, 23.14391489326954, 20.33907315383354, 20.640120065460593, 20.62900831612447, 6.939198587089777, 6.9364716373384, 6.879108089953661, 17.426454817255333, 17.762060818572834, 18.059044902989015, 5.93207013358672, 5.782741797467068, 5.991315287848309, 18.963735900528263, 18.35961052775383, 18.581859447062016, 20.96056555708249, 21.169564103086785, 20.948365864654377, 11.328827681640774, 11.178455630938203, 11.402659917871148, 16.135994901259735, 15.776130740841225, 16.411164195587233, 21.11092663804689, 22.35701478055367, 22.256928090626985, 24.82312962909539, 24.968474139769867, 25.027549774696425, 15.019877598931387, 14.57899461438258, 14.774311323960617, 20.88572038213411, 21.56370786825815, 21.714784222344548, 22.199366504947335, 22.31930028895536, 22.30644043783346, 20.765260741114616, 21.237455619499087, 20.89796493202448, 10.166382382313401, 9.780772964159638, 10.232426191369683, 29.398110290368393, 29.74676096377273, 29.80086093101029, 6.353428592284516, 6.67173073192437, 6.962814689924315, 15.855479250351578, 16.191847506600112, 16.18594456060478, 21.293238470951707, 21.52583363900581, 21.562145831684262, 15.530651040375233, 15.186551451683044, 15.456222981214523, 5.932671884695679, 6.36296251617992, 6.054340610901505, 3.80752519518137, 3.182042807340622, 3.6146929562091827, -101.58875642716885, -111.84421001374722, -102.26205883920193, 22.30469822138548, 22.37052320688963, 22.203232936561108, 17.416492233673722, 17.61766319970289, 17.887937909613044, 22.016745915015534, 22.166936953862503, 22.725682535519198, 9.596273529032857, 9.794814868519694, 9.600778597096593, 1.058478412528828, 0.7839302544792446, 0.6870496471722873, 7.787637695670128, 8.080627009272575, 7.864757165312767, 9.399411916732788, 9.62454603612423, 10.189740058034658, 28.329479599992425, 28.314209858576447, 28.603508974115044, 22.29582531253496, 22.282603735725075, 22.403414304057748, 20.55911237001419, 21.650845707394183, 21.47386695817113, 16.52293302988012, 16.483702295770243, 16.596097535764173, 24.064121708118662, 23.877666549136237, 24.098882683077434, 15.323254739244774, 15.55565721665819, 15.331941557427243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532107135503631, "mean_inference_ms": 0.7048743114530726, "mean_action_processing_ms": 0.09998142626809782, "mean_env_wait_ms": 0.8074711637291675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1870830, "timesteps_this_iter": 0, "agent_timesteps_total": 5612490, "timers": {"sample_time_ms": 20153.33, "sample_throughput": 476.05, "load_time_ms": 0.299, "load_throughput": 32130431.632, "learn_time_ms": 3112.064, "learn_throughput": 3082.841, "update_time_ms": 8.348}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.667134842657739e-13, "cur_lr": 0.0005, "total_loss": 68.71380996704102, "policy_loss": 0.0006981182170235911, "vf_loss": 68.9056806564331, "vf_explained_var": 0.03971397131681442, "kl": 0.03917157417198147, "entropy": 19.25694704055786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1870830, "num_agent_steps_sampled": 5612490, "num_steps_trained": 1870830, "num_agent_steps_trained": 5612490, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7052, "training_iteration": 195, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-48-55", "timestamp": 1706194135, "time_this_iter_s": 20.252496480941772, "time_total_s": 3932.3830857276917, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3932.3830857276917, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 9.617241379310345, "ram_util_percent": 53.63793103448276}}
{"episode_reward_max": 89.20050331950186, "episode_reward_min": -315.695025280118, "episode_reward_mean": 50.52129844012496, "episode_len_mean": 298.59, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -111.84421001374722}, "policy_reward_max": {"shared_policy": 29.90046788503726}, "policy_reward_mean": {"shared_policy": 16.840432813374978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.656404878944144, 42.44036934152244, 64.83225777931509, 58.92392469570039, 69.7456280873157, 55.48412670288232, 59.60695643723011, 61.70095394551751, 78.72340872138737, 44.01550221070646, 24.230115436017513, 75.09956191852686, 32.36072924733162, 52.59707379061726, 76.4181308224797, 65.15807712450624, 64.23726670606993, 41.80427069962025, 53.421051114797564, 81.75881385733372, 39.5980442147702, 55.524473905563354, 54.512733604758964, 62.27040679007767, 70.86853798851371, 37.15212101861832, 70.15582609176634, -3.511510415002718, 55.546510539948926, 58.8370150141418, 26.327012725174427, 70.22689252253622, 61.6082015354186, 20.754778314381838, 53.24756053881718, 17.706127218902097, 55.90520587534411, 63.07849552482365, 33.909943230450125, 48.32328983768819, 65.72486950922755, 74.81915354356168, 44.373183537274585, 64.1642124727368, 66.82510723173615, 62.90068129263818, 30.179581537842722, 88.94573218515141, 19.9879740141332, 48.23327131755647, 64.38121794164178, 46.1734254732728, 18.349975011777104, 10.604260958731174, -315.695025280118, 66.87845436483622, 52.922093342989655, 66.90936540439724, 28.991866994649143, 2.52945831418036, 23.73302187025547, 29.213698010891676, 85.24719843268392, 66.98184335231778, 63.6838250355795, 49.60273286141454, 72.04067094033233, 46.21085351333021, 62.21047092997469, 89.20050331950186, 47.92896826937793, 64.55779464915395, 18.152630543336258, 78.86720050312576, 17.48223895649423, 54.25205793976784, 65.32468540035185, 62.876423715613754, 79.26266032829881, 80.3294292183418, 46.79982407204804, 47.92815708369017, 58.80716087669134, 40.799081951379776, 60.69890095293522, 68.75166749209164, 67.20603551703968, 60.9913924001157, 41.30139125930144, 82.55619379691778, 42.98574757575989, 61.30996276438235, 68.75350064923985, 54.33633378148076, 76.1656998321414, 40.54792386974438, 59.02671165019274, 59.24087598454207, 68.29372839909047, 75.01549755083396], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 159, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.770575956751898, 16.94884757728626, 16.936981344905988, 14.394429390629128, 14.214000561585024, 13.831939389308289, 21.325403834382683, 21.69328489402929, 21.813569050903112, 19.691167188187435, 19.36340746780236, 19.869350039710596, 23.283381653328732, 23.491475682550416, 22.970770751436547, 18.30095964918533, 18.691962398278207, 18.491204655418784, 19.826084315776825, 19.99575564265251, 19.785116478800774, 20.685505504409463, 20.20555348197618, 20.809894959131867, 26.075126489003495, 26.35289929558833, 26.295382936795548, 14.44283842047055, 15.054369912793234, 14.518293877442673, 7.159510672092438, 8.470698546618223, 8.599906217306852, 24.884233231345803, 25.4073899971942, 24.807938689986855, 11.016539946198463, 10.811140403151512, 10.533048897981644, 17.330899606148392, 17.622887175219745, 17.64328700924912, 25.62784533823529, 25.076838860909135, 25.713446623335273, 21.84349874034524, 21.658082008361816, 21.65649637579918, 20.775220781564713, 21.424583360552788, 22.03746256395243, 13.706072479486465, 13.961170338094234, 14.137027882039547, 17.77499585847059, 18.145966226855904, 17.50008902947107, 27.29893854873565, 27.249471935754016, 27.210403372844056, 13.40999941714108, 13.26843012496829, 12.919614672660828, 18.486917704343796, 18.545830637216568, 18.49172556400299, 18.62957255666454, 18.22038147350152, 17.662779574592903, 20.687097152074173, 20.706608695288494, 20.876700942715004, 23.591767966747284, 24.084124144166708, 23.192645877599716, 12.117174642781407, 12.347609216968209, 12.6873371588687, 23.102471490701035, 23.929146264990166, 23.124208336075142, -1.213494392732784, -0.9979666701207606, -1.3000493521491734, 18.48258054008086, 18.54334132870038, 18.520588671167687, 19.99026196077466, 19.697064645588398, 19.14968840777874, 8.635754033923149, 8.525588929653168, 9.16566976159811, 23.278447531163692, 23.804530098102987, 23.14391489326954, 20.33907315383354, 20.640120065460593, 20.62900831612447, 6.939198587089777, 6.9364716373384, 6.879108089953661, 17.426454817255333, 17.762060818572834, 18.059044902989015, 5.93207013358672, 5.782741797467068, 5.991315287848309, 18.963735900528263, 18.35961052775383, 18.581859447062016, 20.96056555708249, 21.169564103086785, 20.948365864654377, 11.328827681640774, 11.178455630938203, 11.402659917871148, 16.135994901259735, 15.776130740841225, 16.411164195587233, 21.11092663804689, 22.35701478055367, 22.256928090626985, 24.82312962909539, 24.968474139769867, 25.027549774696425, 15.019877598931387, 14.57899461438258, 14.774311323960617, 20.88572038213411, 21.56370786825815, 21.714784222344548, 22.199366504947335, 22.31930028895536, 22.30644043783346, 20.765260741114616, 21.237455619499087, 20.89796493202448, 10.166382382313401, 9.780772964159638, 10.232426191369683, 29.398110290368393, 29.74676096377273, 29.80086093101029, 6.353428592284516, 6.67173073192437, 6.962814689924315, 15.855479250351578, 16.191847506600112, 16.18594456060478, 21.293238470951707, 21.52583363900581, 21.562145831684262, 15.530651040375233, 15.186551451683044, 15.456222981214523, 5.932671884695679, 6.36296251617992, 6.054340610901505, 3.80752519518137, 3.182042807340622, 3.6146929562091827, -101.58875642716885, -111.84421001374722, -102.26205883920193, 22.30469822138548, 22.37052320688963, 22.203232936561108, 17.416492233673722, 17.61766319970289, 17.887937909613044, 22.016745915015534, 22.166936953862503, 22.725682535519198, 9.596273529032857, 9.794814868519694, 9.600778597096593, 1.058478412528828, 0.7839302544792446, 0.6870496471722873, 7.787637695670128, 8.080627009272575, 7.864757165312767, 9.399411916732788, 9.62454603612423, 10.189740058034658, 28.329479599992425, 28.314209858576447, 28.603508974115044, 22.29582531253496, 22.282603735725075, 22.403414304057748, 20.55911237001419, 21.650845707394183, 21.47386695817113, 16.52293302988012, 16.483702295770243, 16.596097535764173, 24.064121708118662, 23.877666549136237, 24.098882683077434, 15.323254739244774, 15.55565721665819, 15.331941557427243, 20.085067734122276, 20.864583536982536, 21.260819658869877, 29.654584196706608, 29.90046788503726, 29.645451237757996, 16.146297582735613, 15.88451612492402, 15.8981545617183, 20.730828642845154, 21.936201602220535, 21.89076440408826, 6.550514514868453, 5.098146398862198, 6.503969629605606, 26.382833291466028, 26.2392708385984, 26.24509637306133, 5.397777686516434, 6.225372876428679, 5.859088393549115, 17.68107482790947, 17.918133676052094, 18.652849435806274, 21.66490081200996, 21.565631250540406, 22.094153337801487, 20.753036784629018, 21.050661486263067, 21.07272544472167, 26.423642478883266, 26.089480623602867, 26.749537225812674, 27.368323188692244, 26.747708948949963, 26.213397080699593, 15.859255381549389, 15.490382211903722, 15.45018647859493, 16.210548482835293, 15.538202986121178, 16.179405614733696, 19.297894433140755, 19.759936721995473, 19.749329721555114, 13.207167893648148, 13.753646969795227, 13.838267087936401, 20.003391548991203, 20.11730831861496, 20.578201085329056, 22.64428712924321, 23.12990865235527, 22.977471710493163, 22.381690780321748, 22.548386952412926, 22.275957784305007, 20.57805649439493, 19.578943173090607, 20.834392732630164, 13.708878026654318, 13.955180691399917, 13.637332541247204, 27.727481167142585, 27.525860046346978, 27.30285258342822, 14.32375194132328, 14.326195135712624, 14.335800498723984, 20.42601465185483, 20.344731723268822, 20.539216389258698, 22.931640618791178, 23.13544497157757, 22.686415058871106, 18.20875647912422, 18.03207657734552, 18.09550072501102, 25.042199313640594, 25.675640486180782, 25.447860032320023, 12.95184629658857, 13.798582848491293, 13.797494724664517, 19.62271461635828, 19.66733144968748, 19.736665584146976, 19.36968855559826, 19.89517392590642, 19.976013503037393, 22.191628634929657, 22.54633267223835, 23.555767091922462, 25.017467630406216, 24.629547526439026, 25.368482393988714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15321521762380386, "mean_inference_ms": 0.7050518167652244, "mean_action_processing_ms": 0.10001096918517988, "mean_env_wait_ms": 0.8076312449104125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1880424, "timesteps_this_iter": 0, "agent_timesteps_total": 5641272, "timers": {"sample_time_ms": 20100.685, "sample_throughput": 477.297, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3102.813, "learn_throughput": 3092.033, "update_time_ms": 8.242}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.000702263986608e-13, "cur_lr": 0.0005, "total_loss": 6.493663191795349, "policy_loss": -0.0004250813902468842, "vf_loss": 6.688818514347076, "vf_explained_var": 0.11049342900514603, "kl": 0.005344157776927853, "entropy": 19.47306990623474, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1880424, "num_agent_steps_sampled": 5641272, "num_steps_trained": 1880424, "num_agent_steps_trained": 5641272, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7084, "training_iteration": 196, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-49-15", "timestamp": 1706194155, "time_this_iter_s": 19.68435549736023, "time_total_s": 3952.067441225052, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BA0550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3952.067441225052, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 10.200000000000001, "ram_util_percent": 53.51481481481483}}
{"episode_reward_max": 89.20050331950186, "episode_reward_min": -315.695025280118, "episode_reward_mean": 46.96691738600086, "episode_len_mean": 298.59, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -111.84421001374722}, "policy_reward_max": {"shared_policy": 29.90046788503726}, "policy_reward_mean": {"shared_policy": 15.655639128666946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.22689252253622, 61.6082015354186, 20.754778314381838, 53.24756053881718, 17.706127218902097, 55.90520587534411, 63.07849552482365, 33.909943230450125, 48.32328983768819, 65.72486950922755, 74.81915354356168, 44.373183537274585, 64.1642124727368, 66.82510723173615, 62.90068129263818, 30.179581537842722, 88.94573218515141, 19.9879740141332, 48.23327131755647, 64.38121794164178, 46.1734254732728, 18.349975011777104, 10.604260958731174, -315.695025280118, 66.87845436483622, 52.922093342989655, 66.90936540439724, 28.991866994649143, 2.52945831418036, 23.73302187025547, 29.213698010891676, 85.24719843268392, 66.98184335231778, 63.6838250355795, 49.60273286141454, 72.04067094033233, 46.21085351333021, 62.21047092997469, 89.20050331950186, 47.92896826937793, 64.55779464915395, 18.152630543336258, 78.86720050312576, 17.48223895649423, 54.25205793976784, 65.32468540035185, 62.876423715613754, 79.26266032829881, 80.3294292183418, 46.79982407204804, 47.92815708369017, 58.80716087669134, 40.799081951379776, 60.69890095293522, 68.75166749209164, 67.20603551703968, 60.9913924001157, 41.30139125930144, 82.55619379691778, 42.98574757575989, 61.30996276438235, 68.75350064923985, 54.33633378148076, 76.1656998321414, 40.54792386974438, 59.02671165019274, 59.24087598454207, 68.29372839909047, 75.01549755083396, 35.051751839695484, 15.076393580064178, 46.96227712905964, 52.89649572223425, 64.91963215917349, 68.73224925622343, 27.633839258924112, 30.383867335855015, 64.47017102316019, 29.260933566838503, 45.584624085575314, 52.725568711757646, -2.7743921130895615, 51.917381035164, 48.41965405270456, 49.716585262678535, 27.130690701305866, 34.75973564013839, 59.961749110370874, 46.36284922622143, 76.0967227220535, 22.65396045893428, 18.46419303119181, 4.407233476638794, 61.56079572066663, 57.642743233591304, 73.86927539855242, 55.965270724147544, 20.501550629734965, 27.04478596523404, 57.65910163894294], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 159, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.278447531163692, 23.804530098102987, 23.14391489326954, 20.33907315383354, 20.640120065460593, 20.62900831612447, 6.939198587089777, 6.9364716373384, 6.879108089953661, 17.426454817255333, 17.762060818572834, 18.059044902989015, 5.93207013358672, 5.782741797467068, 5.991315287848309, 18.963735900528263, 18.35961052775383, 18.581859447062016, 20.96056555708249, 21.169564103086785, 20.948365864654377, 11.328827681640774, 11.178455630938203, 11.402659917871148, 16.135994901259735, 15.776130740841225, 16.411164195587233, 21.11092663804689, 22.35701478055367, 22.256928090626985, 24.82312962909539, 24.968474139769867, 25.027549774696425, 15.019877598931387, 14.57899461438258, 14.774311323960617, 20.88572038213411, 21.56370786825815, 21.714784222344548, 22.199366504947335, 22.31930028895536, 22.30644043783346, 20.765260741114616, 21.237455619499087, 20.89796493202448, 10.166382382313401, 9.780772964159638, 10.232426191369683, 29.398110290368393, 29.74676096377273, 29.80086093101029, 6.353428592284516, 6.67173073192437, 6.962814689924315, 15.855479250351578, 16.191847506600112, 16.18594456060478, 21.293238470951707, 21.52583363900581, 21.562145831684262, 15.530651040375233, 15.186551451683044, 15.456222981214523, 5.932671884695679, 6.36296251617992, 6.054340610901505, 3.80752519518137, 3.182042807340622, 3.6146929562091827, -101.58875642716885, -111.84421001374722, -102.26205883920193, 22.30469822138548, 22.37052320688963, 22.203232936561108, 17.416492233673722, 17.61766319970289, 17.887937909613044, 22.016745915015534, 22.166936953862503, 22.725682535519198, 9.596273529032857, 9.794814868519694, 9.600778597096593, 1.058478412528828, 0.7839302544792446, 0.6870496471722873, 7.787637695670128, 8.080627009272575, 7.864757165312767, 9.399411916732788, 9.62454603612423, 10.189740058034658, 28.329479599992425, 28.314209858576447, 28.603508974115044, 22.29582531253496, 22.282603735725075, 22.403414304057748, 20.55911237001419, 21.650845707394183, 21.47386695817113, 16.52293302988012, 16.483702295770243, 16.596097535764173, 24.064121708118662, 23.877666549136237, 24.098882683077434, 15.323254739244774, 15.55565721665819, 15.331941557427243, 20.085067734122276, 20.864583536982536, 21.260819658869877, 29.654584196706608, 29.90046788503726, 29.645451237757996, 16.146297582735613, 15.88451612492402, 15.8981545617183, 20.730828642845154, 21.936201602220535, 21.89076440408826, 6.550514514868453, 5.098146398862198, 6.503969629605606, 26.382833291466028, 26.2392708385984, 26.24509637306133, 5.397777686516434, 6.225372876428679, 5.859088393549115, 17.68107482790947, 17.918133676052094, 18.652849435806274, 21.66490081200996, 21.565631250540406, 22.094153337801487, 20.753036784629018, 21.050661486263067, 21.07272544472167, 26.423642478883266, 26.089480623602867, 26.749537225812674, 27.368323188692244, 26.747708948949963, 26.213397080699593, 15.859255381549389, 15.490382211903722, 15.45018647859493, 16.210548482835293, 15.538202986121178, 16.179405614733696, 19.297894433140755, 19.759936721995473, 19.749329721555114, 13.207167893648148, 13.753646969795227, 13.838267087936401, 20.003391548991203, 20.11730831861496, 20.578201085329056, 22.64428712924321, 23.12990865235527, 22.977471710493163, 22.381690780321748, 22.548386952412926, 22.275957784305007, 20.57805649439493, 19.578943173090607, 20.834392732630164, 13.708878026654318, 13.955180691399917, 13.637332541247204, 27.727481167142585, 27.525860046346978, 27.30285258342822, 14.32375194132328, 14.326195135712624, 14.335800498723984, 20.42601465185483, 20.344731723268822, 20.539216389258698, 22.931640618791178, 23.13544497157757, 22.686415058871106, 18.20875647912422, 18.03207657734552, 18.09550072501102, 25.042199313640594, 25.675640486180782, 25.447860032320023, 12.95184629658857, 13.798582848491293, 13.797494724664517, 19.62271461635828, 19.66733144968748, 19.736665584146976, 19.36968855559826, 19.89517392590642, 19.976013503037393, 22.191628634929657, 22.54633267223835, 23.555767091922462, 25.017467630406216, 24.629547526439026, 25.368482393988714, 11.759072696169213, 11.429438744982079, 11.863240398544193, 5.03751565143466, 5.133040094748139, 4.905837833881378, 15.103598808248833, 15.816784979154662, 16.04189334165615, 17.769654281437397, 17.587762251496315, 17.539079189300537, 21.663007900118828, 21.772836610674858, 21.483787648379803, 22.95609020752211, 22.947955291097358, 22.82820375760396, 9.346564284836248, 9.108190176387623, 9.179084797700241, 10.352238352138855, 9.942576458056763, 10.089052525659397, 21.78810755039254, 20.953258017698914, 21.728805455068738, 9.65635634958744, 9.852381981909275, 9.752195235341787, 15.082414495448262, 15.351606449733168, 15.150603140393883, 17.550224636991814, 17.90863451858361, 17.26670955618222, -0.942143440246582, -0.8927063979208469, -0.9395422749221325, 17.450858363881707, 17.199775837361813, 17.26674683392048, 15.734648381670311, 16.441841678073004, 16.243163992961243, 16.9075943181912, 17.144950756492705, 15.66404018799463, 9.003392308950424, 8.898771181702614, 9.228527210652828, 11.82726226374507, 11.426843643188477, 11.505629733204842, 19.940060954540968, 19.958399534225464, 20.063288621604443, 15.42993066956599, 15.598523701851562, 15.334394854803875, 24.996028299132973, 25.695463287333638, 25.405231135586888, 7.593919965128094, 7.433696980277688, 7.6263435135284965, 6.077741776903466, 5.885987003644303, 6.500464250644043, 1.1467056572437286, 1.360720381140709, 1.8998074382543564, 20.595178344597414, 20.368739758928612, 20.596877617140606, 19.642778423925236, 19.652650163819388, 18.34731464584668, 24.76265900582075, 24.276151329278946, 24.83046506345272, 18.642650851358965, 18.671169829865292, 18.651450042923287, 6.938247422377259, 6.598154644171387, 6.965148563186318, 8.77138203382492, 9.453232292085886, 8.820171639323235, 19.55789815758665, 19.335954805215195, 18.7652486761411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1532117113627412, "mean_inference_ms": 0.705054624007075, "mean_action_processing_ms": 0.10000784423973244, "mean_env_wait_ms": 0.8076152043532939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1890018, "timesteps_this_iter": 0, "agent_timesteps_total": 5670054, "timers": {"sample_time_ms": 20044.455, "sample_throughput": 478.636, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3094.804, "learn_throughput": 3100.035, "update_time_ms": 8.243}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.000702263986608e-13, "cur_lr": 0.0005, "total_loss": 5.2754093408584595, "policy_loss": 1.1529669293741662e-05, "vf_loss": 5.4670140743255615, "vf_explained_var": 0.3259102925658226, "kl": 0.00457617337850485, "entropy": 19.161607027053833, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1890018, "num_agent_steps_sampled": 5670054, "num_steps_trained": 1890018, "num_agent_steps_trained": 5670054, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7115, "training_iteration": 197, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-49-35", "timestamp": 1706194175, "time_this_iter_s": 19.743939638137817, "time_total_s": 3971.8113808631897, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3971.8113808631897, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 9.935714285714287, "ram_util_percent": 53.60714285714285}}
{"episode_reward_max": 89.23040019068867, "episode_reward_min": -2.7743921130895615, "episode_reward_mean": 54.71092332859989, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -0.942143440246582}, "policy_reward_max": {"shared_policy": 30.153141458518803}, "policy_reward_mean": {"shared_policy": 18.236974442866625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.60273286141454, 72.04067094033233, 46.21085351333021, 62.21047092997469, 89.20050331950186, 47.92896826937793, 64.55779464915395, 18.152630543336258, 78.86720050312576, 17.48223895649423, 54.25205793976784, 65.32468540035185, 62.876423715613754, 79.26266032829881, 80.3294292183418, 46.79982407204804, 47.92815708369017, 58.80716087669134, 40.799081951379776, 60.69890095293522, 68.75166749209164, 67.20603551703968, 60.9913924001157, 41.30139125930144, 82.55619379691778, 42.98574757575989, 61.30996276438235, 68.75350064923985, 54.33633378148076, 76.1656998321414, 40.54792386974438, 59.02671165019274, 59.24087598454207, 68.29372839909047, 75.01549755083396, 35.051751839695484, 15.076393580064178, 46.96227712905964, 52.89649572223425, 64.91963215917349, 68.73224925622343, 27.633839258924112, 30.383867335855015, 64.47017102316019, 29.260933566838503, 45.584624085575314, 52.725568711757646, -2.7743921130895615, 51.917381035164, 48.41965405270456, 49.716585262678535, 27.130690701305866, 34.75973564013839, 59.961749110370874, 46.36284922622143, 76.0967227220535, 22.65396045893428, 18.46419303119181, 4.407233476638794, 61.56079572066663, 57.642743233591304, 73.86927539855242, 55.965270724147544, 20.501550629734965, 27.04478596523404, 57.65910163894294, 77.22943537216631, 68.47554449737072, 66.27705194056031, 21.269410878419876, 67.05990468012169, 49.40243962802924, 53.582419669255586, 41.9938637688756, 63.92686117812988, 29.204999509267495, 55.98818960413334, 79.12378146499394, 61.093209216371164, 89.23040019068867, 71.6411045270506, 35.54729889705777, 44.38574554165824, 81.68370411172506, 72.70910129696128, 48.31148092541842, 58.827596524730296, 88.20381137542427, 80.81730567663907, 52.41734637692569, 86.02602247428146, 54.183045059442506, 59.89336100965738, 53.81755321659146, 61.98385403305289, 54.097208929248126, 63.63581041153519, 48.66858659218997, 53.614656242541955, 81.89742990769443], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [16.52293302988012, 16.483702295770243, 16.596097535764173, 24.064121708118662, 23.877666549136237, 24.098882683077434, 15.323254739244774, 15.55565721665819, 15.331941557427243, 20.085067734122276, 20.864583536982536, 21.260819658869877, 29.654584196706608, 29.90046788503726, 29.645451237757996, 16.146297582735613, 15.88451612492402, 15.8981545617183, 20.730828642845154, 21.936201602220535, 21.89076440408826, 6.550514514868453, 5.098146398862198, 6.503969629605606, 26.382833291466028, 26.2392708385984, 26.24509637306133, 5.397777686516434, 6.225372876428679, 5.859088393549115, 17.68107482790947, 17.918133676052094, 18.652849435806274, 21.66490081200996, 21.565631250540406, 22.094153337801487, 20.753036784629018, 21.050661486263067, 21.07272544472167, 26.423642478883266, 26.089480623602867, 26.749537225812674, 27.368323188692244, 26.747708948949963, 26.213397080699593, 15.859255381549389, 15.490382211903722, 15.45018647859493, 16.210548482835293, 15.538202986121178, 16.179405614733696, 19.297894433140755, 19.759936721995473, 19.749329721555114, 13.207167893648148, 13.753646969795227, 13.838267087936401, 20.003391548991203, 20.11730831861496, 20.578201085329056, 22.64428712924321, 23.12990865235527, 22.977471710493163, 22.381690780321748, 22.548386952412926, 22.275957784305007, 20.57805649439493, 19.578943173090607, 20.834392732630164, 13.708878026654318, 13.955180691399917, 13.637332541247204, 27.727481167142585, 27.525860046346978, 27.30285258342822, 14.32375194132328, 14.326195135712624, 14.335800498723984, 20.42601465185483, 20.344731723268822, 20.539216389258698, 22.931640618791178, 23.13544497157757, 22.686415058871106, 18.20875647912422, 18.03207657734552, 18.09550072501102, 25.042199313640594, 25.675640486180782, 25.447860032320023, 12.95184629658857, 13.798582848491293, 13.797494724664517, 19.62271461635828, 19.66733144968748, 19.736665584146976, 19.36968855559826, 19.89517392590642, 19.976013503037393, 22.191628634929657, 22.54633267223835, 23.555767091922462, 25.017467630406216, 24.629547526439026, 25.368482393988714, 11.759072696169213, 11.429438744982079, 11.863240398544193, 5.03751565143466, 5.133040094748139, 4.905837833881378, 15.103598808248833, 15.816784979154662, 16.04189334165615, 17.769654281437397, 17.587762251496315, 17.539079189300537, 21.663007900118828, 21.772836610674858, 21.483787648379803, 22.95609020752211, 22.947955291097358, 22.82820375760396, 9.346564284836248, 9.108190176387623, 9.179084797700241, 10.352238352138855, 9.942576458056763, 10.089052525659397, 21.78810755039254, 20.953258017698914, 21.728805455068738, 9.65635634958744, 9.852381981909275, 9.752195235341787, 15.082414495448262, 15.351606449733168, 15.150603140393883, 17.550224636991814, 17.90863451858361, 17.26670955618222, -0.942143440246582, -0.8927063979208469, -0.9395422749221325, 17.450858363881707, 17.199775837361813, 17.26674683392048, 15.734648381670311, 16.441841678073004, 16.243163992961243, 16.9075943181912, 17.144950756492705, 15.66404018799463, 9.003392308950424, 8.898771181702614, 9.228527210652828, 11.82726226374507, 11.426843643188477, 11.505629733204842, 19.940060954540968, 19.958399534225464, 20.063288621604443, 15.42993066956599, 15.598523701851562, 15.334394854803875, 24.996028299132973, 25.695463287333638, 25.405231135586888, 7.593919965128094, 7.433696980277688, 7.6263435135284965, 6.077741776903466, 5.885987003644303, 6.500464250644043, 1.1467056572437286, 1.360720381140709, 1.8998074382543564, 20.595178344597414, 20.368739758928612, 20.596877617140606, 19.642778423925236, 19.652650163819388, 18.34731464584668, 24.76265900582075, 24.276151329278946, 24.83046506345272, 18.642650851358965, 18.671169829865292, 18.651450042923287, 6.938247422377259, 6.598154644171387, 6.965148563186318, 8.77138203382492, 9.453232292085886, 8.820171639323235, 19.55789815758665, 19.335954805215195, 18.7652486761411, 25.788466592940182, 25.796825459847838, 25.644143319378287, 22.846755120903254, 22.8531687669456, 22.775620609521866, 21.907511899868638, 22.26219634215036, 22.107343698541314, 7.375799626111984, 6.67895881831646, 7.214652433991432, 21.98915432393551, 22.460709393024445, 22.610040963161737, 16.521020379150286, 16.49475172162056, 16.386667527258396, 17.92489596332112, 17.595804805556924, 18.061718900377542, 14.050498306751251, 13.8325747102499, 14.110790751874447, 21.443867436299712, 21.164262215296418, 21.318731526533753, 10.282721244109169, 9.314735000332192, 9.607543264826134, 18.74836357558766, 18.698650787274033, 18.541175241271645, 26.21382076044877, 26.609598246713475, 26.300362457831696, 20.517479292427495, 20.42892078806956, 20.146809135874108, 29.936486300081015, 29.140772432088852, 30.153141458518803, 24.171055952940748, 23.88568994651237, 23.58435862759748, 11.724901154637337, 11.65346573293209, 12.168932009488344, 14.947937420414135, 14.52073299636443, 14.917075124879673, 27.227092045048863, 27.048628660539777, 27.407983406136424, 24.09165699283281, 24.278455937902123, 24.338988366226346, 15.844648090501622, 16.357306732175246, 16.109526102741555, 19.72988822000721, 19.410541909436375, 19.68716639528671, 29.61611058562994, 28.97961065173149, 29.608090138062835, 27.120872167249516, 26.977828954656914, 26.718604554732636, 17.642287043233708, 17.96670076375206, 16.808358569939926, 28.554043064514786, 28.49932417521873, 28.972655234547943, 17.449703772862748, 18.42943325390418, 18.30390803267558, 20.006321251392365, 20.207860983908176, 19.679178774356842, 18.171917694931224, 18.02554503207405, 17.62009048958619, 20.614489729205758, 20.74146908024946, 20.627895223597676, 17.991605824480445, 18.19579990549633, 17.90980319927135, 21.57651503042628, 20.88820419212182, 21.17109118898709, 16.501688797026873, 16.717863402329385, 15.44903439283371, 18.40449727357675, 17.60122451682885, 17.608934452136353, 27.278923044602067, 27.430377748484403, 27.18812911460796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531459047625769, "mean_inference_ms": 0.7048997517787453, "mean_action_processing_ms": 0.09998059539155114, "mean_env_wait_ms": 0.8075578941680348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1899612, "timesteps_this_iter": 0, "agent_timesteps_total": 5698836, "timers": {"sample_time_ms": 20052.413, "sample_throughput": 478.446, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3075.413, "learn_throughput": 3119.581, "update_time_ms": 8.143}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 4.965763688087463, "policy_loss": 0.0006738091943956359, "vf_loss": 5.162211537361145, "vf_explained_var": 0.12851373106241226, "kl": 0.006272548140631943, "entropy": 19.712177515029907, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1899612, "num_agent_steps_sampled": 5698836, "num_steps_trained": 1899612, "num_agent_steps_trained": 5698836, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7149, "training_iteration": 198, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-49-54", "timestamp": 1706194194, "time_this_iter_s": 19.3088595867157, "time_total_s": 3991.1202404499054, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3991.1202404499054, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 8.103571428571428, "ram_util_percent": 52.86428571428572}}
{"episode_reward_max": 90.17521606944501, "episode_reward_min": -4.129992542788415, "episode_reward_mean": 55.408821546199604, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -1.855871086319297}, "policy_reward_max": {"shared_policy": 30.260387932881713}, "policy_reward_mean": {"shared_policy": 18.469607182066532}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.1656998321414, 40.54792386974438, 59.02671165019274, 59.24087598454207, 68.29372839909047, 75.01549755083396, 35.051751839695484, 15.076393580064178, 46.96227712905964, 52.89649572223425, 64.91963215917349, 68.73224925622343, 27.633839258924112, 30.383867335855015, 64.47017102316019, 29.260933566838503, 45.584624085575314, 52.725568711757646, -2.7743921130895615, 51.917381035164, 48.41965405270456, 49.716585262678535, 27.130690701305866, 34.75973564013839, 59.961749110370874, 46.36284922622143, 76.0967227220535, 22.65396045893428, 18.46419303119181, 4.407233476638794, 61.56079572066663, 57.642743233591304, 73.86927539855242, 55.965270724147544, 20.501550629734965, 27.04478596523404, 57.65910163894294, 77.22943537216631, 68.47554449737072, 66.27705194056031, 21.269410878419876, 67.05990468012169, 49.40243962802924, 53.582419669255586, 41.9938637688756, 63.92686117812988, 29.204999509267495, 55.98818960413334, 79.12378146499394, 61.093209216371164, 89.23040019068867, 71.6411045270506, 35.54729889705777, 44.38574554165824, 81.68370411172506, 72.70910129696128, 48.31148092541842, 58.827596524730296, 88.20381137542427, 80.81730567663907, 52.41734637692569, 86.02602247428146, 54.183045059442506, 59.89336100965738, 53.81755321659146, 61.98385403305289, 54.097208929248126, 63.63581041153519, 48.66858659218997, 53.614656242541955, 81.89742990769443, 74.44958550529554, 54.303425654768915, 70.91726072877644, 67.85606833361088, 83.09712560940531, 61.019180364906774, 41.867889277636976, 17.9339667279273, 79.30924470350143, 61.18073028884828, 42.30358813703059, 69.1193792633712, 43.31988161057231, 85.13641889393328, 66.5525849983096, 55.378445051610456, 49.503803635016055, 81.07090233266351, 61.140546067152144, 54.502726858481765, 57.78171603567897, 80.4797645807266, -4.129992542788415, 70.14837414398787, 90.17521606944501, 61.76696539670226, 61.04420541785656, 72.46365916775537, 51.621830709278555], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.042199313640594, 25.675640486180782, 25.447860032320023, 12.95184629658857, 13.798582848491293, 13.797494724664517, 19.62271461635828, 19.66733144968748, 19.736665584146976, 19.36968855559826, 19.89517392590642, 19.976013503037393, 22.191628634929657, 22.54633267223835, 23.555767091922462, 25.017467630406216, 24.629547526439026, 25.368482393988714, 11.759072696169213, 11.429438744982079, 11.863240398544193, 5.03751565143466, 5.133040094748139, 4.905837833881378, 15.103598808248833, 15.816784979154662, 16.04189334165615, 17.769654281437397, 17.587762251496315, 17.539079189300537, 21.663007900118828, 21.772836610674858, 21.483787648379803, 22.95609020752211, 22.947955291097358, 22.82820375760396, 9.346564284836248, 9.108190176387623, 9.179084797700241, 10.352238352138855, 9.942576458056763, 10.089052525659397, 21.78810755039254, 20.953258017698914, 21.728805455068738, 9.65635634958744, 9.852381981909275, 9.752195235341787, 15.082414495448262, 15.351606449733168, 15.150603140393883, 17.550224636991814, 17.90863451858361, 17.26670955618222, -0.942143440246582, -0.8927063979208469, -0.9395422749221325, 17.450858363881707, 17.199775837361813, 17.26674683392048, 15.734648381670311, 16.441841678073004, 16.243163992961243, 16.9075943181912, 17.144950756492705, 15.66404018799463, 9.003392308950424, 8.898771181702614, 9.228527210652828, 11.82726226374507, 11.426843643188477, 11.505629733204842, 19.940060954540968, 19.958399534225464, 20.063288621604443, 15.42993066956599, 15.598523701851562, 15.334394854803875, 24.996028299132973, 25.695463287333638, 25.405231135586888, 7.593919965128094, 7.433696980277688, 7.6263435135284965, 6.077741776903466, 5.885987003644303, 6.500464250644043, 1.1467056572437286, 1.360720381140709, 1.8998074382543564, 20.595178344597414, 20.368739758928612, 20.596877617140606, 19.642778423925236, 19.652650163819388, 18.34731464584668, 24.76265900582075, 24.276151329278946, 24.83046506345272, 18.642650851358965, 18.671169829865292, 18.651450042923287, 6.938247422377259, 6.598154644171387, 6.965148563186318, 8.77138203382492, 9.453232292085886, 8.820171639323235, 19.55789815758665, 19.335954805215195, 18.7652486761411, 25.788466592940182, 25.796825459847838, 25.644143319378287, 22.846755120903254, 22.8531687669456, 22.775620609521866, 21.907511899868638, 22.26219634215036, 22.107343698541314, 7.375799626111984, 6.67895881831646, 7.214652433991432, 21.98915432393551, 22.460709393024445, 22.610040963161737, 16.521020379150286, 16.49475172162056, 16.386667527258396, 17.92489596332112, 17.595804805556924, 18.061718900377542, 14.050498306751251, 13.8325747102499, 14.110790751874447, 21.443867436299712, 21.164262215296418, 21.318731526533753, 10.282721244109169, 9.314735000332192, 9.607543264826134, 18.74836357558766, 18.698650787274033, 18.541175241271645, 26.21382076044877, 26.609598246713475, 26.300362457831696, 20.517479292427495, 20.42892078806956, 20.146809135874108, 29.936486300081015, 29.140772432088852, 30.153141458518803, 24.171055952940748, 23.88568994651237, 23.58435862759748, 11.724901154637337, 11.65346573293209, 12.168932009488344, 14.947937420414135, 14.52073299636443, 14.917075124879673, 27.227092045048863, 27.048628660539777, 27.407983406136424, 24.09165699283281, 24.278455937902123, 24.338988366226346, 15.844648090501622, 16.357306732175246, 16.109526102741555, 19.72988822000721, 19.410541909436375, 19.68716639528671, 29.61611058562994, 28.97961065173149, 29.608090138062835, 27.120872167249516, 26.977828954656914, 26.718604554732636, 17.642287043233708, 17.96670076375206, 16.808358569939926, 28.554043064514786, 28.49932417521873, 28.972655234547943, 17.449703772862748, 18.42943325390418, 18.30390803267558, 20.006321251392365, 20.207860983908176, 19.679178774356842, 18.171917694931224, 18.02554503207405, 17.62009048958619, 20.614489729205758, 20.74146908024946, 20.627895223597676, 17.991605824480445, 18.19579990549633, 17.90980319927135, 21.57651503042628, 20.88820419212182, 21.17109118898709, 16.501688797026873, 16.717863402329385, 15.44903439283371, 18.40449727357675, 17.60122451682885, 17.608934452136353, 27.278923044602067, 27.430377748484403, 27.18812911460796, 24.62107439339161, 24.829981353133917, 24.99852975877002, 17.8122641245524, 18.07330575833717, 18.417855771879346, 23.359160115321473, 23.797199865182236, 23.760900748272732, 22.7061101210614, 22.76632656094928, 22.383631651600197, 27.46161328504482, 27.748014981547982, 27.88749734281251, 19.965796043475464, 20.652779695888356, 20.400604625542954, 13.615428085128457, 14.01808839912215, 14.23437279338637, 5.778504105905682, 5.937101858357579, 6.2183607636640374, 26.48846326644221, 26.466718746970088, 26.354062690089137, 20.212195187807083, 20.61364989541471, 20.354885205626488, 14.106517759462193, 14.136337888737515, 14.06073248883088, 23.162889810899884, 22.583039323488862, 23.373450128982455, 14.401668513814599, 14.326022769014031, 14.59219032774368, 28.223149364193276, 28.500000980993107, 28.4132685487469, 22.21556595464547, 22.221551490326718, 22.11546755333741, 18.54940629874666, 18.314686206479863, 18.514352546383932, 15.567441980044038, 17.12624687391022, 16.8101147810618, 27.141030910114438, 27.24409821877876, 26.68577320377031, 20.504075282408536, 20.49977035323778, 20.13670043150583, 17.82431699335575, 18.31998934969306, 18.358420515432954, 19.248418634136513, 19.395847081517175, 19.13745032002528, 26.974915357927472, 26.674086468915135, 26.830762753883988, -1.855871086319297, -1.1050899283339675, -1.1690315281351502, 23.584578479329736, 23.089454318086297, 23.474341346571833, 30.260387932881713, 29.981999680399895, 29.932828456163406, 21.03831362227598, 19.557187298933655, 21.171464475492627, 19.879087780912712, 20.401476857562855, 20.763640779380992, 23.99436084429422, 24.189486520985753, 24.279811802475393, 17.253580684463174, 16.633329610029847, 17.734920414785535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15313817344760225, "mean_inference_ms": 0.7048774060683134, "mean_action_processing_ms": 0.09997550335051329, "mean_env_wait_ms": 0.8075157478989194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1909206, "timesteps_this_iter": 0, "agent_timesteps_total": 5727618, "timers": {"sample_time_ms": 20080.452, "sample_throughput": 477.778, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3066.887, "learn_throughput": 3128.253, "update_time_ms": 8.293}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 6.1758716106414795, "policy_loss": 0.0014655077500281485, "vf_loss": 6.374180793762207, "vf_explained_var": 0.16613996028900146, "kl": 0.011947375722610539, "entropy": 19.97750687599182, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1909206, "num_agent_steps_sampled": 5727618, "num_steps_trained": 1909206, "num_agent_steps_trained": 5727618, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7178, "training_iteration": 199, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-50-14", "timestamp": 1706194214, "time_this_iter_s": 19.974353551864624, "time_total_s": 4011.09459400177, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0205CE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4011.09459400177, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 10.164285714285713, "ram_util_percent": 52.589285714285715}}
{"episode_reward_max": 90.17521606944501, "episode_reward_min": -4.129992542788415, "episode_reward_mean": 59.41279396356084, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -1.855871086319297}, "policy_reward_max": {"shared_policy": 30.260387932881713}, "policy_reward_mean": {"shared_policy": 19.80426465452027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.65910163894294, 77.22943537216631, 68.47554449737072, 66.27705194056031, 21.269410878419876, 67.05990468012169, 49.40243962802924, 53.582419669255586, 41.9938637688756, 63.92686117812988, 29.204999509267495, 55.98818960413334, 79.12378146499394, 61.093209216371164, 89.23040019068867, 71.6411045270506, 35.54729889705777, 44.38574554165824, 81.68370411172506, 72.70910129696128, 48.31148092541842, 58.827596524730296, 88.20381137542427, 80.81730567663907, 52.41734637692569, 86.02602247428146, 54.183045059442506, 59.89336100965738, 53.81755321659146, 61.98385403305289, 54.097208929248126, 63.63581041153519, 48.66858659218997, 53.614656242541955, 81.89742990769443, 74.44958550529554, 54.303425654768915, 70.91726072877644, 67.85606833361088, 83.09712560940531, 61.019180364906774, 41.867889277636976, 17.9339667279273, 79.30924470350143, 61.18073028884828, 42.30358813703059, 69.1193792633712, 43.31988161057231, 85.13641889393328, 66.5525849983096, 55.378445051610456, 49.503803635016055, 81.07090233266351, 61.140546067152144, 54.502726858481765, 57.78171603567897, 80.4797645807266, -4.129992542788415, 70.14837414398787, 90.17521606944501, 61.76696539670226, 61.04420541785656, 72.46365916775537, 51.621830709278555, 29.584749516099677, 62.05094153806564, 68.7969997320324, 86.09019680321214, 80.44495148956773, 56.57465313374993, 60.25604476779699, 54.4654837530106, 53.34940078202635, 57.44984862720591, 30.260029986500726, 52.476983485743375, 22.221941852942095, 63.682313200086355, 75.31617191806436, 65.24615982919931, 66.38384193740782, 69.73769008927044, 69.60960763227192, 51.094440907239886, 33.341526513919206, 83.28249946981667, 25.53385664522645, 40.954193608835325, 74.28161863237617, 70.62088463967665, 0.5239322483539439, 48.19898374751209, 86.54853705875573, 38.84079048410058, 63.94854147359729, 70.41522138565779, 46.88690755888818, 45.113213408738375, 63.87402770668268, 78.62908140383661], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.55789815758665, 19.335954805215195, 18.7652486761411, 25.788466592940182, 25.796825459847838, 25.644143319378287, 22.846755120903254, 22.8531687669456, 22.775620609521866, 21.907511899868638, 22.26219634215036, 22.107343698541314, 7.375799626111984, 6.67895881831646, 7.214652433991432, 21.98915432393551, 22.460709393024445, 22.610040963161737, 16.521020379150286, 16.49475172162056, 16.386667527258396, 17.92489596332112, 17.595804805556924, 18.061718900377542, 14.050498306751251, 13.8325747102499, 14.110790751874447, 21.443867436299712, 21.164262215296418, 21.318731526533753, 10.282721244109169, 9.314735000332192, 9.607543264826134, 18.74836357558766, 18.698650787274033, 18.541175241271645, 26.21382076044877, 26.609598246713475, 26.300362457831696, 20.517479292427495, 20.42892078806956, 20.146809135874108, 29.936486300081015, 29.140772432088852, 30.153141458518803, 24.171055952940748, 23.88568994651237, 23.58435862759748, 11.724901154637337, 11.65346573293209, 12.168932009488344, 14.947937420414135, 14.52073299636443, 14.917075124879673, 27.227092045048863, 27.048628660539777, 27.407983406136424, 24.09165699283281, 24.278455937902123, 24.338988366226346, 15.844648090501622, 16.357306732175246, 16.109526102741555, 19.72988822000721, 19.410541909436375, 19.68716639528671, 29.61611058562994, 28.97961065173149, 29.608090138062835, 27.120872167249516, 26.977828954656914, 26.718604554732636, 17.642287043233708, 17.96670076375206, 16.808358569939926, 28.554043064514786, 28.49932417521873, 28.972655234547943, 17.449703772862748, 18.42943325390418, 18.30390803267558, 20.006321251392365, 20.207860983908176, 19.679178774356842, 18.171917694931224, 18.02554503207405, 17.62009048958619, 20.614489729205758, 20.74146908024946, 20.627895223597676, 17.991605824480445, 18.19579990549633, 17.90980319927135, 21.57651503042628, 20.88820419212182, 21.17109118898709, 16.501688797026873, 16.717863402329385, 15.44903439283371, 18.40449727357675, 17.60122451682885, 17.608934452136353, 27.278923044602067, 27.430377748484403, 27.18812911460796, 24.62107439339161, 24.829981353133917, 24.99852975877002, 17.8122641245524, 18.07330575833717, 18.417855771879346, 23.359160115321473, 23.797199865182236, 23.760900748272732, 22.7061101210614, 22.76632656094928, 22.383631651600197, 27.46161328504482, 27.748014981547982, 27.88749734281251, 19.965796043475464, 20.652779695888356, 20.400604625542954, 13.615428085128457, 14.01808839912215, 14.23437279338637, 5.778504105905682, 5.937101858357579, 6.2183607636640374, 26.48846326644221, 26.466718746970088, 26.354062690089137, 20.212195187807083, 20.61364989541471, 20.354885205626488, 14.106517759462193, 14.136337888737515, 14.06073248883088, 23.162889810899884, 22.583039323488862, 23.373450128982455, 14.401668513814599, 14.326022769014031, 14.59219032774368, 28.223149364193276, 28.500000980993107, 28.4132685487469, 22.21556595464547, 22.221551490326718, 22.11546755333741, 18.54940629874666, 18.314686206479863, 18.514352546383932, 15.567441980044038, 17.12624687391022, 16.8101147810618, 27.141030910114438, 27.24409821877876, 26.68577320377031, 20.504075282408536, 20.49977035323778, 20.13670043150583, 17.82431699335575, 18.31998934969306, 18.358420515432954, 19.248418634136513, 19.395847081517175, 19.13745032002528, 26.974915357927472, 26.674086468915135, 26.830762753883988, -1.855871086319297, -1.1050899283339675, -1.1690315281351502, 23.584578479329736, 23.089454318086297, 23.474341346571833, 30.260387932881713, 29.981999680399895, 29.932828456163406, 21.03831362227598, 19.557187298933655, 21.171464475492627, 19.879087780912712, 20.401476857562855, 20.763640779380992, 23.99436084429422, 24.189486520985753, 24.279811802475393, 17.253580684463174, 16.633329610029847, 17.734920414785535, 9.622510587175682, 10.132524044563368, 9.829714884360627, 20.342633987466485, 20.399217943350465, 21.309089607248694, 23.266227915262178, 22.627767612536744, 22.903004204233483, 28.800098965565354, 28.80147590736547, 28.48862193028131, 26.769356238345296, 26.950674350062997, 26.724920901159436, 18.808719183007867, 18.820356133083493, 18.945577817658574, 19.692549735307693, 20.27492063306272, 20.28857439942658, 18.106265763441712, 18.05849878738323, 18.30071920218566, 17.793507911264896, 17.61222694069147, 17.943665930069983, 19.16860497199619, 19.150522927443177, 19.130720727766544, 10.018109341462448, 9.796342586477593, 10.445578058560685, 17.147704268495232, 17.660775034377963, 17.66850418287018, 6.689867367347077, 7.874047867332891, 7.658026618262127, 21.542141515761614, 20.948598593473434, 21.191573090851307, 24.910272233188152, 25.359405394643545, 25.04649429023266, 22.161205641925335, 21.189401865005493, 21.895552322268486, 22.449150875831634, 21.99749695012966, 21.93719411144653, 23.181097621719033, 23.182397636274487, 23.374194831276924, 23.14730546499291, 23.14274965847531, 23.319552508803696, 16.86861229936281, 17.290920520822198, 16.93490808705488, 10.828624884287507, 10.919912452499062, 11.592989177132637, 27.509580766161278, 27.939192493756607, 27.833726209898785, 8.743045220772416, 8.015016506115586, 8.775794918338448, 13.962125643466905, 13.509024647374943, 13.483043317993477, 24.826640921334416, 24.749175558487565, 24.705802152554185, 23.129214038451508, 24.03905412818615, 23.452616473038987, 0.1814594765504154, -0.040245513121291765, 0.3827182849248203, 15.596539323528603, 16.592958757032946, 16.00948566695054, 28.753732329855353, 28.917589586849004, 28.87721514205137, 12.931644022464752, 12.728503495454788, 13.18064296618104, 20.90313297510147, 21.595604073256254, 21.449804425239563, 23.162414520978928, 23.57690693438053, 23.67589993029833, 15.856749081363276, 15.903952625890568, 15.126205851634339, 15.015858732163906, 15.05803071334958, 15.039323963224888, 20.966898679733276, 21.672643341124058, 21.234485685825348, 26.120114281773567, 25.896103337407112, 26.61286378465593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15310040451010587, "mean_inference_ms": 0.7047358227777667, "mean_action_processing_ms": 0.09993506720388755, "mean_env_wait_ms": 0.8074221436207896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1918800, "timesteps_this_iter": 0, "agent_timesteps_total": 5756400, "timers": {"sample_time_ms": 20137.625, "sample_throughput": 476.422, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3052.868, "learn_throughput": 3142.619, "update_time_ms": 8.292}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 5.801154136657715, "policy_loss": 0.00014972490195708232, "vf_loss": 5.994827926158905, "vf_explained_var": 0.290935717523098, "kl": 0.006563608243957981, "entropy": 19.382354497909546, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1918800, "num_agent_steps_sampled": 5756400, "num_steps_trained": 1918800, "num_agent_steps_trained": 5756400, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 63.952298954129205, "episode_reward_min": 2.4851102244574577, "episode_reward_mean": 45.623984291311345, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.5889590159058571}, "policy_reward_max": {"shared_policy": 21.470748772223786}, "policy_reward_mean": {"shared_policy": 15.207994763770447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.80682501662521, 63.952298954129205, 11.74979009293017, 63.435272366274134, 57.70938433078118, 60.11014535278079, 55.48116558883338, 34.189707855693996, 50.3201431306079, 2.4851102244574577], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.000791224030152, 18.939841167380408, 18.86619262521465, 21.184291084607437, 21.470748772223786, 21.29725909729798, 3.854303936163575, 4.10028160425523, 3.7952045525113647, 20.875449759264782, 21.26165249974777, 21.298170107261583, 19.14887098968029, 19.622044512303546, 18.93846882879734, 20.044866828868777, 20.102341166386992, 19.96293735752502, 18.419865050663546, 18.461821412046746, 18.599479126123086, 10.856252759695053, 11.315419673919678, 12.018035422079265, 16.90531822666526, 17.165805951692164, 16.24901895225048, 0.5889590159058571, 0.9181342348456383, 0.9780169737059623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14438050302483021, "mean_inference_ms": 0.7397633517217936, "mean_action_processing_ms": 0.10037391650222846, "mean_env_wait_ms": 0.8032587540522155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 7214, "training_iteration": 200, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-50-40", "timestamp": 1706194240, "time_this_iter_s": 26.169713973999023, "time_total_s": 4037.264307975769, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4037.264307975769, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 10.627027027027026, "ram_util_percent": 52.64594594594595}}
{"episode_reward_max": 93.55730083212255, "episode_reward_min": -287.1282147318125, "episode_reward_mean": 54.76411863271262, "episode_len_mean": 297.72, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -106.05837627251944}, "policy_reward_max": {"shared_policy": 31.359947399546698}, "policy_reward_mean": {"shared_policy": 18.254706210904207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.98385403305289, 54.097208929248126, 63.63581041153519, 48.66858659218997, 53.614656242541955, 81.89742990769443, 74.44958550529554, 54.303425654768915, 70.91726072877644, 67.85606833361088, 83.09712560940531, 61.019180364906774, 41.867889277636976, 17.9339667279273, 79.30924470350143, 61.18073028884828, 42.30358813703059, 69.1193792633712, 43.31988161057231, 85.13641889393328, 66.5525849983096, 55.378445051610456, 49.503803635016055, 81.07090233266351, 61.140546067152144, 54.502726858481765, 57.78171603567897, 80.4797645807266, -4.129992542788415, 70.14837414398787, 90.17521606944501, 61.76696539670226, 61.04420541785656, 72.46365916775537, 51.621830709278555, 29.584749516099677, 62.05094153806564, 68.7969997320324, 86.09019680321214, 80.44495148956773, 56.57465313374993, 60.25604476779699, 54.4654837530106, 53.34940078202635, 57.44984862720591, 30.260029986500726, 52.476983485743375, 22.221941852942095, 63.682313200086355, 75.31617191806436, 65.24615982919931, 66.38384193740782, 69.73769008927044, 69.60960763227192, 51.094440907239886, 33.341526513919206, 83.28249946981667, 25.53385664522645, 40.954193608835325, 74.28161863237617, 70.62088463967665, 0.5239322483539439, 48.19898374751209, 86.54853705875573, 38.84079048410058, 63.94854147359729, 70.41522138565779, 46.88690755888818, 45.113213408738375, 63.87402770668268, 78.62908140383661, -287.1282147318125, 90.80259055993518, 93.55730083212255, 55.153873356524855, 62.41618919558822, 37.95842919871211, 64.38002026826142, 64.879045933485, 64.44074370618907, 56.520162072032676, 59.03768764808774, 46.84250508435068, 61.588401556014986, 48.149511339142904, 80.97993575572036, 50.33427061885595, 67.84870852343737, 75.53462162986396, 40.67839032784103, 32.25757266581056, 77.08858825266361, 64.21087728999552, 28.6744257705286, 40.81685316725631, 69.09337662905452, 39.3506092019379, 67.02794199530035, 43.93470729887484, 8.684432020294452], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.614489729205758, 20.74146908024946, 20.627895223597676, 17.991605824480445, 18.19579990549633, 17.90980319927135, 21.57651503042628, 20.88820419212182, 21.17109118898709, 16.501688797026873, 16.717863402329385, 15.44903439283371, 18.40449727357675, 17.60122451682885, 17.608934452136353, 27.278923044602067, 27.430377748484403, 27.18812911460796, 24.62107439339161, 24.829981353133917, 24.99852975877002, 17.8122641245524, 18.07330575833717, 18.417855771879346, 23.359160115321473, 23.797199865182236, 23.760900748272732, 22.7061101210614, 22.76632656094928, 22.383631651600197, 27.46161328504482, 27.748014981547982, 27.88749734281251, 19.965796043475464, 20.652779695888356, 20.400604625542954, 13.615428085128457, 14.01808839912215, 14.23437279338637, 5.778504105905682, 5.937101858357579, 6.2183607636640374, 26.48846326644221, 26.466718746970088, 26.354062690089137, 20.212195187807083, 20.61364989541471, 20.354885205626488, 14.106517759462193, 14.136337888737515, 14.06073248883088, 23.162889810899884, 22.583039323488862, 23.373450128982455, 14.401668513814599, 14.326022769014031, 14.59219032774368, 28.223149364193276, 28.500000980993107, 28.4132685487469, 22.21556595464547, 22.221551490326718, 22.11546755333741, 18.54940629874666, 18.314686206479863, 18.514352546383932, 15.567441980044038, 17.12624687391022, 16.8101147810618, 27.141030910114438, 27.24409821877876, 26.68577320377031, 20.504075282408536, 20.49977035323778, 20.13670043150583, 17.82431699335575, 18.31998934969306, 18.358420515432954, 19.248418634136513, 19.395847081517175, 19.13745032002528, 26.974915357927472, 26.674086468915135, 26.830762753883988, -1.855871086319297, -1.1050899283339675, -1.1690315281351502, 23.584578479329736, 23.089454318086297, 23.474341346571833, 30.260387932881713, 29.981999680399895, 29.932828456163406, 21.03831362227598, 19.557187298933655, 21.171464475492627, 19.879087780912712, 20.401476857562855, 20.763640779380992, 23.99436084429422, 24.189486520985753, 24.279811802475393, 17.253580684463174, 16.633329610029847, 17.734920414785535, 9.622510587175682, 10.132524044563368, 9.829714884360627, 20.342633987466485, 20.399217943350465, 21.309089607248694, 23.266227915262178, 22.627767612536744, 22.903004204233483, 28.800098965565354, 28.80147590736547, 28.48862193028131, 26.769356238345296, 26.950674350062997, 26.724920901159436, 18.808719183007867, 18.820356133083493, 18.945577817658574, 19.692549735307693, 20.27492063306272, 20.28857439942658, 18.106265763441712, 18.05849878738323, 18.30071920218566, 17.793507911264896, 17.61222694069147, 17.943665930069983, 19.16860497199619, 19.150522927443177, 19.130720727766544, 10.018109341462448, 9.796342586477593, 10.445578058560685, 17.147704268495232, 17.660775034377963, 17.66850418287018, 6.689867367347077, 7.874047867332891, 7.658026618262127, 21.542141515761614, 20.948598593473434, 21.191573090851307, 24.910272233188152, 25.359405394643545, 25.04649429023266, 22.161205641925335, 21.189401865005493, 21.895552322268486, 22.449150875831634, 21.99749695012966, 21.93719411144653, 23.181097621719033, 23.182397636274487, 23.374194831276924, 23.14730546499291, 23.14274965847531, 23.319552508803696, 16.86861229936281, 17.290920520822198, 16.93490808705488, 10.828624884287507, 10.919912452499062, 11.592989177132637, 27.509580766161278, 27.939192493756607, 27.833726209898785, 8.743045220772416, 8.015016506115586, 8.775794918338448, 13.962125643466905, 13.509024647374943, 13.483043317993477, 24.826640921334416, 24.749175558487565, 24.705802152554185, 23.129214038451508, 24.03905412818615, 23.452616473038987, 0.1814594765504154, -0.040245513121291765, 0.3827182849248203, 15.596539323528603, 16.592958757032946, 16.00948566695054, 28.753732329855353, 28.917589586849004, 28.87721514205137, 12.931644022464752, 12.728503495454788, 13.18064296618104, 20.90313297510147, 21.595604073256254, 21.449804425239563, 23.162414520978928, 23.57690693438053, 23.67589993029833, 15.856749081363276, 15.903952625890568, 15.126205851634339, 15.015858732163906, 15.05803071334958, 15.039323963224888, 20.966898679733276, 21.672643341124058, 21.234485685825348, 26.120114281773567, 25.896103337407112, 26.61286378465593, -106.05837627251944, -90.55618608308336, -90.5136523762097, 30.25456983533998, 30.289707899171233, 30.25831282542397, 30.893241261442498, 31.359947399546698, 31.304112171133355, 17.68486651778221, 18.511201173067093, 18.95780566567555, 21.21984152247508, 19.795181324084595, 21.401166349028543, 12.212679952383041, 12.482619553804398, 13.263129692524672, 21.188081686695412, 21.62721315150459, 21.564725430061415, 21.417756254474313, 21.417951385180146, 22.043338293830544, 21.967802295150847, 20.86031952003637, 21.61262189100185, 18.534818296631173, 18.927121763428048, 19.058222011973456, 19.640585258603096, 19.826041404157877, 19.571060985326767, 15.674842024842889, 15.226657489935548, 15.94100556957224, 20.06501994530359, 21.005113790432603, 20.518267820278794, 15.899148260553673, 16.19876938251157, 16.05159369607766, 26.890895929187536, 27.063916956773028, 27.025122869759798, 16.746919684112072, 16.60459493100643, 16.98275600373745, 23.132051895683006, 21.91170074542363, 22.80495588233073, 24.730348234375313, 25.27002031107743, 25.53425308441122, 13.417959613104657, 13.551232059796646, 13.709198654939726, 11.058476428190858, 10.683508301774651, 10.515587935845048, 25.49773469567299, 25.899982675909996, 25.690870881080627, 21.610992756361753, 21.257372359434754, 21.342512174199015, 9.343710151811436, 9.550555200626448, 9.780160418090716, 13.143905008832604, 13.870674127169565, 13.802274031254143, 23.131767122695834, 23.17345796401301, 22.788151542345673, 13.232409053792551, 12.9342067365845, 13.183993411560849, 21.72249412536621, 22.66244172025472, 22.643006149679422, 14.739266547684863, 14.780367433403924, 14.415073317786053, 2.9060216049353187, 3.4297989313878645, 2.3486114839712684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15317630012667738, "mean_inference_ms": 0.7050377613515917, "mean_action_processing_ms": 0.10001919544394651, "mean_env_wait_ms": 0.8076502723027151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1928394, "timesteps_this_iter": 0, "agent_timesteps_total": 5785182, "timers": {"sample_time_ms": 20709.88, "sample_throughput": 463.257, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3036.795, "learn_throughput": 3159.251, "update_time_ms": 8.392}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 40.63991689682007, "policy_loss": -0.000892373374298927, "vf_loss": 40.84269571304321, "vf_explained_var": 0.1465938612818718, "kl": 0.014345799107498728, "entropy": 20.1886785030365, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1928394, "num_agent_steps_sampled": 5785182, "num_steps_trained": 1928394, "num_agent_steps_trained": 5785182, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7243, "training_iteration": 201, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-51-01", "timestamp": 1706194261, "time_this_iter_s": 20.902442932128906, "time_total_s": 4058.166750907898, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004B91F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4058.166750907898, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 8.727586206896552, "ram_util_percent": 53.134482758620685}}
{"episode_reward_max": 107.25761610083279, "episode_reward_min": -287.1282147318125, "episode_reward_mean": 50.72202871119661, "episode_len_mean": 296.41, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -106.05837627251944}, "policy_reward_max": {"shared_policy": 36.00236048611501}, "policy_reward_mean": {"shared_policy": 16.9073429037322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.584749516099677, 62.05094153806564, 68.7969997320324, 86.09019680321214, 80.44495148956773, 56.57465313374993, 60.25604476779699, 54.4654837530106, 53.34940078202635, 57.44984862720591, 30.260029986500726, 52.476983485743375, 22.221941852942095, 63.682313200086355, 75.31617191806436, 65.24615982919931, 66.38384193740782, 69.73769008927044, 69.60960763227192, 51.094440907239886, 33.341526513919206, 83.28249946981667, 25.53385664522645, 40.954193608835325, 74.28161863237617, 70.62088463967665, 0.5239322483539439, 48.19898374751209, 86.54853705875573, 38.84079048410058, 63.94854147359729, 70.41522138565779, 46.88690755888818, 45.113213408738375, 63.87402770668268, 78.62908140383661, -287.1282147318125, 90.80259055993518, 93.55730083212255, 55.153873356524855, 62.41618919558822, 37.95842919871211, 64.38002026826142, 64.879045933485, 64.44074370618907, 56.520162072032676, 59.03768764808774, 46.84250508435068, 61.588401556014986, 48.149511339142904, 80.97993575572036, 50.33427061885595, 67.84870852343737, 75.53462162986396, 40.67839032784103, 32.25757266581056, 77.08858825266361, 64.21087728999552, 28.6744257705286, 40.81685316725631, 69.09337662905452, 39.3506092019379, 67.02794199530035, 43.93470729887484, 8.684432020294452, 76.56307108514011, 43.35611525736748, 53.40529811475426, 83.93591602146626, 57.0893725429778, 56.05230108462273, 33.72514391527511, 56.860731560736895, 56.622067864984274, 36.01070026122032, 84.09566439315677, 64.28293554857373, 32.51685221493241, 68.11510183289646, 107.25761610083279, 80.4936189474538, 80.85462423786518, 36.805658051744075, 43.74925002083182, 37.33106693392618, 78.39326992130371, 68.3911755159497, 49.83910318091512, 46.193981250748024, 66.06859219446775, 60.89288932457566, 59.16420637979172, 49.28708652406931, 47.99701337143779, 16.190771477296934, 46.7516821809113, 71.68083172477779, 71.27112351357937, 28.137185118161113, -228.378970682621], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 169], "policy_shared_policy_reward": [9.622510587175682, 10.132524044563368, 9.829714884360627, 20.342633987466485, 20.399217943350465, 21.309089607248694, 23.266227915262178, 22.627767612536744, 22.903004204233483, 28.800098965565354, 28.80147590736547, 28.48862193028131, 26.769356238345296, 26.950674350062997, 26.724920901159436, 18.808719183007867, 18.820356133083493, 18.945577817658574, 19.692549735307693, 20.27492063306272, 20.28857439942658, 18.106265763441712, 18.05849878738323, 18.30071920218566, 17.793507911264896, 17.61222694069147, 17.943665930069983, 19.16860497199619, 19.150522927443177, 19.130720727766544, 10.018109341462448, 9.796342586477593, 10.445578058560685, 17.147704268495232, 17.660775034377963, 17.66850418287018, 6.689867367347077, 7.874047867332891, 7.658026618262127, 21.542141515761614, 20.948598593473434, 21.191573090851307, 24.910272233188152, 25.359405394643545, 25.04649429023266, 22.161205641925335, 21.189401865005493, 21.895552322268486, 22.449150875831634, 21.99749695012966, 21.93719411144653, 23.181097621719033, 23.182397636274487, 23.374194831276924, 23.14730546499291, 23.14274965847531, 23.319552508803696, 16.86861229936281, 17.290920520822198, 16.93490808705488, 10.828624884287507, 10.919912452499062, 11.592989177132637, 27.509580766161278, 27.939192493756607, 27.833726209898785, 8.743045220772416, 8.015016506115586, 8.775794918338448, 13.962125643466905, 13.509024647374943, 13.483043317993477, 24.826640921334416, 24.749175558487565, 24.705802152554185, 23.129214038451508, 24.03905412818615, 23.452616473038987, 0.1814594765504154, -0.040245513121291765, 0.3827182849248203, 15.596539323528603, 16.592958757032946, 16.00948566695054, 28.753732329855353, 28.917589586849004, 28.87721514205137, 12.931644022464752, 12.728503495454788, 13.18064296618104, 20.90313297510147, 21.595604073256254, 21.449804425239563, 23.162414520978928, 23.57690693438053, 23.67589993029833, 15.856749081363276, 15.903952625890568, 15.126205851634339, 15.015858732163906, 15.05803071334958, 15.039323963224888, 20.966898679733276, 21.672643341124058, 21.234485685825348, 26.120114281773567, 25.896103337407112, 26.61286378465593, -106.05837627251944, -90.55618608308336, -90.5136523762097, 30.25456983533998, 30.289707899171233, 30.25831282542397, 30.893241261442498, 31.359947399546698, 31.304112171133355, 17.68486651778221, 18.511201173067093, 18.95780566567555, 21.21984152247508, 19.795181324084595, 21.401166349028543, 12.212679952383041, 12.482619553804398, 13.263129692524672, 21.188081686695412, 21.62721315150459, 21.564725430061415, 21.417756254474313, 21.417951385180146, 22.043338293830544, 21.967802295150847, 20.86031952003637, 21.61262189100185, 18.534818296631173, 18.927121763428048, 19.058222011973456, 19.640585258603096, 19.826041404157877, 19.571060985326767, 15.674842024842889, 15.226657489935548, 15.94100556957224, 20.06501994530359, 21.005113790432603, 20.518267820278794, 15.899148260553673, 16.19876938251157, 16.05159369607766, 26.890895929187536, 27.063916956773028, 27.025122869759798, 16.746919684112072, 16.60459493100643, 16.98275600373745, 23.132051895683006, 21.91170074542363, 22.80495588233073, 24.730348234375313, 25.27002031107743, 25.53425308441122, 13.417959613104657, 13.551232059796646, 13.709198654939726, 11.058476428190858, 10.683508301774651, 10.515587935845048, 25.49773469567299, 25.899982675909996, 25.690870881080627, 21.610992756361753, 21.257372359434754, 21.342512174199015, 9.343710151811436, 9.550555200626448, 9.780160418090716, 13.143905008832604, 13.870674127169565, 13.802274031254143, 23.131767122695834, 23.17345796401301, 22.788151542345673, 13.232409053792551, 12.9342067365845, 13.183993411560849, 21.72249412536621, 22.66244172025472, 22.643006149679422, 14.739266547684863, 14.780367433403924, 14.415073317786053, 2.9060216049353187, 3.4297989313878645, 2.3486114839712684, 25.71537342481315, 25.22024405747652, 25.627453602850437, 14.227201556166008, 14.181169187029198, 14.947744514172271, 17.48514299094677, 17.795464739203453, 18.124690384604037, 27.81483532488346, 28.21595200896263, 27.905128687620163, 18.950084876269102, 19.16771285730647, 18.971574809402227, 18.982456955437854, 18.133157720168427, 18.936686409016446, 11.59538670629263, 11.961129827657714, 10.168627381324768, 18.663823753595352, 19.13771817460656, 19.05918963253498, 18.26262818276882, 19.249454379081726, 19.109985303133726, 12.028829960462943, 12.030773099822298, 11.95109720093508, 28.352508295327425, 27.94088675826788, 27.802269339561462, 21.199944704771042, 21.355176880955696, 21.727813962846994, 10.584049339095742, 10.950959439078957, 10.981843436757714, 22.527398859461144, 23.00124831621845, 22.586454657216862, 36.00236048611501, 35.55110840747753, 35.704147207240254, 26.301156774163246, 27.491153341718018, 26.701308831572533, 27.08748851219812, 26.680785941580922, 27.08634978408614, 12.455517488221318, 11.955737608174474, 12.394402955348284, 14.54174592345953, 14.748280543833971, 14.459223553538322, 12.533043680091694, 12.551400269226477, 12.24662298460801, 26.224034986303494, 26.24548857515522, 25.923746359844998, 22.690912219385297, 22.663208390275628, 23.037054906288773, 17.135190304368734, 15.659950256347656, 17.043962620198727, 15.748391631369785, 15.438189548750714, 15.007400070627526, 22.376359208176524, 21.69644349316755, 21.99578949312368, 20.19729981571436, 20.273807667195797, 20.421781841665506, 19.83949465677142, 20.019949389388785, 19.304762333631516, 16.538560826331377, 16.656330067664385, 16.092195630073547, 15.686516135931015, 16.192691780626774, 16.11780545488, 5.015565296014145, 5.754862948631242, 5.420343232651547, 15.772581212222576, 15.180956721305847, 15.79814424738288, 23.89297322432199, 23.687392781178147, 24.10046571927765, 23.627869784832, 23.97994428873062, 23.663309440016747, 9.30590860421458, 9.392465221385152, 9.438811292561383, -70.40641681104898, -87.1230937242508, -70.84946014732122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531217334153854, "mean_inference_ms": 0.7048915774076057, "mean_action_processing_ms": 0.09995634973973579, "mean_env_wait_ms": 0.8075924539397912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1937988, "timesteps_this_iter": 0, "agent_timesteps_total": 5813964, "timers": {"sample_time_ms": 20692.715, "sample_throughput": 463.641, "load_time_ms": 0.199, "load_throughput": 48313306.01, "learn_time_ms": 3027.373, "learn_throughput": 3169.084, "update_time_ms": 8.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 50.16617250442505, "policy_loss": -0.0004015464802376023, "vf_loss": 50.36270189285278, "vf_explained_var": 0.07218274474143982, "kl": 0.007243359316283114, "entropy": 19.612659215927124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1937988, "num_agent_steps_sampled": 5813964, "num_steps_trained": 1937988, "num_agent_steps_trained": 5813964, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7278, "training_iteration": 202, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-51-21", "timestamp": 1706194281, "time_this_iter_s": 19.745840787887573, "time_total_s": 4077.9125916957855, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4077.9125916957855, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 9.135714285714284, "ram_util_percent": 53.0}}
{"episode_reward_max": 107.25761610083279, "episode_reward_min": -287.1282147318125, "episode_reward_mean": 50.7119343127287, "episode_len_mean": 296.41, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -106.05837627251944}, "policy_reward_max": {"shared_policy": 36.00236048611501}, "policy_reward_mean": {"shared_policy": 16.903978104242896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.94854147359729, 70.41522138565779, 46.88690755888818, 45.113213408738375, 63.87402770668268, 78.62908140383661, -287.1282147318125, 90.80259055993518, 93.55730083212255, 55.153873356524855, 62.41618919558822, 37.95842919871211, 64.38002026826142, 64.879045933485, 64.44074370618907, 56.520162072032676, 59.03768764808774, 46.84250508435068, 61.588401556014986, 48.149511339142904, 80.97993575572036, 50.33427061885595, 67.84870852343737, 75.53462162986396, 40.67839032784103, 32.25757266581056, 77.08858825266361, 64.21087728999552, 28.6744257705286, 40.81685316725631, 69.09337662905452, 39.3506092019379, 67.02794199530035, 43.93470729887484, 8.684432020294452, 76.56307108514011, 43.35611525736748, 53.40529811475426, 83.93591602146626, 57.0893725429778, 56.05230108462273, 33.72514391527511, 56.860731560736895, 56.622067864984274, 36.01070026122032, 84.09566439315677, 64.28293554857373, 32.51685221493241, 68.11510183289646, 107.25761610083279, 80.4936189474538, 80.85462423786518, 36.805658051744075, 43.74925002083182, 37.33106693392618, 78.39326992130371, 68.3911755159497, 49.83910318091512, 46.193981250748024, 66.06859219446775, 60.89288932457566, 59.16420637979172, 49.28708652406931, 47.99701337143779, 16.190771477296934, 46.7516821809113, 71.68083172477779, 71.27112351357937, 28.137185118161113, -228.378970682621, 71.7975171646103, 70.20260296203196, -27.54536747559905, 47.40775463823228, 66.06237757205963, 31.12975008506325, 62.84069328382611, 67.79190920107065, 88.37152482569215, 69.65869422070682, 69.21449818834662, 68.24139215238391, 66.6577450626646, 51.10071637900543, 69.44096498191357, 59.2567310128361, 74.51960078056436, 47.24946049973367, 21.996394958347054, 47.20786253362894, 77.48325656726956, 69.18679369986057, 24.152496617287397, 54.313101023435564, 65.48989048227668, 56.753557078540325, 30.696944992989273, 59.433066714555, 56.41466969996688, 59.683234279975295], "episode_lengths": [300, 300, 300, 300, 300, 300, 72, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 169, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.90313297510147, 21.595604073256254, 21.449804425239563, 23.162414520978928, 23.57690693438053, 23.67589993029833, 15.856749081363276, 15.903952625890568, 15.126205851634339, 15.015858732163906, 15.05803071334958, 15.039323963224888, 20.966898679733276, 21.672643341124058, 21.234485685825348, 26.120114281773567, 25.896103337407112, 26.61286378465593, -106.05837627251944, -90.55618608308336, -90.5136523762097, 30.25456983533998, 30.289707899171233, 30.25831282542397, 30.893241261442498, 31.359947399546698, 31.304112171133355, 17.68486651778221, 18.511201173067093, 18.95780566567555, 21.21984152247508, 19.795181324084595, 21.401166349028543, 12.212679952383041, 12.482619553804398, 13.263129692524672, 21.188081686695412, 21.62721315150459, 21.564725430061415, 21.417756254474313, 21.417951385180146, 22.043338293830544, 21.967802295150847, 20.86031952003637, 21.61262189100185, 18.534818296631173, 18.927121763428048, 19.058222011973456, 19.640585258603096, 19.826041404157877, 19.571060985326767, 15.674842024842889, 15.226657489935548, 15.94100556957224, 20.06501994530359, 21.005113790432603, 20.518267820278794, 15.899148260553673, 16.19876938251157, 16.05159369607766, 26.890895929187536, 27.063916956773028, 27.025122869759798, 16.746919684112072, 16.60459493100643, 16.98275600373745, 23.132051895683006, 21.91170074542363, 22.80495588233073, 24.730348234375313, 25.27002031107743, 25.53425308441122, 13.417959613104657, 13.551232059796646, 13.709198654939726, 11.058476428190858, 10.683508301774651, 10.515587935845048, 25.49773469567299, 25.899982675909996, 25.690870881080627, 21.610992756361753, 21.257372359434754, 21.342512174199015, 9.343710151811436, 9.550555200626448, 9.780160418090716, 13.143905008832604, 13.870674127169565, 13.802274031254143, 23.131767122695834, 23.17345796401301, 22.788151542345673, 13.232409053792551, 12.9342067365845, 13.183993411560849, 21.72249412536621, 22.66244172025472, 22.643006149679422, 14.739266547684863, 14.780367433403924, 14.415073317786053, 2.9060216049353187, 3.4297989313878645, 2.3486114839712684, 25.71537342481315, 25.22024405747652, 25.627453602850437, 14.227201556166008, 14.181169187029198, 14.947744514172271, 17.48514299094677, 17.795464739203453, 18.124690384604037, 27.81483532488346, 28.21595200896263, 27.905128687620163, 18.950084876269102, 19.16771285730647, 18.971574809402227, 18.982456955437854, 18.133157720168427, 18.936686409016446, 11.59538670629263, 11.961129827657714, 10.168627381324768, 18.663823753595352, 19.13771817460656, 19.05918963253498, 18.26262818276882, 19.249454379081726, 19.109985303133726, 12.028829960462943, 12.030773099822298, 11.95109720093508, 28.352508295327425, 27.94088675826788, 27.802269339561462, 21.199944704771042, 21.355176880955696, 21.727813962846994, 10.584049339095742, 10.950959439078957, 10.981843436757714, 22.527398859461144, 23.00124831621845, 22.586454657216862, 36.00236048611501, 35.55110840747753, 35.704147207240254, 26.301156774163246, 27.491153341718018, 26.701308831572533, 27.08748851219812, 26.680785941580922, 27.08634978408614, 12.455517488221318, 11.955737608174474, 12.394402955348284, 14.54174592345953, 14.748280543833971, 14.459223553538322, 12.533043680091694, 12.551400269226477, 12.24662298460801, 26.224034986303494, 26.24548857515522, 25.923746359844998, 22.690912219385297, 22.663208390275628, 23.037054906288773, 17.135190304368734, 15.659950256347656, 17.043962620198727, 15.748391631369785, 15.438189548750714, 15.007400070627526, 22.376359208176524, 21.69644349316755, 21.99578949312368, 20.19729981571436, 20.273807667195797, 20.421781841665506, 19.83949465677142, 20.019949389388785, 19.304762333631516, 16.538560826331377, 16.656330067664385, 16.092195630073547, 15.686516135931015, 16.192691780626774, 16.11780545488, 5.015565296014145, 5.754862948631242, 5.420343232651547, 15.772581212222576, 15.180956721305847, 15.79814424738288, 23.89297322432199, 23.687392781178147, 24.10046571927765, 23.627869784832, 23.97994428873062, 23.663309440016747, 9.30590860421458, 9.392465221385152, 9.438811292561383, -70.40641681104898, -87.1230937242508, -70.84946014732122, 24.136104015323014, 23.584808255235345, 24.07660489405194, 23.0739254206419, 23.483682077378035, 23.644995464012027, -9.021438371390104, -9.15431122481823, -9.369617879390717, 16.169629704517618, 15.104736497004822, 16.133388436709836, 22.13644238561392, 21.744349882006645, 22.181585304439068, 10.492021567809076, 10.33509339268008, 10.302635124574095, 20.99819242581725, 20.985649205744267, 20.856851652264595, 21.945305754741028, 22.99350615528722, 22.853097291042403, 28.848423863450677, 29.691314602891595, 29.831786359349877, 22.774236127734184, 23.57165995053947, 23.312798142433167, 22.637793332338333, 23.44290566071868, 23.133799195289612, 22.820514223848775, 22.887518626948193, 22.53335930158694, 21.84816326697667, 22.554545470183555, 22.255036325504378, 17.507478444992245, 17.40274830410877, 16.19048962990442, 23.018348067998886, 23.01425226032734, 23.40836465358734, 19.19766327738762, 19.903832249343395, 20.155235486105084, 25.062073104083538, 24.133834064006805, 25.323693612474017, 15.282258962591484, 16.262791411330298, 15.70441012581189, 7.207406530777604, 7.3598359754929845, 7.429152452076465, 14.716239839792252, 16.362756572663784, 16.128866121172905, 25.504739984869957, 25.50620499253273, 26.472311589866877, 22.888535007834435, 23.124116303399205, 23.174142388626933, 7.820359602570534, 7.682950407266617, 8.649186607450247, 18.250383536020905, 18.02155005435148, 18.04116743306318, 21.52044054120779, 22.02317863702774, 21.946271304041147, 18.8093898370862, 19.173206940293312, 18.770960301160812, 10.164032655457646, 10.430933109174163, 10.101979228357465, 20.100146780411393, 19.106113264958054, 20.22680666918555, 18.51361087958017, 18.930031987527997, 18.971026832858712, 19.726450607180595, 20.12471959553659, 19.83206407725811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15317033606304903, "mean_inference_ms": 0.7051700034183142, "mean_action_processing_ms": 0.10002811673628656, "mean_env_wait_ms": 0.8078144005030614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1947582, "timesteps_this_iter": 0, "agent_timesteps_total": 5842746, "timers": {"sample_time_ms": 20695.735, "sample_throughput": 463.574, "load_time_ms": 0.106, "load_throughput": 90427309.16, "learn_time_ms": 3016.068, "learn_throughput": 3180.963, "update_time_ms": 8.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 6.947637915611267, "policy_loss": -0.0006853372008225334, "vf_loss": 7.145694732666016, "vf_explained_var": 0.12604570388793945, "kl": 0.005631766689852356, "entropy": 19.73714280128479, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1947582, "num_agent_steps_sampled": 5842746, "num_steps_trained": 1947582, "num_agent_steps_trained": 5842746, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7308, "training_iteration": 203, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-51-41", "timestamp": 1706194301, "time_this_iter_s": 20.01575756072998, "time_total_s": 4097.9283492565155, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4097.9283492565155, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 10.382142857142854, "ram_util_percent": 53.08214285714286}}
{"episode_reward_max": 107.25761610083279, "episode_reward_min": -262.78974650334567, "episode_reward_mean": 50.24514160737395, "episode_len_mean": 297.32, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -96.83596394459407}, "policy_reward_max": {"shared_policy": 36.00236048611501}, "policy_reward_mean": {"shared_policy": 16.748380535791313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.684432020294452, 76.56307108514011, 43.35611525736748, 53.40529811475426, 83.93591602146626, 57.0893725429778, 56.05230108462273, 33.72514391527511, 56.860731560736895, 56.622067864984274, 36.01070026122032, 84.09566439315677, 64.28293554857373, 32.51685221493241, 68.11510183289646, 107.25761610083279, 80.4936189474538, 80.85462423786518, 36.805658051744075, 43.74925002083182, 37.33106693392618, 78.39326992130371, 68.3911755159497, 49.83910318091512, 46.193981250748024, 66.06859219446775, 60.89288932457566, 59.16420637979172, 49.28708652406931, 47.99701337143779, 16.190771477296934, 46.7516821809113, 71.68083172477779, 71.27112351357937, 28.137185118161113, -228.378970682621, 71.7975171646103, 70.20260296203196, -27.54536747559905, 47.40775463823228, 66.06237757205963, 31.12975008506325, 62.84069328382611, 67.79190920107065, 88.37152482569215, 69.65869422070682, 69.21449818834662, 68.24139215238391, 66.6577450626646, 51.10071637900543, 69.44096498191357, 59.2567310128361, 74.51960078056436, 47.24946049973367, 21.996394958347054, 47.20786253362894, 77.48325656726956, 69.18679369986057, 24.152496617287397, 54.313101023435564, 65.48989048227668, 56.753557078540325, 30.696944992989273, 59.433066714555, 56.41466969996688, 59.683234279975295, 66.98441508784887, 73.34863607585429, 55.095467407256336, 77.4327709712088, 62.40765944961457, 60.93886709958312, 68.10922074876723, 60.55033574998376, 90.29985681921241, 42.434491815045476, 39.09471329301596, 53.74711302667855, 75.05279540270567, 80.13959204405545, 93.26174199581145, 10.458087444305392, 81.34139301255345, 37.85829889401792, 14.042372034862623, 77.72882229089736, 46.43804321065544, 69.91944482550025, 66.82381160743533, 78.88359507173297, -13.856592953205137, 67.8202212527394, 63.23858318850395, 35.03492205590008, 72.86317983642219, -262.78974650334567, 34.59698648937045, 54.91786687076089, 32.6770732132718, 51.722808718681335], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 169, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 163, 300, 300, 300, 300], "policy_shared_policy_reward": [2.9060216049353187, 3.4297989313878645, 2.3486114839712684, 25.71537342481315, 25.22024405747652, 25.627453602850437, 14.227201556166008, 14.181169187029198, 14.947744514172271, 17.48514299094677, 17.795464739203453, 18.124690384604037, 27.81483532488346, 28.21595200896263, 27.905128687620163, 18.950084876269102, 19.16771285730647, 18.971574809402227, 18.982456955437854, 18.133157720168427, 18.936686409016446, 11.59538670629263, 11.961129827657714, 10.168627381324768, 18.663823753595352, 19.13771817460656, 19.05918963253498, 18.26262818276882, 19.249454379081726, 19.109985303133726, 12.028829960462943, 12.030773099822298, 11.95109720093508, 28.352508295327425, 27.94088675826788, 27.802269339561462, 21.199944704771042, 21.355176880955696, 21.727813962846994, 10.584049339095742, 10.950959439078957, 10.981843436757714, 22.527398859461144, 23.00124831621845, 22.586454657216862, 36.00236048611501, 35.55110840747753, 35.704147207240254, 26.301156774163246, 27.491153341718018, 26.701308831572533, 27.08748851219812, 26.680785941580922, 27.08634978408614, 12.455517488221318, 11.955737608174474, 12.394402955348284, 14.54174592345953, 14.748280543833971, 14.459223553538322, 12.533043680091694, 12.551400269226477, 12.24662298460801, 26.224034986303494, 26.24548857515522, 25.923746359844998, 22.690912219385297, 22.663208390275628, 23.037054906288773, 17.135190304368734, 15.659950256347656, 17.043962620198727, 15.748391631369785, 15.438189548750714, 15.007400070627526, 22.376359208176524, 21.69644349316755, 21.99578949312368, 20.19729981571436, 20.273807667195797, 20.421781841665506, 19.83949465677142, 20.019949389388785, 19.304762333631516, 16.538560826331377, 16.656330067664385, 16.092195630073547, 15.686516135931015, 16.192691780626774, 16.11780545488, 5.015565296014145, 5.754862948631242, 5.420343232651547, 15.772581212222576, 15.180956721305847, 15.79814424738288, 23.89297322432199, 23.687392781178147, 24.10046571927765, 23.627869784832, 23.97994428873062, 23.663309440016747, 9.30590860421458, 9.392465221385152, 9.438811292561383, -70.40641681104898, -87.1230937242508, -70.84946014732122, 24.136104015323014, 23.584808255235345, 24.07660489405194, 23.0739254206419, 23.483682077378035, 23.644995464012027, -9.021438371390104, -9.15431122481823, -9.369617879390717, 16.169629704517618, 15.104736497004822, 16.133388436709836, 22.13644238561392, 21.744349882006645, 22.181585304439068, 10.492021567809076, 10.33509339268008, 10.302635124574095, 20.99819242581725, 20.985649205744267, 20.856851652264595, 21.945305754741028, 22.99350615528722, 22.853097291042403, 28.848423863450677, 29.691314602891595, 29.831786359349877, 22.774236127734184, 23.57165995053947, 23.312798142433167, 22.637793332338333, 23.44290566071868, 23.133799195289612, 22.820514223848775, 22.887518626948193, 22.53335930158694, 21.84816326697667, 22.554545470183555, 22.255036325504378, 17.507478444992245, 17.40274830410877, 16.19048962990442, 23.018348067998886, 23.01425226032734, 23.40836465358734, 19.19766327738762, 19.903832249343395, 20.155235486105084, 25.062073104083538, 24.133834064006805, 25.323693612474017, 15.282258962591484, 16.262791411330298, 15.70441012581189, 7.207406530777604, 7.3598359754929845, 7.429152452076465, 14.716239839792252, 16.362756572663784, 16.128866121172905, 25.504739984869957, 25.50620499253273, 26.472311589866877, 22.888535007834435, 23.124116303399205, 23.174142388626933, 7.820359602570534, 7.682950407266617, 8.649186607450247, 18.250383536020905, 18.02155005435148, 18.04116743306318, 21.52044054120779, 22.02317863702774, 21.946271304041147, 18.8093898370862, 19.173206940293312, 18.770960301160812, 10.164032655457646, 10.430933109174163, 10.101979228357465, 20.100146780411393, 19.106113264958054, 20.22680666918555, 18.51361087958017, 18.930031987527997, 18.971026832858712, 19.726450607180595, 20.12471959553659, 19.83206407725811, 21.756226326028496, 22.644535367066652, 22.583653394753725, 24.54328815390666, 24.202640642722443, 24.602707279225186, 18.541441552961857, 18.493229739988834, 18.060796114305646, 25.449060847361878, 25.99095319708188, 25.99275692676504, 21.132642017987862, 20.27560258408387, 20.999414847542837, 20.214852179090173, 20.35768416772285, 20.366330752770097, 22.508268768588692, 22.763799822578818, 22.837152157599718, 19.842602173487336, 20.165885249773652, 20.54184832672277, 30.081568437317998, 29.984870108465344, 30.233418273429066, 13.798750326037407, 14.4599928278476, 14.175748661160469, 13.312026970088482, 12.753441259264946, 13.029245063662529, 17.780346875389412, 18.10772259285052, 17.859043558438614, 25.07720036804676, 25.18050717562437, 24.79508785903454, 27.024068315823868, 26.10212244590123, 27.01340128233035, 31.21444529232879, 30.887334321935967, 31.15996238154669, 3.928027043739945, 3.135396132866532, 3.3946642676989143, 27.210388910025358, 27.236045859754086, 26.89495824277401, 12.304782410462693, 12.797695779552058, 12.75582070400317, 4.981488275652126, 4.895271265258387, 4.165612493952111, 25.719249342878655, 25.93639737119277, 26.073175576825932, 15.41180122022827, 15.47693546240528, 15.549306528021887, 23.120417706668377, 23.29077586531639, 23.508251253515482, 22.223392722507313, 22.70660069522758, 21.89381818970044, 26.32848389322558, 26.33819509173432, 26.216916086773068, -4.188486102347582, -5.534290631612151, -4.1338162192454035, 22.300618598858506, 23.22855410228172, 22.291048551599175, 20.998231085638196, 21.127623605231435, 21.112728497634322, 11.880011742313698, 11.436802109082535, 11.71810820450385, 24.672494449963168, 24.149034967025116, 24.041650419433907, -96.83596394459407, -83.25799203912418, -82.69579051962744, 12.081598527108625, 10.740794976552323, 11.774592985709504, 18.54003298530975, 18.304521809021622, 18.073312076429517, 10.500275045633316, 10.90169433504343, 11.27510383259505, 17.364946596324444, 16.95544394850731, 17.402418173849583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311254282181058, "mean_inference_ms": 0.7049459365934874, "mean_action_processing_ms": 0.09994170986729843, "mean_env_wait_ms": 0.8076504279796702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1957176, "timesteps_this_iter": 0, "agent_timesteps_total": 5871528, "timers": {"sample_time_ms": 20619.182, "sample_throughput": 465.295, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3012.172, "learn_throughput": 3185.077, "update_time_ms": 8.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 48.56635236740112, "policy_loss": -0.0019474784779638377, "vf_loss": 48.76477098464966, "vf_explained_var": 0.19640261679887772, "kl": 0.01141841546670145, "entropy": 19.647152423858643, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1957176, "num_agent_steps_sampled": 5871528, "num_steps_trained": 1957176, "num_agent_steps_trained": 5871528, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7342, "training_iteration": 204, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-52-01", "timestamp": 1706194321, "time_this_iter_s": 19.975087881088257, "time_total_s": 4117.903437137604, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175CC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4117.903437137604, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 9.660714285714283, "ram_util_percent": 53.31071428571429}}
{"episode_reward_max": 93.26174199581145, "episode_reward_min": -262.78974650334567, "episode_reward_mean": 49.9974320059031, "episode_len_mean": 297.32, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -96.83596394459407}, "policy_reward_max": {"shared_policy": 31.21444529232879}, "policy_reward_mean": {"shared_policy": 16.665810668634364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.7516821809113, 71.68083172477779, 71.27112351357937, 28.137185118161113, -228.378970682621, 71.7975171646103, 70.20260296203196, -27.54536747559905, 47.40775463823228, 66.06237757205963, 31.12975008506325, 62.84069328382611, 67.79190920107065, 88.37152482569215, 69.65869422070682, 69.21449818834662, 68.24139215238391, 66.6577450626646, 51.10071637900543, 69.44096498191357, 59.2567310128361, 74.51960078056436, 47.24946049973367, 21.996394958347054, 47.20786253362894, 77.48325656726956, 69.18679369986057, 24.152496617287397, 54.313101023435564, 65.48989048227668, 56.753557078540325, 30.696944992989273, 59.433066714555, 56.41466969996688, 59.683234279975295, 66.98441508784887, 73.34863607585429, 55.095467407256336, 77.4327709712088, 62.40765944961457, 60.93886709958312, 68.10922074876723, 60.55033574998376, 90.29985681921241, 42.434491815045476, 39.09471329301596, 53.74711302667855, 75.05279540270567, 80.13959204405545, 93.26174199581145, 10.458087444305392, 81.34139301255345, 37.85829889401792, 14.042372034862623, 77.72882229089736, 46.43804321065544, 69.91944482550025, 66.82381160743533, 78.88359507173297, -13.856592953205137, 67.8202212527394, 63.23858318850395, 35.03492205590008, 72.86317983642219, -262.78974650334567, 34.59698648937045, 54.91786687076089, 32.6770732132718, 51.722808718681335, 36.608126904815435, 53.74301326856947, 79.43042436987162, 68.84102388098836, 58.30312499497086, 8.116220502182841, 62.55364527180791, 71.13990906253456, 50.363491043448434, 8.78734100982544, -52.19409997016194, 79.7652181284502, 65.18688254803418, 59.99482950102538, 73.11002978682517, 9.744357516989098, 55.73876435123384, 66.14146725228055, 69.94007213530129, 57.5940682888031, 58.52644664607942, 78.343136459589, 61.990298399701715, 45.20013591833411, 85.22576199099422, 64.31438358128068, 65.03455525636672, 53.49770998582244, 85.1357378743123, 53.81900325417517, 81.45958779007194], "episode_lengths": [300, 300, 300, 300, 169, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 163, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [15.772581212222576, 15.180956721305847, 15.79814424738288, 23.89297322432199, 23.687392781178147, 24.10046571927765, 23.627869784832, 23.97994428873062, 23.663309440016747, 9.30590860421458, 9.392465221385152, 9.438811292561383, -70.40641681104898, -87.1230937242508, -70.84946014732122, 24.136104015323014, 23.584808255235345, 24.07660489405194, 23.0739254206419, 23.483682077378035, 23.644995464012027, -9.021438371390104, -9.15431122481823, -9.369617879390717, 16.169629704517618, 15.104736497004822, 16.133388436709836, 22.13644238561392, 21.744349882006645, 22.181585304439068, 10.492021567809076, 10.33509339268008, 10.302635124574095, 20.99819242581725, 20.985649205744267, 20.856851652264595, 21.945305754741028, 22.99350615528722, 22.853097291042403, 28.848423863450677, 29.691314602891595, 29.831786359349877, 22.774236127734184, 23.57165995053947, 23.312798142433167, 22.637793332338333, 23.44290566071868, 23.133799195289612, 22.820514223848775, 22.887518626948193, 22.53335930158694, 21.84816326697667, 22.554545470183555, 22.255036325504378, 17.507478444992245, 17.40274830410877, 16.19048962990442, 23.018348067998886, 23.01425226032734, 23.40836465358734, 19.19766327738762, 19.903832249343395, 20.155235486105084, 25.062073104083538, 24.133834064006805, 25.323693612474017, 15.282258962591484, 16.262791411330298, 15.70441012581189, 7.207406530777604, 7.3598359754929845, 7.429152452076465, 14.716239839792252, 16.362756572663784, 16.128866121172905, 25.504739984869957, 25.50620499253273, 26.472311589866877, 22.888535007834435, 23.124116303399205, 23.174142388626933, 7.820359602570534, 7.682950407266617, 8.649186607450247, 18.250383536020905, 18.02155005435148, 18.04116743306318, 21.52044054120779, 22.02317863702774, 21.946271304041147, 18.8093898370862, 19.173206940293312, 18.770960301160812, 10.164032655457646, 10.430933109174163, 10.101979228357465, 20.100146780411393, 19.106113264958054, 20.22680666918555, 18.51361087958017, 18.930031987527997, 18.971026832858712, 19.726450607180595, 20.12471959553659, 19.83206407725811, 21.756226326028496, 22.644535367066652, 22.583653394753725, 24.54328815390666, 24.202640642722443, 24.602707279225186, 18.541441552961857, 18.493229739988834, 18.060796114305646, 25.449060847361878, 25.99095319708188, 25.99275692676504, 21.132642017987862, 20.27560258408387, 20.999414847542837, 20.214852179090173, 20.35768416772285, 20.366330752770097, 22.508268768588692, 22.763799822578818, 22.837152157599718, 19.842602173487336, 20.165885249773652, 20.54184832672277, 30.081568437317998, 29.984870108465344, 30.233418273429066, 13.798750326037407, 14.4599928278476, 14.175748661160469, 13.312026970088482, 12.753441259264946, 13.029245063662529, 17.780346875389412, 18.10772259285052, 17.859043558438614, 25.07720036804676, 25.18050717562437, 24.79508785903454, 27.024068315823868, 26.10212244590123, 27.01340128233035, 31.21444529232879, 30.887334321935967, 31.15996238154669, 3.928027043739945, 3.135396132866532, 3.3946642676989143, 27.210388910025358, 27.236045859754086, 26.89495824277401, 12.304782410462693, 12.797695779552058, 12.75582070400317, 4.981488275652126, 4.895271265258387, 4.165612493952111, 25.719249342878655, 25.93639737119277, 26.073175576825932, 15.41180122022827, 15.47693546240528, 15.549306528021887, 23.120417706668377, 23.29077586531639, 23.508251253515482, 22.223392722507313, 22.70660069522758, 21.89381818970044, 26.32848389322558, 26.33819509173432, 26.216916086773068, -4.188486102347582, -5.534290631612151, -4.1338162192454035, 22.300618598858506, 23.22855410228172, 22.291048551599175, 20.998231085638196, 21.127623605231435, 21.112728497634322, 11.880011742313698, 11.436802109082535, 11.71810820450385, 24.672494449963168, 24.149034967025116, 24.041650419433907, -96.83596394459407, -83.25799203912418, -82.69579051962744, 12.081598527108625, 10.740794976552323, 11.774592985709504, 18.54003298530975, 18.304521809021622, 18.073312076429517, 10.500275045633316, 10.90169433504343, 11.27510383259505, 17.364946596324444, 16.95544394850731, 17.402418173849583, 12.28893182426691, 11.948914408683777, 12.370280671864748, 18.157585324331492, 17.55044224609931, 18.03498569813867, 26.54467535018921, 26.556476324796677, 26.32927269488573, 22.973109256476164, 22.976078182458878, 22.891836442053318, 18.919910326600075, 19.73515446204692, 19.648060206323862, 2.7535442002117634, 2.757886780425906, 2.6047895215451717, 20.812086410820484, 20.887879686430097, 20.85367917455733, 23.811471839745835, 23.103298922379807, 24.225138300408915, 17.025875780110553, 16.251731892426804, 17.085883370911077, 2.9322238589326446, 3.0215840923289363, 2.8335330585638587, -17.91718961795172, -17.23833838601908, -17.038571966191142, 26.582828921576336, 26.903559284595147, 26.278829922278717, 21.598889296253518, 21.82622405638297, 21.76176919539769, 20.334047379903495, 19.890650369226933, 19.77013175189495, 24.36946206291516, 24.39612880845864, 24.344438915451363, 2.83302443226178, 3.3168319066365513, 3.5945011780907663, 18.590741459280252, 18.608352908864617, 18.53966998308897, 22.282687644318983, 22.151913323750094, 21.706866284211472, 23.123242651422814, 23.401662324399993, 23.415167159478486, 19.211763378232718, 19.122298166155815, 19.260006744414568, 19.705941637977958, 19.11844466626644, 19.702060341835022, 26.254814956337214, 25.88176641613245, 26.20655508711934, 20.43238141387701, 20.895742120221257, 20.662174865603447, 14.934653719266251, 15.233085020755723, 15.032397178312138, 27.985259279608727, 28.636804282665253, 28.603698428720236, 21.47955190266171, 21.477534508953482, 21.357297169665486, 21.740547075246766, 21.702318984394267, 21.59168919672568, 17.997894380241632, 17.827229537069798, 17.67258606851101, 28.57511923966618, 28.5053474685798, 28.05527116606632, 17.99567711850007, 17.9472175737222, 17.876108561952904, 27.2463549102346, 27.299491370717675, 26.91374150911966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15313032455155087, "mean_inference_ms": 0.7050774928937434, "mean_action_processing_ms": 0.09998583497784429, "mean_env_wait_ms": 0.8077361785573087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1966770, "timesteps_this_iter": 0, "agent_timesteps_total": 5900310, "timers": {"sample_time_ms": 20550.998, "sample_throughput": 466.839, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3005.805, "learn_throughput": 3191.824, "update_time_ms": 8.393}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 7.151280045509338, "policy_loss": -0.00019803447900557103, "vf_loss": 7.3502742648124695, "vf_explained_var": 0.23195166140794754, "kl": 0.006899459055084139, "entropy": 19.879606246948242, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1966770, "num_agent_steps_sampled": 5900310, "num_steps_trained": 1966770, "num_agent_steps_trained": 5900310, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7373, "training_iteration": 205, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-52-21", "timestamp": 1706194341, "time_this_iter_s": 19.546632766723633, "time_total_s": 4137.450069904327, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4137.450069904327, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 9.953571428571427, "ram_util_percent": 53.32142857142856}}
{"episode_reward_max": 106.97594064660368, "episode_reward_min": -262.78974650334567, "episode_reward_mean": 51.023314484546425, "episode_len_mean": 298.07, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -96.83596394459407}, "policy_reward_max": {"shared_policy": 35.86278655069569}, "policy_reward_mean": {"shared_policy": 17.007771494848804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.41466969996688, 59.683234279975295, 66.98441508784887, 73.34863607585429, 55.095467407256336, 77.4327709712088, 62.40765944961457, 60.93886709958312, 68.10922074876723, 60.55033574998376, 90.29985681921241, 42.434491815045476, 39.09471329301596, 53.74711302667855, 75.05279540270567, 80.13959204405545, 93.26174199581145, 10.458087444305392, 81.34139301255345, 37.85829889401792, 14.042372034862623, 77.72882229089736, 46.43804321065544, 69.91944482550025, 66.82381160743533, 78.88359507173297, -13.856592953205137, 67.8202212527394, 63.23858318850395, 35.03492205590008, 72.86317983642219, -262.78974650334567, 34.59698648937045, 54.91786687076089, 32.6770732132718, 51.722808718681335, 36.608126904815435, 53.74301326856947, 79.43042436987162, 68.84102388098836, 58.30312499497086, 8.116220502182841, 62.55364527180791, 71.13990906253456, 50.363491043448434, 8.78734100982544, -52.19409997016194, 79.7652181284502, 65.18688254803418, 59.99482950102538, 73.11002978682517, 9.744357516989098, 55.73876435123384, 66.14146725228055, 69.94007213530129, 57.5940682888031, 58.52644664607942, 78.343136459589, 61.990298399701715, 45.20013591833411, 85.22576199099422, 64.31438358128068, 65.03455525636672, 53.49770998582244, 85.1357378743123, 53.81900325417517, 81.45958779007194, 47.46907810471019, 56.860233263112576, 0.8419136106967926, 67.94672454148531, 53.9520035777241, 89.55522164702413, 70.31663484056479, 82.07470856606957, 75.14068431779741, 20.62906211661175, 83.35807924345136, 66.9136352930218, 76.45271220430732, 57.98895475454627, 41.951599670574055, 51.1676495783031, 61.421720074489684, 106.97594064660368, 16.762403197586508, 31.809595803264514, 79.96017516404389, 30.44673129357396, 61.87059863284229, 95.09521011263129, 70.20476785674688, 68.45348314940927, -234.30212411493994, 57.996856320649385, 78.07109383842908, 16.108506239950657, 56.07600476592776, 55.47731389105317, 57.11485772021112], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 163, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 244, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.51361087958017, 18.930031987527997, 18.971026832858712, 19.726450607180595, 20.12471959553659, 19.83206407725811, 21.756226326028496, 22.644535367066652, 22.583653394753725, 24.54328815390666, 24.202640642722443, 24.602707279225186, 18.541441552961857, 18.493229739988834, 18.060796114305646, 25.449060847361878, 25.99095319708188, 25.99275692676504, 21.132642017987862, 20.27560258408387, 20.999414847542837, 20.214852179090173, 20.35768416772285, 20.366330752770097, 22.508268768588692, 22.763799822578818, 22.837152157599718, 19.842602173487336, 20.165885249773652, 20.54184832672277, 30.081568437317998, 29.984870108465344, 30.233418273429066, 13.798750326037407, 14.4599928278476, 14.175748661160469, 13.312026970088482, 12.753441259264946, 13.029245063662529, 17.780346875389412, 18.10772259285052, 17.859043558438614, 25.07720036804676, 25.18050717562437, 24.79508785903454, 27.024068315823868, 26.10212244590123, 27.01340128233035, 31.21444529232879, 30.887334321935967, 31.15996238154669, 3.928027043739945, 3.135396132866532, 3.3946642676989143, 27.210388910025358, 27.236045859754086, 26.89495824277401, 12.304782410462693, 12.797695779552058, 12.75582070400317, 4.981488275652126, 4.895271265258387, 4.165612493952111, 25.719249342878655, 25.93639737119277, 26.073175576825932, 15.41180122022827, 15.47693546240528, 15.549306528021887, 23.120417706668377, 23.29077586531639, 23.508251253515482, 22.223392722507313, 22.70660069522758, 21.89381818970044, 26.32848389322558, 26.33819509173432, 26.216916086773068, -4.188486102347582, -5.534290631612151, -4.1338162192454035, 22.300618598858506, 23.22855410228172, 22.291048551599175, 20.998231085638196, 21.127623605231435, 21.112728497634322, 11.880011742313698, 11.436802109082535, 11.71810820450385, 24.672494449963168, 24.149034967025116, 24.041650419433907, -96.83596394459407, -83.25799203912418, -82.69579051962744, 12.081598527108625, 10.740794976552323, 11.774592985709504, 18.54003298530975, 18.304521809021622, 18.073312076429517, 10.500275045633316, 10.90169433504343, 11.27510383259505, 17.364946596324444, 16.95544394850731, 17.402418173849583, 12.28893182426691, 11.948914408683777, 12.370280671864748, 18.157585324331492, 17.55044224609931, 18.03498569813867, 26.54467535018921, 26.556476324796677, 26.32927269488573, 22.973109256476164, 22.976078182458878, 22.891836442053318, 18.919910326600075, 19.73515446204692, 19.648060206323862, 2.7535442002117634, 2.757886780425906, 2.6047895215451717, 20.812086410820484, 20.887879686430097, 20.85367917455733, 23.811471839745835, 23.103298922379807, 24.225138300408915, 17.025875780110553, 16.251731892426804, 17.085883370911077, 2.9322238589326446, 3.0215840923289363, 2.8335330585638587, -17.91718961795172, -17.23833838601908, -17.038571966191142, 26.582828921576336, 26.903559284595147, 26.278829922278717, 21.598889296253518, 21.82622405638297, 21.76176919539769, 20.334047379903495, 19.890650369226933, 19.77013175189495, 24.36946206291516, 24.39612880845864, 24.344438915451363, 2.83302443226178, 3.3168319066365513, 3.5945011780907663, 18.590741459280252, 18.608352908864617, 18.53966998308897, 22.282687644318983, 22.151913323750094, 21.706866284211472, 23.123242651422814, 23.401662324399993, 23.415167159478486, 19.211763378232718, 19.122298166155815, 19.260006744414568, 19.705941637977958, 19.11844466626644, 19.702060341835022, 26.254814956337214, 25.88176641613245, 26.20655508711934, 20.43238141387701, 20.895742120221257, 20.662174865603447, 14.934653719266251, 15.233085020755723, 15.032397178312138, 27.985259279608727, 28.636804282665253, 28.603698428720236, 21.47955190266171, 21.477534508953482, 21.357297169665486, 21.740547075246766, 21.702318984394267, 21.59168919672568, 17.997894380241632, 17.827229537069798, 17.67258606851101, 28.57511923966618, 28.5053474685798, 28.05527116606632, 17.99567711850007, 17.9472175737222, 17.876108561952904, 27.2463549102346, 27.299491370717675, 26.91374150911966, 15.711718519528702, 15.959001188244045, 15.798358396937445, 18.580793077747018, 19.00228106478849, 19.277159120577068, 0.20842339098453522, 0.34334811568260193, 0.29014210402965546, 22.835424438118935, 22.447349287569523, 22.663950815796852, 17.929267957806587, 17.815980203449726, 18.206755416467786, 29.38500183324018, 29.915757390360028, 30.254462423423917, 23.39186382790406, 23.741801757908732, 23.182969254751995, 27.473698562631995, 27.12863742063442, 27.47237258280316, 24.7260201772054, 25.134027754267052, 25.280636386324957, 7.136762530077249, 6.932125113904476, 6.560174472630024, 27.78787600249052, 27.725966911762953, 27.844236329197884, 22.572901034727693, 21.86398446559906, 22.476749792695045, 25.333062022924423, 24.981986194849014, 26.13766398653388, 19.33679064114888, 19.123700757821396, 19.528463355575994, 14.362613859896854, 13.755436440308884, 13.833549370368317, 16.726105898618698, 17.20669176056981, 17.23485191911459, 19.89058872560659, 20.752237633491546, 20.778893715391547, 35.305303553740174, 35.86278655069569, 35.80785054216781, 5.494245807329804, 5.779615002373845, 5.488542387882859, 10.874201353018478, 9.938823138674096, 10.996571311571941, 26.197503571708992, 27.152891633411244, 26.609779958923653, 10.244394905244306, 10.063309596230582, 10.139026792099074, 20.779778090616063, 20.91216479366024, 20.178655748565987, 31.739411825935036, 31.741172621647507, 31.61462566504875, 22.933141152063996, 23.5519877548019, 23.719638949880988, 23.182050901154668, 22.297377864519746, 22.974054383734853, -87.60779414574306, -73.47396247337262, -73.22036749582428, 19.30034015700221, 19.36143884807825, 19.335077315568924, 26.249734066193923, 26.08336878195405, 25.737990990281105, 5.4207897782325745, 5.5718832314014435, 5.115833230316639, 18.83562060693899, 18.649193073312432, 18.591191085676343, 18.259552309910447, 18.72939672569433, 18.488364855448395, 19.240568418676645, 18.76632274935642, 19.107966552178056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309967780144088, "mean_inference_ms": 0.704998707075654, "mean_action_processing_ms": 0.09996283338118211, "mean_env_wait_ms": 0.8076618992929113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1976364, "timesteps_this_iter": 0, "agent_timesteps_total": 5929092, "timers": {"sample_time_ms": 20635.896, "sample_throughput": 464.918, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3024.511, "learn_throughput": 3172.083, "update_time_ms": 8.7}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 47.30725145339966, "policy_loss": -0.0003005715495010275, "vf_loss": 47.50581169128418, "vf_explained_var": 0.22971857339143753, "kl": 0.006624379312072494, "entropy": 19.826125144958496, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1976364, "num_agent_steps_sampled": 5929092, "num_steps_trained": 1976364, "num_agent_steps_trained": 5929092, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7406, "training_iteration": 206, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-52-42", "timestamp": 1706194362, "time_this_iter_s": 20.789616584777832, "time_total_s": 4158.239686489105, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B810D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4158.239686489105, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 10.23448275862069, "ram_util_percent": 53.26206896551724}}
{"episode_reward_max": 106.97594064660368, "episode_reward_min": -271.4765470344573, "episode_reward_mean": 51.61833712551044, "episode_len_mean": 297.77, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -90.75974375506243}, "policy_reward_max": {"shared_policy": 35.86278655069569}, "policy_reward_mean": {"shared_policy": 17.206112375170143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.91786687076089, 32.6770732132718, 51.722808718681335, 36.608126904815435, 53.74301326856947, 79.43042436987162, 68.84102388098836, 58.30312499497086, 8.116220502182841, 62.55364527180791, 71.13990906253456, 50.363491043448434, 8.78734100982544, -52.19409997016194, 79.7652181284502, 65.18688254803418, 59.99482950102538, 73.11002978682517, 9.744357516989098, 55.73876435123384, 66.14146725228055, 69.94007213530129, 57.5940682888031, 58.52644664607942, 78.343136459589, 61.990298399701715, 45.20013591833411, 85.22576199099422, 64.31438358128068, 65.03455525636672, 53.49770998582244, 85.1357378743123, 53.81900325417517, 81.45958779007194, 47.46907810471019, 56.860233263112576, 0.8419136106967926, 67.94672454148531, 53.9520035777241, 89.55522164702413, 70.31663484056479, 82.07470856606957, 75.14068431779741, 20.62906211661175, 83.35807924345136, 66.9136352930218, 76.45271220430732, 57.98895475454627, 41.951599670574055, 51.1676495783031, 61.421720074489684, 106.97594064660368, 16.762403197586508, 31.809595803264514, 79.96017516404389, 30.44673129357396, 61.87059863284229, 95.09521011263129, 70.20476785674688, 68.45348314940927, -234.30212411493994, 57.996856320649385, 78.07109383842908, 16.108506239950657, 56.07600476592776, 55.47731389105317, 57.11485772021112, 58.776275785639854, 87.56104389578104, 54.264781899750204, -271.4765470344573, 37.79282803460953, 70.96786456927656, 66.49247868731615, -0.575287770479946, 31.131398580968366, 57.468218402937055, 68.82085590809582, 62.47370091825722, 65.28305718488991, 71.7771667949855, 54.75968445464966, 73.09477455541489, 62.47244537994263, 78.04659444093704, 74.33236344903706, 40.001810813322635, 36.93713748455046, 66.13457633182405, 67.2814819384366, 83.24872975423929, 49.041638582944856, 89.0817151609808, 60.21239310130474, 73.51229650154707, 75.80468985810873, 54.81497043371198, 34.56693387497215, 67.87762706167993, 52.9195677861571], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 244, 300, 300, 300, 300, 300, 300, 300, 300, 300, 133, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.54003298530975, 18.304521809021622, 18.073312076429517, 10.500275045633316, 10.90169433504343, 11.27510383259505, 17.364946596324444, 16.95544394850731, 17.402418173849583, 12.28893182426691, 11.948914408683777, 12.370280671864748, 18.157585324331492, 17.55044224609931, 18.03498569813867, 26.54467535018921, 26.556476324796677, 26.32927269488573, 22.973109256476164, 22.976078182458878, 22.891836442053318, 18.919910326600075, 19.73515446204692, 19.648060206323862, 2.7535442002117634, 2.757886780425906, 2.6047895215451717, 20.812086410820484, 20.887879686430097, 20.85367917455733, 23.811471839745835, 23.103298922379807, 24.225138300408915, 17.025875780110553, 16.251731892426804, 17.085883370911077, 2.9322238589326446, 3.0215840923289363, 2.8335330585638587, -17.91718961795172, -17.23833838601908, -17.038571966191142, 26.582828921576336, 26.903559284595147, 26.278829922278717, 21.598889296253518, 21.82622405638297, 21.76176919539769, 20.334047379903495, 19.890650369226933, 19.77013175189495, 24.36946206291516, 24.39612880845864, 24.344438915451363, 2.83302443226178, 3.3168319066365513, 3.5945011780907663, 18.590741459280252, 18.608352908864617, 18.53966998308897, 22.282687644318983, 22.151913323750094, 21.706866284211472, 23.123242651422814, 23.401662324399993, 23.415167159478486, 19.211763378232718, 19.122298166155815, 19.260006744414568, 19.705941637977958, 19.11844466626644, 19.702060341835022, 26.254814956337214, 25.88176641613245, 26.20655508711934, 20.43238141387701, 20.895742120221257, 20.662174865603447, 14.934653719266251, 15.233085020755723, 15.032397178312138, 27.985259279608727, 28.636804282665253, 28.603698428720236, 21.47955190266171, 21.477534508953482, 21.357297169665486, 21.740547075246766, 21.702318984394267, 21.59168919672568, 17.997894380241632, 17.827229537069798, 17.67258606851101, 28.57511923966618, 28.5053474685798, 28.05527116606632, 17.99567711850007, 17.9472175737222, 17.876108561952904, 27.2463549102346, 27.299491370717675, 26.91374150911966, 15.711718519528702, 15.959001188244045, 15.798358396937445, 18.580793077747018, 19.00228106478849, 19.277159120577068, 0.20842339098453522, 0.34334811568260193, 0.29014210402965546, 22.835424438118935, 22.447349287569523, 22.663950815796852, 17.929267957806587, 17.815980203449726, 18.206755416467786, 29.38500183324018, 29.915757390360028, 30.254462423423917, 23.39186382790406, 23.741801757908732, 23.182969254751995, 27.473698562631995, 27.12863742063442, 27.47237258280316, 24.7260201772054, 25.134027754267052, 25.280636386324957, 7.136762530077249, 6.932125113904476, 6.560174472630024, 27.78787600249052, 27.725966911762953, 27.844236329197884, 22.572901034727693, 21.86398446559906, 22.476749792695045, 25.333062022924423, 24.981986194849014, 26.13766398653388, 19.33679064114888, 19.123700757821396, 19.528463355575994, 14.362613859896854, 13.755436440308884, 13.833549370368317, 16.726105898618698, 17.20669176056981, 17.23485191911459, 19.89058872560659, 20.752237633491546, 20.778893715391547, 35.305303553740174, 35.86278655069569, 35.80785054216781, 5.494245807329804, 5.779615002373845, 5.488542387882859, 10.874201353018478, 9.938823138674096, 10.996571311571941, 26.197503571708992, 27.152891633411244, 26.609779958923653, 10.244394905244306, 10.063309596230582, 10.139026792099074, 20.779778090616063, 20.91216479366024, 20.178655748565987, 31.739411825935036, 31.741172621647507, 31.61462566504875, 22.933141152063996, 23.5519877548019, 23.719638949880988, 23.182050901154668, 22.297377864519746, 22.974054383734853, -87.60779414574306, -73.47396247337262, -73.22036749582428, 19.30034015700221, 19.36143884807825, 19.335077315568924, 26.249734066193923, 26.08336878195405, 25.737990990281105, 5.4207897782325745, 5.5718832314014435, 5.115833230316639, 18.83562060693899, 18.649193073312432, 18.591191085676343, 18.259552309910447, 18.72939672569433, 18.488364855448395, 19.240568418676645, 18.76632274935642, 19.107966552178056, 19.128109763065964, 19.44546403984228, 20.20270198273161, 29.34320230782032, 28.893617399036884, 29.324224188923836, 18.135149123768002, 18.08340115348497, 18.04623162249723, -90.75974375506243, -90.45896452416977, -90.25783875522515, 12.586692499617726, 12.5646970445911, 12.641438490400702, 23.890733392288283, 23.533701812227562, 23.543429364760712, 22.037094461421162, 22.430604382107646, 22.024779843787343, -0.3947872792681153, -0.07622440656027152, -0.10427608465155913, 10.33756312479575, 10.578573202093438, 10.215262254079178, 18.658574000000954, 19.5766928140074, 19.2329515889287, 22.719677944978073, 22.726126869519547, 23.375051093598202, 21.22274352734287, 19.890201320250824, 21.360756070663527, 21.787899365648627, 21.734455168247223, 21.760702650994062, 24.002277626345546, 23.76780757556358, 24.00708159307638, 18.342749981830508, 18.22644671673575, 18.1904877560834, 24.164475778738648, 24.219909737507493, 24.710389039168746, 20.409196774164826, 20.946615944306046, 21.116632661471755, 26.082826875150204, 25.814486727118492, 26.149280838668346, 24.519628842671708, 24.664238949616745, 25.148495656748608, 13.526216790700943, 13.006331006685883, 13.469263015935809, 12.090153997143105, 12.186418031652764, 12.660565455754593, 21.743367736538247, 22.16648408522208, 22.224724510063723, 22.5281580282996, 22.275057363013417, 22.47826654712358, 27.903220439950616, 27.31842682758966, 28.027082486699015, 16.577727926274136, 16.21082941194375, 16.25308124472697, 29.638017413516835, 29.752375788365796, 29.691321959098175, 20.029364711294562, 19.980358498791844, 20.202669891218335, 24.909106521556765, 24.285581568876893, 24.31760841111341, 25.503841190288455, 25.2122054050366, 25.088643262783677, 17.929320017496735, 18.30943329135576, 18.576217124859483, 11.213786845405892, 11.864685999539986, 11.488461030026272, 22.494811216990144, 23.147028607005865, 22.235787237683923, 17.680325905481965, 17.861575993398816, 17.377665887276322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311243769916166, "mean_inference_ms": 0.7050501964303147, "mean_action_processing_ms": 0.0999673639180298, "mean_env_wait_ms": 0.8076922416530751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1985958, "timesteps_this_iter": 0, "agent_timesteps_total": 5957874, "timers": {"sample_time_ms": 20669.154, "sample_throughput": 464.17, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3033.562, "learn_throughput": 3162.619, "update_time_ms": 8.799}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 55.29758882522583, "policy_loss": -0.001442977753004171, "vf_loss": 55.498079776763916, "vf_explained_var": 0.04465217888355255, "kl": 0.006932585064013912, "entropy": 19.904585599899292, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1985958, "num_agent_steps_sampled": 5957874, "num_steps_trained": 1985958, "num_agent_steps_trained": 5957874, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7439, "training_iteration": 207, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-53-02", "timestamp": 1706194382, "time_this_iter_s": 19.967408895492554, "time_total_s": 4178.207095384598, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02053E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4178.207095384598, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 10.185714285714285, "ram_util_percent": 53.057142857142864}}
{"episode_reward_max": 106.97594064660368, "episode_reward_min": -271.4765470344573, "episode_reward_mean": 51.818239316446416, "episode_len_mean": 297.77, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -90.75974375506243}, "policy_reward_max": {"shared_policy": 35.86278655069569}, "policy_reward_mean": {"shared_policy": 17.272746438815467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.49770998582244, 85.1357378743123, 53.81900325417517, 81.45958779007194, 47.46907810471019, 56.860233263112576, 0.8419136106967926, 67.94672454148531, 53.9520035777241, 89.55522164702413, 70.31663484056479, 82.07470856606957, 75.14068431779741, 20.62906211661175, 83.35807924345136, 66.9136352930218, 76.45271220430732, 57.98895475454627, 41.951599670574055, 51.1676495783031, 61.421720074489684, 106.97594064660368, 16.762403197586508, 31.809595803264514, 79.96017516404389, 30.44673129357396, 61.87059863284229, 95.09521011263129, 70.20476785674688, 68.45348314940927, -234.30212411493994, 57.996856320649385, 78.07109383842908, 16.108506239950657, 56.07600476592776, 55.47731389105317, 57.11485772021112, 58.776275785639854, 87.56104389578104, 54.264781899750204, -271.4765470344573, 37.79282803460953, 70.96786456927656, 66.49247868731615, -0.575287770479946, 31.131398580968366, 57.468218402937055, 68.82085590809582, 62.47370091825722, 65.28305718488991, 71.7771667949855, 54.75968445464966, 73.09477455541489, 62.47244537994263, 78.04659444093704, 74.33236344903706, 40.001810813322635, 36.93713748455046, 66.13457633182405, 67.2814819384366, 83.24872975423929, 49.041638582944856, 89.0817151609808, 60.21239310130474, 73.51229650154707, 75.80468985810873, 54.81497043371198, 34.56693387497215, 67.87762706167993, 52.9195677861571, 61.07387381792067, 58.9573217651341, 75.61354751512408, 53.90838396549222, 57.119848670437904, 65.31040375470181, 48.83225082978605, 54.50629684329033, 47.507651217281804, 28.78547320142387, 56.3805982992053, 82.3854480832815, 9.754145307000698, 56.45484452450181, 60.51112145371734, 84.08821115642785, 65.11683953367174, 30.880396014079437, 68.32357958517966, 9.21844173781571, 35.55339488387105, 49.95848164189374, 29.863519253209205, 69.87520677727296, 37.23450134694575, 57.958744792267666, 63.11156510561703, 79.04988376796246, 50.75063178502022, 52.76598936691879], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 244, 300, 300, 300, 300, 300, 300, 300, 300, 300, 133, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.997894380241632, 17.827229537069798, 17.67258606851101, 28.57511923966618, 28.5053474685798, 28.05527116606632, 17.99567711850007, 17.9472175737222, 17.876108561952904, 27.2463549102346, 27.299491370717675, 26.91374150911966, 15.711718519528702, 15.959001188244045, 15.798358396937445, 18.580793077747018, 19.00228106478849, 19.277159120577068, 0.20842339098453522, 0.34334811568260193, 0.29014210402965546, 22.835424438118935, 22.447349287569523, 22.663950815796852, 17.929267957806587, 17.815980203449726, 18.206755416467786, 29.38500183324018, 29.915757390360028, 30.254462423423917, 23.39186382790406, 23.741801757908732, 23.182969254751995, 27.473698562631995, 27.12863742063442, 27.47237258280316, 24.7260201772054, 25.134027754267052, 25.280636386324957, 7.136762530077249, 6.932125113904476, 6.560174472630024, 27.78787600249052, 27.725966911762953, 27.844236329197884, 22.572901034727693, 21.86398446559906, 22.476749792695045, 25.333062022924423, 24.981986194849014, 26.13766398653388, 19.33679064114888, 19.123700757821396, 19.528463355575994, 14.362613859896854, 13.755436440308884, 13.833549370368317, 16.726105898618698, 17.20669176056981, 17.23485191911459, 19.89058872560659, 20.752237633491546, 20.778893715391547, 35.305303553740174, 35.86278655069569, 35.80785054216781, 5.494245807329804, 5.779615002373845, 5.488542387882859, 10.874201353018478, 9.938823138674096, 10.996571311571941, 26.197503571708992, 27.152891633411244, 26.609779958923653, 10.244394905244306, 10.063309596230582, 10.139026792099074, 20.779778090616063, 20.91216479366024, 20.178655748565987, 31.739411825935036, 31.741172621647507, 31.61462566504875, 22.933141152063996, 23.5519877548019, 23.719638949880988, 23.182050901154668, 22.297377864519746, 22.974054383734853, -87.60779414574306, -73.47396247337262, -73.22036749582428, 19.30034015700221, 19.36143884807825, 19.335077315568924, 26.249734066193923, 26.08336878195405, 25.737990990281105, 5.4207897782325745, 5.5718832314014435, 5.115833230316639, 18.83562060693899, 18.649193073312432, 18.591191085676343, 18.259552309910447, 18.72939672569433, 18.488364855448395, 19.240568418676645, 18.76632274935642, 19.107966552178056, 19.128109763065964, 19.44546403984228, 20.20270198273161, 29.34320230782032, 28.893617399036884, 29.324224188923836, 18.135149123768002, 18.08340115348497, 18.04623162249723, -90.75974375506243, -90.45896452416977, -90.25783875522515, 12.586692499617726, 12.5646970445911, 12.641438490400702, 23.890733392288283, 23.533701812227562, 23.543429364760712, 22.037094461421162, 22.430604382107646, 22.024779843787343, -0.3947872792681153, -0.07622440656027152, -0.10427608465155913, 10.33756312479575, 10.578573202093438, 10.215262254079178, 18.658574000000954, 19.5766928140074, 19.2329515889287, 22.719677944978073, 22.726126869519547, 23.375051093598202, 21.22274352734287, 19.890201320250824, 21.360756070663527, 21.787899365648627, 21.734455168247223, 21.760702650994062, 24.002277626345546, 23.76780757556358, 24.00708159307638, 18.342749981830508, 18.22644671673575, 18.1904877560834, 24.164475778738648, 24.219909737507493, 24.710389039168746, 20.409196774164826, 20.946615944306046, 21.116632661471755, 26.082826875150204, 25.814486727118492, 26.149280838668346, 24.519628842671708, 24.664238949616745, 25.148495656748608, 13.526216790700943, 13.006331006685883, 13.469263015935809, 12.090153997143105, 12.186418031652764, 12.660565455754593, 21.743367736538247, 22.16648408522208, 22.224724510063723, 22.5281580282996, 22.275057363013417, 22.47826654712358, 27.903220439950616, 27.31842682758966, 28.027082486699015, 16.577727926274136, 16.21082941194375, 16.25308124472697, 29.638017413516835, 29.752375788365796, 29.691321959098175, 20.029364711294562, 19.980358498791844, 20.202669891218335, 24.909106521556765, 24.285581568876893, 24.31760841111341, 25.503841190288455, 25.2122054050366, 25.088643262783677, 17.929320017496735, 18.30943329135576, 18.576217124859483, 11.213786845405892, 11.864685999539986, 11.488461030026272, 22.494811216990144, 23.147028607005865, 22.235787237683923, 17.680325905481965, 17.861575993398816, 17.377665887276322, 20.020069067676857, 20.47274689873059, 20.581057851513222, 19.9098798330718, 19.71632560839255, 19.331116323669747, 25.198756657540798, 25.004778817296028, 25.410012040287256, 17.866384054223687, 18.156323249141366, 17.885676662127167, 18.88146862636009, 19.194478013242275, 19.04390203083554, 21.437497461835534, 21.73376979927221, 22.139136493594066, 15.91474339862664, 16.48422247295578, 16.43328495820363, 17.999042704701424, 18.251547947525978, 18.255706191062927, 14.999577363332108, 16.24616417785485, 16.261909676094845, 10.21334546928604, 9.980137956639126, 8.591989775498703, 18.918889418244362, 18.703384689986706, 18.758324190974236, 27.15907983978589, 27.593855937321976, 27.632512306173638, 3.3506297121445243, 2.474102507034928, 3.9294130878212457, 18.923197184417702, 18.697597702344254, 18.834049637739852, 20.369923903917268, 20.065411438544587, 20.075786111255482, 27.851589043935135, 28.525118735929325, 27.711503376563385, 21.788912488147616, 21.690018352121115, 21.637908693403006, 10.860136065011218, 9.589294155438736, 10.430965793629483, 22.864831526453287, 22.963166347394377, 22.495581711331994, 2.7841700414816444, 3.4887700608620946, 2.9455016354719703, 11.80206813911596, 12.002322385708482, 11.749004359046609, 16.173959344625473, 16.910085814481135, 16.874436482787132, 10.218467185894639, 9.32655110458532, 10.318500962729246, 22.764128004511193, 23.637525650430078, 23.473553122331694, 12.602805269261196, 11.908801456292466, 12.722894621392086, 18.50076203544934, 20.031614753728107, 19.426368003090218, 21.177671959002808, 21.488334757586316, 20.44555838902791, 25.737433701753616, 26.794895462691784, 26.517554603517056, 17.474915559714034, 16.94397475322087, 16.331741472085312, 17.800495037188128, 17.923152734835938, 17.042341594894722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311718924522663, "mean_inference_ms": 0.7051105915229013, "mean_action_processing_ms": 0.09998625689525874, "mean_env_wait_ms": 0.8077217562890255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 1995552, "timesteps_this_iter": 0, "agent_timesteps_total": 5986656, "timers": {"sample_time_ms": 20720.688, "sample_throughput": 463.016, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3038.616, "learn_throughput": 3157.359, "update_time_ms": 8.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 5.6970096826553345, "policy_loss": -0.0011507635978467157, "vf_loss": 5.898025393486023, "vf_explained_var": 0.21583658456802368, "kl": 0.005200332031049909, "entropy": 19.98648238182068, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1995552, "num_agent_steps_sampled": 5986656, "num_steps_trained": 1995552, "num_agent_steps_trained": 5986656, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7469, "training_iteration": 208, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-53-22", "timestamp": 1706194402, "time_this_iter_s": 19.780721187591553, "time_total_s": 4197.987816572189, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0054E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4197.987816572189, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 8.346428571428572, "ram_util_percent": 53.19285714285714}}
{"episode_reward_max": 89.0817151609808, "episode_reward_min": -271.4765470344573, "episode_reward_mean": 53.67239779361979, "episode_len_mean": 298.33, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -90.75974375506243}, "policy_reward_max": {"shared_policy": 29.752375788365796}, "policy_reward_mean": {"shared_policy": 17.890799264539922}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.07600476592776, 55.47731389105317, 57.11485772021112, 58.776275785639854, 87.56104389578104, 54.264781899750204, -271.4765470344573, 37.79282803460953, 70.96786456927656, 66.49247868731615, -0.575287770479946, 31.131398580968366, 57.468218402937055, 68.82085590809582, 62.47370091825722, 65.28305718488991, 71.7771667949855, 54.75968445464966, 73.09477455541489, 62.47244537994263, 78.04659444093704, 74.33236344903706, 40.001810813322635, 36.93713748455046, 66.13457633182405, 67.2814819384366, 83.24872975423929, 49.041638582944856, 89.0817151609808, 60.21239310130474, 73.51229650154707, 75.80468985810873, 54.81497043371198, 34.56693387497215, 67.87762706167993, 52.9195677861571, 61.07387381792067, 58.9573217651341, 75.61354751512408, 53.90838396549222, 57.119848670437904, 65.31040375470181, 48.83225082978605, 54.50629684329033, 47.507651217281804, 28.78547320142387, 56.3805982992053, 82.3854480832815, 9.754145307000698, 56.45484452450181, 60.51112145371734, 84.08821115642785, 65.11683953367174, 30.880396014079437, 68.32357958517966, 9.21844173781571, 35.55339488387105, 49.95848164189374, 29.863519253209205, 69.87520677727296, 37.23450134694575, 57.958744792267666, 63.11156510561703, 79.04988376796246, 50.75063178502022, 52.76598936691879, 67.55532629135996, 42.79595778651489, 44.95526485191658, 34.30762970540671, 71.00251242890954, 52.89511449635026, 59.44717806391418, 75.62763728946446, 46.58018356049432, 46.11822445318103, 72.59636753052473, 87.44175090640782, 35.02676754631099, 57.23536389507353, 78.41837852448222, 67.20432477723804, 50.2577882260084, 10.558910069987178, 31.843523455085204, 59.27400933392346, 81.6015140376985, 68.17075312137602, 56.03105719480661, 53.35398894920945, 52.020725019276114, 74.72022356651723, 77.33862950652835, 55.33945118635893, 15.068066149950013, 80.14755204878745, 63.61140407435596, 76.45557378605005, 42.18348286300896, 55.637105470523224], "episode_lengths": [300, 300, 300, 300, 300, 300, 133, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.83562060693899, 18.649193073312432, 18.591191085676343, 18.259552309910447, 18.72939672569433, 18.488364855448395, 19.240568418676645, 18.76632274935642, 19.107966552178056, 19.128109763065964, 19.44546403984228, 20.20270198273161, 29.34320230782032, 28.893617399036884, 29.324224188923836, 18.135149123768002, 18.08340115348497, 18.04623162249723, -90.75974375506243, -90.45896452416977, -90.25783875522515, 12.586692499617726, 12.5646970445911, 12.641438490400702, 23.890733392288283, 23.533701812227562, 23.543429364760712, 22.037094461421162, 22.430604382107646, 22.024779843787343, -0.3947872792681153, -0.07622440656027152, -0.10427608465155913, 10.33756312479575, 10.578573202093438, 10.215262254079178, 18.658574000000954, 19.5766928140074, 19.2329515889287, 22.719677944978073, 22.726126869519547, 23.375051093598202, 21.22274352734287, 19.890201320250824, 21.360756070663527, 21.787899365648627, 21.734455168247223, 21.760702650994062, 24.002277626345546, 23.76780757556358, 24.00708159307638, 18.342749981830508, 18.22644671673575, 18.1904877560834, 24.164475778738648, 24.219909737507493, 24.710389039168746, 20.409196774164826, 20.946615944306046, 21.116632661471755, 26.082826875150204, 25.814486727118492, 26.149280838668346, 24.519628842671708, 24.664238949616745, 25.148495656748608, 13.526216790700943, 13.006331006685883, 13.469263015935809, 12.090153997143105, 12.186418031652764, 12.660565455754593, 21.743367736538247, 22.16648408522208, 22.224724510063723, 22.5281580282996, 22.275057363013417, 22.47826654712358, 27.903220439950616, 27.31842682758966, 28.027082486699015, 16.577727926274136, 16.21082941194375, 16.25308124472697, 29.638017413516835, 29.752375788365796, 29.691321959098175, 20.029364711294562, 19.980358498791844, 20.202669891218335, 24.909106521556765, 24.285581568876893, 24.31760841111341, 25.503841190288455, 25.2122054050366, 25.088643262783677, 17.929320017496735, 18.30943329135576, 18.576217124859483, 11.213786845405892, 11.864685999539986, 11.488461030026272, 22.494811216990144, 23.147028607005865, 22.235787237683923, 17.680325905481965, 17.861575993398816, 17.377665887276322, 20.020069067676857, 20.47274689873059, 20.581057851513222, 19.9098798330718, 19.71632560839255, 19.331116323669747, 25.198756657540798, 25.004778817296028, 25.410012040287256, 17.866384054223687, 18.156323249141366, 17.885676662127167, 18.88146862636009, 19.194478013242275, 19.04390203083554, 21.437497461835534, 21.73376979927221, 22.139136493594066, 15.91474339862664, 16.48422247295578, 16.43328495820363, 17.999042704701424, 18.251547947525978, 18.255706191062927, 14.999577363332108, 16.24616417785485, 16.261909676094845, 10.21334546928604, 9.980137956639126, 8.591989775498703, 18.918889418244362, 18.703384689986706, 18.758324190974236, 27.15907983978589, 27.593855937321976, 27.632512306173638, 3.3506297121445243, 2.474102507034928, 3.9294130878212457, 18.923197184417702, 18.697597702344254, 18.834049637739852, 20.369923903917268, 20.065411438544587, 20.075786111255482, 27.851589043935135, 28.525118735929325, 27.711503376563385, 21.788912488147616, 21.690018352121115, 21.637908693403006, 10.860136065011218, 9.589294155438736, 10.430965793629483, 22.864831526453287, 22.963166347394377, 22.495581711331994, 2.7841700414816444, 3.4887700608620946, 2.9455016354719703, 11.80206813911596, 12.002322385708482, 11.749004359046609, 16.173959344625473, 16.910085814481135, 16.874436482787132, 10.218467185894639, 9.32655110458532, 10.318500962729246, 22.764128004511193, 23.637525650430078, 23.473553122331694, 12.602805269261196, 11.908801456292466, 12.722894621392086, 18.50076203544934, 20.031614753728107, 19.426368003090218, 21.177671959002808, 21.488334757586316, 20.44555838902791, 25.737433701753616, 26.794895462691784, 26.517554603517056, 17.474915559714034, 16.94397475322087, 16.331741472085312, 17.800495037188128, 17.923152734835938, 17.042341594894722, 22.372046127915382, 22.18300947546959, 23.00027068797499, 14.47107007371838, 14.302111806968838, 14.022775905827672, 14.933347903192043, 14.736406110227108, 15.28551083849743, 11.497916278739766, 11.05300198992093, 11.756711436746016, 23.774766854941845, 23.27214603126049, 23.955599542707205, 17.31574999789396, 17.844706947604806, 17.734657550851495, 20.056943150237203, 19.409197598695755, 19.981037314981222, 25.08823725332816, 25.437379767497376, 25.102020268638924, 15.637630678558097, 15.486841448893145, 15.455711433043078, 15.02771046757698, 15.455667793750763, 15.634846191853285, 23.56596113741398, 24.51355487201363, 24.516851521097124, 29.595268068214253, 29.11896716554959, 28.727515672643975, 11.837273626277835, 11.413759546975285, 11.775734373057873, 18.529136285185814, 19.084487214684486, 19.621740395203233, 25.96945774803558, 26.217383519435913, 26.23153725701073, 22.7607813157762, 22.14615167180696, 22.29739178965488, 16.752152678867176, 16.835439590116337, 16.670195957024887, 4.011499030515552, 3.22980897128582, 3.3176020681858063, 10.391239578525216, 10.719686356528342, 10.732597520031646, 19.958660328760743, 19.636666268110275, 19.67868273705244, 27.127716319014624, 27.24124314387639, 27.23255457480748, 22.829642680784062, 22.986529407401875, 22.354581033190087, 18.36237609634796, 18.762835229436547, 18.9058458690221, 17.892395112663507, 17.755193881690502, 17.706399954855442, 17.495993117491395, 17.274870241681725, 17.249861660102994, 24.650716431438923, 25.22149076126516, 24.848016373813152, 25.82414229462543, 25.69809542099634, 25.81639179090658, 18.577697195112705, 18.404307059943676, 18.357446931302547, 5.1222784419854435, 4.694281106193856, 5.251506601770714, 27.069113821412117, 26.41777431468168, 26.66066391269365, 20.969757936894894, 21.272376753389835, 21.36926938407123, 25.33858888844648, 25.32324061791101, 25.79374427969256, 14.076007043321923, 13.94740767528613, 14.16006814440091, 18.882446552937225, 18.53809071083863, 18.216568206747368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15308682516716685, "mean_inference_ms": 0.7049442519126861, "mean_action_processing_ms": 0.09995023756641423, "mean_env_wait_ms": 0.8076096258375851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2005146, "timesteps_this_iter": 0, "agent_timesteps_total": 6015438, "timers": {"sample_time_ms": 20668.65, "sample_throughput": 464.181, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3065.939, "learn_throughput": 3129.22, "update_time_ms": 8.708}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 6.267459452152252, "policy_loss": -0.0002327051732283758, "vf_loss": 6.4677592515945435, "vf_explained_var": 0.06128648668527603, "kl": 0.005503895023530725, "entropy": 20.00671887397766, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2005146, "num_agent_steps_sampled": 6015438, "num_steps_trained": 2005146, "num_agent_steps_trained": 6015438, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7503, "training_iteration": 209, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-53-41", "timestamp": 1706194421, "time_this_iter_s": 19.676262378692627, "time_total_s": 4217.664078950882, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02053430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4217.664078950882, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 9.917857142857141, "ram_util_percent": 53.239285714285714}}
{"episode_reward_max": 87.44175090640782, "episode_reward_min": 9.21844173781571, "episode_reward_mean": 55.98148673102946, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": 2.474102507034928}, "policy_reward_max": {"shared_policy": 29.595268068214253}, "policy_reward_mean": {"shared_policy": 18.66049557700982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.21239310130474, 73.51229650154707, 75.80468985810873, 54.81497043371198, 34.56693387497215, 67.87762706167993, 52.9195677861571, 61.07387381792067, 58.9573217651341, 75.61354751512408, 53.90838396549222, 57.119848670437904, 65.31040375470181, 48.83225082978605, 54.50629684329033, 47.507651217281804, 28.78547320142387, 56.3805982992053, 82.3854480832815, 9.754145307000698, 56.45484452450181, 60.51112145371734, 84.08821115642785, 65.11683953367174, 30.880396014079437, 68.32357958517966, 9.21844173781571, 35.55339488387105, 49.95848164189374, 29.863519253209205, 69.87520677727296, 37.23450134694575, 57.958744792267666, 63.11156510561703, 79.04988376796246, 50.75063178502022, 52.76598936691879, 67.55532629135996, 42.79595778651489, 44.95526485191658, 34.30762970540671, 71.00251242890954, 52.89511449635026, 59.44717806391418, 75.62763728946446, 46.58018356049432, 46.11822445318103, 72.59636753052473, 87.44175090640782, 35.02676754631099, 57.23536389507353, 78.41837852448222, 67.20432477723804, 50.2577882260084, 10.558910069987178, 31.843523455085204, 59.27400933392346, 81.6015140376985, 68.17075312137602, 56.03105719480661, 53.35398894920945, 52.020725019276114, 74.72022356651723, 77.33862950652835, 55.33945118635893, 15.068066149950013, 80.14755204878745, 63.61140407435596, 76.45557378605005, 42.18348286300896, 55.637105470523224, 65.24926263652739, 54.937572270631776, 78.32057854533193, 41.6708364896476, 78.78999716602266, 70.04164144955574, 42.75534303486346, 55.302922289818525, 63.200963667593896, 35.66114882007241, 62.76270064711569, 49.53103538602588, 50.54012170992792, 52.95249616354701, 73.03378458973017, 28.136624176055193, 80.5430588297313, 67.29146516043691, 43.589004166424274, 53.725787269882844, 77.77210678067057, 41.22464341484009, 65.03376761265099, 15.545280958525836, 55.08803206682204, 50.48920458741486, 60.558120233821654, 64.3855566959828, 56.63480150233954], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.029364711294562, 19.980358498791844, 20.202669891218335, 24.909106521556765, 24.285581568876893, 24.31760841111341, 25.503841190288455, 25.2122054050366, 25.088643262783677, 17.929320017496735, 18.30943329135576, 18.576217124859483, 11.213786845405892, 11.864685999539986, 11.488461030026272, 22.494811216990144, 23.147028607005865, 22.235787237683923, 17.680325905481965, 17.861575993398816, 17.377665887276322, 20.020069067676857, 20.47274689873059, 20.581057851513222, 19.9098798330718, 19.71632560839255, 19.331116323669747, 25.198756657540798, 25.004778817296028, 25.410012040287256, 17.866384054223687, 18.156323249141366, 17.885676662127167, 18.88146862636009, 19.194478013242275, 19.04390203083554, 21.437497461835534, 21.73376979927221, 22.139136493594066, 15.91474339862664, 16.48422247295578, 16.43328495820363, 17.999042704701424, 18.251547947525978, 18.255706191062927, 14.999577363332108, 16.24616417785485, 16.261909676094845, 10.21334546928604, 9.980137956639126, 8.591989775498703, 18.918889418244362, 18.703384689986706, 18.758324190974236, 27.15907983978589, 27.593855937321976, 27.632512306173638, 3.3506297121445243, 2.474102507034928, 3.9294130878212457, 18.923197184417702, 18.697597702344254, 18.834049637739852, 20.369923903917268, 20.065411438544587, 20.075786111255482, 27.851589043935135, 28.525118735929325, 27.711503376563385, 21.788912488147616, 21.690018352121115, 21.637908693403006, 10.860136065011218, 9.589294155438736, 10.430965793629483, 22.864831526453287, 22.963166347394377, 22.495581711331994, 2.7841700414816444, 3.4887700608620946, 2.9455016354719703, 11.80206813911596, 12.002322385708482, 11.749004359046609, 16.173959344625473, 16.910085814481135, 16.874436482787132, 10.218467185894639, 9.32655110458532, 10.318500962729246, 22.764128004511193, 23.637525650430078, 23.473553122331694, 12.602805269261196, 11.908801456292466, 12.722894621392086, 18.50076203544934, 20.031614753728107, 19.426368003090218, 21.177671959002808, 21.488334757586316, 20.44555838902791, 25.737433701753616, 26.794895462691784, 26.517554603517056, 17.474915559714034, 16.94397475322087, 16.331741472085312, 17.800495037188128, 17.923152734835938, 17.042341594894722, 22.372046127915382, 22.18300947546959, 23.00027068797499, 14.47107007371838, 14.302111806968838, 14.022775905827672, 14.933347903192043, 14.736406110227108, 15.28551083849743, 11.497916278739766, 11.05300198992093, 11.756711436746016, 23.774766854941845, 23.27214603126049, 23.955599542707205, 17.31574999789396, 17.844706947604806, 17.734657550851495, 20.056943150237203, 19.409197598695755, 19.981037314981222, 25.08823725332816, 25.437379767497376, 25.102020268638924, 15.637630678558097, 15.486841448893145, 15.455711433043078, 15.02771046757698, 15.455667793750763, 15.634846191853285, 23.56596113741398, 24.51355487201363, 24.516851521097124, 29.595268068214253, 29.11896716554959, 28.727515672643975, 11.837273626277835, 11.413759546975285, 11.775734373057873, 18.529136285185814, 19.084487214684486, 19.621740395203233, 25.96945774803558, 26.217383519435913, 26.23153725701073, 22.7607813157762, 22.14615167180696, 22.29739178965488, 16.752152678867176, 16.835439590116337, 16.670195957024887, 4.011499030515552, 3.22980897128582, 3.3176020681858063, 10.391239578525216, 10.719686356528342, 10.732597520031646, 19.958660328760743, 19.636666268110275, 19.67868273705244, 27.127716319014624, 27.24124314387639, 27.23255457480748, 22.829642680784062, 22.986529407401875, 22.354581033190087, 18.36237609634796, 18.762835229436547, 18.9058458690221, 17.892395112663507, 17.755193881690502, 17.706399954855442, 17.495993117491395, 17.274870241681725, 17.249861660102994, 24.650716431438923, 25.22149076126516, 24.848016373813152, 25.82414229462543, 25.69809542099634, 25.81639179090658, 18.577697195112705, 18.404307059943676, 18.357446931302547, 5.1222784419854435, 4.694281106193856, 5.251506601770714, 27.069113821412117, 26.41777431468168, 26.66066391269365, 20.969757936894894, 21.272376753389835, 21.36926938407123, 25.33858888844648, 25.32324061791101, 25.79374427969256, 14.076007043321923, 13.94740767528613, 14.16006814440091, 18.882446552937225, 18.53809071083863, 18.216568206747368, 21.69925360257426, 21.72450969244042, 21.82549934151271, 18.357462385048464, 18.349592225005225, 18.230517660578087, 26.11663449058929, 25.940117831031472, 26.263826223711163, 13.151442209879548, 14.220699767271668, 14.298694512496382, 26.124507039785385, 26.7102914955467, 25.955198630690575, 23.357628365357712, 23.843343104546264, 22.840669979651764, 14.248840068777398, 13.998656650384262, 14.507846315701798, 18.60768700391054, 18.667277920991182, 18.0279573649168, 21.005396381020546, 21.23359780665487, 20.96196947991848, 11.864816676825285, 11.74681592732668, 12.049516215920448, 21.18167370309432, 21.209154797097042, 20.371872146924332, 16.727436097959668, 16.074708650509507, 16.728890637556702, 16.973271248862147, 16.959392316639423, 16.607458144426346, 17.453101257483155, 17.85363437483707, 17.645760531226784, 24.315058472255856, 24.848127299609274, 23.870598817865044, 9.297750003635883, 9.247922793030739, 9.59095137938857, 27.189979828622498, 26.649318171044186, 26.70376083006461, 22.660267823686198, 22.721025450465575, 21.91017188628514, 14.611446633934975, 14.376729130744934, 14.600828401744366, 17.589444426198796, 18.017503713568047, 18.118839130116, 25.536749218900994, 26.187726054651037, 26.04763150711854, 13.80628254388769, 13.907759777580694, 13.510601093371704, 22.07349112816155, 21.133239433169365, 21.827037051320076, 5.430572393350303, 5.1168796345591545, 4.997828930616379, 18.07659927507241, 18.657290933032826, 18.3541418587168, 16.88422355055809, 16.79739698022604, 16.80758405663073, 20.143986119578273, 20.179311655151338, 20.234822459092044, 21.70472971660395, 21.456789714594677, 21.224037264784172, 18.925797533243895, 19.097019395790994, 18.611984573304653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15306410167096307, "mean_inference_ms": 0.7050006377626002, "mean_action_processing_ms": 0.09996644095152904, "mean_env_wait_ms": 0.807607982572603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2014740, "timesteps_this_iter": 0, "agent_timesteps_total": 6044220, "timers": {"sample_time_ms": 20664.025, "sample_throughput": 464.285, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3058.177, "learn_throughput": 3137.164, "update_time_ms": 8.808}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 6.52936851978302, "policy_loss": 0.0008730637353553394, "vf_loss": 6.73106724023819, "vf_explained_var": 0.17910367995500565, "kl": 0.009687626705675769, "entropy": 20.257198333740234, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2014740, "num_agent_steps_sampled": 6044220, "num_steps_trained": 2014740, "num_agent_steps_trained": 6044220, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7532, "training_iteration": 210, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-54-02", "timestamp": 1706194442, "time_this_iter_s": 20.278785705566406, "time_total_s": 4237.942864656448, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4237.942864656448, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 9.00344827586207, "ram_util_percent": 53.324137931034485}}
{"episode_reward_max": 101.38452591813983, "episode_reward_min": -240.96147894486785, "episode_reward_mean": 54.54516512050399, "episode_len_mean": 298.1, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -89.51283274094264}, "policy_reward_max": {"shared_policy": 33.92219179873548}, "policy_reward_mean": {"shared_policy": 18.181721706834658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.76598936691879, 67.55532629135996, 42.79595778651489, 44.95526485191658, 34.30762970540671, 71.00251242890954, 52.89511449635026, 59.44717806391418, 75.62763728946446, 46.58018356049432, 46.11822445318103, 72.59636753052473, 87.44175090640782, 35.02676754631099, 57.23536389507353, 78.41837852448222, 67.20432477723804, 50.2577882260084, 10.558910069987178, 31.843523455085204, 59.27400933392346, 81.6015140376985, 68.17075312137602, 56.03105719480661, 53.35398894920945, 52.020725019276114, 74.72022356651723, 77.33862950652835, 55.33945118635893, 15.068066149950013, 80.14755204878745, 63.61140407435596, 76.45557378605005, 42.18348286300896, 55.637105470523224, 65.24926263652739, 54.937572270631776, 78.32057854533193, 41.6708364896476, 78.78999716602266, 70.04164144955574, 42.75534303486346, 55.302922289818525, 63.200963667593896, 35.66114882007241, 62.76270064711569, 49.53103538602588, 50.54012170992792, 52.95249616354701, 73.03378458973017, 28.136624176055193, 80.5430588297313, 67.29146516043691, 43.589004166424274, 53.725787269882844, 77.77210678067057, 41.22464341484009, 65.03376761265099, 15.545280958525836, 55.08803206682204, 50.48920458741486, 60.558120233821654, 64.3855566959828, 56.63480150233954, 29.796312306076274, 52.84605869837105, 49.24825568823141, 81.4704718887806, 28.244297728873775, 32.68260168284178, 68.31725635018664, 63.528507288545356, 83.21875607036053, 68.48240665905175, 38.69987456128001, 61.736185941845164, 101.38452591813983, 75.95273920893666, 65.02508666366337, 58.58467751764691, 65.78087381739167, 61.3832462024875, -240.96147894486785, 59.00063379853961, 68.23689768463373, 33.46938702464101, 63.445340119302244, 38.84434316074473, 90.1952276304364, 47.898327386006684, 75.30278512090445, 33.18973607337102, 53.30574005842206, 64.83409907668826, 71.70194147340952, 41.40643925964832, 78.67094738781452, 57.523814177140565, 79.49201940745115, 22.222590107470737], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [17.800495037188128, 17.923152734835938, 17.042341594894722, 22.372046127915382, 22.18300947546959, 23.00027068797499, 14.47107007371838, 14.302111806968838, 14.022775905827672, 14.933347903192043, 14.736406110227108, 15.28551083849743, 11.497916278739766, 11.05300198992093, 11.756711436746016, 23.774766854941845, 23.27214603126049, 23.955599542707205, 17.31574999789396, 17.844706947604806, 17.734657550851495, 20.056943150237203, 19.409197598695755, 19.981037314981222, 25.08823725332816, 25.437379767497376, 25.102020268638924, 15.637630678558097, 15.486841448893145, 15.455711433043078, 15.02771046757698, 15.455667793750763, 15.634846191853285, 23.56596113741398, 24.51355487201363, 24.516851521097124, 29.595268068214253, 29.11896716554959, 28.727515672643975, 11.837273626277835, 11.413759546975285, 11.775734373057873, 18.529136285185814, 19.084487214684486, 19.621740395203233, 25.96945774803558, 26.217383519435913, 26.23153725701073, 22.7607813157762, 22.14615167180696, 22.29739178965488, 16.752152678867176, 16.835439590116337, 16.670195957024887, 4.011499030515552, 3.22980897128582, 3.3176020681858063, 10.391239578525216, 10.719686356528342, 10.732597520031646, 19.958660328760743, 19.636666268110275, 19.67868273705244, 27.127716319014624, 27.24124314387639, 27.23255457480748, 22.829642680784062, 22.986529407401875, 22.354581033190087, 18.36237609634796, 18.762835229436547, 18.9058458690221, 17.892395112663507, 17.755193881690502, 17.706399954855442, 17.495993117491395, 17.274870241681725, 17.249861660102994, 24.650716431438923, 25.22149076126516, 24.848016373813152, 25.82414229462543, 25.69809542099634, 25.81639179090658, 18.577697195112705, 18.404307059943676, 18.357446931302547, 5.1222784419854435, 4.694281106193856, 5.251506601770714, 27.069113821412117, 26.41777431468168, 26.66066391269365, 20.969757936894894, 21.272376753389835, 21.36926938407123, 25.33858888844648, 25.32324061791101, 25.79374427969256, 14.076007043321923, 13.94740767528613, 14.16006814440091, 18.882446552937225, 18.53809071083863, 18.216568206747368, 21.69925360257426, 21.72450969244042, 21.82549934151271, 18.357462385048464, 18.349592225005225, 18.230517660578087, 26.11663449058929, 25.940117831031472, 26.263826223711163, 13.151442209879548, 14.220699767271668, 14.298694512496382, 26.124507039785385, 26.7102914955467, 25.955198630690575, 23.357628365357712, 23.843343104546264, 22.840669979651764, 14.248840068777398, 13.998656650384262, 14.507846315701798, 18.60768700391054, 18.667277920991182, 18.0279573649168, 21.005396381020546, 21.23359780665487, 20.96196947991848, 11.864816676825285, 11.74681592732668, 12.049516215920448, 21.18167370309432, 21.209154797097042, 20.371872146924332, 16.727436097959668, 16.074708650509507, 16.728890637556702, 16.973271248862147, 16.959392316639423, 16.607458144426346, 17.453101257483155, 17.85363437483707, 17.645760531226784, 24.315058472255856, 24.848127299609274, 23.870598817865044, 9.297750003635883, 9.247922793030739, 9.59095137938857, 27.189979828622498, 26.649318171044186, 26.70376083006461, 22.660267823686198, 22.721025450465575, 21.91017188628514, 14.611446633934975, 14.376729130744934, 14.600828401744366, 17.589444426198796, 18.017503713568047, 18.118839130116, 25.536749218900994, 26.187726054651037, 26.04763150711854, 13.80628254388769, 13.907759777580694, 13.510601093371704, 22.07349112816155, 21.133239433169365, 21.827037051320076, 5.430572393350303, 5.1168796345591545, 4.997828930616379, 18.07659927507241, 18.657290933032826, 18.3541418587168, 16.88422355055809, 16.79739698022604, 16.80758405663073, 20.143986119578273, 20.179311655151338, 20.234822459092044, 21.70472971660395, 21.456789714594677, 21.224037264784172, 18.925797533243895, 19.097019395790994, 18.611984573304653, 9.640972336133316, 10.007685778041676, 10.147654191901282, 17.51432364434004, 17.760537998750806, 17.57119705528021, 16.269614989558846, 16.384533173094184, 16.59410752557838, 27.365767430514097, 26.86599539220333, 27.238709066063166, 8.896485497554139, 9.848941630062953, 9.498870601256684, 10.496675565838814, 10.864588439464569, 11.321337677538395, 22.762533393998936, 23.039528982209347, 22.515193973978356, 21.091179509957627, 20.912829672296837, 21.524498106290892, 27.4622791459163, 27.673916948338345, 28.082559976105884, 22.95349709937969, 23.08527070345977, 22.44363885621229, 12.279111072421074, 13.202426321804523, 13.218337167054415, 20.957533599187926, 20.68260872115691, 20.09604362150033, 33.58479543526967, 33.92219179873548, 33.87753868413468, 25.02677572766939, 25.448823774854333, 25.47713970641294, 21.465718199809388, 21.948461172481373, 21.610907291372612, 19.33493213107188, 19.48619871710737, 19.763546669467658, 21.737667965392262, 21.942762835572154, 22.10044301642725, 20.61900854902342, 20.543082427233458, 20.22115522623062, -75.81622028599183, -89.51283274094264, -75.63242591793339, 19.785324568549782, 19.638143601516873, 19.577165628472954, 22.819950737059116, 22.8132166787982, 22.603730268776417, 11.373208026091248, 10.832979689041764, 11.263199309507996, 21.160452621678502, 21.165834846595914, 21.11905265102783, 13.381541133082152, 13.005586887399346, 12.45721514026323, 30.093797778089836, 29.922806431849793, 30.178623420496777, 15.639410311977059, 16.33025723012784, 15.928659843901784, 25.44219744950533, 24.559931993484497, 25.30065567791462, 10.94763508439064, 10.850752241909504, 11.391348747070879, 17.426484177509934, 18.031593586007745, 17.84766229490438, 21.70728391657272, 21.20102273921171, 21.925792420903832, 23.617733155687645, 23.93388535579045, 24.150322961931423, 13.859361812472343, 13.280599594116211, 14.266477853059769, 24.797456681728363, 26.874303489923477, 26.99918721616268, 18.726406435171754, 19.411223728830606, 19.386184013138205, 26.56530948728323, 26.57643935084343, 26.350270569324493, 7.287483108540371, 7.518784874429301, 7.416322124501065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530502309280531, "mean_inference_ms": 0.7048499905103525, "mean_action_processing_ms": 0.09991597980405353, "mean_env_wait_ms": 0.8074903730894701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2024334, "timesteps_this_iter": 0, "agent_timesteps_total": 6073002, "timers": {"sample_time_ms": 20003.431, "sample_throughput": 479.618, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3043.923, "learn_throughput": 3151.853, "update_time_ms": 8.807}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.500351131993304e-13, "cur_lr": 0.0005, "total_loss": 45.22001934051514, "policy_loss": 0.0023040484321272814, "vf_loss": 45.41656494140625, "vf_explained_var": 0.0675857812166214, "kl": 0.06505937268996849, "entropy": 19.885035037994385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2024334, "num_agent_steps_sampled": 6073002, "num_steps_trained": 2024334, "num_agent_steps_trained": 6073002, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7568, "training_iteration": 211, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-54-21", "timestamp": 1706194461, "time_this_iter_s": 19.74602961540222, "time_total_s": 4257.688894271851, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA004B9820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4257.688894271851, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 9.318518518518518, "ram_util_percent": 53.44814814814814}}
{"episode_reward_max": 101.38452591813983, "episode_reward_min": -240.96147894486785, "episode_reward_mean": 56.473879347461335, "episode_len_mean": 298.1, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -89.51283274094264}, "policy_reward_max": {"shared_policy": 33.92219179873548}, "policy_reward_mean": {"shared_policy": 18.824626449153772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.068066149950013, 80.14755204878745, 63.61140407435596, 76.45557378605005, 42.18348286300896, 55.637105470523224, 65.24926263652739, 54.937572270631776, 78.32057854533193, 41.6708364896476, 78.78999716602266, 70.04164144955574, 42.75534303486346, 55.302922289818525, 63.200963667593896, 35.66114882007241, 62.76270064711569, 49.53103538602588, 50.54012170992792, 52.95249616354701, 73.03378458973017, 28.136624176055193, 80.5430588297313, 67.29146516043691, 43.589004166424274, 53.725787269882844, 77.77210678067057, 41.22464341484009, 65.03376761265099, 15.545280958525836, 55.08803206682204, 50.48920458741486, 60.558120233821654, 64.3855566959828, 56.63480150233954, 29.796312306076274, 52.84605869837105, 49.24825568823141, 81.4704718887806, 28.244297728873775, 32.68260168284178, 68.31725635018664, 63.528507288545356, 83.21875607036053, 68.48240665905175, 38.69987456128001, 61.736185941845164, 101.38452591813983, 75.95273920893666, 65.02508666366337, 58.58467751764691, 65.78087381739167, 61.3832462024875, -240.96147894486785, 59.00063379853961, 68.23689768463373, 33.46938702464101, 63.445340119302244, 38.84434316074473, 90.1952276304364, 47.898327386006684, 75.30278512090445, 33.18973607337102, 53.30574005842206, 64.83409907668826, 71.70194147340952, 41.40643925964832, 78.67094738781452, 57.523814177140565, 79.49201940745115, 22.222590107470737, 50.019026927649946, 62.94192898273468, 99.59006840921936, 37.65020162425935, 66.91175432130693, 82.88003479316828, 83.12462168931961, 63.60648044943807, 77.27291320357469, 80.08041331917048, 47.501098442822666, 38.20444243773818, 62.365458081534584, 55.80590716749427, 39.33377503976223, 30.50085180811584, 92.58882875367998, 68.15124463767276, 53.420270934700966, 68.6281506139785, 72.68666602298617, 41.22793206886854, 53.382852633483694, 66.66609686333685, 68.6267781211063, 64.68315323442219, 66.34420966356993, 74.95089842751622, 86.20990916434675], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [5.1222784419854435, 4.694281106193856, 5.251506601770714, 27.069113821412117, 26.41777431468168, 26.66066391269365, 20.969757936894894, 21.272376753389835, 21.36926938407123, 25.33858888844648, 25.32324061791101, 25.79374427969256, 14.076007043321923, 13.94740767528613, 14.16006814440091, 18.882446552937225, 18.53809071083863, 18.216568206747368, 21.69925360257426, 21.72450969244042, 21.82549934151271, 18.357462385048464, 18.349592225005225, 18.230517660578087, 26.11663449058929, 25.940117831031472, 26.263826223711163, 13.151442209879548, 14.220699767271668, 14.298694512496382, 26.124507039785385, 26.7102914955467, 25.955198630690575, 23.357628365357712, 23.843343104546264, 22.840669979651764, 14.248840068777398, 13.998656650384262, 14.507846315701798, 18.60768700391054, 18.667277920991182, 18.0279573649168, 21.005396381020546, 21.23359780665487, 20.96196947991848, 11.864816676825285, 11.74681592732668, 12.049516215920448, 21.18167370309432, 21.209154797097042, 20.371872146924332, 16.727436097959668, 16.074708650509507, 16.728890637556702, 16.973271248862147, 16.959392316639423, 16.607458144426346, 17.453101257483155, 17.85363437483707, 17.645760531226784, 24.315058472255856, 24.848127299609274, 23.870598817865044, 9.297750003635883, 9.247922793030739, 9.59095137938857, 27.189979828622498, 26.649318171044186, 26.70376083006461, 22.660267823686198, 22.721025450465575, 21.91017188628514, 14.611446633934975, 14.376729130744934, 14.600828401744366, 17.589444426198796, 18.017503713568047, 18.118839130116, 25.536749218900994, 26.187726054651037, 26.04763150711854, 13.80628254388769, 13.907759777580694, 13.510601093371704, 22.07349112816155, 21.133239433169365, 21.827037051320076, 5.430572393350303, 5.1168796345591545, 4.997828930616379, 18.07659927507241, 18.657290933032826, 18.3541418587168, 16.88422355055809, 16.79739698022604, 16.80758405663073, 20.143986119578273, 20.179311655151338, 20.234822459092044, 21.70472971660395, 21.456789714594677, 21.224037264784172, 18.925797533243895, 19.097019395790994, 18.611984573304653, 9.640972336133316, 10.007685778041676, 10.147654191901282, 17.51432364434004, 17.760537998750806, 17.57119705528021, 16.269614989558846, 16.384533173094184, 16.59410752557838, 27.365767430514097, 26.86599539220333, 27.238709066063166, 8.896485497554139, 9.848941630062953, 9.498870601256684, 10.496675565838814, 10.864588439464569, 11.321337677538395, 22.762533393998936, 23.039528982209347, 22.515193973978356, 21.091179509957627, 20.912829672296837, 21.524498106290892, 27.4622791459163, 27.673916948338345, 28.082559976105884, 22.95349709937969, 23.08527070345977, 22.44363885621229, 12.279111072421074, 13.202426321804523, 13.218337167054415, 20.957533599187926, 20.68260872115691, 20.09604362150033, 33.58479543526967, 33.92219179873548, 33.87753868413468, 25.02677572766939, 25.448823774854333, 25.47713970641294, 21.465718199809388, 21.948461172481373, 21.610907291372612, 19.33493213107188, 19.48619871710737, 19.763546669467658, 21.737667965392262, 21.942762835572154, 22.10044301642725, 20.61900854902342, 20.543082427233458, 20.22115522623062, -75.81622028599183, -89.51283274094264, -75.63242591793339, 19.785324568549782, 19.638143601516873, 19.577165628472954, 22.819950737059116, 22.8132166787982, 22.603730268776417, 11.373208026091248, 10.832979689041764, 11.263199309507996, 21.160452621678502, 21.165834846595914, 21.11905265102783, 13.381541133082152, 13.005586887399346, 12.45721514026323, 30.093797778089836, 29.922806431849793, 30.178623420496777, 15.639410311977059, 16.33025723012784, 15.928659843901784, 25.44219744950533, 24.559931993484497, 25.30065567791462, 10.94763508439064, 10.850752241909504, 11.391348747070879, 17.426484177509934, 18.031593586007745, 17.84766229490438, 21.70728391657272, 21.20102273921171, 21.925792420903832, 23.617733155687645, 23.93388535579045, 24.150322961931423, 13.859361812472343, 13.280599594116211, 14.266477853059769, 24.797456681728363, 26.874303489923477, 26.99918721616268, 18.726406435171754, 19.411223728830606, 19.386184013138205, 26.56530948728323, 26.57643935084343, 26.350270569324493, 7.287483108540371, 7.518784874429301, 7.416322124501065, 16.742856467763573, 16.480994413296372, 16.79517604659, 20.14684072136879, 21.4102286323905, 21.38485962897539, 32.61775335172811, 33.66653683471182, 33.30577822277942, 12.461534917354584, 12.31801825761795, 12.870648449286819, 22.852132969846323, 21.600881477197007, 22.4587398742636, 26.98025994996229, 27.926216954986245, 27.973557888219744, 27.596305519342422, 27.688797920942307, 27.83951824903488, 21.35957322890559, 21.323051786671073, 20.923855433861405, 26.02169569550702, 25.35392581919828, 25.897291688869387, 27.107042379677296, 26.507865086197853, 26.465505853295326, 14.96393613020578, 16.28868394965926, 16.248478362957627, 12.981028217822313, 12.75300858169794, 12.470405638217926, 21.189795475821782, 20.176120852430657, 20.999541753282145, 18.559067147473485, 18.593601296345383, 18.6532387236754, 13.179543072978646, 12.937013934055955, 13.21721803272763, 10.18427536636591, 9.972472831606865, 10.344103610143065, 31.037950077404574, 30.563637529810265, 30.987241146465138, 22.673119875291974, 23.26679608206419, 22.211328680316598, 17.83052070438862, 18.012094892561436, 17.57765533775091, 22.701515644788742, 22.891172409057617, 23.035462560132146, 24.439749114215374, 23.67677803337574, 24.57013887539506, 14.100116891786456, 12.888652086257935, 14.23916309082415, 17.748406787713364, 17.662755732734993, 17.971690113035336, 22.338440472570554, 22.334164542456463, 21.99349184830983, 22.718526764462382, 22.97872623583922, 22.929525120804698, 21.7392142539223, 21.308008437355355, 21.63593054314454, 22.18683716095984, 22.02025094255805, 22.137121560052037, 25.101329624652863, 24.626124069094658, 25.2234447337687, 28.65051831677556, 28.74316895008087, 28.816221897490323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15304491086907557, "mean_inference_ms": 0.7049927163399958, "mean_action_processing_ms": 0.09995544644374439, "mean_env_wait_ms": 0.8075557250255713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2033928, "timesteps_this_iter": 0, "agent_timesteps_total": 6101784, "timers": {"sample_time_ms": 20038.565, "sample_throughput": 478.777, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3069.944, "learn_throughput": 3125.139, "update_time_ms": 8.808}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.250526697989957e-13, "cur_lr": 0.0005, "total_loss": 6.592984855175018, "policy_loss": 0.0033510559964101683, "vf_loss": 6.790998578071594, "vf_explained_var": 0.10748376697301865, "kl": 0.2810640982356251, "entropy": 20.13648247718811, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2033928, "num_agent_steps_sampled": 6101784, "num_steps_trained": 2033928, "num_agent_steps_trained": 6101784, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7597, "training_iteration": 212, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-54-42", "timestamp": 1706194482, "time_this_iter_s": 20.543535947799683, "time_total_s": 4278.23243021965, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4278.23243021965, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 10.796666666666669, "ram_util_percent": 53.43666666666665}}
{"episode_reward_max": 101.38452591813983, "episode_reward_min": -240.96147894486785, "episode_reward_mean": 58.25416574370822, "episode_len_mean": 298.1, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -89.51283274094264}, "policy_reward_max": {"shared_policy": 33.92219179873548}, "policy_reward_mean": {"shared_policy": 19.418055247902732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.63480150233954, 29.796312306076274, 52.84605869837105, 49.24825568823141, 81.4704718887806, 28.244297728873775, 32.68260168284178, 68.31725635018664, 63.528507288545356, 83.21875607036053, 68.48240665905175, 38.69987456128001, 61.736185941845164, 101.38452591813983, 75.95273920893666, 65.02508666366337, 58.58467751764691, 65.78087381739167, 61.3832462024875, -240.96147894486785, 59.00063379853961, 68.23689768463373, 33.46938702464101, 63.445340119302244, 38.84434316074473, 90.1952276304364, 47.898327386006684, 75.30278512090445, 33.18973607337102, 53.30574005842206, 64.83409907668826, 71.70194147340952, 41.40643925964832, 78.67094738781452, 57.523814177140565, 79.49201940745115, 22.222590107470737, 50.019026927649946, 62.94192898273468, 99.59006840921936, 37.65020162425935, 66.91175432130693, 82.88003479316828, 83.12462168931961, 63.60648044943807, 77.27291320357469, 80.08041331917048, 47.501098442822666, 38.20444243773818, 62.365458081534584, 55.80590716749427, 39.33377503976223, 30.50085180811584, 92.58882875367998, 68.15124463767276, 53.420270934700966, 68.6281506139785, 72.68666602298617, 41.22793206886854, 53.382852633483694, 66.66609686333685, 68.6267781211063, 64.68315323442219, 66.34420966356993, 74.95089842751622, 86.20990916434675, 66.72517380118369, 69.19833016395567, 56.94079196140953, 45.85223151750688, 63.7661680281162, 68.4912915257737, 74.42248573526739, 52.533044289797516, 70.53019541129468, 66.21863668865987, 52.37447484210131, 60.37862304830922, 86.47200762480497, 70.06665023602544, 72.18317972915244, 63.88308623433112, 60.55939222988671, 79.74868332222104, 64.74784970656036, 63.923557925969334, 66.2682024706155, 61.93693966604768, 63.84996356442569, 62.42198774032292, 71.14299339801073, 40.65351899340749, 28.916436955332728, 52.62624037824568, 66.41751090460454, 67.66360067948698, 43.2953653782606, 57.03286704048513, 71.16397817619145, 26.859421469271155], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 110, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.925797533243895, 19.097019395790994, 18.611984573304653, 9.640972336133316, 10.007685778041676, 10.147654191901282, 17.51432364434004, 17.760537998750806, 17.57119705528021, 16.269614989558846, 16.384533173094184, 16.59410752557838, 27.365767430514097, 26.86599539220333, 27.238709066063166, 8.896485497554139, 9.848941630062953, 9.498870601256684, 10.496675565838814, 10.864588439464569, 11.321337677538395, 22.762533393998936, 23.039528982209347, 22.515193973978356, 21.091179509957627, 20.912829672296837, 21.524498106290892, 27.4622791459163, 27.673916948338345, 28.082559976105884, 22.95349709937969, 23.08527070345977, 22.44363885621229, 12.279111072421074, 13.202426321804523, 13.218337167054415, 20.957533599187926, 20.68260872115691, 20.09604362150033, 33.58479543526967, 33.92219179873548, 33.87753868413468, 25.02677572766939, 25.448823774854333, 25.47713970641294, 21.465718199809388, 21.948461172481373, 21.610907291372612, 19.33493213107188, 19.48619871710737, 19.763546669467658, 21.737667965392262, 21.942762835572154, 22.10044301642725, 20.61900854902342, 20.543082427233458, 20.22115522623062, -75.81622028599183, -89.51283274094264, -75.63242591793339, 19.785324568549782, 19.638143601516873, 19.577165628472954, 22.819950737059116, 22.8132166787982, 22.603730268776417, 11.373208026091248, 10.832979689041764, 11.263199309507996, 21.160452621678502, 21.165834846595914, 21.11905265102783, 13.381541133082152, 13.005586887399346, 12.45721514026323, 30.093797778089836, 29.922806431849793, 30.178623420496777, 15.639410311977059, 16.33025723012784, 15.928659843901784, 25.44219744950533, 24.559931993484497, 25.30065567791462, 10.94763508439064, 10.850752241909504, 11.391348747070879, 17.426484177509934, 18.031593586007745, 17.84766229490438, 21.70728391657272, 21.20102273921171, 21.925792420903832, 23.617733155687645, 23.93388535579045, 24.150322961931423, 13.859361812472343, 13.280599594116211, 14.266477853059769, 24.797456681728363, 26.874303489923477, 26.99918721616268, 18.726406435171754, 19.411223728830606, 19.386184013138205, 26.56530948728323, 26.57643935084343, 26.350270569324493, 7.287483108540371, 7.518784874429301, 7.416322124501065, 16.742856467763573, 16.480994413296372, 16.79517604659, 20.14684072136879, 21.4102286323905, 21.38485962897539, 32.61775335172811, 33.66653683471182, 33.30577822277942, 12.461534917354584, 12.31801825761795, 12.870648449286819, 22.852132969846323, 21.600881477197007, 22.4587398742636, 26.98025994996229, 27.926216954986245, 27.973557888219744, 27.596305519342422, 27.688797920942307, 27.83951824903488, 21.35957322890559, 21.323051786671073, 20.923855433861405, 26.02169569550702, 25.35392581919828, 25.897291688869387, 27.107042379677296, 26.507865086197853, 26.465505853295326, 14.96393613020578, 16.28868394965926, 16.248478362957627, 12.981028217822313, 12.75300858169794, 12.470405638217926, 21.189795475821782, 20.176120852430657, 20.999541753282145, 18.559067147473485, 18.593601296345383, 18.6532387236754, 13.179543072978646, 12.937013934055955, 13.21721803272763, 10.18427536636591, 9.972472831606865, 10.344103610143065, 31.037950077404574, 30.563637529810265, 30.987241146465138, 22.673119875291974, 23.26679608206419, 22.211328680316598, 17.83052070438862, 18.012094892561436, 17.57765533775091, 22.701515644788742, 22.891172409057617, 23.035462560132146, 24.439749114215374, 23.67677803337574, 24.57013887539506, 14.100116891786456, 12.888652086257935, 14.23916309082415, 17.748406787713364, 17.662755732734993, 17.971690113035336, 22.338440472570554, 22.334164542456463, 21.99349184830983, 22.718526764462382, 22.97872623583922, 22.929525120804698, 21.7392142539223, 21.308008437355355, 21.63593054314454, 22.18683716095984, 22.02025094255805, 22.137121560052037, 25.101329624652863, 24.626124069094658, 25.2234447337687, 28.65051831677556, 28.74316895008087, 28.816221897490323, 22.318375894178942, 22.160722595949963, 22.24607531105478, 23.319662277897194, 22.404964854319886, 23.473703031738594, 18.849293308953435, 18.769386092821748, 19.32211255963435, 14.62790784239769, 15.767843321038526, 15.456480354070663, 21.311572308341653, 20.973197708527238, 21.481398011247308, 23.0767461117357, 22.25383932888508, 23.160706085152924, 24.695203726490334, 24.927546226729945, 24.799735782047108, 17.721233422557503, 16.962909976641328, 17.848900890598685, 23.75975665574272, 22.902986993392304, 23.86745176215966, 22.325032401403092, 22.160378633687884, 21.733225653568894, 17.31069583694139, 17.85039825613299, 17.213380749026925, 20.030949407567576, 20.18420704718058, 20.16346659356107, 28.354577630758286, 29.069676933810115, 29.047753060236573, 23.1878131677707, 23.41140430917342, 23.46743275908132, 24.066274548570306, 24.0266640211145, 24.090241159467638, 21.53522316863139, 21.706805941959217, 20.64105712374051, 19.957868007322148, 20.439156329802543, 20.16236789276202, 27.003176290541887, 26.22901400923729, 26.516493022441864, 21.437252463152006, 21.62768376184006, 21.682913481568292, 21.400301730881125, 21.222707363466412, 21.300548831621796, 22.055531095713377, 22.19171508960426, 22.02095628529787, 20.536886540551976, 20.834987557803586, 20.565065567692116, 21.39291840915878, 21.251831141610936, 21.205214013655976, 20.15896617869535, 21.163486023123056, 21.09953553850451, 23.816857740283012, 23.42355604469776, 23.902579613029957, 13.716283749789, 13.846727676689625, 13.090507566928864, 10.049608300129563, 8.993954608837754, 9.87287404636541, 17.51012313614288, 17.531000445286423, 17.58511679681638, 21.75508704284826, 22.314982076796383, 22.347441784959898, 22.649541196723774, 22.64285238211353, 22.37120710064967, 13.554364701112107, 14.384924729665116, 15.356075947483376, 18.881635089715317, 18.93131410827239, 19.219917842497424, 23.39029870927334, 23.883587876334786, 23.890091590583324, 8.771704236666352, 8.830253357688576, 9.257463874916226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305328826607037, "mean_inference_ms": 0.7050174431393734, "mean_action_processing_ms": 0.09993292505374249, "mean_env_wait_ms": 0.8075841362852835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2043522, "timesteps_this_iter": 0, "agent_timesteps_total": 6130566, "timers": {"sample_time_ms": 20196.462, "sample_throughput": 475.034, "load_time_ms": 0.1, "load_throughput": 95924082.422, "learn_time_ms": 3082.283, "learn_throughput": 3112.628, "update_time_ms": 9.0}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.875790046984935e-13, "cur_lr": 0.0005, "total_loss": 5.0583412647247314, "policy_loss": -0.001173626157533747, "vf_loss": 5.263389587402344, "vf_explained_var": 0.1501661315560341, "kl": 0.00672345991957898, "entropy": 20.387449026107788, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2043522, "num_agent_steps_sampled": 6130566, "num_steps_trained": 2043522, "num_agent_steps_trained": 6130566, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7631, "training_iteration": 213, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-55-03", "timestamp": 1706194503, "time_this_iter_s": 21.460012435913086, "time_total_s": 4299.692442655563, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02053DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4299.692442655563, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 10.436666666666667, "ram_util_percent": 53.5}}
{"episode_reward_max": 99.59006840921936, "episode_reward_min": 22.222590107470737, "episode_reward_mean": 62.10037562176971, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 7.287483108540371}, "policy_reward_max": {"shared_policy": 33.66653683471182}, "policy_reward_mean": {"shared_policy": 20.700125207256562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.40643925964832, 78.67094738781452, 57.523814177140565, 79.49201940745115, 22.222590107470737, 50.019026927649946, 62.94192898273468, 99.59006840921936, 37.65020162425935, 66.91175432130693, 82.88003479316828, 83.12462168931961, 63.60648044943807, 77.27291320357469, 80.08041331917048, 47.501098442822666, 38.20444243773818, 62.365458081534584, 55.80590716749427, 39.33377503976223, 30.50085180811584, 92.58882875367998, 68.15124463767276, 53.420270934700966, 68.6281506139785, 72.68666602298617, 41.22793206886854, 53.382852633483694, 66.66609686333685, 68.6267781211063, 64.68315323442219, 66.34420966356993, 74.95089842751622, 86.20990916434675, 66.72517380118369, 69.19833016395567, 56.94079196140953, 45.85223151750688, 63.7661680281162, 68.4912915257737, 74.42248573526739, 52.533044289797516, 70.53019541129468, 66.21863668865987, 52.37447484210131, 60.37862304830922, 86.47200762480497, 70.06665023602544, 72.18317972915244, 63.88308623433112, 60.55939222988671, 79.74868332222104, 64.74784970656036, 63.923557925969334, 66.2682024706155, 61.93693966604768, 63.84996356442569, 62.42198774032292, 71.14299339801073, 40.65351899340749, 28.916436955332728, 52.62624037824568, 66.41751090460454, 67.66360067948698, 43.2953653782606, 57.03286704048513, 71.16397817619145, 26.859421469271155, 83.91819824650884, 57.97883773595095, 54.70543757267295, 63.711587900761515, 62.83875781064853, 72.61542292684317, 84.71999730542302, 88.20961782336235, 71.02100998954847, 33.22952457331118, 47.66871058382094, 56.34231044910848, 83.8911151587963, 60.68387617170809, 62.262241177260876, 51.09092678874731, 83.96816128492355, 74.32045487803407, 58.16917964350429, 56.478965878486605, 44.200234580785036, 65.2501801289618, 65.8969000186771, 58.843613595701754, 74.09422242641446, 44.51976963225752, 31.139324942603707, 94.23004511743781, 34.63194185961035, 41.71607055608183, 76.40949958376585, 47.344766821712255], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [13.859361812472343, 13.280599594116211, 14.266477853059769, 24.797456681728363, 26.874303489923477, 26.99918721616268, 18.726406435171754, 19.411223728830606, 19.386184013138205, 26.56530948728323, 26.57643935084343, 26.350270569324493, 7.287483108540371, 7.518784874429301, 7.416322124501065, 16.742856467763573, 16.480994413296372, 16.79517604659, 20.14684072136879, 21.4102286323905, 21.38485962897539, 32.61775335172811, 33.66653683471182, 33.30577822277942, 12.461534917354584, 12.31801825761795, 12.870648449286819, 22.852132969846323, 21.600881477197007, 22.4587398742636, 26.98025994996229, 27.926216954986245, 27.973557888219744, 27.596305519342422, 27.688797920942307, 27.83951824903488, 21.35957322890559, 21.323051786671073, 20.923855433861405, 26.02169569550702, 25.35392581919828, 25.897291688869387, 27.107042379677296, 26.507865086197853, 26.465505853295326, 14.96393613020578, 16.28868394965926, 16.248478362957627, 12.981028217822313, 12.75300858169794, 12.470405638217926, 21.189795475821782, 20.176120852430657, 20.999541753282145, 18.559067147473485, 18.593601296345383, 18.6532387236754, 13.179543072978646, 12.937013934055955, 13.21721803272763, 10.18427536636591, 9.972472831606865, 10.344103610143065, 31.037950077404574, 30.563637529810265, 30.987241146465138, 22.673119875291974, 23.26679608206419, 22.211328680316598, 17.83052070438862, 18.012094892561436, 17.57765533775091, 22.701515644788742, 22.891172409057617, 23.035462560132146, 24.439749114215374, 23.67677803337574, 24.57013887539506, 14.100116891786456, 12.888652086257935, 14.23916309082415, 17.748406787713364, 17.662755732734993, 17.971690113035336, 22.338440472570554, 22.334164542456463, 21.99349184830983, 22.718526764462382, 22.97872623583922, 22.929525120804698, 21.7392142539223, 21.308008437355355, 21.63593054314454, 22.18683716095984, 22.02025094255805, 22.137121560052037, 25.101329624652863, 24.626124069094658, 25.2234447337687, 28.65051831677556, 28.74316895008087, 28.816221897490323, 22.318375894178942, 22.160722595949963, 22.24607531105478, 23.319662277897194, 22.404964854319886, 23.473703031738594, 18.849293308953435, 18.769386092821748, 19.32211255963435, 14.62790784239769, 15.767843321038526, 15.456480354070663, 21.311572308341653, 20.973197708527238, 21.481398011247308, 23.0767461117357, 22.25383932888508, 23.160706085152924, 24.695203726490334, 24.927546226729945, 24.799735782047108, 17.721233422557503, 16.962909976641328, 17.848900890598685, 23.75975665574272, 22.902986993392304, 23.86745176215966, 22.325032401403092, 22.160378633687884, 21.733225653568894, 17.31069583694139, 17.85039825613299, 17.213380749026925, 20.030949407567576, 20.18420704718058, 20.16346659356107, 28.354577630758286, 29.069676933810115, 29.047753060236573, 23.1878131677707, 23.41140430917342, 23.46743275908132, 24.066274548570306, 24.0266640211145, 24.090241159467638, 21.53522316863139, 21.706805941959217, 20.64105712374051, 19.957868007322148, 20.439156329802543, 20.16236789276202, 27.003176290541887, 26.22901400923729, 26.516493022441864, 21.437252463152006, 21.62768376184006, 21.682913481568292, 21.400301730881125, 21.222707363466412, 21.300548831621796, 22.055531095713377, 22.19171508960426, 22.02095628529787, 20.536886540551976, 20.834987557803586, 20.565065567692116, 21.39291840915878, 21.251831141610936, 21.205214013655976, 20.15896617869535, 21.163486023123056, 21.09953553850451, 23.816857740283012, 23.42355604469776, 23.902579613029957, 13.716283749789, 13.846727676689625, 13.090507566928864, 10.049608300129563, 8.993954608837754, 9.87287404636541, 17.51012313614288, 17.531000445286423, 17.58511679681638, 21.75508704284826, 22.314982076796383, 22.347441784959898, 22.649541196723774, 22.64285238211353, 22.37120710064967, 13.554364701112107, 14.384924729665116, 15.356075947483376, 18.881635089715317, 18.93131410827239, 19.219917842497424, 23.39029870927334, 23.883587876334786, 23.890091590583324, 8.771704236666352, 8.830253357688576, 9.257463874916226, 27.700482964515686, 28.177675161510706, 28.040040120482445, 19.193311750888824, 19.47028961777687, 19.31523636728525, 18.30450802793105, 17.675477897127465, 18.725451647614435, 21.47205705055967, 20.84013134241104, 21.399399507790804, 20.830467253923416, 21.02535744337365, 20.982933113351464, 24.194589748978615, 24.402752675116062, 24.01808050274849, 28.31752146780491, 28.324508231133223, 28.07796760648489, 29.413265466690063, 29.47837020456791, 29.317982152104378, 23.828966258559376, 23.81531369127333, 23.376730039715767, 10.768652538458497, 11.123581657807023, 11.337290377045662, 16.29988611675799, 15.932069718837738, 15.436754748225212, 18.64699125289917, 19.166055386886, 18.52926380932331, 27.77763447662194, 28.250957307716206, 27.86252337445815, 19.87237139542897, 20.288380300005272, 20.52312447627385, 20.63234904408455, 21.186715193092823, 20.443176940083504, 17.085207784548402, 17.090168176218867, 16.91555082798004, 27.76489596068859, 28.24279497563839, 27.960470348596573, 25.095391609938815, 24.292551577091217, 24.932511691004038, 19.516999161491782, 19.59871202117452, 19.05346846083799, 19.256887237230927, 18.5996555785338, 18.62242306272188, 14.65028265491128, 14.654550217092037, 14.89540170878172, 21.72508792579174, 21.841308750212193, 21.68378345295787, 22.08489007999499, 21.319576760133103, 22.492433178549007, 19.605860268697143, 19.59049273841083, 19.64726058859378, 24.89907560745874, 24.788741822044045, 24.406404996911675, 14.718859128654003, 14.914313985966146, 14.886596517637372, 10.108713120222092, 10.553269455209374, 10.477342367172241, 31.385004209975392, 31.57975974182287, 31.26528116563955, 11.21843149761358, 11.688675380932779, 11.724834981063992, 13.633477583527565, 14.457573064602911, 13.625019907951355, 25.357495603462056, 25.28102310498555, 25.770980875318244, 15.725428488105536, 15.779404312372208, 15.839934021234512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15308470214824926, "mean_inference_ms": 0.7052502201840981, "mean_action_processing_ms": 0.09999027236858508, "mean_env_wait_ms": 0.8077682719147117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2053116, "timesteps_this_iter": 0, "agent_timesteps_total": 6159348, "timers": {"sample_time_ms": 20225.163, "sample_throughput": 474.36, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3090.873, "learn_throughput": 3103.977, "update_time_ms": 8.999}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.875790046984935e-13, "cur_lr": 0.0005, "total_loss": 5.341148376464844, "policy_loss": 0.00014755004929090099, "vf_loss": 5.5434988141059875, "vf_explained_var": 0.17513055354356766, "kl": 0.007054286310855465, "entropy": 20.249785900115967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2053116, "num_agent_steps_sampled": 6159348, "num_steps_trained": 2053116, "num_agent_steps_trained": 6159348, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7663, "training_iteration": 214, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-55-24", "timestamp": 1706194524, "time_this_iter_s": 20.222320079803467, "time_total_s": 4319.914762735367, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4319.914762735367, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 10.48214285714286, "ram_util_percent": 53.542857142857144}}
{"episode_reward_max": 101.75386257935315, "episode_reward_min": 18.78933100029826, "episode_reward_mean": 61.99658663754621, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": 5.716798305511475}, "policy_reward_max": {"shared_policy": 34.03215929400176}, "policy_reward_mean": {"shared_policy": 20.665528879182062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.95089842751622, 86.20990916434675, 66.72517380118369, 69.19833016395567, 56.94079196140953, 45.85223151750688, 63.7661680281162, 68.4912915257737, 74.42248573526739, 52.533044289797516, 70.53019541129468, 66.21863668865987, 52.37447484210131, 60.37862304830922, 86.47200762480497, 70.06665023602544, 72.18317972915244, 63.88308623433112, 60.55939222988671, 79.74868332222104, 64.74784970656036, 63.923557925969334, 66.2682024706155, 61.93693966604768, 63.84996356442569, 62.42198774032292, 71.14299339801073, 40.65351899340749, 28.916436955332728, 52.62624037824568, 66.41751090460454, 67.66360067948698, 43.2953653782606, 57.03286704048513, 71.16397817619145, 26.859421469271155, 83.91819824650884, 57.97883773595095, 54.70543757267295, 63.711587900761515, 62.83875781064853, 72.61542292684317, 84.71999730542302, 88.20961782336235, 71.02100998954847, 33.22952457331118, 47.66871058382094, 56.34231044910848, 83.8911151587963, 60.68387617170809, 62.262241177260876, 51.09092678874731, 83.96816128492355, 74.32045487803407, 58.16917964350429, 56.478965878486605, 44.200234580785036, 65.2501801289618, 65.8969000186771, 58.843613595701754, 74.09422242641446, 44.51976963225752, 31.139324942603707, 94.23004511743781, 34.63194185961035, 41.71607055608183, 76.40949958376585, 47.344766821712255, 74.54492648597805, 81.45795882958916, 53.002270814031334, 66.32091133296488, 53.915635421872125, 92.66948650404808, 52.38842210225991, 66.13478872925043, 18.78933100029826, 40.28598353639245, 22.738697454333305, 57.98933117091654, 60.982932453043745, 80.34089111536738, 66.96373341232538, 76.30385107733306, 33.794650375843034, 101.75386257935315, 58.30020239204167, 89.38287609815596, 57.6394555866718, 74.81530548073351, 59.334475528448806, 53.82295141741632, 82.46019258769228, 62.31139691825953, 41.10207156464455, 59.00922178663312, 29.072400681674466, 57.926723323646, 94.2025440749712, 43.37459032610059], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [25.101329624652863, 24.626124069094658, 25.2234447337687, 28.65051831677556, 28.74316895008087, 28.816221897490323, 22.318375894178942, 22.160722595949963, 22.24607531105478, 23.319662277897194, 22.404964854319886, 23.473703031738594, 18.849293308953435, 18.769386092821748, 19.32211255963435, 14.62790784239769, 15.767843321038526, 15.456480354070663, 21.311572308341653, 20.973197708527238, 21.481398011247308, 23.0767461117357, 22.25383932888508, 23.160706085152924, 24.695203726490334, 24.927546226729945, 24.799735782047108, 17.721233422557503, 16.962909976641328, 17.848900890598685, 23.75975665574272, 22.902986993392304, 23.86745176215966, 22.325032401403092, 22.160378633687884, 21.733225653568894, 17.31069583694139, 17.85039825613299, 17.213380749026925, 20.030949407567576, 20.18420704718058, 20.16346659356107, 28.354577630758286, 29.069676933810115, 29.047753060236573, 23.1878131677707, 23.41140430917342, 23.46743275908132, 24.066274548570306, 24.0266640211145, 24.090241159467638, 21.53522316863139, 21.706805941959217, 20.64105712374051, 19.957868007322148, 20.439156329802543, 20.16236789276202, 27.003176290541887, 26.22901400923729, 26.516493022441864, 21.437252463152006, 21.62768376184006, 21.682913481568292, 21.400301730881125, 21.222707363466412, 21.300548831621796, 22.055531095713377, 22.19171508960426, 22.02095628529787, 20.536886540551976, 20.834987557803586, 20.565065567692116, 21.39291840915878, 21.251831141610936, 21.205214013655976, 20.15896617869535, 21.163486023123056, 21.09953553850451, 23.816857740283012, 23.42355604469776, 23.902579613029957, 13.716283749789, 13.846727676689625, 13.090507566928864, 10.049608300129563, 8.993954608837754, 9.87287404636541, 17.51012313614288, 17.531000445286423, 17.58511679681638, 21.75508704284826, 22.314982076796383, 22.347441784959898, 22.649541196723774, 22.64285238211353, 22.37120710064967, 13.554364701112107, 14.384924729665116, 15.356075947483376, 18.881635089715317, 18.93131410827239, 19.219917842497424, 23.39029870927334, 23.883587876334786, 23.890091590583324, 8.771704236666352, 8.830253357688576, 9.257463874916226, 27.700482964515686, 28.177675161510706, 28.040040120482445, 19.193311750888824, 19.47028961777687, 19.31523636728525, 18.30450802793105, 17.675477897127465, 18.725451647614435, 21.47205705055967, 20.84013134241104, 21.399399507790804, 20.830467253923416, 21.02535744337365, 20.982933113351464, 24.194589748978615, 24.402752675116062, 24.01808050274849, 28.31752146780491, 28.324508231133223, 28.07796760648489, 29.413265466690063, 29.47837020456791, 29.317982152104378, 23.828966258559376, 23.81531369127333, 23.376730039715767, 10.768652538458497, 11.123581657807023, 11.337290377045662, 16.29988611675799, 15.932069718837738, 15.436754748225212, 18.64699125289917, 19.166055386886, 18.52926380932331, 27.77763447662194, 28.250957307716206, 27.86252337445815, 19.87237139542897, 20.288380300005272, 20.52312447627385, 20.63234904408455, 21.186715193092823, 20.443176940083504, 17.085207784548402, 17.090168176218867, 16.91555082798004, 27.76489596068859, 28.24279497563839, 27.960470348596573, 25.095391609938815, 24.292551577091217, 24.932511691004038, 19.516999161491782, 19.59871202117452, 19.05346846083799, 19.256887237230927, 18.5996555785338, 18.62242306272188, 14.65028265491128, 14.654550217092037, 14.89540170878172, 21.72508792579174, 21.841308750212193, 21.68378345295787, 22.08489007999499, 21.319576760133103, 22.492433178549007, 19.605860268697143, 19.59049273841083, 19.64726058859378, 24.89907560745874, 24.788741822044045, 24.406404996911675, 14.718859128654003, 14.914313985966146, 14.886596517637372, 10.108713120222092, 10.553269455209374, 10.477342367172241, 31.385004209975392, 31.57975974182287, 31.26528116563955, 11.21843149761358, 11.688675380932779, 11.724834981063992, 13.633477583527565, 14.457573064602911, 13.625019907951355, 25.357495603462056, 25.28102310498555, 25.770980875318244, 15.725428488105536, 15.779404312372208, 15.839934021234512, 24.533143689235047, 24.63215847810109, 25.379624318641916, 27.208425814906747, 27.2260922078664, 27.023440806816012, 17.69094797472158, 17.919919497023017, 17.391403342286736, 22.4208488886555, 21.567831208308533, 22.33223123600085, 18.236268398662403, 18.126352441807583, 17.553014581402138, 30.8174290160338, 30.979070535550505, 30.872986952463776, 17.296284067134053, 17.590819605839584, 17.501318429286272, 22.174472846090794, 21.896120458841324, 22.064195424318314, 6.287833154201508, 6.7846995405852795, 5.716798305511475, 13.260238997638226, 13.474314723163843, 13.551429815590382, 7.482725009322166, 7.715940400958061, 7.540032044053078, 19.05520638575156, 19.40825682257612, 19.525867962588862, 20.274985296030835, 20.561315508869782, 20.146631648143128, 26.96598297233382, 26.452188568810612, 26.922719574222953, 22.251535329967737, 22.31391306221485, 22.398285020142794, 25.653673563773424, 25.175139079491288, 25.475038434068352, 11.354001988967255, 11.375671630104378, 11.0649767567714, 33.81066584959626, 33.911037435755134, 34.03215929400176, 18.767846157153443, 19.81848489058514, 19.713871344303087, 29.99220975240071, 30.315885474284485, 29.074780871470765, 18.569156209627778, 19.534417035679013, 19.53588234136501, 24.849180914461613, 24.79529194533825, 25.170832620933652, 19.61263646682103, 19.865752936651305, 19.85608612497647, 17.495594089229897, 18.174730995049075, 18.15262633313735, 27.646787980416164, 27.363213897993163, 27.45019070928295, 20.766351374487073, 20.549935253957898, 20.995110289814562, 13.598444024721772, 14.059672272453696, 13.443955267469079, 19.434295689066246, 19.74817752030988, 19.826748577256993, 9.11184125145276, 9.994839974989489, 9.965719455232218, 19.515414235997014, 19.00731762498617, 19.403991462662816, 31.531082440788538, 31.572373141689837, 31.099088492492825, 14.493150845170021, 14.193548321723938, 14.687891159206629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530803965987893, "mean_inference_ms": 0.7053582421367062, "mean_action_processing_ms": 0.09998379581591962, "mean_env_wait_ms": 0.8078096059260205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2062710, "timesteps_this_iter": 0, "agent_timesteps_total": 6188130, "timers": {"sample_time_ms": 20272.829, "sample_throughput": 473.244, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3109.215, "learn_throughput": 3085.667, "update_time_ms": 9.101}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.875790046984935e-13, "cur_lr": 0.0005, "total_loss": 6.3902363777160645, "policy_loss": 0.0006380150574767374, "vf_loss": 6.597042798995972, "vf_explained_var": 0.17033211886882782, "kl": 0.006053357472841563, "entropy": 20.744462251663208, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2062710, "num_agent_steps_sampled": 6188130, "num_steps_trained": 2062710, "num_agent_steps_trained": 6188130, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7695, "training_iteration": 215, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-55-44", "timestamp": 1706194544, "time_this_iter_s": 20.127199172973633, "time_total_s": 4340.04196190834, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA020538B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4340.04196190834, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 10.741379310344827, "ram_util_percent": 53.53448275862068}}
{"episode_reward_max": 101.75386257935315, "episode_reward_min": -310.8112049177289, "episode_reward_mean": 59.50132359585201, "episode_len_mean": 298.12, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -110.17760633428892}, "policy_reward_max": {"shared_policy": 34.21375632099807}, "policy_reward_mean": {"shared_policy": 19.833774531950667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.03286704048513, 71.16397817619145, 26.859421469271155, 83.91819824650884, 57.97883773595095, 54.70543757267295, 63.711587900761515, 62.83875781064853, 72.61542292684317, 84.71999730542302, 88.20961782336235, 71.02100998954847, 33.22952457331118, 47.66871058382094, 56.34231044910848, 83.8911151587963, 60.68387617170809, 62.262241177260876, 51.09092678874731, 83.96816128492355, 74.32045487803407, 58.16917964350429, 56.478965878486605, 44.200234580785036, 65.2501801289618, 65.8969000186771, 58.843613595701754, 74.09422242641446, 44.51976963225752, 31.139324942603707, 94.23004511743781, 34.63194185961035, 41.71607055608183, 76.40949958376585, 47.344766821712255, 74.54492648597805, 81.45795882958916, 53.002270814031334, 66.32091133296488, 53.915635421872125, 92.66948650404808, 52.38842210225991, 66.13478872925043, 18.78933100029826, 40.28598353639245, 22.738697454333305, 57.98933117091654, 60.982932453043745, 80.34089111536738, 66.96373341232538, 76.30385107733306, 33.794650375843034, 101.75386257935315, 58.30020239204167, 89.38287609815596, 57.6394555866718, 74.81530548073351, 59.334475528448806, 53.82295141741632, 82.46019258769228, 62.31139691825953, 41.10207156464455, 59.00922178663312, 29.072400681674466, 57.926723323646, 94.2025440749712, 43.37459032610059, 70.64420256763694, 62.427954953163834, 76.69066448137161, 66.80738281644881, 77.66347263380882, 62.43395237624644, 54.99132693745193, 51.10709281079468, 66.76552461087704, 64.82566343434154, 85.32373530045152, 72.4161956552416, 64.48729092441496, 95.73984281625596, 93.68940106034276, 74.61016392312013, 24.36742289364338, -310.8112049177289, 40.97707080608231, 72.6654028519988, 74.03491184115407, 92.23081807792185, 37.73876393586397, 46.050487864762545, 51.424462309107156, 52.347973812371464, 80.47181426454335, 66.16427966766058, 82.507785808295, 54.49823394324628, 72.40098688285795, 66.5325759425759, 101.61746428720653], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 112, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [18.881635089715317, 18.93131410827239, 19.219917842497424, 23.39029870927334, 23.883587876334786, 23.890091590583324, 8.771704236666352, 8.830253357688576, 9.257463874916226, 27.700482964515686, 28.177675161510706, 28.040040120482445, 19.193311750888824, 19.47028961777687, 19.31523636728525, 18.30450802793105, 17.675477897127465, 18.725451647614435, 21.47205705055967, 20.84013134241104, 21.399399507790804, 20.830467253923416, 21.02535744337365, 20.982933113351464, 24.194589748978615, 24.402752675116062, 24.01808050274849, 28.31752146780491, 28.324508231133223, 28.07796760648489, 29.413265466690063, 29.47837020456791, 29.317982152104378, 23.828966258559376, 23.81531369127333, 23.376730039715767, 10.768652538458497, 11.123581657807023, 11.337290377045662, 16.29988611675799, 15.932069718837738, 15.436754748225212, 18.64699125289917, 19.166055386886, 18.52926380932331, 27.77763447662194, 28.250957307716206, 27.86252337445815, 19.87237139542897, 20.288380300005272, 20.52312447627385, 20.63234904408455, 21.186715193092823, 20.443176940083504, 17.085207784548402, 17.090168176218867, 16.91555082798004, 27.76489596068859, 28.24279497563839, 27.960470348596573, 25.095391609938815, 24.292551577091217, 24.932511691004038, 19.516999161491782, 19.59871202117452, 19.05346846083799, 19.256887237230927, 18.5996555785338, 18.62242306272188, 14.65028265491128, 14.654550217092037, 14.89540170878172, 21.72508792579174, 21.841308750212193, 21.68378345295787, 22.08489007999499, 21.319576760133103, 22.492433178549007, 19.605860268697143, 19.59049273841083, 19.64726058859378, 24.89907560745874, 24.788741822044045, 24.406404996911675, 14.718859128654003, 14.914313985966146, 14.886596517637372, 10.108713120222092, 10.553269455209374, 10.477342367172241, 31.385004209975392, 31.57975974182287, 31.26528116563955, 11.21843149761358, 11.688675380932779, 11.724834981063992, 13.633477583527565, 14.457573064602911, 13.625019907951355, 25.357495603462056, 25.28102310498555, 25.770980875318244, 15.725428488105536, 15.779404312372208, 15.839934021234512, 24.533143689235047, 24.63215847810109, 25.379624318641916, 27.208425814906747, 27.2260922078664, 27.023440806816012, 17.69094797472158, 17.919919497023017, 17.391403342286736, 22.4208488886555, 21.567831208308533, 22.33223123600085, 18.236268398662403, 18.126352441807583, 17.553014581402138, 30.8174290160338, 30.979070535550505, 30.872986952463776, 17.296284067134053, 17.590819605839584, 17.501318429286272, 22.174472846090794, 21.896120458841324, 22.064195424318314, 6.287833154201508, 6.7846995405852795, 5.716798305511475, 13.260238997638226, 13.474314723163843, 13.551429815590382, 7.482725009322166, 7.715940400958061, 7.540032044053078, 19.05520638575156, 19.40825682257612, 19.525867962588862, 20.274985296030835, 20.561315508869782, 20.146631648143128, 26.96598297233382, 26.452188568810612, 26.922719574222953, 22.251535329967737, 22.31391306221485, 22.398285020142794, 25.653673563773424, 25.175139079491288, 25.475038434068352, 11.354001988967255, 11.375671630104378, 11.0649767567714, 33.81066584959626, 33.911037435755134, 34.03215929400176, 18.767846157153443, 19.81848489058514, 19.713871344303087, 29.99220975240071, 30.315885474284485, 29.074780871470765, 18.569156209627778, 19.534417035679013, 19.53588234136501, 24.849180914461613, 24.79529194533825, 25.170832620933652, 19.61263646682103, 19.865752936651305, 19.85608612497647, 17.495594089229897, 18.174730995049075, 18.15262633313735, 27.646787980416164, 27.363213897993163, 27.45019070928295, 20.766351374487073, 20.549935253957898, 20.995110289814562, 13.598444024721772, 14.059672272453696, 13.443955267469079, 19.434295689066246, 19.74817752030988, 19.826748577256993, 9.11184125145276, 9.994839974989489, 9.965719455232218, 19.515414235997014, 19.00731762498617, 19.403991462662816, 31.531082440788538, 31.572373141689837, 31.099088492492825, 14.493150845170021, 14.193548321723938, 14.687891159206629, 23.770201640824467, 23.409350166718156, 23.464650760094315, 20.90814164529243, 20.423698897163064, 21.09611441070834, 25.48429116110006, 25.39856172601381, 25.807811594257743, 22.07274904847145, 22.215779520571232, 22.518854247406125, 25.837351786593587, 26.100836633394152, 25.725284213821084, 20.61372162898381, 20.77798621853192, 21.042244528730706, 18.025263945261628, 18.567625970269233, 18.39843702192107, 17.266282480830938, 16.633832449714333, 17.20697788024941, 22.111426398158073, 22.267848879098892, 22.38624933362007, 21.70254223917921, 21.718025262778, 21.405095932384327, 28.554189767688513, 28.38812690600753, 28.381418626755476, 24.22265471735348, 23.955091324945286, 24.23844961294283, 21.739612334097416, 21.503086286286504, 21.244592304031045, 31.46115946273008, 32.145207376840204, 32.13347597668567, 31.362479119251162, 31.027637752393872, 31.299284188697726, 25.054159309482202, 24.70939050614834, 24.846614107489586, 7.840921327471733, 8.255437731742859, 8.271063834428787, -99.94102897991738, -110.17760633428892, -100.69256960352263, 13.715244420493633, 13.522512997190148, 13.739313388398529, 23.639963045716286, 24.520514644682407, 24.504925161600113, 24.74129422257343, 24.700668069223553, 24.592949549357087, 30.795681585868195, 30.581855585177735, 30.853280906875924, 12.665022358298302, 12.307438746094704, 12.766302831470966, 14.715742126107216, 15.508641444146633, 15.826104294508696, 17.150079861904175, 17.080905849734933, 17.19347659746805, 17.381274620691926, 17.618660456190497, 17.34803873548904, 26.99321656767279, 26.90982199087739, 26.568775705993176, 22.340919721250728, 21.789435019095734, 22.033924927314118, 27.301975068946675, 27.598257799943283, 27.60755293940504, 17.9752562145392, 18.179022683451564, 18.343955045255512, 23.710785309473664, 24.40858613854894, 24.281615434835345, 21.826626921693475, 22.536218690375478, 22.16973033050695, 33.71206317842007, 33.69164478778839, 34.21375632099807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15306808731675103, "mean_inference_ms": 0.7053964212693441, "mean_action_processing_ms": 0.0999779037821822, "mean_env_wait_ms": 0.8078280622542858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2072304, "timesteps_this_iter": 0, "agent_timesteps_total": 6216912, "timers": {"sample_time_ms": 20293.745, "sample_throughput": 472.756, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3091.928, "learn_throughput": 3102.918, "update_time_ms": 8.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.875790046984935e-13, "cur_lr": 0.0005, "total_loss": 65.3162488937378, "policy_loss": -0.00047825961546976714, "vf_loss": 65.52272033691406, "vf_explained_var": 0.030092813074588776, "kl": 0.010849653365282055, "entropy": 20.599472999572754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2072304, "num_agent_steps_sampled": 6216912, "num_steps_trained": 2072304, "num_agent_steps_trained": 6216912, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7728, "training_iteration": 216, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-56-04", "timestamp": 1706194564, "time_this_iter_s": 20.638901233673096, "time_total_s": 4360.680863142014, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A101F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4360.680863142014, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 9.644827586206898, "ram_util_percent": 53.589655172413785}}
{"episode_reward_max": 101.75386257935315, "episode_reward_min": -310.8112049177289, "episode_reward_mean": 59.00032231827208, "episode_len_mean": 298.12, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -110.17760633428892}, "policy_reward_max": {"shared_policy": 34.21375632099807}, "policy_reward_mean": {"shared_policy": 19.66677410609069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.23004511743781, 34.63194185961035, 41.71607055608183, 76.40949958376585, 47.344766821712255, 74.54492648597805, 81.45795882958916, 53.002270814031334, 66.32091133296488, 53.915635421872125, 92.66948650404808, 52.38842210225991, 66.13478872925043, 18.78933100029826, 40.28598353639245, 22.738697454333305, 57.98933117091654, 60.982932453043745, 80.34089111536738, 66.96373341232538, 76.30385107733306, 33.794650375843034, 101.75386257935315, 58.30020239204167, 89.38287609815596, 57.6394555866718, 74.81530548073351, 59.334475528448806, 53.82295141741632, 82.46019258769228, 62.31139691825953, 41.10207156464455, 59.00922178663312, 29.072400681674466, 57.926723323646, 94.2025440749712, 43.37459032610059, 70.64420256763694, 62.427954953163834, 76.69066448137161, 66.80738281644881, 77.66347263380882, 62.43395237624644, 54.99132693745193, 51.10709281079468, 66.76552461087704, 64.82566343434154, 85.32373530045152, 72.4161956552416, 64.48729092441496, 95.73984281625596, 93.68940106034276, 74.61016392312013, 24.36742289364338, -310.8112049177289, 40.97707080608231, 72.6654028519988, 74.03491184115407, 92.23081807792185, 37.73876393586397, 46.050487864762545, 51.424462309107156, 52.347973812371464, 80.47181426454335, 66.16427966766058, 82.507785808295, 54.49823394324628, 72.40098688285795, 66.5325759425759, 101.61746428720653, 62.525845505995676, 48.065897840075195, 29.277194998227046, 63.10237003257497, 71.39519698265937, 38.09968178346752, 38.80439059063791, 90.55967853032053, 49.33725409070027, 70.95694426447152, 71.39054394885896, 5.178784973919377, 58.1452038474381, 78.94961832463738, 46.99247464537618, 63.77612318843603, 30.605718173086643, 79.45858754310756, 70.5987907843664, 81.43739025201648, 23.031790655106306, 80.75452781282364, 73.81805009022354, 88.86914508789776, 59.41891638049856, 47.98973174393174, 85.04569936543703, 77.03411912173033, 69.87864193692803, 42.226405657827826], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 112, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [31.385004209975392, 31.57975974182287, 31.26528116563955, 11.21843149761358, 11.688675380932779, 11.724834981063992, 13.633477583527565, 14.457573064602911, 13.625019907951355, 25.357495603462056, 25.28102310498555, 25.770980875318244, 15.725428488105536, 15.779404312372208, 15.839934021234512, 24.533143689235047, 24.63215847810109, 25.379624318641916, 27.208425814906747, 27.2260922078664, 27.023440806816012, 17.69094797472158, 17.919919497023017, 17.391403342286736, 22.4208488886555, 21.567831208308533, 22.33223123600085, 18.236268398662403, 18.126352441807583, 17.553014581402138, 30.8174290160338, 30.979070535550505, 30.872986952463776, 17.296284067134053, 17.590819605839584, 17.501318429286272, 22.174472846090794, 21.896120458841324, 22.064195424318314, 6.287833154201508, 6.7846995405852795, 5.716798305511475, 13.260238997638226, 13.474314723163843, 13.551429815590382, 7.482725009322166, 7.715940400958061, 7.540032044053078, 19.05520638575156, 19.40825682257612, 19.525867962588862, 20.274985296030835, 20.561315508869782, 20.146631648143128, 26.96598297233382, 26.452188568810612, 26.922719574222953, 22.251535329967737, 22.31391306221485, 22.398285020142794, 25.653673563773424, 25.175139079491288, 25.475038434068352, 11.354001988967255, 11.375671630104378, 11.0649767567714, 33.81066584959626, 33.911037435755134, 34.03215929400176, 18.767846157153443, 19.81848489058514, 19.713871344303087, 29.99220975240071, 30.315885474284485, 29.074780871470765, 18.569156209627778, 19.534417035679013, 19.53588234136501, 24.849180914461613, 24.79529194533825, 25.170832620933652, 19.61263646682103, 19.865752936651305, 19.85608612497647, 17.495594089229897, 18.174730995049075, 18.15262633313735, 27.646787980416164, 27.363213897993163, 27.45019070928295, 20.766351374487073, 20.549935253957898, 20.995110289814562, 13.598444024721772, 14.059672272453696, 13.443955267469079, 19.434295689066246, 19.74817752030988, 19.826748577256993, 9.11184125145276, 9.994839974989489, 9.965719455232218, 19.515414235997014, 19.00731762498617, 19.403991462662816, 31.531082440788538, 31.572373141689837, 31.099088492492825, 14.493150845170021, 14.193548321723938, 14.687891159206629, 23.770201640824467, 23.409350166718156, 23.464650760094315, 20.90814164529243, 20.423698897163064, 21.09611441070834, 25.48429116110006, 25.39856172601381, 25.807811594257743, 22.07274904847145, 22.215779520571232, 22.518854247406125, 25.837351786593587, 26.100836633394152, 25.725284213821084, 20.61372162898381, 20.77798621853192, 21.042244528730706, 18.025263945261628, 18.567625970269233, 18.39843702192107, 17.266282480830938, 16.633832449714333, 17.20697788024941, 22.111426398158073, 22.267848879098892, 22.38624933362007, 21.70254223917921, 21.718025262778, 21.405095932384327, 28.554189767688513, 28.38812690600753, 28.381418626755476, 24.22265471735348, 23.955091324945286, 24.23844961294283, 21.739612334097416, 21.503086286286504, 21.244592304031045, 31.46115946273008, 32.145207376840204, 32.13347597668567, 31.362479119251162, 31.027637752393872, 31.299284188697726, 25.054159309482202, 24.70939050614834, 24.846614107489586, 7.840921327471733, 8.255437731742859, 8.271063834428787, -99.94102897991738, -110.17760633428892, -100.69256960352263, 13.715244420493633, 13.522512997190148, 13.739313388398529, 23.639963045716286, 24.520514644682407, 24.504925161600113, 24.74129422257343, 24.700668069223553, 24.592949549357087, 30.795681585868195, 30.581855585177735, 30.853280906875924, 12.665022358298302, 12.307438746094704, 12.766302831470966, 14.715742126107216, 15.508641444146633, 15.826104294508696, 17.150079861904175, 17.080905849734933, 17.19347659746805, 17.381274620691926, 17.618660456190497, 17.34803873548904, 26.99321656767279, 26.90982199087739, 26.568775705993176, 22.340919721250728, 21.789435019095734, 22.033924927314118, 27.301975068946675, 27.598257799943283, 27.60755293940504, 17.9752562145392, 18.179022683451564, 18.343955045255512, 23.710785309473664, 24.40858613854894, 24.281615434835345, 21.826626921693475, 22.536218690375478, 22.16973033050695, 33.71206317842007, 33.69164478778839, 34.21375632099807, 20.738676119595766, 20.9756106256973, 20.81155876070261, 15.571719005703926, 16.117650762200356, 16.376528072170913, 9.729794693489865, 10.014084238869444, 9.533316065867737, 21.215118300945804, 20.789375392099217, 21.097876339529947, 23.69520392517248, 23.956262085276336, 23.743730972210557, 12.622453418870762, 12.641507384677723, 12.835720979919031, 12.662051503856972, 13.018232954045132, 13.124106132735804, 29.838800832629204, 30.6175173278898, 30.10336036980152, 16.139166260759026, 16.35125459978977, 16.846833230151475, 23.83143664648135, 24.07518861194451, 23.050319006045655, 23.636537944277123, 23.880466721331075, 23.873539283250764, 1.9394793932636532, 1.9913940330346378, 1.2479115476210865, 19.364369802176952, 19.512443888932467, 19.268390156328678, 26.634354437390954, 25.694910059372575, 26.620353827873856, 15.57678687075773, 15.481751287976891, 15.933936486641556, 21.15037340670824, 21.431313268840313, 21.194436512887478, 10.315889671444893, 10.287305258214474, 10.002523243427277, 25.952927102645234, 26.69712639910479, 26.808534041357532, 22.97467842201391, 24.013179652082414, 23.610932710270077, 27.333090144209564, 26.975390940904617, 27.128909166902304, 7.740929327905178, 7.759122844785452, 7.531738482415676, 27.060505387683705, 26.659439255793885, 27.03458316934605, 24.456953359146908, 24.516233568390206, 24.844863162686423, 29.318394159277275, 29.741412383814648, 29.80933854480584, 19.930297431070358, 19.65112442523241, 19.83749452419579, 15.825524533788354, 16.00896844516197, 16.15523876498142, 28.22616972029209, 28.276947364211082, 28.542582280933857, 25.443099692463875, 25.69049108028412, 25.900528348982334, 23.50716770067811, 22.983291245996952, 23.38818299025297, 14.713965999583394, 13.888021270434052, 13.62441838781038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530481476348284, "mean_inference_ms": 0.7055153245903036, "mean_action_processing_ms": 0.10001033823096957, "mean_env_wait_ms": 0.8078621333153125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2081898, "timesteps_this_iter": 0, "agent_timesteps_total": 6245694, "timers": {"sample_time_ms": 20239.539, "sample_throughput": 474.023, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3093.67, "learn_throughput": 3101.171, "update_time_ms": 8.795}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.875790046984935e-13, "cur_lr": 0.0005, "total_loss": 6.647575259208679, "policy_loss": -0.000891387993060544, "vf_loss": 6.852253198623657, "vf_explained_var": 0.17271802574396133, "kl": 0.004220280956786632, "entropy": 20.378655433654785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2081898, "num_agent_steps_sampled": 6245694, "num_steps_trained": 2081898, "num_agent_steps_trained": 6245694, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7758, "training_iteration": 217, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-56-24", "timestamp": 1706194584, "time_this_iter_s": 19.626525402069092, "time_total_s": 4380.307388544083, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0175C8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4380.307388544083, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 10.053571428571429, "ram_util_percent": 53.8607142857143}}
{"episode_reward_max": 114.93642088770866, "episode_reward_min": -310.8112049177289, "episode_reward_mean": 61.58820711711771, "episode_len_mean": 298.12, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"shared_policy": -110.17760633428892}, "policy_reward_max": {"shared_policy": 39.09825322777033}, "policy_reward_mean": {"shared_policy": 20.529402372372562}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.926723323646, 94.2025440749712, 43.37459032610059, 70.64420256763694, 62.427954953163834, 76.69066448137161, 66.80738281644881, 77.66347263380882, 62.43395237624644, 54.99132693745193, 51.10709281079468, 66.76552461087704, 64.82566343434154, 85.32373530045152, 72.4161956552416, 64.48729092441496, 95.73984281625596, 93.68940106034276, 74.61016392312013, 24.36742289364338, -310.8112049177289, 40.97707080608231, 72.6654028519988, 74.03491184115407, 92.23081807792185, 37.73876393586397, 46.050487864762545, 51.424462309107156, 52.347973812371464, 80.47181426454335, 66.16427966766058, 82.507785808295, 54.49823394324628, 72.40098688285795, 66.5325759425759, 101.61746428720653, 62.525845505995676, 48.065897840075195, 29.277194998227046, 63.10237003257497, 71.39519698265937, 38.09968178346752, 38.80439059063791, 90.55967853032053, 49.33725409070027, 70.95694426447152, 71.39054394885896, 5.178784973919377, 58.1452038474381, 78.94961832463738, 46.99247464537618, 63.77612318843603, 30.605718173086643, 79.45858754310756, 70.5987907843664, 81.43739025201648, 23.031790655106306, 80.75452781282364, 73.81805009022354, 88.86914508789776, 59.41891638049856, 47.98973174393174, 85.04569936543703, 77.03411912173033, 69.87864193692803, 42.226405657827826, 49.02434897655618, 65.56140117347239, 81.05451032333075, 75.79006833815947, 73.30514873936772, 37.37830019742249, 80.44824779871851, 63.828837360255406, 85.2418240532279, 53.998978698626146, 18.234808675944777, 44.344217048957915, 52.22818981856108, 65.55204276926813, 77.59891540929672, 80.32957967370749, 64.24224202986804, 85.93813131004569, 73.1427781023085, 78.27140082046387, 85.6330690346658, 73.87140849325806, 65.93746657948938, 50.57524207793176, 71.13834725040942, 114.93642088770866, 62.23722229152918, 59.854156229644985, 60.54849197715521, 103.03971274010837, 69.08793121343479, 71.8628558581695, 52.32448365353048, 74.18823865614829], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 112, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.515414235997014, 19.00731762498617, 19.403991462662816, 31.531082440788538, 31.572373141689837, 31.099088492492825, 14.493150845170021, 14.193548321723938, 14.687891159206629, 23.770201640824467, 23.409350166718156, 23.464650760094315, 20.90814164529243, 20.423698897163064, 21.09611441070834, 25.48429116110006, 25.39856172601381, 25.807811594257743, 22.07274904847145, 22.215779520571232, 22.518854247406125, 25.837351786593587, 26.100836633394152, 25.725284213821084, 20.61372162898381, 20.77798621853192, 21.042244528730706, 18.025263945261628, 18.567625970269233, 18.39843702192107, 17.266282480830938, 16.633832449714333, 17.20697788024941, 22.111426398158073, 22.267848879098892, 22.38624933362007, 21.70254223917921, 21.718025262778, 21.405095932384327, 28.554189767688513, 28.38812690600753, 28.381418626755476, 24.22265471735348, 23.955091324945286, 24.23844961294283, 21.739612334097416, 21.503086286286504, 21.244592304031045, 31.46115946273008, 32.145207376840204, 32.13347597668567, 31.362479119251162, 31.027637752393872, 31.299284188697726, 25.054159309482202, 24.70939050614834, 24.846614107489586, 7.840921327471733, 8.255437731742859, 8.271063834428787, -99.94102897991738, -110.17760633428892, -100.69256960352263, 13.715244420493633, 13.522512997190148, 13.739313388398529, 23.639963045716286, 24.520514644682407, 24.504925161600113, 24.74129422257343, 24.700668069223553, 24.592949549357087, 30.795681585868195, 30.581855585177735, 30.853280906875924, 12.665022358298302, 12.307438746094704, 12.766302831470966, 14.715742126107216, 15.508641444146633, 15.826104294508696, 17.150079861904175, 17.080905849734933, 17.19347659746805, 17.381274620691926, 17.618660456190497, 17.34803873548904, 26.99321656767279, 26.90982199087739, 26.568775705993176, 22.340919721250728, 21.789435019095734, 22.033924927314118, 27.301975068946675, 27.598257799943283, 27.60755293940504, 17.9752562145392, 18.179022683451564, 18.343955045255512, 23.710785309473664, 24.40858613854894, 24.281615434835345, 21.826626921693475, 22.536218690375478, 22.16973033050695, 33.71206317842007, 33.69164478778839, 34.21375632099807, 20.738676119595766, 20.9756106256973, 20.81155876070261, 15.571719005703926, 16.117650762200356, 16.376528072170913, 9.729794693489865, 10.014084238869444, 9.533316065867737, 21.215118300945804, 20.789375392099217, 21.097876339529947, 23.69520392517248, 23.956262085276336, 23.743730972210557, 12.622453418870762, 12.641507384677723, 12.835720979919031, 12.662051503856972, 13.018232954045132, 13.124106132735804, 29.838800832629204, 30.6175173278898, 30.10336036980152, 16.139166260759026, 16.35125459978977, 16.846833230151475, 23.83143664648135, 24.07518861194451, 23.050319006045655, 23.636537944277123, 23.880466721331075, 23.873539283250764, 1.9394793932636532, 1.9913940330346378, 1.2479115476210865, 19.364369802176952, 19.512443888932467, 19.268390156328678, 26.634354437390954, 25.694910059372575, 26.620353827873856, 15.57678687075773, 15.481751287976891, 15.933936486641556, 21.15037340670824, 21.431313268840313, 21.194436512887478, 10.315889671444893, 10.287305258214474, 10.002523243427277, 25.952927102645234, 26.69712639910479, 26.808534041357532, 22.97467842201391, 24.013179652082414, 23.610932710270077, 27.333090144209564, 26.975390940904617, 27.128909166902304, 7.740929327905178, 7.759122844785452, 7.531738482415676, 27.060505387683705, 26.659439255793885, 27.03458316934605, 24.456953359146908, 24.516233568390206, 24.844863162686423, 29.318394159277275, 29.741412383814648, 29.80933854480584, 19.930297431070358, 19.65112442523241, 19.83749452419579, 15.825524533788354, 16.00896844516197, 16.15523876498142, 28.22616972029209, 28.276947364211082, 28.542582280933857, 25.443099692463875, 25.69049108028412, 25.900528348982334, 23.50716770067811, 22.983291245996952, 23.38818299025297, 14.713965999583394, 13.888021270434052, 13.62441838781038, 15.979933033386857, 16.707059820337832, 16.337356122831494, 22.387176503737763, 22.33049464722474, 20.843730022509888, 26.787825142343834, 27.083958358814314, 27.182726822172597, 25.297057383693755, 25.193056102842093, 25.299954851623625, 24.334923692047596, 24.368954442441463, 24.601270604878664, 12.543457520504788, 12.589826842149094, 12.245015834768608, 26.198329895734787, 26.957513511180878, 27.292404391802847, 21.330799018343285, 20.996970278521374, 21.501068063390747, 28.67352370172739, 28.266787603497505, 28.301512748003006, 17.912959323575095, 17.92636066426833, 18.159658710782722, 6.51088975618282, 6.18085306386152, 5.543065855900437, 14.59496062497297, 15.076893617088587, 14.67236280689636, 17.356262281537056, 17.316573560237885, 17.555353976786137, 22.064898215855152, 21.412723312775285, 22.07442124063769, 25.430699000755936, 26.21135990197459, 25.956856506566197, 26.742784902453423, 27.21921343356371, 26.367581337690353, 21.549696425596863, 21.862381176712603, 20.83016442755857, 28.79375650982061, 28.52080665032068, 28.6235681499044, 24.664206614096955, 24.947791301955775, 23.530780186255768, 25.5533150533835, 26.508071585247905, 26.210014181832463, 28.83170899624625, 28.25495334963003, 28.546406688789517, 24.591372668743134, 24.88516786042601, 24.394867964088917, 22.047097763667495, 22.132766471865267, 21.75760234395662, 16.624521031975746, 16.71855589002371, 17.232165155932307, 23.582880530506372, 23.797819736413658, 23.757646983489394, 37.018153607845306, 39.09825322777033, 38.82001405209303, 20.771759048104286, 20.378901407122612, 21.08656183630228, 19.88483432183662, 19.826082209746033, 20.14323969806233, 20.470396533608437, 20.22076814621687, 19.857327297329903, 34.24500536546111, 34.33420863375068, 34.46049874089658, 22.54326805472374, 23.24816120788455, 23.296501950826496, 23.481314092874527, 24.14077320508659, 24.24076856020838, 17.325763177126646, 17.51479971781373, 17.483920758590102, 24.951798026139528, 24.2791780779759, 24.95726255203286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15302816229394045, "mean_inference_ms": 0.7054228653093094, "mean_action_processing_ms": 0.09997802075902655, "mean_env_wait_ms": 0.807806376062381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2091492, "timesteps_this_iter": 0, "agent_timesteps_total": 6274476, "timers": {"sample_time_ms": 20190.161, "sample_throughput": 475.182, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3093.272, "learn_throughput": 3101.571, "update_time_ms": 8.794}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.9378950234924675e-13, "cur_lr": 0.0005, "total_loss": 6.617179334163666, "policy_loss": -0.0009779248761629944, "vf_loss": 6.82157039642334, "vf_explained_var": 0.13950848579406738, "kl": 0.006689320959105194, "entropy": 20.34133505821228, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2091492, "num_agent_steps_sampled": 6274476, "num_steps_trained": 2091492, "num_agent_steps_trained": 6274476, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7792, "training_iteration": 218, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-56-43", "timestamp": 1706194603, "time_this_iter_s": 19.26867914199829, "time_total_s": 4399.576067686081, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA02076700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4399.576067686081, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 8.537037037037036, "ram_util_percent": 54.11851851851851}}
{"episode_reward_max": 116.44347176142037, "episode_reward_min": -29.221516908612102, "episode_reward_mean": 63.444376496488694, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -9.898102447390556}, "policy_reward_max": {"shared_policy": 39.09825322777033}, "policy_reward_mean": {"shared_policy": 21.148125498829558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.47181426454335, 66.16427966766058, 82.507785808295, 54.49823394324628, 72.40098688285795, 66.5325759425759, 101.61746428720653, 62.525845505995676, 48.065897840075195, 29.277194998227046, 63.10237003257497, 71.39519698265937, 38.09968178346752, 38.80439059063791, 90.55967853032053, 49.33725409070027, 70.95694426447152, 71.39054394885896, 5.178784973919377, 58.1452038474381, 78.94961832463738, 46.99247464537618, 63.77612318843603, 30.605718173086643, 79.45858754310756, 70.5987907843664, 81.43739025201648, 23.031790655106306, 80.75452781282364, 73.81805009022354, 88.86914508789776, 59.41891638049856, 47.98973174393174, 85.04569936543703, 77.03411912173033, 69.87864193692803, 42.226405657827826, 49.02434897655618, 65.56140117347239, 81.05451032333075, 75.79006833815947, 73.30514873936772, 37.37830019742249, 80.44824779871851, 63.828837360255406, 85.2418240532279, 53.998978698626146, 18.234808675944777, 44.344217048957915, 52.22818981856108, 65.55204276926813, 77.59891540929672, 80.32957967370749, 64.24224202986804, 85.93813131004569, 73.1427781023085, 78.27140082046387, 85.6330690346658, 73.87140849325806, 65.93746657948938, 50.57524207793176, 71.13834725040942, 114.93642088770866, 62.23722229152918, 59.854156229644985, 60.54849197715521, 103.03971274010837, 69.08793121343479, 71.8628558581695, 52.32448365353048, 74.18823865614829, 56.810727924108505, 44.01622231490907, 77.55180662777275, 75.68706998974085, 73.17614896781741, 48.5395252406597, 74.446968129836, 55.339496357366414, 66.80447448417542, 44.7818930223584, 56.21632739063351, 55.26182423159477, 70.8864866271615, 38.96594314370303, 73.68218664079903, 46.988422974944086, 61.47983574867246, 50.3834995739162, 101.12905390560626, 38.87954001594332, 116.44347176142037, 37.32851020433006, 80.20624929619952, 73.13843337446448, 101.47885998897252, 10.201396817341433, 62.647502053528996, -29.221516908612102, 39.52041253959759], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [26.99321656767279, 26.90982199087739, 26.568775705993176, 22.340919721250728, 21.789435019095734, 22.033924927314118, 27.301975068946675, 27.598257799943283, 27.60755293940504, 17.9752562145392, 18.179022683451564, 18.343955045255512, 23.710785309473664, 24.40858613854894, 24.281615434835345, 21.826626921693475, 22.536218690375478, 22.16973033050695, 33.71206317842007, 33.69164478778839, 34.21375632099807, 20.738676119595766, 20.9756106256973, 20.81155876070261, 15.571719005703926, 16.117650762200356, 16.376528072170913, 9.729794693489865, 10.014084238869444, 9.533316065867737, 21.215118300945804, 20.789375392099217, 21.097876339529947, 23.69520392517248, 23.956262085276336, 23.743730972210557, 12.622453418870762, 12.641507384677723, 12.835720979919031, 12.662051503856972, 13.018232954045132, 13.124106132735804, 29.838800832629204, 30.6175173278898, 30.10336036980152, 16.139166260759026, 16.35125459978977, 16.846833230151475, 23.83143664648135, 24.07518861194451, 23.050319006045655, 23.636537944277123, 23.880466721331075, 23.873539283250764, 1.9394793932636532, 1.9913940330346378, 1.2479115476210865, 19.364369802176952, 19.512443888932467, 19.268390156328678, 26.634354437390954, 25.694910059372575, 26.620353827873856, 15.57678687075773, 15.481751287976891, 15.933936486641556, 21.15037340670824, 21.431313268840313, 21.194436512887478, 10.315889671444893, 10.287305258214474, 10.002523243427277, 25.952927102645234, 26.69712639910479, 26.808534041357532, 22.97467842201391, 24.013179652082414, 23.610932710270077, 27.333090144209564, 26.975390940904617, 27.128909166902304, 7.740929327905178, 7.759122844785452, 7.531738482415676, 27.060505387683705, 26.659439255793885, 27.03458316934605, 24.456953359146908, 24.516233568390206, 24.844863162686423, 29.318394159277275, 29.741412383814648, 29.80933854480584, 19.930297431070358, 19.65112442523241, 19.83749452419579, 15.825524533788354, 16.00896844516197, 16.15523876498142, 28.22616972029209, 28.276947364211082, 28.542582280933857, 25.443099692463875, 25.69049108028412, 25.900528348982334, 23.50716770067811, 22.983291245996952, 23.38818299025297, 14.713965999583394, 13.888021270434052, 13.62441838781038, 15.979933033386857, 16.707059820337832, 16.337356122831494, 22.387176503737763, 22.33049464722474, 20.843730022509888, 26.787825142343834, 27.083958358814314, 27.182726822172597, 25.297057383693755, 25.193056102842093, 25.299954851623625, 24.334923692047596, 24.368954442441463, 24.601270604878664, 12.543457520504788, 12.589826842149094, 12.245015834768608, 26.198329895734787, 26.957513511180878, 27.292404391802847, 21.330799018343285, 20.996970278521374, 21.501068063390747, 28.67352370172739, 28.266787603497505, 28.301512748003006, 17.912959323575095, 17.92636066426833, 18.159658710782722, 6.51088975618282, 6.18085306386152, 5.543065855900437, 14.59496062497297, 15.076893617088587, 14.67236280689636, 17.356262281537056, 17.316573560237885, 17.555353976786137, 22.064898215855152, 21.412723312775285, 22.07442124063769, 25.430699000755936, 26.21135990197459, 25.956856506566197, 26.742784902453423, 27.21921343356371, 26.367581337690353, 21.549696425596863, 21.862381176712603, 20.83016442755857, 28.79375650982061, 28.52080665032068, 28.6235681499044, 24.664206614096955, 24.947791301955775, 23.530780186255768, 25.5533150533835, 26.508071585247905, 26.210014181832463, 28.83170899624625, 28.25495334963003, 28.546406688789517, 24.591372668743134, 24.88516786042601, 24.394867964088917, 22.047097763667495, 22.132766471865267, 21.75760234395662, 16.624521031975746, 16.71855589002371, 17.232165155932307, 23.582880530506372, 23.797819736413658, 23.757646983489394, 37.018153607845306, 39.09825322777033, 38.82001405209303, 20.771759048104286, 20.378901407122612, 21.08656183630228, 19.88483432183662, 19.826082209746033, 20.14323969806233, 20.470396533608437, 20.22076814621687, 19.857327297329903, 34.24500536546111, 34.33420863375068, 34.46049874089658, 22.54326805472374, 23.24816120788455, 23.296501950826496, 23.481314092874527, 24.14077320508659, 24.24076856020838, 17.325763177126646, 17.51479971781373, 17.483920758590102, 24.951798026139528, 24.2791780779759, 24.95726255203286, 18.48313708603382, 19.173292376101017, 19.154298461973667, 14.71694856385389, 14.396568755308778, 14.902704995746404, 25.981584965251386, 25.717411782592535, 25.852809879928827, 25.186758793890476, 25.168655447661877, 25.331655748188496, 24.18958493073781, 24.350512367983654, 24.63605166909595, 16.262670466055468, 16.186068159838513, 16.09078661476572, 25.01453075899431, 24.436871240536362, 24.99556613030532, 18.70132210912803, 18.390728610257298, 18.247445637981087, 21.59409976998964, 22.574436138073594, 22.63593857611218, 14.710924891134098, 15.048863147695855, 15.02210498352845, 18.94712540817757, 18.96845514917125, 18.30074683328469, 18.449450845519692, 18.096769491831452, 18.71560389424363, 23.759705029428005, 23.314724132418633, 23.812057465314865, 12.798978437980011, 12.903125633796051, 13.263839071926967, 24.4064333786567, 24.330576707919434, 24.945176554222897, 15.723804655174405, 15.667715306083352, 15.59690301368633, 20.335780958334595, 20.52780425051847, 20.61625053981939, 16.55904023349285, 17.18359623476863, 16.640863105654716, 33.96151614685853, 33.36364870270093, 33.8038890560468, 12.984792331854493, 12.411124671498925, 13.483623012589902, 38.89241167716682, 38.78492188081145, 38.7661382034421, 12.636129506553203, 12.114886189500481, 12.577494508276374, 26.897308742006615, 27.10767838809018, 26.201262166102723, 24.3915871332089, 24.371772463122994, 24.375073778132588, 33.777539814511925, 33.99967271896699, 33.7016474554936, 3.781778416906789, 2.9560019125541004, 3.463616487880543, 20.930072753379733, 20.74418547997871, 20.973243820170552, -9.554896628018469, -9.898102447390556, -9.768517833203077, 13.254191106495753, 12.960598905881241, 13.305622527220592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300464331444266, "mean_inference_ms": 0.7054465586861227, "mean_action_processing_ms": 0.10001283578514704, "mean_env_wait_ms": 0.807739311716546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2101086, "timesteps_this_iter": 0, "agent_timesteps_total": 6303258, "timers": {"sample_time_ms": 20204.584, "sample_throughput": 474.843, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 3066.38, "learn_throughput": 3128.77, "update_time_ms": 8.794}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.9378950234924675e-13, "cur_lr": 0.0005, "total_loss": 7.6457502245903015, "policy_loss": -0.001099192483779543, "vf_loss": 7.854061543941498, "vf_explained_var": 0.1555219367146492, "kl": 0.005348293569550101, "entropy": 20.721193313598633, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2101086, "num_agent_steps_sampled": 6303258, "num_steps_trained": 2101086, "num_agent_steps_trained": 6303258, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7821, "training_iteration": 219, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-57-03", "timestamp": 1706194623, "time_this_iter_s": 19.555453300476074, "time_total_s": 4419.131520986557, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BD7A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4419.131520986557, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 8.562962962962963, "ram_util_percent": 53.86296296296295}}
{"episode_reward_max": 116.44347176142037, "episode_reward_min": -29.221516908612102, "episode_reward_mean": 63.10205809347215, "episode_len_mean": 300.0, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -9.898102447390556}, "policy_reward_max": {"shared_policy": 39.09825322777033}, "policy_reward_mean": {"shared_policy": 21.03401936449071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.87864193692803, 42.226405657827826, 49.02434897655618, 65.56140117347239, 81.05451032333075, 75.79006833815947, 73.30514873936772, 37.37830019742249, 80.44824779871851, 63.828837360255406, 85.2418240532279, 53.998978698626146, 18.234808675944777, 44.344217048957915, 52.22818981856108, 65.55204276926813, 77.59891540929672, 80.32957967370749, 64.24224202986804, 85.93813131004569, 73.1427781023085, 78.27140082046387, 85.6330690346658, 73.87140849325806, 65.93746657948938, 50.57524207793176, 71.13834725040942, 114.93642088770866, 62.23722229152918, 59.854156229644985, 60.54849197715521, 103.03971274010837, 69.08793121343479, 71.8628558581695, 52.32448365353048, 74.18823865614829, 56.810727924108505, 44.01622231490907, 77.55180662777275, 75.68706998974085, 73.17614896781741, 48.5395252406597, 74.446968129836, 55.339496357366414, 66.80447448417542, 44.7818930223584, 56.21632739063351, 55.26182423159477, 70.8864866271615, 38.96594314370303, 73.68218664079903, 46.988422974944086, 61.47983574867246, 50.3834995739162, 101.12905390560626, 38.87954001594332, 116.44347176142037, 37.32851020433006, 80.20624929619952, 73.13843337446448, 101.47885998897252, 10.201396817341433, 62.647502053528996, -29.221516908612102, 39.52041253959759, 87.72781904786824, 61.09412334486841, 77.3291128799319, 71.48382880934513, 56.293018162250505, 26.60449004452674, 82.83202707394956, 64.2953544605989, 97.05564466863869, 57.04746887553483, 96.5097764916718, 81.48109016939998, 72.0676955617964, 67.27111710887401, 29.917934104800196, 74.71372446988242, 44.304189182585105, 57.27182536572215, 64.09446749091146, 87.0005224868655, 82.7393919993192, 61.36155063286422, 82.90203316509721, 60.288553057238445, 45.92660297174005, 47.209348917007446, 81.92375817522405, 85.15532691963016, 73.7277454100549, 27.339803522452712, -0.2379032187164114, 56.186648864299045, 33.967507432214916, 66.00786114856598, 13.687512255739392], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.50716770067811, 22.983291245996952, 23.38818299025297, 14.713965999583394, 13.888021270434052, 13.62441838781038, 15.979933033386857, 16.707059820337832, 16.337356122831494, 22.387176503737763, 22.33049464722474, 20.843730022509888, 26.787825142343834, 27.083958358814314, 27.182726822172597, 25.297057383693755, 25.193056102842093, 25.299954851623625, 24.334923692047596, 24.368954442441463, 24.601270604878664, 12.543457520504788, 12.589826842149094, 12.245015834768608, 26.198329895734787, 26.957513511180878, 27.292404391802847, 21.330799018343285, 20.996970278521374, 21.501068063390747, 28.67352370172739, 28.266787603497505, 28.301512748003006, 17.912959323575095, 17.92636066426833, 18.159658710782722, 6.51088975618282, 6.18085306386152, 5.543065855900437, 14.59496062497297, 15.076893617088587, 14.67236280689636, 17.356262281537056, 17.316573560237885, 17.555353976786137, 22.064898215855152, 21.412723312775285, 22.07442124063769, 25.430699000755936, 26.21135990197459, 25.956856506566197, 26.742784902453423, 27.21921343356371, 26.367581337690353, 21.549696425596863, 21.862381176712603, 20.83016442755857, 28.79375650982061, 28.52080665032068, 28.6235681499044, 24.664206614096955, 24.947791301955775, 23.530780186255768, 25.5533150533835, 26.508071585247905, 26.210014181832463, 28.83170899624625, 28.25495334963003, 28.546406688789517, 24.591372668743134, 24.88516786042601, 24.394867964088917, 22.047097763667495, 22.132766471865267, 21.75760234395662, 16.624521031975746, 16.71855589002371, 17.232165155932307, 23.582880530506372, 23.797819736413658, 23.757646983489394, 37.018153607845306, 39.09825322777033, 38.82001405209303, 20.771759048104286, 20.378901407122612, 21.08656183630228, 19.88483432183662, 19.826082209746033, 20.14323969806233, 20.470396533608437, 20.22076814621687, 19.857327297329903, 34.24500536546111, 34.33420863375068, 34.46049874089658, 22.54326805472374, 23.24816120788455, 23.296501950826496, 23.481314092874527, 24.14077320508659, 24.24076856020838, 17.325763177126646, 17.51479971781373, 17.483920758590102, 24.951798026139528, 24.2791780779759, 24.95726255203286, 18.48313708603382, 19.173292376101017, 19.154298461973667, 14.71694856385389, 14.396568755308778, 14.902704995746404, 25.981584965251386, 25.717411782592535, 25.852809879928827, 25.186758793890476, 25.168655447661877, 25.331655748188496, 24.18958493073781, 24.350512367983654, 24.63605166909595, 16.262670466055468, 16.186068159838513, 16.09078661476572, 25.01453075899431, 24.436871240536362, 24.99556613030532, 18.70132210912803, 18.390728610257298, 18.247445637981087, 21.59409976998964, 22.574436138073594, 22.63593857611218, 14.710924891134098, 15.048863147695855, 15.02210498352845, 18.94712540817757, 18.96845514917125, 18.30074683328469, 18.449450845519692, 18.096769491831452, 18.71560389424363, 23.759705029428005, 23.314724132418633, 23.812057465314865, 12.798978437980011, 12.903125633796051, 13.263839071926967, 24.4064333786567, 24.330576707919434, 24.945176554222897, 15.723804655174405, 15.667715306083352, 15.59690301368633, 20.335780958334595, 20.52780425051847, 20.61625053981939, 16.55904023349285, 17.18359623476863, 16.640863105654716, 33.96151614685853, 33.36364870270093, 33.8038890560468, 12.984792331854493, 12.411124671498925, 13.483623012589902, 38.89241167716682, 38.78492188081145, 38.7661382034421, 12.636129506553203, 12.114886189500481, 12.577494508276374, 26.897308742006615, 27.10767838809018, 26.201262166102723, 24.3915871332089, 24.371772463122994, 24.375073778132588, 33.777539814511925, 33.99967271896699, 33.7016474554936, 3.781778416906789, 2.9560019125541004, 3.463616487880543, 20.930072753379733, 20.74418547997871, 20.973243820170552, -9.554896628018469, -9.898102447390556, -9.768517833203077, 13.254191106495753, 12.960598905881241, 13.305622527220592, 28.970142876108483, 29.72550333787997, 29.032172833879784, 20.30432694156964, 20.07947676380475, 20.710319639494017, 25.269578556219727, 25.88001654545465, 26.17951777825752, 24.03875406978962, 23.70225366701682, 23.74282107253869, 18.483676215012864, 18.767453407247856, 19.041888539989785, 8.879406058539942, 8.91044811562945, 8.81463587035735, 27.1111755122741, 27.976236590494707, 27.744614971180752, 21.888942015590146, 21.31653333455324, 21.089879110455513, 32.17805415888627, 32.426186469693974, 32.45140404005845, 19.090764950960875, 19.218268119730055, 18.738435804843903, 32.338584035634995, 31.93234645575285, 32.23884600028396, 27.52741776406765, 27.454460319131613, 26.499212086200714, 24.12370433534184, 23.968574511508137, 23.97541671494642, 22.48220766646166, 22.470668817249432, 22.318240625162915, 10.017257350186497, 9.875477905074746, 10.025198849538953, 24.85400818039973, 25.425665858628534, 24.434050430854157, 14.667073674499989, 14.624960087239742, 15.012155420845374, 19.097018251816422, 19.145222465197236, 19.029584648708493, 21.39593982199827, 21.29148983458677, 21.407037834326417, 28.952793573339775, 28.388684560855225, 29.659044352670506, 27.659952141344547, 27.996662775054574, 27.082777082920074, 20.384351437290505, 20.595156469692782, 20.382042725880936, 27.456907774011285, 27.53371878961721, 27.911406601468713, 19.47083555658658, 20.57706065041323, 20.240656850238636, 15.351185368684426, 15.286111899962023, 15.289305703093603, 15.534783780574799, 15.510391250252724, 16.164173886179924, 27.539726362874106, 27.200853300591305, 27.18317851175864, 28.565725910787776, 28.089651775856808, 28.49994923298557, 24.7393308567504, 24.665030295650155, 24.32338425765434, 9.376787900924683, 8.589265704154968, 9.373749917373061, -0.15110623588165595, -0.2788371642430718, 0.19204018140831636, 18.760354337592915, 18.554991898437336, 18.871302628268793, 11.361641626805067, 11.070647150278091, 11.535218655131757, 22.278212590763957, 21.668484325210244, 22.06116423259178, 4.878907473913074, 4.61985472838083, 4.188750053445489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300059476124947, "mean_inference_ms": 0.7053297059533626, "mean_action_processing_ms": 0.09996728473000543, "mean_env_wait_ms": 0.8076298800169563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2110680, "timesteps_this_iter": 0, "agent_timesteps_total": 6332040, "timers": {"sample_time_ms": 20278.36, "sample_throughput": 473.115, "load_time_ms": 0.1, "load_throughput": 95650469.636, "learn_time_ms": 3089.661, "learn_throughput": 3105.195, "update_time_ms": 8.947}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.9378950234924675e-13, "cur_lr": 0.0005, "total_loss": 6.3958324790000916, "policy_loss": -0.0009005113262001707, "vf_loss": 6.601105809211731, "vf_explained_var": 0.31082306802272797, "kl": 0.0042252046409687605, "entropy": 20.437257051467896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2110680, "num_agent_steps_sampled": 6332040, "num_steps_trained": 2110680, "num_agent_steps_trained": 6332040, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7856, "training_iteration": 220, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-57-25", "timestamp": 1706194645, "time_this_iter_s": 21.52409315109253, "time_total_s": 4440.6556141376495, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA01688940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4440.6556141376495, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 10.129032258064516, "ram_util_percent": 54.58387096774193}}
{"episode_reward_max": 116.44347176142037, "episode_reward_min": -298.718303238973, "episode_reward_mean": 58.29560539199043, "episode_len_mean": 298.94, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -103.57405271132788}, "policy_reward_max": {"shared_policy": 38.89241167716682}, "policy_reward_mean": {"shared_policy": 19.431868463996803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.54849197715521, 103.03971274010837, 69.08793121343479, 71.8628558581695, 52.32448365353048, 74.18823865614829, 56.810727924108505, 44.01622231490907, 77.55180662777275, 75.68706998974085, 73.17614896781741, 48.5395252406597, 74.446968129836, 55.339496357366414, 66.80447448417542, 44.7818930223584, 56.21632739063351, 55.26182423159477, 70.8864866271615, 38.96594314370303, 73.68218664079903, 46.988422974944086, 61.47983574867246, 50.3834995739162, 101.12905390560626, 38.87954001594332, 116.44347176142037, 37.32851020433006, 80.20624929619952, 73.13843337446448, 101.47885998897252, 10.201396817341433, 62.647502053528996, -29.221516908612102, 39.52041253959759, 87.72781904786824, 61.09412334486841, 77.3291128799319, 71.48382880934513, 56.293018162250505, 26.60449004452674, 82.83202707394956, 64.2953544605989, 97.05564466863869, 57.04746887553483, 96.5097764916718, 81.48109016939998, 72.0676955617964, 67.27111710887401, 29.917934104800196, 74.71372446988242, 44.304189182585105, 57.27182536572215, 64.09446749091146, 87.0005224868655, 82.7393919993192, 61.36155063286422, 82.90203316509721, 60.288553057238445, 45.92660297174005, 47.209348917007446, 81.92375817522405, 85.15532691963016, 73.7277454100549, 27.339803522452712, -0.2379032187164114, 56.186648864299045, 33.967507432214916, 66.00786114856598, 13.687512255739392, 102.78621181473136, 42.5958216525614, 85.3984131850302, 52.10258533805609, 86.0103931459598, 74.22119566611943, 86.40095176734027, 106.16573701426385, 23.405766176991136, 87.35986550152299, 41.35017525963484, 53.572622505016625, 17.809407513588653, 35.885913171339766, 82.13228230550884, 83.25615267315877, 77.88535295054315, 59.118369359523044, 36.93987712822853, -298.718303238973, 66.27276912890375, 79.01161286979912, 75.523965254426, 11.263758141547441, 63.39696022123097, 44.83428220916538, 66.00188522040843, 81.24296888115714, 61.53089272789654, 36.39919606409967], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 194, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.470396533608437, 20.22076814621687, 19.857327297329903, 34.24500536546111, 34.33420863375068, 34.46049874089658, 22.54326805472374, 23.24816120788455, 23.296501950826496, 23.481314092874527, 24.14077320508659, 24.24076856020838, 17.325763177126646, 17.51479971781373, 17.483920758590102, 24.951798026139528, 24.2791780779759, 24.95726255203286, 18.48313708603382, 19.173292376101017, 19.154298461973667, 14.71694856385389, 14.396568755308778, 14.902704995746404, 25.981584965251386, 25.717411782592535, 25.852809879928827, 25.186758793890476, 25.168655447661877, 25.331655748188496, 24.18958493073781, 24.350512367983654, 24.63605166909595, 16.262670466055468, 16.186068159838513, 16.09078661476572, 25.01453075899431, 24.436871240536362, 24.99556613030532, 18.70132210912803, 18.390728610257298, 18.247445637981087, 21.59409976998964, 22.574436138073594, 22.63593857611218, 14.710924891134098, 15.048863147695855, 15.02210498352845, 18.94712540817757, 18.96845514917125, 18.30074683328469, 18.449450845519692, 18.096769491831452, 18.71560389424363, 23.759705029428005, 23.314724132418633, 23.812057465314865, 12.798978437980011, 12.903125633796051, 13.263839071926967, 24.4064333786567, 24.330576707919434, 24.945176554222897, 15.723804655174405, 15.667715306083352, 15.59690301368633, 20.335780958334595, 20.52780425051847, 20.61625053981939, 16.55904023349285, 17.18359623476863, 16.640863105654716, 33.96151614685853, 33.36364870270093, 33.8038890560468, 12.984792331854493, 12.411124671498925, 13.483623012589902, 38.89241167716682, 38.78492188081145, 38.7661382034421, 12.636129506553203, 12.114886189500481, 12.577494508276374, 26.897308742006615, 27.10767838809018, 26.201262166102723, 24.3915871332089, 24.371772463122994, 24.375073778132588, 33.777539814511925, 33.99967271896699, 33.7016474554936, 3.781778416906789, 2.9560019125541004, 3.463616487880543, 20.930072753379733, 20.74418547997871, 20.973243820170552, -9.554896628018469, -9.898102447390556, -9.768517833203077, 13.254191106495753, 12.960598905881241, 13.305622527220592, 28.970142876108483, 29.72550333787997, 29.032172833879784, 20.30432694156964, 20.07947676380475, 20.710319639494017, 25.269578556219727, 25.88001654545465, 26.17951777825752, 24.03875406978962, 23.70225366701682, 23.74282107253869, 18.483676215012864, 18.767453407247856, 19.041888539989785, 8.879406058539942, 8.91044811562945, 8.81463587035735, 27.1111755122741, 27.976236590494707, 27.744614971180752, 21.888942015590146, 21.31653333455324, 21.089879110455513, 32.17805415888627, 32.426186469693974, 32.45140404005845, 19.090764950960875, 19.218268119730055, 18.738435804843903, 32.338584035634995, 31.93234645575285, 32.23884600028396, 27.52741776406765, 27.454460319131613, 26.499212086200714, 24.12370433534184, 23.968574511508137, 23.97541671494642, 22.48220766646166, 22.470668817249432, 22.318240625162915, 10.017257350186497, 9.875477905074746, 10.025198849538953, 24.85400818039973, 25.425665858628534, 24.434050430854157, 14.667073674499989, 14.624960087239742, 15.012155420845374, 19.097018251816422, 19.145222465197236, 19.029584648708493, 21.39593982199827, 21.29148983458677, 21.407037834326417, 28.952793573339775, 28.388684560855225, 29.659044352670506, 27.659952141344547, 27.996662775054574, 27.082777082920074, 20.384351437290505, 20.595156469692782, 20.382042725880936, 27.456907774011285, 27.53371878961721, 27.911406601468713, 19.47083555658658, 20.57706065041323, 20.240656850238636, 15.351185368684426, 15.286111899962023, 15.289305703093603, 15.534783780574799, 15.510391250252724, 16.164173886179924, 27.539726362874106, 27.200853300591305, 27.18317851175864, 28.565725910787776, 28.089651775856808, 28.49994923298557, 24.7393308567504, 24.665030295650155, 24.32338425765434, 9.376787900924683, 8.589265704154968, 9.373749917373061, -0.15110623588165595, -0.2788371642430718, 0.19204018140831636, 18.760354337592915, 18.554991898437336, 18.871302628268793, 11.361641626805067, 11.070647150278091, 11.535218655131757, 22.278212590763957, 21.668484325210244, 22.06116423259178, 4.878907473913074, 4.61985472838083, 4.188750053445489, 34.441220212727785, 34.14484291523695, 34.200148686766624, 14.140658433238656, 14.137031229833752, 14.31813198948899, 28.224704439441354, 28.50547211865583, 28.66823662693301, 17.71562957391143, 16.647603392601013, 17.739352371543646, 27.937988872329385, 28.9587833272914, 29.11362094633901, 24.955257144446165, 24.786069742093474, 24.47986877957979, 28.591555672387273, 28.771208542088658, 29.038187552864343, 35.96079868202408, 35.4531992872556, 34.75173904498418, 7.615413824717194, 7.433574358622224, 8.356777993651718, 29.26073774943748, 29.327945488194615, 28.771182263890893, 13.951050057386354, 14.06032035623987, 13.338804846008614, 17.742542661726475, 18.016467751003802, 17.81361209228635, 5.859552090366677, 6.021676034977034, 5.928179388244942, 11.993914593321577, 12.025969936357185, 11.866028641661003, 27.599473295112446, 27.685707078625754, 26.847101931770638, 27.982863485968352, 27.29294795791307, 27.980341229277343, 26.148118947943047, 25.261563410361603, 26.4756705922385, 19.59763853748639, 19.63214310755332, 19.888587714483336, 11.99834995468457, 12.371163633962468, 12.570363539581493, -92.57316604008278, -103.57405271132788, -102.57108448756239, 21.58359880745411, 22.061167538166046, 22.62800278328359, 26.647894506653145, 26.713495564957455, 25.650222798188523, 25.164997182786465, 25.028125621378422, 25.330842450261116, 3.8026146814227104, 3.8614631108939648, 3.5996803492307663, 21.583486815293625, 20.53385118146737, 21.279622224469975, 14.835438316067055, 15.155298786548272, 14.843545106550053, 21.99533188839753, 21.472365130980805, 22.53418820103009, 27.23880416410975, 27.24443942204016, 26.75972529500723, 19.999629432956368, 20.842773948485643, 20.68848934645453, 12.093234218657017, 11.920279569923878, 12.385682275518775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305004272479064, "mean_inference_ms": 0.7056027116352623, "mean_action_processing_ms": 0.10004390815007486, "mean_env_wait_ms": 0.8077631331109952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2120274, "timesteps_this_iter": 0, "agent_timesteps_total": 6360822, "timers": {"sample_time_ms": 20448.186, "sample_throughput": 469.186, "load_time_ms": 0.1, "load_throughput": 95650469.636, "learn_time_ms": 3108.661, "learn_throughput": 3086.216, "update_time_ms": 8.947}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9689475117462338e-13, "cur_lr": 0.0005, "total_loss": 62.16398096084595, "policy_loss": -0.0006262091032432915, "vf_loss": 62.36908483505249, "vf_explained_var": 0.11250925809144974, "kl": 0.0060159532881461225, "entropy": 20.44749164581299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2120274, "num_agent_steps_sampled": 6360822, "num_steps_trained": 2120274, "num_agent_steps_trained": 6360822, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7886, "training_iteration": 221, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-57-46", "timestamp": 1706194666, "time_this_iter_s": 21.368581295013428, "time_total_s": 4462.024195432663, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A60D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4462.024195432663, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 8.593333333333334, "ram_util_percent": 54.93000000000002}}
{"episode_reward_max": 106.16573701426385, "episode_reward_min": -298.718303238973, "episode_reward_mean": 52.36221390594964, "episode_len_mean": 297.21, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"shared_policy": -103.57405271132788}, "policy_reward_max": {"shared_policy": 35.96079868202408}, "policy_reward_mean": {"shared_policy": 17.45407130198321}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.72781904786824, 61.09412334486841, 77.3291128799319, 71.48382880934513, 56.293018162250505, 26.60449004452674, 82.83202707394956, 64.2953544605989, 97.05564466863869, 57.04746887553483, 96.5097764916718, 81.48109016939998, 72.0676955617964, 67.27111710887401, 29.917934104800196, 74.71372446988242, 44.304189182585105, 57.27182536572215, 64.09446749091146, 87.0005224868655, 82.7393919993192, 61.36155063286422, 82.90203316509721, 60.288553057238445, 45.92660297174005, 47.209348917007446, 81.92375817522405, 85.15532691963016, 73.7277454100549, 27.339803522452712, -0.2379032187164114, 56.186648864299045, 33.967507432214916, 66.00786114856598, 13.687512255739392, 102.78621181473136, 42.5958216525614, 85.3984131850302, 52.10258533805609, 86.0103931459598, 74.22119566611943, 86.40095176734027, 106.16573701426385, 23.405766176991136, 87.35986550152299, 41.35017525963484, 53.572622505016625, 17.809407513588653, 35.885913171339766, 82.13228230550884, 83.25615267315877, 77.88535295054315, 59.118369359523044, 36.93987712822853, -298.718303238973, 66.27276912890375, 79.01161286979912, 75.523965254426, 11.263758141547441, 63.39696022123097, 44.83428220916538, 66.00188522040843, 81.24296888115714, 61.53089272789654, 36.39919606409967, 95.22695584967732, 71.04496750654653, 74.92310079559682, 80.81904923799448, 79.15917622484267, 47.95613801479337, 44.77364588901398, 29.193679831922026, 78.49160224013028, -277.74168817512697, 70.24440216645598, 71.46149514243004, 70.46075753122568, 44.74723779223859, -222.19366030395034, 21.769509334117146, 64.17769771814345, 65.79372274875641, 76.88924065604805, 71.9471476431936, 55.507461338303955, 27.49849261995402, 43.59091036021708, 93.03474124521014, 69.32794823497534, 53.46065044030547, 79.43698525801301, -16.168247561901822, 80.38622458744793, 76.68252190388738, 60.4192938171327, 93.0268808151595, 55.811664983164505, 68.31549087725578, 41.00814117025581], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 194, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 151, 300, 300, 300, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [28.970142876108483, 29.72550333787997, 29.032172833879784, 20.30432694156964, 20.07947676380475, 20.710319639494017, 25.269578556219727, 25.88001654545465, 26.17951777825752, 24.03875406978962, 23.70225366701682, 23.74282107253869, 18.483676215012864, 18.767453407247856, 19.041888539989785, 8.879406058539942, 8.91044811562945, 8.81463587035735, 27.1111755122741, 27.976236590494707, 27.744614971180752, 21.888942015590146, 21.31653333455324, 21.089879110455513, 32.17805415888627, 32.426186469693974, 32.45140404005845, 19.090764950960875, 19.218268119730055, 18.738435804843903, 32.338584035634995, 31.93234645575285, 32.23884600028396, 27.52741776406765, 27.454460319131613, 26.499212086200714, 24.12370433534184, 23.968574511508137, 23.97541671494642, 22.48220766646166, 22.470668817249432, 22.318240625162915, 10.017257350186497, 9.875477905074746, 10.025198849538953, 24.85400818039973, 25.425665858628534, 24.434050430854157, 14.667073674499989, 14.624960087239742, 15.012155420845374, 19.097018251816422, 19.145222465197236, 19.029584648708493, 21.39593982199827, 21.29148983458677, 21.407037834326417, 28.952793573339775, 28.388684560855225, 29.659044352670506, 27.659952141344547, 27.996662775054574, 27.082777082920074, 20.384351437290505, 20.595156469692782, 20.382042725880936, 27.456907774011285, 27.53371878961721, 27.911406601468713, 19.47083555658658, 20.57706065041323, 20.240656850238636, 15.351185368684426, 15.286111899962023, 15.289305703093603, 15.534783780574799, 15.510391250252724, 16.164173886179924, 27.539726362874106, 27.200853300591305, 27.18317851175864, 28.565725910787776, 28.089651775856808, 28.49994923298557, 24.7393308567504, 24.665030295650155, 24.32338425765434, 9.376787900924683, 8.589265704154968, 9.373749917373061, -0.15110623588165595, -0.2788371642430718, 0.19204018140831636, 18.760354337592915, 18.554991898437336, 18.871302628268793, 11.361641626805067, 11.070647150278091, 11.535218655131757, 22.278212590763957, 21.668484325210244, 22.06116423259178, 4.878907473913074, 4.61985472838083, 4.188750053445489, 34.441220212727785, 34.14484291523695, 34.200148686766624, 14.140658433238656, 14.137031229833752, 14.31813198948899, 28.224704439441354, 28.50547211865583, 28.66823662693301, 17.71562957391143, 16.647603392601013, 17.739352371543646, 27.937988872329385, 28.9587833272914, 29.11362094633901, 24.955257144446165, 24.786069742093474, 24.47986877957979, 28.591555672387273, 28.771208542088658, 29.038187552864343, 35.96079868202408, 35.4531992872556, 34.75173904498418, 7.615413824717194, 7.433574358622224, 8.356777993651718, 29.26073774943748, 29.327945488194615, 28.771182263890893, 13.951050057386354, 14.06032035623987, 13.338804846008614, 17.742542661726475, 18.016467751003802, 17.81361209228635, 5.859552090366677, 6.021676034977034, 5.928179388244942, 11.993914593321577, 12.025969936357185, 11.866028641661003, 27.599473295112446, 27.685707078625754, 26.847101931770638, 27.982863485968352, 27.29294795791307, 27.980341229277343, 26.148118947943047, 25.261563410361603, 26.4756705922385, 19.59763853748639, 19.63214310755332, 19.888587714483336, 11.99834995468457, 12.371163633962468, 12.570363539581493, -92.57316604008278, -103.57405271132788, -102.57108448756239, 21.58359880745411, 22.061167538166046, 22.62800278328359, 26.647894506653145, 26.713495564957455, 25.650222798188523, 25.164997182786465, 25.028125621378422, 25.330842450261116, 3.8026146814227104, 3.8614631108939648, 3.5996803492307663, 21.583486815293625, 20.53385118146737, 21.279622224469975, 14.835438316067055, 15.155298786548272, 14.843545106550053, 21.99533188839753, 21.472365130980805, 22.53418820103009, 27.23880416410975, 27.24443942204016, 26.75972529500723, 19.999629432956368, 20.842773948485643, 20.68848934645453, 12.093234218657017, 11.920279569923878, 12.385682275518775, 31.495028376579285, 31.887621112167835, 31.844306360930204, 23.459909826517105, 23.339730247855186, 24.245327432174236, 25.16743344192703, 25.042395283778504, 24.71327206989129, 26.94140102644451, 26.942100869957358, 26.93554734159261, 26.587352382019162, 26.676227666437626, 25.89559617638588, 15.77830537656942, 16.08268994341293, 16.095142694811017, 15.1476209933559, 15.00135914857188, 14.624665747086198, 9.670642028252274, 9.491053531567246, 10.031984272102505, 26.075893344978482, 26.529929966355354, 25.88577892879644, -102.68711205323538, -87.51814805654189, -87.53642806534967, 23.518832452595234, 23.31880099698901, 23.40676871687174, 23.982047929118067, 23.865747104088456, 23.613700109223515, 23.68371343612671, 23.562573067843914, 23.21447102725506, 15.2114600520581, 15.24864061921835, 14.287137120962143, -74.65022497375807, -73.86469133694968, -73.67874399324259, 7.309323685864598, 7.1271882454554145, 7.332997402797133, 21.232092594106987, 21.42874642213185, 21.51685870190461, 22.427236944437027, 21.530881956219673, 21.83560384809971, 26.222061076511935, 25.300257941087082, 25.36692163844903, 24.05435325950384, 24.13134896568954, 23.76144541800022, 18.57841259116927, 18.210943567256123, 18.718105179878563, 9.118239807585866, 8.986374291280896, 9.39387852108726, 14.657706854244068, 14.5088401188453, 14.424363387127713, 30.94346663604179, 30.91772566239038, 31.17354894677797, 23.070009745657444, 23.103758193552494, 23.1541802957654, 17.87736325711012, 17.53345775604248, 18.049829427152872, 26.823165331035852, 26.276404082775116, 26.33741584420204, -4.922007995347187, -6.210115740696594, -5.036123825858041, 26.883410191473857, 26.81826217969258, 26.68455221628149, 25.3346775000294, 25.824120565628007, 25.52372383822997, 20.081408498187855, 20.363508508851126, 19.974376810093716, 30.758994134763867, 31.208812831124902, 31.05907384927073, 18.6991939296325, 19.239285518260047, 17.873185535271958, 22.699115590502814, 22.793261294563607, 22.823113992189363, 13.967028772147984, 13.71795944372812, 13.323152954379708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15307897809377927, "mean_inference_ms": 0.7056463625654719, "mean_action_processing_ms": 0.09997911128723189, "mean_env_wait_ms": 0.807790567255211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2129868, "timesteps_this_iter": 0, "agent_timesteps_total": 6389604, "timers": {"sample_time_ms": 20483.248, "sample_throughput": 468.383, "load_time_ms": 0.2, "load_throughput": 47899241.252, "learn_time_ms": 3098.531, "learn_throughput": 3096.306, "update_time_ms": 8.846}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9689475117462338e-13, "cur_lr": 0.0005, "total_loss": 79.16605377197266, "policy_loss": -0.0014765780061627432, "vf_loss": 79.37252902984619, "vf_explained_var": 0.12824580818414688, "kl": 0.0058327231749738025, "entropy": 20.50018811225891, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2129868, "num_agent_steps_sampled": 6389604, "num_steps_trained": 2129868, "num_agent_steps_trained": 6389604, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7921, "training_iteration": 222, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-58-07", "timestamp": 1706194687, "time_this_iter_s": 20.562702178955078, "time_total_s": 4482.586897611618, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA00460AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4482.586897611618, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 10.713793103448278, "ram_util_percent": 55.5551724137931}}
{"episode_reward_max": 106.69918572250751, "episode_reward_min": -298.718303238973, "episode_reward_mean": 50.09519386986856, "episode_len_mean": 296.43, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -103.57405271132788}, "policy_reward_max": {"shared_policy": 35.96079868202408}, "policy_reward_mean": {"shared_policy": 16.69839795662285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.967507432214916, 66.00786114856598, 13.687512255739392, 102.78621181473136, 42.5958216525614, 85.3984131850302, 52.10258533805609, 86.0103931459598, 74.22119566611943, 86.40095176734027, 106.16573701426385, 23.405766176991136, 87.35986550152299, 41.35017525963484, 53.572622505016625, 17.809407513588653, 35.885913171339766, 82.13228230550884, 83.25615267315877, 77.88535295054315, 59.118369359523044, 36.93987712822853, -298.718303238973, 66.27276912890375, 79.01161286979912, 75.523965254426, 11.263758141547441, 63.39696022123097, 44.83428220916538, 66.00188522040843, 81.24296888115714, 61.53089272789654, 36.39919606409967, 95.22695584967732, 71.04496750654653, 74.92310079559682, 80.81904923799448, 79.15917622484267, 47.95613801479337, 44.77364588901398, 29.193679831922026, 78.49160224013028, -277.74168817512697, 70.24440216645598, 71.46149514243004, 70.46075753122568, 44.74723779223859, -222.19366030395034, 21.769509334117146, 64.17769771814345, 65.79372274875641, 76.88924065604805, 71.9471476431936, 55.507461338303955, 27.49849261995402, 43.59091036021708, 93.03474124521014, 69.32794823497534, 53.46065044030547, 79.43698525801301, -16.168247561901822, 80.38622458744793, 76.68252190388738, 60.4192938171327, 93.0268808151595, 55.811664983164505, 68.31549087725578, 41.00814117025581, 51.74361959472297, 55.22140935249624, 79.59665575809777, 85.05659690499303, 77.93875865265724, 84.32194840162992, 59.15849016234279, 72.48678821697831, 68.43855695612729, 88.85741530638188, 57.575583241879926, 7.700352266430855, 82.12611169368029, 60.677603468298884, 64.41499873064456, 70.58599579147993, 80.33085006475446, 90.74614100484176, 106.69918572250751, 28.839545227587223, 68.56335713714361, 96.94539080187677, 42.913685662671895, 67.77998333796859, 66.52812847495078, 35.15180219709873, 62.573515409370856, 63.501028046011896, -265.49012483656406, 75.0179215092212, 89.39064959948881, 58.82414275035262], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 194, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 151, 300, 300, 300, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300], "policy_shared_policy_reward": [11.361641626805067, 11.070647150278091, 11.535218655131757, 22.278212590763957, 21.668484325210244, 22.06116423259178, 4.878907473913074, 4.61985472838083, 4.188750053445489, 34.441220212727785, 34.14484291523695, 34.200148686766624, 14.140658433238656, 14.137031229833752, 14.31813198948899, 28.224704439441354, 28.50547211865583, 28.66823662693301, 17.71562957391143, 16.647603392601013, 17.739352371543646, 27.937988872329385, 28.9587833272914, 29.11362094633901, 24.955257144446165, 24.786069742093474, 24.47986877957979, 28.591555672387273, 28.771208542088658, 29.038187552864343, 35.96079868202408, 35.4531992872556, 34.75173904498418, 7.615413824717194, 7.433574358622224, 8.356777993651718, 29.26073774943748, 29.327945488194615, 28.771182263890893, 13.951050057386354, 14.06032035623987, 13.338804846008614, 17.742542661726475, 18.016467751003802, 17.81361209228635, 5.859552090366677, 6.021676034977034, 5.928179388244942, 11.993914593321577, 12.025969936357185, 11.866028641661003, 27.599473295112446, 27.685707078625754, 26.847101931770638, 27.982863485968352, 27.29294795791307, 27.980341229277343, 26.148118947943047, 25.261563410361603, 26.4756705922385, 19.59763853748639, 19.63214310755332, 19.888587714483336, 11.99834995468457, 12.371163633962468, 12.570363539581493, -92.57316604008278, -103.57405271132788, -102.57108448756239, 21.58359880745411, 22.061167538166046, 22.62800278328359, 26.647894506653145, 26.713495564957455, 25.650222798188523, 25.164997182786465, 25.028125621378422, 25.330842450261116, 3.8026146814227104, 3.8614631108939648, 3.5996803492307663, 21.583486815293625, 20.53385118146737, 21.279622224469975, 14.835438316067055, 15.155298786548272, 14.843545106550053, 21.99533188839753, 21.472365130980805, 22.53418820103009, 27.23880416410975, 27.24443942204016, 26.75972529500723, 19.999629432956368, 20.842773948485643, 20.68848934645453, 12.093234218657017, 11.920279569923878, 12.385682275518775, 31.495028376579285, 31.887621112167835, 31.844306360930204, 23.459909826517105, 23.339730247855186, 24.245327432174236, 25.16743344192703, 25.042395283778504, 24.71327206989129, 26.94140102644451, 26.942100869957358, 26.93554734159261, 26.587352382019162, 26.676227666437626, 25.89559617638588, 15.77830537656942, 16.08268994341293, 16.095142694811017, 15.1476209933559, 15.00135914857188, 14.624665747086198, 9.670642028252274, 9.491053531567246, 10.031984272102505, 26.075893344978482, 26.529929966355354, 25.88577892879644, -102.68711205323538, -87.51814805654189, -87.53642806534967, 23.518832452595234, 23.31880099698901, 23.40676871687174, 23.982047929118067, 23.865747104088456, 23.613700109223515, 23.68371343612671, 23.562573067843914, 23.21447102725506, 15.2114600520581, 15.24864061921835, 14.287137120962143, -74.65022497375807, -73.86469133694968, -73.67874399324259, 7.309323685864598, 7.1271882454554145, 7.332997402797133, 21.232092594106987, 21.42874642213185, 21.51685870190461, 22.427236944437027, 21.530881956219673, 21.83560384809971, 26.222061076511935, 25.300257941087082, 25.36692163844903, 24.05435325950384, 24.13134896568954, 23.76144541800022, 18.57841259116927, 18.210943567256123, 18.718105179878563, 9.118239807585866, 8.986374291280896, 9.39387852108726, 14.657706854244068, 14.5088401188453, 14.424363387127713, 30.94346663604179, 30.91772566239038, 31.17354894677797, 23.070009745657444, 23.103758193552494, 23.1541802957654, 17.87736325711012, 17.53345775604248, 18.049829427152872, 26.823165331035852, 26.276404082775116, 26.33741584420204, -4.922007995347187, -6.210115740696594, -5.036123825858041, 26.883410191473857, 26.81826217969258, 26.68455221628149, 25.3346775000294, 25.824120565628007, 25.52372383822997, 20.081408498187855, 20.363508508851126, 19.974376810093716, 30.758994134763867, 31.208812831124902, 31.05907384927073, 18.6991939296325, 19.239285518260047, 17.873185535271958, 22.699115590502814, 22.793261294563607, 22.823113992189363, 13.967028772147984, 13.71795944372812, 13.323152954379708, 17.318997365732983, 17.644899563242987, 16.779722665747002, 18.453828851381928, 18.546216097349912, 18.221364403764397, 26.53210075199604, 26.422391548752785, 26.642163457348943, 27.67485953370729, 28.727780314783246, 28.65395705650249, 26.18436051408449, 25.571907664338738, 26.182490474234015, 27.893449291586876, 28.14679902046919, 28.28170008957386, 19.5159208253026, 19.858302254229784, 19.784267082810402, 24.54515752568841, 24.145068928599358, 23.796561762690544, 22.914807494729757, 22.417313620448112, 23.106435840949416, 29.591968528926373, 29.391585014760494, 29.873861762695014, 19.28754786898692, 18.967488919695214, 19.320546453197792, 2.7419528514146805, 2.542831800878048, 2.4155676141381264, 27.36885057389736, 27.33646807819605, 27.420793041586876, 20.078242043654114, 20.273249777654797, 20.326111646989972, 21.24534713725248, 21.59359275518605, 21.576058838206023, 23.891139019591108, 23.84055613384892, 22.854300638039902, 26.86753117541471, 26.83188864092031, 26.631430248419434, 30.50378981310253, 30.027342220147446, 30.215008971591786, 35.249986509482056, 35.69936091142395, 35.7498383016015, 9.659206338226795, 9.286499500274658, 9.89383938908577, 22.63490518927574, 22.71145297586918, 23.21699897199869, 32.25319989894827, 32.38526924451192, 32.306921658416584, 14.561538428689033, 14.012168760100991, 14.339978473881871, 22.747177500277758, 22.554049380123615, 22.478756457567215, 22.226608139773205, 21.900218432148293, 22.401301903029278, 11.536471411585808, 11.972736172378063, 11.642594613134861, 20.99943819331625, 20.569268594185502, 21.004808621869103, 20.520291204253823, 21.513608504707605, 21.467128337050468, -99.58967137336731, -83.03835670650005, -82.8620967566967, 24.989495247602463, 24.90817953646183, 25.120246725156903, 29.605789480110005, 29.76149070759614, 30.023369411782667, 19.307744599878788, 19.804716430604458, 19.711681719869375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15315166052345214, "mean_inference_ms": 0.7059599592733473, "mean_action_processing_ms": 0.1000692643222421, "mean_env_wait_ms": 0.80802749168183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2139462, "timesteps_this_iter": 0, "agent_timesteps_total": 6418386, "timers": {"sample_time_ms": 20435.721, "sample_throughput": 469.472, "load_time_ms": 0.2, "load_throughput": 47899241.252, "learn_time_ms": 3114.73, "learn_throughput": 3080.203, "update_time_ms": 8.955}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9689475117462338e-13, "cur_lr": 0.0005, "total_loss": 59.09699487686157, "policy_loss": -0.00039404293150813174, "vf_loss": 59.30471897125244, "vf_explained_var": 0.11887013912200928, "kl": 0.009324385377555634, "entropy": 20.733105182647705, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2139462, "num_agent_steps_sampled": 6418386, "num_steps_trained": 2139462, "num_agent_steps_trained": 6418386, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7953, "training_iteration": 223, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-58-28", "timestamp": 1706194708, "time_this_iter_s": 21.248203992843628, "time_total_s": 4503.835101604462, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017903A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4503.835101604462, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 10.69, "ram_util_percent": 55.29333333333333}}
{"episode_reward_max": 106.69918572250751, "episode_reward_min": -277.74168817512697, "episode_reward_mean": 52.39278722857125, "episode_len_mean": 297.49, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -102.68711205323538}, "policy_reward_max": {"shared_policy": 35.7498383016015}, "policy_reward_mean": {"shared_policy": 17.464262409523744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.53089272789654, 36.39919606409967, 95.22695584967732, 71.04496750654653, 74.92310079559682, 80.81904923799448, 79.15917622484267, 47.95613801479337, 44.77364588901398, 29.193679831922026, 78.49160224013028, -277.74168817512697, 70.24440216645598, 71.46149514243004, 70.46075753122568, 44.74723779223859, -222.19366030395034, 21.769509334117146, 64.17769771814345, 65.79372274875641, 76.88924065604805, 71.9471476431936, 55.507461338303955, 27.49849261995402, 43.59091036021708, 93.03474124521014, 69.32794823497534, 53.46065044030547, 79.43698525801301, -16.168247561901822, 80.38622458744793, 76.68252190388738, 60.4192938171327, 93.0268808151595, 55.811664983164505, 68.31549087725578, 41.00814117025581, 51.74361959472297, 55.22140935249624, 79.59665575809777, 85.05659690499303, 77.93875865265724, 84.32194840162992, 59.15849016234279, 72.48678821697831, 68.43855695612729, 88.85741530638188, 57.575583241879926, 7.700352266430855, 82.12611169368029, 60.677603468298884, 64.41499873064456, 70.58599579147993, 80.33085006475446, 90.74614100484176, 106.69918572250751, 28.839545227587223, 68.56335713714361, 96.94539080187677, 42.913685662671895, 67.77998333796859, 66.52812847495078, 35.15180219709873, 62.573515409370856, 63.501028046011896, -265.49012483656406, 75.0179215092212, 89.39064959948881, 58.82414275035262, 32.64340973366049, 102.22807577252387, 46.58673052955416, 65.5927075780928, 24.541463088244186, 67.62556835263968, 57.33102472871539, 46.05213095620272, 44.65103542804715, 43.440868987701805, 31.506959583610268, 51.22860685037449, 52.566171023994656, 73.3266127258539, 104.83771959692237, -21.061091916635633, 63.10195401124655, 63.51790952682494, 49.36226804833858, 76.24092108756304, 105.34443104639648, 45.074955284595475, 69.57713588885963, 63.070037219673395, 47.987372427014606, 29.15347182005644, 52.13433290272948, 55.49548754002896, 70.1656425206456, 86.51542570628224, 66.80987147381528], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 151, 300, 300, 300, 300, 276, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [19.999629432956368, 20.842773948485643, 20.68848934645453, 12.093234218657017, 11.920279569923878, 12.385682275518775, 31.495028376579285, 31.887621112167835, 31.844306360930204, 23.459909826517105, 23.339730247855186, 24.245327432174236, 25.16743344192703, 25.042395283778504, 24.71327206989129, 26.94140102644451, 26.942100869957358, 26.93554734159261, 26.587352382019162, 26.676227666437626, 25.89559617638588, 15.77830537656942, 16.08268994341293, 16.095142694811017, 15.1476209933559, 15.00135914857188, 14.624665747086198, 9.670642028252274, 9.491053531567246, 10.031984272102505, 26.075893344978482, 26.529929966355354, 25.88577892879644, -102.68711205323538, -87.51814805654189, -87.53642806534967, 23.518832452595234, 23.31880099698901, 23.40676871687174, 23.982047929118067, 23.865747104088456, 23.613700109223515, 23.68371343612671, 23.562573067843914, 23.21447102725506, 15.2114600520581, 15.24864061921835, 14.287137120962143, -74.65022497375807, -73.86469133694968, -73.67874399324259, 7.309323685864598, 7.1271882454554145, 7.332997402797133, 21.232092594106987, 21.42874642213185, 21.51685870190461, 22.427236944437027, 21.530881956219673, 21.83560384809971, 26.222061076511935, 25.300257941087082, 25.36692163844903, 24.05435325950384, 24.13134896568954, 23.76144541800022, 18.57841259116927, 18.210943567256123, 18.718105179878563, 9.118239807585866, 8.986374291280896, 9.39387852108726, 14.657706854244068, 14.5088401188453, 14.424363387127713, 30.94346663604179, 30.91772566239038, 31.17354894677797, 23.070009745657444, 23.103758193552494, 23.1541802957654, 17.87736325711012, 17.53345775604248, 18.049829427152872, 26.823165331035852, 26.276404082775116, 26.33741584420204, -4.922007995347187, -6.210115740696594, -5.036123825858041, 26.883410191473857, 26.81826217969258, 26.68455221628149, 25.3346775000294, 25.824120565628007, 25.52372383822997, 20.081408498187855, 20.363508508851126, 19.974376810093716, 30.758994134763867, 31.208812831124902, 31.05907384927073, 18.6991939296325, 19.239285518260047, 17.873185535271958, 22.699115590502814, 22.793261294563607, 22.823113992189363, 13.967028772147984, 13.71795944372812, 13.323152954379708, 17.318997365732983, 17.644899563242987, 16.779722665747002, 18.453828851381928, 18.546216097349912, 18.221364403764397, 26.53210075199604, 26.422391548752785, 26.642163457348943, 27.67485953370729, 28.727780314783246, 28.65395705650249, 26.18436051408449, 25.571907664338738, 26.182490474234015, 27.893449291586876, 28.14679902046919, 28.28170008957386, 19.5159208253026, 19.858302254229784, 19.784267082810402, 24.54515752568841, 24.145068928599358, 23.796561762690544, 22.914807494729757, 22.417313620448112, 23.106435840949416, 29.591968528926373, 29.391585014760494, 29.873861762695014, 19.28754786898692, 18.967488919695214, 19.320546453197792, 2.7419528514146805, 2.542831800878048, 2.4155676141381264, 27.36885057389736, 27.33646807819605, 27.420793041586876, 20.078242043654114, 20.273249777654797, 20.326111646989972, 21.24534713725248, 21.59359275518605, 21.576058838206023, 23.891139019591108, 23.84055613384892, 22.854300638039902, 26.86753117541471, 26.83188864092031, 26.631430248419434, 30.50378981310253, 30.027342220147446, 30.215008971591786, 35.249986509482056, 35.69936091142395, 35.7498383016015, 9.659206338226795, 9.286499500274658, 9.89383938908577, 22.63490518927574, 22.71145297586918, 23.21699897199869, 32.25319989894827, 32.38526924451192, 32.306921658416584, 14.561538428689033, 14.012168760100991, 14.339978473881871, 22.747177500277758, 22.554049380123615, 22.478756457567215, 22.226608139773205, 21.900218432148293, 22.401301903029278, 11.536471411585808, 11.972736172378063, 11.642594613134861, 20.99943819331625, 20.569268594185502, 21.004808621869103, 20.520291204253823, 21.513608504707605, 21.467128337050468, -99.58967137336731, -83.03835670650005, -82.8620967566967, 24.989495247602463, 24.90817953646183, 25.120246725156903, 29.605789480110005, 29.76149070759614, 30.023369411782667, 19.307744599878788, 19.804716430604458, 19.711681719869375, 10.92435896365592, 10.886338664839656, 10.832712105164916, 34.129396249850586, 34.1117199709018, 33.98695955177148, 15.610454988355428, 15.283243584136159, 15.693031957062573, 21.66133292516072, 21.64352186520894, 22.28785278772314, 8.236766013627246, 8.082035494347409, 8.22266158026953, 23.01364804059267, 22.448421105742455, 22.16349920630455, 19.424282530943543, 18.92868101100126, 18.97806118677059, 15.254402468601853, 14.984697783986718, 15.813030703614146, 14.691211352745682, 14.96168936106065, 14.99813471424082, 15.07658233648786, 13.607708851496369, 14.756577799717576, 9.901898364226014, 10.557852211097867, 11.047209008286387, 17.54598042787984, 16.3732191324234, 17.30940729007125, 17.609207107375056, 17.499848323563725, 17.457115593055875, 24.59896995251377, 24.13736768563588, 24.590275087704256, 35.01709545465806, 35.13900783347586, 34.68161630878845, -7.034012861549854, -6.98848576284945, -7.038593292236328, 21.38645844471951, 20.630121817191437, 21.085373749335602, 21.321694811185196, 21.228410263856247, 20.967804451783493, 16.74188435574372, 15.850174208482102, 16.770209484112755, 25.150640442967415, 25.47074320167303, 25.619537442922592, 34.756498013933495, 35.21866468091805, 35.36926835154493, 15.156235565741852, 15.602104534705475, 14.316615184148148, 23.791196724399924, 23.522134102880955, 22.26380506157875, 20.48301410675049, 21.342301730066538, 21.24472138285637, 15.818917776147515, 16.106715915181354, 16.061738735685736, 9.03169670701027, 10.030617523938417, 10.091157589107752, 17.55957260231176, 16.9488071600596, 17.62595314035812, 18.436380388836056, 18.619514221015066, 18.439592930177838, 23.683649436493084, 23.288423287371785, 23.193569796780736, 28.79541329791148, 28.811377005030707, 28.908635403340057, 22.516661755119756, 21.712886815269783, 22.58032290342574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153193335434782, "mean_inference_ms": 0.7061877170508049, "mean_action_processing_ms": 0.10005812767569068, "mean_env_wait_ms": 0.8081644312892371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2149056, "timesteps_this_iter": 0, "agent_timesteps_total": 6447168, "timers": {"sample_time_ms": 20631.992, "sample_throughput": 465.006, "load_time_ms": 0.301, "load_throughput": 31908772.164, "learn_time_ms": 3139.11, "learn_throughput": 3056.28, "update_time_ms": 9.059}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9689475117462338e-13, "cur_lr": 0.0005, "total_loss": 7.413937628269196, "policy_loss": -0.00029964928286574377, "vf_loss": 7.619246065616608, "vf_explained_var": 0.2411673367023468, "kl": 0.003935565677672597, "entropy": 20.500900506973267, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2149056, "num_agent_steps_sampled": 6447168, "num_steps_trained": 2149056, "num_agent_steps_trained": 6447168, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7984, "training_iteration": 224, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-58-50", "timestamp": 1706194730, "time_this_iter_s": 22.261357069015503, "time_total_s": 4526.096458673477, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03B88C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4526.096458673477, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 10.159375, "ram_util_percent": 55.05}}
{"episode_reward_max": 106.69918572250751, "episode_reward_min": -265.49012483656406, "episode_reward_mean": 59.34512460984929, "episode_len_mean": 299.22, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -99.58967137336731}, "policy_reward_max": {"shared_policy": 35.7498383016015}, "policy_reward_mean": {"shared_policy": 19.781708203283095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0268808151595, 55.811664983164505, 68.31549087725578, 41.00814117025581, 51.74361959472297, 55.22140935249624, 79.59665575809777, 85.05659690499303, 77.93875865265724, 84.32194840162992, 59.15849016234279, 72.48678821697831, 68.43855695612729, 88.85741530638188, 57.575583241879926, 7.700352266430855, 82.12611169368029, 60.677603468298884, 64.41499873064456, 70.58599579147993, 80.33085006475446, 90.74614100484176, 106.69918572250751, 28.839545227587223, 68.56335713714361, 96.94539080187677, 42.913685662671895, 67.77998333796859, 66.52812847495078, 35.15180219709873, 62.573515409370856, 63.501028046011896, -265.49012483656406, 75.0179215092212, 89.39064959948881, 58.82414275035262, 32.64340973366049, 102.22807577252387, 46.58673052955416, 65.5927075780928, 24.541463088244186, 67.62556835263968, 57.33102472871539, 46.05213095620272, 44.65103542804715, 43.440868987701805, 31.506959583610268, 51.22860685037449, 52.566171023994656, 73.3266127258539, 104.83771959692237, -21.061091916635633, 63.10195401124655, 63.51790952682494, 49.36226804833858, 76.24092108756304, 105.34443104639648, 45.074955284595475, 69.57713588885963, 63.070037219673395, 47.987372427014606, 29.15347182005644, 52.13433290272948, 55.49548754002896, 70.1656425206456, 86.51542570628224, 66.80987147381528, 48.28923361003399, 39.66731937229632, 77.58921664394437, 32.106274761259556, 53.00133262760937, 57.349052735604346, 75.55677776783702, 73.73715115897356, 91.51065352372825, 98.8277478739619, 68.31742659956217, 88.57515361811964, 30.682541646063314, 72.96988823357968, 63.06943203415722, 58.73384431004523, 65.72268949332644, 74.56909641250967, 85.8230733796954, 45.403115734457955, 61.12295977026221, 74.83078651502727, 41.35662880167365, 68.89765535667537, 57.03247659653424, 56.75043240265222, 32.2939857840538, 99.30392417311666, 22.39321803674099, 68.0340743077686, 53.589024150744066, 85.35260105412452, 53.02619852125645], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [30.758994134763867, 31.208812831124902, 31.05907384927073, 18.6991939296325, 19.239285518260047, 17.873185535271958, 22.699115590502814, 22.793261294563607, 22.823113992189363, 13.967028772147984, 13.71795944372812, 13.323152954379708, 17.318997365732983, 17.644899563242987, 16.779722665747002, 18.453828851381928, 18.546216097349912, 18.221364403764397, 26.53210075199604, 26.422391548752785, 26.642163457348943, 27.67485953370729, 28.727780314783246, 28.65395705650249, 26.18436051408449, 25.571907664338738, 26.182490474234015, 27.893449291586876, 28.14679902046919, 28.28170008957386, 19.5159208253026, 19.858302254229784, 19.784267082810402, 24.54515752568841, 24.145068928599358, 23.796561762690544, 22.914807494729757, 22.417313620448112, 23.106435840949416, 29.591968528926373, 29.391585014760494, 29.873861762695014, 19.28754786898692, 18.967488919695214, 19.320546453197792, 2.7419528514146805, 2.542831800878048, 2.4155676141381264, 27.36885057389736, 27.33646807819605, 27.420793041586876, 20.078242043654114, 20.273249777654797, 20.326111646989972, 21.24534713725248, 21.59359275518605, 21.576058838206023, 23.891139019591108, 23.84055613384892, 22.854300638039902, 26.86753117541471, 26.83188864092031, 26.631430248419434, 30.50378981310253, 30.027342220147446, 30.215008971591786, 35.249986509482056, 35.69936091142395, 35.7498383016015, 9.659206338226795, 9.286499500274658, 9.89383938908577, 22.63490518927574, 22.71145297586918, 23.21699897199869, 32.25319989894827, 32.38526924451192, 32.306921658416584, 14.561538428689033, 14.012168760100991, 14.339978473881871, 22.747177500277758, 22.554049380123615, 22.478756457567215, 22.226608139773205, 21.900218432148293, 22.401301903029278, 11.536471411585808, 11.972736172378063, 11.642594613134861, 20.99943819331625, 20.569268594185502, 21.004808621869103, 20.520291204253823, 21.513608504707605, 21.467128337050468, -99.58967137336731, -83.03835670650005, -82.8620967566967, 24.989495247602463, 24.90817953646183, 25.120246725156903, 29.605789480110005, 29.76149070759614, 30.023369411782667, 19.307744599878788, 19.804716430604458, 19.711681719869375, 10.92435896365592, 10.886338664839656, 10.832712105164916, 34.129396249850586, 34.1117199709018, 33.98695955177148, 15.610454988355428, 15.283243584136159, 15.693031957062573, 21.66133292516072, 21.64352186520894, 22.28785278772314, 8.236766013627246, 8.082035494347409, 8.22266158026953, 23.01364804059267, 22.448421105742455, 22.16349920630455, 19.424282530943543, 18.92868101100126, 18.97806118677059, 15.254402468601853, 14.984697783986718, 15.813030703614146, 14.691211352745682, 14.96168936106065, 14.99813471424082, 15.07658233648786, 13.607708851496369, 14.756577799717576, 9.901898364226014, 10.557852211097867, 11.047209008286387, 17.54598042787984, 16.3732191324234, 17.30940729007125, 17.609207107375056, 17.499848323563725, 17.457115593055875, 24.59896995251377, 24.13736768563588, 24.590275087704256, 35.01709545465806, 35.13900783347586, 34.68161630878845, -7.034012861549854, -6.98848576284945, -7.038593292236328, 21.38645844471951, 20.630121817191437, 21.085373749335602, 21.321694811185196, 21.228410263856247, 20.967804451783493, 16.74188435574372, 15.850174208482102, 16.770209484112755, 25.150640442967415, 25.47074320167303, 25.619537442922592, 34.756498013933495, 35.21866468091805, 35.36926835154493, 15.156235565741852, 15.602104534705475, 14.316615184148148, 23.791196724399924, 23.522134102880955, 22.26380506157875, 20.48301410675049, 21.342301730066538, 21.24472138285637, 15.818917776147515, 16.106715915181354, 16.061738735685736, 9.03169670701027, 10.030617523938417, 10.091157589107752, 17.55957260231176, 16.9488071600596, 17.62595314035812, 18.436380388836056, 18.619514221015066, 18.439592930177838, 23.683649436493084, 23.288423287371785, 23.193569796780736, 28.79541329791148, 28.811377005030707, 28.908635403340057, 22.516661755119756, 21.712886815269783, 22.58032290342574, 15.907191142439842, 16.204800970852375, 16.17724149674177, 12.853602920969323, 13.437619810303048, 13.376096641023949, 25.889315658559397, 25.880581277733043, 25.81931970765193, 11.113322906196117, 10.643874078989029, 10.34907777607441, 17.470667734742165, 17.325298339128494, 18.205366553738713, 18.825550347566605, 19.251774570904672, 19.27172781713307, 25.5717037419478, 25.289335044721753, 24.695738981167466, 24.340566804011658, 24.54889803876479, 24.847686316197112, 30.104735642671585, 30.438742712140083, 30.967175168916583, 32.46619916955629, 33.20937381560603, 33.15217488879958, 22.958629332482815, 22.63040380179882, 22.728393465280533, 29.59653087177624, 29.43717861299713, 29.541444133346275, 10.379016694923237, 10.183875670035675, 10.119649281104401, 24.165034015973404, 24.660587800977126, 24.14426641662915, 20.96604685485363, 21.08483466040343, 21.018550518900156, 19.825887245436505, 19.661392507453755, 19.24656455715497, 22.108282630719856, 22.02286738778153, 21.591539474825055, 24.60596390565236, 24.912325856586293, 25.050806650271014, 28.552860391636685, 28.534952995677784, 28.735259992380932, 15.032187310357884, 15.13579838102062, 15.235130043079451, 20.253841570268065, 20.531793470184, 20.33732472981015, 24.784085807700947, 25.09542867665489, 24.951272030671433, 13.951916757971048, 14.00331475585699, 13.401397287845612, 22.75555595507224, 23.005474523951605, 23.136624877651528, 19.107658126701907, 18.88677480568488, 19.03804366414745, 18.552551060914993, 18.95258817449212, 19.24529316724511, 10.834461748600006, 10.345666483044624, 11.113857552409172, 33.0995187635223, 33.1881707633535, 33.01623464624086, 7.460615734259278, 7.425472910205514, 7.507129392276198, 22.71444671228528, 22.870683347224258, 22.448944248259068, 17.79869210844238, 17.748847780128315, 18.04148426217337, 28.482527044912175, 28.212245014806584, 28.65782899440576, 17.793105617165565, 17.356525883078575, 17.876567021012306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15329457412895445, "mean_inference_ms": 0.7067268634999475, "mean_action_processing_ms": 0.10016029513178738, "mean_env_wait_ms": 0.8084907936702972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2158650, "timesteps_this_iter": 0, "agent_timesteps_total": 6475950, "timers": {"sample_time_ms": 20932.336, "sample_throughput": 458.334, "load_time_ms": 0.301, "load_throughput": 31908772.164, "learn_time_ms": 3152.764, "learn_throughput": 3043.044, "update_time_ms": 9.107}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.844737558731169e-14, "cur_lr": 0.0005, "total_loss": 6.76846045255661, "policy_loss": 0.001437736721559446, "vf_loss": 6.977058112621307, "vf_explained_var": 0.21193082630634308, "kl": 0.009247400216284242, "entropy": 21.003565788269043, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2158650, "num_agent_steps_sampled": 6475950, "num_steps_trained": 2158650, "num_agent_steps_trained": 6475950, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8017, "training_iteration": 225, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-59-13", "timestamp": 1706194753, "time_this_iter_s": 23.012197971343994, "time_total_s": 4549.108656644821, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA017A6D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4549.108656644821, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 10.0125, "ram_util_percent": 55.396875}}
{"episode_reward_max": 105.34443104639648, "episode_reward_min": -267.8665536083281, "episode_reward_mean": 54.399014725353915, "episode_len_mean": 297.76, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -99.58967137336731}, "policy_reward_max": {"shared_policy": 35.36926835154493}, "policy_reward_mean": {"shared_policy": 18.1330049084513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.501028046011896, -265.49012483656406, 75.0179215092212, 89.39064959948881, 58.82414275035262, 32.64340973366049, 102.22807577252387, 46.58673052955416, 65.5927075780928, 24.541463088244186, 67.62556835263968, 57.33102472871539, 46.05213095620272, 44.65103542804715, 43.440868987701805, 31.506959583610268, 51.22860685037449, 52.566171023994656, 73.3266127258539, 104.83771959692237, -21.061091916635633, 63.10195401124655, 63.51790952682494, 49.36226804833858, 76.24092108756304, 105.34443104639648, 45.074955284595475, 69.57713588885963, 63.070037219673395, 47.987372427014606, 29.15347182005644, 52.13433290272948, 55.49548754002896, 70.1656425206456, 86.51542570628224, 66.80987147381528, 48.28923361003399, 39.66731937229632, 77.58921664394437, 32.106274761259556, 53.00133262760937, 57.349052735604346, 75.55677776783702, 73.73715115897356, 91.51065352372825, 98.8277478739619, 68.31742659956217, 88.57515361811964, 30.682541646063314, 72.96988823357968, 63.06943203415722, 58.73384431004523, 65.72268949332644, 74.56909641250967, 85.8230733796954, 45.403115734457955, 61.12295977026221, 74.83078651502727, 41.35662880167365, 68.89765535667537, 57.03247659653424, 56.75043240265222, 32.2939857840538, 99.30392417311666, 22.39321803674099, 68.0340743077686, 53.589024150744066, 85.35260105412452, 53.02619852125645, -4.124522760510445, 76.88107610866425, 86.5585902314633, 87.69257561862466, 61.458043177612126, 61.58227846771477, 79.17129658907652, 89.06276027858257, 43.85149955004454, 59.28079737722872, 70.24606384802607, 72.53234924562275, 72.55672885850072, 61.51094128191468, 81.18120218440889, 50.49435908719897, 78.56284762360153, 62.49555013328789, 44.25052294880152, 54.259297172538936, 50.63450059108433, 46.88450389355418, 63.4654155820608, 58.594642804935575, 95.0523790065199, -267.8665536083281, 42.50288816541433, 62.89844137802719, 64.94737083557993, 17.826209302060292, 52.0796039626002], "episode_lengths": [300, 222, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [20.520291204253823, 21.513608504707605, 21.467128337050468, -99.58967137336731, -83.03835670650005, -82.8620967566967, 24.989495247602463, 24.90817953646183, 25.120246725156903, 29.605789480110005, 29.76149070759614, 30.023369411782667, 19.307744599878788, 19.804716430604458, 19.711681719869375, 10.92435896365592, 10.886338664839656, 10.832712105164916, 34.129396249850586, 34.1117199709018, 33.98695955177148, 15.610454988355428, 15.283243584136159, 15.693031957062573, 21.66133292516072, 21.64352186520894, 22.28785278772314, 8.236766013627246, 8.082035494347409, 8.22266158026953, 23.01364804059267, 22.448421105742455, 22.16349920630455, 19.424282530943543, 18.92868101100126, 18.97806118677059, 15.254402468601853, 14.984697783986718, 15.813030703614146, 14.691211352745682, 14.96168936106065, 14.99813471424082, 15.07658233648786, 13.607708851496369, 14.756577799717576, 9.901898364226014, 10.557852211097867, 11.047209008286387, 17.54598042787984, 16.3732191324234, 17.30940729007125, 17.609207107375056, 17.499848323563725, 17.457115593055875, 24.59896995251377, 24.13736768563588, 24.590275087704256, 35.01709545465806, 35.13900783347586, 34.68161630878845, -7.034012861549854, -6.98848576284945, -7.038593292236328, 21.38645844471951, 20.630121817191437, 21.085373749335602, 21.321694811185196, 21.228410263856247, 20.967804451783493, 16.74188435574372, 15.850174208482102, 16.770209484112755, 25.150640442967415, 25.47074320167303, 25.619537442922592, 34.756498013933495, 35.21866468091805, 35.36926835154493, 15.156235565741852, 15.602104534705475, 14.316615184148148, 23.791196724399924, 23.522134102880955, 22.26380506157875, 20.48301410675049, 21.342301730066538, 21.24472138285637, 15.818917776147515, 16.106715915181354, 16.061738735685736, 9.03169670701027, 10.030617523938417, 10.091157589107752, 17.55957260231176, 16.9488071600596, 17.62595314035812, 18.436380388836056, 18.619514221015066, 18.439592930177838, 23.683649436493084, 23.288423287371785, 23.193569796780736, 28.79541329791148, 28.811377005030707, 28.908635403340057, 22.516661755119756, 21.712886815269783, 22.58032290342574, 15.907191142439842, 16.204800970852375, 16.17724149674177, 12.853602920969323, 13.437619810303048, 13.376096641023949, 25.889315658559397, 25.880581277733043, 25.81931970765193, 11.113322906196117, 10.643874078989029, 10.34907777607441, 17.470667734742165, 17.325298339128494, 18.205366553738713, 18.825550347566605, 19.251774570904672, 19.27172781713307, 25.5717037419478, 25.289335044721753, 24.695738981167466, 24.340566804011658, 24.54889803876479, 24.847686316197112, 30.104735642671585, 30.438742712140083, 30.967175168916583, 32.46619916955629, 33.20937381560603, 33.15217488879958, 22.958629332482815, 22.63040380179882, 22.728393465280533, 29.59653087177624, 29.43717861299713, 29.541444133346275, 10.379016694923237, 10.183875670035675, 10.119649281104401, 24.165034015973404, 24.660587800977126, 24.14426641662915, 20.96604685485363, 21.08483466040343, 21.018550518900156, 19.825887245436505, 19.661392507453755, 19.24656455715497, 22.108282630719856, 22.02286738778153, 21.591539474825055, 24.60596390565236, 24.912325856586293, 25.050806650271014, 28.552860391636685, 28.534952995677784, 28.735259992380932, 15.032187310357884, 15.13579838102062, 15.235130043079451, 20.253841570268065, 20.531793470184, 20.33732472981015, 24.784085807700947, 25.09542867665489, 24.951272030671433, 13.951916757971048, 14.00331475585699, 13.401397287845612, 22.75555595507224, 23.005474523951605, 23.136624877651528, 19.107658126701907, 18.88677480568488, 19.03804366414745, 18.552551060914993, 18.95258817449212, 19.24529316724511, 10.834461748600006, 10.345666483044624, 11.113857552409172, 33.0995187635223, 33.1881707633535, 33.01623464624086, 7.460615734259278, 7.425472910205514, 7.507129392276198, 22.71444671228528, 22.870683347224258, 22.448944248259068, 17.79869210844238, 17.748847780128315, 18.04148426217337, 28.482527044912175, 28.212245014806584, 28.65782899440576, 17.793105617165565, 17.356525883078575, 17.876567021012306, -0.9626508913934231, -2.1547861993312836, -1.007085669785738, 25.72073896477619, 25.69362240905562, 25.466714734832436, 28.92904384930928, 29.054813850050166, 28.57473253210385, 29.146598408619553, 29.30683759848276, 29.239139611522347, 20.293017208576202, 20.496830858290195, 20.668195110745728, 20.077365328868225, 21.094253835578755, 20.410659303267792, 26.38395545631647, 26.341727949678898, 26.44561318308115, 29.419913426041603, 29.833027174696326, 29.809819677844644, 14.464677222073078, 14.653664980083704, 14.733157347887754, 19.827998859186962, 19.806497079630688, 19.646301438411072, 23.357930469016225, 23.405208705614, 23.482924673395843, 23.97412096709013, 24.29297702945769, 24.265251249074936, 24.33367557451129, 24.065902993083, 24.15715029090643, 20.46427287409702, 20.349864328900964, 20.6968040789167, 26.608736281593636, 27.12894308318694, 27.443522819628313, 16.879501208662987, 16.182100862264633, 17.432757016271353, 26.389284644896776, 26.241031679014355, 25.932531299690396, 20.568791960676506, 20.620445271333054, 21.306312901278332, 14.870455607771873, 14.269129380583763, 15.110937960445881, 18.183829812332988, 18.272017096169293, 17.803450264036655, 16.90234614132592, 16.838043667996914, 16.894110781761498, 15.92913497487703, 15.419816302756459, 15.535552615920693, 21.080443178613976, 21.049158712228135, 21.33581369121869, 19.08058276772499, 19.95739489234984, 19.556665144860744, 31.580304255088166, 31.61707741518815, 31.854997336243585, -98.10964683691661, -84.5886177259187, -85.16828904549281, 14.313581071794033, 14.272827923297882, 13.916479170322418, 20.738617104788617, 21.04932155211766, 21.11050272112091, 21.881249328143895, 21.19723714888096, 21.86888435855508, 6.138230245870844, 5.954308570673064, 5.7336704855163845, 17.65890752027431, 17.02191540102163, 17.39878104130426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15337694217014242, "mean_inference_ms": 0.707220605802016, "mean_action_processing_ms": 0.10021337897433906, "mean_env_wait_ms": 0.8087940735102466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2168244, "timesteps_this_iter": 0, "agent_timesteps_total": 6504732, "timers": {"sample_time_ms": 21052.711, "sample_throughput": 455.713, "load_time_ms": 0.462, "load_throughput": 20750903.762, "learn_time_ms": 3163.553, "learn_throughput": 3032.666, "update_time_ms": 9.158}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.844737558731169e-14, "cur_lr": 0.0005, "total_loss": 44.4752197265625, "policy_loss": 5.878652369850634e-05, "vf_loss": 44.687581062316895, "vf_explained_var": 0.2787793055176735, "kl": 0.013527847070251441, "entropy": 21.241906881332397, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2168244, "num_agent_steps_sampled": 6504732, "num_steps_trained": 2168244, "num_agent_steps_trained": 6504732, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8048, "training_iteration": 226, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-59-35", "timestamp": 1706194775, "time_this_iter_s": 21.806614875793457, "time_total_s": 4570.915271520615, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA0158A3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4570.915271520615, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 8.619354838709677, "ram_util_percent": 55.448387096774184}}
{"episode_reward_max": 99.30392417311666, "episode_reward_min": -267.8665536083281, "episode_reward_mean": 57.81167118750018, "episode_len_mean": 298.54, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -98.10964683691661}, "policy_reward_max": {"shared_policy": 33.20937381560603}, "policy_reward_mean": {"shared_policy": 19.270557062500053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.1656425206456, 86.51542570628224, 66.80987147381528, 48.28923361003399, 39.66731937229632, 77.58921664394437, 32.106274761259556, 53.00133262760937, 57.349052735604346, 75.55677776783702, 73.73715115897356, 91.51065352372825, 98.8277478739619, 68.31742659956217, 88.57515361811964, 30.682541646063314, 72.96988823357968, 63.06943203415722, 58.73384431004523, 65.72268949332644, 74.56909641250967, 85.8230733796954, 45.403115734457955, 61.12295977026221, 74.83078651502727, 41.35662880167365, 68.89765535667537, 57.03247659653424, 56.75043240265222, 32.2939857840538, 99.30392417311666, 22.39321803674099, 68.0340743077686, 53.589024150744066, 85.35260105412452, 53.02619852125645, -4.124522760510445, 76.88107610866425, 86.5585902314633, 87.69257561862466, 61.458043177612126, 61.58227846771477, 79.17129658907652, 89.06276027858257, 43.85149955004454, 59.28079737722872, 70.24606384802607, 72.53234924562275, 72.55672885850072, 61.51094128191468, 81.18120218440889, 50.49435908719897, 78.56284762360153, 62.49555013328789, 44.25052294880152, 54.259297172538936, 50.63450059108433, 46.88450389355418, 63.4654155820608, 58.594642804935575, 95.0523790065199, -267.8665536083281, 42.50288816541433, 62.89844137802719, 64.94737083557993, 17.826209302060292, 52.0796039626002, 19.08866360038519, 81.53185205347835, 13.195880465209484, 60.07259679585694, 75.3345540165901, 68.80182829871772, 55.85492106527087, 74.14785965532063, 65.24948003515598, 74.23742337059228, 57.61440509185192, 78.89308949187398, 38.252938125282526, 53.17534714564681, 55.93695430504155, 83.01990262418985, 40.17400101199745, 42.65910723060367, 56.87089443206784, 50.47493307059629, 45.50092032365498, 87.34983371384439, 64.57933838292954, 40.794954309239984, 58.060870768502326, 30.717133142054067, 58.674329988658414, 59.37649843635154, 64.31435149908063, 41.971022333949804, 91.8327301368117, 59.15220621670596, 58.75671196845359], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [23.683649436493084, 23.288423287371785, 23.193569796780736, 28.79541329791148, 28.811377005030707, 28.908635403340057, 22.516661755119756, 21.712886815269783, 22.58032290342574, 15.907191142439842, 16.204800970852375, 16.17724149674177, 12.853602920969323, 13.437619810303048, 13.376096641023949, 25.889315658559397, 25.880581277733043, 25.81931970765193, 11.113322906196117, 10.643874078989029, 10.34907777607441, 17.470667734742165, 17.325298339128494, 18.205366553738713, 18.825550347566605, 19.251774570904672, 19.27172781713307, 25.5717037419478, 25.289335044721753, 24.695738981167466, 24.340566804011658, 24.54889803876479, 24.847686316197112, 30.104735642671585, 30.438742712140083, 30.967175168916583, 32.46619916955629, 33.20937381560603, 33.15217488879958, 22.958629332482815, 22.63040380179882, 22.728393465280533, 29.59653087177624, 29.43717861299713, 29.541444133346275, 10.379016694923237, 10.183875670035675, 10.119649281104401, 24.165034015973404, 24.660587800977126, 24.14426641662915, 20.96604685485363, 21.08483466040343, 21.018550518900156, 19.825887245436505, 19.661392507453755, 19.24656455715497, 22.108282630719856, 22.02286738778153, 21.591539474825055, 24.60596390565236, 24.912325856586293, 25.050806650271014, 28.552860391636685, 28.534952995677784, 28.735259992380932, 15.032187310357884, 15.13579838102062, 15.235130043079451, 20.253841570268065, 20.531793470184, 20.33732472981015, 24.784085807700947, 25.09542867665489, 24.951272030671433, 13.951916757971048, 14.00331475585699, 13.401397287845612, 22.75555595507224, 23.005474523951605, 23.136624877651528, 19.107658126701907, 18.88677480568488, 19.03804366414745, 18.552551060914993, 18.95258817449212, 19.24529316724511, 10.834461748600006, 10.345666483044624, 11.113857552409172, 33.0995187635223, 33.1881707633535, 33.01623464624086, 7.460615734259278, 7.425472910205514, 7.507129392276198, 22.71444671228528, 22.870683347224258, 22.448944248259068, 17.79869210844238, 17.748847780128315, 18.04148426217337, 28.482527044912175, 28.212245014806584, 28.65782899440576, 17.793105617165565, 17.356525883078575, 17.876567021012306, -0.9626508913934231, -2.1547861993312836, -1.007085669785738, 25.72073896477619, 25.69362240905562, 25.466714734832436, 28.92904384930928, 29.054813850050166, 28.57473253210385, 29.146598408619553, 29.30683759848276, 29.239139611522347, 20.293017208576202, 20.496830858290195, 20.668195110745728, 20.077365328868225, 21.094253835578755, 20.410659303267792, 26.38395545631647, 26.341727949678898, 26.44561318308115, 29.419913426041603, 29.833027174696326, 29.809819677844644, 14.464677222073078, 14.653664980083704, 14.733157347887754, 19.827998859186962, 19.806497079630688, 19.646301438411072, 23.357930469016225, 23.405208705614, 23.482924673395843, 23.97412096709013, 24.29297702945769, 24.265251249074936, 24.33367557451129, 24.065902993083, 24.15715029090643, 20.46427287409702, 20.349864328900964, 20.6968040789167, 26.608736281593636, 27.12894308318694, 27.443522819628313, 16.879501208662987, 16.182100862264633, 17.432757016271353, 26.389284644896776, 26.241031679014355, 25.932531299690396, 20.568791960676506, 20.620445271333054, 21.306312901278332, 14.870455607771873, 14.269129380583763, 15.110937960445881, 18.183829812332988, 18.272017096169293, 17.803450264036655, 16.90234614132592, 16.838043667996914, 16.894110781761498, 15.92913497487703, 15.419816302756459, 15.535552615920693, 21.080443178613976, 21.049158712228135, 21.33581369121869, 19.08058276772499, 19.95739489234984, 19.556665144860744, 31.580304255088166, 31.61707741518815, 31.854997336243585, -98.10964683691661, -84.5886177259187, -85.16828904549281, 14.313581071794033, 14.272827923297882, 13.916479170322418, 20.738617104788617, 21.04932155211766, 21.11050272112091, 21.881249328143895, 21.19723714888096, 21.86888435855508, 6.138230245870844, 5.954308570673064, 5.7336704855163845, 17.65890752027431, 17.02191540102163, 17.39878104130426, 6.5420781299471855, 6.490148440003395, 6.0564370304346085, 27.40955086362858, 26.87019373228152, 27.252107457568243, 4.252157509326935, 4.730459451675415, 4.213263504207134, 20.041837883492306, 19.99223933120568, 20.03851958115895, 24.900730339189366, 25.222640254845217, 25.21118342255552, 22.67926763494809, 23.195369855811194, 22.92719080795844, 18.666781852642686, 18.58631334702173, 18.601825865606457, 24.664919914056853, 24.758686327685908, 24.72425341357787, 21.609328652421624, 22.357695421824843, 21.282455960909516, 23.930291553338364, 25.1598327619334, 25.147299055320516, 19.24679686377445, 19.57725408549109, 18.79035414258638, 26.303216315805912, 26.55983765050769, 26.03003552556038, 12.636425711214542, 12.86871125176549, 12.747801162302494, 17.664953164756298, 18.004744697362185, 17.505649283528328, 18.44903619090715, 18.51860166589418, 18.96931644824022, 27.419316232204437, 27.69666662812233, 27.903919763863087, 13.542131186773375, 13.246593569715813, 13.38527625550826, 14.259680251280457, 13.849425877133996, 14.550001102189213, 19.117857764164597, 19.280373851458222, 18.472662816445023, 16.90133988515784, 16.969970654541, 16.603622530897454, 15.3709758358697, 14.631069908539445, 15.498874579245836, 28.81075583646694, 29.36309724363187, 29.17598063374558, 21.10319700340429, 21.84702893967429, 21.629112439850957, 13.73967032879591, 13.22757638990879, 13.827707590535283, 19.409865746895463, 19.291361300895602, 19.35964372071126, 9.8927305539449, 10.284605128069714, 10.539797460039452, 19.674619903167084, 19.27036302288373, 19.7293470626076, 19.82373029770679, 19.73127020150423, 19.82149793714052, 21.399712434659392, 21.36265507216254, 21.551983992258698, 13.955631174147129, 14.086736228317022, 13.928654931485653, 30.87768206993738, 30.264823163549096, 30.69022490332523, 19.690442733466625, 19.905069176806137, 19.5566943064332, 19.92504326587853, 18.959475954373673, 19.872192748201385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534675712895149, "mean_inference_ms": 0.7075897611660611, "mean_action_processing_ms": 0.10025334009221032, "mean_env_wait_ms": 0.8090274265679271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2177838, "timesteps_this_iter": 0, "agent_timesteps_total": 6533514, "timers": {"sample_time_ms": 21203.174, "sample_throughput": 452.479, "load_time_ms": 0.462, "load_throughput": 20750903.762, "learn_time_ms": 3170.487, "learn_throughput": 3026.033, "update_time_ms": 9.164}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.844737558731169e-14, "cur_lr": 0.0005, "total_loss": 6.808101415634155, "policy_loss": -0.0007143198798063577, "vf_loss": 7.018996715545654, "vf_explained_var": -0.01265687495470047, "kl": 0.004370870738528359, "entropy": 21.01810574531555, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2177838, "num_agent_steps_sampled": 6533514, "num_steps_trained": 2177838, "num_agent_steps_trained": 6533514, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8081, "training_iteration": 227, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_15-59-56", "timestamp": 1706194796, "time_this_iter_s": 21.090864419937134, "time_total_s": 4592.006135940552, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA03BBD790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4592.006135940552, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 10.06, "ram_util_percent": 55.20000000000001}}
{"episode_reward_max": 95.0523790065199, "episode_reward_min": -327.7056161537767, "episode_reward_mean": 53.562347345055166, "episode_len_mean": 296.4, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -113.96275760730109}, "policy_reward_max": {"shared_policy": 31.854997336243585}, "policy_reward_mean": {"shared_policy": 17.85411578168505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.39321803674099, 68.0340743077686, 53.589024150744066, 85.35260105412452, 53.02619852125645, -4.124522760510445, 76.88107610866425, 86.5585902314633, 87.69257561862466, 61.458043177612126, 61.58227846771477, 79.17129658907652, 89.06276027858257, 43.85149955004454, 59.28079737722872, 70.24606384802607, 72.53234924562275, 72.55672885850072, 61.51094128191468, 81.18120218440889, 50.49435908719897, 78.56284762360153, 62.49555013328789, 44.25052294880152, 54.259297172538936, 50.63450059108433, 46.88450389355418, 63.4654155820608, 58.594642804935575, 95.0523790065199, -267.8665536083281, 42.50288816541433, 62.89844137802719, 64.94737083557993, 17.826209302060292, 52.0796039626002, 19.08866360038519, 81.53185205347835, 13.195880465209484, 60.07259679585694, 75.3345540165901, 68.80182829871772, 55.85492106527087, 74.14785965532063, 65.24948003515598, 74.23742337059228, 57.61440509185192, 78.89308949187398, 38.252938125282526, 53.17534714564681, 55.93695430504155, 83.01990262418985, 40.17400101199745, 42.65910723060367, 56.87089443206784, 50.47493307059629, 45.50092032365498, 87.34983371384439, 64.57933838292954, 40.794954309239984, 58.060870768502326, 30.717133142054067, 58.674329988658414, 59.37649843635154, 64.31435149908063, 41.971022333949804, 91.8327301368117, 59.15220621670596, 58.75671196845359, 34.57520232349634, 56.69915711134669, 65.02320188283919, 59.599468474276364, 55.88891209289429, 58.04413984715937, 26.127627317793653, 51.177244041115046, 50.60718461126086, 69.2721252143383, 85.71597889624533, 52.80910737812518, -327.7056161537767, 79.01396000385283, 76.46221951022741, 75.26360927098719, 49.51902058720589, 70.48357821628449, 71.21920858323571, 74.32953763753173, 83.85252499207851, 67.6960827410221, 49.50514694303271, 73.28199074044822, 77.74063196405766, 80.72713224589825, 57.76394484937191, 46.696119885891676, 70.57273913174866, 74.2654983010143, 75.42174775199965], "episode_lengths": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 154, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 86, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "policy_shared_policy_reward": [7.460615734259278, 7.425472910205514, 7.507129392276198, 22.71444671228528, 22.870683347224258, 22.448944248259068, 17.79869210844238, 17.748847780128315, 18.04148426217337, 28.482527044912175, 28.212245014806584, 28.65782899440576, 17.793105617165565, 17.356525883078575, 17.876567021012306, -0.9626508913934231, -2.1547861993312836, -1.007085669785738, 25.72073896477619, 25.69362240905562, 25.466714734832436, 28.92904384930928, 29.054813850050166, 28.57473253210385, 29.146598408619553, 29.30683759848276, 29.239139611522347, 20.293017208576202, 20.496830858290195, 20.668195110745728, 20.077365328868225, 21.094253835578755, 20.410659303267792, 26.38395545631647, 26.341727949678898, 26.44561318308115, 29.419913426041603, 29.833027174696326, 29.809819677844644, 14.464677222073078, 14.653664980083704, 14.733157347887754, 19.827998859186962, 19.806497079630688, 19.646301438411072, 23.357930469016225, 23.405208705614, 23.482924673395843, 23.97412096709013, 24.29297702945769, 24.265251249074936, 24.33367557451129, 24.065902993083, 24.15715029090643, 20.46427287409702, 20.349864328900964, 20.6968040789167, 26.608736281593636, 27.12894308318694, 27.443522819628313, 16.879501208662987, 16.182100862264633, 17.432757016271353, 26.389284644896776, 26.241031679014355, 25.932531299690396, 20.568791960676506, 20.620445271333054, 21.306312901278332, 14.870455607771873, 14.269129380583763, 15.110937960445881, 18.183829812332988, 18.272017096169293, 17.803450264036655, 16.90234614132592, 16.838043667996914, 16.894110781761498, 15.92913497487703, 15.419816302756459, 15.535552615920693, 21.080443178613976, 21.049158712228135, 21.33581369121869, 19.08058276772499, 19.95739489234984, 19.556665144860744, 31.580304255088166, 31.61707741518815, 31.854997336243585, -98.10964683691661, -84.5886177259187, -85.16828904549281, 14.313581071794033, 14.272827923297882, 13.916479170322418, 20.738617104788617, 21.04932155211766, 21.11050272112091, 21.881249328143895, 21.19723714888096, 21.86888435855508, 6.138230245870844, 5.954308570673064, 5.7336704855163845, 17.65890752027431, 17.02191540102163, 17.39878104130426, 6.5420781299471855, 6.490148440003395, 6.0564370304346085, 27.40955086362858, 26.87019373228152, 27.252107457568243, 4.252157509326935, 4.730459451675415, 4.213263504207134, 20.041837883492306, 19.99223933120568, 20.03851958115895, 24.900730339189366, 25.222640254845217, 25.21118342255552, 22.67926763494809, 23.195369855811194, 22.92719080795844, 18.666781852642686, 18.58631334702173, 18.601825865606457, 24.664919914056853, 24.758686327685908, 24.72425341357787, 21.609328652421624, 22.357695421824843, 21.282455960909516, 23.930291553338364, 25.1598327619334, 25.147299055320516, 19.24679686377445, 19.57725408549109, 18.79035414258638, 26.303216315805912, 26.55983765050769, 26.03003552556038, 12.636425711214542, 12.86871125176549, 12.747801162302494, 17.664953164756298, 18.004744697362185, 17.505649283528328, 18.44903619090715, 18.51860166589418, 18.96931644824022, 27.419316232204437, 27.69666662812233, 27.903919763863087, 13.542131186773375, 13.246593569715813, 13.38527625550826, 14.259680251280457, 13.849425877133996, 14.550001102189213, 19.117857764164597, 19.280373851458222, 18.472662816445023, 16.90133988515784, 16.969970654541, 16.603622530897454, 15.3709758358697, 14.631069908539445, 15.498874579245836, 28.81075583646694, 29.36309724363187, 29.17598063374558, 21.10319700340429, 21.84702893967429, 21.629112439850957, 13.73967032879591, 13.22757638990879, 13.827707590535283, 19.409865746895463, 19.291361300895602, 19.35964372071126, 9.8927305539449, 10.284605128069714, 10.539797460039452, 19.674619903167084, 19.27036302288373, 19.7293470626076, 19.82373029770679, 19.73127020150423, 19.82149793714052, 21.399712434659392, 21.36265507216254, 21.551983992258698, 13.955631174147129, 14.086736228317022, 13.928654931485653, 30.87768206993738, 30.264823163549096, 30.69022490332523, 19.690442733466625, 19.905069176806137, 19.5566943064332, 19.92504326587853, 18.959475954373673, 19.872192748201385, 11.788066044449806, 11.483184225857258, 11.303952053189278, 17.904612402121217, 19.583846310774476, 19.210698398451, 21.703040560086563, 21.643362899621323, 21.676798423131302, 19.691771015524864, 19.89631314575672, 20.011384312994778, 18.62729678923884, 18.716954338053853, 18.544660965601594, 19.478315969308213, 19.471062680085495, 19.094761197765663, 8.834967635882393, 8.824651277934507, 8.468008403976754, 17.155571084469557, 17.03324583172798, 16.988427124917507, 16.41276733080545, 17.050533453623444, 17.143883826831967, 23.10118854045868, 22.98431236296892, 23.1866243109107, 28.61998751635352, 28.382959271470696, 28.713032108421118, 17.925390874346093, 16.999784906705216, 17.883931597073868, -102.47405188282332, -111.26880666365227, -113.96275760730109, 26.385181811948613, 26.188498963912323, 26.440279227991894, 25.110575551788003, 25.7383296030263, 25.61331435541311, 25.298391213752126, 25.110681268076092, 24.85453678915897, 16.501897178590298, 16.452196404337883, 16.564927004277706, 23.077151159445435, 23.73668789739409, 23.66973915944496, 23.912274243930966, 23.634965161482484, 23.671969177822263, 25.09505337725082, 24.30311347047487, 24.93137078980604, 28.083334444711596, 27.831449220577866, 27.93774132678905, 22.890081120034054, 22.575687331457928, 22.230314289530114, 15.987023095289857, 16.58104224006334, 16.937081607679517, 24.90526732181509, 24.49596906205018, 23.880754356582955, 26.169815747688205, 25.719824353853852, 25.8509918625156, 26.887976348400116, 27.064089559018612, 26.77506633847952, 19.67678704112768, 18.973040476441383, 19.114117331802845, 15.236490219831467, 15.775380991399288, 15.684248674660921, 23.34546611954768, 23.485120510061577, 23.742152502139405, 24.81898694485426, 25.016881136223674, 24.42963021993637, 25.13153579644859, 25.240335723850876, 25.049876231700182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15350765829582302, "mean_inference_ms": 0.7078563468041543, "mean_action_processing_ms": 0.10029157995100689, "mean_env_wait_ms": 0.8092123136702134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 9, "timesteps_total": 2187432, "timesteps_this_iter": 0, "agent_timesteps_total": 6562296, "timers": {"sample_time_ms": 21309.053, "sample_throughput": 450.231, "load_time_ms": 0.562, "load_throughput": 17061756.445, "learn_time_ms": 3174.04, "learn_throughput": 3022.646, "update_time_ms": 9.164}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.9223687793655844e-14, "cur_lr": 0.0005, "total_loss": 33.27073287963867, "policy_loss": -0.0002532484283796349, "vf_loss": 33.4833607673645, "vf_explained_var": 0.036757878959178925, "kl": 0.008759496297455672, "entropy": 21.23752188682556, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2187432, "num_agent_steps_sampled": 6562296, "num_steps_trained": 2187432, "num_agent_steps_trained": 6562296, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8112, "training_iteration": 228, "trial_id": "b13f9_00000", "experiment_id": "04ae82db22a74503b89423c26761f25d", "date": "2024-01-25_16-00-17", "timestamp": 1706194817, "time_this_iter_s": 20.29261565208435, "time_total_s": 4612.298751592636, "pid": 28228, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 9, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 533, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 4800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 300, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 9, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 300, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000001AA41A6BE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 4800, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4612.298751592636, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 10.713793103448275, "ram_util_percent": 54.551724137931025}}
